Catalo目 录
绪论…………………………………………………………………………………………
第章 时域离散信号和时域离散系统 ……………………………………………………
引言………………………………………………………………
时域离散信号…………………………………………………………………………………………
常用的典型序列…………………………………………………………………………………
序列的运算 ……………………………………………………………………………………
时域离散系统………………………………………………………………………………………
线性系统 ………………………………………………………………………………………
时不变系统………………………………………………………………………………………
线性时不变系统及其输入与输出之间的关系……………………………………………………
系统的因果性和稳定性 ……………………………………………………………………………
时域离散系统的输入输出描述法——线性常系数差分方程………………………………………
线性常系数差分方程 ……………………………………………………………………………
线性常系数差分方程的求解………………………………………………………………………
模拟信号数字处理方法 …………………………………………………………………………………
采样定理及AD变换…………………………………………………………………………
将数字信号转换成模拟信号 ………………………………………………………………………
确定性信号的相关函数…………………………………………………………………………………
信号的互相关函数和自相关函数…………………………………………………………………
周期信号的相关性………………………………………………………………………………
相关函数的性质 ……………………………………………………………………………………
输入信号与输出信号的相关函数…………………………………………………………………
相关函数的应用………………………………………………………………………………
用MATLAB计算相关函数 ……………………………………………………………………
习题与上机题…………………………………………………………………………………………
第章 时域离散信号和系统的频域分析……………………………………………………
引言 ………………………………………………………………………………………………………………
时域离散信号的傅里叶变换的定义及性质……………………………………………………………
时域离散信号傅里叶变换的定义 ………………………………………………………………
——
Created by ZhuangHeng
时域离散信号傅里叶变换的性质………………………………………………………………
周期序列的离散傅里叶级数及傅里叶变换表示式 …………………………………………………
周期序列的离散傅里叶级数……………………………………………………………………
周期序列的傅里叶变换表示式………………………………………………
时域离散信号的傅里叶变换与模拟信号傅里叶变换之间的关系…………………………………
序列的Z变换………………………………………………………………………………………
Z变换的定义 ……………………………………………………………………………………
序列特性对收敛域的影响…………………………………………………………………………
逆Z变换………………………………………………………………………………
Z变换的性质和定理 ………………………………………………………………………………
利用Z变换解差分方程…………………………………………………………………………
利用Z变换分析信号和系统的频响特性……………………………………………………………
频率响应函数与系统函数…………………………………………………………………………
利用系统函数的极点分布分析系统的因果性和稳定性 ………………………………………
利用系统的极零点分布分析系统的频率响应特性………………………………………………
几种特殊系统的系统函数及其特点 ………………………………………………………………
习题与上机题…………………………………………………………………………………
第章 离散傅里叶变换DFT……………………………………………………………
离散傅里叶变换的定义及物理意义 ……………………………………………………………………
DFT的定义……………………………………………………………………………………
DFT与傅里叶变换和Z变换的关系………………………………………………………………
DFT的隐含周期性…………………………………………………………………………………
用MATLAB计算序列的DFT …………………………………………………………………
离散傅里叶变换的基本性质………………………………………………………………………
线性性质……………………………………………………………
循环移位性质………………………………………………………
循环卷积定理…………………………………………………………………………
复共轭序列的DFT …………………………………………………………………………
DFT的共轭对称性……………………………………………………………………………
频率域采样……………………………………………………………………………………
DFT的应用举例 ………………………………………………………………………………………
用DFT计算线性卷积 ……………………………………………………………………
用DFT对信号进行谱分析 ……………………………………………………………………
习题与上机题……………………………………………………………………………………………
第章 快速傅里叶变换FFT……………………………………………………………
引言…………………………………………………………………………
基FFT算法……………………………………………………………………………………
直接计算DFT的特点及减少运算量的基本途径………………………………………………
——
Created by ZhuangHeng
时域抽取法基FFT基本原理…………………………………………………………………
DITFFT算法与直接计算DFT运算量的比较……………………………………………
DITFFT的运算规律及编程思想………………………………………………………
频域抽取法FFTDIFFFT…………………………………………………………………
IDFT的高效算法 ………………………………………………………………………………………
进一步减少运算量的措施…………………………………………………………………………
多类蝶形单元运算………………………………………………………………
旋转因子的生成…………………………………………………
实序列的FFT算法…………………………………………………………………………
其他快速算法简介…………………………………………………………………………………
习题与上机题……………………………………………………………………………………………
第章 时域离散系统的网络结构…………………………………………………………
引言……………………………………………………………………………
用信号流图表示网络结构……………………………………………………………………
IIR系统的基本网络结构…………………………………………………………………………
FIR系统的基本网络结构………………………………………………………………………………
FIR系统的线性相位结构………………………………………………………………………………
FIR系统的频率采样结构………………………………………………………………………………
格型网络结构………………………………………………………………………………………
全零点格型网络结构…………………………………………………
全极点格型网络结构……………………………………………………………
习题与上机题………………………………………………………………………………………………
第章 无限脉冲响应数字滤波器的设计 …………………………………………………
数字滤波器的基本概念……………………………………………………………………………
模拟滤波器的设计…………………………………………………………………………………
模拟低通滤波器的设计指标及逼近方法……………………………………………………
巴特沃斯低通滤波器的设计…………………………………………………………………
切比雪夫滤波器的设计………………………………………………………………………
椭圆滤波器的设计………………………………………………………………………
五种类型模拟滤波器的比较…………………………………………………………………
频率变换与模拟高通、带通、带阻滤波器的设计……………………………………………
用脉冲响应不变法设计IIR数字低通滤波器…………………………………………………………
用双线性变换法设计IIR 数字低通滤波器…………………………………………………
数字高通、带通和带阻滤波器的设计………………………………………………………………
习题与上机题……………………………………………………………………………………………
第章 有限脉冲响应数字滤波器的设计 …………………………………………………
线性相位FIR数字滤波器的条件和特点…………………………………………………………
利用窗函数法设计FIR滤波器 ………………………………………………………………………
——
Created by ZhuangHeng
窗函数法设计原理………………………………………………………………………
典型窗函数介绍…………………………………………………………………………
用窗函数法设计FIR 滤波器的步骤 …………………………………………………………
窗函数法的MATLAB设计函数简介………………………………………………………
利用频率采样法设计FIR 滤波器……………………………………………………………………
利用等波纹最佳逼近法设计FIR数字滤波器 ………………………………………………………
等波纹最佳逼近法的基本思想……………………………………………………………………
remez和 remezord 函数及滤波器设计指标………………………………………………………
IIR和FIR数字滤波器的比较………………………………………………………………………
几种特殊类型滤波器简介………………………………………………………………………………
滤波器分析设计工具FDATool ……………………………………………………………………
习题与上机题……………………………………………………………………………………………
第章 多采样率数字信号处理……………………………………………………………
引言……………………………………………………………………………………
信号的整数倍抽取…………………………………………………………………………………
信号的整数倍内插……………………………………………………………………………
按有理数因子ID的采样率转换…………………………………………………………………
整数倍抽取和内插在数字语音系统中的应用……………………………………………………
数字语音系统中的信号采样过程及其存在的问题……………………………………………
数字语音系统中改进的AD转换方案 …………………………………………………………
接收端DA转换的改进方案 ……………………………………………………………………
采样率转换滤波器的高效实现方法……………………………………………………………………
直接型 FIR滤波器结构 ………………………………………………………………………
多相滤波器结构……………………………………………………………………………………
采样率转换器的MATLAB实现…………………………………………………………………
习题与上机题……………………………………………………………………………………………
第章 数字信号处理的实现 ………………………………………………………………
数字信号处理中的量化效应…………………………………………………………………
量化及量化误差……………………………………………………………………………………
AD变换器中的量化效应………………………………………………………………………
数字系统中的系数量化效应…………………………………………………………………
数字系统中的运算量化效应…………………………………………………………………
数字信号处理技术的软件实现………………………………………………………………
数字信号处理的硬件实现简介……………………………………………………………………
第章 上机实验………………………………………………………………
实验一：系统响应及系统稳定性 ……………………………………………………………………
实验二：时域采样与频域采样 ………………………………………………………………………
实验三：用FFT对信号作频谱分析…………………………………………………………………
——
Created by ZhuangHeng
实验四：IIR数字滤波器设计及软件实现……………………………………………………………
实验五：FIR数字滤波器设计与软件实现 ………………………………………………………
实验六：数字信号处理在双音多频拨号系统中的应用……………………………………………
附录………………………………………………………………………………………
附录A 用Masson公式求网络传输函数Hz…………………………………………………………
附录B MATLAB信号处理工具箱函数索引表……………………………………………………………
参考文献 …………………………………………………………………………………………
——
Created by ZhuangHeng
绪论
数字信号处理的基本概念
几乎在所有的工程技术领域中都会涉及信号处理问题，其信号表现形式有电、磁、机
械以及热、光、声等。信号处理一般包括数据采集以及对信号进行分析、变换、综合、估值
与识别等。这里的信号类别有种：第种是连续信号即模拟信号它的幅度和时间都
取连续变量；第种是时域离散信号，其幅度取连续变量，而时间取离散值；第种是幅度
离散信号，其时间变量取连续值，幅度取离散值，如振幅键控信号；第种是数字信号，它
的幅度和时间都取离散值。一般来说，数字信号处理的对象是数字信号，模拟信号处理的
对象是模拟信号。但是，如果系统中增加数模转换器和模数转换器，那么数字信号处理
系统也可以处理模拟信号。这里关键的问题是两种信号处理系统对信号处理的方式不同，
数字信号处理是采用数值计算的方法完成对信号的处理，而模拟信号处理则是通过一些模
拟器件例如晶体管、运算放大器、电阻、电容、电感等组成的网络来完成对信号的处理。
例如，图a所示的是一个简单的模拟高通滤波器，它是由电阻R和电容C组成的，
而图b所示的则是一个简单的数字滤波器，它是由一个加法器、一个乘法器和一个
延时器组成的。因此，简单地说，数字信号处理就是用数值计算的方法对信号进行处理，这
里“处理”的实质是“运算”处理对象则包括模拟信号和数字信号。
绪
论
C xn yn
xa R y a 延时
○ ×
a简单的模拟高通滤波器 b简单的数字滤波器
图 高通滤波器简型
数字信号处理的实现方法
数字信号处理的主要对象是数字信号，且是采用数值运算的方法达到处理目的的。因
Created by ZhuangHeng
口
数字信号处理第五版
此，其实现方法不同于模拟信号处理的实现方法。数字信号处理的实现方法基本上可以分
成两种，即软件实现方法和硬件实现方法。软件实现方法指的是按照原理和算法，自己编
写程序或者采用现成的程序在通用计算机上实现；硬件实现是按照具体的要求和算法，设
计硬件结构图，用乘法器、加法器、延时器、控制器、存储器以及输入输出接口等基本部件
实现的一种方法。显然，软件实现灵活，只要改变程序中的有关参数，例如只要改变图
b中的参数a数字滤波器可能就是低通、带通或高通滤波器，但是运算速度慢，一
般达不到实时处理，因此，这种方法适合于算法研究和仿真。硬件实现运算速度快，可以达
到实时处理要求，但是不灵活。
用单片机实现的方法属于软硬结合实现，现在单片机发展很快，功能也很强，配以数
字信号处理软件，既灵活，速度又比软件方法快。采用专用的数字信号处理芯片DSP芯
片是目前发展最快、应用最广的一种方法。因为DSP芯片比通用单片机有更为突出的优
点，它结合了数字信号处理的特点，内部配有乘法器和累加器，结构上采用了流水线工作
方式以及并行结构、多总线，且配有适合数字信号处理的指令，是一类可实现高速运算的
微处理器。DSP芯片已由最初的位发展为位、位，且性能优良的高速DSP不断面
市，价格也在不断下降。可以说，用DSP芯片实现数字信号处理，正在变成或已经变成工
程技术领域中的主要实现方法。
综上所述，如果从数字信号处理的实际应用情况和发展考虑，数字信号处理的实现方
法分成软件实现和硬件实现两大类。而硬件实现指的是选用合适的DSP芯片，配有适合芯
片语言及任务要求的软件，实现某种信号处理功能的一种方法。这种系统无疑是一种最佳
的数字信号处理系统。对于更高速的实时系统，DSP的速度也不满足要求时，应采用可编
程超大规模器件或开发专用芯片来实现。
数字信号处理的特点
由于数字信号处理是用数值运算的方式实现对信号的处理的，因此，相对模拟信号处
理，数字信号处理主要有以下优点：
灵活性
数字信号处理系统简称数字系统的性能取决于系统参数，这些参数存储在存储器
中，很容易改变，因此系统的性能容易改变，甚至通过参数的改变，系统可以变成各种完全
不同的系统。灵活性还表现在数字系统可以时分复用，用一套数字系统分时处理几路信号。
数字系统可以实现智能系统的功能，可以根据环境条件、用户需求，自动选择最佳的处理
算法，例如，软件无线电等。软件无线电的基本思想就是：将宽带AD变换器及DA变换
器尽可能地靠近射频天线，建立一个具有“ADDSPDA”模型的通用的、开放的硬件平
台，在这个硬件平台上尽量利用软件技术来实现电台的各种功能模块。例如，通过可编程
数字滤波器对信道进行分离；使用数字信号处理器DSP技术，通过软件编程来实现通信
频段的选择以及完成传送信息抽样、量化、编码解码、运算处理和变换等；通过软件编程
实现不同的信道调制方式的选择，如调幅、调频、单边带、跳频和扩频等；通过软件编程实
现不同的保密结构、网络协议和控制终端功能等。
Created by ZhuangHeng
高精度和高稳定性
数字系统的特性不易随使用条件变化而变化，尤其使用了超大规模集成的DSP芯片，
使设备简化，进一步提高了系统的稳定性和可靠性。运算位数又由位提高到、位，
在计算精度方面，模拟系统是不能和数字系统相比拟的，为此，许多测量仪器为满足高精
度的要求只能采用数字系统。
便于大规模集成
数字部件具有高度的规范性，对电路元件参数要求不严，容易大规模集成和大规模生
产，价格不断降低，这也是DSP芯片和超大规模可编程器件发展迅速的主要因素之一。由
于采用了大规模集成电路，数字系统体积小、重量轻、可靠性强。
可以实现模拟系统无法实现的诸多功能
数字信号可以存储，数字系统可以进行各种复杂的变换和运算。这一优点更加使数字
信号处理不再仅仅限于对模拟系统的逼近，它可以实现模拟系统无法实现的诸多功能。例
如，电视系统中的画中画、多画面以及各种视频特技，包括画面压缩、画面放大、画面坐标
旋转、演员特技制作；变声变调的特殊的配音制作；解卷积；图像信号的压缩编码；高级加
密解密；数字滤波器严格的线性相位特性；等等。
数字信号处理涉及的理论、实现技术与应用
正是由于以上的优点，数字信号处理的理论和技术一出现就受到人们的极大关注，发
展非常迅速。国际上一般把年作为数字信号处理这一门新学科的开端，多年以来，
这门学科基本上形成了自己一套完整的理论体系，其中也包括各种快速的和优良的算法。
而且随着各种电子技术及计算机技术的飞速发展，数字信号处理的理论和技术还在不断丰
富和完善，新的理论和新技术层出不穷。可以说，数字信号处理是发展最快、应用最广泛、
成效最显著的新学科之一，目前已广泛地应用在语音、雷达、声呐、地震、图像、通信、控
制、生物医学、遥感遥测、地质勘探、航空航天、故障检测、自动化仪表等领域。
绪
论
数字信号处理涉及的内容非常丰富广泛。其所应用的数学工具涉及微积分、随机过程、
高等代数、数值分析、复变函数、数值方法和各种变换傅里叶变换，Z变换，离散傅里叶
变换，小波变换……等；数字信号处理的理论基础包括网络理论、信号与系统、神经网络
等；数字信号处理的实现技术又涉及计算机、DSP技术、微电子技术、专用集成电路设计
和程序设计等方面；应用领域包括通信、雷达、人工智能、模式识别、航空航天、图像处理、
语音处理等。
由此可见，要从事数字信号处理理论研究和应用开发工作，需要学习的知识很多。本
书作为数字信号处理的基础教材，主要讲述数字信号处理的基本原理和基本分析方法，是
今后学习上述专门知识和技术的基础。
Created by ZhuangHeng
数字信号处理第五版
第章
时域离散信号和时域离散系统
引 言
信号通常是一个自变量或几个自变量的函数。如果仅有一个自变量，则称为一维信号；
如果有两个以上的自变量，则称为多维信号。本书仅研究一维数字信号处理的理论与技术。
物理信号的自变量有多种，可以是时间、距离、温度、位置等，本书一般把信号看做时间的
函数。针对信号的自变量和函数值的取值情况，信号可分为以下三种。
如果信号的自变量和函数值都取连续值，则称这种信号为模拟信号或者称为时域连续
信号，例如语言信号、温度信号等；如果自变量取离散值，而函数值取连续值，则称这种信
号为时域离散信号，这种信号通常来源于对模拟信号的采样；如果信号的自变量和函数值
均取离散值，则称为数字信号。我们知道，计算机或者专用数字信号处理芯片的位数是有
限的，用它们分析与处理信号，信号的函数值必须用有限位的二进制编码表示，这样信号
本身的取值不再是连续的，而是离散值。这种用有限位二进制编码表示的时域离散信号就
是数字信号，因此，数字信号是幅度量化了的时域离散信号。
例如：xt sinπt这是一个模拟信号，如果将它按照时间采样间隔T
s进行等间隔采样，便得到时域离散信号rn即
xnxT sinπnT
…一…
显然，时域离散信号是时间离散化的模拟信号。如果用四位二进制数表示该时域离散信号，
便得到相应的数字信号xn即
xn……
Created by ZhuangHeng
显然，数字信号是幅度、时间均离散化的模拟信号，或者说是幅度离散化的时域离散信号。
信号有模拟信号、时域离散信号和数字信号之分，按照系统的输入输出信号的类型，
系统也分为模拟系统、时域离散系统和数字系统。当然，也存在模拟网络和数字网络构成
的混合系统。
数字信号处理最终要处理的是数字信号，但为简单，在理论研究中一般研究时域离散
信号和系统。时域离散信号和数字信号之间的差别，仅在于数字信号存在量化误差，本书
将在第章中专门分析实现中的量化误差问题。
本章作为全书的基础，主要学习时域离散信号的表示方法和典型信号、时域离散线性
时不变系统的时域分析方法，最后介绍模拟信号数字处理方法。
时域离散信号
实际中遇到的信号一般是模拟信号，对它进行等间隔采样便可以得到时域离散信号。
假设模拟信号为x。t在离散时间点t对它进行采样，得到x。tn为整数。x。t
是离散时间变量t的函数，仅在离散时间点t上有意义，而在其他时间则没有定义。在实际
应用中，通常采样间隔为常数T即t。nT。这种采样称为等间隔采样均匀采样采样得
到的信号记为
xnx。xnTn
这里，xn称为时域离散信号，式中的n取整数，将n……代人
上式，得到：
xn…x。Tx一TxxTx。TxT…
显然xn是一个有序的数字的集合，因此时域离散信号也可以称为序列。注意，这里n取
整数，非整数时xn无定义。时域离散信号有三种表示方法。
用集合符号表示序列
数的集合用集合符号·表示。时域离散信号是一个有序的数的集合，可表示成集合：
xn《xn……
例如，一个有限长序列可表示为
rnn
也可简单地表示为
xn
集合中有下划线的元素表示 n时刻的采样值。
用公式表示序列
例如：
第章
时域离散信号和时域离散系统
xnaa∞n∞
Created by ZhuangHeng
口口
口口
口口
口口
口
数字信号处理第五版
用图形表示序列
例如，时域离散信号xnsinπnn……图就是
它的图形表示。
n
n
图 rnsinmn的波形图
这是一种很直观的表示方法。为了醒目，常常在每一条竖线的顶端加一个小黑点。
实际中要根据具体情况灵活运用三种表示方法，对于一般序列，例如由实际模拟信号
采样得到的序列，或者是一些没有明显规律的数据，可以用集合或波形图表示。
下面介绍用MATLAB语言表示序列。
MATLAB用两个参数向量x和n表示有限长序列xnx是xn的样值向量，n是
位置向量相当于图形表示方法中的横坐标nn与x长度相等，向量n的第m个元素
nm表示样值xm的位置。位置向量n一般都是单位增向量，产生语句为：nnsnf其
中ns表示序列xn的起始点，nf表示序列xn的终止点。这样将有限长序列xn记为
xnnnsnf。
例如，xn
相应的n…所以序列
xn的MATLAB表示如下：
n
x
这里xn的个样值是正弦序列的采样值，即
xnsinπn n……
所以，也可以用计算的方法产生序列向量：
nx sinpin
这样用MATLAB计算产生xn并绘图的程序如下：
gmsinpin信号产生及图绘图程序
置向量n从到 n
xsinpin算序列向量xn的个样值
subplotstemnxline
axisxlabelnylabelxn
运行程序输出波形如图所示。
Created by ZhuangHeng
常用的典型序列
单位脉冲序列δn
单位脉冲序列也称为单位采样序列，特点是仅在n时取值为其他均为零。它在
时域离散线性时不变系统中的作用类似于模拟信号和系统中的单位冲激函数δt但不同
的是，t在t时取值为无穷大，t≠时取值为零，对时间t的积分为。单位脉冲序列
和单位冲激信号如图所示。
n t
n
a单位脉冲序列 b单位冲激信号
图 单位脉冲序列和单位冲激信号
单位阶跃序列un
“
单位阶跃序列如图所示。它类似于模拟信号中的单位阶跃函数ut。δn与
un之间的关系如下列公式所示：
δnunun
unnk
令nkm代入式得
nm
un
第章时域离散信号和时域离散系统
n
图 单位阶跃序列
矩形序列Rn
Rn≤n≤N
其他n
式中，N称为矩形序列的长度。当N时，Rn的波形如图所示。矩形序列可用
Created by ZhuangHeng
口
口口口
数字信号处理第五版
单位阶跃序列表示，如下式：
RnununN
Rn
图 矩形序列
实指数序列
xnaun a为实数
如果axn的幅度随n的增大而减小，称xn为收敛序列；如果a则称为发
散序列。其波形如图所示。
dun dnn
a a
n n
a收敛序列 b发散序列
图 实指数序列
正弦序列
xnsinwn
式中，w称为正弦序列的数字域频率也称数字频率单位是弧度rad它表示序列变化
的速率，或者说表示相邻两个序列值之间相位变化的弧度数。
如果正弦序列是由模拟信号xt采样得到的，那么
xtsinΩt
xnxrsinQnTsinwn
因此得到数字频率w与模拟角频率Ω之间的关系为
wQT
式具有普遍意义，它表示凡是由模拟信号采样得到的序列，模拟角频率Ω与序
列的数字域频率w呈线性关系。由于采样频率F与采样周期T互为倒数，因而有
上式表示数字域频率是模拟角频率对采样频率的归一化频率。本书中用w表示数字域频
率，Ω和f分别表示模拟角频率和模拟频率。
复指数序列
复指数序列用下式表示：
Created by ZhuangHeng
xne
式中，w。为数字域频率。设s用极坐标和实部虚部表示如下式：
xne
xncoswonjsinmon
由于n取整数，下面等式成立：
eaDe
cosw。πMncoswn
sinw。πMnsinwn
上面公式中M取整数，所以对数字域频率而言，正弦序列和复指数序列都是以π为周期
的。在以后的研究中，在频率域只分析研究其主值区ππ或π就够了。
周期序列
如果对所有n存在一个最小的正整数N使下面等式成立：
m为整数 xnxnmN
则称序列xn为周期性序列，周期为N。
例如：
xnsin”
式中数字频率是πn取整数，可以写成下式：
xnsinnsinnπmsinnm m为整数
xnsinn 因此， 是周期为的周期序列，波形如图所示。下面讨论一般正弦
序列的周期性。 第章 ”
n
图 正弦序列 时域离散信号和时域离散系统
设
xnA sinwnφ
那么
xnmNA sinwnmNφA sinwnwmNφ
如果
Created by ZhuangHeng
口
数字信号处理第五版
xnmNxn
则对于m要求Nπwok。式中，k与N均取整数，且k的取值要保证N是最小的
正整数，满足这些条件，正弦序列才是以N为周期的周期序列。
具体正弦序列有以下三种情况：
当πw。为整数时，k正弦序列是以πw。为周期的周期序列。例如，
singn该正弦序列周期为。
πw。不是整数，是一个有理数时，设πw。PQ式中P、Q是互为素数的整
数，取kQ那么NP则该正弦序列是以P为周期的周期序列。例如，sinπn
πwok该正弦序列是以为周期的周期序列。
πw。是无理数，任何整数k都不能使N为正整数，因此，此时的正弦序列不是周
期序列。例如，wosinan即不是周期序列。
对于复数指数序列e的周期性也有和上面同样的分析结果。
以上介绍了几种常用的典型序列，对于任意序列xn可以用单位脉冲序列的移位加
权和表示，即
xn∑xmonm
这种任意序列的表示方法，在信号分析中是一个很有用的公式。例如，xn的波形如图
所示，可以用式表示成：
xnnnnδnn
δnnδn
xn
n
图 用单位脉冲序列移位加权和表示序列
序列的运算
序列的简单运算有加法、乘法、移位、翻转及尺度变换。
加法和乘法
序列之间的加法和乘法，是指它的同序号的序列值逐项对应相加和相乘，如图
所示。
Created by ZhuangHeng
xn xnxn
n n
xn xinxn
n
图 序列的加法和乘法
移位、翻转及尺度变换
序列xn如图a所示，其移位序列xnn。当n。时如图b所示。
当n。时，称为xn的延时序列；当n时，称为xn的超前序列。xn则是xn
的翻转序列，如图c所示。xmn是xn序列每m点取一点形成的序列，相当于n
轴的尺度变换。当m时，其波形如图d所示。
xn xnn
n n
a b
第章
x一n xn
n n
c d 时域离散信号和时域离散系统
图 序列的移位、翻转和尺度变换
时域离散系统
设时域离散系统的输入为xn经过规定的运算，系统输出序列用yn表示。设运算
关系用T·表示，输出与输入之间关系用下式表示：
Created by ZhuangHeng
口
口口
口
数字信号处理第五版
ynTxn
其框图如图所示。
在时域离散系统中，最重要和最常用的是线性时不变
系统，这是因为很多物理过程都可用这类系统表征，在一
定条件下，有些非线性时变系统可以用线性时不变系统近
似。线性时不变系统便于分析、设计与实现。
xn T· yn
图 时域离散系统
线性系统
系统的输入、输出之间满足线性叠加原理的系统称为线性系统。设xn和xn分别
作为系统的输入序列，其输出分别用yn和yn表示，即
ynTxnynTxn
那么线性系统一定满足下面两个公式：
Tznxnynyn
Tarnayn
式表征线性系统的可加性；式表征线性系统的比例性或齐次性，式中a是
常数。将以上两个公式结合起来，可表示成
ynTarnbxnaynbyn
上式中a和b均是常数。
【例】 证明ynaxnba和b是常数所代表的系统是非线性系统。
证明 ynTxnaxnb
ynTxnaxnb
ynTxnxnaxnaxnb
yn≠ynyn
因此，该系统不是线性系统。用同样方法可以证明ynxnsinwn所代表的系统
是线性系统。
时不变系统
如果系统对输入信号的运算关系T·在整个运算过程中不随时间变化，或者说系统
对于输入信号的响应与信号加于系统的时间无关，则这种系统称为时不变系统，用公式表
示如下：
Tcnm
式中n。为任意整数。检查一个系统是否是时不变系统，就是检查其是否满足式。
【例】 检查ynaxnb所代表的系统是否是时不变系统，式中a和b是
常数。
Created by ZhuangHeng
解 ynaxnb
ynnaxnnb
ynnTxnn
因此该系统是时不变系统。
【例】 检查ynnxn所代表的系统是否是时不变系统。
解 ynnxn
ynn。nnxnno
Txnnonxnn
ynn。≠Txnn
因此该系统不是时不变系统。此例从物理概念上可以理解成该系统是一个放大器，放大
器的放大量是n它随n变化，因此是一个时变系统。依同样方法可以证明yn
xnsinwon所代表的系统也是时变系统。
线性时不变系统及其输入与输出之间的关系
线性时不变系统：同时满足线性和时不变特性的系统称为时域离散线性时不变系统。
时域离散系统的零输入响应、零状态响应和完全响应：设n。为初始观察时刻，则可将
系统的输入分为两部分，称 n以前的输入为历史输入信号，称n。及n以后的输入为当前输
入信号简称输入信号。仅由n。时刻的初始状态或历史输入信号引起的响应称为零输入响
应；仅由当前输入信号引起的响应称为零状态响应；将零输入响应与零状态响应之和称为
系统的完全响应。
设系统的输入xnn系统输出yn的初始状态为零，定义这种条件下的系统输
出为系统的单位脉冲响应，用hn表示。换句话说，单位脉冲响应即系统对于δn的零状
态响应。用公式表示为
hnTδn
hn和模拟系统中的单位冲激响应ht相类似，都代表系统的时域特征。
设系统的输入用xn表示，按照式表示成单位脉冲序列移位加权和为
xn∑xmonm
那么系统输出为
ymT∑msnm
根据线性系统的叠加性质
ym∑zxmTLonm
又根据时不变性质
ym∑zmhCnmrnhn
Created by ZhuangHeng
第章
时域离散信号和时域离散系统
数字信号处理第五版
式中的符号“”代表卷积运算，式表示线性时不变系统的输出等于输入序列和该
系统的单位脉冲响应的卷积。计算卷积有三种方法：图解法，解析法，利用MATLAB语言
的工具箱函数计算法。下面先介绍图解法。
图解法
观察式，计算卷积的基本运算是翻转、移位、相乘和相加，这类卷积称为序列
的线性卷积。如果两个序列的长度分别为N和M那么卷积结果的长度为NM。下面
用例题说明如何用图解法计算卷积。
【例】 已知xnRnhnRn求ynxnhn。
yn∑xmhnm∑RmRnm 解
首先将hn用hm表示，并将波形翻转，得到hm如图c所示。然后将
xn
a
n
lxm
b
m
Ihm
c
m
hm
d
m
hm
e
m
yn
f
n
图 例线性卷积
Created by ZhuangHeng
hm移位 n得到hnmn序列右移；n序列左移。如n得到
hm如图d所示。接着将xm和hnm相乘后，再相加，得到yn的一个
值。对所有的n重复这种计算，最后得到卷积结果，如图f所示，yn表达式为
yn
其实这种图解法可以用列表法代替，上面的图解过程如表所示。
表 图解法列表法
xm
hm
hm y
hm y
hm y
hm y
hm y
hm y
hm y
这种列表法的原理和图解法一样，但可以省去作图过程。
解析法
如果已知两个卷积信号的解析表达式，则可以直接按照卷积式进行计算，下面举例
说明。
【例】 设xnaunhnRn求ynxnhn。
解 ynhnzn∑Rma”nm
要计算上式，关键是根据求和号内的两个信号乘积的非零值区间确定求和的上、下限。
因为m≤n时，unm才能取非零值；≤m≤时，Rm取非零值，所以，求和区间中
m要同时满足下面两式：
m≤n
≤m≤
这样求和限与n有关系，必须将n进行分段然后计算。
n时，
yn
≤n≤时，乘积的非零值范围为≤m≤n因此
ynaaa
n≥时，乘积的非零区间为≤m≤因此
ym∑aaa
第章
时域离散信号和时域离散系统
Created by ZhuangHeng
D
口
口
口口
口
数字信号处理第五版
写成统一表达式为
用MATLAB计算两个有限长序列的卷积
MATLAB信号处理工具箱提供了conv 函数，该函数用于计算两个有限长序列的卷积
或计算两个多项式相乘。
CconvAB 计算两个有限长序列向量A和B的卷积。如果向量A和B的长度分
别为N和M则卷积结果向量C的长度为NM。如果向量A和B为两个多项式的系
数，则C就是这两个多项式乘积的系数。应当注意，conv 函数默认A和B表示的两个序列
都是从开始，所以不需要位置向量。当然，默认卷积结果序列C也是从开始，即卷积结
果也不提供特殊的位置信息。例中的两个序列满足上述条件，直接调用conv函数求
解例的卷积计算程序epm如下：
m例的卷积计算程序
xnhn
ynconvxnhn
运行结果：
yn
显然，当两个序列不是从开始时，必须对conv函数稍加扩展。设两个位置向量已知
的序列：xnnxnxsnxfhnnhnhsnhf要求计算卷积：ynhnxn以及
yn的位置向量ny。下面编写计算这种卷积的通用卷积函数convu。
根据卷积原理知道，yn的起始点和终止点分别为：nysnhsnxsnyfnhfnxf。
调用conv函数写出通用卷积函数convu 如下：
function ynyconvuhnhxnx nvu通用卷积函数，y为卷积结果序列向量，
是y的位置向量，h和x是有限长序列，
和nx分别是h和x的位置向量
nysnhnxnyfnhendnxendd 表示最后一个元素的下标
yconvhxnynysnyf
如果hnxnRN则调用convu 函数计算ynhnxn的程序
如下：
honesnh
xhnxnh
y nyconvuhnhxnx
运行结果：
y
Created by ZhuangHeng
ny
线性卷积服从交换律、结合律和分配律。它们分别用公式表示如下：
xnhnhnn
xnhnhnxnhnhn
xnhnhnxnhnxnhn
以上三个性质请读者自己证明。式表示卷积服从交换律。和
式分别表示卷积的结合律和分配律。设hn和hn分别是两个系统的单位脉冲响应，
xn表示输入序列。按照式的右端，信号通过hn系统后再通过hn系统，等
效于按照式左端，信号通过一个系统，该系统的单位脉冲响应为hnhn如
图a、b所示。该式还表明两系统级联，其等效系统的单位脉冲响应等于两系统分
别的单位脉冲响应的卷积。按照式，信号同时通过两个系统后相加，等效于信号
通过一个系统，该系统的单位脉冲响应等于两个系统分别的单位脉冲响应之和，如图
c、d所示。换句话说，系统并联的等效系统的单位脉冲响应等于两个系统分别的
单位脉冲响应之和。
a x hn hn n
b xn
hn hn yn
c xm hn
n
xn d
hn
hnhn n
图 卷积的结合律和分配律
需要再次说明的是，关于系统级联、并联的等效系统的单位脉冲响应与原来两系统分
别的单位脉冲响应的关系，是基于线性卷积的性质，而线性卷积是基于线性时不变系统满
足线性叠加原理和时不变特性。因此，对于非线性或者时变系统，这些结论是不成立的。
再考察式，它也是一个线性卷积式，它表示序列xn与单位脉冲序列的线性
卷积等于序列本身xn
zn∑rmonmxnn
如果序列与一个移位的单位脉冲序列nn。进行线性卷积，就相当于将序列本身移位 n。
n。是整常数如下式表示：
ynannn∑xmnn。m
上式中求和项只有当mnn。时才有非零值，因此得到：
xnnnxnn
Created by ZhuangHeng
第章
时域离散信号和时域离散系统
数字信号处理第五版
【例】 在图中，hn系统与hn系统级联，设
xnun
hnδnδn
hnaun la
求系统的输出yn。
xn mn hn hn n
图 例框图
解 先求第一级的输出mn再求yn。
mnxnhn
unnδn
unδnunδn
unun
Rn
ynmnhn
Rnaun
由例的计算结果知道：
n
≤n≤
≤n
系统的因果性和稳定性
一般因果系统定义：
如果系统 n时刻的输出只取决于n时刻以及n时刻以前的输入序列，而和n时刻以后
的输入序列无关，则称该系统具有因果性质，或称该系统为因果系统。如果n时刻的输出
还取决于n时刻以后的输入序列，在时间上违背了因果性，系统无法实现，则系统被称为
非因果系统。因此系统的因果性是指系统的可实现性。
线性时不变系统具有因果性的充分必要条件：
系统的单位脉冲响应满足下式：
hn n
满足式的序列称为因果序列，因此因果系统的单位脉冲响应必然是因果序列。因
果系统条件式从概念上也容易理解，因为单位脉冲响应是输入为n的零状态响
应，在n时刻以前即n时，没有加入信号，输出只能等于零，因此得到因果性条件
式。
Created by ZhuangHeng
一般稳定系统定义：
如果对有界输入，系统产生的输出也是有界的，则称该系统具有稳定性，或称该系统
为稳定系统。
线性时不变系统稳定的充分必要条件：
系统的单位脉冲响应绝对可和，用公式表示为
∑IhnI○
证明 先证明充分性。
yn∑hkxnk
lynhCAxnk
因为输入序列xn有界，即
lxnB∞n∞B为任意常数
因此
l yn ≤B∑ hk
如果系统的单位脉冲响应满足式，那么输出yn一定也是有界的，即
Iyn
下面用反证法证明其必要性。如果hn不满足式，即
总可以找到一个或若干个有界的输入来引起无界的输出，例如：
∑Ihn∞那么
yn∑hkxnA
令n有
yO∑hAxkZhkhk
∑IhkI 第章时域离散信号和时域离散系统
上式说明n时刻的输出为无界，系统不稳定，证明了式条件的必要性。
应当注意：线性时不变系统因果稳定性的判断方法仅适用于线性时不变系统，所以，
利用该方法判定系统是否因果稳定时，首先必须确定系统是线性时不变的。而一般因果稳
定系统的定义适用于判定任何系统。
【例】 设系统的输入输出关系方程为yne试分析该系统的因果稳定性。
解 因为yn只与xn有关，与n时刻以后的输入无关，所以，根据一般因果系统的
Created by ZhuangHeng
数字信号处理第五版
定义，该系统是因果系统。
如果xnA则eyne所以，根据一般稳定系统定义，该系统是稳定系统。
值得注意：如果不加判断，直接利用线性时不变系统因果稳定性的充分必要条件求证，
就会得出如下错误的结论：
令xnn代入系统差分方程得到hne当n时，hne°≠由
此得出结论，该系统是非因果系统。
∑Ihn∑e∞所以，该系统是不稳定系统。 又因为
之所以得出错误结论，是因为线性时不变系统因果稳定性的充分必要条件只适用于线
性时不变系统。但对该系统
Taxrnbxnehme·e
Tarn·Tbxn
≠aTxnbTxn
显然是非线性系统，不能用线性时不变系统因果稳定性的充分必要条件求证。此例说明，
应用性质和定理时，一定要注意其适用范围。
【例】 设线性时不变系统的单位脉冲响应hnaun式中a是实常数，试
分析该系统的因果稳定性。
解 由于n时，hn因此系统是因果系统。
∑ThnIalmalma
只有当a时，才有
∑Thna
因此系统稳定的条件是a否则，a≥时，系统不稳定。系统稳定时，hn的模值
随n加大而减小，此时序列hn称为收敛序列。如果系统不稳定，hn的模值随n加大而
增大，则称为发散序列。
【例】 设系统的单位脉冲响应hnun求对于任意输入序列xn的输出
yn并检验系统的因果性和稳定性。
解 hnun
ynxnhn∑xkunk
因为当nk时，unknk≥时，unk因此，求和限为k≤n所以
ym∑xA
上式表示该系统是一个累加器，它将输入序列从加上之时开始，逐项累加，一直加到n时
刻为止。
下面分析该系统的稳定性：由于
Created by ZhuangHeng
∑Thn∑an
因此该系统是一个不稳定系统。显然，该系统是一个因果系统。
根据以上介绍的稳定概念，可以通过检查系统单位脉冲响应是否满足绝对可和的条件
来判断线性时不变系统是否稳定。实际中，如何用实验信号测定系统是否稳定是一个重要
问题，显然，不可能对所有有界输入都检查是否得到有界输出。可以证明只要用单位
阶跃序列作为输入信号，如果稳态输出趋于常数包括零则系统一定稳定，否则系统不
稳定。不必要对所有有界输入都进行实验。
时域离散系统的输入输出描述法——线性常系数差分方程
描述一个系统时，可以不管系统内部的结构如何，将系统看成一个黑盒子，只描述或
者研究系统输出和输入之间的关系，这种方法称为输入输出描述法。对于模拟系统，我们
知道由微分方程描述系统输出输入之间的关系。对于时域离散系统，则用差分方程描述输
出输入之间的关系。线性时不变系统用线性常系数差分方程来描述。本节主要介绍这类差
分方程及其解法。差分方程均指线性常系数差分方程，本书中不另说明。
线性常系数差分方程
一个N阶线性常系数差分方程用下式表示：
ymZbxcniasn
或者
∑asycn∑bxn a
式中，xn和yn分别是系统的输入序列和输出序列，a和b均为常数，式中yni和
xni项只有一次幂，也没有相互交叉相乘项，故称为线性常系数差分方程。差分方程的
阶数是用方程yni项中i的最大取值与最小取值之差确定的。在式中，yni
项i最大的取值为Ni的最小取值为零，因此称为N阶差分方程。
线性常系数差分方程的求解 第章时域离散信号和时域离散系统
已知系统的输入序列，通过求解差分方程可以求出输出序列。求解差分方程的基本方
法有以下三种：
经典解法。这种方法类似于模拟系统中求解微分方程的方法，它包括齐次解与特
解，由边界条件求待定系数，较麻烦，实际中很少采用，这里不作介绍。
递推解法。这种方法简单，且适合用计算机求解，但只能得到数值解，对于阶次较
高的线性常系数差分方程不容易得到封闭式公式解答。
Created by ZhuangHeng
口口□口
口
数字信号处理第五版
变换域方法。这种方法是将差分方程变换到z域进行求解，方法简便有效，这部分
内容放在第章学习。
当然还可以不直接求解差分方程，而是先由差分方程求出系统的单位脉冲响应，再与
已知的输入序列进行卷积运算，得到系统的输出。但是系统的单位脉冲响应如果不是预先
知道，仍然需要求解差分方程，求其零状态响应解。
本节只介绍递推法，其中包括如何用MATLAB求解差分方程。
观察式，求n时刻的输出，要知道n时刻以及n时刻以前的M个输入序列值，
还要知道n时刻以前的N个输出序列值初始条件。因此求解差分方程在给定输入序列的
条件下，还需要确定N个初始条件。以上介绍的三种基本解法都只能在已知N个初始条件
的情况下，才能得到唯一解。如果求n。时刻以后的输出，n。时刻以前的N个输出值
yn。、yn。、…、yn。N就构成了初始条件。
式表明，已知输入序列和N个初始条件，则可以求出n时刻的输出；如果将该
公式中的n用n代替，可以求出n时刻的输出，因此式表示的差分方程本身
就是一个适合递推法求解的方程。
【例】 设因果系统用差分方程ynaynxn描述，输入序列xn
δn求输出序列yn。
解 该系统差分方程是一阶差分方程，需要一个初始条件。
设初始条件为y则递推得到：
ynaynxn
n时，yay
n时，yaya
n时，yaya
…
nn时，yna
ynaun
设初始条件为y则递推得到：
n时，yaya
n时，yayaa
n时，yayδaa
……
nn时，ynaa
ynaaun
该例表明，对于同一个差分方程和同一个输入信号，因为初始条件不同，得到的输出
信号是不相同的。
对于实际系统，用递推解法求解，总是由初始条件向n的方向递推，是一个因果
解。但对于差分方程，其本身也可以向n的方向递推，得到的是非因果解。因此差分方
Created by ZhuangHeng
程本身不能确定该系统是因果系统还是非因果系统，还需要用初始条件进行限制。下面就
是向方向n递推的例题。
【例】 设差分方程为
xnδnynn ynaynxn
求输出序列yn。
解 ynaynδn
n时，yay
n时，yaya
n时，yaya
……
nn时，yna
将n用n代替，得到：
ynaun
这确实是一个非因果的输出信号。用差分方程求系统的单位脉冲响应，由于单位脉冲响应
是当系统输入δn时的零状态响应，因此只要令差分方程中的输入序列为δnN个初始
条件都为零，其解就是系统的单位脉冲响应。实际上例题中求出的yn就是该系
统的单位脉冲响应，例题求出的yn则是一个非因果系统的单位脉冲响应。
最后要说明的是，一个线性常系数差分方程描述的系统不一定是线性非时变系统，
这和系统的初始状态有关。如果系统是因果的，一般在输入xnnn。时，则输出
ynnn系统是线性非时变系统。
下面介绍用MATLAB求解差分方程。
MATLAB信号处理工具箱提供的 filter 函数实现线性常系数差分方程的递推求解，调
用格式如下：
ynfilterBAxn
计算系统对输入信号向量xn的零状态响应输出信号向量ynyn与xn长度相等，其中，B
和A是式所给差分方程的系数向量，即
Bbb…bMAaa…an
其中a。如果a。≠则 filter用a。对系数向量B和A归一化。
ynfilterBAxnxi
计算系统对输入信号向量xn的完全响应输出信号yn。其中，xi是等效初始条件的输入序
列，所以xi是由初始条件确定的。MATLAB信号处理工具箱提供的filtic就是由初始条件
计算 xi的函数，其调用格式如下：
第章时域离散信号和时域离散系统
xifilticBAysxs
其中，ys和xs是初始条件向量：ysyyy…yNxs
xxx…xM。如果xn是因果序列，则xs调用时可缺
省xs。
Created by ZhuangHeng
口
口
口
口
口
口口
数字信号处理第五版
例的MATLAB求解程序epm如下：
m调用 filter解差分方程ynaynxn
差分方程系数a初始状态：y ays
xnzerosn单位脉冲序列，长度N
BAa 分方程系数
xifilticBAys 初始条件计算等效初始条件的输人序列xi
ynfilterBAxnxi用filter解差分方程，求系统输出信号yn
nlengthyn
subplotstemnyn
titleaxlabelnylabelyn
程序中取差分方程系数a时，得到系统输出yn如图a所示，与例的
解析递推结果完全相同。如果令初始条件y仅修改程序中ys则得到系统输
出ynhn如图b所示。
yn hn
n n
a b
图 例求解程序输出波形
模拟信号数字处理方法
在绪论中已介绍了数字信号处理技术相对于模拟信号处理技术的许多优点，因此人们
往往希望将模拟信号经过采样和量化编码形成数字信号，再采用数字信号处理技术进行处
理；处理完毕，如果需要，再转换成模拟信号。这种处理方法称为模拟信号数字处理方法，
其原理框图如图所示。图中的预滤波与平滑滤波所起的作用在后面介绍。本节主要
介绍采样定理和采样恢复。
x 预滤波 ADC 数字信号处理 DAC 平滑滤波 y
图 模拟信号数字处理框图
采样定理及AD变换
对模拟信号进行采样可以看做一个模拟信号通过一个电子开关S。设电子开关每隔周
Created by ZhuangHeng
期T合上一次，每次合上的时间为trT在电子开关输出端得到其采样信号xt。该
电子开关的作用等效成一宽度为z周期为T的矩形脉冲串prt采样信号t就是
xt与pt相乘的结果。采样过程如图a所示。如果让电子开关合上的时间
→则形成理想采样，此时上面的脉冲串变成单位冲激串，用pat表示。pt中每个单
位冲激处在采样点上，强度为理想采样则是xt与pt相乘的结果，采样过程如图
b所示。用公式表示为
pa∑nT
tzp∑znT
上式中t是单位冲激信号，在上式中只有当tnT时，才可能有非零值，因此写成下式：
z∑znTnT
xt 金， xa
s × 金
PTp
x xa
P P
T T
T
念
在
上 A
a b
图 对模拟信号进行采样
下面研究理想采样前后信号频谱的变化，从而找出为了使采样信号能不失真地恢复原
模拟信号，采样速率FFT与模拟信号最高频率f。之间的关系。
我们知道在傅里叶变换中，两信号在时域乘积的傅里叶变换等于两个信号分别的傅里
叶变换的卷积除以π按照式，推导如下：
设
第章
时或离改言号和时域离敬系统
Created by ZhuangHeng
口
数字信号处理第五版
XGjFTrt
XjFTxt
PjΩFTpt
对式进行傅里叶变换，得到
Pi∑maBQa
式中，ΩπT称为采样角频率，单位是rads。
a÷emd云
因此
PGia经∑akD
根据傅里叶变换的频域卷积定理有
XjDxGjnPGj
·经xGo∑Qkde
÷zxjOkade
÷∑xinjA
上式表明理想采样信号的频谱是原模拟信号的频谱沿频率轴，每间隔采样角频率Ω重复
出现一次，并叠加形成的周期函数。或者说，理想采样信号的频谱是原模拟信号的频谱以
Ω为周期，进行周期性延拓而成的。
在图中，设x。t是带限信号，最高频率为其频谱Xj如图a所
示。pt的频谱Pj如图b所示，那么按照式，t的频谱Xj如图
c所示，图中原模拟信号的频谱称为基带频谱。如果满足Ω≥Ω或者用频率表示
该式，即满足F≥f。基带谱与其他周期延拓形成的谱不重叠，如图c所示情况，
可以用理想低通滤波器Gj从采样信号中不失真地提取原模拟信号，如图所示。
但如果选择采样频率太低，或者说信号最高截止频率过高，使FfXGj按照采样频
率F周期延拓时，形成频谱混叠现象，用图d表示。这种情况下，再用图所
示的理想低通滤波器对xt进行滤波，得到的是失真了的模拟信号。用公式表示如下：
aa
YjFTytXGj·GGj
Created by ZhuangHeng
y。tFTY
n≤ a ytxt
aa yt≠xt
这里需要说明的是，一般频谱函数是复函数，相加应是复数相加，图和图
仅是示意图。一般称F为折叠频率，只有当信号最高频率不超过F时，才不会产生
频率混叠现象，否则超过F的频谱会折叠回来而形成混叠现象，因此频率混叠在F
附近最严重。
x
a
GGO y
a Q Q 口
PG ×GD
b b Q Q O
×G GGO
c R Q Q
e WT WT 口
GO XG
d Q QQ Q
d
Q
图 采样信号的频谱 图 采样恢复
总结上述内容，采样定理叙述如下：
对连续信号进行等间隔采样形成采样信号，采样信号的频谱是原连续信号的频谱
以采样频率为周期进行周期性的延拓形成的，用公式表示。
设连续信号xt属带限信号，最高截止频率为Ω如果采样角频率Ω≥Ω那
么让采样信号xt通过一个增益为T、截止频率为ΩπT的理想低通滤波器，可以唯
一地恢复出原连续信号xt。否则，ΩΩ。会造成采样信号中的频谱混叠现象，不可能
无失真地恢复原连续信号。
第章时域离散信号和时域离散系统
实际中对模拟信号进行采样，需根据模拟信号的截止频率，按照采样定理的要求选择
采样频率，即Ω≥Ω但考虑到理想滤波器GjΩ不可实现，要有一定的过渡带，为此可
选ΩaΩa。另外，可以在采样之前加一抗混叠的低通滤波器，滤除高于Ω
的一些无用的高频分量和其他的一些杂散信号。这就是在图中采样之前加预滤波的
原因。
Created by ZhuangHeng
口
■口 口
口
口口
□口
■口
a口
数字信号处理第五版
上面我们通过对模拟信号进行理想采样分析推导出采样定理。采样定理表示的是采样
信号xt的频谱与原模拟信号xt的频谱之间的关系，以及由采样信号不失真地恢复原
模拟信号的条件。要进一步说明的是，采样信号用式表示，它是用一串延时的单位
冲激加权和表示的。按照该式，在tnT时，即在每个采样点上，采样信号的强度幅度准
确地等于对模拟信号的采样值xnT而在t≠nT非采样点上采样信号的幅度为零。时域
离散信号序列xn只有在n为整数时才有定义，否则无定义，因此采样信号和时域离散
信号不相同。但如果序列是通过对模拟信号采样得到的，即xnxnT序列值等于采
样信号在tnT时的幅度，在第章将通过分析时域离散信号的频谱，得到此时序列的频
谱依然是模拟信号频谱的周期延拓，因此由模拟信号通过采样得到序列时，依然要服从采
样定理，否则同样也会产生频谱混叠现象。
将模拟信号转换成数字信号由模数转换器AnalogDigital ConverterADC完成，
模数转换器的原理框图如图所示。通过按等间隔T对模拟信号进行采样，得到一串
采样点上的样本数据，这一串样本数据可看作时域离散信号序列。设ADC有M位，那
么每个样本数据用M位二进制数表示，即形成数字信号。因此，采样以后到形成数字信号
的这一过程是一个量化编码的过程。例如：模拟信号xtsinπftπ式中f
Hz选采样频率F Hz将tnT代人xt中，得到采样数据：
xnTsinπfnT T青
sinπ
sinm
当n……时，得到序列xn如下：
rn… …
xn x 采样 量化编码 n
图 模数转换器原理框图
如果ADC按照M进行量化编码，即上面的采样数据均用位二进制码表示，其中一位
为符号位，则数字信号用n表示：
xn……
用十进制数表示的in为
xn… …
显然量化编码以后的xn和原xn不同。这样产生的误差称为量化误差，这种量化误差的
影响称为量化效应，这部分内容将在第章介绍。
将数字信号转换成模拟信号
我们已经知道模拟信号xt经过理想采样，得到采样信号xx和云t之间
Created by ZhuangHeng
的关系用式描述。如果选择采样频率F、满足采样定理，t的频谱没有频谱混叠
现象，可用一个传输函数为GGjΩ的理想低通滤波器不失真地将原模拟信号xt恢复出
来，这是一种理想恢复。下面先分析推导该理想低通滤波器的输入和输出之间的关系，以
便了解理想低通滤波器是如何由采样信号恢复原模拟信号的，然后再介绍在实际中数字信
号如何转换成模拟信号。
下面由式表示的低通滤波器的传输函数Gj推导其单位冲激响应gt
g元厂GGiaednTedasinC
因为ΩπFπT因此gt也可以用下式表示：
gsinzT
理想低通滤波器的输人、输出分别为xt和yt
vtigtizgzdr
将式表示的gt和式表示的xt代入上式，得到：
v∑znTSrnTgtzdr
xnTδrnTgtzdr
znTgtnT
znTsiacTT
由于满足采样定理，ytxt因此得到：
zt∑xnTinrrnTTT
式中，当n……时，xnT是一串离散的采样值，而xt是模拟信号，t
取连续值，gt的波形如图所示。其特点是：t时，gtnTn≠时，
gt。在式中，gt保证了在各个采样点上，即tnT时，恢复的xt等于原
采样值，而在采样点之间，则是各采样值乘以gtnT的波形伸展叠加而成的。这种伸展
波形叠加的情况如图所示。gt函数所起的作用是在各采样点之间内插，因此称为
g
T T
T t
图 内插函数g波形
第章
时域离散信号和时域离散系统
Created by ZhuangHeng
数字信号处理第五版
内插函数，而式则称为内插公式。这种用理想低通滤波器恢复的模拟信号完全等于
原模拟信号xt是一种无失真的恢复。但由于gt是非因果的，因此理想低通滤波器是
非因果不可实现的。
xn
TTO T T T
xTgt
石
xDgtD
O
xg
xTgtT
石
xDgt
O
xg
O
x
图 理想恢复
下面介绍实际的数字信号到模拟信号的转换。
实际中采用DACDigitalAnalog Converter完成数字信号到模拟信号的转换。DAC包
括三部分，即解码器、零阶保持器和平滑滤波器，DAC方框图如图所示。解码器的
作用是将数字信号转换成时域离散信号xnT零阶保持器和平滑滤波器则将xnT变
Created by ZhuangHeng
成模拟信号。
xn 解码器 xnD 零阶保持器 x 平滑滤波器 xa
图 DAC方框图
由时域离散信号xnT恢复模拟信号的过程是内插的过程。理想低通滤波的方法是用
gt函数作内插函数，还可以用一阶线性函数作内插。零阶保持器是将前一个采样值进行
保持，一直到下一个采样值来到，再跳到新的采样值并保持，因此相当于进行常数内插。零
阶保持器的单位冲激函数ht以及输出波形如图所示。对ht进行傅里叶变换，得
到其传输函数：
HGhDededTsinCTe
xnD h⑩
T TT T T
X
T TTT
图 零阶保持器的输出波形
其幅频特性和相频特性如图所示。由该图看到，零阶保持器是一个低通滤波器，能
IIHG
T
πT πT WT πT wT
argHG
π
πT πT
πT πT Q
一
图 零阶保持器的频响特性
第章时域离散信号和时域离散系统
Created by ZhuangHeng
口口
口口
口
口口
口口
口
数字信号处理第五版
够起到将时域离散信号恢复成模拟信号的作用。图中虚线表示理想低通滤波器的幅度特
性。零阶保持器的幅度特性与理想低通滤波器有明显的差别，主要是在ΩπT区域有
较多的高频分量，表现在时域上，就是恢复出的模拟信号是台阶形的。因此需要在DAC
之后加平滑低通滤波器，滤除多余的高频分量，对时间波形起平滑作用，这也就是在图
模拟信号数字处理框图中，最后加平滑滤波器的原因。虽然这种零阶保持器恢复的
模拟信号有些失真，但简单、易实现，是经常使用的方法。实际中，将解码器与零阶保持器
集成在一起，就是工程上的DAC器件。
确定性信号的相关函数
在检测技术中，相关检测已经发展成一个独立的分支，并引起人们的广泛关注。相关
函数的估计和计算是经典谱估计和现代谱估计的基础。相关函数是与卷积十分类似的数学
运算。与卷积运算一样，相关函数也涉及两个信号序列。但卷积主要关心对其中一个信号
的处理功能和处理效果，例如去除其中的干扰噪声。而相关运算是研究两个信号的相似性，
或一个信号经过延迟后与原信号的相似性，以实现对信号的检测、识别与信息提取。
本节主要介绍确定性信号的相关函数的定义、性质与应用。但在实际中，相关函数是
描述随机信号的重要统计量，在随机信号的分析与处理中有着重要作用。
信号的互相关函数和自相关函数
定义
ram∑xnsnm
为信号xn和yn的互相关函数①。从式可见，将xn保持不动，若yn右移m
个采样周期，则得到ynm再将xn与ynm相乘并求和，则得到rm在m时刻
的值。rm反映了xn与ynm两个波形的相似程度。
与序列卷积运算相比较，相关运算仅缺少了将yn翻转变成yn的步骤，其他运算
过程完全相同。所以
rmxnyn
因此，用于卷积的计算过程和程序都可以直接用于计算序列的相关函数。将yn翻转变成
yn再调用卷积函数计算xmym则得到xn和yn的互相关函数rm。
如果式中ynxn则上面定义的互相关函数即变成xn的自相关函数，
记为rm即
rm∑xnynm ① 互相关函数也可以定义为， 二者本质上是相同的。式更便于工程
上借用卷积算法和程序进行计算。
Created by ZhuangHeng
ram∑xnnm
自相关函数表示了信号xn与其自身移位后的xnm的相似程度。为了表示简单，
一般将自相关函数记为rm。
r∑n一E
式说明，r表示xn的能量，记为E。当E时，信号xn称为能量信号；
当E时，信号xn称为能量无限信号。对能量无限信号，我们主要研究其平均功率。
信号xn的功率定义为
PlmNIz
当Po时，称 xn为功率信号。功率信号是工程实际和理论研究中的常用信号，如周期
信号。
当输入序列是有限长序列，或只能获得无限长序列的有限个序列值时，通常将互相关
函数和自相关函数表示成有限和的形式。特别是当xn和yn是长度为N的因果序列时，
互相关函数和自相关函数可以表示为
rnvnmm
n
m
m 为其他值
m 为其他值
上述对相关函数的定义都是针对实信号的，如果xn和yn是复信号，其相关函数也
是复信号，此时定义式和式应该为
rm∑znynm
rmananm
在后面的讨论中，如果不做特别说明，xn和yn一律都视为实信号。
【例】 设信号为xnauna。求其自相关函数。
解 由于xn是无限时宽的，所以rm也是无限时宽的。下面分m≥和m两种
情况来求解。
当m≥时，由图可见：
第章时域离散信号和时域离散系统
Created by ZhuangHeng
数字信号处理第五版
rm∑nxnm∑araa∑a
因为a无限级数收敛，所以有
rma∑a° m≥
xn
… … n
a
xnm
m
m n
b
m
xnm
m
册
c
nm
…… m
d
图 信号xnaun的自相关函数运算示意图
当m时，由图可见：
rm∑nrnm∑aaa∑a m
因为m时，aa于是，rm的上述两段表示式可以合并为
rm ∞m
自相关函数rm如图所示。由图可以观察到，rm是偶对称函数，即rm
rm。后面会证明，自相关函数都是偶函数。
【例】 已知序列xn和yn分别为
xn……
yn……
求xn和yn的互相关函数r。m。
Created by ZhuangHeng
解 序列xn和yn均为有限长序列，但不是因果序列，所以不能直接套用式
必须用式计算。
r。m∑xnyn乘积序列 当m时，
vnxnyn……
对于n的所有值，对乘积序列各项求和，可得
ram∑un
当m时，只要将yn相对xn向右平移m个时间单位，得到ynm再计
rm∑vn可得 算乘积序列vnxnynm最后求
r。r。r。r
r。r。rmm≥
当m时，只要将yn相对xn向左平移m个采样间隔，再进行同样的计算
可得
r。r rr
rr。rrmm≤
综上可得xn和yn的互相关函数r。m为
rm
周期信号的相关性
在节中定义了能量信号的互相关函数和自相关函数。在工程实际中，常常涉及
功率信号的相关性。下面讨论功率信号，特别是周期信号的相关性。
设xn和yn是两个功率信号，其互相关函数定义为
rammNwynm
当ynxn时，功率信号的自相关函数定义为
rmN∑nxcnm
特别是，如果xn和yn是两个周期为N的周期信号，则式和式中有
限区间上的平均值就等于一个周期上的平均值，因此，式和式就可以简
化为
ram、xynm
rm六znanm
Created by ZhuangHeng
第章时域离散信号和时域离散系统
由周期信号的定义可得
口
口 口口
数字信号处理第五版
mN÷xnzcnmM÷cnmm
所以，周期为N的周期信号的自相关函数也是以N为周期的。这样，如果一个周期信号的
周期未知，我们可以根据其自相关函数的周期性质，估计其周期。
【例】 已知xnsinwn其周期为N即wπN求xn的自相关函数。
解 由式得
rm六sinansinunm
六sinanLsincancoscmcosun sincm
osamsinansincamZsinconcsun
由于第二项中 sinancosan第一项中
sinan≥cosmn
所以
rmcosam
由此可见，正弦序列的自相关函数是同频率的余弦序列，显然自相关函数与原序列周
期相同。
相关函数的性质
互相关函数和自相关函数都有很重要的性质，这些性质可以使很多问题的分析和判断
更加简单。本节中，假设两个信号xn和yn均为能量信号，其能量分别为r
∑xnE和r∑ynE
互相关函数性质
rm不是偶函数，而且rm≠rm但有
r。mrm
ram∑anynm∑zkmyk∑yexkmrm 证明
rm满足
r。m≤√rr√EE
证明 生成线性组合序列
Created by ZhuangHeng
arnbynm
其中，a和b为任意常数，m为整数表示延时。该线性组合序列的能量可以表示为
∑CarmbynmPamb∑ynmb ansnm
arbrabr。m
我们知道能量是非负的，所以下式成立：
arbrabr。m≥
假设b≠则式两边除以b得
r号r。m号r≥
方的一元二次方程，其三个系数分别为 r、r。m和r。由于方 把上式看成关于
程非负，所以二次判别式非正，即
rmrr≤
由上式可得互相关函数满足的条件：
r。m≤VrOr√EE
如果互相关函数中任一信号或两个信号的幅度增大或缩小，其互相关函数的形状不会
改变，只是其幅度随之发生变化。由于相关函数幅度并不重要，所以为了检测判决方便，实
际中通常把互相关函数和自相关函数归一化到上。为此，定义归一化互相关函数为
e。mOVEE
rm满足
limrm
式说明，将yn相对xn移至无穷远处，则二者无相关性。这是因为一般能
量信号都是有限非零时宽的，所以当m→∞时，xn和ynm的非零区不重叠，则式
成立。
自相关函数性质
若xn是实信号，rm是实偶函数，即
rmrm
当式中ynxn时，即可得式。若xn是复信号，则rm是共轭对
称函数，即rmrm。
rm在m时取得最大值，即r≥rm。
证明 令式中ynxn则rm≤√rrr因此满足
r≥rm。
同理，定义归一化自相关函数为
emmEm
对于能量信号xn将xn相对自身移至无穷远处，则二者不相关。即
Created by ZhuangHeng
第章
时域离散信号和时域离散系统
数字信号处理第五版
limrm
输入信号与输出信号的相关函数
下面讨论时域离散线性时不变系统输出信号与输入信号的互相关函数。假设系统输入
信号xn的自相关函数rm已知，系统单位脉冲响应为hn系统输出信号为
ynhnzn∑hkznk
由式可知，输出信号与输入信号的互相关函数可表示为
rmymxmhmxmxm
hmxmxm
hmrm
由式可见，输出信号与输入信号的互相关函数等于系统单位脉冲响应hm
与输入信号自相关函数rm的卷积。所以，rm可以看成线性时不变系统对输入序列
rm的响应输出，如图所示。
rm rnm LTI系统
图 rm的输入与输出关系
在式中令xnyn再利用卷积的性质，可以得到系统输出信号的自相关
函数rm
rmymymhmxmhmxm
hmhmxmxm
rmrm
hm
如果系统稳定，则hn为能量信号，rm存在。这样，如果rm存在，则rm存
在，即输出信号也是能量信号。在式中令m可得输出信号的能量为
∑rnrn
式以相关函数的形式给出了输出信号的能量。实际上，本节所得输入信号与输出
信号的相关函数关系式对于能量信号和功率信号都适用。
相关函数的应用
如前所述，相关运算用来衡量两个信号之间的相似程度，并提取相关的有用信息。相
关函数的应用很广，在雷达、声呐、数字通信、地质和其他科学和工程领域的信号的相关性
分析中都有广泛的应用，例如噪声中信号的检测、信号中隐含周期性的检测、信号相关性
的检测、信号延时时间的测量等。
相关函数在雷达和主动声呐系统中的的应用
假设信号序列xn和yn是我们需要比较的两路信号，在雷达和主动声呐系统中，
Created by ZhuangHeng
xn一般是发射信号的采样，而yn表示接收端AD变换器输出的信号。如果目标是某
个被雷达或声呐搜索的物体，则接收信号yn由发射信号被目标反射，并经加性噪声污染
后的延迟信号组成。雷达目标检测示意图如图所示。
图 雷达目标检测示意图
接收信号yn可以表示为
ynaxnDwn
其中，a是衰减因子，表示发射信号xn在发射信道和反射信道中的损耗；D是延迟量假
设D为采样间隔的整数倍wn表示天线接收到的加性噪声以及接收机前端电子器件或
放大器产生的噪声。如果在雷达或声呐搜索空间没有目标，则接收信号yn仅含有噪声信号
wn。
通常称xn为发射信号或参考信号，称yn为接收信号或观测信号。雷达探测的目的
是通过比较xn和yn判断目标是否存在。如果存在，则通过求延迟D来确定目标的距
离。工程实际中，由于加性噪声的污染严重，已经不可能从yn的波形判断目标是否存在，
而相关函数却提供了良好的检测方法。接收信号与发射信号的相关函数为
ram∑ynrnm∑arnDunanm
∑arnDanmZunxnm
armDrm
由于信号xn与噪声wn的相关性很小，即rm非常小，所以当目标不存在时，无反
射信号，rmrm≈当目标存在时，rm≈armD当mD时，rm取
得最大值，rmrD≈araE。这时雷达检测到目标，并根据rm取得最大
值时的m值换算出目标距离。
使用相关函数检测物理信号隐含的周期性
在实际应用中，自相关函数可以用来检测被随机噪声污染的观测物理信号yn隐含的
周期性。
假设
第章时域离散信号和时域离散系统
ynxnwn
Created by ZhuangHeng
数字信号处理第五版
其中，xn是一个未知周期N的周期信号，wn表示加性随机干扰噪声。假定观测到yn
的M个采样值，观测区间为≤n≤M且MN。实际计算时，可以将yn看作长度
为M的因果序列，并引入归一化因子M则yn的自相关函数为
m六ynynm
六ZznucnJrnmunm
mZznxnm六Zrnucnm
ucnanmmucnunm
rmrmrmrm
式等号右边有四项，第一项为xn的自相关函数rm由于xn是周期序列，
所以rm也是周期序列，且周期与xn的周期相同，因而在mNN…时，rm
会周期性地出现较大峰值。但随着m接近M值，峰值会逐渐减小，这是因为yn是长度为
M的有限长序列，当m接近M值时，乘积序列xnxnm中大多数点为零。因此，当
mM时，通常就不再计算了。
设计时，一般使信号xn与干扰噪声wn完全不相关，所以式右边的
rm和rm相对很小。式等号右边第四项为干扰噪声的自相关函数rm
由于干扰噪声wn一般近似于白噪声，所以只有在m时出现峰值r但会迅速衰
减到很小。所以当m时，只有rm会周期性地出现较大峰值，根据这一特点，我们就
可以从干扰噪声中检测出yn中是否存在周期信号xn并确定其周期N。
【例】 设信号xnsinπn≤n≤xn与加性噪声wn混合在一
起，wn是在AA上均匀分布的白噪声序列，A为分布参数。观测序列是yn
xnwn。求自相关函数rm并确定信号xn的周期。
解 本例中，假设仅知道已被噪声污染的观测信号yn的个采样值，而且yn中
包含一周期信号xn但并不知道其周期是多少。现在要通过计算yn的自相关函数确定
xn的周期。噪声wn的功率P。由分布参数A决定，由本书节的式b可
知，PA信号xn的功率P因此信噪比SN为
春一是
通常，SN以对数表示：SNlgPP单位为dB。当SNlgPP
dB时，A√当SNlgPPdB时，A√°。
在节中，将编写程序epm并运行，可产生SN dB时的噪声wn、观
测信号ynxnwn和yn的自相关函数rm分别如图a、b和c所
示；SNdB时的噪声 wn、观测信号ynxnwn和yn的自相关函数
Created by ZhuangHeng
rm分别如图a、b和c所示。
a m然
n
b n
n
c mr
m
图 干扰噪声、观测信号和观测信号自相关函数波形SN dB
a
n
b fn
n
c r用
m
图 干扰噪声、观测信号和观测信号自相关函数波形SN dB
从图b可看出，由于受到干扰噪声影响，很难由观测信号yn直接确定xn
的周期。但从图c可看出，除了m处出现很大峰值以外，rm是以为周期
的，这正是yn中周期信号xn的自相关函数导致的，所以可以确定xn的周期为。
r的峰值是由白噪声wn的自相关函数导致的。
从图b可看出，即使噪声功率较小，观测信噪比达到dB也很难直接由观测
信号yn确定xn的周期，但观察yn的自相关函数却很容易确定xn的周期。
第章时域离散信号和时域离散系统
另外，MATLAB中的 rand 函数每次运行产生的随机信号可能不相同，所以程序
epm每次运行时产生的wn和yn波形可能不相同。
用MATLAB计算相关函数
MATLAB包含多个可以产生各种常用信号的工具箱函数，例如 rand和 randn 函数可
Created by ZhuangHeng
数字信号处理第五版
以产生两种白噪声序列。此外，MATLAB还包含多个实现各种计算的函数，例如与本节有
关的xcorr函数可以计算相关函数。下面先介绍rand 函数和xcorr 函数，最后编写程序求
解例。
rand函数
rand 函数用于产生均值为幅度在上均匀分布的伪随机序列，在数字信号处
理中常用于模拟近似均匀分布的白噪声信号wn。理想的白噪声信号wn的功率谱是一
个常数，其自相关函数r。maom即仅在m时rm有值，m取其他值时rm
皆为零。其中，是wn的方差，即wn的平均功率：
六ucnmJ
式中m。表示wn的均值。rand 函数产生的wn的功率cm。
rand函数的调用格式如下：
· wrandN生N维列向量w
·wrandMN生M×N维矩阵w
请读者注意，另一个函数 randn可产生均值为方差功率为服从高斯分布的白
噪声，其调用格式与rand函数相同。
xcorr 函数
xcorr函数用于计算信号的互相关函数或自相关函数。xcorr函数的两种调用格式
如下：
· rxy xcorrxy算序列x和y的互相关函数
如果x和y的长度都是N则r。的长度为N如果x和y的长度不相等，则将短
的序列后面补零，再按照长度相等方法计算。
·rxxcorrxMflag算序列x的自相关函数
M表示自相关函数r的单边长度，总长度为Mflag是定标标志，若flag
biased则表示有偏估计，需将rm都除以N见式若flagunbiased则表示
无偏估计，需将rm都除以Nabsm。若flag缺省，则r不定标。M和 flag同样适用
于求互相关函数。
求解例的程序为epm程序运行结果如图和图所示。
求解程序epm
clear
置信号和噪声序列长度Nyn自相关函数单边长度M NM
R dB时，计算噪声分布参数A Alsqrt
nN
wAlrandN生白噪声，均值为零，在AA上均匀分布
xsinpin 生信号xn的个值
yxw nxnwn
ryxcorryMbiased算yn的自相关函数的M个值
Created by ZhuangHeng
mMM 相关函数的M个值对应的自变量mM……M
figure
subplotstemnwaxis
xlabelnylabelwntitlea
subplotstemnyaxis
xlabelnylabelCyntitleb
subplotstemmry
xlabelmylabelrymtitlec
Asqrt N dB时，计算噪声分布参数A
wArandN生白噪声，均值为零，在AA上均匀分布
yxw nxnwn
ryxcorryMbiased算yn自相关函数的M个值
mMM 相关函数的M个值对应的自变量mM……M
figure
subplotCstemnwaxis
xlabelCnylabelwntitlea
subplotstemnyaxis
xlabelCnylabelCyntitleb
subplotstemmry
xlabelmylabelrymtitlec
习题与上机题 第章
用单位脉冲序列n及其加权和表示题图所示的序列。
xn
n
时域离散信号和时域离散系统
题图
给定信号：
Created by ZhuangHeng
口
口
口
口
口
数字信号处理第五版
画出xn序列的波形，标上各序列值；
试用延迟的单位脉冲序列及其加权和表示xn序列；
令xnxn试画出xn波形；
令xnxn试画出xn波形；
令xxn试画出xn波形。
判断下面的序列是否是周期的；若是周期的，确定其周期。
rnA cosπ A是常数
xne
对题图给出的xn要求：
画出xn的波形；
计算x。nxnzn并画出x。n波形；
x。nanxn并画出x。n波形； 计算a
令xnxnx。n将xn与xn进行比较，你能得到什么结论
设系统分别用下面的差分方程描述，xn与yn分别表示系统输入和输出，判断
系统是否是线性非时变的。
ynxnxnxn
ynxn
ynxnn n。为整常数
ynxn
ynxn
ynxn
ynxm
ynxnsinwn
给定下述系统的差分方程，试判定系统是否是因果稳定系统，并说明理由。
yn六znk
ynxnxn
ysmD
ynxnn
yne
Created by ZhuangHeng
设线性时不变系统的单位脉冲响应hn和输入序列xn如题图所示，要求画出
输出yn的波形。
hn xn
n n
题图
设线性时不变系统的单位脉冲响应hn和输入xn分别有以下三种情况，分别求
出输出yn。
hnRnxnRn
hnRnxnnn
hnunxRn
证明线性卷积服从交换律、结合律和分配律，即证明下面等式成立：
xnhnhnxn
xnhnhnxnhnhn
xnhnhnxnhnxnhn
设系统的单位脉冲响应hnun系统的输入xn是一些观测数据，
设xnxxT…x…》试利用递推法求系统的输出yn。递推时设系统初始
状态为零状态。
设系统由下面差分方程描述：
ynynxnxn
设系统是因果的，利用递推法求系统的单位脉冲响应。
设系统用一阶差分方程ynaynxn描述，初始条件y试分
析该系统是否是线性非时变系统。
有一连续信号xtcosπftφ式中，f Hzφπ。
求出xt的周期；
对xt进行采样，采样间隔T s试写出采样信号xt的表达式；
画出对应xt的时域离散信号序列xn的波形，并求出xn的周期。
已知滑动平均滤波器的差分方程为
yn号znxnznznxn
求出该滤波器的单位脉冲响应；
如果输入信号波形如题图所示，试求出yn并画出它的波形。
第章时域离散信号和时域离散系统
Created by ZhuangHeng
口
数字信号处理第五版
xn
oL
I IIi IIIiIIiIIi
n
题图
°已知系统的差分方程和输入信号分别为
ynynxnxn
xn
用递推法计算系统的零状态响应。
°已知两个系统的差分方程分别为
ynynynxn
ynynynxnxn
分别求出所描述的系统的单位脉冲响应和单位阶跃响应。
已知系统的差分方程为
ynaynaynbxn
其中，aab。
编写求解系统单位脉冲响应hn≤n≤的程序，并画出hn≤n≤
编写求解系统零状态单位阶跃响应sn≤n≤的程序，并画出sn≤n≤
。
在题图中，有四个分系统T、T、T和T四个分系统分别用下面的单位脉
冲响应或者差分方程描述：T Thm其他
Created by ZhuangHeng
Tyn—xnxn—zn
Tynynynvnvn
编写程序计算整个系统的单位脉冲响应hn≤n≤。
xn
T T
zn T yn
T n
题图
已知序列xnaunaxnununN分别求它们的自相
关函数，并证明二者都是偶对称的实序列。
设xnen…T为采样间隔。求xnT的自相关函数rmT。
已知xnAsinπfnTBsinπfnT其中ABff均为常数。求
xn的自相关函数rm。
设xnAsinwnwn其中wπwn是均匀分布的白噪声。
调用MATLAB函数 rand产生均匀分布，均值为功率P的白噪声信号
wn画出wn的时域波形，并求 wn的自相关函数rm画出rm的波形。
欲使xn的信噪比为 dB试确定A的值，编程产生xn画出xn的时域波
形，并求xn的自相关函数rm画出rm的波形，最后从rm的波形确定xn中
正弦序列的周期N。
第章时域离散信号和时域离散系统
Created by ZhuangHeng
口
口口口
口
口口
数字信号处理第五版
第 章
时域离散信号和系统的频域分析
引 言
我们知道，信号和系统的分析方法有两种，即时域分析方法和频域分析方法。在模拟
领域中，信号一般用连续变量时间的函数表示，系统则用微分方程描述。在频率域，则用信
号的傅里叶变换Fourier Transform或拉普拉斯变换表示。而在时域离散信号和系统中，
信号用时域离散信号序列表示，系统则用差分方程描述。在频率域，则用信号的傅里叶
变换或Z变换表示。
本章学习序列的傅里叶变换和Z变换，以及利用Z变换分析系统和信号频域特性。该
章内容是本书也是数字信号处理的理论基础。
时域离散信号的傅里叶变换的定义及性质
时域离散信号不同于模拟信号，因此它们的傅里叶变换不相同，但都是线性变换，一
部分性质是相同的。
时域离散信号傅里叶变换的定义
序列xn的傅里叶变换定义为
xeFTxn∑xne
FT为Fourier Transform的缩写。FTxn存在的充分条件是序列xn绝对可和，即满
足下式：
∑IznI○
Created by ZhuangHeng
为了得到傅里叶反变换公式，对公式两边同时乘以e并进行积分：
xeed∑xmeed∑xmd
由于
dfcosonmjsinanmd
om”
所以
xeedmzn
由此可得傅里叶反变换公式：
znIFTXexeeda
式和式组成一对傅里叶变换公式。式是傅里叶变换存在的充分条件，
有些函数例如周期序列并不满足式，说明它的傅里叶变换不存在，但如果引入冲激
函数，其傅里叶变换也可以用冲激函数的形式表示出来，这部分内容将在节介绍。
【例】 设xnR、n求xn的傅里叶变换。
解 xe∑Rne
eDu sincN
当N时，其幅度与相位随频率w的变化曲线如图所示。
xn
IXel
π π π
argXe】 π
一π
图 Rn的幅度与相位曲线
n
第章时域离散信号和系统的频域分析
Created by ZhuangHeng
数字信号处理第五版
时域离散信号傅里叶变换的性质
FT的周期性
在定义式中，n取整数，因此下式成立：
xezmcane
XeMDM为整数
观察上式，得到傅里叶变换是频率w的周期函数，周期是π。这一特点不同于模拟信号的
傅里叶变换。
由FT的周期性进一步分析得到，在w和wπM附近的频谱分布应是相同的M
取整数在w±π±π…点上表示xn信号的直流分量；离开这些点愈远，其频
率愈高，但又是以π为周期，那么最高的频率应是wπ。另外要说明的是，所谓xn的
直流分量，是指如图a所示的波形。例如，xncoSan当wπMM取整数时，
xn的序列值如图a所示，它代表一个不随n变化的信号直流信号当w
Mπ时，xn波形如图b所示，它代表最高频率信号，是一种变化最快的正
弦信号。由于FT的周期是π一般只分析一π十π之间或π范围的频谱就够了。
cos n cos an
… … … …
n n
a wπM bwMπ
图 cosan 的波形
线性
设XeFTxnXeFTxn那么
FTarnbxnaXebXe
式中，ab是常数。
时移与频移性质
设XeFTxn那么
FTxnneXe
FTexnXe
FT的对称性
在学习FT的对称性之前，先介绍什么是共轭对称与共轭反对称，以及它的性质。
设序列xn满足下式：
Created by ZhuangHeng
xnx一n
则称xn为共轭对称序列。为研究共轭对称序列具有什么性质，将x。n用其实部与虚部
表示：
xnxnjxn
将上式两边的n用n代替，并取共轭，得到：
xnxnjxn
对比上面两公式，因左边相等，因此得到：
xnxn
xnxn
上面两式表明共轭对称序列其实部是偶函数，而虚部是奇函数。类似地，可定义满足
下式的共轭反对称序列：
x。nxn
将x。n表示成实部与虚部，如下式：
x。nxnjxn
可以得到：
xnn
xnxn
即共轭反对称序列的实部是奇函数，而虚部是偶函数。
【例】 试分析 xne”的对称性。
解 因为
xnexn
满足式，所以xn是共轭对称序列，如展成实部与虚部，则得到：
xncOSwnjsinwn
上式表明，共轭对称序列的实部确实是偶函数，虚部是奇函数。
一般序列可用共轭对称与共轭反对称序列之和表示，即
xnx。nx。n
式中，xn和x。n可以分别用原序列xn求出，将式中的n用n代替，再取
共轭，得到：
x一nxnx。n
利用和式，得到：
xnanxn
x。nxnxn
利用上面两式，可以用xn分别求出xn的共轭对称分量x。n和共轭反对称分量x。n。
对于频域函数Xe也有和上面类似的概念和结论：
XeXeX。e
Created by ZhuangHeng
第章时域离散信号和系统的频域分析
口口口
口
口口
数字信号处理第五版
式中，Xe与X。e分别称为共轭对称部分和共轭反对称部分，它们满足：
XeXe
X。eX。e
同样有下面公式成立：
xexexe“
x。e—xexe
有了上面的概念和结论，下面研究FT的对称性。
将序列xn分成实部rn与虚部xn即
xnxnjxn
将上式进行傅里叶变换，得到：
XeXeX。e
式中
xeFTzn∑xne
x。eFTizni∑xne
上面两式中，xn和xn都是实数序列。容易证明：X。e满足式，具有共轭
对称性，它的实部是偶函数，虚部是奇函数；X。e满足式，具有共轭反对称性
质，它的实部是奇函数，虚部是偶函数。
最后得到结论：序列分成实部与虚部两部分，实部对应的傅里叶变换具有共轭对称性，
虚部和j一起对应的傅里叶变换具有共轭反对称性。
将序列分成共轭对称部分xn和共轭反对称部分x。n即
xnxn十xn
将和式重写如下：
x。nxnxn
x。nxnxn
将上面两式分别进行傅里叶变换，得到：
FTLznXexeReXeXgea
FTranxexejlmXejXeb
因此式的FT为
XeXRejXe c
式表示：序列xn的共轭对称部分xn对应着Xe的实部Xge而序
Created by ZhuangHeng
列xn的共轭反对称部分x。n对应着Xe的虚部包括j。
下面我们利用FT的对称性，分析实序列hn的对称性，并推导其偶函数hn和奇函
数h。n与hn之间的关系。
因为hn是实序列，其FT只有共轭对称部分He共轭反对称部分为零。
HeHe
HeHe
因此实序列的FT是共轭对称函数，其实部是偶函数，虚部是奇函数，用公式表示为
HgeHge
HeHe
显然，其模的平方HeIHeHie是偶函数，相位函数argHe
arctanHeHee是奇函数，这和实模拟信号的FT有同样的结论。
如果hn为实因果序列，按照和式得到：
hnhnh。n
hnhnhn
hn—hnhn
因为hn是实因果序列，按照上面两式，hn和h。n可用下式表示：
按照上面两式，实因果序列hn可以分别用hn和h。n表示为
hnhnun
hnh。nunhn
式中 第章时域离散信号和系统的频域分析
因为hn是实序列，上面公式中hn是偶函数，h。n是奇函数。按照式，
实因果序列完全由其偶序列恢复，但按照式，h。n中缺少n点hn的信息。
因此由h。n恢复hn时，要补充一点hnn信息。
Created by ZhuangHeng
数字信号处理第五版
则
【例】xnauna。求其偶对称分量xn和奇对称分量x。n。
解 xnxnx。n
按式，得到：
按式，得到：
xn、xn和xn波形如图所示。
xndun
n
xn
n
x。n
n
图 例图
时域卷积定理
设 ynxnhn
YeXeHe
Created by ZhuangHeng
证明 yn∑zmhnm
YeFTSycn∑zmhnme
令knm则
re三∑hAmee∑hke“zme
HeXe
该定理说明，两序列卷积的FT服从相乘的关系。对于线性时不变系统，输出的FT等
于输入信号的FT乘以单位脉冲响应的FT。因此，在求系统的输出信号时，可以在时域用
卷积公式计算，也可以在频域按照式，求出输出的FT再作逆FT求出
输出信号yn。
频域卷积定理
设
ynhnxn
则
YeHeXe厂He°Xedo
证明
Ye∑znhne∑znHeedee
交换积分与求和的次序，得到：
YeHe∑znedfHexede
HeXe
该定理表明，在时域两序列相乘，转移到频域时服从卷积关系。
帕斯瓦尔Parseval定理
∑IzmPxePd
证明
∑znI∑znxn∑xmxeeda
xe∑xned
时或焉敬言号和系统的顷或分折
xex edu
xeIdo
Created by ZhuangHeng
口口
口口
口口
口
数字信号处理第五版
帕斯维尔定理表明了信号时域的能量与频域的能量关系。
表综合了FT的性质，这些性质在分析问题和实际应用中是很重要的。
表 序列傅里叶变换的性质和定理
周期序列的离散傅里叶级数及傅里叶变换表示式
因为周期序列不满足式绝对可和的条件，因此它的FT并不存在，但由于是周
期性的，可以展成离散傅里叶级数，引入奇异函数δa其FT可以用公式表示出来。
周期序列的离散傅里叶级数
设n是以N为周期的周期序列，可以展成离散傅里叶级数。我们知道xn的基波
成分为enaek次谐波成分为enaeM。又因为eNdNe
所以，离散傅里叶级数中只有N个独立的谐波成分，展成离散傅里叶级数时，只能取
k～N的N个独立的谐波分量，k表示周期序列的直流成分。因此，xn展成离
散傅里叶级数如下：
序 列 傅里叶变换
rn Xe
yn Ye
arnbyn a、b为常数 aXebYe
xnn eXe
rne Xe
xn Xe
xn Xe
rnyn XeYe
rnyn xeYed
nrn jaxCe
Rern Xe“
jImxn X。e
xn ReXe
r。n jlmXe
∑lzmP去IxePd 帕斯瓦尔定理：
m
Created by ZhuangHeng
为求系数a将上式两边乘以e并对n在一个周期N中求和，即
zmee
式中
A≠m
式的证明作为练习请读者自己证明。因此
a六me ≤k≤N
式中，k和》均取整数。因为ee取整数，即e是周期为N的周期函
数。所以，系数a也是周期序列，满足aaN。
为了与第章介绍的离散傅里叶变换DFT相比较，令XkNa并将式
代入，得到：
k∑zne k
式中，Xk也是以N为周期的周期序列，称为n的离散傅里叶级数系数，用DFS
Discrete Fourier Series表示。
六Xk代替式中的a得到： 用
m六xe
将式和式重写如下：
XADFSGm∑me
IDFSCXk六xe
式和式称为一对DFS。式表明将周期序列分解成N次谐波，第k
个谐波频率为wπNkk…N幅度为NXk。基波分量的频率是
πN幅度是NX。一个周期序列可以用其DFS系数Xk表示它的频谱分布规律。
【例】设xnRn将xn以N为周期进行周期延拓，得到如图
a所示的周期序列xn周期为求DFSn。
解 按照式，有
×acme“立e
第章时域离散信号和系统的频域分析
Created by ZhuangHeng
口
口
口
口口
口
口
口
口口
口
口
口
数字信号处理第五版
其幅度特性Xk如图b所示。
n
a
n
Xkt
b
k
图 例图
周期序列的傅里叶变换表示式
在模拟系统中见参考文献x。te°其傅里叶变换是在ΩΩ。处的单位冲
激函数，强度是π即
XjFTxzedtπΩΩ
对于时域离散信号，xneπ≤w≤ππw。为有理数，暂时假定其FT的形
式与式一样，即是在ww。处的单位冲激函数，其强度为π。但由于n取整数，下
式成立：
ee r取整数
因此e的FT为
xeFTeJ∑mommr
式表示复指数序列的FT是在w。πr处的单位冲激函数，强度为π如图
所示。但这种假定如果成立，则要求按照式的逆变换必须存在，且唯一等于e
下面进行验证。按照IFT定义，对式两边进行 IFT得到：
厂xeed∑momaed
观察图在一ππ区间，只包括一个单位冲
激函数δww等式右边为e因此得到下式：
Xe
π xeedIFTXe 一
叫π π
证明了式确实是e的FT前面的暂时
假定是正确的。
图 e的FT
对于一般周期序列xn按式展成DFS第k次谐波为XkNe类似
于复指数序列的FT其FT为
Created by ZhuangHeng
nXkmkm
因此xn的FT如下式：
xeFTGnXkam
式中，k…N。如果让k在○区间变化，上式可简化成
xeC×k
式中 Xke
式就是周期序列的傅里叶变换表示式。需要说明的是，上面公式中的w表
示单位冲激函数，而δn表示单位脉冲序列，由于括弧中的自变量不同，因而不会引起
混淆。
表中综合了一些基本序列的FT。
表 基本序列的傅里叶变换
序列 傅里叶变换
n
la aun ae
Rn esin
un e∑noc
xn macmxk
πm。为有理数，a∈ππ ∑mx
πm。为有理数，m∈ππ cosan “∑mmamD
sinann πws为有理数，a∈ππ im cmmmDmmD
第章
表中un序列的傅里叶变换推导如下：
用xn表示un的交流分量，un的直流分量为所以，
xnun
时域离散信号和系统的频域分析
用差分关系求xn的FT
rnun
xnxnununn
对式进行FT得到：
Created by ZhuangHeng
口
口
口
口口
口口
口
数字信号处理第五版
xe
应当注意，如果信号有直流分量，差分运算就丢失了直流信息，所以不能用上述方法。对
式进行FT得到：
xeUem∑mπk
Uemoumk
【例】求例中周期序列的FT。
解 将例中得到的Xk代入式中，得到：
xe∑esinrkmk
其幅频特性如图所示。
n
a
n
iXelI
b
图 例图
对比图对于同一个周期信号，其DFS和FT的模的形状是一样的，不同的是
FT用单位冲激函数表示用带箭头的竖线表示。因此周期序列的频谱分布用其DFS或者
FT表示都可以，但画图时应注意单位冲激函数的画法。
【例】 令ncoSwnπw。为有理数，求其FT。
解 将xn用欧拉公式展开：
ine”e
按照式，其FT推导如下：
xeFTcoson县·πmmwu
π∑mmruamr
式表明，coSaun的FT是在w±w。处的单位冲激函数，强度为π且以π
为周期进行延拓，如图所示。
Created by ZhuangHeng
xe
π一πa π
图 cosan的FT
时域离散信号的傅里叶变换与模拟信号
傅里叶变换之间的关系
时域离散信号与模拟信号是两种不同的信号，傅里叶变换也不同，如果时域离散信号
是由某模拟信号采样得来，那么时域离散信号的傅里叶变换和该模拟信号的傅里叶变换之
间有一定的关系。下面推导这一关系式。
公式xnxtlrxnT表示了由采样得到的时域离散信号和模拟信号的关
系，而理想采样信号xt和模拟信号的关系用式表示，重写如下：
立∑zxnTtnT
对上式进行傅里叶变换，得到：
XGintDed厂∑znTnTed
∑xnTtnTed
∑zTenTd
∑zNTe
对比式，并令wΩT且xnxnT得到：
XeXjΩ
由式得
xe÷xGinjA 第章时域离散信号和系统的频域分析
式中
πF
式也可以表示成
xexGiala÷xn
Created by ZhuangHeng
口口
口
口口
口口
口口
口
数字信号处理第五版
、和式均表示时域离散信号的傅里叶变换和模拟信号傅里叶变换
之间的关系。由这些关系式可以得出两点结论。一点结论是时域离散信号的频谱也是模拟
πF因此由模拟信号进行采样得到时域离散信 信号频谱的周期性延拓，周期为
号时，同样要满足前面推导出的采样定理，采样频率必须大于等于模拟信号最高频率的
倍以上，否则也会产生频域混叠现象，频率混叠在Ω附近最严重，在数字域则是在π附
近最严重。另一点结论是计算模拟信号的FT可以用计算相应的时域离散信号的FT得到，
方法是：首先按照采样定理，以模拟信号最高频率的两倍以上频率对模拟信号进行采样
得到时域离散信号，再通过计算机对该时域离散信号进行FT得到它的频谱函数，截取
ππ上的主值区，再乘以采样间隔T便得到模拟信号的FT注意关系式wΩT。
按照数字频率和模拟频率之间的关系，在一些文献中经常使用归一化频率ffF
或ΩΩΩwaπ因为f、Q和w都是无量纲量，刻度是一样的，将f、Ω、w、f、
Ω、o的定标值对应关系用图表示。
F F F F
i i
Q Q
π
一π
f
Ω
g
π
a
图 模拟频率与数字频率之间的定标关系
图表明，模拟折叠频率F对应数字频率π如果采样定理满足，则要求模拟
最高频率f。不能超过F如果不满足采样定理，则会在wπ附近，或者fF附近
引起频率混叠。以上几个频率之间的定标关系很重要，尤其在模拟信号数字处理中，经常
需要了解它们的对应关系。
序列的Z变换
在模拟信号和系统中，用傅里叶变换进行频域分析，拉普拉斯变换可作为傅里叶变换
的推广，对信号和系统进行复频域分析。在时域离散信号和系统中，用序列的傅里叶变换
进行频域分析，Z变换则是其推广，用以对序列和系统进行复频域分析。通过Z变换，时域
离散信号的卷积运算变成乘法运算，系统的差分方程变成代数方程，从而使分析更加方便。
因此Z变换在数字信号处理中同样起着很重要的作用。
Z变换的定义
序列xn的Z变换定义为
Created by ZhuangHeng
x∑zn
式中，z是一个复变量，它所在的复平面称为z平面。注意在定义中，对n求和是在
、十∞之间求和，称为双边Z变换。还有一种称为单边Z变换的定义，如下式：
x∑xn
这种单边Z变换的求和限是从零到无限大，因此对于因果序列，用两种Z变换定义计算的
结果是一样的。本书中如不另外说明，均用双边Z变换对信号和系统进行分析。
式Z变换存在的条件是等号右边级数收敛，要求级数绝对可和，即
∑IznsI○
使式成立时，变量z取值的域称为Z变换的收敛域。一般收敛域为环状域，即
RzlR
令zre代入上式得到RrR收敛域是分别以R和R为收敛半径的两个圆
形成的环状域如图中所示的斜线部分。当然，R可以小到零，R可以大到无穷
大。收敛域的示意图如图所示。
Imfzl
R
R Rez
图 Z变换的收敛域
常用的Z变换是一个有理函数，用两个多项式之比表示：
XzP
分子多项式Pz的根是Xz的零点，分母多项式Qz的根是Xz的极点。在极点处Z
变换不存在，因此收敛域中没有极点，收敛域总是用极点限定其边界。
对比序列的傅里叶变换定义式，很容易得到傅里叶变换和Z变换ZT之间的
关系，用下式表示：
XeXz
式中，ze表示在z平面上r的圆，该圆称为单位圆。式表明单位圆上的Z变
换就是序列的傅里叶变换。如果已知序列的Z变换，就可用式很方便地求出序列的
傅里叶变换，条件是收敛域中包含单位圆。
【例】 xnun求其Z变换。
第章时域离散信号和系统的频域分析
Created by ZhuangHeng
口
口
口
口口口
口
口口
口
口
口口
数字信号处理第五版
解 X∑unz
Xz存在的条件是z因此收敛域为z因此
Xz IzI
Xz表达式表明，极点是z单位圆上的Z变换不存在，或者说收敛域不包含单位圆，
因此其傅里叶变换不存在，更不能用式求傅里叶变换。该序列的傅里叶变换不存
在，但如果引进奇异函数δw其傅里叶变换则可以表示出来见表。该例同时说
明一个序列的傅里叶变换不存在，但在一定收敛域内Z变换是可以存在的。
序列特性对收敛域的影响
序列的特性决定其Z变换收敛域，了解序列特性与收敛域的一般关系，对使用Z变换
是很有帮助的。
有限长序列
如序列xn满足下式：
其他”
即序列xn从n到n的序列值不全为零，此范围之外序列值为零，这样的序列称为有限
长序列。其Z变换为
xaans
设xn为有界序列，由于是有限项求和，除与∞两点是否收敛与n、n取值情况有
关外，整个z平面均收敛。如果n则收敛域不包括一点；如果n则收敛域不包括
z点；如果是因果序列，收敛域包括z点。具体有限长序列的收敛域表示如下：
nn≤时，≤lzl∞
nn时，z
n≥n时，Izl≤
【例】求xnRgn的Z变换及其收敛域。
解 X∑Rane
这是一个因果的有限长序列，因此收敛域为z≤。但由结果的分母可以看出，似乎
z是Xz的极点，但同时分子多项式在z时也有一个零点，极、零点对消，Xz在
单位圆上仍存在，求RNn的傅里叶变换，可将ze代入Xz得到，其结果和例题
中的结果式是相同的。
右序列
右序列是指在n≥n时，序列值不全为零，而在nn时，序列值全为零的序列。右序
Created by ZhuangHeng
列的Z变换表示为
xzZxnsznZanz
第一项为有限长序列，设n≤其收敛域为≤lz∞。第二项为因果序列，其收敛域
为Rlz≤∞R是第二项最小的收敛半径。将两收敛域相与，其收敛域为
Rz∞。如果是因果序列，收敛域为Rz≤∞。
【例】求xnaun的Z变换及其收敛域。
解 Xz∑auna∑aza
在收敛域中必须满足az因此收敛域为za。
左序列
左序列是指在n≤n时，序列值不全为零，而在nn时，序列值全为零的序列。左序
列的Z变换表示为
x∑zn
如果n≤z点收敛，z点不收敛，其收敛域是在某一圆半径为R的圆内，
收敛域为≤zR。如果n则收敛域为zR。
【例】求xnaun的Z变换及其收敛域。
解 这里xn是一个左序列，当n≥时，xn
Xz∑auneaza
Xz存在要求az即收敛域为zla因此
Xzaa zlaI
双边序列
一个双边序列可以看做是一个左序列和一个右序列之和，其Z变换表示为
Xz∑xnsXXz
xwe ≤IzR 第章时域离散信号和系统的频域分析
X∑xns Rlzl≤
Xz的收敛域是Xz和Xz收敛域的交集。如果RR则其收敛域为R
zR是一个环状域；如果RR两个收敛域没有交集，Xz则没有收敛域，因此
Xz不存在。
【例】xnaa为实数，求rn的Z变换及其收敛域。
Created by ZhuangHeng
口
数字信号处理第五版
解
xa∑aa
∑a∑a
第一部分收敛条件为az得到的收敛域为zlal第二部分收敛条件为az
得到的收敛域为zla。如果a两部分的公共收敛域为azla其Z变
换如下式：
Xzaaaaa Iaza
如果a≥则无公共收敛域，因此Xz不存在。当a时，xn的波形及Xz
的收敛域如图所示。
n
Imz
a Rez
a
图 例图
我们注意到，例和例的序列是不同的，即一个是左序列，一个是右序列，
但其Z变换Xz的函数表示式相同，仅收敛域不同。换句话说，同一个Z变换函数表达式，
收敛域不同，对应的序列是不相同的。所以，Xz的函数表达式及其收敛域是一个不可分
离的整体，求Z变换就包括求其收敛域。
此外，收敛域中无极点，收敛域总是以极点为界的。如果求出序列的Z变换，找出其极
点，则可以根据序列的特性，较简单地确定其收敛域。例如在例中，其极点为 za
根据xn是一个因果性序列，其收敛域必为：za又例如在例中，其极点为
之a但xn是一个左序列，收敛域一定在某个圆内，即za。
逆Z变换
已知序列的Z变换Xz及其收敛域，求原序列xn的过程称为求逆Z变换。重写
xn的Z变换定义式如下：
Created by ZhuangHeng
X∑rne”RzR
对式两端乘以zn为任一整数，并在Xz的收敛域上进行积分，得
fxzdzf∑xmzdz∑xmpzd
式中积分路径c是Xz收敛域中一条包围原点的逆时针方向的闭合围线，如图所
dz 示。根据复变函数理论中的柯西公式，只有当nm即mn时，
πj否则， φx”dz。考虑到m是整数，所以，求和式中除了mn以外，其余各项全
为零，于是有
φXzedzmjrn
所以
xnIZTXxadz
式就是逆Z变换公式。
Ima
c、
R
o R Rea
图 围线积分路径
计算逆Z变换的方法有留数法、部分分式展开法和幂级数法长除法。下面仅介绍留
数法和部分分式展开法，重点放在留数法。
用留数定理求逆Z变换
求逆Z变换时，直接计算式给出的围线积分是比较麻烦的，用留数定理求则很
容易。为了书写简单，用Fz表示被积函数：FzXzz。
如果Fz在围线c内的极点用z表示，根据留数定理有
焉xdx∑ResFzz
式中，ResFzz表示被积函数Fz在极点zz的留数，逆Z变换是围线c内所有的
极点留数之和。
如果z 是单阶极点，则根据留数定理有
ResFzzzz·Fz
如果z是m阶极点，则根据留数定理有
Created by ZhuangHeng
第章时域离散信号和系统的频域分析
口
口
数字信号处理第五版
ResFzzmDzF
式表明，对于m阶极点，需要求m次导数，这是比较麻烦的。如果c内有
多阶极点，而c外没有多阶极点，则可以根据留数辅助定理改求c外的所有极点留数之和，
使问题简单化。
如果Fz在z平面上有N个极点，在收敛域内的封闭曲线c将z平面上的极点分成两
部分：一部分是c内极点，设有N个极点，用z表示；另一部分是c外极点，设有N个，
用z表示。NNN。根据留数辅助定理，下式成立：
∑ResLFzuZRsFazu
注意：式成立的条件是Fz的分母阶次应比分子阶次高二阶或二阶以上。设
XzPzQzPz和Qz分别是z的M和N阶多项式。式成立的条件是
NMn≥
因此要求
nNM
如果满足式，c内极点中有多阶极点，而c外没有多阶极点，则逆Z变换的计算可
以按照式，改求c圆外极点留数之和，最后加一个负号。
【例】 已知Xzazza求其逆Z变换xn。
解 xnfazzdz
Fza
为了用留数定理求解，先找出Fz的极点。显然，Fz的极点与n的取值有关。
极点有两个：za当n时，其中z的极点和n的取值有关。n≥时，z不
是极点；n时，z是一个n阶极点。因此，分成n≥和n两种情况求xn。
n≥时，Fz在c内只有个极点：za
n时，Fz在c内有个极点：zazn阶
所以，应当分段计算xn。
n≥时， Imz
n阶极点
o a
Rez
图 例中n时Fz的
极点分布
Created by ZhuangHeng
xnResFzazaa
n时，z是n阶极点，不易求留数。采用留数
辅助定理求解，先检查式是否满足。该例
题中NMNM所以n时，满足
式，可以采用留数辅助定理求解，改求c
外极点留数，但对于Fz该例题中圆外没有极点
见图故nxn。最后得到该例题
的原序列为
xnaun
事实上，该例题由于收敛域是za根据前面分析的序列特性对收敛域的影响知道，
xn一定是因果序列，这样 n部分一定为零，无需再求。本例如此求解是为了证明用留
数辅助定理求解的正确性。
Xzazazla 【例】 已知 求其逆变换xn。
解 该例题没有给定收敛域，为求出唯一的原序列xn必须先确定收敛域。分析
Xz得到其极点分布如图所示。图中有两个极点：za和za这样收敛域
有三种选法，它们是
za对应的xn是因果序列；
za对应的xn是左序列；
aza对应的xn是双边序列。
Imla
a a Rez
图 例中Xz的极点
下面分别按照不同的收敛域求其xn。
收敛域为za
Fxaaaza
这种情况的原序列是因果的右序列，无须求 n时的xn。当n≥时，Fz在c内有两
个极点：za和za因此
xn ResFzaResFza
zaazasaza
aa
最后表示成：xnaaun。
收敛域为zla
这种情况原序列是左序列，无须计算 n≥情况。实际上，当n≥时，围线c内没有极
点，因此xn。n时，c内只有一个极点z且是n阶极点，改求c外极点留数之和。
n时，Fz满足式，所以按式计算xn
第章时域离散信号和系统的频域分析
Created by ZhuangHeng
数字信号处理第五版
xnResFzaResFza
azaasaza
aaaa
最后将xn表示成封闭式：
xnaaun
收敛域为aza
这种情况对应的xn是双边序列。根据被积函数Fz按n≥和n两种情况分别
求xn。
n≥时，c内只有个极点：za
xnResFzaa
n时，c内极点有个，其中z是n阶极点，改求c外极点留数，c外极点只有
za因此
rnResFzaa
最后将xn表示为
n≥
即
xna
部分分式展开法
对于大多数单阶极点的Xz常常也用部分分式展开法求逆Z变换。
设xn的Z变换Xz是有理函数，分母多项式是N阶，分子多项式是M阶，将Xz
展成一些简单的常用的部分分式之和，通过查表参考表求得各部分的逆变换，再
相加便得到原序列xn。设Xz只有N个一阶极点，可展成下式：
XAA
xAA
观察上式，Xzz在z的极点留数就是系数A。在极点zz的留数就是系数A…。
A。Res
ARes
求出A。系数m…N后，查表可求得序列xn。
Xzlzl求逆Z变换。 【例】 已知
Created by ZhuangHeng
解 XzzA
ARes×xz
ARes××z
Xz
Xz
因为收敛域为z第一部分极点是z因此收敛域为z。第二部分极
点是z收敛域应取z。查表得到：
xnunun
注意：在进行部分分式展开时，也用到求留数问题；求各部分分式对应的原序列时，还
要确定它的收敛域在哪里，因此一般情况下不如直接用留数法求方便。
一些常见序列的Z变换可参考表。
表 常见序列的Z变换
序 列 Z 变 换 收 敛 域
n 整体z平面
un Izl
aun a za
RNn z
aun a zal
nun a Iz
naun aa zlal
eun z
sinanun z
cosanun z
Z变换的性质和定理
下面介绍Z变换重要的性质和定理。
第章时域离散信号和系统的频域分析
Created by ZhuangHeng
口
口
口
口口
口
口
口口
口口
数字信号处理第五版
线性性质
设
mnaxnbyn ab为常数
XzZTxnRzR
YzZTyn RzR
则
MzZTmnaXzbYzRzRm
RminRR
RmaxRR
这里，Mz的收敛域RR是Xz和Yz的公共收敛域，如果没有公共收敛域，例
如当RRRR时，则Mz不存在。
序列的移位性质
设
则
XzZTxnRzR
ZTxnn。xXzRzR
序列乘以指数序列的性质
设
XzZTxn RzR
ynaxn a为常数
则
证明
YzZTaxnXazaRzaR
Y∑anz∑anaXa
因为RazR得到aRzaR
序列乘以n的ZT
设
则
证明
XzZTxn RzR
ZTnrndxzRzR
dx∑xna∑xn
∑nmn∑un
zZTnxn
Created by ZhuangHeng
因此
ZTnxnaXz
由于Xz是z的幂级数，其导函数是具有相同收敛域的另一个幂级数，故式
的收敛域与Xz相同。
复共轭序列的ZT
设
则
XzZTxn RzR
ZTxnXzRzR
证明 ZTxn∑xns∑xnz
∑znzxz
初值定理
设xn是因果序列，XzZTxn则
x limXz
证明 Xznaxxaxz…
因此
limXzx
终值定理
若xn是因果序列，其Z变换的极点，除可以有一个一阶极点在z上，其他极点均
在单位圆内，则
limxn limzXz
证明 zX∑znxne”
因为xn是因果序列，xnn所以
zDXlim∑mDz∑zm“
因为zXz在单位圆上无极点，上式两端对z取极限：
imzXzlim∑xm∑am
limrx…xnznxx…n
limxnlimxn
终值定理也可用Xz在z点的留数表示，因为
第章时域离散信号和系统的频域分析
Created by ZhuangHeng
a口
口口
口
口口
口口
口口
口口
a口
口
数字信号处理第五版
limzDXzResXz
因此
xcResXz
如果在单位圆上Xz无极点，则xo。
时域卷积定理
设
wnxnyn
XzZTxnRzR
YzZTynRzR
则
WzZTwnXzYzRzR
RminRR
RmaxRR
证明 WzZTznyn∑∑zmynm。
zmsommzSacmesame
XzYz
Wz的收敛域就是Xz和Yz的公共收敛域。如果Xz和Yz相乘中有零、极点对
消，则Wz的收敛域可能扩大。
【例】已知网络的单位脉冲响应hnauna网络输入序列xn
un求网络的输出序列yn。
解 ynhnxn
求yn可用两种方法，一种直接求解线性卷积，另一种是Z变换法。
yn∑hmznm∑aumunm
∑aun“n
ynhnxn
HzZTauna IzIal
XzZTun Il
YzHzXzaa zl
yn嘉zzad
由收敛域判定
ynn
Created by ZhuangHeng
n≥时，
ynResYzResYzaaa
将yn表示为
ynun
复卷积定理
如果
ZTxnXzRzR
ZTynYzRzR
wnxnyn
则
WzφxY元
Wz的收敛域为
RRzRR
式中v平面上，被积函数的收敛域为
maxRRlminRR
Wz∑znynz∑焉fxdoynz 证明
焉fx∽yn合
嘉fxoY
由Xz的收敛域和Yz的收敛域得到：
RlvlR
RR
因此
RRIzRR
maxRRlminRR
【例】已知 xnunynaa若wnxnyn求
WzZTwn。
第章时域离散信号和系统的频域分析
解Xz z≤
Yzaaaa IaIzIa
Created by ZhuangHeng
数字信号处理第五版
wafro×毒faa
maxRRvlminRR
Wz的收敛域为az≤∞这里，R○RRaRa。
因此被积函数v平面上的收敛域为maxavminazv平面上极点有
a、a和zc内极点有za。令FoYox二则
WResFoaa az≤∞
wnaun
帕斯维尔Parseval定理
设
XzZTxnRzR
YzZTynRlzR
RRRR
那么
∑znym嘉xoxod
v平面上，c所在的收敛域为
maxRRlminRR
利用复卷积定理可以证明上面的重要的帕斯维尔定理。
证明 令
wnrnyn
按照式得到：
WzZTonfxwxodu
按照式，RRzRR按照假设，z在收敛域中，将z代入
Wz中，则有
wfxYod
w∑anym∑znyn
因此
∑znyn—xoydu
如果xn和yn都满足绝对可和，即单位圆上收敛，在上式中令ve得到：
Created by ZhuangHeng
∑znynxexed
令xnyn得到：
∑IxnP厂IxePd
上面得到的公式和在傅里叶变换中所讲的帕斯维尔定理式是相同的。
式还可以表示成下式：
∑IznI嘉xzXz
注意：上式中Xz收敛域包含单位圆，当xn为实序列时，XeXe。
利用Z变换解差分方程
在第章中介绍了差分方程的递推解法，下面介绍Z变换解法。这种方法将差分方程
变成了代数方程，使求解过程简单。
设N阶线性常系数差分方程为
∑aynk∑bnk
求稳态解
如果输入序列xn是在n以前一时加上的，n时刻的yn是稳态解，对
式求Z变换，得到：
∑aYzz∑bXza
YzHzXz
式中
ynIZTYz
第章时域离散信号和系统的频域分析
求暂态解
对于N阶差分方程，求暂态解必须已知N个初始条件。设xn是因果序列，即
xnn已知初始条件yy…yN。对式进行Z变换
时，注意这里要用单边Z变换。该方程式的右边由于xn是因果序列，单边Z变换与双边
Z变换是相同的。下面先求移位序列的单边Z变换。
Created by ZhuangHeng
口
数字信号处理第五版
设
Yz∑yns
ZTynmun∑ynms∑ynm
∑yAsA∑ybz
z”Y∑ykz
按照式对式进行单边Z变换，有
∑aaYz≥∑bXa
上式右边第一部分与系统初始状态无关，称为零状态解；而第二部分与输入信号无关，
称为零输入解。求零状态解时，可用双边Z变换求解也可用单边Z变换求解，求零输入解
却必须考虑初始条件，用单边Z变换求解。
【例】 已知差分方程ynbynxn式中xnauny
求yn。
解 将已知差分方程进行Z变换：
YzbeYzbyXz
Yzx
式中
Xzazal
于是
Yaaba
收敛域为zmaxab因此
ynab n≥
式中第一项为零输入解，第二项为零状态解。
利用Z变换分析信号和系统的频响特性
信号和系统的频率特性一般用傅里叶变换和Z变换进行分析。本节用Z变换方法进行
Created by ZhuangHeng
分析讨论。
频率响应函数与系统函数
设系统初始状态为零，系统对输入为单位脉冲序列n的响应输出称为系统的单位脉
冲响应hn。对hn进行傅里叶变换，得到：
He∑hneI Hee
一般称He为系统的频率响应函数，或称系统的传输函数，它表征系统的频率响应特性。
He称为幅频特性函数，pw称为相频特性函数。
将hn进行Z变换，得到Hz一般称Hz为系统的系统函数，它表征了系统的复
频域特性。对N阶差分方程式，进行Z变换，得到系统函数的一般表示式
如果Hz的收敛域包含单位圆z则He与Hz之间的关系如下：
HeHz
He表示系统对特征序列e的响应特性，这也是He的物理意义所在，下面具体阐述。
若系统输入信号xne则系统输出信号为
ynhnxn∑hmnm∑hme
∑hmeHee
即
ynHeeHeet
上式说明，单频复指数信号e通过频率响应函数为He的系统后，输出仍为单频复指数
序列，其幅度放大He倍，相移为pw。
为了加深读者对He物理意义的理解，下面以大家熟悉的正弦信号为例进行讨论。
当系统输入信号xncoswn时，求系统的输出信号yn
因为
xncoscmee
所以，利用上面的结论可得到：
yn去HeeHee
设hn为实序列，则
HeHeHeHepwqo
第章时域离散信号和系统的频域分析
故
Created by ZhuangHeng
数字信号处理第五版
yn贵HeHee
Heemen
Hecosangw
由此可见，线性时不变系统对单频正弦信号cosan的响应为同频正弦信号，其幅度放
大He倍，相移增加qa这就是其名称“频率响应函数”、“幅频响应”和“相频响应”
的物理含义。如果系统输入为一般的序列xn则He对xn的不同的频率成分
进行加权处理。对感兴趣的频段，取He其他频段He则Ye
Xe·He这就是对输入信号的理想滤波处理。根据佩利维纳准则①理想滤波器的
He不满足物理可实现的必要条件。所以，实际中都是用可实现的滤波器来逼近理想
滤波器的。
利用系统函数的极点分布分析系统的因果性和稳定性
因果可实现系统其单位脉冲响应hn一定是因果序列，那么其系统函数Hz的收
敛域一定包含点，即点不是极点，极点分布在某个圆内，收敛域在某个圆外。
∑Ihn∞这正是HeFThn存在的条件，对照Z变换 系统稳定要求
与傅里叶变换的关系可知，系统稳定的条件是Hz的收敛域包含单位圆。如果系统因果且
稳定，收敛域包含点和单位圆，那么收敛域可表示为
rz≤ r
这样 Hz的极点集中在单位圆的内部。具体系统的因果性和稳定性可由系统函数Hz的
极点分布和收敛域确定。下面通过例题说明。
如果系统函数分母多项式阶数较高如阶以上用手工计算极点分布并判定系统是
否稳定，不是一件简单的事情。用MATLAB函数判定则很简单，判定函数程序如下：
function stabA
tab系统稳定性判定函数，A是Hz的分母多项式系数向量
disp系统极点为：
Hz的极点，并显示 ProotsA
dispC系统极点模的最大值为：
MmaxabsP所有极点模的最大值，并显示
if M disp系统稳定elsedisp系统不稳定end
① 佩利维纳准则：He满足物理可实现的必要条件是：
厂Hd
即He可以在某些离散点上为零，但不能在某一有限频带内全为零。
Created by ZhuangHeng
请注意，这里要求 Hz是正幂有理分式。给Hz的分母多项式系数向量A赋值，调
用该函数，求出并显示系统极点和极点模的最大值M判断M值，如果M则显示“系
统稳定”否则显示“系统不稳定”。如果Hz的分母多项式系数A
则调用该函数输出如下：
P i i
系统极点模的最大值为：M
系统稳定。
Hzaaa 【例】 已知 分析其因果性和稳定性。
解 Hz的极点为zaza如图所示。
收敛域为az≤对应的系统是因果系统，但由于收敛域不包含单位圆，
因此是不稳定系统。单位脉冲响应hnaaun参考例这是一个因果序
列，但不收敛。
收敛域为≤za对应的系统是非因果且不稳定系统。其单位脉冲响应
hnaaun参考例这是一个非因果且不收敛的序列。
收敛域为aza对应一个非因果系统，但由于收敛域包含单位圆，因此是
稳定系统。其单位脉冲响应hna这是一个收敛的双边序列，如图a所示。
hna
a
n
N
hn
b
n
图 例图示
下面分析如同例这样的系统的可实现性。 第章时域离散信号和系统的频域分析
Hz的三种收敛域中，前两种系统不稳定，不能选用；最后一种收敛域，系统稳定但
非因果，还是不能具体实现。因此严格地讲，这样的系统是无法具体实现的。但是我们利用
数字系统或者说计算机的存储性质，可以近似实现第三种情况。方法是将图a从
N到N 截取一段，再向右移，形成如图b所示的hn序列，将hn作为具体实
现的系统单位脉冲响应。N愈大，hn表示的系统愈接近hn系统。具体实现时，预先将
hn存储起来，备运算时应用。这种非因果但稳定的系统的近似实现性，是数字信号处理
Created by ZhuangHeng
数字信号处理第五版
技术比模拟信息处理技术优越的地方。
说明：对一个实际的物理实现系统，其Hz的收敛域是唯一的。
利用系统的极零点分布分析系统的频率响应特性
将式因式分解，得到：
A 式中， 是Hz的零点，d是其极点。A 参数影响频率响应函数的幅度大小，影
响系统特性的是零点c和极点d的分布。下面我们采用几何方法研究系统零极点分布对
系统频率特性的影响。
将式分子、分母同乘以zNM得到：
设系统稳定，将ze代人上式，得到频率响应函数
在z平面上，ec用一根由零点c指向单位圆上e点B的向量cB表示，同样，ed
用由极点指向e点B的向量dB表示，如图所示，即cB和dB分别称为零点向量和
极点向量，将它们用极坐标表示：
cBcBe
dBdBe
将cB和dB表示式代入式，得到：
goaNmB
Created by ZhuangHeng
系统的频响特性由式和式确定。当频率w从变化到π时，这些向量的终
点B沿单位圆逆时针旋转一周，按照式和式，分别估算出系统的幅频特性
和相频特性。例如图表示了具有一个零点和两个极点的频率特性。
Ijlm HeI
B
d
dB B
GB
φ
π π
a
Re
d π π
一π
图 频响的几何表示法
按照式，知道零极点的分布后，可以很容易地确定零极点位置对系统特性的影
响。当B点转到极点附近时，极点向量长度最短，因而幅度特性可能出现峰值，且极点愈
靠近单位圆，极点向量长度愈短，峰值愈高愈尖锐。如果极点在单位圆上，则幅度特性为
系统不稳定。对于零点，情况相反，当B点转到零点附近时，零点向量长度变短，幅度
特性将出现谷值，零点愈靠近单位圆，谷值愈接近零。当零点处在单位圆上时，谷值为零。
总结以上结论：极点位置主要影响频响的峰值位置及尖锐程度，零点位置主要影响频响的
谷点位置及形状。
这种通过零极点位置分布分析系统频响的几何方法为我们提供了一个直观的概念，对
于分析和设计系统是十分有用的。基于这种概念，可以用零极点累试法设计简单滤波器。
下面介绍用MATLAB计算零、极点及频率响应曲线。首先介绍MATLAB工具箱中
两个函数zplane和freqz的功能和调用格式。
第章
zplane 绘制Hz的零、极点图。
zplanezp 绘制出列向量z中的零点以符号“O”表示和列向量p中的极点以符
号“×”表示同时画出参考单位圆，并在多阶零点和极点的右上角标出其阶数。如果z和
p为矩阵，则zplane 以不同的颜色分别绘出z和p各列中的零点和极点。
zplaneBA绘制出系统函数Hz的零极点图。其中B和A为系统函数Hz
BzAz的分子和分母多项式系数向量。假设系统函数Hz用下式表示： 时域离散信号和系统的频域分析 HBB①B…BMzBAMD
则
BBBB… BMAAAA…AN
freqz 计算数字滤波器Hz的频率响应。
HfreqzBAw计算由向量w指定的数字频率点上数字滤波器Hz的频率响
Created by ZhuangHeng
口口
口
数字信号处理第五版
应He结果存于H向量中。B和A仍为Hz的分子和分母多项式系数向量同上。
Hw freqzBAM计算出M个频率点上的频率响应，存放在H向量中，M
个频率存放在向量w中。freqz 函数自动将这M个频率点均匀设置在频率范围π上。
Hw freqzBAMwhole自动将M个频率点均匀设置在频率范围
π上。
当然，还可以由频率响应向量H得到各采样频点上的幅频响应函数和相频响应函数；
再调用plot绘制其曲线图。
HeabsH
φoangleH
式中，abs函数的功能是对复数求模，对实数求绝对值；angle 函数的功能是求复数的相角。
freqzBA 自动选取个频率点计算。不带输出向量的 freqz 函数将自动绘出固
定格式的幅频响应和相频响应曲线。所谓固定格式，是指频率范围为π频率和相位是
线性坐标，幅频响应为对数坐标。
其他几种调用格式可用命令 help查阅。
【例】已知Hzz分析其频率特性。
解 由Hzz可知极点为z幅频特性He相频特性φww
频响特性如图所示。用几何方法也容易确定，当w转到wπ时，极点向量的长
度始终为。
由该例可以得到结论：处于原点处的零点或极点，由于零点向量长度或者极点向量长
度始终为因此原点处的零极点不影响系统的幅频响应特性，但对相频特性有贡献。
HelI
o
φ
o ①
图 Hzz的频响特性
【例】设一阶系统的差分方程为
ynbynxn
用几何法分析其幅度特性。
解 由系统差分方程得到系统函数为
Hbb IzIIb
Created by ZhuangHeng
式中，b。系统极点zb零点z当B点从w逆时针旋转时，在w点，由
于极点向量长度最短，形成波峰；在wπ点形成波谷；z处零点不影响幅频响应。极零
点分布及幅度特性如图所示。
Imz IIHe°I
o b Rez π π
图 例插图
【例】 已知Hzz试定性画出系统的幅频特性。
解 Hzz
Hz的极点为z这是一个N阶极点，它不影响系统的幅频响应。零点有N个，由分
子多项式的根决定
zN 即 zNe
ze k…N
N个零点等间隔分布在单位圆上，设N极零点分布如图所示。当w从变化到
π时，每遇到一个零点，幅度为零，在两个零点的中间幅度最大，形成峰值。幅度谷值点频
率为：wπNkk…N。一般将具有如图所示的幅度特性的滤
波器称为梳状滤波器。
调用zplane和freqz求解本例的程序epm如下：
m例求解程序
置系统函数系数向量B和A BA
制零极点图 subplotzplaneBA
算频率响应 HwfreqzBA
subplotplotwpiabsHD 制幅频响应曲线
xlabelomegapi
ylabelTHejomega
axis
制相频响应曲线 subplotplotwpi angleH
xlabelomegapií
ylabelphiomega
运行上面的程序，绘制出阶梳状滤波器的零极点图和幅频特性、相频特性如图
所示。
第章时域离散信号和系统的频域分析
Created by ZhuangHeng
口
口
口
口
■■
口
口口口
口口
口口
口
口
数字信号处理第五版
F
oy
IHe
os
百
oL L
Real Part aπ mm
图 梳状滤波器的极零点分布及幅频、相频特性
几种特殊系统的系统函数及其特点
这一节介绍几种特殊的系统，即全通滤波器、梳状滤波器、最小相位系统等。
全通滤波器
如果滤波器的幅频特性对所有频率均等于常数或即
He≤w≤π
则该滤波器称为全通滤波器或称全通系统、全通网络。全通滤波器的频率响应函数可表
示成
Hee
式表明信号通过全通滤波器后，幅度谱保持不变，仅相位谱随φw改变，起纯相
位滤波作用。
全通滤波器的系统函数一般形式如下式：
ao
或者写成二阶滤波器级联形式：
Haa
上面两式中的系数均为实数。容易看出，全通滤波器系统函数Hz的构成特点是其分子、
分母多项式的系数相同，但排列顺序相反。下面证明式表示的滤波器具有全通幅
频特性。
Daa。 式中， 。由于系数a是实数，因此
DzDeDe
Created by ZhuangHeng
HeDe
这就证明了式表示的Hz具有全通滤波特性。
下面分析全通滤波器的零点和极点的分布规律。设z为
Hz的零点，按照式，z必然是Hz的极
点，记为pz则pz全通滤波器的极点和零
点互为倒数关系。如果再考虑到Dz和Dz的系数
为实数，其极点、零点均以共轭对出现，这样，复数零
点、复数极点必然以四个一组出现。例如，z是Hz的
零点，则必有零点z、极点p、piz。对
实数零极点，则以两个一组出现，且零点与极点互为倒
数关系。零极点位置示意图如图所示。
Im
A
pi
Rez
P×
图 全通滤波器一组零
极点示意
观察图如果将零点z和极点p组成一对，将零点z与极点p。组成一对，那
么全通滤波器的极点与零点便以共轭倒易关系出现，即如果z为全通滤波器的零点，则
z必然是全通滤波器的极点。因此，全通滤波器系统函数也可以写成如下形式：
Hs
显然，式中极点和零点互为共轭倒易关系。其全通特性的证明留作习题。应当注
意，为了保证分子、分母多项式系数是实数，极点、零点分别以共轭对形式出现，当N
时，零点、极点均为实数。
全通滤波器是一种纯相位滤波器，经常用于相位均衡。如果要求设计一个线性相位滤
波器，可以设计一个具有线性相位的FIR滤波器，也可以先设计一个满足幅频特性要求的
IIR 滤波器，再级联一个全通滤波器进行相位校正，使总的相位特性是线性的。IIR和FIR
滤波器设计分别在第章和第章介绍。
梳状滤波器
在前一节例中，曾提到具有如图所示的幅度特性的滤波器称为梳状滤波
器，显然，梳状滤波器起名于它的幅度特性形状。下面介绍一般梳状滤波器的构成方法。
设滤波器的系统函数为Hz我们知道，其频率响应函数He”以π为周期。将
Hz的变量z用z代替，得到Hz则相应的频率响应函数He是以πN为周期
的，在区间π上有N个相同频率特性周期。利用这种性质，可以构成各种梳状滤
波器。
Hza零点为极点为a所以Hz表示一个高通滤波 例如，
器。以z代替Hz的z得到：
Hza
第章
时域离散信号和系统的频域分析
Created by ZhuangHeng
口
数字信号处理第五版
当N时，零点为≈ek…极点为pVaek…。Hz
零极点分布和幅频响应特性绘制程序为figm其中a部分程序如下：
绘制程序：figm
a
B
Aa
subplot
zplaneBAtitlea零极点分布aN
HkwfreqzBA算频响特性aN
subplot
plotwpiabsHkmaxabsHk
xlabelomegapi
axis
titleb幅频特性aN
a
B
Aa
以下程序与a时相同省略。
运行本书程序集程序figm绘制出当Na和a时，Hz的零极
点分布和幅频响应特性曲线如图所示。
Real Part π
a零极点分布aN b幅频特性aN
o
Real Part π
c零极点分布aN d幅频特性aN
图 梳状滤波器的零极点分布和幅频响应特性
Created by ZhuangHeng
Imaginary Part
Imaginary Part
梳状滤波器可滤除输入信号中 π
wkk…N的频率分量。这种滤波器
N
可用于消除信号中的电网谐波干扰和其他频谱等间隔分布的干扰。
由图可见，a取值越接近幅频特性越平坦。将图和图比较，形
状很相似，不同的是每一个梳状周期的形状不同。显然，图对应的系统函数是由
z中变量z用z代替后得到的，用于消除电网谐波干扰时，特性不如Hz
的滤波性能好。但图对应的梳状滤波器适用于分离两路频谱等间隔交错分
布的信号，例如，彩色电视接收机中用于进行亮色分离和色分离等。
最小相位系统
一个因果稳定的时域离散线性非移变系统Hz其所有极点必须在单位圆内，但其零
点可在z平面上任意位置，只要频响特性满足要求即可。如果因果稳定系统Hz的所有零
点都在单位圆内，则称之为“最小相位系统”记为Hz反之，如果所有零点都在单位
圆外，则称之为“最大相位系统”记为Hmz若单位圆内、外都有零点，则称之为“混合
相位系统”。
最小相位系统在工程理论中较为重要。下面给出最小相位系统的几个重要特点。
任何一个非最小相位系统的系统函数Hz均可由一个最小相位系统Hz和一
个全通系统Hz级联而成，即
HzHmzHz
证明 假设因果稳定系统Hz仅有一个零点在单位圆外，令该零点为zz
z则Hz可表示为
HzHczHz
Hzz
d 因为Hz为最小相位系统，所以Hzzx也是最小相位系统，又因为
为全通系统，故HzHzHz。显然，HeHe。
该特点说明了在滤波器优化中很有用的结论：将系统位于单位圆外的零或极点z用
其镜像z代替时，不会影响系统的幅频响应特性。这一点在滤波器优化设计中已用到。
在那里，将单位圆外的极点用其镜像代替，以确保滤波器因果稳定。该结论为我们提供了
一种用非最小相位系统构造幅频特性相同的最小相位系统的方法：将非最小相位系统Hz
位于单位圆外的零点z用z代替k…mm。为单位圆外零点数目即得最
小相位系统Hz且Hz与Hz的幅频响应特性相同。
第章时域离散信号和系统的频域分析
在幅频响应特性相同的所有因果稳定系统集中，最小相位系统的相位延迟负的相
位值最小。
由式可知，任何一个非最小相位系统Hz的相位函数，是一个与Hz的幅
频特性相同的最小相位系统Hz的相位函数加上一个全通系统Hz的相位函数。可
Created by ZhuangHeng
数字信号处理第五版
以证明全通系统Hz的相位函数是非正的因此任意系统比最小相位系统多了一个负
相位，这样使最小相位系统具有最小相位延迟的性质，或者从时域说，最小相位系统的时
域响应波形延迟和能量延迟均最小。
最小相位系统保证其逆系统存在。给定一个因果稳定系统HzBzAz定
义其逆系统为
HwHB
当且仅当Hz为最小相位系统时，Hsyz才是因果稳定的物理可实现的。
逆滤波在信号检测及解卷积中有重要应用。例如，信号检测中的信道均衡器实质上就
是设计信道的近似逆滤波器。
习题与上机题
设Xe和Ye分别是xn和yn的傅里叶变换，试求下面序列的傅里叶变换：
xnn xn
xnyn xn
nxn xnyn
xn xn
w一衡数
已知
xesl
求Xe的傅里叶反变换xn。
线性时不变系统的频率响应频率响应函数HeHee如果单位脉冲
响应hn为实序列，试证明输入xnA coswnφ的稳态响应为
ynAHecoswnφa
设
“其他
将xn以为周期进行周期延拓，形成周期序列xn画出xn和xn的波形，求出
n的离散傅里叶级数Xk和傅里叶变换。
设题图所示的序列xn的FT用Xe表示，不直接求出Xe完成下列
运算或工作：
Created by ZhuangHeng
Xe
厂xedo
Xe
确定并画出傅里叶变换实部ReXe的时间序列xn
xePdo
xcd
xn
n
题图
试求如下序列的傅里叶变换：
tnonnn xnn
xnunun a xnaun
设：
xn是实偶函数，
xn是实奇函数，
分别分析推导以上两种假设下，其xn的傅里叶变换性质。
设xnRn试求xn的共轭对称序列xn和共轭反对称序列x。n并分
别用图表示。
已知xnauna分别求出其偶函数xn和奇函数xn的傅里叶变换。
若序列hn是实因果序列，其傅里叶变换的实部如下式：
Hgecosw
求序列hn及其傅里叶变换He。
若序列hn是实因果序列，h其傅里叶变换的虚部为
Hesina
求序列hn及其傅里叶变换He。
设系统的单位脉冲响应hnauna输入序列为
xnnn
第章时域离散信号和系统的频域分析
完成下面各题：
Created by ZhuangHeng
口口
口
口口
□
口口
口口
口
数字信号处理第五版
求出系统输出序列yn
分别求出xn、hn和yn的傅里叶变换。
已知xtcosπf。式中f。 Hz以采样频率f Hz对xt进行
采样，得到采样信号xt和时域离散信号xn试完成下面各题：
写出xt的傅里叶变换表示式Xj
写出xt和xn的表达式；
分别求出xt的傅里叶变换和xn的傅里叶变换。
求出以下序列的Z变换及收敛域：
un un
un δn
δn unun
求以下序列的Z变换及其收敛域，并在z平面上画出极零点分布图。
N rnRNn
xnArcoswnφunrwπ radφπ rad
≤n≤N z N≤n≤N
其他
式中，N。
已知
xa
求出对应Xz的各种可能的序列表达式。
已知 xnauna。分别求：
xn的Z变换；
nxn的Z变换；
aun的Z变换。
Xz 已知入 分别求：
收敛域z对应的原序列xn
收敛域z对应的原序列xn。
用部分分式法求以下Xz的反变换：
xa Iel
x贵
Created by ZhuangHeng
设确定性序列xn的自相关函数用下式表示：
ram∑znnm
试用xn的Z变换Xz和傅里叶变换Xe分别表示自相关函数的Z变换Rz和傅里
叶变换Re。
用Z变换法解下列差分方程：
ynynun ynn≤
ynynun yynn
ynynynn
yyynn≤
设线性时不变系统的系统函数Hz为
Hza a为实数
在z平面上用几何法证明该系统是全通网络，即He常数；
参数a如何取值，才能使系统因果稳定画出其极零点分布及收敛域。
设系统由下面差分方程描述：
ynynynxn
求系统的系统函数Hz并画出极零点分布图；
限定系统是因果的，写出Hz的收敛域，并求出其单位脉冲响应hn
限定系统是稳定性的，写出Hz的收敛域，并求出其单位脉冲响应hn。
已知线性因果网络用下面差分方程描述：
ynynxnxn
求网络的系统函数Hz及单位脉冲响应hn
写出网络频率响应函数He的表达式，并定性画出其幅频特性曲线；
设输入xne求输出yn。
已知网络的输入和单位脉冲响应分别为
xnaunhnbun ab
试用卷积法求网络输出yn
试用ZT法求网络输出yn。
线性因果系统用下面差分方程描述：
ynryncosθrynxn 第章时域离散信号和系统的频域分析
式中，xnaunarθ常数，试求系统的响应yn。
如果xn和xn是两个不同的因果稳定实序列，求证：
宗xeXedxedaxeda
式中，Xe和Xe分别表示xn和xn的傅里叶变换。
若序列hn是因果序列，其傅里叶变换的实部如下式：
Created by ZhuangHeng
口口
口 口
□口
口
口口
口
数字信号处理第五版
HaCa cosla
求序列hn及其傅里叶变换He。
若序列hn是因果序列，h其傅里叶变换的虚部为
Heaa cosla
求序列hn及其傅里叶变换He。
°假设系统函数如下式：
Hz
试用MATLAB语言判断系统是否稳定。
假设系统函数如下式：
H
画出极、零点分布图，并判断系统是否稳定；
求出输入单位阶跃序列un检查系统是否稳定。
下面四个二阶网络的系统函数具有一样的极点分布：
Hz
H。
H
Hz
试用MATLAB语言研究零点分布对于单位脉冲响应的影响。要求：
分别画出各系统的零、极点分布图；
分别求出各系统的单位脉冲响应，并画出其波形；
分析零点分布对于单位脉冲响应的影响。
Created by ZhuangHeng
章 第
离散傅里叶变换DFT
傅里叶变换和Z变换是数字信号处理中常用的重要数学变换。对于有限长序列，还有
一种更为重要的数学变换，即本章要讨论的离散傅里叶变换Discrete Fourier Transform
DFT。DFT之所以更为重要，是因为其实质是有限长序列傅里叶变换的有限点离散采样，
从而实现了频域离散化，使数字信号处理可以在频域采用数值运算的方法进行，这样就大
大增加了数字信号处理的灵活性。更重要的是，DFT有多种快速算法，统称为快速傅里叶
变换Fast Fourier TransformFFT从而使信号的实时处理和设备的简化得以实现。因
此，时域离散系统的研究与应用在许多方面取代了传统的连续时间系统。所以说，DFT不
仅在理论上有重要意义，而且在各种信号的处理中亦起着核心作用。
本章主要讨论DFT的定义、物理意义、基本性质以及频域采样和DFT的应用举例等
内容。
离散傅里叶变换的定义及物理意义
DFT的定义
设xn是一个长度为M的有限长序列，则定义xn的N点离散傅里叶变换为
xkDFTLZn∑xmw k…N
Xk的离散傅里叶逆变换Inverse Discrete Fourier TransformIDFT为
xmIDFTXA六xAw n…N
Created by ZhuangHeng
第章君散博里叶变奂□n下
口
口
数字信号处理第五版
式中，WeN称为DFT变换区间长度，N≥M。通常称式和式为离
散傅里叶变换对。为了叙述简洁，常常用DFTxn、和IDFTXk、分别表示N点离
散傅里叶变换和N点离散傅里叶逆变换。下面证明IDFTXk的唯一性。
把式代入式，有
IDFTXA六z∑zmWw
∑m六w
由于
六wm为整数
所以，在变换区间上满足下式：
IDFTXkNrn ≤n≤N
由此可见，式定义的离散傅里叶逆变换是唯一的。
【例】 xnRn求xn的点和点DFT。
解 设变换区间N则
Xkanwe
o
设变换区间N则
xA∑mw
k…
由此例可见，xn的离散傅里叶变换结果与变换区间长度N的取值有关。对DFT与
Z变换和傅里叶变换的关系及DFT的物理意义进行讨论后，上述问题就会得到解释。
DFT与傅里叶变换和Z变换的关系
设序列xn的长度为M其Z变换和NN≥M点DFT分别为
XzZTxn∑zn
xkDFTrn∑nw k…N
比较上面二式可得关系式
Created by ZhuangHeng
XkXzk…N
或
XkXeL k…N
式表明序列xn的N点DFT是xn的Z变换在单位圆上的N点等间隔采
样。式则说明Xk为xn的傅里叶变换Xe在区间π上的N点等间隔采
样。这就是DFT的物理意义。由此可见，DFT的变换区间长度N不同，表示对Xe在区
间π上的采样间隔和采样点数不同，所以DFT的变换结果不同。上例中，
xnRnDFT变换区间长度N分别取、时，Xe和Xk的幅频特性曲线图如
图所示。由此容易得到xnRn的点DFT为XkDFTxnk
这一特殊的结果在下面将得到进一步解释。
Ixca
Oπ
axn的幅频特性曲线
×
k
bxn的点DFT
xx
k
exn的点DFT
图 Rn的FT和DFT的幅度特性关系 第章离散傅里叶变换DF
DFT的隐含周期性
前面定义的DFT变换对中，xn与Xk均为有限长序列，但由于W～的周期性，使
和式中的Xk和xn隐含周期性，且周期均为N。对任意整数m总有
WNWkm为整数，N为自然数
所以式中，Xk满足：
xkmNxmwzmwxk
Created by ZhuangHeng
口
口 口
口口
口
口口
口
数字信号处理第五版
实际上，任何周期为N的周期序列n都可以看做长度为N的有限长序列xn的周
期延拓序列，而xn则是xn的一个周期，即
n∑xnmN
xninR√n
上述关系如图a和b所示。一般称周期序列xn中从n到N的第一个周期
为xn的主值区间，而主值区间上的序列称为xn的主值序列。因此xn与xn的上述
关系可叙述为：xn是xn的周期延拓序列，xn是xn的主值序列。
为了以后叙述简洁，当N大于等于序列xn的长度时，将式用如下形式表示：
xnxn
式中xn、表示xn以N为周期的周期延拓序列，n、表示模N对n求余，即如果
nMNn≤n≤NM为整数
则
nn
例如，Nxnxn。则有
xx。x
xx。x
所得结果符合图a和b所示的周期延拓规律。
哥
n
axn
xns
n
bxn的周期延拓序列，N
n
n
cxn的周期延拓序列，N
图 xn及其周期延拓序列
应当说明，若xn实际长度为M延拓周期为N则当NM时，式仍表示
以N为周期的周期序列，但和式仅对N≥M时成立。图a中xn
实际长度M当延拓周期N时，xn如图c所示。
Created by ZhuangHeng
如果xn的长度为M且xnxnNN≥M则可写出n的离散傅里叶级数
表示式
XAnwm、Wxnw
n÷×AW÷xkW
式中
XkXkRk
即Xk为Xk的主值序列。将和式与DFT的定义和式
相比较可知，有限长序列xn的N点离散傅里叶变换Xk正好是xn的周期延拓序列
xn、的离散傅里叶级数系数Xk的主值序列，即XkXkRk。后面要讨论的
频域采样理论将会加深对这一关系的理解。我们知道，周期延拓序列频谱完全由其离散傅
里叶级数系数Xk确定，因此，Xk实质上是xn的周期延拓序列xn、的频谱特
性，这就是N点DFT的第二种物理解释物理意义。
现在解释DFTRnk。根据DFT第二种物理解释可知，DFTRn表示
Rn以为周期的周期延拓序列Rn的频谱特性，因为Rn是一个直流序列，
只有直流成分即零频率成分。
用MATLAB计算序列的DFT
MATLAB提供了用快速傅里叶变换算法FFT算法见第章介绍计算 DFT的函数
fft其调用格式如下：
XkfftxnN
调用参数xn为被变换的时域序列向量，N是DFT变换区间长度，当N大于xn的长度
时，fft 函数自动在xn后面补零。函数返回xn的N点DFT变换结果向量Xk这时，
XkDFTxnxXkkkN。当N小于xn的长度时，fft函数计算xn
的前面N个元素构成的N长序列的N点DFT忽略xn后面的元素。
ifft 函数计算IDFT其调用格式与fft 函数相同，可参考 help文件。
【例】 设xnRnXeFTxn。分别计算 Xe在频率区间
π上的点和点等间隔采样，并绘制Xe采样的幅频特性图和相频特性图。
解 由DFT与傅里叶变换的关系知道，Xe在频率区间π上的点和点
等间隔采样，分别是xn的点和点DFT。调用fft 函数求解本例的程序epm
如下：
程序epm
FT的MATLB计算
xn 人时域序列向量xnRn
Xkfftxn 算xn的点DFT
Xkfftxn 算xn的点DFT
第章离散傅里叶变换DFT
Created by ZhuangHeng
口
口
口
口
数字信号处理第五版
下为绘图部分省略，程序集中有
程序运行结果如图所示。
幅度 幅度
oπ π
a点DFT的幅频特性图 c点DFT的幅频特性图
相位 相位
π π
b点DFT的相频特性图 d点DFT的相频特性图
图 程序epm运行结果
离散傅里叶变换的基本性质
线性性质
如果xn和xn是两个有限长序列，长度分别为N和N且
ynarnbxn
式中，a、b为常数，取N≥maxNN则yn的N点DFT为
YkDFTLynaXkbXk≤k≤N
其中Xk和Xk分别为xn和xn的N点DFT。
循环移位性质
序列的循环移位
设xn为有限长序列，长度为MM≤N则rn的循环移位定义为
ynxnmR～n
式表明，将xn以N为周期进行周期延拓得到xnxn。再将xn左移m
得到xnm最后取xnm的主值序列则得到有限长序列xn的循环移位序列yn。
MNm时，xn及其循环移位过程如图所示。显然，yn是长度为N
Created by ZhuangHeng
的有限长序列。观察图可见，循环移位的实质是将xn左移m位，而移出主值区
≤n≤N的序列值又依次从右侧进入主值区。“循环移位”就是由此得名的。
ol
n
axn
n
bxn
L
n n
cxn。 dxnRgn
图 xn及其循环移位过程
由循环移位的定义可知，对同一序列xn和相同的位移m当延拓周期N不同时，
ynxnmNRn则不同。请读者画出NMm时，xn的循环移位序
列yn波形图。
时域循环移位定理
设xn是长度为MM≤N的有限长序列，yn为xn的循环移位，即
ynxnmNRn
则
YkDFTyn、WNXk
其中 XkDFTxnN≤k≤N
证明
YkDFTSynx∑xnm、RanwZxnmW
令nmn则有
YkZxwWwanWS
由于上式中求和项xnNW以N为周期，因此对其在任一周期上的求和结果相同。将
上式的求和区间改在主值区，则得
Ykw∑xmWw∑znww×k
频域循环移位定理
如果
第章
离散傅里叶变换DF
XkDFTxn、≤k≤N
YkXCkD、RNk
Created by ZhuangHeng
口
口口
口口
口
口
数字信号处理第五版
则
ynIDFTYk、WNxn
式的证明方法与时域循环移位定理类似，直接对YkXCk、Rk进行
IDFT即得证。
循环卷积定理
时域循环卷积定理是DFT中最重要的定理，具有很强的实用性。已知系统输入和系统
的单位脉冲响应，计算系统的输出，以及用FFT实现FIR滤波器等，都是基于该定理的。
下面首先介绍循环卷积的概念和计算循环卷积的方法，然后介绍循环卷积定理。
两个有限长序列的循环卷积
设序列hn和xn的长度分别为N和M。hn与xn的L点循环卷积定义为
vnZhmxnmRm
式中，L称为循环卷积区间长度，L≥maxNM。上式显然与第章介绍的线性卷积不同，
为了区别线性卷积，用◎表示循环卷积，用D表示L点循环卷积，即ynhnDxn。观
察式，xnm是以L为周期的周期信号，n和m的变化区间均是L
因此直接计算该式比较麻烦。计算机中采用矩阵相乘或快速傅里叶变换FFT的方法计算
循环卷积。下面介绍用矩阵计算循环卷积的公式。
当n…L时，由xn形成的序列为：xx…xL。令
nm…L由式中xnm形成xn的循环倒相序列为
xxx…xL
xxLxL…x
与序列xn进行对比，相当于将第一个序列值x不动，将后面的序列xx…
xL反转°再放在x的后面。这样形成的序列称为xn的循环倒相序列。
令nm…L由式中xnm形成的序列为
xLxx…xL
xxxL…x
观察上式等号右端序列，它相当于xn的循环倒相序列向右循环移一位，即向右移位，
移出区间L的序列值再从左边移进。
再令nm…L此时得到的序列又是上面的序列向右循环移位。
依次类推，当n和m均从变化到L时，得到一个关于xnm的矩阵如下：
xrL xL
xx xL… x
Created by ZhuangHeng
上面矩阵称为xn的L点“循环卷积矩阵”其特点是：
第行是序列xx…xL的循环倒相序列。注意，如果xn的长
度ML则需要在xn末尾补LM个零后，再形成第一行的循环倒相序列。
第行以后的各行均是前一行向右循环移位形成的。
矩阵的各主对角线上的序列值均相等。
有了上面介绍的循环卷积矩阵，就可以写出式的矩阵形式如下： E
h x
按照上式，可以在计算机上用矩阵相乘的方法计算两个序列的循环卷积，这里关键是先形
成循环卷积矩阵。上式中如果hn的长度NL则需要在hn末尾补LN个零。
【例】 计算下面给出的两个长度为的序列hn与xn的点和点循环
卷积。
xnxxxx
hnhhhh
解 按照式写出hn与xn的点循环卷积矩阵形式为
hn与xn的点循环卷积矩阵形式为
Lo
第章离散傅里叶变换DFT
hn和xn及其点和点循环卷积结果分别如图a、b、c和d所示。请读者
计算验证本例的点循环卷积结果等于hn与xn的线性卷积结果。后面将证明，当循
环卷积区间长度L大于等于ynhnxn的长度时，循环卷积结果就等于线性
卷积。
Created by ZhuangHeng
口
口
口
口
口
口
口
口口
口 口
口
口口
口口
口 口
口口
a口
数字信号处理第五版
其刀 hn
o
n n
axn bhn
yn s yn
n n
c点循环卷积 d点循环卷积
图 序列及其循环卷积波形
循环卷积定理
有限长序列xn和xn的长度分别为N和NN≥maxNNxn和xn
的N点循环卷积为
amaWOzwAmnnmJRam
则xn的N点DFT为
其中
XkDFTxnnXkXk
XkDFTxnNXkDFTxn
证明 直接对式两边进行DFT则有
XkDFTxn、
Zzmtnm、Rnw
xmznmw
令nmn则有
xzmmw
zmwnw
因为上式中xnWN是以N为周期的，所以对其在任一个周期上求和的结果不变。
因此
xAZxmw·zw
XkXk≤k≤N
由于XkDFTxnXkXkXkXk因此
xnIDFTXkxn×xnxnxn
Created by ZhuangHeng
即循环卷积亦满足交换律。
作为习题请读者证明以下频域循环卷积定理：
如果xnxnxn则
XkDFTxnx六xkOXk
∑xDXkAJRa a
或
Xk六xkOXk六∑xCDxkD、JRkb
式中
XkDFTaOo≤k≤N
相对频域循环卷积定理，称式为时域循环卷积定理。
复共轭序列的DFT
设xn是xn的复共轭序列，长度为NXkDFTxn则
DFTxnXNk ≤k≤N
且XNX。
证明 根据DFT的唯一性，只要证明式右边等于左边即可。
xNkxnwSZxnw
∑xnwDFTan。
又由Xk的隐含周期性，有
XNX
用同样的方法可以证明
DFTxNnxXk
DFT的共轭对称性
第章离散傅里叶变换DFT
如前所述，序列傅里叶变换满足共轭对称性，其对称性是指关于坐标原点的纵坐标的
对称性。DFT也有类似的对称性，但在DFT中涉及的序列xn及其离散傅里叶变换Xk
均为有限长序列，且定义区间为到N所以这里的对称性是指关于N点的对称性。
下面讨论DFT的共轭对称性。
有限长共轭对称序列和共轭反对称序列
为了区别于傅里叶变换中所定义的共轭对称或共轭反对称序列，下面用xn和
Created by ZhuangHeng
数字信号处理第五版
xn分别表示有限长共轭对称序列和共轭反对称序列，则二者满足如下关系式：
xnNn ≤n≤N a
xnxNn≤n≤N b
当N为偶数时，将上式中的n换成Nn可得到：
nxn ≤n≤
nxn ≤n≤
上式更清楚地说明了有限长共轭对称序列是关于nN点共轭对称。容易证明，如同任
何实函数都可以分解成偶对称分量和奇对称分量一样，任何有限长序列xn都可以表示成
其共轭对称分量和共轭反对称分量之和，即
xnxnxn ≤n≤N
将上式中的n换成Nn并取复共轭，再将a式和b式代入，得到：
xNnxNnxNnxnxn
式分别加减式，可得
xnznxNn a
rnznxNn b
DFT的共轭对称性
如果将xn表示为
xnrnjxn
其中
xnReznxnxn
jxnj Imxnznxn
那么由式和a式可得
DFTxnDFTrnxnXkXNkXk
由式和b式可得
DFTLiznDFTznxn号XkxNkXk
由DFT的线性性质即可得
XkDFTxnXkX。k
其中，XkDFTxn是Xk的共轭对称分量，XkDFTjxn是Xk的共
Created by ZhuangHeng
轭反对称分量。
如果将xn表示为
xnxnxn ≤n≤N
nxnxNn是xn的共轭对称分量，nxn 其中，
xNn是xn的共轭反对称分量，那么由式可得
DFTznDFTxnxNnXkXkReXk
DFTxnDFTLznxNnXkxkj ImXk
因此
XkDFTxnXkjXk
其中
XgkReXkDFTxn
jXkjImXkDFTxn
综上所述，可总结出DFT的共轭对称性质：如果序列xn的DFT为Xk则xn
的实部和虚部包括j的DFT分别为Xk的共轭对称分量和共轭反对称分量；而xn的
共轭对称分量和共轭反对称分量的DFT分别为Xk的实部和虚部乘以j。
另外，请读者根据上述共轭对称性证明有限长实序列DFT的共轭对称性见本章习题
题。
设xn是长度为N的实序列，且XkDFTxnN则Xk满足如下对称性：
Xk共轭对称，即
XkXNkk…N
如果xn是实偶对称序列，即xnxNn则Xk实偶对称，即
XkXNk
如果xn是实奇对称序列，即xnxNn则Xk纯虚奇对称，即
XkXNk
实际中经常需要对实序列进行DFT利用上述对称性质，可减少DFT的运算量，提高
运算效率。例如，计算实序列的N点DFT时，当N偶数时，只需计算 Xk的前面
N点，而N奇数时，只需计算Xk的前面N点，其他点按照式
即可求得。例如，XNXXNX…这样可以减少近一半运
算量。
【例】 利用DFT的共轭对称性，设计一种高效算法，通过计算一个N点DFT
就可以计算出两个实序列xn和xn的N点DFT。
解 构造新序列xnxnjxn对xn进行N点DFT得到：
XkDFTxnXkXk
由、和式得到：
第章
离散傅里叶变换DF
Created by ZhuangHeng
口
口
口
数字信号处理第五版
X。kDFTLznXkxNk
XkDFTLiznXkxNk
所以，由Xk可以求得两个实序列xn和xn的N点DFT
xkDFTznXkxNk
XkDFTrnj XkxNk
频率域采 样
时域采样定理告诉我们，在一定条件下，可以由时域离散采样信号恢复原来的连续信
号。那么能不能也由频域离散采样恢复原来的信号或原连续频率函数其条件是什么
内插公式又是什么形式本节就上述问题进行讨论。
设任意序列xn的Z变换为
X∑anz
且Xx的收敛域包含单位圆即xn存在傅里叶变换。在单位圆上对Xz等间隔采样N
点，得到：
XkXz∑zne∑znW ≤k≤N
显然，式表示在区间π上对xn的傅里叶变换Xe的N点等间隔采样。将
Xk看做长度为N的有限长序列xn的DFT即
xNnIDFTXk≤n≤N
下面推导序列xxn与原序列xn之间的关系，并导出频域采样定理。
由DFT与DFS的关系可知，Xk是xnn以N为周期的周期延拓序列xn的离散
傅里叶级数系数Xk的主值序列，即
XkXk、DFSn
XkXkRNk
nx×n。IDFSCXA卡xW÷xkW
将式代入上式得
m÷xmWwam÷w
Created by ZhuangHeng
式中
mniNi为整数 六w 其他m
因此
n∑zniN
所以
znnR、n∑zniNRn
式说明，Xz在单位圆上的N点等间隔采样Xk的N点IDFT是原序列xn以
N为周期的周期延拓序列的主值序列。综上所述，可以总结出频域采样定理：
如果序列xn的长度为M则只有当频域采样点数N≥M时，才有
xnIDFTXkxn
即可由频域采样Xk恢复原序列xn否则产生时域混叠现象。
满足频域采样定理时，频域采样序列Xk就是原序列xn的N点DFT所以 Xk
的N点IDFT是原序列xn必然可以由Xk恢复Xz和Xe。下面推导用频域采样
Xk表示Xz和Xe的内插公式和内插函数。设序列xn长度为M在频域π上
等间隔采样N点，N≥M则有
xzzne
XkXz k…N
因为满足频域采样定理，所以式中
znIDFTXA÷xckW
将上式代入Xz的表示式中，得到：
xexkw÷xkZw
六xAW a 章离散博里变换□山卜
式中，W因此
x六xk b
令
e六—w
则
Created by ZhuangHeng
数字信号处理第五版
xzxkg
式称为用Xk表示Xz的复频域内插公式，pz称为复频域内插函数。将ze
代入a式，并进行整理化简，可得
xexkem
wNsinN。
式称为频域内插公式，pw称为频域内插函数。在数字滤波器的结构与设计
中，我们将会看到，频域采样理论及有关公式可提供一种有用的滤波器结构和滤波器设计
途径，式有助于分析FIR滤波器频率采样设计法的逼近性能。
【例】长度为的三角形序列xn如图b所示。编写MATLAB程序
验证频域采样理论。
解 解题思想：先计算 xn的点DFT得到其频谱函数Xe在频率区间π
上等间隔点采样Xk再对Xk隔点抽取，得到Xe在频率区间π上等间
隔点采样Xk。最后分别对Xk和Xgk求IDFT得到：
xnIDFTXk
xnIDFTXk
绘制xn和xn波形图验证频域采样理论。
MATLAB求解程序epm如下：
数字信号处理第四版》第章例程序epm
域采样理论验证
MNnM
xaMxb ceilMxnxaxb生M长三角波序列xn
Q点FFTxn Xkfftxn
Xkfftxn 点FFTxn
点IFFTXk得到xn xnifftXk
XkXkN 点抽取Xk得到Xk
xnifftXkN 点IFFTXk得到xn
以下绘图部分省略。
程序运行结果如图所示。图a和b分别为Xe和xn的波形；图
c和d分别为Xe的点采样Xk和xnIDFTXk波形图；图
e和f分别为Xe的点采样Xk和xnIDFTXk波形图；由
于实序列的DFT满足共轭对称性，因此频域图仅画出π上的幅频特性波形。本例中
xn的长度M。从图中可以看出，当采样点数NM时，xn确实等于原三角序列
xn以为周期的周期延拓序列的主值序列。由于存在时域混叠失真，因而xn≠xn
当采样点数NM时，无时域混叠失真，xnIDFTXkxn。
Created by ZhuangHeng
IxemgI
ux
ot n
aFTxn b三角波序列xn
Xk ulx
L
k n
c点频域采样 d点IDFTXk
krrX xira
k n
e点频域采样 点IDFTXk
图 频域采样定理验证
DFT的应用举例
DFT的快速算法FFT的出现，使DFT在数字通信、语音信号处理、图像处理、功率
谱估计、系统分析与仿真、雷达信号处理、光学、医学、地震以及数值分析等各个领域都得
到广泛应用。然而，各种应用一般都以卷积和相关运算的具体计算为依据，或者以DFT作
为连续傅里叶变换的近似为基础。所以本节主要介绍用DFT计算卷积的基本原理以及用
DFT对连续信号和序列进行谱分析等最基本的应用。只要掌握了这两种基本应用的原理，
就为用DFT解决数字滤波和系统分析等问题打下了基础。
用DFT计算线性卷积
用DFT计算循环卷积很简单。设hn和xn的长度分别为N和M其L点循环卷积为
vnhnrnZhmznmRm
且
XkDFTaco≤k≤LL≥maxNM
则由DFT的时域循环卷积定理有
YekDFTynHkXk≤k≤L
第章
离散傅里叶变换DFT
Created by ZhuangHeng
由此可见，循环卷积既可以在时域直接计算，也可以按照图所示的计算框图在频域
计算。由于DFT有快速算法，当L很大时，在频域计算循环卷积的速度快得多，因而常用
DFTFFT计算循环卷积。
数字信号处理第五版
hn 补LN个零 L点DFT Hk
× Yek L点IDFT yn
xn 补LM个零 L点DFT Xk
图 用DFT计算循环卷积的原理框图
在实际应用中，为了分析时域离散线性时不变系统或者对序列进行滤波处理等，需要计
算两个序列的线性卷积。与计算循环卷积一样，为了提高运算速度，也希望用DFTFFT计算
线性卷积。而DFT只能直接用来计算循环卷积，因此，下面先导出线性卷积和循环卷积之间
的关系以及循环卷积与线性卷积相等的条件，最后得出用图计算线性卷积的条件。
假设hn和xn都是有限长序列，长度分别是N和M。它们的线性卷积和循环卷积
分别表示如下：
ymhnznZhmanm
ynhnrn∑hcmrnmERm
其中
L≥maxNMxn∑xnL
所以
vmhmnmLRmhmrcnLmRn
对照式可以看出，上式中
∑hmrniLmynL
即
vnvnLRn
式说明，yn等于yn以L为周期的周期延拓序列的主值序列。我们知道，
yn长度为NM因此只有当循环卷积长度L≥NM时，yn以L为周期进行
周期延拓时才无时域混叠现象。此时取其主值序列显然满足ynyn。由此证明了循
环卷积等于线性卷积的条件是L≥NM。图中画出了hn、xn、hnxn以
及L分别取、、时hn①xn的波形。由于hn长度Nxn长度M
NM因此只有L≥时，hnDrn波形才与hnxn相同。
Created by ZhuangHeng
是 xn
n
n
ahn波形 bxn波形
yn ydn
n
n
cyinhn°xn d点循环卷积
n yn
n
n
e点循环卷积 点循环卷积
图 线性卷积与循环卷积波形图
综上所述，取L≥NM则可按照如图所示的计算框图用DFTFFT计算
线性卷积。其中DFT和IDFT通常用快速算法FFT来实现，故常称其为快速卷积。
实际上，经常遇到两个序列的长度相差很大的情况，例如MN。若仍选取L≥NM
以L为循环卷积区间，并用上述快速卷积法计算线性卷积，则要求对短序列补很多零
点，而且长序列必须全部输入后才能进行快速计算。因此要求存储容量大，运算时间长，并
使处理延时很大，不能实现实时处理。况且在某些应用场合，序列长度不定或者认为是无
限长，如电话系统中的语音信号和地震检测信号等。显然，在要求实时处理时，直接套用上
述方法是不行的。解决这个问题的方法是将长序列分段计算，这种分段处理方法有重叠相
加法和重叠保留法两种。下面只介绍重叠相加法，重叠保留法作为本章习题留给读者
讨论。
设序列hn长度为Nxn为无限长序列。将xn等长分段，每段长度取M则 第章离散博里叶变换DrT
xn∑xn xnxnRnkM a
于是，hn与xn的线性卷积可表示为
ynhnxnhn∑zmZhnxnn b
式中
ynhnxn c
b式说明，计算hn与xn的线性卷积时，可先计算分段线性卷积ynhn
Created by ZhuangHeng
口口
口
口
口口
口
口
口
口
口
数字信号处理第五版
xn然后把分段卷积结果叠加起来即可，如图所示。每一分段卷积yn的长度
为NM因此相邻分段卷积yn与yn有N个点重叠，必须把重叠部分的
yn与yin相加，才能得到正确的卷积序列yn。显然，可用图所示的快速卷
积法计算分段卷积yn其中LNM。由图可以看出，当第二个分段卷积
yn计算完后，叠加重叠点便可得输出序列yn的前M个值；同样道理，分段卷积
yn计算完后，就可得到yn第i段的M个序列值。因此，这种方法不要求大的存储容
量，且运算量和延时也大大减少，最大延时TpmxMTT。T是系统采样间隔，T。是
计算个分段卷积所需时间，一般要求T。MT。这样，就实现了边输入边计算边输出，
如果计算机的运算速度快，可以实现实时处理。
hm
N
n
xn
xon xn xn
M M M
n
yon
NM
N
n
yin
yn
NM
NM
n
nyonynyn…
M M
MN
图 用重叠相加法计算线性卷积的时域关系示意图
用DFT 计算分段卷积yn的方法如下：
iLNM计算并保存HkDFThn
读入xnxnRMniM构造变换区间L上的序列n
xniMRn实际中就是将xn的M个值存放在长度为M的数组中，并计算Xk
DFTxn
YkHkXk
jnynkMRnIDFTYkn…L
计算： voMMNInM重蚕区不加
ii返回。
Created by ZhuangHeng
应当说明，一般xn是因果序列，假设初始条件yn。
MATLAB信号处理工具箱中提供了一个函数fftfilt该函数用重叠相加法实现线性卷
积的计算。调用格式为：yfftfilthxM。调用参数中，h是系统单位脉冲响应向量；x
是输入序列向量；y是系统的输出序列向量h与x的卷积结果M是由用户选择的输入
序列x的分段长度，缺省M时，默认输入序列x的分段长度M。
【例】 假设hnRnxncosπncosπnun用重叠相
加法计算ynhnxn并画出hn、xn和yn的波形。
解 hn的长度为N对xn进行分段，每段长度为M。计算hn和xn的
线性卷积的MATLAB程序如下：
重叠相加法的MATLAB实现程序：epm
LxNM 为信号序列xn长度
hnonesN hnlhnzerosLxN 生hn其后补零是为了绘图好看
nLx
xncospincospin 生xn的Lx个样值
ynfftfilthnxnM 用fftfilt用重叠相加法计算卷积
下为绘图部分省略
运行程序画出hn、xn和yn的波形如图所示。请读者从理论上证明yn
的稳态波形是单一频率的正弦波。
hn
ux
yn
第章离散傅里叶变换DFT
n
图 例的求解程序运行结果
运行绘图程序figm可以得到用重叠相加法求解本例题的x nyn和yn
y。nynynyn如图所示。
Created by ZhuangHeng
口
数字信号处理第五版
hn
ux
a°x
虽
ux
xm
ay
uy
yn
yn
yn
ol
。
。
。
。
l
n
图 重叠相加法时域波形
Created by ZhuangHeng
用DFT对信号进行谱分析
所谓信号的谱分析，就是计算信号的傅里叶变换。连续信号与系统的傅里叶分析显然
不便于直接用计算机进行计算，使其应用受到限制。而DFT是一种时域和频域均离散化的
变换，适合数值运算，成为用计算机分析离散信号和系统的有力工具。对连续信号和系统，
可以通过时域采样，应用DFT进行近似谱分析。下面分别介绍用DFT对连续信号和离散
信号序列进行谱分析的基本原理和方法。
用DFT对连续信号进行谱分析
工程实际中，经常遇到连续信号xt其频谱函数X。j也是连续函数。为了利用
DFT对xt进行频谱分析，先对xt进行时域采样，得到xnxnT再对xn进
行DFT得到的Xk则是xn的傅里叶变换Xe在频率区间π上的N点等间隔
采样。这里xn和Xk均为有限长序列。然而，由傅里叶变换理论知道，若信号持续时间
有限长，则其频谱无限宽；若信号的频谱有限宽，则其持续时间必然为无限长。所以严格地
讲，持续时间有限的带限信号是不存在的。因此，按采样定理采样时，上述两种情况下的采
样序列xnxnT均应为无限长，不满足DFT的变换条件。实际上对频谱很宽的信号，
为防止时域采样后产生频谱混叠失真，可用预滤波器滤除幅度较小的高频成分，使连续信
号的带宽小于折叠频率。对于持续时间很长的信号，采样点数太多，以致无法存储和计算，
只好截取有限点进行 DFT。由上述可见，用DFT对连续信号进行频谱分析必然是近似的，
其近似程度与信号带宽、采样频率和截取长度有关。实际上从工程角度看，滤除幅度很小
的高频成分和截去幅度很小的部分时间信号是允许的。因此，在下面分析中，假设xt是
经过预滤波和截取处理的有限长带限信号。
设连续信号xt持续时间为T最高频率为f。如图a所示。x的傅里叶
变换为Xj对xt进行时域采样得到xnxnTxn的傅里叶变换为Xe。
由假设条件可知 xn的长度为
NTF
式中，T为采样间隔，FT为采样频率。用Xk表示 xn的N点DFT下面推导出
Xk与Xj的关系，最后由此关系归纳出用Xk表示X。j的方法，即用DFT对连
续信号进行谱分析的方法。
由式知道，xn的傅里叶变换Xe与xt的傅里叶变换Xj满足如下
关系：
xe÷∑xim
将wT代人上式，得到：
xe÷∑xa“×Gia
Created by ZhuangHeng
第章离散傅里叶变换DF
式中
XGja∑xiam
表示模拟信号频谱Xj的周期延拓函数。由xn的N点DFT的定义有
XkDFTznxXe一 ≤k≤N
将式代入式，得到：
口口
口
数字信号处理第五版
Xkxe—jk—ik ≤k≤N
式说明了Xk与Xj的关系。为了符合一般的频谱描述习惯，以频率f为自变
量，整理式。令
cx
则式变为
xA×“E k…N
由此可得
XkFTXkT·DFTxnk…N
式中，F表示对模拟信号频谱的采样间隔，所以称之为频率分辨率，TNT为截断时间长度。
F立
x xf
a T。 f。 f。
xn F xo
b T F F F NT xn XkF
c
NT nT NDF F
图 用DFT分析连续信号谱的原理示意图
式说明，可以通过对连续信号采样并进行DFT再乘以T得到模拟信号频谱的
周期延拓函数在第一个周期F上的N点等间隔采样XkF如图所示。对满足
假设的持续时间有限的带限信号，在满足时域采样定理时，XkF包含了模拟信号频谱的全
部信息k…N表示正频率频谱采样；kNN…N表示
负频率频谱采样。所以，上述分析方法不丢失信息，即可由Xk恢复Xj或xt。
Created by ZhuangHeng
但直接由分析结果Xk看不到Xj的全部频谱特性，而只能看到N个离散采样点
的谱线，这就是所谓的栅栏效应。对实信号，其频谱函数具有共轭对称性，所以分析正频率
频谱就足够了。不存在频谱混叠失真时，正频率F频谱采样为
XkFTXkT·DFTxnNk…N
值得注意，如果xt持续时间无限长，上述分析中要进行截断处理，所以会产生所谓的
截断效应，从而使谱分析产生误差。本节最后将讨论上述误差问题产生的原因及改进措施。
下面举例说明截断效应。理想低通滤波器的单位冲激响应ht及其频响函数H
分别如图a、b所示图a中只画出h。t所截取的一段。图中，
htsifra a
现在用DFT来分析ht的频率响应特性。由于ht的持续时间为无穷长，因此要截取一
段T假设Ts采样间隔Ts即采样频率F Hz采样点数NTT
频域采样间隔FT Hz由于h为实信号，因此仅取正频率F频
谱采样：
HkFT·DFThn ≤k≤
其中，hnhnTRn。
hRT
T s
a
HG
fHz
b HA
第章离散傅里叶变换DFT
k
c
图 用DFT计算理想低通滤波器的频响曲线
HkF如图c中黑点所示。由图可见，低频部分近似理想低通频响特性，而
高频误差较大，且整个频响都有波动。这些误差就是由于对ht截断所产生的，所以通常
称之为截断效应。为减少这种截断误差，可适当加长T增加采样点数N或用窗函数处理
Created by ZhuangHeng
口
口
口
口口
口
口
数字信号处理第五版
后再进行DFT。有关窗函数的内容将在FIR数字滤波器设计中详细叙述。
在对连续信号进行谱分析时，主要关心两个问题，这就是谱分析范围和频率分辨率。
谱分析范围为F直接受采样频率F的限制。为了不产生频谱混叠失真，通常要求
信号的最高频率fF。频率分辨率用频率采样间隔F描述，F表示谱分析中能够分辨
的两个频率分量的最小间隔。显然，F越小，谱分析就越接近Xjf所以F较小时，我们
称频率分辨率较高。下面讨论用DFT对连续信号谱分析的参数选择原则。
在已知信号的最高频率f即谱分析范围时，为了避免频率混叠现象，要求采样速率
F满足下式：
Ff
按照式，谱分辨率FFN如果保持采样点数N不变，要提高频谱分辨率减
小F就必须降低采样频率，采样频率的降低会引起谱分析范围变窄和频谱混叠失真。如
维持F不变，为提高频率分辨率可以增加采样点数N因为NTTTF只有增加
对信号的观察时间T才能增加N。T。和N可以按照下面两式进行选择：
N
To≥卡
【例】 对实信号进行谱分析，要求谱分辨率F≤ Hz信号最高频率f
kHz试确定最小记录时间Tpm最大的采样间隔Tm最少的采样点数Nm。如果
f不变，要求谱分辨率提高倍，最少的采样点数和最小的记录时间是多少
解 To≥卡s
因此Tmn s。因为要求F≥f所以
T方××s
NF×
为使用DFT的快速算法FFT希望N符合的整数幂，为此选用N点。为使频率
分辨率提高倍，即FHz要求：
N×T号s
用快速算法FFT计算时，选用N点。
上面分析了为提高谱分辨率，又保持谱分析范围不变，必须增长记录时间T增大采
样点数N。应当注意，这种提高谱分辨率的条件是必须满足时域采样定理，即绝对不能保
持N不变，通过增大T来增加记录时间T。
用DFT对序列进行谱分析
我们知道单位圆上的Z变换就是序列的傅里叶变换，即
XeXz
Created by ZhuangHeng
Xe是w的连续周期函数。如果对序列xn进行N点DFT得到Xk则Xk是在区
间π上对Xe的N点等间隔采样，频谱分辨率就是采样间隔πN。因此序列的傅
里叶变换可利用DFT即FFT来计算。
对周期为N的周期序列xn由式知道，其频谱函数为
xeFTGin×km
其中
XADFSCmime
由于Xk以N为周期，因而Xe也是以π为周期的离散谱，每个周期有N条谱线，第
k条谱线位于wπNk处，代表n的k次谐波分量。而且，谱线的相对大小与Xk
成正比。由此可见，周期序列的频谱结构可用其离散傅里叶级数系数Xk表示。由DFT
的隐含周期性知道，截取xn的主值序列xnxnRn并进行N点DFT得到：
XCkDFTxnDFTxnRnXkRk
所以可用Xk表示 xn的频谱结构。
如果截取长度M等于xn的整数个周期，即MmNm为正整数，即
nnRn
XaADFTzmwene k…mN
令nniNi…mn…N则
XkZiexme
x。xm云
因为
m整数
所以
第章离散傅里叶变换DF
由此可见，Xk也能表示xn的频谱结构，只是在kim时，XMimmXi表示xn
的i次谐波谱线，其幅度扩大m倍。而其他k值时，XMk当然，Xi与XMim对应
N·mi。。所以，只要截取n的整数个周期进行DFT就可得 点频率是相等的
到它的频谱结构，达到谱分析的目的。
如果xn的周期预先不知道，可先通过计算n的自相关函数估算xn的周
期，然后按上述方法对周期信号进行谱分析。
Created by ZhuangHeng
■ g
a口
口
口
□口
口口口口
口口口
□口口口口口
口
数字信号处理第五版
在很多实际应用中，并非整个单位圆上的频谱都很有意义。例如，对于窄带信号，往往
只希望对信号所在的一段频带进行谱分析，这时便希望采样能密集地在这段频带内进行，
而带外部分可完全不予考虑。另外，有时希望采样点不局限于单位圆上。例如，语音信号处
理中，常常需要知道系统极点所对应的频率，如果极点位置离单位圆较远，则其单位圆上
的频谱就很平滑，如图a所示，这时很难从中识别出极点对应的频率。如果使采样
点轨迹沿一条接近这些极点的弧线或圆周进行，则采样结果将会在极点对应的频率上出现
明显的尖峰，如图b所示。这样就能准确地测定出极点频率。对均匀分布在以原点
为圆心的任何圆上的N点zrek…N频率采样，可用 DFTFFT计
算，而沿螺旋弧线采样，则要用线性调频Z变换ChirpZ变换，简称CZT计算。
Imz Imz
x× × × B ×
×× Re
× ×× Rez
×
Xe Xz
π A B
a b
图 单位圆与非单位圆谱分析示意图
例如，要求计算序列在半径为r的圆上的频谱，那么N个等间隔采样点为zre
k…Nz的频谱分量为
xaXxnre
令xnxnr则
xz∑ineDFTim≤k≤N
上式说明，要计算xn在半径为r的圆上的N点等间隔频谱分量，可以先对xn乘以
r再计算N点DFTFFT即可得到。若要求 xn分布在该圆的有限角度πM内的N
点等间隔频谱采样，可以取LMN在尾部补LN个零，仍按式用DFT分析
整个圆上的L点等间隔频谱，最后只取所需角度内的N点等间隔采样即可。显然，这种方
法的计算量大，效率低。下面要介绍的ChirpZ变换可使这种谱分析的运算量大大减少。
ChirpZ变换
设序列xn长度为N要求分析z平面上M点频谱采样值，设分析点z为
zAW≤k≤M
Created by ZhuangHeng
式中A和W为复数，用极坐标形式表示为 jlma
。M 名
式中，A。和W。为正实数。当k时，有 A
。AeA Rea
由此可见，式中，A决定谱分析起始点
z。的位置，W。的值决定分析路径的盘旋趋势，
φ则表示两个相邻分析点之间的夹角。如果
w则随着k增大，分析点z以φ。为步长
向外盘旋；而W时，向内盘旋，如图
所示。
图 ChirpZ变换分析频点分布
将z代入Z变换公式得到：
xxZnAwJwAw ≤k≤M
利用下面的关系式：
nk nkkn
得到：
xaZowawwwwAwwwa
令
ynxnAw
hnw
则
Xzw∑ynhkn ≤k≤M
式说明，长度为N的序列xn的M点ChirpZ变换可通过预乘得到yn再计算
yn与hn的卷积vk最后乘以W这三个步骤得到。计算方框图如图所示。图
中，hnW看成一个数字网络的单位脉冲响应，输出vnynhnVk。
第章离散傅里叶变换DFT
xn yn vnVk Xz
图 ChirpZ变换的计算框图
当W。时，hne”是一个频率随时间线性增长的复指数序列。在雷达系统
Created by ZhuangHeng
口
口
口
口口
数字信号处理第五版
中，这样的信号称作线性调频信号，并用专用词汇 Chirp表示，因此对上述变换起名为线性
调频Z变换，简称ChirpZ变换CZT。
下面介绍用DFTFFT计算ChirpZ变换的原理和实现步骤。首先要确定线性卷积
的区间。由于序列xn的长度为N即≤n≤N因此yn的长度也是N如图
a所示。然而hnW是无限长序列，vnynhn必然是无限长序列。
而谱分析点数为M即我们只对≤k≤M区间上的卷积结果感兴趣，因此只要计算出
Vkvn在区间～M上的M个值就可以了。根据上述要求，只要截取区间
NM上的hn就可以了。如图b所示，这时经线性卷积所得vn
长度为NM。由式知，yn①hn是vn的周期延拓序列的主值序列，延
拓周期为L即
ynhn∑onqL·Rn
而vn的非零区间为NNM。为了用循环卷积代替线性卷积计算出vn
在M区间上的M个序列值，以L为周期进行周期延拓时，只要保证M区
间上不混叠即可，所以循环卷积区间长度L应大于或等于NM。一般用快速卷积法
n
a
N n
hn
b
N M n
hn
c
M L n
yn①hn
d
M n
ynhnvn
图 ChirpZ变换中hn的形成
Created by ZhuangHeng
FFT算法计算，故应选择L≥NM同时又满足Lm为自然数的最小值。
若选择LNM那么yn尾部应补M个零，并将hn从N到M所截
取的一段序列以L为周期进行周期延拓，取主值序列形成hn如图c所示。这
时可以用快速卷积法计算如上构造的两个序列yn和hn的循环卷积。应当注意，当选
择LNM时，yn应补LN个零点，而hn应从ML到M区间上截取
或按上述区间NM截取后在N点前面补LNM个零点后，以
L为周期进行周期延拓。
综上所述，可归纳出具体计算步骤如下：
形成hn序列：
MnL mw
计算 HkDFThn ≤k≤L
nAwO≤n≤N 计算 N≤n≤L
计算 YkDFTyn≤k≤L
计算 YkHk
计算 VkIDFTYmHm≤k≤L
计算 XzwVk≤k≤M
与标准DFTFFT算法相比较，ChirpZ变换有以下特点：
输入序列长度N和输出序列长度不需要相等，且二者均可为素数。
分析频率点z的起始点z。及相邻两点的夹角。是任意的即频率分辨率是任意
的因此可从任意频率上开始，对输入数据进行窄带高分辨率的谱分析。
谱分析路径可以是螺旋形的。
当AMNWe时，z均匀分布在单位圆上，此时 ChirpZ变换就是序
列的DFT。因此可以说，DFT是ChirpZ变换的特例。
总之，ChirpZ变换用作谱分析时，具有灵活、适应性强和运算效率高等优点。
用DFT进行谱分析的误差问题
第章离散傅里叶变换DFT
DFT实际中用FFT计算可用来对连续信号和数字信号进行谱分析。在实际分析过
程中，要对连续信号采样和截断，有些非时限数据序列也要截断，由此可能引起分析误差。
下面分别对可能产生误差的三种现象进行讨论。
混叠现象。对连续信号进行谱分析时，首先要对其采样，变成时域离散信号后才能
用DFTFFT进行谱分析。采样速率F必须满足采样定理，否则会在wπ对应模拟频率
fF附近发生频谱混叠现象。这时用DFT分析的结果必然在fF附近产生较大
误差。因此，理论上必须满足F≥ff。为连续信号的最高频率。对F确定的情况，一
Created by ZhuangHeng
数字信号处理第五版
般在采样前进行预滤波，滤除高于折叠频率F的频率成分，以免发生频谱混叠现象。
栅栏效应。我们知道，N点DFT是在频率区间π上对时域离散信号的频谱
进行N点等间隔采样，而采样点之间的频谱是看不到的。这就好像从N个栅栏缝隙中观看
信号的频谱情况，仅得到N个缝隙中看到的频谱函数值。因此称这种现象为栅栏效应。由
于栅栏效应，有可能漏掉挡住大的频谱分量。为了把原来被“栅栏”挡住的频谱分量检测
出来，就必须提高频率分辨率。对有限长序列，可以在原序列尾部补零；对无限长序列，可
以增大截取长度及DFT变换区间长度，从而使频域采样间隔变小，增加频域采样点数和采
样点位置，使原来漏掉的某些频谱分量被检测出来。对连续信号的谱分析，只要采样速率
F足够高，且采样点数满足频率分辨率要求见式和式就可以认为
DFT后所得离散谱的包络近似代表原信号的频谱。
截断效应。实际中遇到的序列xn可能是无限长的，用DFT对其进行谱分析时，
必须将其截短，形成有限长序列ynxnwnwn称为窗函数，长度为N。wn
Rn称为矩形窗函数。根据傅里叶变换的频域卷积定理，有
YeFTynxeWexeWede
其中
XeFTxnWeFTwn
对矩形窗数wnRNn有
WeFTuneiNwuer
wwsin
幅度谱Ww～w曲线如图所示Ww以π为周期，只画低频部分。图中，
lwlπN的部分称为主瓣，其余部分称为旁瓣。
Wa
图 矩形窗的幅度谱
rncosn 例如， 其频谱为
xemmπam
xn的频谱Xe如图a所示。将xn截断后，ynxnRn的幅频曲线如
图b所示。
Created by ZhuangHeng
由上述可见，截断后序列的频谱Ye与原序列频谱Xe必然有差别，这种差别对
谱分析的影响主要表现在如下两个方面：
泄露。由图b可知，原来序列xn的频谱是离散谱线，经截断后，使原来
的离散谱线向附近展宽，通常称这种展宽为泄露。显然，泄露使频谱变模糊，使谱分辨率降
低。从图可以看出，频谱泄露程度与窗函数幅度谱的主瓣宽度直接相关，在第章
将证明，在所有的窗函数中，矩形窗的主瓣是最窄的，但其旁瓣的幅度也最大。所以，在窗
函数长度N相同时，用矩形窗截取，产生的泄露最小。
Xe
W W
a
IYel
W W
b
图 xncosan加矩形窗前、后的幅频特性
谱间干扰。在主谱线两边形成很多旁瓣，引起不同频率分量间的干扰简称谱间干
扰特别是强信号谱的旁瓣可能湮没弱信号的主谱线，或者把强信号谱的旁瓣误认为是另
一频率的信号的谱线，从而造成假信号，这样就会使谱分析产生较大偏差。由于矩形窗的
旁瓣最大，所以，用矩形窗截取时，产生的谱间干扰最大。
由于上述两种影响是由对信号截断引起的，因此称之为截断效应。由图可以看
出，增加N可使Ww的主瓣变窄，减小泄露，提高频率分辨率，但旁瓣的相对幅度并不
减小。为了减小谱间干扰，应用其他形状的窗函数wn代替矩形窗窗函数将在FIR 数字
滤波器设计中介绍。但在N一定时，旁瓣幅度越小的窗函数，其主瓣就越宽。所以，在
DFT变换区间即截取长度N一定时，只能以降低谱分析分辨率为代价，换取谱间干扰
的减小。通过进一步学习数字信号处理的功率谱估计等现代谱估计内容可知，减小截断效
应的最好方法是用近代谱估计的方法。但谱估计只适用于不需要相位信息的谱分析
场合。
第章
离散傅里叶变换DF
最后要说明的是，栅栏效应与频率分辨率是不同的两个概念。如果截取长度为N的一
段数据序列，则可以在其后面补N个零，再进行N点DFT使栅栏宽度减半，从而减轻
了栅栏效应。但是这种截短后补零的方法不能提高频率分辨率。因为截短已经使频谱变模
糊，补零后仅使采样间隔变小，但得到的频谱采样的包络仍是已经变模糊的频谱，所以频
率分辨率没有提高。因此，要提高频率分辨率，就必须对原始信号截取的长度加长对模拟
信号，就是增加采样时间T。的长度。
Created by ZhuangHeng
口
口
甲
数字信号处理第五版
习题与上机题
计算以下序列的N点DFT在变换区间≤n≤N内，序列定义为
xn
xnn
xnnnnN
xnRn mN
xne mN
rncosmn mN
xneRn
xnsinwon·Rn
xncoswn·RNN
xnnRNn
已知下列Xk求xnIDFTXk
其中，m为正整数，mN。
已知长度为N的两个有限长序列：
作图表示 xn、xn和ynxn关xn循环卷积区间长度L。
证明DFT的对称定理，即假设XkDFTxn证明
DFTXnNxNk
如果XkDFTxn证明DFT的初值定理
x六xA
Created by ZhuangHeng
设xn的长度为N且
XkDFTxn ≤k≤N
令 hnxnRvn m为自然数
HkDFThnmN≤k≤mN
求Hk与Xk的关系式。
证明：若xn为实序列，XkDFTxnn则Xk为共轭对称序列，即
XkXNk若xn实偶对称，即xnxNn则Xk也实偶对称；若xn
实奇对称，即xnxNn则Xk为纯虚函数并奇对称。
证明频域循环移位性质：设XkDFTxnYkDFTyn如果Yk
XkRnk则
ynIDFTYkWxn
已知xn长度为NXkDFTxn
N≤n≤mm为自然数
YkDFTyn ≤k≤mN
求Yk与Xk的关系式。
证明离散相关定理。若
XkXikXk
则
znDFTXkZxiDzUnRan
证明离散帕塞瓦尔定理。若XkDFTxn则
lznP六×kP
已知fnxnjynxn与yn均为长度为N的实序列。设
FkDFTfnN≤k≤N
Fkawiw ab为实数
FkjN
第章离散傅里叶变换DFT
试求XkDFTxnnYkDFTyn、以及xn和yn。
已知序列xnauna对xn的Z变换Xz在单位圆上等间隔采样
N点，采样序列为
Xkxz k…N
求有限长序列IDFTXkN。
两个有限长序列xn和yn的零值区间为
xn n≤n
Created by ZhuangHeng
口口
口口
口口
口
中国事
数字信号处理第五版
yn n≤n
对每个序列作点DFT即
XkDFTrnk…
YkDFTynk…
如果
FkXk·Ykk…
fnIDFTFkk…
试问在哪些点上fn与xnyn值相等，为什么
已知实序列xn的点DFT的前个值为j
j。
求Xk的其余点的值；
zxn∑xnmRn求XkDFTzn
xnxne求xkDFTxn。
xn、xn和xn分别如题图a、b和c所示，已知 Xk
DFTxn。。求
XkDFTxn。和 XkDFTxn。
注：用Xk表示Xk和Xk。
xn
a n
xn
b i n
xn
c i n
题图
设xn是长度为N的因果序列，且
XeFTznyn∑xnmMRanYkDFTLynu
试确定Yk与Xe的关系式。
用微处理机对实数序列作谱分析，要求谱分辨率F≤ Hz信号最高频率为
kHz试确定以下各参数：
最小记录时间T
Created by ZhuangHeng
最大取样间隔Tmax
最少采样点数Nmm
在频带宽度不变的情况下，使频率分辨率提高倍即F缩小一半的N值。
已知调幅信号的载波频率fkHz调制信号频率f Hz用FFT对其进
行谱分析，试求：
最小记录时间Tpmm
最低采样频率fm
最少采样点数Nmi
在下列说法中选择正确的结论。线性调频Z变换可以用来计算一个有限长序列
hn在z平面实轴上诸点z的Z变换Hz使
zak…Na为实数，a≠
zakk…Na为实数，a≠
和都不行，即线性调频Z变换不能计算Hz在z平面实轴上的取样值。
我们希望利用hn长度为N的FIR滤波器对一段很长的数据序列进行滤波
处理，要求采用重叠保留法通过DFT即FFT来实现。所谓重叠保留法，就是对输入序列
进行分段本题设每段长度为M个采样点但相邻两段必须重叠V个点，然后计算
各段与hn的L点本题取L循环卷积，得到输出序列ynm表示第m段循环
卷积计算输出。最后，从yn中选取B个样值，使每段选取的B个样值连接得到滤波输
出yn。
求V
求B
确定取出的B个采样应为yn中的哪些样点。
证明DFT的频域循环卷积定理。
已知序列xn。
求出xn的傅里叶变换Xe画出幅频特性和相频特性曲线提示：用点
FFT近似Xe
计算xn的NN≥点离散傅里叶变换Xk画出幅频特性和相频特性曲线；
将Xe和Xk的幅频特性和相频特性曲线分别画在同一幅图中，验证Xk是
Xe的等间隔采样，采样间隔为πN
计算Xk的N点IDFT验证DFT和IDFT的唯一性。
°给定两个序列：xnxn。
直接在时域计算xn与xn的卷积：
用DFT计算 xn与xn的卷积，总结出DFT的时域卷积定理。
已知序列hnRnrnnRn。
第章离散傅里叶变换DFT
Created by ZhuangHeng
计算ynhn⑧rn
计算ynhnxn和ynhnxn。
画出hn、xn、yn和yn的波形图，观察总结循环卷积与线性卷积的关系。
°验证频域采样定理。设时域离散信号为
IL
其中aL。
计算并绘制信号xn的波形。
证明：xeFTnJxancsom。
按照N对Xe采样得到CXek… N。
m÷ce试根据频域采样定理解释序列xn 计算并图示周期序列
与xn的关系。
yn∑xnmN比较xn与yn验证中的 计算并图示周期序列
解释。
对N重复～。
°选择合适的变换区间长度N用DFT对下列信号进行谱分析，画出幅频特性和
相频特性曲线。
xncosπn
xnsinπnsinπn
xnRn 数字信号处理第五版
Created by ZhuangHeng
章 第
快速傅里叶变换FFT
引 言
DFT是数字信号分析与处理中的一种重要变换。但直接计算 DFT的计算量与变换区
间长度N的平方成正比，当N较大时，计算量太大，所以在快速傅里叶变换FFTFast
Fourier Transform出现以前，直接用DFT算法进行谱分析和信号的实时处理是不切实际
的。直到年提出 DFT的一种快速算法以后，情况才发生了根本的变化。
自从年库利TWCooley和图基JWTuky在《计算数学》Math Compu tationVol杂志上发表了著名的《机器计算傅里叶级数的一种算法》论文后，桑
德GSand—图基等快速算法相继出现，又经人们进行改进，很快形成一套高效计算方
法，这就是现在的快速傅里叶变换FFT。这种算法使DFT的运算效率提高了～个数
量级，为数字信号处理技术应用于各种信号的实时处理创造了条件，大大推动了数字信号
处理技术的发展。
人类的求知欲和科学的发展是永无止境的。多年来，人们继续寻求更快、更灵活的好
算法。年，法国的杜哈梅尔P Dohamel和霍尔曼H Hollmann提出的分裂基快速
算法，使运算效率进一步提高。本章主要讨论基 FFT算法及其编程思想。
基FFT算法
直接计算DFT的特点及减少运算量的基本途径
有限长序列xn的N点DFT为
第章快速博里叶变换πFT
Created by ZhuangHeng
数字信号处理第五版
xkznwk…N
考虑xn为复数序列的一般情况，对某一个k值，直接按式计算Xk的个
值需要N次复数乘法和N次复数加法。因此，计算Xk的所有N个值，共需N次
复数乘法和NN次复数加法运算。当N时，NN≈N。由上述可见，N点
DFT的乘法和加法运算次数均为N。当N较大时，运算量相当可观。例如N时，
N。这对于实时信号处理来说，必将对处理设备的计算速度提出难以实现的要
求。所以，必须减少其运算量，才能使DFT在各种科学和工程计算中得到应用。
如前所述，N点 DFT的复乘次数等于N。显然，把N点DFT分解为几个较短的
DFT可使乘法次数大大减少。另外，旋转因子W具有明显的周期性和对称性。其周期性
表现为
weew
其对称性表现为
WnWN或者 WNW
wW
a
b
FFT算法就是不断地把长序列的DFT分解成几个短序列的DFT并利用W的周期性和
对称性来减少 DFT的运算次数。算法最简单最常用的是基FFT。
时域抽取法基FFT基本原理
基FFT算法分为两类：时域抽取法FFTDecimationInTime FFT简称DITFFT
频域抽取法FFTDecimationInFrequency FFT简称DIFFFT。本节介绍DITFFT
算法。
设序列xn的长度为N且满足N“M为自然数。按n的奇偶把xn分解为两
个N点的子序列
xrxr r…
zrxr r…
则xn的DFT为
xk∑zmw∑xnW
awxrDwo
wwxw
因为
w。ew
Created by ZhuangHeng
所以
xkzwawWa
XkWNXkk…N
其中Xk和Xk分别为xr和xr的N点DFT即
xAzrWaDFTZxrsa
xkzWDFTzs
由于Xk和Xk均以N为周期，且WW因此Xk又可表示为
XkXkWXkk…
xkXkWXk k…
这样，就将N点DFT分解为两个N点 DFT和式以及式的运算。
和式的运算可用图所示的流图符号表示，称为蝶形运算符号。采用
这种图示法，经过一次奇偶抽取分解后，N点DFT运算图可以用图表示。图中，
NXX由式给出，而X～X则由式给出。
A ACB
B
C
ACB
图 蝶形运算符号
x
N点
DFT
X XO
X x X
x X X
X x X
x
N点
DFT
X w X
x X w X
x X w X
第章快速傅里叶变换FFT
x X w X
图 点DFT一次时域抽取分解运算流图
由图可见，要完成一个蝶形运算，需要一次复数乘法和两次复数加法运算。由
图容易看出，经过一次分解后，计算个N点DFT共需要计算两个N点DFT和
N个蝶形运算。而计算一个N点DFT需要N次复数乘法和NN次复
数加法。所以，按图计算N点DFT时，总的复数乘法次数为
Created by ZhuangHeng
口
数字信号处理第五版
贵nNt竺
复数加法次数为
NN
由此可见，仅仅经过一次分解，就使运算量减少近一半。既然这样分解对减少 DFT的运算
量是有效的，且NMN仍然是偶数，故可以对N点DFT再作进一步分解。
与第一次分解相同，将xr按奇偶分解成两个N点的子序列xL和xL即
l…
Xk又可表示为
xAAwW
xWwxDw
k… XkWXk
式中
xZWFTLDm
XAzDwDFTzD
同理，由Xk和Xk的周期性和WN的对称性WNNW最后得到：
fxk…
用同样的方法可计算出
XkXk土W xxAk…
其中
xkzDwsDFTza
xAzDwsDFTz
Zl…
这样，经过第二次分解，又将N点DFT分解为个N点DFT和式或
式所示的N个蝶形运算，如图所示。依次类推，经过M次分解，最后将
Created by ZhuangHeng
N点DFT分解成N个点DFT和M级蝶形运算，而点DFT就是时域序列本身。一个
完整的点DITFFT运算流图如图所示。图中用到关系式 WNWN。图中输入
序列不是顺序排列，但后面会看到，其排列是有规律的。图中的数组A用于存放输入序列
和每级运算结果，在后面讨论编程方法和倒序时要用到。
N点
DFT
X X x XO
x X X X
N点
DFT
X x w° X X
X x W
X X
x N点
DFT
X X wg X
x X X W X
x N点
DFT
X w
X w ●X
x X Wn X w X
图 点DFT二次时域抽取分解运算流图
x A A A A X
x A A A A w X
x A A w
A A X
x A A w° W A AX
x A A A w AX
x A A A w w AX
x A A A w w A X
x A A w w A w AX
图 点DITFFT运算流图
DITFFT算法与直接计算DFT运算量的比较 第章快速傅里叶变换FFT 由DITFFT算法的分解过程及图可见，N时，其运算流图应有M级蝶形，
每一级都由N个蝶形运算构成。因此，每一级运算都需要N次复数乘和N次复数加
每个蝶形需要两次复数加法。所以，M级运算总的复数乘次数为
C·MbN
复数加次数为
CAN·MNIbN
而直接计算 DFT的复数乘为N次，复数加为NN次。当N》时，N》
Created by ZhuangHeng
①口 。。。
口口
口
口口
重
重
口
口
口
口口
口
面单
数字信号处理第五版
NIbN所以，DITFFT算法比直接计算 DFT的运算次数大大减少。例如，N
时，
这样，就使运算效率提高多倍。图为FFT算法和直接计算DFT所需复数乘法
次数CM与变换点数N的关系曲线。由此图更加直观地看出FFT算法的优越性，显然，N
越大时，优越性就越明显。
乘法次数
直接计算DFT
DITFFT算法
N取样点数
图 DITFFT算法与直接计算 DFT所需复数乘法次数的比较曲线
DITFFT的运算规律及编程思想
为了最终写出DITFFT运算程序或设计出硬件实现电路，下面介绍DITFFT的运
算规律和编程思想。
原位计算
由图可以看出，DITFFT的运算过程很有规律。NM点的FFT共进行M
级运算，每级由N个蝶形运算组成。同一级中，每个蝶形的两个输入数据只对计算本蝶
形有用，而且每个蝶形的输入、输出数据结点又同在一条水平线上，这就意味着计算完一
个蝶形后，所得输出数据可立即存入原输入数据所占用的存储单元数组元素。这样，经
过M级运算后，原来存放输入序列数据的N个存储单元数组A中便依次存放Xk的N
个值。这种利用同一存储单元存储蝶形计算输入、输出数据的方法称为原位址计算。原
位计算可节省大量内存，从而使设备成本降低。
旋转因子的变化规律
如上所述，N点DITFFT运算流图中，每级都有N个蝶形。每个蝶形都要乘以因
子W称其为旋转因子，p为旋转因子的指数。但各级的旋转因子和循环方式都有所不
同。为了编写计算程序，应先找出旋转因子W与运算级数的关系。用L表示从左到右的
Created by ZhuangHeng
运算级数L…M。观察图不难发现，第L级共有个不同的旋转因子。
N时的各级旋转因子表示如下：
L时，
WWWJ
L时，
WkWWJ
L时，
weWWJ
对NM的一般情况，第L级的旋转因子为
WWJ…
因为
M×MN·zM
所以
WCWWJ…
pJ·M
这样，就可按和式确定第L级运算的旋转因子实际编程序时，L为最外
层循环变量。
蝶形运算规律
设序列xn经时域抽选倒序后，按图所示的次序倒序存入数组A中。如果
蝶形运算的两个输入数据相距B个点，应用原位计算，则蝶形运算可表示成如下形式：
AJ∈AJAJBWN
AJB∈AJAiJBW
式中
pJ×J…L…M
下标L表示第L级运算，AJ则表示第L级运算后的数组元素AJ的值即第L级蝶形
的输出数据。而AJ表示第L级运算前AJ的值即第L级蝶形的输入数据。
编程思想及程序框图
仔细观察图还可以归纳出一些对编程有用的运算规律：第L级中，每个蝶形的
两个输入数据相距B个点；每级有B个不同的旋转因子；同一旋转因子对应着间隔
为点的M个蝶形。
总结上述运算规律，便可采用下述运算方法。先从输入端第级开始，逐级进行，共
进行M级运算。在进行第L级运算时，依次求出B个不同的旋转因子，每求出一个旋转因
子，就计算完它对应的所有M个蝶形。这样，我们可用三重循环程序实现DITFFT运
算，程序框图如图所示。
第章快速傅里叶变换FFT
Created by ZhuangHeng
口
口口
口口
口口
口口
口
数字信号处理第五版
开始
读入xnM
N
倒序
LM
B
JB
PIJ
kJN
TAkAkBW
AkBAkAkBW
AikT
输出
结束
图 DITFFT运算程序框图
另外，DITFFT算法运算流图的输出Xk为自然顺序，但为了适应原位计算，其输
入序列不是按xn的自然顺序排列，这种经过M次偶奇抽选后的排序称为序列xn的倒
序倒位。因此，在运算M级蝶形之前应先对序列xn进行倒序。下面介绍倒序算法。
序列的倒序
DITFFT算法的输入序列的排序看起来似乎很乱，但仔细分析就会发现这种倒序是
很有规律的。由于NM因此顺序数可用M位二进制数nMnM…nn。表示。M次偶
奇时域抽选过程如图所示。第一次按最低位n。的和将xn分解为偶奇两组，第
二次又按次低位n的、值分别对偶奇组分组；依次类推，第M次按ns位分解，最后
所得二进制倒序数如图所示。表列出了N时以二进制数表示的顺序数和
倒序数，由表显而易见，只要将顺序数nnn的二进制位倒置，则得对应的二进制倒序值
nnn。按这一规律，用硬件电路和汇编语言程序产生倒序数很容易。但用有些高级语言
程序实现时，直接倒置二进制数位是不行的，因此必须找出产生倒序数的十进制运算规律。
由表可见，自然顺序数I增加是在顺序数的二进制数最低位加逢向高位进
位。而倒序数则是在M位二进制数最高位加逢向低位进位。例如，在最高位加
则得而最高位为所以最高位加要向次高位进位，其实质是将最高位
Created by ZhuangHeng
变为再在次高位加得到。用这种算法，可以从当前任一倒序值求得下一个倒
序值。
n
no bbb
bbbo
图 形成例序的树状图N
表 顺序和倒序对照表
为了叙述方便，用J表示当前倒序数的十进制数值。对于NMM位二进制数最高
位的十进制权值为N且从左向右二进制位的权值依次为NN…。因此，
最高为加相当于十进制运算JN。如果最高位是JN则直接由JN得下
一个倒序值；如果最高位是J≥N则先将最高位变成J∈JN然后次高位
加JN。但次高位加时，同样要判断、值，如果为JN则直接加
J∈JN否则将次高位变成JJN再判断下一位；依此类推，直到完成最
顺 序 倒 序
十进制数I 二进制数 二进制数 十进制数J
第章快速傅里叶变换FFT
高位加逢向右进位的运算。图所示的倒序的程序框图中的虚线框内就是完成计
算倒序值的运算流程图。
形成倒序J后，将原数组A中存放的输入序列重新按倒序排列。设原输入序列xD先
按自然顺序存入数组A中。例如，对NAA…A中依次存放着x
xx…x。对xn的重新排序倒序规律如图所示。倒序的程序框图
如图所示。由图可见，第一个序列值x和最后一个序列值xN不需要
重排，所以，顺序数I初值为终值为N倒序数J的初值为N。每计算出一个倒序
值J便与循环语句自动生成的顺序I比较，当IJ时，不需要交换，当I≠J时，A与
Created by ZhuangHeng
口
口
口
口口
口口
口
口口
口口
口□
口口
口
数字信号处理第五版
AJ交换数据。另外，为了避免再次调换前面已调换过的一对数据，框图中只对IJ的情
况调换AI和AJ的内容。
LHeN
NN JLH
IN
I≥ Y
N
x x xx x x xx
A A A A A A
TKA
AA
AT
KLH
KK N JK
KK
Y
AO AA A A A A A
x x x xx x x x
图 倒序规律
JK
图 倒序程序框图
第章介绍的MATLAB函数fft是一个计算 DFT的智能程序，如果计算点数N
则自动按DITFFT快速算法计算，否则，直接计算 DFT。所以，调用该函数计算
DFT时，最好选取NM使处理速度大大提高。
频域抽取法FFTDIFFFT
在基FFT算法中，频域抽取法FFT也是一种常用的快速算法，简称DIFFFT。
设序列xn长度为NM首先将xn前后对半分开，得到两个子序列，其DFT可
表示为如下形式：
XkDFTLxn∑xW
Zwanw
zmwZnws
nw≠nw
Created by ZhuangHeng
式中
w°k一奇数
将Xk分解成偶数组与奇数组，当k取偶数kmm…N时
Xmxnxnw
zxnxn号w
当k取奇数kmm…N时，
xmzn号w
znn号ws·w
令
n …
将xn和xn分别代入和式，可得
式表明，Xk按奇偶k值分为两组，其偶数组是xn的N点DFT奇数组则
是xn的N点DFT。xn、xn和xn之间的关系也可用图所示的蝶形运
算流图符号表示。图表示N时第一次分解的运算流图。
xxOn xn
岭mKa÷m n号
第章快速博里叶变换FFT
图 DIFFFT蝶形运算流图符号
由于NMN仍然是偶数，继续将N点DFT分成偶数组和奇数组，这样每个
N点DFT又可由两个N点DFT形成，其输入序列分别是xn和xn按上下对半
分开形成的四个子序列。图示出了N时第二次分解运算流图。这样继续分解下
去，经过M次分解，最后分解为M个两点DFT两点DFT就是一个基本蝶形运算流
Created by ZhuangHeng
口
口
口
口
数字信号处理第五版
x x
N点
DFT
X
x xi X
x x X
x x X
x w
x
N点
DFT
X
x w x X
x w x X
x w x X
图 DIFFFT第一次分解运算流图N
图。当N时，经两次分解，便分解为四个两点DFT。N的完整DIFFFT运算流
图如图所示。
x N点 DFT
XO
x X
x w N点
DFT
X
x w X
x w N点
DFT
X
x w X
x w w N点 X
x w w DFT X
图 DIFFFT第二次分解运算流图N
x XO
x w X
x w X
x w w X
x w X
x w w XS
x w w X
x w w w X
图 DIFFFT运算流图N
这种算法是对Xk进行奇偶抽取分解的结果，所以称之为频域抽取法FFT。观察图
Created by ZhuangHeng
可知，DIFFFT算法与DITFFT算法类似，可以原位计算，共有M级运算，每
级共有N个蝶形运算，所以两种算法的运算次数亦相同。不同的是DIFFFT算法输人
序列为自然顺序，而输出为倒序排列。因此，M级运算完后，要对输出数据进行倒序才能
得到自然顺序的Xk。另外，蝶形运算略有不同，DITFFT蝶形先乘后加减而
DIFFFT蝶形先加减后相乘。
最后要说明的是，上述两种FFT的算法流图形式不是唯一的。只要保证各支路传输比
不变，改变输入与输出点以及中间结点的排列顺序，就可以得到其他变形的FFT运算流
图，各种运算流图各有特点
IDFT的高效算法
上述FFT算法流图也可以用于计算 IDFT。比较DFT和IDFT的运算公式：
xkDFTLznrnw
rnIDFTLzn六xkW
只要将DFT运算式中的系数W、改变为W最后乘以N就是IDFT运算公式。所
以，只要将上述的DITFFT与DIFFFT算法中的旋转因子W改为W最后的输出
再乘以N就可以用来计算IDFT。只是现在流图的输入是Xk输出就是xn。因此，
原来的DITFFT改为IFFT后，称为DIFIFFT更合适；DIFFFT改为IFFT后，应称
为DITIFFT。
如果希望直接调用FFT子程序计算IFFT则可用下面的方法：
由于
nx kWs六DFTLXk
所以，可以先将Xk取复共轭，然后直接调用FFT子程序，或者送入 FFT专用硬件设备
进行DFT运算，最后取复共轭并乘以N得到序列xn。这种方法虽然用了两次取共轭
运算，但可以与FFT共用同一子程序，因而用起来很方便。
进一步减少运算量的措施 第，快重尊里叶变奂nT卜
前面讨论的DITFFT和DIFFFT算法，由于其算法简单，编程效率高，得到广泛
应用。下面介绍进一步减少运算量的途径，以程序的复杂度换取计算效率的进一步提高。
多类蝶形单元运算
由DITFFT运算流图已得出结论，N点FFT共需要MN次复数乘法。由
式，当L时，只有一种旋转因子W所以，第一级不需要乘法运算。当
L时，共有两个旋转因子：W和WNj因此，第二级也不需要乘法运算。在
Created by ZhuangHeng
口口
口
口口
口
口
数字信号处理第五版
DFT中，又称其值为±和士j的旋转因子为无关紧要的旋转因子，如W°WNWN等。
综上所述，先除去第一、二两级后，所需复数乘法次数应是
CMM
进一步考虑各级中的无关紧要旋转因子。当L时，有两个无关紧要的旋转因子W°
和WN因为同一旋转因子对应着MIN个碟形运算，所以第三级共有N
N个碟形不需要复数乘法运算。依此类推，当L≥时，第L级的个无关紧要的旋转因
子减少复数乘法的次数为NN。这样，从L至LM共减少复数乘法次
数为
AN
因此，DITFFT的复乘次数降至
CMMM
下面再讨论FFT中特殊的复数运算，以便进一步减少复数乘法次数。一般实现一次复
数乘法运算需要四次实数乘，两次实数加。但对WNj√这一特殊复数，任一复
数xjy与其相乘时，
ajxjsxjyjxyxyjxyRjl
Rxy
Ixyyx
只需要两次实数加和两次实数乘就可实现。这样，WN对应的每个蝶形节省两次实数乘。
在DITFFT运算流图中，从L至LM级，每级都包含旋转因子WN第L级中，
wN对应N个蝶形运算。因此从第三级至最后一级，旋转因子WN节省的实数乘次数
与式相同。所以从实数乘运算考虑，计算N点DITFFT所需实数乘法次
数为
RxMNM
在基FFT程序中，若包含了所有旋转因子，则称该算法为一类碟形单元运算；若去
掉W±的旋转因子，则称之为二类碟形单元运算；若再去掉W±j的旋转因子，则
称为三类碟形单元运算；若再判断处理WNj√则称之为四类碟形运算。我们将
后三种运算称为多类碟形单元运算。显然，碟形单元类型越多，编程就越复杂，但当N较
大时，乘法运算的减少量是相当可观的。例如，N时，三类碟形单元运算的乘法次数
为一类碟形单元运算的
Created by ZhuangHeng
旋转因子的生成
在FFT运算中，旋转因子WcosπmNjsinπmN求正弦和余弦函数值的
计算量是很大的。所以编程时，产生旋转因子的方法直接影响运算速度。一种方法是在每
级运算中直接产生；另一种方法是在FFT程序开始前预先计算出Wm…
N存放在数组中，作为旋转因子表，在程序执行过程中直接查表得到所需旋转因子
值，不再计算。这样使运算速度大大提高，其不足之处是占用内存较多。
实序列的FFT算法
在实际工作中，数据xn常常是实数序列。如果直接按FFT运算流图计算，就是把
xn看成一个虚部为零的复序列进行计算，这就增加了存储量和运算时间。处理该问题的
方法有三种。早期提出的方法是用一个N点FFT计算两个N点实序列的FFT一个实序
列作为xn的实部，另一个作为虚部，计算完FFT后，根据DFT的共轭对称性，用例
所述的方法由输出Xk分别得到两个实序列的N点DFT。第二种方法是用N点
FFT计算一个N点实序列的DFT。第三种方法是用离散哈特莱变换DHT。下面简要
介绍第二种方法。
设xn为N点实序列，取xn的偶数点和奇数点分别作为新构造序列yn的实部和
虚部，即
xnxnxnxn n…
ynxnjzn n…
对yn进行N点FFT输出Yk则 第章
xDPFTx k…
根据DITFFT的思想及和式，可得到Xk的前个值：
XkXkWNXkk… 快速傅里叶变换TTT
式中，xxX号X。。由于xn为实序列，因此Xk具有共轭对称
性，Xk的另外N点的值为
k… XNkXk
N AM 计算 点FFT的复乘次数为 计算式的复乘次数为 所以用这种
MM。相对一般的N点FFT 算法，计算Xk所需复数乘法次数为
Created by ZhuangHeng
口
口
口
数字信号处理第五版
”MAMMH当N时，η 算法，上述算法的运算效率为
运算速度提高近倍。
其他快速算法简介
快速傅里叶变换算法是信号处理领域重要的研究课题。自从年提出基FFT算法
以来，现在已提出的快速算法有多种，且还在不断研究探索新的快速算法。由于教材篇幅
和教学大纲所限，本章仅介绍算法最简单、编程最容易的基FFT算法原理及其编程思想，
使读者建立快速傅里叶变换的基本概念，了解研究FFT算法的主要途径和编程思路。其他
高效快速算法请读者参考文献、、。例如，分裂基FFT算法、离散哈特莱变换
DHT、基FFT、基FFT、基rFFT、混合基FFT以及进一步减少运算量的途径等内
容，对研究新的快速算法都是很有用的。本节简要介绍其他几种快速算法的运算量及其主
要特点，以便读者选择快速算法时参考。
从理论上讲，不同基数的FFT算法的运算效率不同，实际中最常用的是基FFT、基
FFT、分裂基FFT和DHT。为此，下面简要介绍后三种FFT算法的特点和运算效率，
以扩展读者的视野。其具体算法请参考文献、。
在基rFFT算法中，基FFT算法运算效率与基FFT很接近，但基FFT算法实现程
序简单，且判断开销少。可以证明，当FFT的基大于时，不会明显降低计算量。基FFT
要求NMM为自然数。其复数乘法次数为
Ca基N bN
CN IbN基 其中未计入乘以±j和的计算。比较基FFT的复数乘法次数
FFT的复数乘法次数减少
年，法国的杜梅尔PDohamel和霍尔曼H Hollmann将基分解和基分解
糅合，提出了分裂基FFT算法，其复数乘法次数接近FFT理论最小值，但其运算流图却与
基FFT很相似，编程简单，运算程序也很短，是一种很实用的高效算法。分裂基FFT算
法复数乘法次数为
Ca分裂基号bNfN“鲁
只考虑式的第一项，分裂基FFT算法的复数乘法次数就比基FFT减少比
基FFT减少应当说明，在比较时，未考虑式后项减少的运算量，所以分
裂基FFT算法的效率更高。
由以上比较可见，分裂基FFT算法的效率最高，所以得到广泛应用。但是，对实序列
xn上述各种FFT算法仍将其看成虚部为零的复序列存储和计算。而一次复数乘法需要
四次实数乘法和二次实数加法。所以，必然浪费存储资源和增加多余的运算量。我们知道，
Created by ZhuangHeng
实序列的N点DFT具有共轭对称性，即
XNkXkk…N
所以，只要计算出Xk的前面N个值，则其后面的N个值可以由对称性求得。因此，
FFT算法得到的N个Xk值有一半是多余的。由以上分析可见，对实序列一定存在更高
效的快速算法。离散哈特莱变换DHT就是针对实序列的一种高效变换算法，相对一般的
FFT算法，DHT的快速算法FHT可以减少近一半的计算量。N点基时域抽取快速
DHT基DITFHT算法的实数乘法次数为
MHTNMN
N点基DITFHT算法的实数加法次数为
AmNM
由式可见，基DITFHT算法的实数乘法次数约为基DITFFT算法的一半。
与前面三种FFT算法比较，对实序列，基DITFHT算法的实数乘法次数最少。
应当说明，DHT是与DFT不同的变换，所以要想得到实序列的DFT还要根据二者
的关系式进行转换。下面会看到该关系非常简单。
DHT具有以下主要优点：
DHT是实数变换，在对实信号进行处理时避免了复数运算，运算效率高，且实现
硬件简单经济。
DHT的正、逆变换除了因子N外具有相同的形式，所以实现硬件或程序亦相
同。N点DHT定义如下：
xnkDHTzwzwcas k…N
N点逆DHT变换定义为
xnIDHTXnk、六Xakcas n…N
式中，casacosasina。 第章快速傅里叶变换F下
DHT满足循环卷积定理，所以，可以直接用FHT实现实序列的快速卷积，大大
提高处理速度口，并使处理硬件简化。
DHT与DFT之间的关系非常简单，容易实现二者之间的转换，关系式如下：
XkXakXnNkjXakXNk
所以对实信号xn进行谱分析时，可以先对xn进行FHT得到XHkDHTxn
然后再将X日k转换成XkDFTxnn这样可以提高分析速度，减少存储空间。
Created by ZhuangHeng
习题与上机题
如果某通用单片计算机的速度为平均每次复数乘需要μs每次复数加需要μs
用来计算N点DFT问直接计算需要多少时间。用FFT计算呢照这样计算，用
FFT进行快速卷积来对信号进行处理时，估计可实现实时处理的信号最高频率。
如果将通用单片机换成数字信号处理专用单片机TMS系列，计算复数乘和复数
加各需要 ns。请重复做上题。
已知Xk和Yk是两个N点实序列xn和yn的DFT希望从Xk和Yk求
xn和yn为提高运算效率，试设计用一次N点IFFT来完成的算法。
设xn是长度为N的有限长实序列，Xk为xn的N点DFT。
试设计用一次N点FFT完成计算 Xk的高效算法；
若已知Xk试设计用一次N点IFFT实现求Xk的N点IDFT运算。
分别画出点基DITFFT和DIFFFT运算流图，并计算其复数乘次数，如果
考虑三类碟形的乘法计算，试计算复乘次数。
°按照下面的IDFT算法编写MATLAB语言IFFT程序，其中的FFT部分不用写
出清单，可调用fft 函数。并分别对单位脉冲序列、矩形序列、三角序列和正弦序列进行
FFT和IFFT验证所编程序。
xnIDFTXk六DFTXk
数字信号处理第五版
Created by ZhuangHeng
第 章
时域离散系统的网络结构
引 言
一般时域离散系统或网络可以用差分方程、单位脉冲响应以及系统函数进行描述。如
果系统输入、输出服从N阶差分方程：
nbxnZayn
则其系统函数Hz为
为了用计算机或专用硬件完成对输入信号的处理运算必须把式或者式
变换成一种算法，按照这种算法对输入信号进行运算。其实式就是对输入信号的一
种直接算法，如果已知输入信号xn以及a、b和n时刻以前的yni则可以递推出
第章
时域离散系统的网络结构
yn值。但给定一个差分方程，不同的算法有多种，例如：
H
H
Hz
可以证明以上HzHzHz但它们具有不同的算法。不同的算法直接影响系统
Createdby ZhuangHeng
口
a
数字信号处理第五版
运算误差、运算速度以及系统的复杂程度和成本等，因此研究实现信号处理的算法是一个
很重要的问题。我们用网络结构表示具体的算法，因此网络结构实际表示的是一种运算结
构。这一章是第章数字信号处理实现的必要基础。
在介绍数字系统的基本网络结构之前，先介绍网络结构的表示方法。
用信号流图表示网络结构
观察式可知，数字信号处理中有三种基本运算，即乘法、加法和单位延迟。三
种基本运算框图及其流图如图所示。
xn z xinD xn xn
xn × axn a
xn axn
a
xn xnxn xn xnxn
An xn
图 三种基本运算的流图表示
z与系数a作为支路增益写在支路箭头旁边，箭头表示信号流动方向。如果箭头旁边
没有标明增益，则认为支路增益是。两个变量相加，用一个圆点表示称为网络节点这
样整个运算结构完全可用这样一些基本运算支路组成，图所示的就是这样的流图，
该图中圆点称为节点，输入xn的节点称为源节点或输入节点，输出yn称为吸收节点或
输出节点。每个节点处的信号称节点变量，这样信号流图实际上是由连接节点的一些有方
向性的支路构成的。和每个节点连接的有输入支路和输出支路，节点变量等于所有输人支
路的输出之和。在图中，
nbovn
从该例中，我们看到用信号流图表示系统的运算情况网络结构是比较简明的。以下我们
均用信号流图表示网络结构。
不同的信号流图代表不同的运算方法，而对于同一个系统函数可以有多种信号流图与
之相对应。从基本运算考虑，满足以下条件，称为基本信号流图。
信号流图中所有支路都是基本支路，即支路增益是常数或者是z
流图环路中必须存在延迟支路；
节点和支路的数目是有限的。
Created by ZhuangHeng
b
b
xn w W W
b yn xn yn Hz a
a
a基本信号流图 b非基本信号流图
图 信号流图
图a是基本信号流图，图中有两个环路，环路增益分别为az和—az
且环路中都有延时支路，而图b不是基本信号流图，它不能决定一种具体的算法，
不满足基本信号流图的条件。
根据信号流图可以求出网络的系统函数，方法是列出各个节点变量方程，形成联立方
程组，并进行求解，求出输出与输入之间的z域关系。
【例】 求图a信号流图决定的系统函数Hz。
解 图a信号流图的节点变量方程为式，对式进行Z变换，
得到：
经过联立求解得到：
H
当结构复杂时，上面利用节点变量方程联立求解的方法较麻烦，不如用梅逊Masson
公式直接写Hz表示式方便。关于梅逊公式请参考本书附录A。
一般将网络结构分成两类，一类称为有限长单位脉冲响应网络，简称FIRFinite
Impulse Response网络，另一类称为无限长单位脉冲响应网络，简称IIRInfinite Impulse
Response网络。FIR网络中一般不存在输出对输入的反馈支路，因此差分方程用下式
描述：
n∑bxn
其单位脉冲响应hn是有限长的，按照式，hn表示为
no其他”M
IIR网络结构存在输出对输入的反馈支路，也就是说，信号流图中存在反馈环路。这类网络
的单位脉冲响应是无限长的。例如，一个简单的一阶IIR网络的差分方程为
ynaynxn
第章
时域离散系统的网络结构
Created by ZhuangHeng
a口
数字信号处理第五版
其单位脉冲响应hnaun。这两类不同的网络结构各有不同的特点，下面分类叙述其
网络结构。
IIR系统的基本网络结构
IIR系统的基本网络结构有三种，即直接型、级联型和并联型。
直接型
将N阶差分方程重写如下：
ynbrni∑asnD
对应的系统函数为
设MN按照差分方程可以直接画出网络结构如图a所示。图中第一部分系统
函数用Hz表示，第二部分用Hz表示，那么HzHz·Hz当然也可以写
成HzHz·Hz按照该式，相当于将图a中两部分流图交换位置，如图
b所示。该图中节点变量ww因此前后两部分的延时支路可以合并，形成如图
c所示的网络结构流图，我们将图c所示的这类流图称为IIR 直接型网络
xn b yn
a xn h
a
yn
xn a
yn
H Hz
xn w W b yn
a b
b a b
H H
xn b yn
c
图 IIR网络直接型结构
a
z b
a h
Created by ZhuangHeng
结构。
MN时的系统函数为
Hah
对照图c的各支路的增益系数与Hz分母分子多项式的系数可见，可以直接按照
Hz画出直接型结构流图。
【例】设IIR数字滤波器的系统函数Hz为
a
画出该滤波器的直接型结构。
解 由Hz写出差分方程如下：
ynynyngyn
xnxnxnxn
按照差分方程画出如图所示的直接型网络结构。
xn yn
图 例图
上面我们按照差分方程画出了网络结构，也可以按照Hz表达式，直接画出直接型网
络结构，这里需要用到Masson公式。
下面讲述直接型的MATLAB的表示与实现。
在MATLAB中，直接型结构由个行向量B和A表示，B和A与数字滤波器系统函
数的关系如下：
Aaaa…axBbbb…ba
则直接型系统函数为
z
z
z
第章
时域离散系统的网络结构
调用节介绍的MATLAB信号处理工具箱函数 filter 就是按照直接型结构实现滤波
器。如果滤波器输入信号向量为xn输出信号向量为yn则ynfilterBAxn按照直接
型结构实现对xn的滤波，计算系统对输入信号向量xn的零状态响应输出信号向量ynyn
与xn长度相等。
Created by ZhuangHeng
口
口
口
数字信号处理第五版
级联型
在式表示的系统函数Hz中，分子、分母均为多项式，且多项式的系数一般
为实数。现将分子、分母多项式分别进行因式分解，得到：
式中，A是常数；c和d分别表示Hz的零点和极点。由于多项式的系数是实数，c和
d是实数或者是共轭成对的复数，将共轭成对的零点极点放在一起，形成一个二阶多项
式，其系数仍为实数；再将分子、分母均为实系数的二阶多项式放在一起，形成一个二阶网
络Hz。Hz如下式：
HRe
式中，B、β、β、a和a均为实数。这样Hz就分解成一些一阶或二阶的子系统函数的
相乘形式：
HzHzHz…Hz
式中Hz表示一个一阶或二阶的数字网络的子系统函数，每个Hz的网络结构均采用
前面介绍的直接型网络结构，如图所示，Hz则由k个子系统级联构成。
xn A yn xn A yn
a A
a直接型一阶网络结构
a zR
a R
b直接型二阶网络结构
图 一阶和二阶直接型网络结构
【例】 设系统函数Hz如下式：
Hz
试画出其级联型网络结构。
解 将Hz的分子、分母进行因式分解，得到：
Hz
为减少单位延迟的数目，将一阶的分子、分母多项式组成一个一阶网络，二阶的分子、分母
多项式组成一个二阶网络，画出级联结构图如图所示。
级联型结构中每一个一阶网络决定一个零点、一个极点，每一个二阶网络决定一对零
点、一对极点。在式中，调整B、β和β三个系数可以改变一对零点的位置，调整
aj和a可以改变一对极点的位置。因此，相对直接型结构，其优点是调整方便。此外，级联
结构中后面的网络输出不会再流到前面，运算误差的积累相对直接型也小。
Created by ZhuangHeng
xn yn
Fsz
图 例图
并联型
如果将级联形式的Hz展成部分分式形式，则得到：
HzHzHz十…Hz
对应的网络结构为这k个子系统并联。上式中，Hz通常为一阶网络或二阶网络，网络系
数均为实数。二阶网络的系统函数一般为
HRBa
式中，β、β、a和a都是实数。如果βa则构成一阶网络。由式，其输出
Yz表示为
YzHzXzHzXz…HzXz
上式表明将xn送入每个二阶包括一阶网络后，将所有输出加起来得到输出yn。
【例】 画出例题中的Hz的并联型结构。
解 将例中Hz展成部分分式形式：
H
将每一部分用直接型结构实现，其并联型网络结构如图所示。
xn yn
当见打骨书的用的民省
图 例图
在这种并联型结构中，每一个一阶网络决定一个实数极点，每一个二阶网络决定一对
共轭极点，因此调整极点位置方便，但调整零点位置不如级联型方便。另外，各个基本网络
是并联的，产生的运算误差互不影响，不像直接型和级联型那样有误差积累，因此，并联形
式运算误差最小。由于基本网络并联，可同时对输入信号进行运算，因此并联型结构与直
接型和级联型比较，其运算速度最高。
MATLAB信号处理工具箱提供了种线性系统网络结构变换函数，实现各种结构之
Created by ZhuangHeng
数字信号处理第五版
间的变换。可惜缺少并联结构与其他结构之间的变换函数，参考文献中开发了直
接型与并联型的相互变换函数tfpar和partf。本书涉及的种常用结构直接型、级联
型、格型之间的变换函数有如下种：
tfsos 直接型到级联型结构变换。
sostf级联型到直接型网络结构的变换。
tflatc 直接型到格型结构变换。
latetf格型到直接型结构变换。
下面先简要介绍变换函数tfsos和 sostf及其调用格式，tflatc和 latctf在节
介绍。
SGtfsosBA实现直接型到级联型的变换。B和A分别为直接型系统
函数的分子和分母多项式系数向量，当A时，表示FIR系统函数。返回L级二阶级联
型结构的系数矩阵S和增益常数G。
S为L×矩阵，每一行表示一个二阶子系统函数的系数向量，第k行对应的阶系统函
数为
Hhbaz k…L
级联结构的系统函数为
HzHzHz…Hz
例的求解程序如下：
B
A
SGtfsosBA
运行结果：
S
G
Hzzz
该结果与例所得结果等价，但本程序结果更标准。
BAsostfSG实现级联型到直接型网络结构的变换。B、A、S和G的
含义与SGtfsosBA中相同。
Created by ZhuangHeng
FIR系统的基本网络结构
FIR网络结构特点是没有反馈支路，即没有环路，其单位脉冲响应是有限长的。设单
位脉冲响应hn长度为N其系统函数Hz和差分方程分别为
Hahnz
yn∑hmznm
直接型
按照Hz或者卷积公式直接画出结构图如图所示。这种结构称为直接型网络
结构或者称为卷积型结构。
xn z
hO h h hN hN
yn
图 FIR直接型网络结构
级联型
将Hz进行因式分解，并将共轭成对的零点放在一起，形成一个系数为实数的二阶形
式，这样级联型网络结构就是由一阶或二阶因子构成的级联结构，其中每一个因式都用直
接型实现。
【例】设FIR网络系统函数Hz如下式：
Hzzzz
画出 Hz的直接型结构和级联型结构。
解 将Hz进行因式分解，得到：
Hzzzz
其级联型结构和直接型结构如图a和b所示。
xn yn xn z
z
b
第章
时域离散系统的网络结构
a
图 例图
yn
Created by ZhuangHeng
口
口口
数字信号处理第五版
例的求解程序如下：
B
A
SGtfsosBA
运行结果：
S
G
级联结构的系统函数为
Hzzzz
级联型结构每一个一阶因子控制一个零点，每一个二阶因子控制一对共轭零点，因此
调整零点位置比直接型方便，但Hz中的系数比直接型多，因而需要的乘法器多。在例
中直接型需要四个乘法器，而级联型则需要五个乘法器。分解的因子愈多，需要的乘
法器也愈多。另外，当Hz的阶次高时，也不易分解。因此，普遍应用的是直接型。
FIR系统的线性相位结构
线性相位结构是FIR系统的直接型结构的简化网络结构，特点是网络具有线性相位特
性，比直接型结构节约了近一半的乘法器。第章将证明，如果系统具有线性相位，它的单
位脉冲响应满足下面公式：
hn士hNn
式中，“十”代表第一类线性相位滤波器；“一”代表第二类线性相位滤波器。系统函数满足
下面两式：
当N为偶数时，
HZhne±
当N为奇数时，
HehCe±IA
观察式和式，运算时先进行方括号中的加法减法运算，再进行乘法运算，
这样就节约了乘法运算。按照这两个公式，第一类线性相位网络结构的流图如图所
示，第二类线性相位网络结构的流图如图所示。和直接型结构比较，如果N取偶数，
直接型需要N个乘法器，而线性相位结构减少到N个乘法器，节约了一半的乘法器。如
果N取奇数，则乘法器减少到N个，也近似节约了近一半的乘法器。
Created by ZhuangHeng
xn
…
z ho hD h hNDT
yn
aN为偶数
z xn
…
h
…
z ho hD hN
yn
bN为奇数
图 第一类线性相位网络结构流图
xn z …
z
h
…
z z
hO h hND
yn
aN为偶数
xn
…
z
…
hO h h hN
·yn
bN为奇数 第章
图 第二类线性相位网络结构流图
FIR系统的频率采样结构
我们已经知道，频率域等间隔采样，相应的时域信号会以采样点数为周期进行周期性
延拓。如果在频率域采样点数N大于等于原序列的长度M则不会引起信号失真，此时由
式得到原序列的Z变换Hz与频域采样值Hk满足下面关系式：
时域离散系统的网络结构
Ha六H
设FIR滤波器单位脉冲响应hn长度为M系统函数HzZThn则式中
Hk用下式计算：
HkHzk…N
要求频率域采样点数N≥M。式提供了一种称为频率采样的网络结构。由于这种结
构是通过频域采样得来的，存在时域混叠的问题，因此不适合IIR系统，只适合FIR系统。
Created by ZhuangHeng
口口
口口
口口
口
数字信号处理第五版
但这种网络结构中又存在反馈网络，不同于前面介绍的FIR网络结构，下面进行分析。
将式写成下式：
Hz青H∑H
Hzz
HzWk
式中Hz是前面学习过的梳状滤波器，Hz是IIR的一阶网络。这样，Hz是由梳状
滤波器Hz和N个一阶网络Hz的并联结构进行级联而成的，其网络结构如图
所示。我们看到该网络结构中有反馈支路，它是由Hz产生的，其极点为
zek…N
即它们是单位圆上等间隔分布的N个极点，第章已学过Hz是一个梳状滤波网络，其
零点为
ze k…N
刚好和极点相同，也是等间隔地分布在单位圆上。理论上，极点和零点相互抵消，保证了网
络的稳定性，使频率域采样结构仍属FIR网络结构。
xn HO yn
z w
H
之
w HND
z w
图 FIR 滤波器频率采样结构
频率域采样结构有两个突出优点：
在频率采样点w处，HeHk只要调整Hk即一阶网络Hz中乘法
器的系数Hk就可以有效地调整频响特性，使实践中调整方便，可以实现任意形状的
频响曲线。
只要hn长度N相同，对于任何频响形状，其梳状滤波器部分和N个一阶网络部
分结构完全相同，只是各支路增益Hk不同。这样，相同部分便可以标准化、模块化。各
支路增益可做成可编程单元，生产可编程FIR 滤波器。
然而，上述频率采样结构亦有两个缺点：
系统稳定是靠位于单位圆上的N个零极点相互对消保证的。实际上，因为寄存器
字长都是有限的，对网络中支路增益WN量化时产生量化误差，可能使零极点不能完全对
消，从而影响系统稳定性。
Created by ZhuangHeng
结构中，Hk和Wn一般为复数，要求乘法器完成复数乘法运算，这对硬件实现
是不方便的。
为了克服上述缺点，对频率采样结构作以下修正。
首先将单位圆上的零极点向单位圆内收缩一点，收缩到半径为r的圆上，取r且
r≈。此时Hz为
Hzrs六wA
式中，Hk是在r圆上对Hz的N点等间隔采样值。由于r≈因此可近似取Hk≈
Hk。这样，零极点均为rek…N。如果由于实际量化误差，零极点不
能抵消时，极点位置仍处在单位圆内，保持系统稳定。
另外，由DFT的共轭对称性知道，如果hn是实数序列，则其离散傅里叶变换Hk
关于N点共轭对称，即HkHNk。而且WNWN我们将Hz和
HNz合并为一个二阶网络，并记为Hz则
HrwHwNk
ww
式中
—RdFHW k…
显然，二阶网络Hz的系数都为实数，其结构如图a所示。当N为偶数时，Hz
可表示为
Hoa点
第章时域离散系统的网络结构 式中，H和HN为实数。式对应的频率采样修正结构由N个二阶网
络和两个一阶网络并联构成，如图b所示。当N奇数时，只有一个采样值HO
为实数，Hz可表示为
Haa”
N等于奇数的修正结构由一个一阶网络和N个二阶网络结构构成。
由图可见，当采样点数N很大时，其结构显然很复杂，需要的乘法器和延时单
Created by ZhuangHeng
口
口口 口
数字信号处理第五版
ao xn HO yn
a
z z
Hz
N
r z
H
H
HN
z r
a b
图 频率采样修正结构
元很多。但对于窄带滤波器，大部分频率采样值Hk为零，从而使二阶网络个数大大减
少。所以频率采样结构适用于窄带滤波器。
格型网络结构
格型网络结构适用于一般时域离散系统，结构的优点是对有限字长效应比较不敏感，
且适合递推算法。它在一般数字滤波器、自适应滤波器、线性预测以及谱估计中都有广泛
的应用。
全零点格型网络结构
全零点格型网络的系统函数
全零点格型网络结构的流图如图所示。该流图只有直通通路，没有反馈回路，
因此可称为FIR格型网络结构。观察该图，它可以看成是由图的基本单元级联而成。
xne。n en nn eanyn
k k k
k k
nz n z n nz rn
图 全零点格型网络结构
en en
k
k
n n
图 基本单元
Created by ZhuangHeng
按照图写出差分方程如下：
eneinrnk
rnenkrn
将上式进行Z变换，得到
EzEzzRzk
RzEzkzRz
再将上式写成矩阵形式
ReR
将N个基本单元级联后，得到：
ReRe
令YzENzXzE。zR。z其输出为
YaRe立xa
由上式得到全零点格型网络的系统函数为
Ha
只要知道格型网络的系数kL…N由上式可以直接求出FIR格型网络的系
统函数。
由FIR直接型网络结构转换成全零点格型网络结构
假设N阶FIR型网络结构的系统函数为
Hhs”
式中，hhn是FIR 网络的单位脉冲响应。令ahk得到：
H∑a 离
式中，aohk为全零点格型网络的系数，L…N。
下面仅给出转换公式，推导过程请参考文献
aa
afk
aka k…
式中，LNN…。
Created by ZhuangHeng
口口
口
口口
品
口口
口
数字信号处理第五版
解释 公式中的下标k或表示第k或D个系数，这里FIR结构和格型结构均各有
N个系数；式是一个递推公式，上标带圆括弧表示递推序号，从N开始，然后
是NN…注意式ak当递推到上标圆括弧中的数字与下标相
同时，格型结构的系数k刚好与FIR的系数aa相等。下面举例说明。
【例】 将下面三阶FIR系统函数Hz转换成格型网络，要求画出该FIR直接
型结构和相应的格型网络结构流图。
Hzzzz
解 例题中N按照式，有
aaa
由式，得到：
ksa
按照式，递推得到：
Lk时，
k×
Lk时，
aka×
ka
lk时，
aa×
k
最后按照算出的格型结构的系数，画出三阶FIR直接型结构和三级格型网络结构流图如图
所示。
xn
yn
a直接型结构
xnen en en enyn
k k k
k k k
nz n zn Fn
b格型网络结构
图 例图
Created by ZhuangHeng
略去由全零点格型网络结构转换到FIR直接型网络结构的公式，如需要了解该内容，
请参考文献。
实际上，调用MATLAB函数实现直接型网络结构与格型网络结构之间的相互转换非
常容易。tflatc实现直接型到格型结构变换，latctf 实现格型到直接结型结构变换。
Ktflatehn求FIR格型结构的系数向量Kkk…k、hn为FIR滤波器
的单位脉冲响应向量，并关于hnh归一化。应当注意，当FIR系统函数在单位圆
上有零极点时，可能发生转换错误。
hnlatctfK将FIR格型结构转换为FIR直接型结构。K为FIR格型结构的系数向
量，hn为FIR 滤波器的单位脉冲响应向量，即FIR 直接型结构系数向量。显然，该函数可
以用于求格型结构的系统函数的系数。
例的求解程序如下：
hn
Ktflatehn
运行结果：
K
与上面的递推结果相同。
全极点格型网络结构
全极点IIR系统的系统函数用下式表示：
Aa
式中，Az是FIR系统，因此全极点IIR系统Hz是FIR系统Az的逆系统。下面先介
绍如何将Hz变成Az。
假设系统的输入和输出分别用xn、yn表示，由式得到全极点IIR 滤波器
的差分方程为
ynZaynkxn
第章时域离散系统的网络结构
如果将xn、yn的作用相互交换，差分方程则变成下式：
xnaxnkyn
则
ymzn∑arnk
观察上式，它描述的是具有系统函数HzAz的FIR系统，而式描述的是
Created by ZhuangHeng
……………dooo □ ■
口
口口
品口口
口
□口
数字信号处理第五版
HzAz的IIR系统。按照式描述的全极点直接型结构如图所示。
xn
a ar a a
yn
图 全极点IIR系统的直接型结构
基于上面的事实，我们将FIR格型结构通过交换公式中的输入输出作用，形成它的逆
系统，即全极点格型IIR系统。重新定义输入输出
znexnyne。n
再将FIR格型结构的基本公式、重写如下：
enenrnk
rneinkrn
由于重新定义了输入输出，将en按降序运算，rn不变，即
xnenn
enenrnklNN…
rnenkrnlNN…
yne。nr。n
按照上面四个方程画出它的结构如图所示。为了说明这是一个全极点IIR系统，令
N得到方程为
xnen
e。nenr。nk
rne。nkr。n
yne。nxnkyn
xneyn en en on yn
k k k
k k k
n z n n zrn n
图 全极点IIR格型结构
当xn和yn分别作为输入和输出时，式就是一个全极点的差分方程，由
～式描述的结构就是一阶的单极点格型网络，如图a所示。如果
N可得到下面方程组：
xnen
enenkrn
Created by ZhuangHeng
rnkenrn
e。nenkrn
rnkeanr。n
yne。nr。n
xn en e。n yn xn en gn e。n yn
k
k
k
k
k k
rn n Fn zrn z
a b
图 单极点和双极点IIR格型网络结构
经过化简，得到：
ynkkynkynxn
rnkynkkynyn
显然，式差分方程表示的就是双极点IIR系统。按照上面两式构成的双极点IIR
格型结构如图b所示。
由上面分析知道，全极点网络可以由全零点格型网络形成，这是一个求逆的问题。对
比全零点格型结构和全极点结构，可以归纳出下面的一般求逆准则：
将输入到输出的无延时通路全部反向，并将该通路的常数支路增益变成原常数的
倒数此处为
将指向这条新通路的各节点的其他节点的支路增益乘以
将输入输出交换位置。
调用MATLAB转换函数可以实现全极点系统的直接型和格型结构之间的转换。
KtflatcA求IIR全极点系统格型结构的系数向量KA为式给出
的IIR全极点系统函数的分母多项式Az的系数向量。
具有零点和极点的IIR格型网络称为格梯型网络结构，这部分内容请参考文献和
的例。
KV tflateBA求具有零点和极点的IIR格型网络系数向量K及其梯型网
络系数向量V。应当注意，当IIR系统函数在单位圆上有极点时，可能发生转换错误。
BAlatetfKallpole将IIR全极点系统格型结构转换为直接型结构。K为
IIR全极点系统格型结构的系数向量，A为IIR全极点系统系数函数的分母多项式Az的
系数向量。显然，该函数可以用于求格型结构的系统函数，这时分子为常数所以B。
BAlatctfKV将具有零点和极点的IIR格梯型网络结构转换为直接型结构。
例如：
第章时域离散系统的网络结构
Created by ZhuangHeng
数字信号处理第五版
Azzzz
则求IIR全极点系统格型结构系数向量K的程序为
A
KtflateA
运行结果：
K
对上面所求格型结构的系数向量K调用latctf求其对应的格型结构的系统函数的程
序如下：
K
BAlatetfKallpole
运行结果：
B
A
对应的系统函数为
Hz②zz
下面再推导全极点网络结构的系统函数，将和式进行Z变换，得到：
EzEzzRzk
RzEzkzRz
写成矩阵形式：
Ra②
将N个基本单元级联后，得到：
XzENzYzEzR。z
xaere
m
与全零点格型网络的系统函数式比较，全极点格型网络的系统函数正好是
式的倒数。
全极点格型网络同样存在稳定问题，可以证明稳定的充分必要条件是k≤L
…N。
具有零点和极点的IIR格型网络称为格梯形网络结构，这部分内容请参考文献。
Created by ZhuangHeng
习题与上机题
已知系统用下面差分方程描述：
ynyngynxnzn
试分别画出系统的直接型、级联型和并联型结构。式中xn和yn分别表示系统的输入和
输出信号。
设数字滤波器的差分方程为
ynxnxnyniyn
试画出系统的直接型结构。
设系统的差分方程为
ynabynabynxnabxnabxn
式中，abxn和yn分别表示系统的输入和输出信号，试画出系统的直接
型和级联型结构。
设系统的系统函数为
Hzad
试画出各种可能的级联型结构，并指出哪一种最好。
题图中画出了四个系统，试用各子系统的单位脉冲响应分别表示各总系统的单位
脉冲响应，并求其总系统函数。
xn hn hn hn yn
a
hn
xn
xn hn yn hn hn yn
hjn
b
hn
e 第章时域离散系统的网络结构 hn
hn yn
xn hn
hsn
d
题图
题图中画出了种不同的流图，试分别写出它们的系统函数及差分方程。
hn
Created by ZhuangHeng
见■ 口
口
口口
口
口口
口口
口
口
口
□
a口
数字信号处理第五版
xn yn xn yn xn z
z a b
a z c yn
a b c
xn yn xn yn
xn a yn z z
b
d e
xn
xn yn
z
m yn
h
xn b yn xn b yn
a
z
a b a
z
a b
z
b a
a
b
b
①
题图
假设滤波器的单位脉冲响应为
hnaun a
求出滤波器的系统函数，并画出它的直接型结构。
已知系统的单位脉冲响应为
hnnnnnn
试写出系统的系统函数，并画出它的直接型结构。
已知FIR滤波器的系统函数为
Hzzzz
试画出该滤波器的直接型结构和线性相位结构。
已知FIR滤波器的单位脉冲响应为：
N
hh
hh
Created by ZhuangHeng
hh
N
hh
hh
hh
h
试画出它们的线性相位型结构图，并分别说明它们的幅度特性、相位特性各有什么特点。
已知FIR滤波器的个频率采样值为：
H H～H
Hj√ Hj
Hj Hj√
试画出其频率采样结构，选择r可以用复数乘法器。
已知FIR滤波器系统函数在单位圆上个等间隔采样点为：
H HH
Hj√ Hj
Hj Hj√
试画出它的频率采样结构，取修正半径r要求用实数乘法器。
已知FIR滤波器的单位脉冲响应为
hnnnδn
试用频率采样结构实现该滤波器。设采样点数N要求画出频率采样网络结构，写出滤
波器参数的计算公式。
令：
Hzxzz
Hzzzz
HzHzHz
分别画出它们的直接型结构。
写出题图中系统的系统函数和单位脉冲响应。
xn
z
yn
题图
画出题图中系统的转置结构，并验证两者具有相同的系统函数。
第章时域离散系统的网络结构
Created by ZhuangHeng
口
口
口
口口
数字信号处理第五版
用b和b确定a、a、c和c。使题图中的两个系统等效。
xn yn xn co yn
z
b a a G
a b
题图
对于题图中的系统，要求：
确定它的系统函数；
如果系统参数为
① bbbaa
② b。bbaa
画出系统的零极点分布图，并检验系统的稳定性。
xn
b b b
yn
a a
z
题图
°假设滤波器的系统函数为
Hz
在单位圆上采样六点，选择r试画出它的频率采样结构，并在计算机上用DFT求
出频率采样结构中的有关系数。
已知FIR滤波器的系统函数为：
Hzzz
Hzzzz
试分别画出它们的直接型结构和格型结构，并求出格型结构的有关参数。
假设FIR格型网络结构的参数kkkk求系
统的系统函数并画出FIR直接型结构。
假设系统的系统函数为
Hzzzzz
要求：
画出系统的直接型结构以及描述系统的差分方程；
画出相应的格型结构，并求出它的系数；
判断系统是否为最小相位系统。
Created by ZhuangHeng
第章
无限脉冲响应数字滤波器的设计
数字滤波器的基本概念
所谓数字滤波器，是指输人、输出均为数字信号，通过数值运算处理改变输入信号所
含频率成分的相对比例，或者滤除某些频率成分的数字器件或程序。因此，数字滤波的概
念和模拟滤波相同，只是信号的形式和实现滤波方法不同。正因为数字滤波通过数值运算
实现滤波，所以数字滤波器处理精度高、稳定、体积小、重量轻、灵活、不存在阻抗匹配问
题，可以实现模拟滤波器无法实现的特殊滤波功能。如果要处理的是模拟信号，可通过
ADC和DAC在信号形式上进行匹配转换，同样可以使用数字滤波器对模拟信号进行
滤波。
第章
数字滤波器的分类
按照不同的分类方法，数字滤波器有许多种类，但总起来可以分成两大类：经典滤波
器和现代滤波器。经典滤波器的特点是其输入信号中有用的频率成分和希望滤除的频率成
分各占有不同的频带，通过一个合适的选频滤波器滤除干扰，得到纯净信号，达到滤波的
目的。例如，输入信号xt中含有干扰，其时域波形和频谱图分别如图a、b所
示，由图可见，信号和干扰的频带互不重叠，可用图c所示低通滤波器滤除干扰，
无限脉冲响应数字滤波器的设计
得到纯信号，如图d所示。
但是，如果信号和干扰的频谱相互重叠，则经典滤波器不能有效地滤除干扰，最大限
度地恢复信号，这时就需要现代滤波器，例如维纳滤波器、卡尔曼滤波器、自适应滤波器等
最佳滤波器。现代滤波器是根据随机信号的一些统计特性，在某种最佳准则下，最大限度
地抑制干扰，同时最大限度地恢复信号，从而达到最佳滤波的目的。本书仅介绍经典滤波器
Created by ZhuangHeng
口
口口
口口口口
口口
B口
口
数字信号处理第五版
x
ts
a信号加噪声波形
幅度
L
fHz
b信号加噪声的频谱
幅度
l
fHz
c低通滤波器幅频特性
s
d滤除噪声后的信号波形
图 用经典滤波器从噪声中提取信号
的设计分析与实现方法，而现代滤波器属于随机信号处理范畴，已超出本书学习范围。
经典数字滤波器从滤波特性上分类，可以分成低通、高通、带通和带阻等滤波器。它们
的理想幅频特性如图所示。这种理想滤波器是不可能实现的，因为它们的单位脉冲
IHeI IHeI
π π② π π
a低通 b高通
HelI IHemI
π π π π
c带通 d带阻
图 理想低通、高通、带通和带阻滤波器幅度特性
Created by ZhuangHeng
响应均是非因果且无限长的，我们只能按照某些准则设计滤波器，使之在误差容限内逼近
理想滤波器，理想滤波器可作为逼近的标准。另外，需要注意的是，数字滤波器的频率响应
函数He都是以π为周期的，低通滤波器的通频带中心位于π的整数倍处，而高通滤
波器的通频带中心位于π的奇数倍处，这一点和模拟滤波器是有区别的。一般在数字频率
的主值区一ππ描述数字滤波器的频率响应特性。
数字滤波器从实现的网络结构或者从单位脉冲响应长度分类，可以分成无限长单位脉
冲响应IIR滤波器和有限长单位脉冲响应FIR滤波器。它们的系统函数分别为：
Hs∑hns
式中的Hz称为N阶IIR数字滤波器系统函数；式中的Hz称为N
阶FIR数字滤波器系统函数。这两种数字滤波器的设计方法有很大区别，因此下面分成两
章分别进行学习。
根据滤波器对信号的处理作用又将其分为选频滤波器和其他滤波器。上述低通、高通、
带通和带阻滤波器均属于选频滤波器，其他滤波器有微分器、希尔伯特变换器、频谱校正
等滤波器。
滤波器可用于波形形成、调制解调器、从噪声中提取信号见图、信号分离和信
道均衡等。所以学习滤波器的设计与实现是必不可少的。运行本书程序集中的绘图程序
figbm可以清楚地观察用滤波器分离载波频率不同的两路双边带信号的原理。
数字滤波器的技术指标
常用的数字滤波器一般属于选频滤波器。假设数字滤波器的频率响应函数He用下
式表示：
He”Hee
式中，He称为幅频特性函数；θw称为相频特性函数。幅频特性表示信号通过该滤
波器后各频率成分振幅衰减情况，而相频特性反映各频率成分通过滤波器后在时间上的延
时情况。因此，即使两个滤波器幅频特性相同，而相频特性不同，对相同的输入，滤波器输
出的信号波形也是不一样的。一般选频滤波器的技术指标由幅频特性给出，对几种典型滤
波器如巴特沃斯滤波器其相频特性是确定的，所以设计过程中，对相频特性一般不作
要求。但如果对输出波形有要求，则需要考虑相频特性的技术指标，例如波形传输、图像信
号处理等。本章主要研究针对幅频特性指标的选频滤波器设计。如果对输出波形有严格要
求，则需要设计线性相位数字滤波器，这部分内容在第章介绍。
第章无限脉冲响应数字滤波器的设计
对于图所示的各种理想滤波器，我们必须设计一个因果可实现的滤波器去近似
实现。另外，也要考虑复杂性与成本问题，因此实用中通带和阻带中都允许一定的误差容
限，即通带不是完全水平的，阻带不是绝对衰减到零。此外，按照要求，在通带与阻带之间
Created by ZhuangHeng
数字信号处理第五版
还应设置一定宽度的过渡带。
图表示低通滤波器的幅频特性，w。和w分别称为通带边界频率和阻带截止频
率。通带频率范围为≤lw≤w在通带中要求δHe≤阻带频率范围为
w≤lw≤π在阻带中要求He≤δ。从w。到w称为过渡带，过渡带上的频响一般是
单调下降的。通常，通带内和阻带内允许的衰减一般用分贝数表示，通带内允许的最大衰
减用a表示，阻带内允许的最小衰减用a表示。对低通滤波器，a和a分别定义为：
mxHedB o≤ml a
a疆带中max H a
显然，a越小，通带波纹越小，通带逼近误差就越小；a越大，阻带波纹越小，阻带逼近误
差就越小；u。与w间距越小，过渡带就越窄。所以低通滤波器的设计指标完全由通带边界
频率a、通带最大衰减αp、阻带边界频率w和阻带最小衰减a确定。
片段常数特性：对于选频型滤波器，一般对通带和阻带内的幅频响应曲线形状没有具
体要求，只要求其波纹幅度小于某个常数，通常将这种要求称为“片段常数特性”。所谓片
段，是指“通带”和“阻带”常数是指“通带波纹幅度δ”和“阻带波纹幅度δ”而通带最大
衰减a。和阻带最小衰减a是与δ和δ完全等价的两个常数。片段常数特性概念在选频型
滤波器设计中很重要，尤其有助于理解IIR数字滤波器的双线性变换设计思想。
对图所示的单调下降幅频特性，a和a分别可以表示为
gHdB b
agHaB b
√
Hem
图 低通滤波器的幅频特性指标示意图
如果将He°归一化为b和b式则表示为：
a lgHCedB
a lgHedB
Created by ZhuangHeng
当幅度下降到√时，标记ww此时α lgHe dB称w。为 dB通带截
止频率。wp、w和w统称为边界频率，它们是滤波器设计中所涉及的很重要的参数。对其
他类型的滤波器，b式和b式中的He°应改成Heo。为滤波器通带中
心频率。
数字滤波器设计方法概述
IIR滤波器和FIR滤波器的设计方法完全不同。IIR 滤波器设计方法有间接法和直接
法，间接法是借助于模拟滤波器的设计方法进行的。其设计步骤是：先设计过渡模拟滤波
器得到系统函数Hs然后将Hs按某种方法转换成数字滤波器的系统函数Hz。这
是因为模拟滤波器的设计方法已经很成熟，不仅有完整的设计公式，还有完善的图表和曲
线供查阅；另外，还有一些典型的优良滤波器类型可供我们使用。直接法直接在频域或者
时域中设计数字滤波器，由于要解联立方程，设计时需要计算机辅助设计。FIR滤波器不
能采用间接法，常用的设计方法有窗函数法、频率采样法和切比雪夫等波纹逼近法。
对于线性相位滤波器，经常采用FIR滤波器。可以证明，FIR滤波器的单位脉冲响应
满足一定条件时，其相位特性在整个频带是严格线性的，这是模拟滤波器无法达到的。当
然，也可以采用IIR滤波器，但必须使用全通网络对其非线性相位特性进行校正，这样增加
了设计与实现的复杂性。
本章只介绍IIR 滤波器的间接设计方法。为此，我们先介绍模拟低通滤波器的设计，这
是因为低通滤波器的设计是设计其他滤波器的基础。模拟高通、带通和带阻滤波器的设计
过程是：先将希望设计的各种滤波器的技术指标转换为低通滤波器技术指标，然后设计相
应的低通滤波器，最后采用频率转换法将低通滤波器转换成所希望的各种滤波器。
应当说明，滤波器设计公式较多，计算繁杂。但是，在计算机普及的今天，各种设计方
法都有现成的设计程序或设计函数供我们调用。所以，只要掌握了滤波器基本设计原理，
在工程实际中采用计算机辅助设计滤波器是很容易的事。
模拟滤波器的设计
模拟滤波器的理论和设计方法已发展得相当成熟，且有多种典型的模拟滤波器供我们
选择，如巴特沃斯Butterworth滤波器、切比雪夫Chebyshev滤波器、椭圆Ellipse滤波
器、贝塞尔Bessel滤波器等。这些滤波器都有严格的设计公式、现成的曲线和图表供设计
人员使用，而且所设计的系统函数都满足电路实现条件。这些典型的滤波器各有特点：巴
特沃斯滤波器具有单调下降的幅频特性；切比雪夫滤波器的幅频特性在通带或者阻带有等
波纹特性，可以提高选择性；贝塞尔滤波器通带内有较好的线性相位特性；椭圆滤波器的
选择性相对前三种是最好的，但通带和阻带内均呈现等波纹幅频特性，相位特性的非线性
也稍严重。设计时，根据具体要求选择滤波器的类型。
第章无限脉冲响应数字滤波器的设计
选频型模拟滤波器按幅频特性可分成低通、高通、带通和带阻滤波器，它们的理想幅
Created by ZhuangHeng
数字信号处理第五版
频特性如图所示。但设计滤波器时，总是先设计低通滤波器，再通过频率变换将低
通滤波器转换成希望类型的滤波器。下面先介绍低通滤波器的技术指标和逼近方法，然后
分别介绍巴特沃斯滤波器和切比雪夫滤波器的设计方法。椭圆滤波器的设计理论比较复
杂，所以只介绍其MATLAB设计函数，并举例说明直接调用MATLAB函数设计椭圆滤
波器的方法。其他滤波器的设计方法请参考文献。
IHGDI IIHGt
Q Q
a低通 b高通
IHGO BGDI
O Q
c带通 d带阻
图 各种理想模拟滤波器幅频特性
模拟低通滤波器的设计指标及逼近方法
本书中，分别用h。t、Hs、HGj表示模拟滤波器的单位冲激响应、系统函数、频
率响应函数，三者的关系如下：
HsLThhted
HjaFTLh厂hed
可以用h。t、Hs、Hj中任一个描述模拟滤波器，也可以用线性常系数微分方程描
述模拟滤波器。但是设计模拟滤波器时，设计指标一般由幅频响应函数Hj给出，而
模拟滤波器设计就是根据设计指标，求系统函数Hs。
工程实际中通常用所谓的损耗函数也称为衰减函数AΩ来描述滤波器的幅频响应
特性，对归一化幅频响应函数maxHj本书后面都是针对该情况，特别说明的
除外AΩ定义如下其单位是分贝，用dB表示
AΩ IgIHj lgHjIdB
应当注意，损耗函数A和幅频特性函数Hj只是滤波器幅频响应特性的两种
描述方法。损耗函数的优点是对幅频响应Hj的取值非线性压缩，放大了小的幅度，
从而可以同时观察通带和阻带频响特性的变化情况。二者的特点如图所示。图
a所示的幅频响应函数完全看不清阻带内取值较小以下的波纹，而图
b所示的同一个滤波器的损耗函数则能很清楚地显示出阻带 dB以下的波纹变化曲线。
Created by ZhuangHeng
另外，直接画出的损耗函数曲线图正好与幅频特性曲线形状相反，所以，习惯将
AΩ曲线称为损耗函数本书中也如此称谓如图b所示。
F
HG
AdB
oL
fHz fHz
a幅频特性曲线 b损耗函数曲线
图 幅频响应与损耗函数曲线的比较
模拟低通滤波器的设计指标参数有ap、、a和Ω。其中Ω和Ω分别称为通带边界
频率和阻带截止频率，a。称为通带最大衰减即通带中允许AΩ的最大值a称
为阻带最小衰减即阻带Ω≥Ω上允许AΩ的最小值ap和a的单位为dB。以上技术指
标如图所示，图a以幅频特性描述，图b以损耗函数描述。
o下
√ IRon A
α
aQ Q BQ Q
Q Q
图 模拟低通滤波器的设计指标参数示意图
由图可见，对于单调下降的幅度特性，a。和a可表示成：
a IgHGj
a lgIHjΩI
因为图中HΩ√ lgHjΩdB所以Ω。称为 dB截止频率。
δ和分别称为通带和阻带波纹幅度，容易得到关系式：
ap Ig
a lgo
滤波器的技术指标给定后，需要设计一个系统函数Hs希望其幅度平方函数
Hj满足给定的指标。一般滤波器的单位冲激响应为实函数，因此
第章无限脉冲响应数字滤波器的设计
Created by ZhuangHeng
口
口
口口
口口
■口
口口
口
口
数字信号处理第五版
IHjHsHsnHjHj
如果能由αp、、a和Ω求出HjΩ那么就可以求出HsHs由此可求出所
需要的Hs。Hs必须是因果稳定的，因此极点必须落在s平面的左半平面，相应的
Hs的极点必然落在右半平面。这就是由HsHs求所需要的Hs的具体原
则，即模拟低通滤波器的逼近方法。因此幅度平方函数在模拟滤波器的设计中起着很重要
的作用。对于上面介绍的五种典型滤波器，其幅度平方函数都有确知表达式，可以直接
引用。
巴特沃斯低通滤波器的设计
巴特沃斯低通模拟滤波器设计原理
巴特沃斯低通滤波器的幅度平方函数Hj用下式表示：
BoP
式中，N称为滤波器的阶数。当Ω时，HGjΩΩ。时，Hj√Ω
是dB截止频率。在ΩΩ附近，随Ω加大，幅度迅速下降。幅度特性与Ω和N的关系如
图所示。幅度下降的速度与阶数N有关，N愈大，通带愈平坦，过渡带愈窄，过渡
带与阻带幅度下降的速度愈快，总的频响特性与理想低通滤波器的误差愈小。
以s替换j将幅度平方函数Hj写成s的函数：
BOH
复变量saj此式表明幅度平方函数有N个极点，极点s用下式表示：
sGjΩe
式中，k…N。N个极点等间隔分布在半径为Ω。的圆上该圆称为巴特沃
斯圆间隔是πN rad。例如N极点间隔为π rad如图所示。
jQ
S Ss
Hr N
N S S
N
Q
Ω
图 巴特沃斯低通滤波器幅度特性与
n和N的关系
图 三阶巴特沃斯滤波器极点分布图
Created by ZhuangHeng
为形成因果稳定的滤波器，N个极点中只取s平面左半平面的N个极点构成Hs
而右半平面的N个极点构成H一s。Hs的表达式为
设N极点有个，它们分别为
sΩesΩsΩe
ssAesΩssne
取s平面左半平面的极点s。、S、S组成系统函数Hs即
BSaGcae
由于不同的技术指标对应的边界频率和滤波器幅频特性不同，为使设计公式和图表统
一，将频率归一化。巴特沃斯滤波器采用对 dB截止频率Ω。归一化，归一化后的系统函
数为
一
令pηjλsΩλΩλ称为归一化频率，p称为归一化复变量，这样巴特沃斯滤波
器的归一化低通原型系统函数为
BcoA
式中，psΩ为归一化极点，用下式表示：
pe k…N
显然，
sΩp
这样，只要根据技术指标求出阶数N按照式求出N个极点，再按照式
得到归一化低通原型系统函数Gp如果给定Ω再去归一化，即将psΩ代入Gp
中或由式求出sΩp便得到期望设计的系统函数Hs。
将极点表示式代入式，得到Gp的分母是p的N阶多项式，用下
式表示： 第章无限脉冲响应数字滤波器的设计 CDpbpb…bpb
归一化原型系统函数Gp的系数bk…N以及极点p可以由表
得到。另外，表中还给出了Gp的因式分解形式中的各系数，这样只要求出阶数N查表
可得到Gp及各极点，而且可以选择级联型和直接型结构的系统函数表示形式，避免了
因式分解运算工作。
Created by ZhuangHeng
数字信号处理第五版
表 巴特沃斯归一化低通滤波器参数
极点位置
阶数N
Psn Pn PiNr PoN P
±j
±j
±j ±j
±j ±j
±j ±j ±j
±j ±j±j
±j ±j ±j ±j
±j ±j ±j ±j
分母多项式
阶数N
BppbnipNbnzpN…bpb。
b b b b bb h b
分母因式
阶数N
BpBpBp…BMap 表示取大于等于 的最小整数
p
pp
ppp
pppp
ppDppDp
ppDpppp
ppDppppp
ppDpppppp
ppDppppppp
Created by ZhuangHeng
由式和式可知，只要求出巴特沃斯滤波器的阶数N和 dB截止频率
Ω就可以求出滤波器的系统函数Hs。所以，巴特沃斯滤波器的设计实质上就是根据设
计指标求阶数N和 dB截止频率。的过程。下面先介绍阶数N的确定方法。
阶数N的大小主要影响通带幅频特性的平坦程度和过渡带、阻带的幅度下降速度，它
由技术指标Ω、ap、Ω和a确定。将ΩΩ。代入幅度平方函数式中，再将幅度平
方函数Hj代入式，得到：
将ΩΩ代入式中，再将Hj代入式中，得到：
由和式得到：
√
令
k√
a
b
则N由下式表示：
N c
用上式求出的N可能有小数部分，应取大于或等于N的最小整数。关于dB截止频率
Ω如果技术指标中没有给出，可以按照式或式求出。由式
得到：
Ω°k
由式得到：
nΩ°
请注意，如果采用式确定Ω则通带指标刚好满足要求，阻带指标有富余；如果
采用式确定Ω则阻带指标刚好满足要求，通带指标有富余。
总结以上，低通巴特沃斯滤波器的设计步骤如下：
根据技术指标、a、Ω和a用式求出滤波器的阶数N。
按照式，求出归一化极点p将p代入式，得到归一化低通原
型系统函数Gp。也可以根据阶数N直接查表得到p和Gp。
将Gp去归一化。将psΩ。代人Gp得到实际的滤波器系统函数
HsGp
方白中本后七口名
Created by ZhuangHeng
口
数字信号处理第五版
这里Ω为 dB截止频率，如果技术指标没有给出Ω可以按照式或式
求出。
【例】已知通带截止频率fkHz通带最大衰减a dB阻带截止频率
f kHz阻带最小衰减a dB按照以上技术指标设计巴特沃斯低通滤波器。
解确定阶数N。
k√o
入。
NI取N
按照式，其极点为
p。eppepe
psepe
按照式，归一化低通原型系统函数为
Do
上式分母可以展开成五阶多项式，或者将共轭极点放在一起，形成因式分解式。这里不如
直接查表简单，由N直接查表得到：
极点：
±j±j
归一化低通原型系统函数为
Gppbpbpbpbpbo
式中，bobbbb。
分母因式分解形式为
GpppppDp
以上公式中的数据均取小数点后四位。
为将Gp去归一化，先求 dB截止频率Ω。按照式，得到：
nQ。°π× krads
将Ω代入式，得到：
aΩπ× krads
此时算出的Ω比题目中给的Ω小，因此，过渡带小于指标要求。或者说，在Ωπ×
krads时衰减大于 dB所以说阻带指标有富余量。
将psΩ。代入Gp中，得到：
Created by ZhuangHeng
Hbaasba
用MATLAB工具箱函数设计巴特沃斯滤波器
MATLAB信号处理工具箱函数buttapbuttord和 butter是巴特沃斯滤波器设计函
数。其种调用格式如下。
·ZPKbuttapN
该格式用于计算N阶巴特沃斯归一化 dB截止频率Ω模拟低通原型滤波器系统
函数的零、极点和增益因子。返回长度为N的列向量Z和P分别给出N个零点和极点的
位置，K表示滤波器增益。得到的系统函数为如下形式：
GpkpPpP…pPN
式中，Zk和Pk分别为向量Z和P的第k个元素。如果要从计算得到的零、极点得到系统
函数的分子和分母多项式系数向量B和A可以调用结构转换函数BAzptfZPK。
· NwcbuttordwpwsRpAs
该格式用于计算巴特沃斯数字滤波器的阶数N和 dB截止频率wc。调用参数wp和ws
分别为数字滤波器的通带边界频率和阻带边界频率的归一化值，要求≤wp≤≤ws≤
表示数字频率π对应模拟频率FF表示采样频率。Rp和As分别为通带最大衰减
和阻带最小衰减dB。当ws≤wp时，为高通滤波器；当wp和ws为二元矢量时，为带通
或带阻滤波器，这时wc 也是二元向量。N和we作为butter 函数的调用参数。
·Nwe buttordwpwsRpAss
该格式用于计算巴特沃斯模拟滤波器的阶数N和 dB截止频率we。wp、ws和we是
实际模拟角频率rads。其他参数与格式相同。
·BAbutterNwcftype
计算N阶巴特沃斯数字滤波器系统函数分子和分母多项式的系数向量B和A。调用参
数N和we分别为巴特沃斯数字滤波器的阶数和 dB截止频率的归一化值关于π归一
化一般按格式调用函数buttord计算N和wc。由系数向量B和A可以写出数字滤波
器系统函数：
HzA②BCDB…BNAN
式中，Bk和Ak分别为向量B和A的第k个元素。
·BAbutterNwcftypes 第章无限脉冲响应数字滤波器的设计
计算巴特沃斯模拟滤波器系统函数的分子和分母多项式的系数向量B和A。调用参数
N和 we分别为巴特沃斯模拟滤波器的阶数和dB截止频率实际角频率。由系数向量B
和A写出模拟滤波器的系统函数为
HsASBsBs…BNsBAN
由于高通滤波器和低通滤波器都只有一个dB截止频率wc因此仅由调用参数wc不
Created by ZhuangHeng
口口
口
数字信号处理第五版
能区别要设计的是高通还是低通滤波器。当然仅由二维向量wc也不能区分带通和带阻。所
以用参数ftype来区分。ftypehigh 时，设计 dB截止频率为we的高通滤波器。缺省
ftype时默认设计低通滤波器。ftypestop时，设计dB截止频率为we的带阻滤波器，此
时 we为二元向量welwcuwel和wcu分别为带阻滤波器的通带 dB下截止频率和上
截止频率。缺省 ftype时设计带通滤波器，通带为频率区间wclwwcu。应当注意，设计
的带通和带阻滤波器系统函数是N 阶的。这是因为带通滤波器相当于N阶低通滤波器与
N阶高通滤波器级联。
、和式也适用于后面要介绍的切比雪夫和椭圆滤波器的
MATLAB设计函数。
【例】 调用buttord和butter设计巴特沃斯低通模拟滤波器。要求与例
相同。
设计程序epm如下：
wppiwspiRpAs置滤波器参数
N webuttordwp wsRpAss 算滤波器阶数N和dB截止频率we
BAbutterN wes 算滤波器系统函数分子分母多项式系数
kfkwkpifk
HkfreqsBAwk
subplot
plotfklogabsHkgrid on
xlabelC频率kHzylabel幅度dB
axis
运行结果：
NwceBe
A e e e e e
将B和A代人式写出系统函数为
HsAsACsAsAsA
与例计算结果形式相同。滤波器的损耗函数曲线如图所示。
adA
fkHz
图 程序epm运行输出的损耗函数例的设计结果
Created by ZhuangHeng
由图可以看出，在f kHz时，衰减 dB即阻带刚好满足指标要求，通带指标有
富余。这就说明buttord函数使用式计算 dB截止频率。
切比雪夫滤波器的设计
切比雪夫滤波器的设计原理
巴特沃斯滤波器的频率特性曲线，无论在通带还是阻带都是频率的单调减函数。因此，
当通带边界处满足指标要求时，通带内肯定会有较大富余量。因此，更有效的设计方法应
该是将逼近精确度均匀地分布在整个通带内，或者均匀分布在整个阻带内，或者同时均匀
分布在两者之内。这样，就可以使滤波器阶数大大降低。这可通过选择具有等波纹特性的
逼近函数来达到。
切比雪夫滤波器的幅频特性就具有这种等波纹特性。它有两种形式：幅频特性在通带
内是等波纹的、在阻带内是单调下降的切比雪夫I型滤波器；幅频特性在通带内是单调下
降、在阻带内是等波纹的切比雪夫Ⅱ型滤波器。采用何种形式的切比雪夫滤波器取决于实
际用途。图a和b分别画出不同阶数的切比雪夫I型和Ⅱ型滤波器幅频特性。
N N
N
糖度 糖度 N
N
N
归一化角频率
。
归一化角预率
a切比雪夫I型滤波器的幅频特性 b切比雪夫Ⅱ型滤波器的幅频特性
图 不同阶数的切比雪夫I型和Ⅱ型滤波器幅频特性
我们这里仅介绍切比雪夫I型滤波器的设计方法。其幅度平方函数用HG表示：
BGoPecA
式中，e为小于的正数，表示通带内幅度波动的程度，e愈大，波动幅度也愈大；Ω。称为
通带截止频率。令λΩQ称为对Ω的归一化频率。Cx称为N阶切比雪夫多项式，
定义为
CzchNarchaIz≥
当N时，C。x当N时，Cxx当N时，Cxx当
N时，Cxxx。由此可归纳出高阶切比雪夫多项式的递推公式为
第章无限脉冲响应数字滤波器的设计
Created by ZhuangHeng
口
口口
口
口口
口口口口口口
口
数字信号处理第五版
令λΩΩ由λ有
CNxxCNxCnx
切比雪夫多项式的特性：
切比雪夫多项式的过零点在x≤的范围内；
当x时，Cx≤在x范围内具有等波纹性；
当x时，CNx是双曲线函数，随x单调上升。
这样，当x≤时，eC、x在至e之间波动，函数eCx的倒数即是幅度平
方函数Hj。所以Hj在a上有等波纹波动，最大值为最小值为
e。当QΩ时，HGjI随Ω加大很快接近于零。图分别画出了四阶切
比雪夫I型和巴特沃斯低通滤波器的幅频特性，显然，切比雪夫滤波器比巴特沃斯滤波器
有较窄的过渡带。
幅度
l
频率kHz
图 四阶切比雪夫I型和巴特沃斯低通滤波器的幅频特性比较
按照式，幅度平方函数与三个参数e、Ω、N有关。其中e与通带内允许的
波动幅度有关，定义允许的通带内最大衰减a用下式表示：
mnBGi IΩ≤Ω
式中
maxHGjPminHGjIe
因此
a lge
E°
这样，根据通带内最大衰减ap可以求出参数E。阶数N影响过渡带的宽度，同时也影响通
带内波动的疏密，因为N等于通带内最大值与最小值的总个数。设阻带的起始点频率阻
带截止频率用Ω表示，在Ω处的HGΩ用式确定：
Gc
Created by ZhuangHeng
CachNarchà√IHGia
可以解出
LiJnsa
aach—arch√BG
dB截止频率用Ω。表示，
IHGiaI
按照式，有
eCaλ
通常取λ因此
CxCA±chNarch
上式中仅取正号，得到 dB截止频率计算公式：
ancharch
Ω通常是设计指标给定的，由和式求出e和N后，可以求出滤波器的极
点，并确定归一化系统函数GppsΩ。下面略去繁杂的求解过程，仅介绍一些有用
的结论。
设Hs的极点为sojΩ可以证明：
…N
式中
arsh
hh
式是一个椭圆方程，长半轴为Ωche在虚轴上短半轴为Ωshe在实轴上。令
b。和aΩ分别表示长半轴和短半轴，可推导出：
ag
b—β
式中
第章无限脉冲响应数字滤波器的设计
Created by ZhuangHeng
口口
口
数字信号处理第五版
R√
因此切比雪夫滤波器的极点就是一组分布在b。为长半轴、aΩ为短半轴的椭圆上的点。
为因果稳定，用左半平面的极点构成Gp即
co
式中，c是待定系数。根据幅度平方函数式可导出：ce·N代入式，
得到归一化的系统函数为
c
去归一化后的系统函数为
BDCcefa
按照以上分析，归纳出切比雪夫I型滤波器设计步骤：
确定技术指标参数a、Ωp、a。和Ω。ap是ΩΩ。时的衰减，a是ΩΩ时的衰
减，它们满足
o gHGD
agHG
这里ap就是前面定义的通带最大衰减，见式。
求滤波器阶数N和参数e。归一化边界频率为λpλQ。由式
得到：
HGeCAC
HGineCAC
将以上两式代入和式，得到：
°eCNCecosN arccose
°eCNaechN archλ
chNarch
令
k√o
则chNarchàki因此
Created by ZhuangHeng
Narch
这样，先由式求出k代入式，求出阶数N最后取大于或等于N的最
小整数。
按照式求e
e°
求归一化系统函数Gp。为求Gp先按照式求出归一化极点p
k…N。
pchesinkNj chscoskN
将极点p代人式，得到：
ccA
将Gp去归一化，得到实际的Hs即
HsGpv
【例】 设计低通切比雪夫滤波器，要求通带截止频率fkHz通带最大衰减
a dB阻带截止频率f kHz阻带最小衰减a dB。
解滤波器的技术要求：
ap dBπfπ krads
a dBπfπ krads
Aa余。
由和式求阶数N和e
Narch
k√o
Narcrc取N
e√°√°
将极点p、N和e代入式求Gp
的中水长中
c
由式求出N时的极点p代入上式，得到：
cPPpPp
Created by ZhuangHeng
数字信号处理第五版
将Gp去归一化，得到：
HSGDl××°×
××°
用MATLAB设计切比雪夫滤波器
MATLAB信号处理工具箱函数cheblap、cheblord和chebyl是切比雪夫I型滤波器
设计函数。其调用格式如下：
·zpkcheblapNRp
·NwpocheblordwpwsRpAs
·Nwpo cheblordwpwsRpAss
·BAchebylNRpwpoftype
·BAchebylNRpwpoftypes
切比雪夫I型滤波器设计函数与前面的巴特沃斯滤波器设计函数比较，只有两点不
同。一是这里设计的是切比雪夫I型滤波器；二是格式和的返回参数与格式和
的调用参数wpo是切比雪夫I型滤波器的通带截止频率，而不是dB截止频率。其他参数
含义与巴特沃斯滤波器设计函数中的参数相同。系数向量B和A与数字和模拟滤波器系统
函数的关系由和式给出。
MATLAB信号处理工具箱函数chebap、chebord和cheby是切比雪夫Ⅱ型滤波器
设计函数。其调用格式如下：
·zpG chebapNRs
该格式用于计算N阶切比雪夫Ⅱ型归一化阻带截止频率Ω模拟低通滤波器系统
函数的零、极点和增益因子。返回长度为N的列向量z和p分别给出N个零点和极点的
位置。G表示滤波器增益。Rs是阻带最小衰减dB。
·NwsochebordwpwsRpAs
该格式用于计算切比雪夫Ⅱ型数字滤波器的阶数N和阻带截止频率wso。调用参数
wp和ws分别为数字滤波器的通带边界频率和阻带边界频率的归一化值，要求≤wp≤
≤ws≤表示数字频率π对应模拟频率F。Rp和As分别为通带最大衰减和阻带
最小衰减dB。当ws≤wp时，为高通滤波器；当wp和ws为二元矢量时，为带通或带阻
滤波器，这时wso 也是二元向量。N和wso作为cheby的调用参数。
·NwsochebordwpwsRpAss
该格式用于计算切比雪夫Ⅱ型模拟滤波器的阶数N和阻带截止频率wso。wp、ws和
wso是实际模拟角频率rads。其他参数与格式相同。
·BAchebyNAswsoftype
该格式用于计算N阶切比雪夫Ⅱ型数字滤波器系统函数的分子和分母多项式系数向量
B和A。调用参数N和wso分别为切比雪夫Ⅱ型数字滤波器的阶数和阻带截止频率的归一
Created by ZhuangHeng
化值关于π归一化一般调用函数chebord计算N和wso。
·BAchebyNAswsoftypes
该格式用于计算N阶切比雪夫Ⅱ型模拟滤波器系统函数的分子和分母多项式系数向量
B和A。调用参数N和wso分别为N阶切比雪夫Ⅱ型模拟滤波器的阶数和阻带截止频率
实际角频率。
ftype的定义与巴特沃斯滤波器设计函数中的ftype相同。
【例】设计切比雪夫I型和切比雪夫Ⅱ型模拟低通滤波器。要求与例相同。
解 设计程序epm如下：
设计程序：epm
计切比雪夫I型模拟低通滤波器
wppiwspiRpAs置指标参数
NwplcheblordwpwsRpAss算切比雪夫I型模拟低通滤波器阶数和通带
界频率
BIAlchebylNRpwpls算切比雪夫I型模拟低通滤波器系统函数系数
subplot
fkwkpi fk
HkfreqsBAlwk
plotfklogabsHkgrid on
xlabel频率kHzylabelC幅度dB
axis
计切比雪夫Ⅱ型模拟低通滤波器省略
运行结果：
N
切比雪夫I型模拟低通滤波器通带边界频率：wple
切比雪夫I型模拟低通滤波器系统函数分子分母多项式系数：
Be
Ae e e e e
切比雪夫I型和Ⅱ型滤波器损耗函数分别如图a和b所示。
F
幅度dB
幅度dB
第章无限脉冲响应数字滤波器的设计
频率kHz 频率kHz
a切比雪夫I型滤波器损耗函数 b切比雪夫Ⅱ型滤波器损耗函数
图 五阶切比雪夫I型和Ⅱ型模拟低通滤波器损耗函数例的设计结果
Created by ZhuangHeng
数字信号处理第五版
椭圆滤波器的设计
椭圆Elliptic滤波器在通带和阻带内都具有等波纹幅频响应特性。由于其极点位置与
经典场论中的椭圆函数有关，所以由此取名为椭圆滤波器。又因为在年考尔Cauer
首先对这种滤波器进行了理论证明，所以其另一个通用名字为考尔Cauer滤波器。椭圆滤
波器的典型幅频响应特性曲线如图所示。由图a可见，椭圆滤波器通带和
阻带波纹幅度固定时，阶数越高，过渡带越窄；由图b可见，当椭圆滤波器阶数固
定时，通带和阻带波纹幅度越小，过渡带就越宽。所以椭圆滤波器的阶数N由通带边界频
率Ω、阻带边界频率Ω、通带最大衰减a。和阻带最小衰减a共同决定。后面对五种滤波
器的比较将证实，阶数相同时，椭圆滤波器可以获得对理想滤波器幅频响应的最好逼近，
是一种性能价格比最高的滤波器，所以应用非常广泛。
N
N dBladB adBadB
a dBadB
幅度 N 幅度 adBadB
N
归一化角频率
归一化角频率
aαdBαdBN bNadBαdB
图 椭圆滤波器幅频响应特性曲线
椭圆滤波器逼近理论是复杂的纯数学问题，该问题的详细推导已超出本书的范围。只
要给定滤波器指标，通过调用MATLAB信号处理工具箱提供的椭圆滤波器设计函数，就
很容易得到椭圆滤波器系统函数和零极点位置。
MATLAB信号处理工具箱提供椭圆滤波器设计函数ellipap、ellipord和ellip。其调用
格式如下：
·zpkellipapNRpAs
用于计算N阶归一化通带边界频率wp模拟低通椭圆滤波器的零点向量 z、极点
向量p和增益因子k。Rp和As分别为通带最大衰减和阻带最小衰减dB。返回长度为N
的列向量z和p分别给出N个零点和N个极点的位置。
·Nwpo ellipordwpwsRpAs
用于计算满足指标的椭圆数字滤波器的最低阶数N和通带边界频率wpo指标要求由
参数wpwsRpAs给定。参数wpwsRpAs的定义与巴特沃斯滤波器设计函数
buttord中的相应参数相同。
·NwpoellipordwpwsRpAss
Created by ZhuangHeng
用于计算满足指标的椭圆模拟滤波器的最低阶数N和通带边界频率wpo。
·BAellipNRpwpoftype
当wpo是表示滤波器通带边界频率的标量，而且缺省参数ftype时，该格式返回N阶
低通椭圆数字滤波器系统函数的分子和分母多项式系数向量B和A滤波器通带波纹为
Rp dB当 ftypehigh时，返回N阶高通椭圆数字滤波器系统函数系数向量B和A。当
wpo是表示带通滤波器通带边界频率的二元向量，而且缺省参数ftype时，该格式返回N
阶带通椭圆数字滤波器系统函数的分子和分母多项式系数向量B和A滤波器通带波纹为
Rp dB。当ftypestop时，返回N 阶带阻椭圆数字滤波器系统函数系数向量B和A。二元
向量参数wpo表示阻带上下边界频率关于π归一化。
·BAellipNRpwpoftypes
计算椭圆模拟滤波器系统函数系数向量B和A。当然，其中的边界频率均为实际模拟
角频率值rads。
【例】 设计椭圆模拟低通滤波器。要求与例相同。设计程序epm
如下：
圆滤波器设计程序：epm
wppiwspiRpAs置指标参数
N wpoellipordwpwsRpAss算椭圆低通模拟滤波器阶数和通带边界频率
BAellipNRpAswpos 算低通模拟滤波器系统函数系数
去以下绘图部分
运行结果：
椭圆模拟低通滤波器阶数：N
模拟低通滤波器通带边界频率：wpoe
椭圆模拟低通滤波器系统函数分子分母多项式系数：
B e e e e
A e e e e
滤波器损耗函数如图所示。虽然本例中椭圆滤波器阶数是但从图可
以看出，四阶椭圆模拟低通滤波器的过渡带宽度小于kHz比指标要求 kHz窄
kHz。而例中需要五阶切比雪夫模拟低通滤波器，且其过渡带宽度大于kHz。对
于本例的设计指标，如果用巴特沃斯模拟低通滤波器，计算所要求的阶数N。
幅度dB
频率kHz
图 四阶椭圆模拟低通滤波器损耗
第章无限脉冲响应数字滤波器的设计
Created by ZhuangHeng
□ oodd……………
口口口 □□
口
□口
数字信号处理第五版
五种类型模拟滤波器的比较
前面讨论了四种类型的模拟低通滤波器巴特沃斯、切比雪夫I型、切比雪夫Ⅱ型和椭
圆滤波器的设计方法，这四种滤波器是主要考虑逼近幅度响应指标的滤波器，第五种贝
塞尔滤波器是主要考虑逼近线性相位特性的滤波器。为了正确地选择滤波器类型以满足
给定的幅频响应指标，必须比较四种幅度逼近滤波器的特性。为此，下面比较相同阶数的
归一化巴特沃斯、切比雪夫I型、切比雪夫Ⅱ型和椭圆滤波器的频率响应特性。
调用MATLAB滤波器设计函数，很容易验证：当阶数相同时，对相同的通带最大衰
减a。和阻带最小衰减a巴特沃斯滤波器具有单调下降的幅频特性，过渡带最宽。两种类
型的切比雪夫滤波器的过渡带宽度相等，比巴特沃斯滤波器的过渡带窄，但比椭圆滤波器
的过渡带宽。切比雪夫I型滤波器在通带具有等波纹幅频特性，过渡带和阻带是单调下降
的幅频特性。切比雪夫Ⅱ型滤波器的通带幅频响应几乎与巴特沃斯滤波器相同，阻带是等
波纹幅频特性。椭圆滤波器的过渡带最窄，通带和阻带均是等波纹幅频特性。
相位逼近情况：巴特沃斯和切比雪夫滤波器在大约的通带上非常接近线性相位特
性，而椭圆滤波器仅在大约半个通带上非常接近线性相位特性。贝塞尔滤波器在整个通带
逼近线性相位特性，而其幅频特性的过渡带比其他四种滤波器宽得多。
复杂性：对前四种滤波器，在满足相同的滤波器幅频响应指标条件下，巴特沃斯滤波
器阶数最高，椭圆滤波器的阶数最低，而且阶数差别较大。所以，就满足滤波器幅频响应指
标而言，椭圆滤波器的性能价格比最高，应用较广泛。
由上述比较可见，五种滤波器各具特点。工程实际中选择哪种滤波器取决于对滤波器
阶数阶数影响处理速度和实现的复杂性和相位特性的具体要求。例如，在满足幅频响应
指标的条件下希望滤波器阶数最低时，就应当选择椭圆滤波器。
频率变换与模拟高通、带通、带阻滤波器的设计
高通、带通、带阻滤波器的幅频响应曲线及边界频率分别如图a、b和c
所示。
IIHGI IH HsGI
l
δ
Q A
QQQQ
Ω RΩQa
a高通滤波器 b带通滤波器 c带阻滤波器
图 各种滤波器幅频特性曲线及边界频率示意图
HGj为偶函数，只画出正频率部分
低通、高通、带通和带阻滤波器的通带最大衰减和阻带最小衰减仍用a。和a表示。图
中，Ω表示高通滤波器的通带边界频率；Ω和Ω分别表示带通和带阻滤波器的通
Created by ZhuangHeng
带下边界频率和通带上边界频率；Ω和Ω分别表示带通和带阻滤波器的阻带下边界频率
和阻带上边界频率。
从原理上讲，通过频率变换公式，可以将模拟低通滤波器系统函数Qp变换成希望设
计的低通、高通、带通和带阻滤波器系统函数Hs。在模拟滤波器设计手册中，各种经典
滤波器的设计公式都是针对低通滤波器的，并提供从低通到其他各种滤波器的频率变换公
式。所以，设计高通、带通和带阻滤波器的一般过程是：
通过频率变换公式，先将希望设计的滤波器指标转换为相应的低通滤波器指标；
设计相应的低通滤波器系统函数Qp
对Qp进行频率变换，得到希望设计的滤波器系统函数Hs。
设计过程中涉及的频率变换公式和指标转换公式较复杂，其推导更为复杂。幸好一些
学者已经开发出根据设计指标直接设计高通、带通和带阻滤波器的CAD程序函数，只要根
据设计指标直接调用CAD程序，就可以得到高通、带通和带阻滤波器系统函数。前面所提
到的MATLAB信号处理工具箱函数butterchebycheby和ellip都具有这样的功能。
本节先简要介绍模拟滤波器的频率变换公式，再举例说明调用MATLAB信号处理工
具箱函数直接设计高通、带通和带阻滤波器的方法。对那些繁杂的设计公式推导不做叙述，
有兴趣的读者请参阅相关书籍。
后面的设计举例将说明，如果低通滤波器Qp是关于某边界频率的“归一化低通滤波
器”则设计计算将大大简化。这里，“归一化低通滤波器”是指关于某个边界频率归一化的
低通滤波器，其系统函数就用Qp表示。归一化频率根据设计需要而定，对巴特沃斯滤波
器，关于dB截止频率归一化的系统函数称为巴特沃斯归一化低通原型记为Gp而
切比雪夫和椭圆滤波器的归一化低通原型一般是关于通带边界频率归一化的低通系统
函数即Qp的通带边界频率为。
为了叙述方便，定义pηjà为Qp的归一化复变量，其通带边界频率记为λλ称
为归一化频率。用Hs表示希望设计的模拟滤波器的系统函数，saj表示Hs的
复变量。例如，一阶巴特沃斯低通原型系统函数为
Gpp
显然，其dB截止频率λ。是关于dB截止频率归一化的。模拟滤波器设计手册中给
出了各种模拟滤波器归一化低通系统函数的参数零、极点位置，分子、分母多项式系
数等。
下面简单介绍各种频率变换公式。从p域到s域映射的可逆变换记为pFs。低通
系统函数Qp与Hs之间的转换关系为
HsQppFo
QpHspcp
模拟高通滤波器设计
从低通到高通滤波器的映射关系为
Created by ZhuangHeng
第章无限脉冲响应数字滤波器的设计
■口口
口口口□□口
口
数字信号处理第五版
pAC
在虚轴频率轴上该映射关系简化为如下频率变换公式：
λ
式中，Ω为希望设计的高通滤波器Hps的通带边界频率。频率变换公式意味
着将低通滤波器的通带λ。映射为高通滤波器的通带∞Ω而将低通滤波器的
通带λ映射为高通滤波器的通带Qm○。同样，将低通滤波器的阻带λ。○映
射为高通滤波器的阻带Ω而将低通滤波器的阻带λ映射为高通滤波器
的阻带a。映射关系式确保低通滤波器Qp通带λpλp上的幅度值出
现在高通滤波器Hs的通带Ω≤上。同样，低通滤波器Qp阻带λ≤la上的幅度
值出现在高通滤波器HHs的阻带ΩΩ上。
所以只要将式代入式，就可将通带边界频率为λ。的低通滤波器的系
统函数Qp转换成通带边界频率为Ω的高通滤波器系统函数：
HHpsGpa
【例】 设计巴特沃斯模拟高通滤波器，要求通带边界频率为kHz阻带边界频
率为 kHz通带最大衰减为 dB阻带最小衰减为 dB。
解通过映射关系式将希望设计的高通滤波器的指标转换成相应的低
通滤波器Qp的指标。为了计算简单，一般选择Qp为归一化低通，即取Qp的通带边
界频率λ。。则由式可求得归一化阻带边界频率为
AAπ×
转换得到低通滤波器的指标为：通带边界频率λp阻带边界频率A通带最大衰减
ap dB阻带最小衰减a dB。
设计相应的归一化低通系统函数Qp。本例调用MATLAB函数buttord和
butter来设计Qp。也可以仿照例的设计，留作读者练习。
用式和式将Qp转换成希望设计的高通滤波器的系统函数
Hps。本例调用MATLAB函数lphp实现低通到高通的变换。Iphp函数的功能可用
help命令查阅。BHAHlphpBAwph将系统函数分子和分母系数向量为B和A
的低通滤波器变换成通带边界频率为 whp的高通滤波器，返回结果BH和AH是高通滤波
器系统函数分子和分母的系数向量。实现步骤和的程序epm如下：
设计巴特沃斯模拟高通滤波器程序：epm
wpwsRpAs 置低通滤波器指标参数
N webuttordwpwsRpAss算低通滤波器Qp的阶数N和dB截止频率we
BAbutterN wes 算低通滤波器系统函数Qp的分子分母多项式系数
拟高通滤波器通带边界频率wph wphpi
BHAHlphpBAwph 通到高通转换
Created by ZhuangHeng
由系数向量B和A写出归一化低通系统函数为
Qpppppp
由系数向量BH和AH写出希望设计的高通滤波器系统函数为
Hms××××××
Qp和HHps的损耗函数曲线如图所示。
F
幅度dB 幅度dB
l
归一化频率 频率Hz
a归一化低通滤波器Qp b高通滤波器Hos
图 例所得低通、高通滤波器损耗函数曲线
值得注意的是，实际上调用函数buttord和butter可以直接设计巴特沃斯高通滤波器。
设计程序epbm如下：
直接设计巴特沃斯模拟高通滤波器程序：epbm
wppiwspiRpAs 置高通滤波器指标参数
N webuttordwp wsRpAss算高通滤波器阶数N和 dB截止频率
BHAHbutterN wehighs算高通滤波器系统函数Hs分子分母多项式
数
程序运行结果：
N
BH
AH e e e e e
分母多项式系数向量AH与程序epm的运行结果相同。但是，分子多项式系数向
量BH与程序epm的运行结果有较大差别，这是由运算误差引起的。由于butter 函数
采用了归一化处理，所以计算误差小。本程序所得分子多项式系数向量BH与理论设计结
果相同。所以实际中应当用程序pbm设计高通滤波器。由BH和AH写出希望设计的
高通滤波器系统函数：
Hs×s×°s×s×s×
低通到带通的频率变换
低通到带通的频率变换公式如下：
第章无限脉冲响应数字滤波器的设计
Created by ZhuangHeng
口口
口口
口
口口
口
口口
数字信号处理第五版
px
在p平面与s平面虚轴上的频率关系为
λλBa
式中，BΩQ表示带通滤波器的通带宽度，Ω和Ω分别为带通滤波器的通带下截
止频率和通带上截止频率；Ω。称为带通滤波器的中心频率。根据式的映射关系，
频率λ映射为频率Ω±频率λλ映射为频率Ω和Ω频率λλ。映射为频
率Ω和Ω。也就是说，将低通滤波器Gp的通带Aλ映射为带通滤波器的通带
ΩΩ和Ω。同样道理，频率λλ映射为频率Ω和Ω频率λλ。映
射为频率Ω和Ω。所以将式带入式就将Qp转换为带通滤波器的
系统函数，即
HmSQp
可以证明
QQQ
所以，带通滤波器的通带阻带边界频率关于中心频率Ω。几何对称。如果原指标给定的边
界频率不满足式就要改变其中一个边界频率，以便满足式但要保证
改变后的指标高于原始指标。具体方法是，如果ΩmΩΩ则减小Ω或增大Ω使
式得到满足。具体计算公式为
或
减小Ω使通带宽度大于原指标要求的通带宽度，增大Ω或减小Ω都使左边的过渡带宽度
小于原指标要求的过渡带宽度；反之，如果ΩΩ则减小Ω或增大Ω使式
得到满足。而且在关于中心频率Ω。几何对称的两个正频率点上，带通滤波器的幅
度值相等。综上所述，低通到带通的边界频率及幅频响应特性的映射关系如图所
GGI
λ
IHI
QQQQ D
图 低通原型到带通的边界频率及幅频响应特性的映射关系
Created by ZhuangHeng
示，低通原型的每一个边界频率都映射为带通滤波器两个相应的边界频率。图中标出了设
计时有用的频率对应关系。请读者画出正频率部分的带通滤波器各边界频率与低通原型各
边界频率的对应关系。
【例】 设计巴特沃斯模拟带通滤波器，要求通带上、下边界频率分别为 kHz
和kHz阻带上、下边界频率分别为kHz和kHz通带最大衰减为 dB阻带最小衰
减为 dB。
解 所给带通滤波器指标为：
fukHzfmkHzap dB
fakHzfkHza dB
ffm××
faf。××
因为fufmfaf所以不满足式。按照式增大f则
fr×° kHz
采用修正后的f按如下步骤设计巴特沃斯模拟带通滤波器。
①通过映射关系式将希望设计的带通滤波器指标转换为相应的低通原型滤
波器Qp的指标。为了设计方便，一般选择Qp为归一化低通，即取Qp的通带边界频
率λ。因为λλ的映射为Ω所以将λ、λλ。和QQ代入式可求
得归一化阻带边界频率为
xPB×
转换得到的归一化低通滤波器指标为：通带边界频率λ阻带边界频率λ通
带最大衰减a dB阻带最小衰减a dB。
②设计相应的归一化低通系统函数Qp。设计过程与例完全相同，留作读者
练习。
③用式将Qp转换成所希望设计的带通滤波器系统函数Hs。
本例调用MATLAB函数buttord和butter 直接设计巴特沃斯模拟带通滤波器。设计
程序epm如下：
设计巴特沃斯模拟带通滤波器程序：epm
wppiwspiRpAs置带通滤波器指标参数
Nwebuttordwp wsRpAss 算带通滤波器阶数N和dB截止频率we
BBABbutterN wes 算带通滤波器系统函数分子分母多项式系数向
BB和AB
程序运行结果：
阶数：N
第章无限脉冲响应数字滤波器的设计
Created by ZhuangHeng
数字信号处理第五版
系统函数分子多项式系数向量：
BBe
系统函数分母多项式系数向量：
AB e e e e e
e e e e e
由运行结果可知，带通滤波器是N阶的。阶巴特沃斯带通滤波器损耗函数曲线如
图所示。
幅度dB
L
频率Hz
图 例巴特沃斯模拟带通滤波器损耗函数
低通到带阻的频率变换
低通到带阻的频率变换公式为
pa
在p平面与s平面虚轴上的频率变换关系为
λ
式中，BΩΩ表示带阻滤波器的阻带宽度，Ω和Ω分别为带阻滤波器的阻带下截
止频率和阻带上截止频率；Ω。称为带阻滤波器的阻带中心频率。由式知道，λ是
Ω的二次函数，从低通滤波器频率λ到带阻滤波器频率Ω为双值映射。
当λ从→λ→λ→时，①Ω从Ω→→Ω→○形成如图
c所示的带阻滤波器Hj在Ω上的频响；②Ω从Ω→Ω→
Ω→形成Hsj在上的频响。
当λ从→λ→λ→时，①Ω从→Ω→Ω→形成Hsj在
Ω上的频响；②Ω从→Ω→→Ω形成Hsj在Ω∞上
的频响。
所以将式带入式，就将阻带边界频率为λ。的低通原型滤波器Qp
转换为所希望的带阻滤波器的系统函数：
HesGp
Created by ZhuangHeng
与低通到带通变换情况相同，有
ΩamΩΩ
由于带阻滤波器的设计与带通滤波器的设计过程相同，因此下面仅举例说明调用
MATLAB函数直接设计模拟带阻滤波器的设计程序。
【例】 分别设计巴特沃斯、椭圆模拟带阻滤波器，要求阻带上、下边界频率分别
为kHz和kHz通带上、下边界频率分别为kHz和kHz通带最大衰减为 dB阻
带最小衰减为 dB。
解 所给带阻滤波器指标为
f kHzfmkHza dBfnkHzfkHzapdB
调用MATLAB函数buttordbutterellipord和ellip直接设计巴特沃斯带阻、椭圆带阻模
拟滤波器的设计程序epm如下：
设计模拟带阻滤波器程序：epm
wppiwspiRpAs置带阻滤波器指标参数
计巴特沃斯模拟带阻滤波器
NbwebuttordwpwsRpAss算带阻滤波器阶数N和 dB截止频率
BSbASbbutterNbwestops算带阻stop滤波器系统函数分子分母多项式系数
计椭圆模拟带阻滤波器
Ne wepellipordwpwsRpAss算带阻滤波器阶数N和dB截止频率
BSeASeellipNeRpAswepstops算带阻滤波器系统函数分子分母多项式系数
程序运行结果：
巴特沃斯模拟带阻滤波器阶数：Nb
巴特沃斯模拟带阻滤波器系统函数分子多项式系数向量：
BSbe
巴特沃斯模拟带阻滤波器系统函数分母多项式系数向量：
ASb e e e e e
e e e e e
椭圆模拟带阻滤波器阶数：Ne
椭圆模拟带阻滤波器系统函数分子多项式系数向量：
BSe e e e e
e 第章无限脉冲响应数字滤波器的设计
椭圆模拟带阻滤波器系统函数分母多项式系数向量：
ASe e e e e e
e
由运行结果可知，带阻滤波器也是N阶的。阶巴特沃斯带阻滤波器和阶椭圆带阻滤
波器损耗函数分别如图a和b所示。
Created by ZhuangHeng
口 口
口
口口
■着
口口
口
数字信号处理第五版
幅度dB 幅度dB
频率Hz 频率Hz
a巴特沃思带阻滤波器 b椭圆带阻滤波器
图 例的巴特沃斯、椭圆模拟带阻滤波器损耗函数
用脉冲响应不变法设计IIR数字低通滤波器
利用模拟滤波器成熟的理论及其设计方法来设计IIR 数字低通滤波器是常用的方法。
设计过程是：按照数字滤波器技术指标要求设计一个过渡模拟低通滤波器Hs再按照
一定的转换关系将Hs转换成数字低通滤波器的系统函数Hz。由此可见，设计的关键
问题就是找到这种转换关系，将s平面上的Hs转换成z平面上的Hz。为了保证转换
后的Hz稳定且满足技术指标要求，对转换关系提出两点要求：
因果稳定的模拟滤波器转换成数字滤波器，仍是因果稳定的。我们知道，模拟滤波
器因果稳定的条件是其系统函数Hs的极点全部位于s平面的左半平面；数字滤波器因
果稳定的条件是Hz的极点全部在单位圆内。因此，转换关系应使s平面的左半平面映射
到z平面的单位圆内部。
数字滤波器的频率响应模仿模拟滤波器的频响特性，s平面的虚轴映射为z平面的
单位圆，相应的频率之间呈线性关系。
将系统函数Hs从s平面转换到z平面的常用方法有脉冲响应不变法和双线性变换
法。本节先研究脉冲响应不变法。
设模拟滤波器的系统函数为Hs相应的单位冲激响应是htHs
LTh。。
LT·代表拉氏变换，对h进行等间隔采样，采样间隔为T得到hnT将
hnhnT作为数字滤波器的单位脉冲响应，那么数字滤波器的系统函数Hz便是
hn的Z变换。因此脉冲响应不变法是一种时域逼近方法，它使hn在采样点上等于
h。但是，模拟滤波器的设计结果是Hs所以下面基于脉冲响应不变法的思想，导出
直接从Hs到Hz的转换公式。
设模拟滤波器Hs只有单阶极点，且分母多项式的阶次高于分子多项式的阶次，将
Hs用部分分式表示：
Created by ZhuangHeng
HA
式中s为Hs的单阶极点。将Hs进行逆拉氏变换，得到：
h∑Aeu
式中，ut是单位阶跃函数。对ht进行等间隔采样，采样间隔为T得到：
hnhnTZAcaGT
对上式进行Z变换，得到数字滤波器的系统函数Hz即
HA
对比和式，Hs的极点s映射到≈平面的极点为e系数A不变。
下面我们分析从模拟滤波器转换到数字滤波器，s平面和z平面之间的映射关系，从而找到
这种转换方法的优缺点。这里以理想采样信号h作为桥梁，推导其映射关系。
设ht的理想采样信号用ht表示，即
bt∑htnT
对ht进行拉氏变换，得到：
AshedZhnTe“d
ZhnTe
式中，hnT是ht在采样点tnT时的幅度值，它与序列hn的幅度值相等，即
hnhnT因此得到：
Hs∑hnehnHz
上式表明理想采样信号h的拉氏变换与相应的采样序列hn的Z变换之间的映射关系
可用下式表示： ze”
式就是脉冲响应不变法对应的s平面到z平面的映射关系。设sajzre
按照式，得到reeTe。由此得到：
ar
第章无限脉冲响应数字滤波器的设计
Created by ZhuangHeng
由式可见：
口
口
口
口
口口
u口
数字信号处理第五版
上面关系式说明，s平面的虚轴o映射为z平面的单位圆rs平面左半平面
o映射为z平面单位圆内rs平面右半平面映射为z平面单位圆外r。这说
明如果Hs因果稳定，转换后得到的Hz仍是因果稳定的。
另外，注意到ze是一个周期函数，可写成
eeeTeeapM为任意整数
当σ不变，模拟频率Ω变化πT的整数倍时，映射值不变。或者说，将s平面沿着j轴分
割成一条条宽为πT的水平带，每条水平面都按照前面分析的映射关系对应着整个z平
面。此时Hs所在的s平面与Hz所在的z平面的映射关系如图所示。当模拟频
率Ω从πT变化到πT时，数字频率w则从一π变化到π且按照式，wAT
即w与Ω之间呈线性关系。
jo jlm
πT
πT
Rez
πT
πT 平面
s平面
图 脉冲响应不变法s平面和z平面之间的映射关系
下面讨论数字滤波器的频响特性与模拟滤波器的频响特性之间的关系。因为hn
hnT由和式得到：
He÷∑Hiaj经
He÷∑Hjn
上式说明，He是HGj以πT为周期的周期延拓函数对数字频率w则是以π为
周期。如果原h。t的频带不是限于士πT之间，则会在奇数πT附近产生频谱混叠，对
应数字频率在w±π附近产生频谱混叠。脉冲响应不变法的频谱混叠现象如图所
示。这种频谱混叠现象会使设计出的数字滤波器在w土π附近的频率响应特性程度不同
的偏离模拟滤波器在πT附近的频率特性，严重时使数字滤波器不满足给定的技术指标。
为此，希望设计的模拟滤波器是带限滤波器，如果不是带限的，例如高通滤波器、带阻滤波
器，需要在高通和带阻滤波器之前加保护滤波器，滤除高于折叠频率πT以上的频带，以
免产生频谱混叠现象。但这样会增加系统的成本和复杂性，因此，高通与带阻滤波器不适
合用这种方法设计。
Created by ZhuangHeng
BHGI
πT T Q
a
IHe
… …
π o ππ ππ π oΩT
b
图 脉冲响应不变法的频谱混叠现象示意图
假设He没有频谱混叠现象，即满足
HGj al≥
由式得到：
HeHi号wlπ
上式说明，如果不考虑频谱混叠现象，用脉冲响应不变法设计的数字滤波器可以很好地重
现原模拟滤波器的频响特性。但是，He的幅度与采样间隔成反比，当T很小时，
He就会有太高的增益。为避免这一现象，令
hnThnT
那么
HIA
式称为实用公式，此时
HeHj号lwlπ
Hs的极点s一般是一个复数，且以共轭成对的形式出现，将式中一对对复
数共轭极点s和s放在一起，形成一个二阶基本节。如果模拟滤波器的二阶基本节的形
式为
s° 极点为a±j 第章无良泳中响应数字虑波器的设计
可以推导出相应的数字滤波器二阶基本节只有实数乘法的形式为
sTT
如果模拟滤波器二阶基本节的形式为
sa 极点为σ±jΩ
Created by ZhuangHeng
口口
口
口口
数字信号处理第五版
则对应的数字滤波器二阶基本节的形式为
zsaTT
利用以上这些变换关系，可以简化设计，使实现结构中无复数乘法器。
综上所述，脉冲响应不变法的优点是频率变换关系是线性的，即wΩT如果不存在
频谱混叠现象，用这种方法设计的数字滤波器会很好地重现原模拟滤波器的频响特性。另
外一个优点是数字滤波器的单位脉冲响应完全模仿模拟滤波器的单位冲激响应波形，时域
特性逼近好。但是，有限阶的模拟滤波器不可能是理想带限的，所以，脉冲响应不变法的最
大缺点是会产生不同程度的频谱混叠失真，其适合用于低通、带通滤波器的设计，不适合
用于高通、带阻滤波器的设计。
【例】 已知模拟滤波器的系统函数Hs为
Hs
用脉冲响应不变法将Hs转换成数字滤波器的系统函数Hz。
解 首先将Hs写成部分分式：
Hsss
极点为
Sjsj
那么Hz的极点为
ee
按照式，并经过整理，得到：
Hz°T
式中，T是采样间隔，若T选取过大，则会使wπ附近频谱混叠现象严重。这里选取T
s和Ts两种情况，以便进行比较。设Ts时用Hz表示，Ts时用
Hz表示，则
H
Hz
转换时，也可以直接按照、式进行转换。首先将Hs写成式的
形式，令极点So±jΩ则
Hsaa
再按照式，Hz为
Created by ZhuangHeng
HT
将Ts、Ts分别代入 Hz中，得到Hz和Hz其结果和前面得到的
Hz、Hz完全一样。将HjΩ、He和He的幅频特性用它们的最大值归一化
后，如图所示。由图a可见，模拟滤波器Hs通带很窄，但阻带衰减慢，拖
了很长的“尾巴”不是带限滤波器。图b表示的是两种采样间隔Tss转换
成数字滤波器的损耗函数，它的横坐标是对π归一化的数字频率。图a、b两张图
的横坐标服从线性关系，即wΩT关系。按照这种关系，T s时，图a的A、
B、C、D、E点对应图b的a、b、c、d、e点；而Ts时，图a的H、、J点对应图b
的h、i、j点。显然，Ts时，它们的幅度特性很相似，只是在折叠频率π模拟频率是
π rads附近有很轻的混叠现象。而对于Ts情况，频率混叠现象很严重，原
模拟滤波器的J点幅度衰减近 dB而对应的数字滤波器的j点幅度衰减却只有 dB
J点的模拟频率只有 radsI点附近失真都很厉害。数字滤波器的幅度特性在wπ
以后又上升，是由于数字系统频响函数的周期性形成的。
tH
h
F T Zis
—— s
幅度dB gIHeI
B
C
幅度dB a
Ts
D
b gIHe
E ae
L
Qrads oπ
a b
图 例中不同采样频率转换结果对比
【例】 用脉冲响应不变法设计数字低通滤波器，要求通带和阻带具有单调下降
特性，指标参数如下：wπ rada dBwπ rada dB。
解 例仅是将给定的模拟滤波器转换成数字滤波器，本例才是用脉冲响应不变
法设计数字滤波器。根据间接设计法的基本步骤求解。
将数字滤波器设计指标转换为相应的模拟滤波器指标。设采样周期为T由
式得到： 第章无限脉冲响应数字滤波器的设计
“ radsadB
a学 radsadB
设计相应的模拟滤波器，得到模拟系统函数Hs。根据单调下降要求，选择巴特
沃斯滤波器。设计过程与例完全相同，求出阶数N。求解计算留做读者练习。
Created by ZhuangHeng
数字信号处理第五版
按照和式，将模拟滤波器系统函数Hs转换成数字滤波器系统
函数Hz
HAHsiA
如上求解计算相当复杂。本例调用MATLAB信号处理工具箱函数进行设计。设计程序
epm如下。读者可以改变程序中的T值，观察T的大小与频谱混叠失真的关系。
用脉冲响应不变法设计数字滤波器程序：epm
T s
wppiTwspiTrprss的模拟滤波器指标
N webuttordwpwsrprsS算相应的模拟滤波器阶数N和dB截止频率we
BAbutterN wes 算相应的模拟滤波器系统函数
BzAzimpinvarBAT脉冲响应不变法将模拟滤波器转换成数字滤波器
省略绘图部分。
程序中，impinvar是脉冲响应不变法的转换函数，BzAzimpinvarBAFs实
现用脉冲响应不变法将分子和分母多项式系数向量为B和A的模拟滤波器系统函数Hs
转换成数字滤波器的系统函数HzHz的分子和分母多项式系数向量为Bz和Az。Fs
为采样频率，缺省时，其值为 Hz。
取Ts时的运行结果：
N
模拟滤波器系统函数Hs分子和分母多项式系数向量B和A
B
A
数字滤波器的系统函数Hz分子和分母多项式系数向量Bz和Az
Bz
Az
由Bz和Az写出数字滤波器系统函数：
Hz
Ts时模拟滤波器和数字滤波器的损耗函数分别如图a和b所示。
如果取T s运行程序得到的Hz与Ts的Hz基本相同保留四位小数
模拟滤波器差别较大。这说明当给定数字滤波器指标时，采样间隔T的取值对频谱混叠程
度的影响很小见后面解释。所以，一般取Ts使设计运算最简单。Ts时，设计的
模拟滤波器和数字滤波器损耗函数曲线如图a和b所示。Ts时，设计的模
拟滤波器和数字滤波器损耗函数曲线如图c和d所示。图中数字滤波器满足指标
要求，但是，由于频谱混叠失真，使数字滤波器在wπ对应模拟频率F Hz附近的衰
减明显小于模拟滤波器在fF附近的衰减。
Created by ZhuangHeng
幅度dB
幅度dB
fHz π a模拟滤波器T s b数字滤波器Ts
幅度dB
幅度dB
fHz π
c模拟滤波器T s d数字滤波器T s
图 例设计的模拟和数字滤波器的损耗函数
用双线性变换法设计IR数字低通滤波器
脉冲响应不变法的主要缺点是会产生频谱混叠现象，使数字滤波器的频响偏离模拟滤
波器的频响特性。产生的原因是模拟低通滤波器不是带限于折叠频率πT在离散化采
样后产生了频谱混叠，再通过映射关系 ze使数字滤波器在wπ附近形成频谱混叠。
为了克服这一缺点，可以采用非线性频率压缩方法，将整个模拟频率轴压缩到士πT之间，
再用ze”转换到z平面上。设Hssj经过非线性频率压缩后用Hssj
表示，这里用正切变换实现频率压缩：
atanaT
式中，T仍是采样间隔。当Ω从πT经过变化到πT时，Ω则由一∞经过变化
到十∞实现了s平面上整个虚轴完全压缩到s平面上虚轴的士πT之间的转换。由
式有
iaeie
代人sjsjΩ得到：
s异e
再通过ze从s平面转换到z平面上，得到：
Created by ZhuangHeng
第章
无限脉冲响应数字滤波器的设计
口
口口
口口
只
口口
口
口
数字信号处理第五版
s
式或式称为双线性变换。从s平面映射到s平面，再从s平面映射到z平
面，其映射关系如图所示。由于从s平面到s平面的非线性频率压缩，使Hs带
限于πT rads因此再用脉冲响应不变法从s平面转换到z平面不可能产生频谱混叠现
象。这就是双线性变换法最大的优点。另外，从s平面转换到z平面仍然采用转换关系
zes平面的±πT之间水平带的左半部分映射到z平面单位圆内部，虚轴映射为单
位圆，这样Hs因果稳定，转换成的Hz也是因果稳定的。
jO
s平面 iQ jlmz s平面 z平面
πT
o Re
πT
图 双线性变换映射关系示意图
下面分析双线性变换法的转换性能。先分析模拟频率Ω和数字频率。之间的关系。令
sjze并代入式，得到：
iae
atan
上式说明，s平面上Ω与z平面的w成非线性正切关系，如图所示。在w附近接
近线性关系；当w增加时，Ω增加得愈来愈快；当w趋近π时，Ω趋近于一。正是因为这种
非线性关系，消除了频谱混叠现象。
①
π
π
图 双线性变换法的频率关系
w与Ω之间的非线性关系是双线性变换法的缺点，使数字滤波器频响曲线不能保真地
模仿模拟滤波器的频响曲线形状。幅度特性和相位特性失真的情况如图所示。这种
非线性影响的实质问题是：如果Ω的刻度是均匀的，则其映像w的刻度不是均匀的，而是
Created by ZhuangHeng
随w增加愈来愈密。因此，如果模拟滤波器的频响具有片段常数特性，则主要是数字滤波
器频响特性曲线的转折点频率值与模拟滤波器特性转折点的频率值成非线性关系。当然，
对于不是片段常数的相位特性仍有非线性失真。因此，双线性变换法适合片段常数特性的
滤波器的设计。实际中，一般选频滤波器的通带和阻带均要求是片段常数特性，因此双线
性变换法得到了广泛的应用。但在设计时，要注意边界频率如通带截止频率、阻带截止频
率等的转换关系要用式计算。如果设计指标中边界频率以数字频率给出，则必须
按式求出相应模拟滤波器的边界频率，将这种计算称为“预畸变校正”。只有这样，
才能保证将设计的Hs转换成Hz后仍满足给定的数字滤波器技术指标。如果边界频
率以模拟频率给出，则设计过程见下小节例和例。
QΩ
Q Q
o
IBGIHe ∠HG
∠He
图 双线性变换法幅度和相位特性的非线性映射示意图
双线性变换法可由简单的代数公式将Hs直接转换成Hz这是该变换
法的优点。但当阶数稍高时，将Hz整理成需要的形式，也不是一件简单的工作。
MATLAB信号处理工具箱提供的几种典型的滤波器设计函数，用于设计数字滤波器时，
就是采用双线性变换法。所以，只要掌握了基本设计原理，工程实际中设计就非常容易。
【例】试用脉冲响应不变法和双线性不变法将 R
图所示的RC低通滤波器转换成数字滤波器。 o o
解 首先按照图写出该滤波器的系统函数 C
Hs为
HSaRC 图 简单RC低通滤波器
利用脉冲响应不变法转换，数字滤波器的系统函数Hz为
Hze
利用双线性变换法转换，数字滤波器的系统函数Hz为
HzHS
aT
第章无限脉冲响应数字滤波器的设计
Created by ZhuangHeng
口 口
口口
口
数字信号处理第五版
设aTs和 sHz和Hz的归一化幅频特性分别如图
b和c所示。图a是模拟滤波器幅频特性，是一个低通滤波器，但由于阶数
低，选择性差，拖了很长的尾巴。图b是采用脉冲响应不变法转换成的数字滤波器
幅频特性曲线，图中wπ处对应的模拟频率与采样间隔T有关，当Ts时，对应
的模拟频率为T Hz当Ts时，对应的模拟频率为 Hz。对照图
a图b所示的数字滤波器与原模拟滤波器的幅度特性差别很大，且频率愈高，差
别愈大。这是由频率混叠失真引起的。相对而言，Ts时混叠少一些。图c
是采用双线性变换法转换成的数字滤波器幅频特性曲线，由于该转换法的频率压缩作用，
使wπ处的幅度降为零，无频谱混叠。但曲线的形状与原模拟滤波器幅度特性曲线的形
状差别较大，这是由于该转换法的非线性造成的，T小一些，非线性的影响少一些。
噩
fHz
a
Ts —Ts
噩 噩
Ts
—Ts
oπ wπ
b e
图 例中Hs、Hz和Hz的幅频特性
下面我们总结利用模拟滤波器设计IIR数字低通滤波器的步骤。
确定数字低通滤波器的技术指标：通带边界频率w、通带最大衰减a、阻带截止
频率w、阻带最小衰减a。
将数字低通滤波器的技术指标转换成相应的模拟低通滤波器的技术指标。这里主
要是边界频率w。和w的转换，a和a指标不变。如果采用脉冲响应不变法，边界频率的
转换关系为
Created by ZhuangHeng
一
如果采用双线性变换法，边界频率的转换关系为
按照模拟低通滤波器的技术指标设计过渡模拟低通滤波器。设计方法及设计步骤
参考本章节。
用所选的转换方法，将模拟滤波器Hs转换成数字低通滤波器系统函数Hz。
在设计过程中，要用到采样间隔T下面介绍T的选择原则。如采用脉冲响应不变法，
为避免产生频率混叠现象，要求所设计的模拟低通带限于一πTπT区间。由于实际滤
波器都是有限阶的，因此有一定宽度的过渡带，且频响特性不是带限于πT。当给定模拟
滤波器Hs要求单向转换成数字滤波器 Hz且a。足够大时，选择T满足Ω
πT可使频谱混叠足够小，满足数字滤波器指标要求。但如果先给定数字低通的技术指标
时，情况则不一样。由于数字滤波器频响函数He以π为周期，最高频率在wπ处，
因此，wπ按照线性关系ΩwT那么一定满足πT这样T可以任选。一般选
Ts。这时，频谱混叠程度完全取决于aa越大，混叠越小。对双线性变换法不存在频
谱混叠现象，尤其对于设计片段常数滤波器，T也可以任选。为了简化计算，一般取
Ts。
【例】 设计低通数字滤波器，要求频率低于π rad时，容许幅度误差在 dB
以内；在频率π到π之间的阻带衰减大于 dB。指定模拟滤波器采用巴特沃斯低通滤
波器。试用双线性变换法设计数字滤波器。
解数字低通技术指标为
。π radap dB
wπ rada dB
为了计算简单，取Ts预畸变校正计算相应模拟低通的技术指标为
atan tanπ radsadB
ntan tanm radsadB
设计巴特沃斯低通模拟滤波器。根据式阶数N计算如下：
√
第，章无良脉中向应数字虑皮的没
Created by ZhuangHeng
数字信号处理第五版
NI
取N。将Ω和a代人式，求得Ω rads。这样保证阻带技术指标满
足要求，通带指标有富余。
根据N查表得到的归一化低通原型系统函数Gp为
GDppDpbDppD
将psΩ。代人Gp去归一化得到实际的Hs为
Hsssss
用双线性变换法将Hs转换成数字滤波器Hz即
HzHS
a
本例设计的模拟和数字滤波器幅度特性分别如图a和b所示。此图表明数字滤波
器满足技术指标要求，且无频谱混叠。
F
幅度dB
幅度dB
fHz wπ
a b
图 例设计的模拟和数字滤波器幅度特性
本例的设计程序为epm。程序中分别采用本例中的双线性变换法的分步设计法和
调用MATLAB工具箱函数buttord和butter直接设计数字滤波器，所得结果完全相同。这
就说明该函数默认采用双线性变换法。
设计程序：epm
双线性变换法设计 DF
TFsT
wpzwsz
wptanwpz piwstanwszpirplrs畸变校正转换指标
Nwebuttordwpwsrprss计过渡模拟滤波器
BAbutterNwes
BzAzbilinearBAFs 双线性变换法转换成数字滤波器
Created by ZhuangHeng
Nd wdebuttordwpzwszrprs 用buttord和butter直接设计数字滤波器
BdzAdzbutterNdwde
制滤波器的损耗函数曲线省略
数字高通、带通和带阻滤波器的设计
前面我们已经学习了模拟低通滤波器的设计方法，以及基于模拟滤波器的频率变换，
模拟高通、带通和带阻滤波器的设计方法。对于数字高通、带通和带阻滤波器的设计，通用
方法为双线性变换。可以借助于模拟滤波器的频率变换设计一个所需类型的过渡模拟滤波
器，再通过双线性变换将其转换成所需类型的数字滤波器，例如高通数字滤波器等。具体
设计步骤如下：
确定所需类型数字滤波器的技术指标。
将所需类型数字滤波器的边界频率转换成相应类型的过渡模拟滤波器的边界频
率，转换公式为
atan
将相应类型模拟滤波器技术指标转换成模拟低通滤波器技术指标具体转换公式
参看本章节。
设计模拟低通滤波器。
通过频率变换将模拟低通转换成相应类型的过渡模拟滤波器。
采用双线性变换法将相应类型的过渡模拟滤波器转换成所需类型的数字滤波器。
MATLAB信号处理工具箱中的各种IIRDF 设计函数就是按照如上步骤编程设计
的，工程实际中可以直接调用这些函数设计各种类型的IIR数字滤波器。下面先通过例题
说明按照如上步骤设计高通数字滤波器的方法，再直接调用MATLAB函数设计带通、带
阻数字滤波器。
【例】 设计一个数字高通滤波器，要求通带截止频率wπ rad通带衰减不
大于dB阻带截止频率wπ rad阻带衰减不小于 dB。希望采用巴特沃斯滤波器。
解确定数字高通的技术指标：
wpπ radadB
wπ rada dB
将高通数字滤波器的技术指标转换成高通模拟滤波器的设计指标：令Ts预
第章无限脉冲响应数字滤波器的设计
畸变校正得到模拟边界频率：
mtan radsadB
QtanradsadB
模拟低通滤波器的技术指标计算如下：对通带边界频率本例中就是dB截止频
Created by ZhuangHeng
口
口
数字信号处理第五版
率Ω归一化，即
λλapdB
将λ。和Ω代入式，求出归一化低通滤波器的阻带截止频率
λadB
设计归一化模拟滤波器Gp。
k√oA。
N取N
查表得到归一化模拟低通原型系统函数Gp为
Cpzp
利用频率变换公式式将Gp转换成模拟高通HHps
HSGp
用双线性变换法将模拟高通Hs转换成数字高通Hz
HzHS
实际上，上述复杂的设计过程的实现程序epm只有下面行：
wpzwszrprs
N webuttordwpzwszrprs用buttord和butter直接设计数字滤波器
BzAzbutterN wehigh
程序运行结果：
NBz Az
Hz的系数虽然不相同，但手算结果和程序运行结果均满足指标要求。数字滤波器损
耗函数如图所示。
幅度dB
π
图 高通数字滤波器损耗函数
Created by ZhuangHeng
【例】 希望对输入模拟信号采样并进行数字带通滤波处理，系统采样频率F
kHz要求保留～ Hz频段的频率成分，幅度失真小于 dB滤除～ Hz
和 Hz以上频段的频率成分，衰减大于 dB。试设计数字带通滤波器实现上述要求。
解 这是一个用数字滤波器对模拟信号进行带通滤波处理的应用实例先对模拟信号
进行AD变换，再进行数字带通滤波处理。首先确定数字滤波器技术指标：
Ffππ
RπaFπ
dBa dB
为了使滤波器阶数最低，选用椭圆滤波器。调用MATLAB信号处理工具箱函数
ellipord和ellip直接设计数字带通滤波器的程序为epm。
调用函数ellipord和ellip直接设计数字椭圆带通滤波器程序：epm
fplfpufslfsuFs
wpfplFsfpuFswsfslFsfsuFs波器边界频率关于π归一化
rprs
Nwpoellipordwpwsrprs用ellipord 计算滤波器阶数N和通带截止频率wpo
BAellipNrp rs wpo用ellip 计算带通滤波器系统函数系数向量B和A
程序运行结果：
N
wpo ws
B
A
由系数向量B和A可知，系统函数分子分母是N阶多项式：
Hbahazaaaa
式中
bBkaAkk
阶椭圆数字带通滤波器损耗函数曲线如图所示。
幅度dB 第章无限脉冲响应数字滤波器的设计
L
t
图 六阶椭圆数字带通滤波器损耗函数曲线
Created by ZhuangHeng
数字信号处理第五版
【例】 希望对输人模拟信号采样并进行数字带阻滤波处理，系统采样频率F
kHz要求滤除～ Hz频段的频率成分，衰减大于 dB保留 Hz和
Hz以上频段的频率成分，幅度失真小于dB。试设计数字带阻滤波器实现上述要求。
解 首先确定数字滤波器技术指标：
f×fπ
mf×πamf×m
a dBa dB
选用椭圆滤波器，调用MATLAB信号处理工具箱函数ellipord和ellip直接设计数字带阻
滤波器的程序为epm。除了ellip 中加入滤波器类型参数stop外，该程序与程序
epm完全相同。
调用函数ellipord和ellip直接设计数字椭圆带阻滤波器程序：epm
fslfsufplfpuFs
wsfslFsfsuFswpfplFsfpuFs算滤波器边界频率关于π归一化
rprs
Nwpoellipordwpwsrprs用ellipord计算滤波器阶数N和通带截止频率wpo
BAellipNrprswpostop用ellip计算带阻滤波器系统函数系数向量B和A
程序运行结果：
Nwpo
B
A
根据系统函数系数向量B和A画出阶数字椭圆带阻滤波器损耗函数曲线如图
所示。
幅度dB
L
a
图 六阶椭圆数字带阻滤波器损耗函数曲线
以上仅介绍了用双线性变换法设计数字高通、数字带通和数字带阻滤波器的基本步
骤，并举例说明了高通数字滤波器的设计过程。这种方法基于模拟滤波器的频率变换，即
先设计模拟低通滤波器，再利用频率变换将模拟低通滤波器转换成所需类型的模拟滤波器
例如模拟高通滤波器最后采用双线性变换法将所需类型的模拟滤波器转换成所需类型
的数字滤波器。这里要说明的是，如果设计的是数字低通或者数字带通滤波器，则也可以
Created by ZhuangHeng
采用脉冲响应不变法。但对于数字高通或者数字带阻滤波器，则只能采用双线性变换法进
行转换。
按照以上步骤设计数字滤波器的计算繁杂，MATLAB提供的滤波器设计工具箱函数
就是按照这种理论来实现各种类型滤波器的设计的。工程实际中，调用对应函数就可以直
接设计所需要的各种滤波器。
请注意，对于滤波器的频率变换，除了本节介绍的模拟域的频率变换以外，在数字域
也可以进行频率变换。利用数字域频率变换的设计过程是：先将模拟低通滤波器采用脉冲
响应不变法或者双线性变换法转换成数字低通滤波器，再在数字域利用频率变换将低通滤
波器转换成所需类型的数字滤波器例如数字高通滤波器。限于篇幅，本书未编入这部分
内容，读者若感兴趣，可阅读参考文献。
最后要说明的是，前面所介绍的IIR数字滤波器的间接设计法是通过先设计模拟滤波
器，再进行sz平面转换，来达到设计数字滤波器的目的的。这种设计方法使数字滤波器
幅度特性受到所选模拟滤波器特性的限制。例如，巴特沃斯低通幅度特性是单调下降，而
切比雪夫低通特性带内或带外有上、下波动等。所以，对于要求任意幅度特性的滤波器，则
不适合采用这种方法。数字域直接设计IIR 滤波器的方法和FIR数字滤波器的设计方法可
以解决这种问题。
IIR滤波器的数字域直接设计方法有零极点累试法、频域幅度平方误差最小法和时域
直接设计法。后两种方法都属于优化设计方法。在下章节将介绍的MATLAB
滤波器设计分析工具fadtool中，也有任意形状频响特性数字滤波器的直接设计方法。
零极点累试法的基本思想是根据期望的幅频特性先确定零极点位置，再按照确定的零
极点写出其系统函数，画出其幅度特性，并与希望的幅频特性进行比较，如不满足要求，可
通过移动零极点位置或增加减少零极点进行修正。这种修正是多次的，因此称为零极点
累试法。这种设计方法主要适用于实现简单、选择性要求很低的简单的滤波器设计。
限于篇幅和高等学校本科教学要求，本书未编入直接设计法的具体内容。
习题与上机题
设计一个巴特沃斯低通滤波器，要求通带截止频率fkHz通带最大衰减a
dB阻带截止频率f kHz阻带最小衰减α dB。求出滤波器归一化系统函数
Gp以及实际的Hs。
第章无限脉冲响应数字滤波器的设计
设计一个切比雪夫低通滤波器，要求通带截止频率fkHz通带最大衰减a
dB阻带截止频率f kHz阻带最小衰减a dB。求出滤波器归一化系统函数
Gp和实际的Hs。
设计一个巴特沃斯高通滤波器，要求其通带截止频率f。 kHz阻带截止频率
fkHzf。处最大衰减为dB阻带最小衰减a dB。求出该高通滤波器的系统函
Created by ZhuangHeng
数字信号处理第五版
数Hs。
已知模拟滤波器的系统函数Hs如下：
Hssa
Hssab
式中a、b为常数，设Hs因果稳定，试采用脉冲响应不变法将其转换成数字滤波器
Hz。
已知模拟滤波器的系统函数如下：
Hss
Hs
试采用脉冲响应不变法和双线性变换法将其转换为数字滤波器。设Ts。
设h表示一模拟滤波器的单位冲激响应，即
用脉冲响应不变法，将此模拟滤波器转换成数字滤波器用hn表示单位脉冲响应，即
hnhnT。确定系统函数Hz并把T作为参数，证明：T为任何值时，数字滤波
器是稳定的，并说明数字滤波器近似为低通滤波器还是高通滤波器。
假设某模拟滤波器Hs是一个低通滤波器，又知 HzHs出，数字滤波
器Hz的通带中心位于下面哪种情况并说明原因。
w低通。
wπ高通。
除或π以外的某一频率带通。
题图是由RC组成的模拟滤波器，写出其系统函数Hs并选用一种合适的转
换方法，将Hs转换成数字滤波器Hz最后画出网络结构图。
C
x R yt
○
题图
设计低通数字滤波器，要求通带内频率低于π rad时，容许幅度误差在 dB之
内；频率在π到π之间的阻带衰减大于 dB。试采用巴特沃斯型模拟滤波器进行设计，
用脉冲响应不变法进行转换，采样间隔Tms。
要求同题试采用双线性变换法设计数字低通滤波器。
设计一个数字高通滤波器，要求通带截止频率wπ rad通带衰减不大于
Created by ZhuangHeng
dB阻带截止频率wπ rad阻带衰减不小于 dB希望采用巴特沃斯型滤波器。
设计一个数字带通滤波器，通带范围为π rad到π rad通带内最大衰减
为dBπ rad 以下和π rad 以上为阻带，阻带内最小衰减为 dB。试采用巴特
沃斯型模拟低通滤波器。
°设计巴特沃斯数字带通滤波器，要求通带范围为π rad≤w≤π rad通带
最大衰减为dB阻带范围为≤w≤π rad和π rad≤w≤π rad阻带最小衰减为
dB。调用MATLAB工具箱函数buttord和butter 设计，并显示数字滤波器系统函数
Hz的系数，绘制数字滤波器的损耗函数和相频特性曲线。这种设计对应于脉冲响应不变
法还是双线性变换法
设计一个工作于采样频率 kHz的巴特沃斯低通数字滤波器，要求通带边界频
率为kHz通带最大衰减为 dB阻带边界频率为kHz阻带最小衰减为 dB。调
用MATLAB工具箱函数buttord和 butter设计，并显示数字滤波器系统函数Hz的系
数，绘制损耗函数和相频特性曲线。
°设计一个工作于采样频率 kHz的切比雪夫I型低通数字滤波器，滤波器指标
要求与题的相同。调用MATLAB工具箱函数cheblord和chebyl设计，并显示数字滤
波器系统函数Hz的系数，绘制损耗函数和相频特性曲线。与题的设计结果比较，简
述巴特沃斯滤波器和切比雪夫I型滤波器的特点。
°设计一个工作于采样频率 kHz的椭圆高通数字滤波器，要求通带边界频率
为 kHz通带最大衰减为 dB阻带边界频率为kHz阻带最小衰减为 dB。调
用MATLAB工具箱函数ellipord和ellip 设计，并显示数字滤波器系统函数Hz的系数，
绘制损耗函数和相频特性曲线。
°设计一个工作于采样频率MHz的椭圆带通数字滤波器，要求通带边界频率为
kHz和kHz通带最大衰减为dB阻带边界频率为kHz和MHz阻带
最小衰减为 dB。调用MATLAB工具箱函数ellipord和ellip设计，并显示数字滤波器系
统函数Hz的系数，绘制损耗函数和相频特性曲线。
°设计一个工作于采样频率kHz的椭圆带阻数字滤波器，要求通带边界频率为
Hz和 Hz通带最大衰减为 dB阻带边界频率为 kHz和 Hz阻带最
小衰减为 dB。调用MATLAB工具箱函数ellipord和ellip设计，并显示数字滤波器系统
函数Hz的系数，绘制损耗函数和相频特性曲线。 第章无恨脉中响数字虑皮器的设计 °用脉冲响应不变法设计一个巴特沃斯低通数字滤波器，指标要求与题的相
同。编写程序先调用MATLAB工具箱函数buttord和butter设计过渡模拟低通滤波器，再
调用脉冲响应不变法数字化转换函数impinvar将过渡模拟低通滤波器转换成低通数字滤
波器Hz并显示过渡模拟低通滤波器和数字滤波器系统函数的系数，绘制损耗函数和相
频特性曲线。请归纳本题的设计步骤和所用的计算公式，并比较本题与题°的设计结果，
观察双线性变换法的频率非线性失真和脉冲响应不变法的频谱混叠失真。
Created by ZhuangHeng
口口
数字信号处理第五版
第章
有限脉冲响应数字滤波器的设计
IIR 数字滤波器的设计方法是利用模拟滤波器成熟的理论及设计图表进行设计的，因
而保留了一些典型模拟滤波器优良的幅度特性。但设计中只考虑了幅度特性，没考虑相位
特性，所设计的滤波器一般是某种确定的非线性相位特性。为了得到线性相位特性，对IIR
滤波器必须另外增加相位校正网络，使滤波器设计变得复杂，成本也高，又难以得到严格
的线性相位特性。有限脉冲响应FIR滤波器在保证幅度特性满足技术要求的同时，很容
易做到有严格的线性相位特性。本章中用N表示FIR滤波器单位脉冲响应hn的长度，
其系统函数Hz为
H∑hna
Hz是z的N次多项式，它在z平面上有N个零点，在原点z处有一个N重
极点。因此，Hz绝对稳定。稳定和线性相位特性是FIR 滤波器最突出的优点。
FIR滤波器的设计方法和IIR滤波器的设计方法截然不同。FIR滤波器设计任务是选
择有限长度的hn使频率响应函数He满足技术指标要求。本章主要介绍三种设计方
法：窗函数法、频率采样法和切比雪夫等波纹逼近法。
线性相位FIR数字滤波器的条件和特点
本节主要介绍FIR 滤波器具有线性相位的条件及幅度特性以及零点的分布特点。
线性相位FIR数字滤波器
对于长度为N的hn频率响应函数为
He∑hne
Created by ZhuangHeng
HeHwe
式中，Hw称为幅度特性；θw称为相位特性。注意，这里Hw不同于He
Hw为w的实函数，可能取负值，而He总是正值。线性相位FIR滤波器是指θw
是w的线性函数，即
ww t为常数
如果θw满足下式：
w。w。是起始相位
严格地说，此时θo不具有线性相位特性，但以上两种情况都满足群时延是一个常数，即
d
也称这种情况为线性相位。一般称满足式是第一类线性相位严格线性相位特性
满足式为第二类线性相位。π是第二类线性相位特性常用的情况，所以本
章仅介绍这种情况。
线性相位FIR滤波器的时域约束条件
线性相位FIR 滤波器的时域约束条件是指满足线性相位时，对hn的约束条件。为了
使滤波器对实信号的处理结果仍是实信号，一般要求hn为实序列。
第一类线性相位对hn的约束条件
第一类线性相位FIR数字滤波器的相位函数θwwr由式和得到：
He∑hneHe
∑hCncsnjsinunHcsrjsinor
由式得到： 二二
将式中两式相除得到：
第章有限脉冲响应数字滤波器的设计
即
∑hcncsn siorhcn sinon cos
移项并用三角公式化简得到：
Created by ZhuangHeng
∑hnsinon
数字信号处理第五版
函数hnsinwnr关于求和区间的中心N奇对称，是满足式的一组解。
因为sinanr关于nr奇对称，如果取rN则要求hn关于N偶对
称，所以要求r和hn满足如下条件：
——
由以上推导结论可知，如果要求单位脉冲响应为hn、长度为N的FIR数字滤波器具有
第一类线性相位特性严格线性相位特性则hn应当关于nN点偶对称。当N
确定时，FIR数字滤波器的相位特性是一个确知的线性函数，即θwwN。N
为奇数和偶数时，hn的对称情况分别如表中的情况和情况所示。
第二类线性相位对hn的约束条件
第二类线性相位 FIR数字滤波器的相位函数θwπwr由式和
式有
Hehne”He
经过同样的推导过程可得到：
∑hwcsCon
函数hncosunt关于求和区间的中心N奇对称，是满足式的一组
解，因为cosunr关于nt偶对称，所以要求r和hn满足如下条件：
N N一分。≤n≤N
由以上推导结论可知，如果要求单位脉冲响应为hn、长度为N的FIR 数字滤波器
具有第二类线性相位特性，则hn应当关于nN点奇对称。N为奇数和偶数时
hn的对称情况分别如表中情况和情况所示。
线性相位FIR滤波器幅度特性Ho的特点
实质上，幅度特性的特点就是线性相位FIR滤波器的频域约束条件。将时域约束条件
hn±hNn代入式设hn为实序列，即可推导出线性相位条件对FIR
数字滤波器的幅度特性Hw的约束条件。当N取奇数和偶数时对Hw的约束不同，因
此，对于两类线性相位特性，下面分四种情况讨论其幅度特性的特点。这些特点对正确设
计线性相位FIR数字滤波器具有重要的指导作用。为了推导方便，引人两个参数符号：
NMNz
式中，N表示取不大于N的最大整数。显然，仅当N为奇数时，Mr
N。
Created by ZhuangHeng
表 线性相位FIR数字滤波器的时域和频域特性一览表
第一类线性相位特性 hnhNn
情况 r Bwr
以N为例画图
。
oπ
N为奇数N
加m
BOmZZmofeuD
r
H
aπ
N为偶数N
r
是
BOZhosuw
π
情况
hnhNn 第二类线性相位特性
情况 eorr
以N为例画图
F
π
N为奇数N
r
是 F
n
Bmmno切
ofH
。
π
N为偶数N
加m
n
mmiob
o用
o
wπ
情况
第章有限脉冲响应数字滤波器的设计
Created by ZhuangHeng
口
口
■□
口
口
口口
口
口口
口口
口口
口口
口
数字信号处理第五版
情况hnhNnN为奇数。
将时域约束条件hnhNn和θwwr代入式和得到：
HeHmeZhne
hN∑hcnehNne
hNhnemhne
enNzZhnee
ehehcncstLon
所以
HuhzhncosLunz
因为coswnt关于wππ三点偶对称，所以由式可以看出，Hw关于
wππ三点偶对称。因此情况可以实现各种低通、高通、带通、带阻滤波器。对
于N的低通情况，Hw的一种例图如表中情况所示。
情况hnhNnN为偶数。
仿照情况的推导方法得到：
HeHehnec∑hmcsocn
Hm∑zhncsLon
式中，zNN。因为N是偶数，所以当wπ时
cosunxcosπnsinnn
而且coswnt关于过零点奇对称，关于w和π偶对称。所以HπHw关
于wπ奇对称，关于w和π偶对称。因此，情况不能实现高通和带阻滤波器。对
N的低通情况，Hw如表中情况所示。
情况hnhNnN为奇数。
将时域约束条件hnhNn和θwπ—wr代人式和并
考虑hN得到：
HeHehne
∑ChCnehNnDe
Created by ZhuangHeng
∑LhCnehne
Zhcne
jeZhCn sintocn
chn ifocn
Hmhnsinon
式中，N是奇数，zN是整数。所以，当wππ时，sinwnr而且
sinwnr关于过零点奇对称。因此Hw关于wππ三点奇对称。由此可见，情
况只能实现带通滤波器。对N的带通滤波器举例，Hw如表中情况所示。
情况hnhNnN为偶数。
用情况的推导过程可以得到：
H∑hw sinton
式中，N是偶数，zNN。所以，当wπ时，sinunr当
wπ时，sinwntN为峰值点。而且 sinwnr关于过零点w和π
两点奇对称，关于峰值点wπ偶对称。因此Hw关于w和π两点奇对称，关于w
π偶对称。由此可见，情况不能实现低通和带阻滤波器。对N的高通滤波器举例，
Hw如表中情况所示。
为了便于比较，将上面四种情况的hn及其幅度特性需要满足的条件列于表
中。应当注意，对每一种情况仅画出满足幅度特性要求的一种例图。例如，情况仅以低通
的幅度特性曲线为例。当然也可以画出满足情况的幅度约束条件Hw关于wπ
π三点偶对称的高通、带通和带阻滤波器的幅度特性曲线。所以，仅从表就认为情
况只能设计低通滤波器是错误的。
线性相位FIR数字滤波器的零点分布特点
H∑hnz 第章有限脉冲响应数字滤波器的设计
将hn±hNn代入上式，得到：
H∑hne±∑hCNn
±ZhmW±Ha
由式可以看出，如zz是Hz的零点，其倒数z也必然是其零点；又因为
Created by ZhuangHeng
口
口口
口 口
口
口口
口
口口
口口
口
口
数字信号处理第五版
hn是实序列，Hz的零点必定共轭成对，因此z和z也是其零点。这样，线性相
位FIR 滤波器零点必定是互为倒数的共轭对，确定其中一个，另外三个零点也就确定了，
如图中z、z、z和z。当然，也有一些特殊情况，如图中z、z和z
情况。
虚部
。 至
。 z
。
。
实部
图 线性相位FIR数字滤波器的零点分布
利用窗函数法设计FIR滤波器
窗函数法设计原理
设希望逼近的滤波器频率响应函数为He其单位脉冲响应是han。
He∑hne
hanHeed
如果能够由已知的He求出hn经过Z变换可得到滤波器的系统函数。但通常以理
想滤波器作为He其幅度特性逐段恒定，在边界频率处有不连续点，因而hn是无
限时宽的，且是非因果序列。例如，线性相位理想低通滤波器的频率响应函数He为
Hlaix
其单位脉冲响应hn为
hnedsia
由上式看到，理想低通滤波器的单位脉冲响应han是无限长，且是非因果序列。hn的
波形如图a所示。为了构造一个长度为N的第一类线性相位FIR滤波器，只有将
hn截取一段，并保证截取的一段关于nN偶对称。设截取的一段用hn表
Created by ZhuangHeng
示，即
hnhnRn
式中，R√n是一个矩形序列，长度为N波形如图b所示。由该图可知，当α取值
为N时，截取的一段hn关于nN偶对称，保证所设计的滤波器具有线
性相位。
hn
l
RMn
oL
hn
l
I。 I
n
图 窗函数设计法的时域波形矩形窗，N
我们实际设计的滤波器的单位脉冲响应为hn长度为N其系统函数为Hz
Hshn
这样用一个有限长的序列hn去代替hn肯定会引起误差，表现在频域就是通常所说
的吉布斯Gibbs效应。该效应引起过渡带加宽以及通带和阻带内的波动，尤其使阻带的衰
减小，从而满足不了技术上的要求，如图所示。这种吉布斯效应是由于将hn直接
截断引起的，因此，也称为截断效应。下面讨论这种截断效应的产生，以及如何构造窗函数 第章有限脉冲响应数字滤波器的设计
wn用来减少截断效应，设计一个能满足技术要求的FIR线性相位滤波器。
以上就是用窗函数法设计FIR滤波器的思想。另外，我们知道H。e是一个以π为
周期的函数，可以展为傅里叶级数，即
Hae∑hane
傅里叶级数的系数为hn当然就是He对应的单位脉冲响应。设计FIR 滤波器就是
Created by ZhuangHeng
根据要求找到N个傅里叶级数系数hnn…N以N项傅氏级数去近似
代替无限项傅氏级数，这样在一些频率不连续点附近会引起较大误差，这种误差就是前面
说的截断效应，如图所示。因此，从这一角度来说，窗函数法也称为傅氏级数法。显
然，选取傅氏级数的项数愈多，引起的误差就愈小，但项数增多即hn长度增加，也使成
本和滤波计算量加大，应在满足技术要求的条件下，尽量减小hn的长度。
k
数字信号处理第五版
幅度
幅度dB
oL
L
wπ π
a幅频响应函数曲线 b损耗函数曲线
图 吉普斯效应
在式中，Rnn矩形序列就是起对无限长序列的截断作用，可以形象地把
Rxn看做一个窗口，hn则是从窗口看到的一段hn序列，所以称hnhnRxn
为用矩形窗对hn进行加窗处理。下面分析用矩形窗截断的影响和改进的措施。为了叙述
方便，用wn表示窗函数，用下标表示窗函数类型，矩形窗记为wgn。用N表示窗函数
长度。
根据傅里叶变换的时域卷积定理，得到式的傅里叶变换：
HefHe°We”de
式中，He和Wge分别是hn和R√n的傅里叶变换，即
WaeZunee
esic
Wgewe
式中
aN WmsicN
Wrga称为矩形窗的幅度函数，如图b所示，将图中πNπN区间上的
一段波形称为WRw的主瓣，其余较小的波动称为旁瓣。将He写成He
Hae则按照式，理想低通滤波器的幅度特性函数如图a所示为
Hellx
Created by ZhuangHeng
Hθ
a
一π
θ
Wθ
b πN πN
H W
c
θ
H
W d
aπN θ
H
Wg
e
anN θ
HaH
a a
图 矩形窗加窗效应
将He和Wge代入式，得到：
HeHfeWuede
e厂HOWaudo
第章有限脉冲响应数字滤波器的设计
将He写成HeHwe则
HmHOWnwde
式中Hw是He的幅度特性。该式说明加窗后的滤波器的幅度特性等于理想低通滤波
器的幅度特性Hw与矩形窗幅度特性WRw的卷积。
Created by ZhuangHeng
口口
口口口
口
口
数字信号处理第五版
图f表示Hw与Wo卷积形成的Hw波形。当w时，H等于图
a与b两波形乘积的积分，相当于对Wrw在土w之间一段波形的积分，当w》
πN时，近似为士π之间波形的积分。将H值归一化到。当ww时，情况如图
c所示，当wπN时，积分近似为WRg一半波形的积分，对H归一化后
的值近似为。当ww。πN时，情况如图d所示，Wgw主瓣完全在区间
ww之内，而最大的一个负旁瓣移到区间ww之外，因此HwπN有一
个最大的正峰。当wwπN时，情况如图e所示，Wggw主瓣完全移到积分区
间外边，由于最大的一个负旁瓣完全在区间w内，因此HwπN形成最大的
负峰。图表明，Hw最大的正峰与最大的负峰对应的频率相距πN。通过以上分
析可知，对hn加矩形窗处理后，Hw与原理想低通Hw的差别有以下两点：
在理想特性不连续点ww。附近形成过渡带。过渡带的宽度近似等于Ww主瓣
宽度πN。这里将Hw最大正、负峰值对应的频率间距称为近似过渡带宽度，其精确值
为πN见表。
通带内产生了波纹，最大的峰值在wπN处。阻带内产生了余振，最大的负峰
在wπN处。通带与阻带中波纹的情况与窗函数的幅度谱有关，Wrw旁瓣幅度的大
小直接影响Hw波纹幅度的大小。
以上两点就是对hn用矩形窗截断后，在频域的反映，称为吉布斯效应。这种效应直
接影响滤波器的性能。通带内的波纹影响滤波器通带的平稳性，阻带内的波纹影响阻带内
的衰减，可能使最小衰减不满足技术指标要求。当然，一般滤波器都要求过渡带愈窄愈好。
下面研究如何减少吉布斯效应的影响，设计一个满足要求的FIR滤波器。
直观上，好像增加矩形窗的长度，即加大N就可以减少吉布斯效应的影响。只要分析
一下N加大时WRw的变化，就可以看到这一结论不是完全正确。我们讨论在主瓣附近
的情况。在主瓣附近，按照式WRa可近似为
Wusinc≈Nsinz
该函数的性质是随x加大N加大主瓣幅度加高，同时旁瓣也加高，保持主瓣和旁瓣幅
度相对值不变；另一方面，N加大时，WRw的主瓣和旁瓣宽度变窄，波动的频率加快。
三种不同长度的矩形窗函数的幅度特性Wgw曲线如图a、b、c所示。用这三
种窗函数设计的FIR滤波器的幅度特性Ha曲线如图d、e、f所示。因此，
当N加大时，Hw的波动幅度没有多大改善，带内最大肩峰比 H高阻带最
大负峰值为H的使阻带最小衰减只有 dB。加大N只能使Hw过渡带变
窄过渡带近似为主瓣宽度πN。因此加大N并不是减小吉布斯效应的有效方法。
以上分析说明，调整窗口长度N只能有效地控制过渡带的宽度，而要减少带内波动以
及增大阻带衰减，只能从窗函数的形状上找解决问题的方法。构造新的窗函数形状，使其
谱函数的主瓣包含更多的能量，相应旁瓣幅度更小。旁瓣的减小可使通带、阻带波动减小，
从而加大阻带衰减。但这样总是以加宽过渡带为代价的。下面介绍几种常用的窗函数。
Created by ZhuangHeng
worda
l l
l
wπ wπ π
aN bN cN
aploH
l
l
wπ wπ oπ
dN eN N
图 矩形窗函数长度的影响
典型窗函数介绍
本节主要介绍几种常用窗函数的时域表达式、时域波形、幅度特性函数衰减用dB计
量曲线，以及用各种窗函数设计的FIR数字滤波器的单位脉冲响应和损耗函数曲线。为了
叙述简单，我们把这组波形图简称为“四种波形”。下面均以低通为例，He取理想低通，
wπ窗函数长度N。
矩形窗Rectangle Window
wgnR、n
前面已分析过，按照式，其幅度函数为
Wamsina
为了描述方便，定义窗函数的几个参数：
旁瓣峰值a——窗函数的幅频函数Ww的最大旁瓣的最大值相对主瓣最大值的衰
减值dB
过渡带宽度B——用该窗函数设计的FIR数字滤波器FIRDF的过渡带宽度；
阻带最小衰减a——用该窗函数设计的FIRDF的阻带最小衰减。
图所示的矩形窗的参数为：a dBBπNa dB。
三角形窗Bartlett Window
第章有限脉冲响应数字滤波器的设计 一
Created by ZhuangHeng
口
口
口口
口
口口
a口
数字信号处理第五版
其频谱函数为
waein。
其幅度函数为
w元si
三角窗的四种波形如图所示，参数为：a dBBπNa dB。
F
m同
Wool
n o
gHon
l
n wπ
图 三角窗的四种波形
汉宁Hanning窗——升余弦窗
wmancosNRn
We”FTwmnWngme
WHeFTWHn
WeuwnuNWNe
Wnme
当N时，N≈N
WmaWuWwW
汉宁窗的幅度函数WHngw由三部分相加，旁瓣互相对消，使能量更集中在主瓣中。汉宁窗
的四种波形如图所示，参数为：a dBBπNa dB。
Created by ZhuangHeng
uaw
ewon
k
n w
hn
工 工 gHo
B
l L
n wm
图 汉宁窗的四种波形
哈明Hamming窗——改进的升余弦窗
wmn cosRn
其频谱函数WHe为
weWaeWee始Wae音
其幅度函数WHmw为
WaWaWuNWeN
当N时，其可近似表示为
Ww≈WmWW
这种改进的升余弦窗，能量更加集中在主瓣中，主瓣的能量约占旁瓣峰值幅度为
dB但其主瓣宽度和汉宁窗的相同，仍为πN。可见哈明窗是一种高效窗函数，所以
MATLAB窗函数设计函数的默认窗函数就是哈明窗。哈明窗的四种波形如图所示，
参数为：a dBBπNa dB。
布莱克曼Blackman窗
wnn cscoNR≈n
第章有限脉冲响应数字滤波器的设计
其频谱函数为
WneWaeWe章We
We弱We
Created by ZhuangHeng
其幅度函数为
口
口口
口
口口
口
数字信号处理第五版
wm
gWMot
oL
n π
r
是
glHon
π
图 哈明窗的四种波形
WnguWWuNwmN
WwNWwN
这样其幅度函数由五部分组成，它们都是移位不同，且幅度也不同的WRu函数，使旁瓣
再进一步抵消。旁瓣峰值幅度进一步增加，其幅度谱主瓣宽度是矩形窗的倍。布莱克曼
窗的四种波形如图所示，参数为：a dB△BπNa dB。
F i
u藏w
wa oo
l
l A
n aπ
r
是
gHo
n oπ
图 布莱克曼窗的四种波形
凯塞一贝塞尔窗KaiserBasel Window
以上五种窗函数都称为参数固定窗函数，每种窗函数的旁瓣幅度都是固定的。凯塞一
Created by ZhuangHeng
贝塞尔窗是一种参数可调的窗函数，是一种最优窗函数。
wno≤n≤N
式中 βa√“
I。β是零阶第一类修正贝塞尔函数，可用下面级数计算：
I。B号
一般I。β取～项，便可以满足精度要求。a参数可以控制窗的形状。一般a加大，
主瓣加宽，旁瓣幅度减小，典型数据为a。当α时，窗函数接近哈明窗。
a时，窗函数接近布莱克曼窗。在设计指标给定时，可以调整a值，使滤波器阶数最
低，所以其性能最优。凯塞Kaiser给出的估算β和滤波器阶数Mhn的长度NM
的公式如下：
seome a dB
dB a dB a
a
MB
式中，Bww是数字滤波器过渡带宽度。应当注意，因为式为阶数估算，
所以必须对设计结果进行检验。另外，凯塞窗函数没有独立控制通带波纹幅度，实际中通
带波纹幅度近似等于阻带波纹幅度。凯塞窗的幅度函数为
wu∑uncoscan
对α的种典型值，将凯塞窗函数的性能列于表中，供设计者参考。由表可见，当
a时，各项指标都好于哈明窗。种典型窗函数基本参数归纳在表中，可供
设计时参考。
表 凯塞窗参数对滤波器的性能影响
a 过渡带宽 通带波纹dB 阻带最小衰减dB
πN 土
πN 士
πN ±
πN 士
πN ±
πN ±
πN 士
πN ±
第章有限脉冲响应数字滤波器的设计
Created by ZhuangHeng
数字信号处理第五版
表 种窗函数的基本参数
表中过渡带宽和阻带最小衰减是用对应的窗函数设计的FIR数字滤波器的频率响应指
标。随着数字信号处理的不断发展，学者们提出的窗函数已多达几十种，除了上述种窗
函数外，比较有名的还有Chebyshev窗、Gaussian窗。MATLAB信号处理工具箱提供
了种窗函数的产生函数，下面列出上述种窗函数的产生函数及其调用格式：
wnboxcarN
wnbartlettN
wnhanningN
wnhammingN
wnblackmanN
wnkaiserNbeta
窗函数类型
旁瓣峰值
adB
过渡带宽度B 阻带最小衰减
adB 近似值 精确值
矩形窗 πN πN
三角窗 πN πN
汉宁窗 πN πN
哈明窗 πN πN
布莱克曼窗 πN πN
凯塞窗β πN
向量 wn中返回长度为N的矩形窗函数wn
向量wn中返回长度为N的三角窗函数wn
向量wn中返回长度为N的汉宁窗函数wn
向量wn中返回长度为N的哈明窗函数wn
向量wn中返回长度为N的布莱克曼窗函数wn
向量wn中返回长度为N的凯塞一贝塞尔窗函数wn
用窗函数法设计FIR滤波器的步骤
用窗函数法设计FIR滤波器的步骤如下：
根据对阻带衰减及过渡带的指标要求，选择窗函数的类型，并估计窗口长度N。先
按照阻带衰减选择窗函数类型。原则是在保证阻带衰减满足要求的情况下，尽量选择主瓣
窄的窗函数。然后根据过渡带宽度估计窗口长度N。待求滤波器的过渡带宽度B近似等于
窗函数主瓣宽度，且近似与窗口长度N成反比，N≈ABA取决于窗口类型，例如，矩
形窗的Aπ哈明窗的Aπ等，参数A的近似和精确取值参考表。
构造希望逼近的频率响应函数He即
HeHweND
所谓的“标准窗函数法”就是选择He为线性相位理想滤波器理想低通、理想高
通、理想带通、理想带阻。以低通滤波器为例，Hgw应满足：
l Ha
由图知道，理想滤波器的截止频率w。近似位于最终设计的FIRDF的过渡带的
中心频率点，幅度函数衰减一半约 dB。所以如果设计指标给定通带边界频率和阻带
Created by ZhuangHeng
边界频率w和w一般取
计算hn。如果给出待求滤波器的频响函数为He那么单位脉冲响应用下
式求出：
hanHeed
如果He较复杂，或者不能用封闭公式表示，则不能用上式求出hn。我们可以对
He”从w到wπ采样M点，采样值为HMkHek…M进行
M点IDFTIFFT得到：
hanIDFTHakM
根据频域采样理论，han与han应满足如下关系：
haun∑hnMRxn
因此，如果M选得较大，可以保证在窗口内haun有效逼近hn。
对式给出的线性相位理想低通滤波器作为He由式求出单位脉
冲响应han
hansinr
为保证线性相位特性，aN。
加窗得到设计结果：hnh。nwn。
【例】 用窗函数法设计线性相位高通FIRDF要求通带截止频率π rad
阻带截止频率wπ rad通带最大衰减a dB阻带最小衰减a dB。
解选择窗函数wn计算窗函数长度N。已知阻带最小衰减a dB由表
可知汉宁窗和哈明窗均满足要求，我们选择汉宁窗。本例中过渡带宽度B≤wpw
π汉宁窗的精确过渡带宽度BπN所以要求BπN≤π解之得
N≥。对高通滤波器N必须取奇数，取N。由式有
uncosRsn
构造He
HCl
式中 N
求出han
hanHeedo
第章有限脉冲响应数字滤波器的设计
Created by ZhuangHeng
口
口□
口口
口
数字信号处理第五版
去cdccd
sincnsin
将r代入得
hnnsinn
sinBcn δn对应全通滤波器， 是截止频率为π的理想低通滤波器的单位
脉冲响应，二者之差就是理想高通滤波器的单位脉冲响应。这就是求理想高通滤波器的单
位脉冲响应的另一个公式。
加窗：
hnhnwn
onsincancos婴Ran
窗函数法的MATLAB设计函数简介
实际设计时一般用MATLAB工具箱函数。可调用工具箱函数 firl实现窗函数法设计
步骤～的解题过程。
firl是用窗函数法设计线性相位FIR数字滤波器的工具箱函数，实现线性相位
FIR数字滤波器的标准窗函数法设计。这里的所谓“标准”是指在设计低通、高通、带通和
带阻FIR滤波器时，Hae分别表示相应的线性相位理想低通、高通、带通和带阻滤波器
的频率响应函数。因而将所设计的滤波器的频率响应称为标准频率响应。
firl的调用格式及功能：
·hnfirlMwc返回dB截止频率为we的M阶单位脉冲响应hn长度N
MFIR低通wc为标量滤波器系数向量hn默认选用哈明窗。滤波器单位脉冲响应
hn与向量hn的关系为
hnhnnn…M
而且满足线性相位条件：hnhNn。其中we为对π归一化的数字频率，
≤we≤。
当wewelwcu时，得到的是带通滤波器，其 dB通带为wel≤w≤wcu。
·hnfirlMweftype可设计高通和带阻FIR滤波器。当ftypehigh时，设计
高通FIR滤波器；当ftypestop且wcwelwcu时，设计带阻FIR滤波器。
应当注意，在设计高通和带阻FIR滤波器时，阶数M只能取偶数hn长度NM
为奇数。不过，当用户将M设置为奇数时，fir会自动对M加。
·hnfirlMwewindow可以指定窗函数向量window。如果缺省 window 参数，
则firl默认为哈明窗。例如：
Created by ZhuangHeng
hnfirMwebartlettM使用Bartlett 窗设计；
hnfirlMweblackmanM使用blackman 窗设计；
hnfirlMwcftypewindow通过选择 wc、ftype和window 参数含义同上
可以设计各种加窗滤波器。
fir为任意形状幅度特性的窗函数法设计函数，用fir设计时，可以指定任意形状
的He它实质是一种频率采样法与窗函数法的综合设计函数。主要用于设计幅度特性
形状特殊的滤波器如数字微分器和多带滤波器等。用help命令查阅其调用格式及调用参
数的含义。
例的设计程序epm如下：
m例用窗函数法设计线性相位高通FIR数字滤波器
wppiwspi
算过渡带宽度 Btwpws
据表汉宁窗计算所需hn长度NOceilx取大于等于 NOceilpiBt
的最小整数
保hn长度N是奇数 NNOmodN
算理想高通滤波器通带截止频率关于π归一化 wewpwspi
hnfirlNwehighhanningN用 firl计算高通 FIR数字滤波器的hn
去绘图部分
运行程序得到hn的个值：
hn
高通FIR 数字滤波器的hn及损耗函数如图所示。
oF
是
gNo
A
n π
ahn波形 b损耗函数曲线 第章有限脉冲响应数字滤波器的设计
图 高通FIR数字滤波器的hn波形及损耗函数曲线
【例】 对模拟信号进行低通滤波处理，要求通带≤f≤kHz内衰减小于
dB阻带kHz≤f≤上衰减大于dB。希望对模拟信号采样后用线性相位FIR数
字滤波器实现上述滤波，采样频率F kHz。用窗函数法设计满足要求的FIR 数字低通
Created by ZhuangHeng
数字信号处理第五版
滤波器，求出hn并画出损耗函数曲线。为了降低运算量，希望滤波器阶数尽量低。
解确定相应的数字滤波器指标：
通带截止频率为
m×π
阻带截止频率为
π×m
阻带最小衰减为
a dB
用窗函数法设计FIR 数字低通滤波器，为了降低阶数选择凯塞窗。根据式
计算凯塞窗的控制参数为
aa°a
指标要求过渡带宽度Bwwπ根据式计算滤波器阶数为
MB×π
取满足要求的最小整数M。所以hn长度为NM。但是，如果用汉宁窗，
hn长度为N。理想低通滤波器的通带截止频率www。π所以由式
和式得到：
hnhanunsinlonun rN
式中，wn是长度为α的凯塞窗函数。
实现本例设计的MATLAB程序为epm。
m例用凯塞窗函数设计线性相位低通 FIR数字滤波器
fpfsrs
wppifpFswspifsFs
Btwswp 算过渡带宽度
alphrsrs据式计算kaiser窗的控制参数α
MceilrsBt据式计算kaiser 窗所需阶数M
wcwpwspi算理想高通滤波器通带截止频率关于π归一化
hnfirlMwekaiserMalph用 firl计算低通 FIRDF的hn
下绘图部分省去
运行程序得到hn的个值：
hn
低通FIR数字滤波器的hn波形和损耗函数曲线如图所示。
Created by ZhuangHeng
o
是
Hoor
w
ahn波形 b损耗函数曲线
图 低通FIR 数字滤波器的hn波形及损耗函数曲线
【例】 用窗函数法设计一个线性相位FIR带阻滤波器。要求通带下截止频率
oπ阻带下截止频率wπ阻带上截止频率wmπ通带上截止频率
π通带最大衰减ap dB阻带最小衰减a dB。
解 本例直接调用firl 函数设计。因为阻带最小衰减a dB所以选择布莱克曼
窗，再根据过渡带宽度选择滤波器长度N布莱克曼窗的过渡带宽度BπN所以
x≤upπππ
解之得N。调用参数
设计程序为epm参数计算也由程序完成。
m例用窗函数法设计线性相位带阻FIR数字滤波器
wlppiwlspiwuspiwuppi计指标参数赋值
渡带宽度 Bwlswlp
MceilpiB 算阶数M ceilx为大于等于x的最小整数
wpwlswlppiwuswuppi置理想带阻截止频率
hnfirlMwpstopblackmanM阻滤波器要求hn长度为奇数，firl会自动处理
略绘图部分
程序运行结果：
N
由于hn数据量太大，因而仅给出hn的波形及损耗函数曲线，如图所示。
加m
oF
Ho
n oπ
ahn波形 b损耗函数曲线
图 带阻FIR 数字滤波器的hn波形及损耗函数曲线
第章有限脉冲响应数字滤波器的设计
Created by ZhuangHeng
数字信号处理第五版
由图可见，阻带衰减有较大的富余。如果选用凯塞窗设计，滤波器长度N就可以满足
设计指标。由此可以看出凯塞窗函数的显著优点。
利用频率采样法设计FIR滤波器
用频率采样法设计FIR滤波器的基本思想
设希望逼近的滤波器的频响函数用He表示，对He在w到π之间等间隔
采样N点，得到Hk
HkHe k…N
再对Hk进行N点IDFT得到hn
h六HAWn…N
将hn作为所设计的FIR 滤波器的单位脉冲响应，其系统函数Hz为
Hhn
另外根据频率域采样理论，利用频率域采样值恢复原信号Z变换的和式，
得到Hz的内插表示形式：
HIHwk
此式就是直接利用频率采样值Hk形成滤波器的系统函数，式适合FIR 直接型
网络结构，式适合频率采样结构。下面讨论两个问题：一个是为了设计线性相位
FIR滤波器，频域采样序列Hk应满足的条件；另一个是逼近误差问题及其改进措施。
设计线性相位滤波器时对Hk的约束条件
FIR 滤波器具有线性相位的条件是hn为实序列，且满足hnhNn在此
基础上我们已推导出其频响函数应满足的条件是：
HeHoe
mN
HwHπwN奇数
HaHπaN偶数
在wπ区间上N个等间隔的采样频点为
k…N
将ww代入～式中，并写成k的函数：
HkHke
kNkNk
Created by ZhuangHeng
HkHNkN奇数
HkHNkN偶数
～式就是对频率采样值的约束条件。式说明，N等于奇数时
Hk关于N点偶对称。式说明，N等于偶数时，Hk关于N点奇对称，
且HN。
设用理想低通作为希望逼近的滤波器He截止频率为w采样点数为NHk
和θk用下列公式计算：
N奇数时，
Nk k…k
BAkkk
k …N
N偶数时，
A
上面公式中的k。是通带内最后一个采样点的序号，所以k。的值取不大于wNπ的最
大整数。另外，本节设计的是第一类线性相位FIR滤波器，所以，对于高通和带阻滤波器，
N只能取奇数。
逼近误差及其改进措施
如果待逼近的滤波器为He对应的单位脉冲响应为hn则由频率域采样定理
知道，在频域π范围等间隔采样N点，利用IDFT得到的hn应是han以N为周期
的周期延拓的主值区序列，即
hn∑hanmNRxn
如果He有间断点，那么相应的单位脉冲响应hn应是无限长的。这样，由于时域混
叠及截断，使hn与han有偏差。所以，频域的采样点数N愈大，时域混叠愈小，设计出
的滤波器频响特性愈逼近He。
上面是从时域分析其设计误差的来源，下面从频域分析。频域采样定理表明，频率
域等间隔采样Hk经过IDFT得到hn由和式，得到He
FThn的内插表示形式：
HeHkom
第章有限脉冲响应数字滤波器的设计
式中
Created by ZhuangHeng
口
口
口口
n
数字信号处理第五版
msincuN。
上式表明，在采样频点，wπkNk…NΦwπkN因此采样点
处He”与Hk相等，逼近误差为。在采样点之间，He由N项HkφwπkN之
和形成。频域幅度采样序列Hk及其内插波形 Hw如图所示。图a中，实
线表示希望逼近的理想幅度函数Hw黑点表示幅度采样序列Hk图b中，实
线Hco与虚线Hw的误差与Hw特性的平滑程度有关，Hw特性愈平滑的区域，误
差愈小；特性曲线间断点处，误差最大。表现形式为间断点变成倾斜下降的过渡带曲线，过渡
带宽度近似为πN。通带和阻带内产生震荡波纹，且间断点附近振荡幅度最大，使阻带衰减
减小，往往不能满足技术要求。当然，增加N可以使过渡带变窄，但是通带最大衰减和阻带
最小衰减随N的增大并无明显改善。且N太大，会增加滤波器的阶数，即增加了运算量和成
本。N和N两种情况下的幅度内插波形 Hw如图所示，图中的空心圆和实
心圆点分别表示N和N时的频域幅度采样。运行本书程序库程序figm即可
绘制出图和图并分别输出两种采样点数N和N的通带最大衰减a。和阻
带最小衰减α。N时，通带最大衰减a dB阻带最小衰减a dB
N时，通带最大衰减a dB阻带最小衰减a dB。所以，直接对理想滤
波器的频率响应采样的“基本频率采样设计法”不能满足一般工程对阻带衰减的要求。
Hk
o月
wπ
wπ
图 频域幅度采样序列Hk及其内插波形Hw
a
b
Created by ZhuangHeng
月
wπ
图 N和N的幅度内插波形Ha
在窗函数设计法中，通过加大过渡带宽度换取阻带衰减的增加。频率采样法同样满足
这一规律。提高阻带衰减的具体方法是在频响间断点附近区间内插一个或几个过渡采样
点，使不连续点变成缓慢过渡带，这样，虽然加大了过渡带，但阻带中相邻内插函数的旁瓣
正负对消，明显增大了阻带衰减。
过渡带采样点的个数与阻带最小衰减a。的关系以及使阻带最小衰减α最大化的每个
过渡带采样值求解都要用优化算法解决。其基本思想是将过渡带采样值设为自由量，用一
种优化算法如线性规划算法改变它们，最终使阻带最小衰减α最大。该内容已超出本书
要求。为了说明这种优化的有效性和上述改进措施的正确性，例中，运行程序时，采
用累试法得到满足指标要求的过渡带采样值。
将过渡带采样点的个数m与滤波器阻带最小衰减α的经验数据列于表中，我们
可以根据给定的阻带最小衰减α选择过渡带采样点的个数m。
表 过渡带采样点的个数m与滤波器阻带最小衰减α的经验数据
m
a dB dB ～ dB
频率采样法设计步骤
综上所述，可归纳出频率采样法的设计步骤：
根据阻带最小衰减a。选择过渡带采样点的个数m。
确定过渡带宽度B估算频域采样点数即滤波器长度N。如果增加m个过渡带
采样点，则过渡带宽度近似变成mπN。当N确定时，m越大，过渡带越宽。如果给
定过渡带宽度B则要求mπN≤B滤波器长度N必须满足如下估算公式：
第章有限脉冲响应数字滤波器的设计
N≥mD管
构造一个希望逼近的频率响应函数：
HeHweN
设计标准型片段常数特性的FIR数字滤波器时，一般构造幅度特性函数Hw为相应的
Created by ZhuangHeng
数字信号处理第五版
理想频响特性，且满足表要求的对称性。
按照式进行频域采样：
HkHeLHke k…N
HkH k…N
并加入过渡带采样。过渡带采样值可以设置为经验值，或用累试法确定，也可以采用优化
算法估算。
对Hk进行N点IDFT得到第一类线性相位FIR数字滤波器的单位脉冲响应：
hnIDFTHk六≥HkWn…N
检验设计结果。如果阻带最小衰减未达到指标要求，则要改变过渡带采样值，直到
满足指标要求为止。如果滤波器边界频率未达到指标要求，则要微调Hw的边界频率。
上述设计过程中的计算相当烦琐，所以通常借助计算机设计。MATLAB就是一种很
有效的语言。
【例】 用频率采样法设计第一类线性相位低通FIR数字滤波器，要求通带截止
频率wπ阻带最小衰减大于 dB过渡带宽度B≤π。
解 查表a dB时，过渡带采样点数m。将m和B≤π代人
式估算滤波器长度：N≥mπB留一点富余量，取N。构造He
HweND为理想低通特性，其幅度响应函数Ha如图a中实线所示。
设计由以下程序epm完成：
m用频率采样法设计FIR低通滤波器
TinputT 入过渡带采样值T
Btpiwppi 渡带宽度为pi通带截止频率为pi
mNceilmpiBt 式估算采样点数N
N为奇数 NNmodN
为通带wp上采样点数 NpfixwppiN
为阻带wp×piwp上采样点数 NsNNp
HkonesNpzerosNsonesNp
为奇数，幅度采样向量偶对称AkANk
HkNpTHkNNpT 一个过渡采样
位采样向量θkNπkN≤k≤N thetakpiNNN
HdkHkexpGjthetak 造频域采样向量Hdk
hnrealifftHdk nIDFTHkreal只取实部，忽略计算误差引起的虚部
Hwffthn 算频率响应函数：DFThn
wkpix
HgwHwexpG·wkN算幅度响应函数HgmHe·e
算通带最大衰减Rp和阻带最小衰减Rs
RpmaxlogabsHgw
Created by ZhuangHeng
hgminminrealHgwRslogabshgmin
下绘图部分略去
运行程序，输入T得到设计结果如图所示，并输出通带最大衰减a
dB阻带最小衰减α。 dB。但是，如果过渡带采样值T和则
得到阻带最小衰减a dB和 dB。由此可见，当过渡带采样点数给定
时，过渡带采样值不同，则逼近误差不同。所以，对过渡带采样值进行优化设计才是有效的
方法。
H a
π
州用 b
F
Noo
c
l
oπ
图 一个过渡点的设计结果过渡带采样值T
MATLAB信号处理工具箱函数fir是一种频率采样法与窗函数法相结合的FIR 数字
滤波器设计函数。
hn firMFAwindowM设计一个M阶线性相位FIR数字滤波器，返回长
度为NM的单位脉冲响应序列向量hn。window表示窗函数名，缺省该项时默认选用
Hamming窗。可供选择的窗函数有Boxcar、Bartlett、Hann、Hamm、Blackman、Kaiser和
Chebwin。当windowboxcar时，fir就是纯粹的频率采样设计法。希望逼近的幅度特性由边
界频率向量F和相应的幅度向量A确定，plotFA画出的就是希望逼近的幅度特性曲线。
F为对π归一化的数字频率向量，≤F≤。而且F的元素必须是单调递增的，以开始，
以结束，对应于模拟频率Fs。对例FwppiwppiNwppiN
第章有限脉冲响应数字滤波器的设计
AT。其中，wepiN为过渡带采样点频率，T为过渡带采样值。
Created by ZhuangHeng
口
口
口口
口
口口
口口
口
口
数字信号处理第五版
plotFA画出的就是希望逼近的幅度特性曲线，如图所示。调用fir求解例
的程序为epbm。与程序epm比较，epbm更加简单。
日。or
π
图 例希望逼近的幅度特性T
应当注意，用Fir设计FIR数字滤波器时，应当灵活利用其频率采样法与窗函数法相
结合的特性，既可以采用优化过渡带采样，设计希望逼近的幅度特性，来控制阻带最小衰
减程序epbm中采用这种方法又可以不加过渡带采样，通过选用合适的窗函数来
控制阻带最小衰减。但优化过渡带采样可以使滤波器阶数更低。
用 fir求解例的程序epbm
TinputT 入过渡采样值T
渡带宽度pi通带截止频率为pi Btpiwppi
m 渡点个数m
Nceilm·piBt 式估算采样点数N
FwppiwppiNwppiNAT置调用参数向量F和A
hnfirNFAboxcarN用矩形窗函数
以下与epm相同省略。
窗函数设计法和频率采样法简单方便，易于实现。但它们存在以下缺点：①滤波器边
界频率不易精确控制。②窗函数设计法总使通带和阻带波纹幅度相等，频率采样法只能依
靠优化过渡带采样点的取值控制阻带波纹幅度，所以两种方法都不能分别控制通带和阻带
波纹幅度。但是工程上对二者的要求是不同的，希望能分别控制。③所设计的滤波器在阻
带边界频率附近的衰减最小，距阻带边界频率越远，衰减越大。所以，如果在阻带边界频率
附近的衰减刚好达到设计指标要求，则阻带中其他频段的衰减就有很大富余量。这就说明
这两种设计法存在较大的资源浪费，或者说所设计滤波器的性能价格比低。下一节介绍一
种能克服上述缺点的最优逼近设计方法。
利用等波纹最佳逼近法设计FIR数字滤波器
等波纹最佳逼近法是一种优化设计法，它克服了窗函数设计法和频率采样法的缺点，
使最大误差即波纹的峰值最小化，并在整个逼近频段上均匀分布。用等波纹最佳逼近法
设计的FIR数字滤波器的幅频响应在通带和阻带都是等波纹的，而且可以分别控制通带和
阻带波纹幅度。这就是等波纹的含义。最佳逼近是指在滤波器长度给定的条件下，使加权
Created by ZhuangHeng
误差波纹幅度最小化。与窗函数设计法和频率采样法比较，由于这种设计法使最大误差均
匀分布，所以设计的滤波器性能价格比最高。阶数相同时，这种设计法使滤波器的最大逼
近误差最小，即通带最大衰减最小，阻带最小衰减最大；指标相同时，这种设计法使滤波器
阶数最低。
等波纹最佳逼近设计法的数学证明复杂，已超出本科生的数学基础。所以本节略去等
波纹最佳逼近法复杂的数学推导，只介绍其基本思想和实现线性相位FIR数字滤波器的等
波纹最佳逼近设计的MATLAB信号处理工具箱函数 remez和 remezord remez函数采用
数值分析中的remez多重交换迭代算法求解等波纹最佳逼近问题，求得满足等波纹最佳逼
近准则的FIR数字滤波器的单位脉冲响应hn。由于切比雪夫Chebyshev和雷米兹
Remez对解决该问题做出了贡献，所以又称之为切比雪夫逼近法，或雷米兹逼近法。
等波纹最佳逼近法的基本思想
用Hw表示希望逼近的幅度特性函数，要求设计线性相位FIR数字滤波器时，
Hw必须满足线性相位约束条件。用Ho表示实际设计的滤波器幅度特性函数。定义
加权误差函数Ew为
EwWwHwHw
式中，Ww称为误差加权函数，用来控制不同频段一般指通带和阻带的逼近精度。等波
纹最佳逼近基于切比雪夫逼近，在通带和阻带以Ew的最大值最小化为准则，采用
Remez多重交换迭代算法求解滤波器系数hn。所以Ww取值越大的频段，逼近精度
越高，开始设计时应根据逼近精度要求确定Ww在Remez多重交换迭代过程中Ww是
确知函数。
等波纹最佳逼近设计中，把数字频段分为“逼近或研究区域”和“无关区域”。逼近区
域一般指通带和阻带，而无关区域一般指过渡带。设计过程中只考虑对逼近区域的最佳逼
近。应当注意，无关区宽度不能为零，即Hw不能是理想滤波特性。
利用等波纹最佳逼近准则设计线性相位FIR数字滤波器数学模型的建立及其求解算法
的推导复杂，求解计算必须借助计算机，幸好滤波器设计专家已经开发出MATLAB信号
处理工具箱函数 remezord和remez只要简单地调用这两个函数就可以完成线性相位FIR
数字滤波器的等波纹最佳逼近设计。
在介绍MATLAB工具箱函数 remezord和 remez之前，先介绍等波纹滤波器的技术指
标及其描述参数。
图给出了等波纹滤波器技术指标的两种描述参数。图a用损耗函数描
第章有限脉冲响应数字滤波器的设计
述，即w。πa dBwπa dB。这是工程实际中常用的指标描述方法。
但是，用等波纹最佳逼近设计法求滤波器阶数N和误差加权函数Ww时，要求给出滤波
器通带和阻带的振荡波纹幅度δ和δ。图b给出了用通带和阻带的振荡波纹幅度
δ和δ。描述的技术指标。显然，两种描述参数之间可以换算。如果设计指标以ap和a给
出，为了调用MATLAB工具箱函数 remezord和 remez进行设计，就必须由ap和a换算
Created by ZhuangHeng
出通带和阻带的振荡波纹幅度δ和δ。对比图a和b得出关系式：
gig
agilgo
由式和得到
按照式和计算得到图b中的参数：δ。实际中，
δ和δ一般很小，这里为了观察等波纹特性及参数δ和δ的含义，特意取较大值。
口
数字信号处理第五版
无关区 gHo
oH 无关区
δ
l 以a π
以
a
wm
b
图 等波纹滤波器的幅频特性函数曲线及指标参数
下面举例说明误差加权函数Ww的作用，以及滤波器hn长度N和波纹幅度和
的制约关系。设期望逼近的通带和阻带分别为π和ππ对下面四种不同
的控制参数，等波纹最佳逼近的损耗函数曲线分别如图a、b、c和d所示。图
中，Www表示第一个逼近区π上的误差加权函数Www第二个逼近
区ππ上的误差加权函数Www。图a中，通带频段π上的
Ww阻带频段ππ上的Ww。
比较图a、b、c和d可以得出结论：当N一定时，误差加权函数Ww较
大的频带逼近精度较高，Ww较小的频带逼近精度较低，如果改变Ww使通阻带逼近
精度提高，则必然使阻通带逼近精度降低。滤波器阶数N增大才能使通带和阻带逼近精
度同时提高。所以，Ww和N由滤波器设计指标即ap和a以及过渡带宽度确定。所以
用等波纹最佳逼近法设计FIR数字滤波器的过程是：
根据给定的逼近指标估算滤波器阶数N和误差加权函数Ww
采用remez算法得到滤波器单位脉冲响应hn。
MATLAB工具箱函数 remezord和 remez就是完成以上个设计步骤的有效函数。
Created by ZhuangHeng
l
gHo
gHo
l L
oπ oπ
aNW bNW
ol
gHon
F
l L
oπ aπ
cNW dNW
图 误差加权函数Wa和滤波器阶数N对逼近精度的影响
remez和 remezord函数及滤波器设计指标
remez和 remezord 函数
remez
remez函数实现线性相位FIR数字滤波器的等波纹最佳逼近设计。其调用格式为
hnremezMfmw
调用结果返回单位脉冲响应向量hn。remez 函数的调用参数Mfmw一般通过调用
remezord 函数来计算。调用参数含义如下：
M为FIR 数字滤波器阶数，hn长度NM。
f和m给出希望逼近的幅度特性。f为边界频率向量，≤f≤要求f为单调增向量
即fkfkk…而且从开始，以结束，对应数字频率wπ模拟频
第章有限脉冲响应数字滤波器的设计
率FF表示时域采样频率。m是与f对应的幅度向量，m与f长度相等，mk表示频
点fk的幅度响应值。如果用命令Plotfm画出幅频响应曲线，则k为奇数时，频段
fkfk上的幅频响应就是期望逼近的幅频响应值，频段fkfk为无
关区。简言之，Plotfm命令画出的幅频响应曲线中，起始频段为第一段，奇数频段为逼
近区，偶数频段为无关区。
Created by ZhuangHeng
口
口
口
口口
口口
口口
a口
数字信号处理第五版
例如，对图fmplotfm画出的幅度特
性曲线如图所示，图中奇数段第一、三段的水平幅度为希望逼近的幅度特性，偶
数段第二段的下降斜线为无关部分，逼近时形成过渡带，并不考虑该频段的幅频响应
形状。
w为误差加权向量，其长度为f的一半。wi表示对m中第i个逼近频段的误差加权
值。图a中，w。缺省w时，默认w为全即每个逼近频段的误差加权值
相同。除了设计选频FIR数字滤波器，remez 函数还可以设计两种特殊滤波器：希尔伯特
变换器和数字微分器，调用格式分别为
hnremezMfmwhilbert
hnremezMfmwdefferentiator
希尔伯特变换器和数字微分器设计和应用的详细内容请参考文献。
remezord
采用 remezord 函数，可根据逼近指标估算等波纹最佳逼近FIR 数字滤波器的最低阶
数M、误差加权向量w和归一化边界频率向量f使滤波器在满足指标的前提下造价最低。
其返回参数作为 remez函数的调用参数。其调用格式为
MfomowremezordfmripFs
参数说明：
f与remez中的类似，这里f可以是模拟频率单位为Hz或归一化数字频率，但必须
从开始，到Fs用归一化频率时对应结束，而且其中省略了和Fs两个频点。Fs
为采样频率，缺省时默认FsHz。但是这里f的长度包括省略的和Fs两个频点是
m的两倍，即m中的每个元素表示f给定的一个逼近频段上希望逼近的幅度值。例如，对
图fm。
E
L
f
图 希望逼近的幅度特性曲线
注意：①省略Fs时，f中必须为归一化频率。②有时估算的阶数M略小，使设计结果
达不到指标要求，这时要取M或M必须注意对滤波器长度NM的奇偶性要
求。所以必须检验设计结果。③如果无关区过渡带太窄，或截止频率太接近零频率和
Fs时，设计结果可能不正确。
rip 表示f和m描述的各逼近频段允许的波纹幅度幅频响应最大偏差f的长度是
rip的两倍。
一般以NfomowremezordfmripFs返回的参数作为 remez的调用参数，
Created by ZhuangHeng
计算单位脉冲响应：hnremezNfomow。对比前面介绍的 remez调用参数，可清楚
地看出 remezord返回参数N、fo、mo和w的含义。
综上所述，调用 remez和 remezord 函数设计线性相位FIR数字滤波器，关键是根据设
计指标求出 remezord函数的调用参数f、m、rip和Fs其中Fs一般是题目给定的，或根据
实际信号处理要求按照采样定理确定。下面给出由给定的各种滤波器设计指标确定
remezord调用参数f、m和 rip的公式，编程时直接套用即可。
滤波器设计指标
低通滤波器设计指标
逼近通带：wp通带最大衰减：adB逼近阻带：wπ阻带最小衰减：adB。
remezord调用参数：
f一mripioz
其中，f向量省去了起点频率和终点频率δ和分别为通带和阻带波纹幅度，由式
和计算得到，下面相同。
高通滤波器设计指标
逼近通带：w。π通带最大衰减：adB逼近阻带：w阻带最小衰减：adB。
remezord调用参数：
fmripzoi
带通滤波器设计指标
逼近通带：wwm通带最大衰减：adB逼近阻带：wawπ阻带最小
衰减：adB。
remezord调用参数：
fmripi
带阻滤波器设计指标
逼近阻带：ww阻带最小衰减：adB逼近通带：awπ通带最大
衰减：apdB。
remezord调用参数：
rmripoibi
工程实际中常常给出对模拟信号的滤波指标要求，设计数字滤波器，对输入模拟信号采样
后进行数字滤波。这时，调用参数f可以用模拟频率表示。但是，调用 remezord时一定要
加入采样频率参数Fs。这种情况的调用参数及调用格式见例。
【例】 利用等波纹最佳逼近法重新设计FIR 带阻滤波器。指标与例相
同，即
逼近通带：πππ通带最大衰减：a dB
第章有限脉冲响应数字滤波器的设计
Created by ZhuangHeng
口
口
口
口口
口口do■国
口
数字信号处理第五版
逼近阻带：ππ阻带最小衰减：a dB
解 调用 remezord和 remez函数求解。由调用格式知道，首先要根据设计指标确定
remezord函数的调用参数，再直接编写程序调用 remezord和remez 函数设计得到hn。
将设计指标带入式即可得到remezord函数的调用参数f、m和 rip。
本例设计程序为epm即
m例用remez函数设计带阻滤波器
f略了和
m
rpIrs
式和式求通带和阻带波纹幅度 datl、dat和 rip
datlrprpdatrsripdatdatdat
Mfomowremezordfm rip
hnremezMfomow
下绘图检验部分略去
程序运行结果：M。即hn的长度N。hn及其损耗函数曲线如图所示。
例中N。由此例可见，等波纹最佳逼近设计方法可以使滤波器阶数大大降低。
是 幅度dB
L
L
oπ
a b
图 调用remez 函数设计的带阻 FIR数字滤波器的hn及损耗函数曲线
注意：设计结果应当是单位脉冲响应hn的数据序列，但是一般N较大，列出hn的
全部数据序列所占篇幅太大，而且从一大堆数据中看不出hn的变化规律，所以每道例题
只给出其波形。读者运行程序就可以得到hn的数据。
【例】 利用等波纹最佳逼近法设计FIR数字低通滤波器，实现对模拟信号的数
字滤波处理。要求与例相同。求出hn并画出损耗函数曲线。
解 将例中所给指标重写如下：
通带截止频率：f Hz通带最大衰减：ap dB
阻带截止频率：f Hz阻带最小衰减：a dB
对模拟信号的采样频率：F kHz
调用 remezord和remez函数设计的程序为epm即
m例用remez函数设计低通滤波器
Created by ZhuangHeng
Fs 模拟信号采样的频率为kHz
f 界频率为模拟频率Hz
m
rprs
datlrprpdatrs
ripdatldat
MfomowremezordfmripFs界频率为模拟频率Hz时必须加入采样频率Fs
MM算的M值达不到要求，加后满足要求
hnremezMfomow
下绘图检验部分省略
运行结果：滤波器阶数M。hn及损耗函数曲线如图所示。请读者注意，例
中用窗函数设计的滤波器阶数为。
是 幅度dB ——
咔 ——
L
A π
a b
图 调用 remez函数设计的低通FIR数字滤波器的hn及损耗函数曲线
IIR和FIR数字滤波器的比较
前面我们讨论了IIR和FIR两种滤波器的设计方法。这两种滤波器究竟各自有什么特
点在实际运用时应该怎样去选择它们呢为了回答这个问题，下面对这两种滤波器作一
简单的比较。
首先，从性能上来说，IIR滤波器系统函数的极点可位于单位圆内的任何地方，因此零
点和极点相结合，可用较低的阶数获得较高的选择性，所用的存储单元少，计算量小，所以
经济高效。但是这个高效率是以相位的非线性为代价的。相反，FIR滤波器却可以得到严
格的线性相位，然而由于FIR滤波器系统函数的极点固定在原点，因而只能用较高的阶数
即较多的零点达到高的选择性；对于同样的滤波器幅频特性指标，FIR滤波器所要求的
阶数一般比IIR滤波器高～倍，使成本较高，信号延时也较大；如果按相同的选择性和
相同的线性相位要求来说，则IIR滤波器就必须加全通网络进行相位校正，同样要大大增
加滤波器的阶数和复杂性。
第章有限脉冲响应数字滤波器的设计
从结构上看，IIR滤波器必须采用递归结构，极点位置必须在单位圆内，否则系统将不
Created by ZhuangHeng
口口
口
□
数字信号处理第五版
稳定。另外，在这种结构中，由于运算过程中对序列的舍入处理，这种有限字长效应有时会
引起寄生振荡。相反，FIR滤波器主要采用非递归结构，不论在理论上还是在实际的有限
精度运算中都不存在稳定性问题，运算误差引起的输出信号噪声功率也较小。此外，FIR
滤波器可以采用FFT算法实现，在相同阶数的条件下，运算速度可以大大提高。
从设计工具看，IIR滤波器可以借助成熟模拟滤波器设计成果，因此一般都有封闭形
式的设计公式可供准确计算，计算工作量比较小，对计算工具的要求不高。FIR滤波器计
算通带和阻带衰减等仍无显式表达式，其边界频率也不易精确控制。一般，FIR滤波器的
设计只有计算程序可循，因此对计算工具要求较高。但在计算机普及的今天，很容易实现
其设计计算。
另外，也应看到，IIR滤波器虽然设计简单，但主要是用于设计具有片段常数特性的选
频型滤波器，如低通、高通、带通及带阻等，往往脱离不了几种典型模拟滤波器的频响特性
的约束。而FIR 滤波器则要灵活得多，易于适应某些特殊的应用，如构成微分器或积分器，
或用于巴特沃斯、切比雪夫等逼近不可能达到预定指标的情况，例如由于某些原因要求三
角形幅频响应或一些更复杂的幅频响应形状，因而FIR滤波器有更大的适应性和更广阔的
应用场合。
从上面的简单比较可以看到，IIR与FIR滤波器各有所长，所以在实际应用时应该全
面考虑加以选择。例如，从使用要求上看，在对相位要求不敏感的场合，如语音通信等，选
用IIR滤波器较为合适，这样可以充分发挥其经济高效的特点；而对于图像信号处理，数据
传输等以波形携带信号的系统，则对线性相位要求较高，采用FIR滤波器较好。
几种特殊类型滤波器简介
前面详细介绍了通用IIR和FIR数字滤波器的分析与设计方法，可以根据选频型滤波
器技术指标要求，用通用的设计方法设计出满足要求的滤波器。但是通用的设计方法不能
满足工程实际中的一些特殊需求。例如①梳状滤波器；②希尔伯特变换器；③数
字微分器；④全通滤波器；⑤最小相位滤波器；⑥数字谐振器；⑦正弦波发生器；⑧数
字陷波器；⑨简单整系数滤波器，等等。这些滤波器各有特点，其设计分别涉及一些特殊
的方法或理论，不能简单地用前面介绍的通用方法设计。如果用通用的滤波器设计方法设计
特殊滤波器，其结果可能复杂很多。例如，梳状滤波器的系统函数为HzZN非常简
单，但是，如果用频域最小均方误差优化设计法设计，其系统函数就可能非常复杂。
不过，这些都属于实际应用技术，掌握了滤波的概念和滤波器分析与设计理论，这些
技术都很容易掌握。而且，随着集成电路技术和计算机技术的发展，有些特殊滤波器没有
过去那么重要了。例如，简单整系数滤波器是指滤波网络中的乘法增益均为简单整数的滤
波器。其优点是避免乘法运算，缺点是只能实现选择性要求不高的简单滤波。适用于要求
处理速度快，对滤波器性能要求较低，设计与实现简单的场合。现在实现数字硬件乘法器
非常容易，速度也很快，所以很多实时处理场合可以采用滤波性能更好的滤波器代替简单
Created by ZhuangHeng
整系数滤波器。所以，这些内容不再详细叙述，感兴趣的读者请参考有关书籍文献。
滤波器分析设计工具FDATool
FDAToolFilter Design and Analysis Tool是一个功能强大的数字滤波器设计与分析
工具，它涵盖了信号处理工具箱中所有的滤波器设计方法。利用它可以方便地设计出满足
各种性能指标的滤波器，并可查看该滤波器的各种分析图形。待滤波器设计满意后，还可
以把其系数直接导出为MATLAB变量、文本文件或C语言头文件等。
在命令窗中运行FDATool启动滤波器分析设计工具，界面如图所示。
t
Np
Dne
加 上
叶
Bw
F
e
口
G ao
品 C
Am Dn m lo
Roady
n t 四
图 FDATool启动界面
FDATool的界面分上、下两个部分：上面部分显示有关滤波器的信息，下面部分用来
指定设计指标参数。下面按照滤波器的一般设计步骤对FDATool加以介绍。
在Filter type下选择滤波器类型：低通，高通，带通，带阻，微分器，Hilbert 变换
器，多带，任意频率响应，升余弦等如果安装了滤波器设计工具箱，则会有更多选项然
后在Design Method下从众多的IIR或FIR滤波器设计方法中选择一个合适的设计方法
例如，IIR 滤波器的巴特沃斯、切比雪夫、椭圆滤波器等设计方法。
第章有限脉冲响应数字幾波器的设计
在Filter Order下选择滤波器阶数，可以使用满足要求的最小滤波器阶数或直接指
定滤波器的阶数。
根据前面两步中选择的设计方法，Options下会显示与该方法对应的可调节参数。
Created by ZhuangHeng
口
口口
口口口口口n
口
数字信号处理第五版
例如选择FIR窗函数设计法时，Options 如图所示。在该面板的Window 中可选择
不同的窗函数包括自定义窗函数，或窗函数需要的参数单击View 按钮可在wvtool中
查看选中的窗函数。
Options
Scnle Dlonsband
Wrsow Kaiser
Fumcion Namei
Bet
Vlew
图 FIR 窗函数法对应的Options选项
指定设计指标：选择滤波器的类型、设计方法和滤波器阶数时，相应的设计指标及
其含义会在Filter Specifications中用图形直观地显示出来以供设计参考。这些设计指标的
具体参数需要在Frequency Specifications和Magnitude Specifications下明确指定。
例如，选择了FIR 等波纹低通最小阶数设计后的FADTool 如图所示，其
中，Filter Specifications显示了所选设计需指定的设计指标参数。即必须在Frequency
Specifications下设置频率单位归一化频率单位或Hz等、采样频率Fs、通带截止频率
Fpass和阻带截止频率Fstop在Magnitude Specifications下设置幅度单位dB或线性、
通带最大衰减Apass和阻带最小衰减Astop。
一般来说，对不同的滤波器类型和设计方法需要不同的设计参数。这些参数设置栏会自
动显示在Frequency Specifications和Magnitude Specifications中，参照Filter Specifications中
的图示，可以直观地看出这些参数的含义。
指定所有的设计指标后，单击FDATool最下面的Design Filter 按钮即可完成滤波
器设计。设计完成后Design Filter按钮变为不可用，除非再次修改了设计指标。
通过FDATool的工具条如图所示查看设计的滤波器性能。
幅频相频曲线 单位阶跃响应 滤波器信息
全屏显示分析 幅频曲线 群延时 零极点图 幅度响应估计
D日凸
显示滤波器指标 单位脉冲响应 舍入噪声功率谱
相频曲线 滤波器系数
图 FDATool的工具条
使用菜单【EditConvert】可转换当前滤波器的实现结构。所有滤波器都能在直接
I型、直接Ⅱ型、转置直接I型、转置直接Ⅱ型、状态空间模型和格形结构之间直接转换。
此外，系统安装滤波器设计工具箱后将有更多的结构形式可供转换。
使用菜单【EditConvert to Second—order Sections】或【EditConvert to Single Section】实现
滤波器级联结构与直接型结构之间的转换。
Created by ZhuangHeng
使用菜单【FileExport】可导出或保存设计结果。可以选择导出的是滤波器的系数
向量还是整个滤波器对象把设计结果导出为滤波器对象qfilt时，系统应安装有滤波器设
计工具箱可以选择把导出结果保存为MATLAB工作空间中的变量、文本文件或MAT
文件。
使用菜单【FileExport to C Header File】可以把滤波器系数保存为C语言格式的
头文件，其中系数变量的数据类型可以选择。
使用菜单【fileExport to SPtool】可以把滤波器导出到信号处理工具SPtool中。
有关SPtool的使用可参阅MATLAB帮助文件或参考文献。
使用菜单【File】中与Session有关的子菜单，可以把整个设计保存为一个fda文
件，或调入一个已有的设计文件，继续进行设计。
如果安装了其他相关组件，FDATool的菜单条上会出现【targets】项。例如安装了
MATLAB与TI CCS的连接后，该菜单下会出现【Export to Code ComposerStudiotm
IDE】子项，利用它可以把滤波器系数直接传递到TI CCS Studio或DSP的内存中。
以上介绍了FDATool启动时默认显示的滤波器设计分析界面。此外，FDATool启动
界面左下侧竖向工具栏内还有个按钮如图所示自上而下依次为；①【Simulink
模型实现】需安装DSP模块库②【设计多采样率滤波器】③【频率变换】④【量化并分
析滤波器】⑤【零极点编辑器】⑥【导入并分析滤波器】⑦【设计并分析滤波器默认】。
如果安装了滤波器设计工具箱和信号处理工具箱，单击这些按钮还可以显示其他相应的设
计分析界面。有关这方面的内容可参考文献。下面仅对【量化并分析滤波器】按钮进行
简单介绍，以便读者观察滤波器系数量化效应。
进行滤波器量化。在MATLAB环境下，运行在PC机上的滤波器都是双精度格
式即滤波器系数的数据类型为位双精度浮点制可认为没有量化误差。但在空间和能
量都十分有限的设备如手机上，系统字长较短，常常要对滤波器进行定点或浮点量化处
理。FDATool启动界面左下侧竖向工具栏内按钮④【Set Quantization Parameters】提供滤
波器量化分析的功能。下面仅对滤波器系数量化分析方法作简要介绍。按照前面的步骤设
计的滤波器系数未量化称为参考滤波器Reference Filter系数量化后的滤波器称为量
化滤波器Quantized Filter。下面主要针对定点量化介绍。
①单击该按钮，显示滤波器量化分析界面如图所示。滤波器算法Filter Arithmetic
默认双精度浮点格式DoublePrecision Floating point。这时不需要设置量化参数。
②选择Filter arithmetic为定点制，并选择滤波器系数coefficient进行位量化，
分子、分母小数部分字长选位。对设计的阶椭圆滤波器，采用级级联结构时，系数
量化前后零极点位置和频响特性曲线均无明显变化。
第章有限脉冲响应数字滤波器的设计
③使用菜单【EditConvert to Single Section】将滤波器结构转换成直接型结构。量化字
长不变，点击按钮【Apply】显示量化参数设置与量化结果界面，如图所示。由图可
见，实线所示的量化滤波器频响曲线与参考滤波器虚线偏差很大，且当前滤波器信息显
示滤波器为不稳定状态。由此直观地看出，系数量化误差对直接型结构滤波器性能的影响
Created by ZhuangHeng
口
口
■ ■
□
口口
□口口□
a口
数字信号处理第五版
Fe DeinAndyss ToolomtitedJd 同回区
Fe ArTagds ew dow
Crerd F omcn
⑥③× 日广EIA
trude Ratson
sbuchee octFom
Scre
Shctone rde
Secon
yor 相通和而貌制
sorc esper
goree a
Frrpiert
rae
poueoien tonget口 Fte hnite
Theont sTgs tor Doute peeson fosrgtot wteato
Peady
图 滤波器量化分析界面
F康er DesinkAnalysis Tool unttledida H回图
TaMo ow
D日
Cnrt Fer hlormoion
⑥四X 口贝日子厅□同◎日E
Mytue Rorpone
同者料的的
Saro Cawrtsd mwtieD
Sef
frune Ot
F Wg
F aithmeskFoedport CoethcrterotououFee Wems
固露招
困
雳圈
Coeffert word irgdke 厂Bestprecolon factonlory toe inonesrrdan
fumerte ic lere 厂scnerenmor cotioeta to tuay
rethe rae nnerar Ceso s
FDrornatr nooking
Cbmonostor r
Computng Respone done
图 量化参数设置与直接型结构系数量化结果界面
suctue pectfom
Sactont
Created by ZhuangHeng
比级联型结构大得多。
第章关于系数量化误差敏感度理论将解释这一现象。通过FDATool的工具条查看
量化前后的零极点位置如图所示。由图可见，系数量化误差使极点位置偏移很大，
更严重的是有个极点移到单位圆外，所以滤波器不稳定。
PoleZero Plot
G
卡
d
Imaginary Part
·
口 量化后零点
O参考零点
× 参考极点
量化后极点
x
×
—
Real Part
图 直接型结构系数量化前后的零极点位置
如前所述，FDATool是一个功能强大的数字滤波器设计与分析工具。SPToolSignal
Processing Tool提供了一个便于完成信号处理任务的GUI集成环境。利用它，可以从
MATLAB工作空间或从数据文件直接导入已经设计好的信号、滤波器或频谱；可以分析、
比较、聆听和输出时域信号；可以设计、分析和输出滤波器；可以完成对信号的滤波；可以
对输入、输出信号进行各种谱分析并输出分析结果，等等。所以SPTool的功能更全，可以
用于数字信号处理课程所有内容的实验。限于篇幅，本书对此不作详细介绍，请读者参阅
参考书。
习题与上机题
已知FIR滤波器的单位脉冲响应为：
hn长度N
hh
hh
hh
hn长度N
hh
hh
hh
第章有限脉冲响应数字滤波器的设计
Created by ZhuangHeng
口
数字信号处理第五版
h
试分别说明它们的幅度特性和相位特性各有什么特点。
已知第一类线性相位FIR滤波器的单位脉冲响应长度为其个频域幅度采样
值中的前个为：
HHHH～H
根据第一类线性相位FIR滤波器幅度特性Hw的特点，求其余个频域幅度采样值。
设FIR滤波器的系统函数为
Hzzzz
求出该滤波器的单位脉冲响应hn判断是否具有线性相位，求出其幅度特性函数和相位
特性函数。
用矩形窗设计线性相位低通FIR滤波，要求过渡带宽度不超过π rad。希望逼近
的理想低通滤波器频率响应函数Hae为
hCe
求出理想低通滤波器的单位脉冲响应han
求出加矩形窗设计的低通FIR滤波器的单位脉冲响应hn表达式，确定α与N之
间的关系；
简述N取奇数或偶数对滤波特性的影响。
用矩形窗设计一线性相位高通滤波器，要求过渡带宽度不超过π rad。希望逼近
的理想高通滤波器频率响应函数Hae为
He其他
求出该理想高通的单位脉冲响应han
求出加矩形窗设计的高通FIR滤波器的单位脉冲响应hn表达式，确定a与N的
关系；
N的取值有什么限制为什么
理想带通特性为
BCcokBlol
求出该理想带通的单位脉冲响应hn
写出用升余弦窗设计的滤波器的hn表达式，确定α与N之间的关系；
要求过渡带宽度不超过π rad。N的取值是否有限制为什么
试完成下面两题：
设低通滤波器的单位脉冲响应与频率响应函数分别为hn和He另一个滤波
器的单位脉冲响应为hn它与hn的关系是hnhn。试证明滤波器hn
Created by ZhuangHeng
是一个高通滤波器。
设低通滤波器的单位脉冲响应与频率响应函数分别为hn和He截止频率为
w另一个滤波器的单位脉冲响应为hn它与hn的关系是hnhncoSwn且
wwπw。试证明滤波器hn是一个带通滤波器。
题图中hn是偶对称序列，N设
HkDFThnk…N
HkDFThnk…N
试确定Hk与Hk的关系式。I HkHk是否成立为什么
用hn和hn分别构成的低通滤波器是否具有线性相位群延时为多少
hn
hn
n n
题图
对下面的每一种滤波器指标，选择满足FIRDF设计要求的窗函数类型和长度。
阻带衰减为 dB过渡带宽度为kHz采样频率为 kHz
阻带衰减为 dB过渡带宽度为kHz采样频率为 kHz
阻带衰减为 dB过渡带宽度为 Hz采样频率为kHz。
利用矩形窗、升余弦窗、改进升余弦窗和布莱克曼窗设计线性相位FIR 低通滤波
器。要求希望逼近的理想低通滤波器通带截止频率wπ radN。求出分别对应的
单位脉冲响应。
求出分别对应的单位脉冲响应hn的表达式。
用MATLAB画出损耗函数曲线。
将技术要求改为设计线性相位高通滤波器，重复题。
利用窗函数哈明窗法设计一数字微分器，逼近题图所示的理想微分器特性，
并绘出其幅频特性。
IHo
π
π π
题图
用窗函数法设计一个线性相位低通FIRDF要求通带截止频率为π rad过渡带
宽度为π rad阻带最小衰减为 dB。
选择合适的窗函数及其长度，求出hn的表达式。
°用MATLAB画出损耗函数曲线和相频特性曲线。
第章有限脉冲响应数字滤波器的设计
Created by ZhuangHeng
口
口口
口口
口口
口口
口
数字信号处理第五版
要求用数字低通滤波器对模拟信号进行滤波，要求：通带截止频率为 kHz阻
带截止频率为 kHz阻带最小衰减为 dB采样频率为F kHz。用窗函数法设计
数字低通滤波器。
选择合适的窗函数及其长度，求出hn的表达式。
用MATLAB画出损耗函数曲线和相频特性曲线。
利用频率采样法设计线性相位FIR低通滤波器，给定N通带截止频率w
π rad。求出hn。为了改善其频率响应过渡带宽度、阻带最小衰减应采取什么
措施
重复题但改为用矩形窗函数法设计。将设计结果与题进行比较。
利用频率采样法设计线性相位FIR低通滤波器，设N给定希望逼近的滤波
器的幅度采样值为
k k
k
利用频率采样法设计线性相位FIR带通滤波器，设N理想幅度特性Hw
如题图所示。
Hm
ππ π π 其o
题图
设信号xtstvt其中vt是干扰，st与vt的频谱不混叠，其幅度谱
如题图所示。要求设计数字滤波器，将干扰滤除，指标是允许SD在≤f≤ kHz
频率范围中幅度失真不超过±f kHz衰减大于 dB希
望分别设计性价比最高的FIR和IIR两种滤波器进行滤除干扰。请选择合适的滤波器类型
和设计方法进行设计，最后比较两种滤波器的幅频特性、相频特性和阶数。
xDI
sf
Ivfl
fkHz
题图
°调用MATLAB工具箱函数firl设计线性相位低通FIR滤波器，要求希望逼近的
Created by ZhuangHeng
理想低通滤波器通带截止频率wπ rad滤波器长度N。分别选用矩形窗、
Hanning窗、Hamming窗和Blackman窗进行设计，绘制用每种窗函数设计的单位脉冲响
应hn及其损耗函数曲线，并进行比较，观察各种窗函数的设计性能。
将要求改成设计线性相位高通FIR滤波器，重作题。
调用MATLAB工具箱函数 remezord和 remez设计线性相位低通FIR 滤波器，
实现对模拟信号的采样序列xn的数字低通滤波处理。指标要求：采样频率为 kHz通
带截止频率为kHz通带最小衰减为 dB阻带截止频率为 kHz阻带最小衰减为
dB。列出hn的序列数据，并画出损耗函数曲线。
调用MATLAB工具箱函数 remezord和 remez设计线性相位高通FIR 滤波器，
实现对模拟信号的采样序列xn的数字高通滤波处理。指标要求：采样频率为 kHz通
带截止频率为kHz通带最小衰减为 dB过渡带宽度小于等于kHz阻带最小衰
减为 dB。列出hn的序列数据，并画出损耗函数曲线。
°用窗函数法设计一个线性相位低通FIR滤波器，要求通带截止频率为π rad
阻带截止频率为π rad阻带最小衰减为dB。选择合适的窗函数及其长度，求出并显
示所设计的单位脉冲响应hn的数据，并画出损耗函数曲线和相频特性曲线，请检验设计
结果。试不用firl函数，直接按照窗函数设计法编程设计。
调用MATLAB工具箱函数firl设计线性相位高通FIR滤波器。要求通带截止频
率为π rad阻带截止频率为π rad通带最大衰减为 dB阻带最小衰减为
dB。显示所设计的单位脉冲响应hn的数据，并画出损耗函数曲线。
调用MATLAB工具箱函数 firl设计线性相位带通FIR 滤波器。要求通带截止频
率为π rad和π rad阻带截止频率为π rad和π rad通带最大衰减为
dB阻带最小衰减为 dB。显示所设计的单位脉冲响应hn的数据，并画出损耗函
数曲线。
°调用 remezord和 remez函数完成题和所给技术指标的滤波器的设计，
并比较设计结果主要比较滤波器阶数的高低和幅频特性。 限脉中向应数虑皮的设
Created by ZhuangHeng
数字信号处理第五版
第 章
多采样率数字信号处理
引 言
前面所讨论的信号处理的各种方法都是把采样率F视为固定值，即在一个数字系统
中只有一个采样频率。但在实际系统中，经常会遇到采样率的转换问题，即要求一个数字
系统能工作在“多采样率”状态。例如：
在数字电视系统中，图像采集系统一般按标准或标准采集数字
电视信号，再根据不同的电视质量要求，将其转换成其他标准的数字信号如
等标准进行处理、传输。这就要求数字电视演播室系统工作在多采样率
状态。标准的含义是“亮度信号Y的采样率：红色差信号RY的采样率：蓝色
差信号BY的采样率”其他标准以此类推。
在数字电话系统中，传输的信号既有语音信号，又有传真信号，甚至有视频信号，
这些信号的带宽相差甚远。所以，该系统应具有多采样率功能，并根据所传输的信号自动
完成采样率转换。
对一个非平稳随机信号如语音信号作谱分析或编码时，对不同的信号段，可根
据其频率成分的不同而采用不同的采样率，以达到既满足采样定理，又最大限度地减少数
据量的目的。
如果以高采样率采集的数据存在冗余，这时就希望在该数字信号的基础上降低采
样速率，剔除冗余，减少数据量，以便存储、处理与传输。
以上所列举的几个方面都是希望能对采样率进行转换，或要求数字系统工作在多采样
率状态。近年来，建立在采样率转换基础上的“多采样率数字信号处理”已成为数字信号处
Created by ZhuangHeng
理学科的主要内容之一。
一般认为，在满足采样定理的前提下，首先将以采样率F采集的数字信号进行 DA
转换，变成模拟信号，再按采样率F进行AD变换，从而实现从F到F的采样率转换。
但这样较麻烦，且易使信号受到损伤，所以实际上改变采样率是在数字域实现的。根据采
样率转换理论，对采样后的数字信号xn直接进行采样率转换，以得到最新采样率下的采
样数据。
采样率转换通常分为“抽取Decimation”和“插值Interpolation”。抽取是降低采样率
以去掉多余数据的过程，而插值则是提高采样率以增加数据的过程。本章先讨论抽取和插
值的一般概念，然后讨论其几种基本的实现方法。本章所涉及的内容也是语音及图像数据
压缩新技术——子带编码的重要理论基础。
信号的整数倍抽取
设xnT是连续信号x的采样序列，采样率FTHzT称为采样间隔，
单位为秒，即
xnTXnT
如果希望将采样率降低到原来的DD为大于的整数，称为抽取因子。最简单的方法
是对xnT每D点抽取点，抽取的样点依次组成新序列ynT。ynT的采样间隔
为T采样率为FTHzT与T的关系为
TDT
为了后面叙述方便，我们将上述的抽取系统用图a表示，图中符号D表示采样率
降低为原来的DD为Decimation的第一个字母，表示抽取。rnT和ynT分别如
图b和c所示。图中n和n分别表示xnT和xnT序列的序号，于是有
ynTxnDT
当nnD时，ynTxnT。
上面在时域讨论了整数倍抽取的概念。抽取看起来好像很简单，只要每隔D个抽
取一个就可以了，但抽取降低了采样频率，可能引起频谱混叠现象。下面讨论抽取过程中
可能出现的频谱混叠及改进措施。
如果xnT是连续信号xt的采样信号，则x。t和xnT的傅里叶变换Xj
和Xe”分别是
XGiazed
xe∑zcnTe
其中，Ωπf radsf为模拟频率变量；w为数字频率，
Created by ZhuangHeng
第章
多采样率数字信号处理
口
口口
口
数字信号处理第五版
xnT D
ynT
D
a
xnT
n
T
b
ynT
T
n
c
图 数字信号的时域抽取示意图
ATmF
由式有
xe÷∑xijk
式中，ΩπTrads亦称为采样频率。
为了对抽样前后的频谱进行比较，作图时均以模拟角频率Ω为自变量横坐标为此
按式将Xe写成Ω的函数为
Xexem六∑zjnjka
因为这里xt是一般的非周期连续函数，所以XjΩ也是模拟频率Ω的非周期函数，
如图a所示。而xnT的傅里叶变换Xe”为连续频率w的周期函数。在满足
采样定理时，Xe的频谱在aΩ上与Xj相似差一个比例常数T
且无混叠现象，如图b所示。但如果将采样率降低到原来的D即TDT当
D时，得到ynT及其频谱Ye如图所示实际上，Ye”应为图中各重复
谱的叠加曲线。图中，ynT为对xnT抽取的结果，Ye”为ynT的傅里叶变
换。Ye”的周期ΩπTπDTΩD。这就是说，Ye”的周期是Xe”周期
的D。
Created by ZhuangHeng
x XG
FT
QΩ
a
xnT XeXe
FT
T
QΩ
b
Q
图 x与xnT及其频谱图
ynT Ye
FT
T Q
方a
图 抽取引起的频谱混叠现象
由图可见，Ye”是有混叠的，无法从ynT中恢复出xnT来。所以随意
对xnT进行抽取是不行的。只有在抽取后仍能满足采样定理时才能恢复出原来的信号
rt否则就必须另外采取措施。通常采取的措施是抗混叠滤波。所谓抗混叠滤波，就是
在抽取之前先对信号进行低通滤波，把信号的频带限制在Ω以下。这种抽取系统框图
如图所示。图中hnT为抗混叠滤波器，它的输出vnT的最高频率已被
hnT限制在ΩΩD以下。即抗混叠滤波器的阻带截止频率为ΩD对
应的数字阻带截止频率为
TiTDTi芬
所以，在理想情况下，抗混叠低通滤波器hnT的频率响应He由下式给出：
oi
Created by ZhuangHeng
第章多采样率数字信号处理
口
数字信号处理第五版
于是λnT的DFS展开式为
图中各点的信号在时域和频域中的示意图如图所示。这种办法虽然把
xnT中的高频部分损失掉了，但由于抽取后避免了混叠，所以在Ye中完好无损地
保留了Xe中的低频部分，可以从Ye中恢复出Xe的低频部分。
xnT vnT ynT hmT D
图 带有抗混叠滤波器的抽取系统框图
xnT Xe
FT
T m Q Q a Q Q
a
nT IVeI
FT
T
m A Aman Q Q
b
ynT iYe
FT
T n Q Q Q Q
c
图 抽取前后信号的时域和频域示意图
为了进一步搞清xnT经↓D前后的频谱关系，对信号的抽取过程进行等效的数学
描述，如图所示，以便于进行频谱分析，找出Ye与Xe之间的关系。在抽取
前先令xnT乘以周期序列ānT即
xnTxnT·ānT
其中，λnT定义如下：
mT 其他，±D±D
然后对xnT进行D得到ynT。ānT的离散傅里叶级数DFS系数λk为
akacmTe
Created by ZhuangHeng
amT—ace
将式代入式，得
iT方mTe
对xnT进行抽取，每隔D个点抽取一个样值，所取得抽样点均在λnT的点
上。把这样抽取的结果作为ynT如图所示D。
xnT xnT
nT n
AāZ
o nT inZxnZānZ 直接抽取
TT nT
DT
ynT ynT
T T T T TnT m
HTDT T
图 抽取过程的等效数学描述与直接抽取波形
下面推导Ye与Xe的关系：
Y∑sTesLDTe∑scnDTe
当nDn时，ynDTinT而当nD≠n时，nT所以
rmicmTeGTc
第章多采样率数字信号处理
方x
Created by ZhuangHeng
口口
口口
口
口
数字信号处理第五版
令ze”zeWe带，则
Y方xcw
式中，zeeez°。所以有省去z的下标
Yaxw
式就是Ye与Xe的关系，即Ye“是Xe”的D个平移样本之和，
相邻的平移样本在频率轴ay上相差πD在模拟频率轴Ω上相差πDTΩD
如图和图所示。
xnTi IXeI
工
矿 ←T nT Q a
Q Q Ω
nT Ak 三 i …
T nT ò k
DT b 余nT Xe
工
DI DTDT mT ò R Ω
c
nT YeI
工
nT Q Ω
d
图 Ω时，抽取前后的频谱关系示意图
为了更清楚地说明上述关系，将由xnT求得ynT频谱的过程用图和图
表示出来。图给出了抽取后产生混叠的情况，即Xe中的最高频率
ΩΩDΩ。这里Ω为Xe的周期，Ω为Ye的周期。图
给出了抽取后不产生混叠的情况，即Xe中的最高频率ΩΩDΩ的
情况。
Created by ZhuangHeng
XeI
QQ Q Q
a
Ak
k
b
xeI
QD Q Q
c
Ye
Q Ω
d
图 nΩ时，抽取前后的频谱关系示意图
信号的整数倍内插
整数倍内插的概念与内插方法
整数I倍内插是在已知的相邻两个原采样点之间等间隔插入I个新的采样值。由于
这I个采样值并非已知的值，所以关键问题是如何求出这I个采样值。从理论上讲，
可以对已知的采样序列xnT进行 DA转换，得到原来的模拟信号xt然后再对
xt进行较高采样率的采样得到ynT这里
TIT
第章多采样率数字信号处理
式中，I为大于的整数，称为内插因子。上述过程可用图表示。但这样的插入方法
是不经济的，且附加DA和AD变换易对信号产生损伤。实际工作中采用下述内插方法。
整数内插是先在已知采样序列xnT的相邻两个样点之间等间隔插入I个值
点，然后进行低通滤波，即可求得I倍内插的结果。这种内插方案如图所示。图中
个I表示在xnT相邻样点之间插入I个值采样，称为零值内插器。I为英文单词
Interpolation的第一个字母。零值内插后，得到vnT。vnT经过hnT低通滤波
后变成ynT。xnT、vnT及ynT如图所示。
Created by ZhuangHeng
。。。
口口
口
口口
品
口口
口
■口
数字信号处理第五版
AxnT xnT
vnT hnT ynT
图 零值内插方案原理框图
AxnTi
n
a
Ax
T n
AznT
b
AynT T n
T
LynT
T n
c
T n
图 内插概念示意图 图 内插过程时域波形
整数倍内插的频域解释
上述的零值内插方案中，xnT、vnT及ynT的频谱关系是怎样的回答这
一问题的过程，就是解释为什么vnT经低通滤波就能得出采样率升高I倍的ynT
的原理。这样才能提出对低通滤波器的技术要求。
为了回答上面的问题，设xnT为模拟信号xt的采样序列，并假定xt及其傅
里叶变换Xj如图所示。
Ax AXGI
Ωa
图 模拟信号及其频谱示意图
按照内插的概念，ynT应为以采样间隔T对xt的采样序列，且满足TTI。于
是xnT、ynT及其傅里叶变换Xe”、Ye”应该如图所示。Xe和
Ye”均为周期函数，若二者都用模拟频率Ω表示，则Xe”Xe周期为Q
Created by ZhuangHeng
πTYeYe周期为ΩπTπTDIQ。
AxmT ixe
动
m
T
QQQ Q
a
AnT AIYeI
T
HT n Qa Q Q
b
图 xnT、ynT、Xe、Ye的波形I
下面分析图中vnT的频谱，最后讨论为了得到满足插值要求的ynT如
图所示对hnT的技术要求。
T 当n±I±I…
其他
vnT的傅里叶变换Ve为
ve∑onTe∑DCnTeZTe
zcnTe两xxe
上式表明Ve和Xe的频谱相同，如图所示。实质上，vnT的信息与
xnT完全相同，所以二者应具有相同的频谱。图中，ΩπTΩπT
xmT Xe
上
T n Q Q
a π π
nT iveI
不
T n QDΩ
b π 码
图 零值内插前后的时域信号及其频谱
第章
多采样率数字信号处理
Created by ZhuangHeng
数字信号处理第五版
πTDIΩ。与图中的Ye相比较，图中的Ve多出了从Ω
到ΩΩ的部分，通常将这部分频谱称为镜像频谱。由此可见，要想从Ve”得到如
图b所示的Ye就必须滤除这些镜像频谱。所以，要求滤波器hnT的理想
低通幅频特性如图所示。实际工作中ΩΩ所以允许He有一定的过渡带，
可用线性相位FIR 滤波器实现。根据其功 AIHe
能，将hnT称为镜像滤波器。
将理想镜像滤波器的阻带截止频率换算
成数字频率为 QQ Q Q a
T子 mI wI π
图 镜像滤波器的理想幅频特性
所以，理想情况下，镜像滤波器hnT的
频率响应特性为
c
式中，C为定标系数。因此输出频谱为
≤lwI
≤I≤π
定标系数C的作用是，在m±I±I±I…时，确保输出序列ymxmI。
为了计算简单，取m来求解C的值。
yYedxeda
因为wwI所以
yoxedSrx
由此得出，定标系数CI。
内插器的输入、输出关系
时域输入、输出关系
由图有
ynT∑omThnTmT
因为
cmrxTmm及Tr 共池
Created by ZhuangHeng
所以
yonT∑znThnSTnT∑zmTAmmDT
上式就是内插器时域输入、输出关系。
频域输入、输出关系
YeVe“He
由式知道VeXe所以
YeXCeHeXeHe
在复频域分析图时，其输入xnT的Z变换Xz与输出ynT的Z变换Yz
的关系推导如下：
YzVz·Hz
其中
VVnT
∑T n时 n为I的整数倍即
DaomTx
YzXzHz
式中所有变量都为z所以可去掉下标，得到：
YzXzHz
按有理数因子ID的采样率转换
在按整数因子I内插和整数因子D抽取的基础上，本节介绍按有理数因子ID采样率
转换的一般原理。显然，可以用图所示方案实现有理数因子ID采样率转换。
xn h hp D m 第章多采样率数字信号处理
内插器 抽取器
图 按有理数因子ID的采样率转换方法
首先对输入序列xn按整数因子I内插，然后再对内插器的输出序列按整数因子D抽
取，达到按有理数因子ID的采样率转换。应当注意，先内插后抽取，才能最大限度地保
留输入序列的频谱成分。
用FT和FT分别表示输入序列xn和输出序列ym的采样频率，则
FIDF。另外，图中镜像滤波器hD和抗混叠滤波器hp级联，而且工作在相同
的采样频率IF因此完全可以将它们合成为一个等效滤波器hL得到按有理数因子
Created by ZhuangHeng
□ ■ 口
口
口
口
a口
数字信号处理第五版
ID采样率转换的实用原理方框图，如图所示。
z w iD I xn h ym
图 按有理数因子D采样率转换的实用原理方框图
如前所述，理想情况下，h和hp均为理想低通滤波器，所以二者级联的等效滤波
器h仍是理想低通滤波器，其等效带宽应当是hL和hp中最小的带宽。hD的频率
响应为
现在推导图中输出序列ym的时域表达式。零值内插器的输出序列为
t±±
线性滤波器输出序列为
u∑hlkk∑hCLkDak
整数因子D抽取器最后输出序列为ym其时域表达式为
ymuDm∑hDmkDrk
如果线性滤波器用FIR滤波器实现，则可以根据式计算输出序列ym。
除了前面介绍的采样率变换技术，在实际工作中还会遇到任意因子采样率转换FF
为任意有限数或可能随机变化。有兴趣的读者请参考文献。
整数倍抽取和内插在数字语音系统中的应用
为了下面叙述方便，首先说明本节对信号时域和频域的表示方法和描述符号。设xt
为模拟信号，xnT表示对xt的采样序列，ymT是对xnT进行采样率转换内插
或抽取后的序列。并定义
X jΩFTxt
XeXeFTxnT
YeYeFTymT
其中，数字频率与模拟频率的关系为wΩTaΩT。xnT的采样频率记为F
THzynT的采样频率记为FT Hz相应的采样角频率记为ΩπF
πTradsΩπFπT rads。
为了通过观察比较xt、xnT和ymT的频谱关系，理解采样率转换在数字语音
Created by ZhuangHeng
系统中的应用原理，本节全部以模拟角频率Ω为自变量横坐标并采用上面定义的符号，
来绘制应用系统中各信号的频谱曲线。
数字语音系统中的信号采样过程及其存在的问题
在数字语音系统中，语音信号的采样过程如图所示。图中，zt为模拟信号，
其有用频谱分布范围为一fff。表示xt中有用频率成分的最高频率。信号中一般
含有干扰噪声，其频带宽度远大于f。xt及其幅频特性XGj如图b所示。下
面以电话系统中的数字语音系统为例，讨论图a所示的基本采集系统中存在的技术
问题。
x h AD nD
x a IXGI
o a ax
b HGDI
a a
e IiVgI
A R Q
n d
ive
o T n
N Q
e
图 语音信号的一般采样过程示意图 第章多采样率数字信号处理 在电话系统中，一般要保证kHz的音频带宽，即取fkHz。但送话器发出的信号
x。t的带宽比子。大很多。因此，在AD变换之前要对其进行模拟预滤波，以防止采样后
发生频谱混叠失真。为了使信号采集数据量尽量小，取采样频率FfkHz。这时要
求低通模拟滤波器ht的幅频响应特性HGj如图c所示。预滤波后的信号vt
及其采样序列vnT和相应的频谱分别如图d、e所示。
上述基本采集系统对xt进行AD变换的困难在于对预滤波器ht的技术要求太高
要求过渡带宽度为用理想低通滤波器因而是难以设计与实现的。显然，在接收端
DA变换过程中同样会遇到此问题。如果简单地将采样率提高，如取F kHz则预滤
波器就容易实现允许有kHz的过渡带但使采集信号的数据量加大倍，传输带宽也加
Created by ZhuangHeng
大倍。下面讨论如何采用整数因子抽取与整数因子内插来解决该问题，而不增加数据量。
数字语音系统中改进的AD转换方案
为了降低对模拟预滤波器的技术要求，采用如图a所示的改进方案。先用较高
的采样率进行采样，如采样率FT kHz经过AD后，再按因子D抽取，把
数字信号处理第五版
xt g ADnT hnT vnT ymT
x a
IXg
b IGG
QΩ Q
c
w AIWG
Ω a Q Ω
d
wnT AIWe
T n
Q
e AIHeI
Ω a QΩ
VnT AIVeI
T n Ω A Q Ω
g
AmT IYeI
T m h Ω Ω
图 数字语音系统中改进的AD转换方案及各点信号波形与频谱示意图
Created by ZhuangHeng
采样率降至kHz。这时，模拟预滤波器gt的过渡带为≤f≤ kHz如图c所
示。这样的预滤波器会导致采样信号wnT的频谱We在 kHz的频带中发生
混叠，如图e所示。但这部分混叠在抽取前用数字滤波器hnT滤掉了。数字滤波
器hnT的幅频特性He如图f所示。这样，模拟预滤波器就容易设计和实
现了。现在把问题转移到设计和实现技术要求很高的数字滤波器hnT上了，这就是解决
问题的关键技术。数字滤波器可用FIR结构，容易设计成线性相位和陡峭的通带边缘特性。
这种方案最终并未增加信号数据量。
接收端DA转换的改进方案
设数字信号序列ymT传送到接收端后变成ymT若不考虑信道噪声，则其频谱
与图h相同。要将ymT恢复为模拟信号t若采用基本方案，先将ymT经
DA转换器，再进行模拟低通滤波，得到it。这种方案同样会对模拟恢复低通滤波器
gt提出难以实现的技术要求。为了解决这一难题，可采用如图所示 DA转换器的
改进方案。该方案的思路是，采用整数因子内插，将模拟恢复低通滤波器gt的设计与实
现的困难转移到设计滤除镜像频谱的高性能数字滤波器hnT来解决。具体实现原理
如下。
o mT AnT SnT DA
图 DA转换器的改进方案
设输入数字信号ymT如图a所示与图h相同。经内插后将采样率
提高倍，滤波器hnT的输出为vnT假定hnT可设计成陡峭通带边缘特性，则
ünT的时域和频域波形如图b所示。对vnT进行DA变换，得到：
mT AIfeI
T m o
a 会 Q
第章多采样率数字信号处理
CnT AIVeI
T i
m ΩQ Ω
b
图 ymT和inT时域和频域示意图
it及其幅频特性VGj如图所示。应当说明，这种DA转换器难以实现，实
Created by ZhuangHeng
数字信号处理第五版
际中常用零阶保持型DA转换器代替，但其频响特性不理想，会引入幅频失真。这种失真
可在数字域进行预处理补偿。
AIVG
HKT 云 Q Q
图 vt时域和频域示意图
对it进行模拟低通滤波，这时要求模拟低通滤波器gt的通带边缘频率为Ω
πT过渡带为πT≤IΩ≤πT阻带为πT≤I。gt的幅频特性
曲线如图所示，当然，过渡带上的频响曲线可以不是直线。gt的输出则为模拟信号
xt。由于过渡带较宽，所以模拟低通滤波器gt的设计与实现较容易。我们希望恢复的
信号就是xt其时域和频域示意图如图所示。
AGG A×Ga
oL 云云°云 Ω 云云
图 g的幅频特性曲线 图 恢复的模拟信号x及其频谱示意图
采样率转换滤波器的高效实现方法
在多采样率系统中，总是设法把乘法运算安排在低采样率一侧，以使每秒钟内的乘法
次数最少。但在前面介绍的两种采样率转换方案中，滤波器的卷积运算均在采样率较高的
一侧。因此，必须对多采样率系统的网络结构进行研究，以便得到乘法次数最少的高效实
现结构。
用FIR 结构实现多采样率系统具有很大的优越性。这是由于FIR结构绝对稳定且很容
易做成线性相位，特别是容易实现高效结构。所以在多采样率系统的实现中绝大多数采用
FIR滤波器。本节只介绍FIR 直接实现和多相结构，其他两种高效实现结构多级实现和时
变网络请参阅文献。
直接型FIR滤波器结构
整数倍抽取器的FIR 直接实现
整数D倍抽取器框图如图所示。抗混叠低通滤波器用FIR结构时，抽取器的
时域输入、输出关系为设hnT长度为N
Created by ZhuangHeng
mTZhrTrmT
ynTvnDT
如果滤波器用FIR直接型结构，则该抽取器的实现网络结构如图a所示。经滤
波卷积运算得出vnT最后将 vnT每隔D个取一个作为输出ynT即
vnT中有DD的样值都被舍弃了。所以这种结构是一种低效实现结构，而且要求
计算每一个vnT的N次乘法和N次加法在一个T时间内完成。
xnT hO zmT
hT
tD ynT
xmDTi z
要要垂
hNT xnNTi
xmNT
zhNDT
a
xnTi D
hO ynT
z
xnT tD hT
tD hNTi xmNT
xmNTI iD hNT
b
图 按整数因子D抽取系统的直接型FIR滤波器结构
为了得到相应的高效FIR直接实现，对图a进行等效变换。显然，将图
a中的vD移在N条乘法器支路中的乘法器之前，如图b所示，所得ynT与
原结构输出相同，即图a与图b是等效的。
图b中各条支路里的↓D同时在nnD时开通，例如DNn
第章
多采样率数字信号处理 时，n第条支路通过的是xT第条支路通过的是xT……最下面
的第N条支路通过的是xT。此刻开始计算N个支路的N次乘法和最后的N
次加法，得到一个输出样值：ynTyTyDTyT。由于在xT到
来之前所有的↓D同时关闭，直到n时，即nnD时，N个VD才又同时开
通，分别让xTxT…xT通过，开始计算下一个输出序列样值yT。
所以，改进后的实现结构将乘法运算移到低采样率一侧，使乘法运算速度要求降低到原来
的D即原来要在一个T时间内完成的运算，现在只要在DT时间之内完成就可以了。
当然，也使计算量减少到原来的D。故称之为高效结构。
Created by ZhuangHeng
口
oo口
口
口口
□o■■ ■
口
口
数字信号处理第五版
应当说明，图b中将↓D放在hCOhT…hNT之前，减少了
运算量，但这并不是把抗混叠滤波放到了抽取之后，而是与原来的滤波作用等效。对此作
如下解释：
滤波和抽取的作用次序在FIR实现结构中体现在滤波器输入端及延迟链上所加的信号
序列，如果所加信号是抽取以前的信号，则是先滤波后抽取，反之是先抽取后滤波。图
b中，所有D均安排在延迟链之后，即滤波器延迟链上各点的信号仍然是原序列
xnTxnT…xnNT而不是抽取后的信号。每当D开通
时，进入左侧的信号是未抽取的原信号，即输出的ynT与图a中抽选的ynT
相同，而两次开通之间所阻挡的信号恰好就是图a中将来要舍弃的部分，所以计算
结果是正确的。但绝对不能将D提前到延迟链之前，那样才是真正的先抽取后滤波，会
产生严重的混叠现象。
由于常常希望把FIR滤波器设计成线性相位的，因而可用FIR线性相位结构，这样又
可以使乘法计算量减少一半。根据线性相位时域特性
hnThNnT
可画出抽取器FIR结构的线性相位形式如图所示。
hO ynT
xnT tD
ID
ID
D
tD
图 抽取器FIR结构的线性相位形式N
整数倍内插器的FIR直接实现
整数倍内插方案原理框图如图所示。镜像滤波器hnT采用FIR 结构时，I倍
内插器的FIR 直接实现结构如图所示。
图中乘法是在高采样率一侧进行的，不是高效结构，应设法将乘法运算移到低
采样率一侧以减少计算量。可采用以下方法进行网络等效变换，得出相应的高效结构。
先将FIR滤波网络部分进行转置，得到图所示的FIR转置型结构，再用其代替
图中的FIR滤波网络，得到图所示的内插系统直接实现结构。
D hT
D zhT
D hT
D
tD
hT tD
Created by ZhuangHeng
xmT
vnT hO ynT vnT hO ynT
hT hT
z
重中果 善曲曲
hNTI HNT
z hNT hNT z
图 按整数因子I内插系统的直接型FIR
滤波器结构
图 FIR转置型结构
由整数倍抽取系统的FIR直接实现的等效变换概念可知，图中先零值内插后分
支相乘与先分支相乘后零值内插等效。因此，可将图中的个分别移到FIR网络的
各支路的乘法器之后，可得到图所示的内插系统直接实现高效结构。由于延时链上
所加的仍然是内插后的信号，因而等效变换后的高效结构仍是先内插后滤波。
xnT
vnT hO ynT xnT hO
hT
杠 ynT
hT z
z 杠 z
重垂用
hNT hNT
hNT z
hNT
图 滤波网络转置后的内插器的
FIR 直接实现
图 内插器FIR 直接实现的
高效结构
当满足线性相位条件hnThNnT时，可用线性相位结构实现，将乘
法次数再减少一半。取N画出内插器的线性相位FIR直接高效实现结构，如图
所示。
xnT h
hT ynT
hT 中 z
hT
z
hT
z
口 z
图 内插器的线性相位 FIR直接实现结构
第章
多采样率数字信号处理
Created by ZhuangHeng
观察图和图b可发现一个有趣的规律：图所示的按整数因子I内
插系统的高效FIR滤波器结构与图b所示的按整数因子D抽取系统的高效FIR滤
波器结构互为转置关系。这种关系有助于简化整数因子抽取系统和整数因子内插系统的高
效FIR滤波器结构的研究，在多相实现结构的讨论中将用到该关系。
按有理数因子D的采样率转换系统的高效FIR滤波器结构
为了叙述方便，先由图画出按有理数因子ID采样率转换系统的直接型FIR结
构，如图所示。
数字信号处理第五版
hO xn
h
ID m
z
z
h
hM
z
图 按有理数因子D采样率转换系统的直接型 FIR滤波器结构
按有理数因子ID采样率转换系统的高效结构一般基于内插系统的高效FIR滤波器
结构与抽取系统的高效FIR滤波器结构进行设计。其指导思想是，使FIR滤波器运行于最
低采样速率。为此，当ID时，FF将图中的直接型 FIR结构与前面的个用
图所示的整数因子I内插器的高效FIR 滤波器结构代替即可。当ID时，FF
将图中的直接型FIR结构与后面的D用图b所示的整数因子D抽取器的
高效FIR滤波器结构代替即可。如果采用线性相位FIR滤波器，则应当用相应的线性相位
FIR滤波器的高效内插结构或高效抽取结构来实现。
多相滤波器结构
可以证明，图所示的按整数因子I内插系统的高效FIR滤波器结构可以用一组
较短的多相滤波器组实现。如果FIR滤波器总长度为MNI则多相滤波器组由I个长度
为NMI的短滤波器构成，且个短滤波器轮流分时工作。
为了证明上述结论，观察图给出的整数因子I内插系统的直接型FIR滤波器结
构。为了下面描述简单，用xn表示xnT用vm表示 vnTym表示ynT。
输出序列ym为
ymZhnmm
hM
零值内插器的输出序列vm是在输入序列xn的两个相邻样值之间插入I个零样值得
Created by ZhuangHeng
到的，因此 vm进入 FIR滤波器的M个样值中只有NMI个非零值。所以在任意m时
刻，计算ymhmvm时只有N个非零值与hm中的N个系数相乘。由式
知道
m其，±z±
所以，mjI时刻，
ymhcncmnhGxjn
hOxjhDzGjhDaj… hNDxjN
mjI时刻，中vjIn右移位，N个xn的非零值与hn的对应关系又右
移位，所以
ymZhcmocmmZhmxGjm
hxjhDxjhDxj…
hNDrjND ……
当mjII时刻，N个xn的值与hn的对应关系又重复式，只是xn又移进
位，所以
mhnom”
hCnDaj
hxjhDxjhDxGj…
hNDxjN
综上所述，当mjIkk…Ij…时，有
ymZhcnmnZhknDajn
把式中的hknl看做长度NMI的子滤波器的单位脉冲响应，并用pn
表示：
pnhknlk…In…N
这样，从m开始，整数因子I内插系统的输出序列ym计算如下：
ym∑pnxjpnn
Created by ZhuangHeng
第章多采样率数字信号处理
式中，mjIkk…Ij…。显然，当mjIk从开始增大
时，k从开始以I为周期循环取值；j表示循环周期数。所以，实现式的多相滤波
器结构如图所示。I个子滤波器均运行于低采样率F下，且系数少，计算量小，所
以多相滤波器结构是一种高效结构。输入端的xn每移入一个样值，I个子滤波器分别计
算出ym的I个样值，选择电子开关以高采样率FIF依次逆时针循环选取I个子滤
波器的输出，形成输出序列ym。实现了整数因子I内插功能。
口口
数字信号处理第五版
xn Pan
Pn 速率IF
Pn ym
采样速率FIF
采样率F Pn 采样率F
图 整数因子I内插系统的多相滤波器结构
从I个子滤波器的频响特性可以解释“多相滤波器”的含义。对低通滤波器hn按整数
因子I抽取得到子滤波器pn。hn是截止频率为πI的理想低通滤波器，则pn的截
止频率必然是π即I个子滤波器都是全通滤波器，幅度特性相同，它们的唯一区别是相位
特性不同，故称为“多相滤波器”结构。正是由hn的I个不同的起始点抽取得到I个子滤
波器，形成了这种多相特性。
根据整数因子I内插器的实现结构与整数因子D抽取器的实现结构互为转置关系的规
律，将图给出的整数因子I内插系统的多相滤波器结构进行转置，则得到图
所示的整数因子D抽取系统的多相滤波器结构。
P。n ym
速率FD
速率F
xn
图 整数因子D抽取系统的多相滤波器结构
定义多相滤波器的单位脉冲响应为
pnhknDk…Dn…N
pn
Pn
Pon
Created by ZhuangHeng
式中，N为pn的长度。一般选择原抗混叠FIR滤波器总长度MDNNMD。电子
开关以速率F逆时针旋转，从子滤波器p。n在m时刻开始，并输出y然后电子
开关以速率F逆时针每旋转一周，即每次转到子滤波器p。n时，输出端就以速率F
FD送出一个ym样值。
下面以NDMDN为例，验证图所示的抽取系统多相结构的正确
性。首先根据图a计算出抽取器的正确输出ym
Dnhnn∑hDnD
ymvDmvm
假设xn为因果信号，则
yvhOx oape 现在根据图计算多相实现结构的输出ym。图中，多相子滤波器p。n
hhpnhh开始时kn只有x进入p。npn中
无信号，所以总输出yp。xhx。逆时针旋转开始下一周期：kD
时，电子开关转到pnx进入pnpn的输出为pxhxk时，
电子开关又转到p。n此时，x进入p。n第一节，上一周期中进入p。n的x移位到
p。n的第二节，所以p。n的输出为
p。xp。xhxhx
总的输出y为pon与pn输出之和，即
yhxhxhx
同样道理，可求出下一旋转周期得到的输出为
ypxpxp。xp。x
hxhxhxhx
所求y、y和y与式相同，所以，图所给结构是正确的。 第章多采样率数字信号处理 需要说明，在实际采样率转换系统中，常常会遇到抽取因子和内插因子很大的情况。
例如，按有理数因子ID的采样率转换系统，从理论上讲，可以采用多相滤波器
结构准确地实现这种采样率转换，但是实现结构中将需要个多相滤波器，而且其工作
效率很低。“多级实现结构”可以很好地解决该问题。而且，多级实现结构可以使滤波器总
长度大大降低。多级实现内容请参考文献。按有理数因子ID采样率转换系统还
可以采用线性时变滤波器结构实现。
【例】 设计一个按因子I的内插器，要求镜像滤波器通带最大衰减为
dB阻带最小衰减为 dB过渡带宽度不大于π。设计FIR滤波器系数hn并
Created by ZhuangHeng
口
口
口
口口
口口口口
口口
n口
数字信号处理第五版
求出多相滤波器实现结构中的个多相滤波器系数。
解 由式知道FIR滤波器hn的阻带截止频率为π根据题意可知滤波器
其他指标参数：通带截止频率为πππ通带最大衰减为 dB阻带最小衰
减为 dB。调用 remezord函数求得hn长度M为了满足的整数倍，取M。
调用remez 函数求得hn如下：
heh heh
heh heh
heh heh
heh heh
heh heh
heh heh
heh heh
he—h heh
heh he—h
heh he—h
heh heh
heh heh
heh
根据式确定多相滤波器实现结构中的个多相滤波器系数如下：
p。nhnlhhhhhhhhhh
pnhnlhhhhhhhhhh
pnhnDhhhhhhhhhh
psnhnhhhhhhhhhh
pnhnlhhhhhhhhhh
采样率转换器的MATLAB实现
MATLAB信号处理工具箱提供的采样率转换函数有 upfirdninterpdecimate
resample其功能简述如下。
YupfirdnXHD先对输入信号向量X进行I倍零值内插，再用H提供的
FIR数字滤波器FIRDF对内插结果滤波，其中H为FIRDF 的单位脉冲响应向量，
FIRDF采用高效的多相实现结构。最后按因子D抽取得到输出信号向量Y。
YinterpXD采用低通滤波插值法实现对序列向量X的I倍插值，其中的插值滤
波器让原序列无失真通过，并在X的两个相邻样值之间按照最小均方误差准则插入I
个序列值。得到的输出信号向量Y的长度为X长度的I倍。
Created by ZhuangHeng
YdecimateXDN先对序列X抗混叠滤波，再按整数因子D对滤波输出序列抽
取。输出序列Y的长度是X长度的D。抗混叠滤波用N阶切比雪夫I型低通滤波器，阻
带截止频率为FD如果省略N则默认用阶切比雪夫I型低通滤波器；Y
decimateXDNFIR用长度为N的FIR滤波器，FIR 滤波器是抽取函数 decimate自
动调用firlND设计的。省略N则默认用点FIR数字滤波器。
YresampleXID采用多相滤波器结构实现按有理数因子ID的采样率转换。
如果原序列向量X的采样频率为F长度为L则序列Y的采样频率为FIDF长
度为IDL当IDL不是整数时，Y的长度取不小于IDL、的最小整数。该函数具
有默认的抗混叠滤波器设计功能，按照最小均方误差准则调用函数 firls设计。
YBresampleXID返回输出信号向量Y和抗混叠滤波器的单位脉冲响应
序列向量B。
YresampleXIDB允许用户提供抗混叠滤波器的单位脉冲响应序列向量B。
这些函数的其他调用格式请用help命令查阅。
【例】 编写程序产生长度为的序列xnsinπnsinπn再
调用 resample函数对xn按因子进行采样率变换，并绘制采样率变换器的输入序列
xn、输出序列yn和采样率变换器中的FIR 数字滤波器的单位脉冲响应hn及其频率
响应特性曲线。
解 本例题的实现程序epm如下：
实现程序epm调用 resample 函数实现按因子进行采样率变换
nxnsinpinsinpin生长度为的序列向量xn
ynhnresamplexnxn按因子进行采样率变换，yn为转换器输出序列，hn是
RDF的单位脉冲响应
下是绘图部分
subplotDstemhnaxistitleaxlabelt
ylabelhGi
w
subplotplotwlogabsffthnaxisgrid on
titlebxlabelomegapiylabellgHgomega
subplotstemnxntitleCexlabelnylabelxn 第章多采样率数字信号处理
nylengthyn
subplotstemnyyntitleCdxlabelCmylabelym
运行程序得到采样率转换器的输入信号xn、输出信号ym、FIR数字滤波器的单位
脉冲响应hn及其频率响应的波形分别如图c、d、a和b所示。由图b可以
看出，resample函数默认设计的抗混叠滤波器的阻带最小衰减大于dB满足理论要求。
xn的长度为ym的长度为×hn的长度为。由图可见，低
通滤波器滤除输入信号中较高的频率成分sinπn采样率变换器输出单频正弦波
采样，采样频率为FF所以输出序列
Created by ZhuangHeng
口口口 ■■ ■ ■
口口
口
□□ 口
口
口
口
口
数字信号处理第五版
ymsinπ×msinπm
aHae
VW
π
a b
xn
n
c
Mm
m
d
图 程序epm运行结果
习题与上机题
已知信号xnauna。
求信号xn的频谱函数XeFTxn
按因子D对xn抽取得到ym试求ym的频谱函数。
证明：ym的频谱函数就是xn的频谱函数。
假设信号xn及其频谱Xe如题图所示。按因子D直接对xn抽取，得到
信号ymxm。画出ym的频谱函数曲线，说明抽取过程中是否丢失了信息。
Xel
一π 恐
π
题图
按整数因子D抽取器原理方框图如题图a所示。其中，FkHzF
Created by ZhuangHeng
Hz输入序列xn的频谱如题图b所示。请画出题图a中理想低通滤波器
hpn的频率响应特性曲线和序列vn、ym的频谱特性曲线。
Xe
RIr hon zn pITFJD
一篇
a b
题图
按整数因子I内插器原理方框图如题图所示。图中，F HzFkHz输
人序列xn的频谱如题图b所示。确定内插因子I并画出题图中理想低通滤波器
hn的频率响应特性曲线和序列vm、ym的频谱特性曲线。
Frun zm m
题图
°设计一个抽取器，要求抽取因子D。用 remez函数设计抗混叠FIR滤波器，图
示滤波器的单位脉冲响应和损耗函数。要求通带最大衰减为 dB阻带最小衰减为
dB过渡带宽度为π rad。画出实现抽取器的多相结构，并求出多相实现时各子滤
波器的单位脉冲响应。
°设计一个内插器，要求内插因子I。用remez 函数设计镜像FIR滤波器，图示
滤波器的单位脉冲响应和损耗函数。要求通带最大衰减为 dB阻带最小衰减为 dB
过渡带宽度为π rad。画出实现内插器的多相结构，并求出多相实现时各子滤波器的
单位脉冲响应。
°设计一个按因子降低采样率的采样率转换器，画出系统原理方框图。要求其
中的FIR低通滤波器的过渡带宽为π rad通带最大衰减为 dB阻带最小衰减为
dB设计FIR低通滤波器的单位脉冲响应，并画出一种高效实现结构。
°假设信号xn是以奈奎斯特采样频率对模拟信号x的采样序列，采样频率
F kHz。现在为了减少数据量，只保留≤f≤ kHz的低频信息，希望尽可能降低采
样频率，请设计采样率转换器。要求经过采样率转换器后，在频带≤f≤ kHz中频谱
失真不大于dB频谱混叠不超过
确定满足要求的最低采样频率F和相应的采样率转换因子；
画出采样率转换器原理方框图；
确定采样率转换器中FIR低通滤波器的技术指标，用等波纹最佳逼近法设计FIR
低通滤波器，画出滤波器的单位脉冲响应及其损耗函数曲线，并标出指标参数通带截止频
率、阻带截止频率、通带最大衰减和阻带最小衰减
求出多相实现结构中子滤波器的单位脉冲响应，并列表显示或打印。
第章多采样率数字信号处理
Created by ZhuangHeng
■
口口口
口口口 …口口
口
口
数字信号处理第五版
第章
数字信号处理的实现
数字系统的实现方法有软件实现和硬件实现。软件实现就是按照系统运算结构设计软
件并在通用计算机上运行实现。硬件实现方法则是按照设计的运算结构，利用加法器、乘
法器和延时器等组成专用的设备，完成特定的信号处理算法。利用数字信号处理专用单片
处理器DSP实现，无疑是一种好的实现方法，此方法属于软硬结合实现。一般理论设计
后，只得到系统的系统函数或者差分方程，还必须再具体设计一种算法，进行实现。第章
学习了各种各样的网络结构，它们均代表了一种具体算法，根据这些具体算法才能设计软
件或硬件进行实现。
不同网络结构的计算误差、计算中要求的存储量、计算的复杂性及计算速度，设备成
本等均不相同。这里计算的复杂性指的是乘法次数、加法次数、取数存数次数以及两数之
间的比较次数等。存储量指的是为存储系统参数、中间计算结果以及输入输出信号值等要
求的存储量。运算速度除了和硬件本身的速度有关以外，主要和计算的复杂性有关。
运算误差主要来自有限字长效应，它是数字信号处理实现中特有的重要问题。因为数
字计算机用二进制编码信号进行运算，二进制编码的位数或字长有限，带来了各种量化
误差，形成有限精度的运算。因此需要研究各种网络结构对有限字长效应的敏感程度，以
及为给定的运算误差所需要的字长等。
本章主要学习各种量化误差，包括系数量化误差、运算量化误差以及AD变换器中的
量化误差，最后介绍数字信号处理的软件实现及硬件实现方法。
Created by ZhuangHeng
数字信号处理中的量化效应
量化及量化误差
数字信号处理技术实现时，信号序列值、运算结果及参加运算的各个参数都必须用二
进制的编码形式存储在有限长的寄存器中，如果该编码长度长于寄存器的长度，需要进行
尾数处理；运算中，二进制乘法会使位数增多，也需要进行尾数处理。尾数处理必然带来误
差，例如，序列值用二进制表示为…。如用位二进制表示，序列
值则为其十进制为 与原序列值的差值为
该差值是因为用有限位二进制数表示序列值形成的误差，称为量化误差。量化
误差产生的原因是用有限长的寄存器存储数字引起的，因此也将这种误差引起的各种效应
称为有限寄存器长度效应。这些量化效应在数字信号处理技术实现中，表现在以下几方面：
ADC中量化效应，数字网络中参数量化效应，数字网络中运算量化效应，FFT中量化效
应等。这些量化效应在数字信号处理技术实现时，都是很重要的问题，一直受到科技工作
者的重视，并在理论上进行了很多研究。随着科学技术的飞速发展，主要是数字计算机的
发展，计算机字长由位、位提高到位；一些结合数字信号处理特点发展起来的数字
信号处理专用芯片近几年来发展尤其迅速，不仅处理快速，字长达到 bit另外，高精度
的AD变换器也已商品化。这样，随着计算字长的大大增加，量化误差大大减少了，因此，
对于处理精度要求不高、计算字长较长的一般数字信号处理技术的实现，可以不考虑这些
量化效应。但是对于要求成本低，用硬件实现时，或者要求高精度的硬件实现时，这些量化
效应问题亦然是重要问题。
如果信号值用b位二进制数表示量化其中一位表示符号，b位表示小数部分，
能表示的最小单位称为量化阶或量化步长用q表示，q。对于超过b位的部分进行
尾数处理。尾数处理有两种方法：一种是舍人法，即将尾数第b位按逢进位，逢不进
位，b位以后的数略去的原则处理；另一种是截尾法，即将尾数第b位以及以后的数
码略去。显然这两种处理方法的误差会不一样。
如果信号xn值量化后用Qxn表示，量化误差用en表示，
enQxnxn
一般xn是随机信号，那么en也是随机的，经常将en称为量化噪声。为便于分析，一
般假设en是与xn不相关的平稳随机序列，且是具有均匀分布特性的白噪声。设采用定
点补码制，截尾法和舍入法的量化噪声概率密度曲线分别如图a和b所示。这样
截尾法量化误差的统计平均值为q方差为q舍入法的统计平均值为方差也为
q这里q”。很明显，字长b愈长，量化噪声方差愈小。后面我们将分别介绍各
种量化效应。
根据上述量化原理，四舍五入量化的数学模型为
第章数字信号处理的实现
Created by ZhuangHeng
口口
口
口口
口口o□
口口
面而
数字信号处理第五版
plen pen
q
q
q en
en
a b
图 量化噪声en的概率密度曲线
Qxq·roundxq
式中，roundx表示对x四舍五人后取整，roundxq表示x包含量化阶q的个数，所以
Qxq·roundxq就是量化后的数值。x可以是标量、向量和矩阵。将数取整的方法有
四舍五入取整、向上取整、向下取整、向零取整，对应的MATLAB取整函数分别为
roundx、ceilx、floorx、fixx。round最常用，对应的MATLAB量化语句为xq
qroundxq。
例如，xb量化程序如下：
xb
qb
xqqroundxq
exxq
算量化阶q
x舍入量化
算量化误差e
运行结果：
xqe
AD变换器中的量化效应
AD变换器的功能原理图如图a所示，图中n是量化编码后的输出，如果
未量化的二进制编码用xn表示，那么量化噪声为eninxn因此AD变换器
的输出xn为
nxnen
考虑AD变换器的量化效应，其统计模型如图b所示。这样，由于en的存在而降
低了输出端的信噪比。
en
由细 n x xn x 理想ADC 采样 量化编码
b统计模型 aAD变换器功能原理图
图 ADC功能原理图及统计模型
假设AD变换器输入信号xt不含噪声，输出xn中仅考虑量化噪声en信号
xt平均功率用c表示，en的平均功率用。表示，输出信噪比用SN表示，
S
Created by ZhuangHeng
信噪比通常用dB数表示：
SdB a
AD变换器采用定点舍入法，en的统计平均值m方差
a°“ b
将c代入式a得到：
Sblgo c
此式表明，AD变换器的位数b愈多，信噪比愈高；每增加一位，输出信噪比增加约dB。
当然，输出信噪比也和输入信号功率有关，为增加输出信噪比，应在AD变换器动态范围
中，尽量提高信号幅度。如果对输出端信噪比提出要求，根据式c可以估计对AD
变换器的位数要求。设xt服从标准正态分布NcAD变换器的动态范围为
±V。我们知道，对于正态分布，xt的幅度落入±a以外的概率很小，可以忽略。为
v 充分利用其动态范围，取 代入式c得
Sb
如果要求SN≥ dB由上式计算出b≥如果SN≥ dB则b≥。增加AD变换
器的位数，会增加输出端信噪比，但AD变换器的成本也会随位数b增加而迅速增加；另
外，输入信号本身有一定的信噪比，过分追求减少量化噪声提高输出信噪比是没有意义的。
因此，应根据实际需要，合理选择AD变换器位数。
输入最大幅度为±V的b位AD变换器，根据舍入量化模型式可以写出b
位AD变换器的MATLAB量化函数quant
function yquantxbV
if narginVmaxabsxend 省V则默认V等于x的最大值
掉负号 axabsx
qVb 算量化阶q
x舍入值量化 xqqroundaxq
入负号，恢复带负号的量化值y ysignxxq
第…
该函数可以对带负号的数据x进行AD变换，x可以是标量、向量和矩阵。
应当注意，上述AD为线性量化，其缺点是不利于小信号。为了改善小信号量化信噪
比，工程上常常采用非线性量化。
数字系统中的系数量化效应
系统对输入信号进行处理时需要若干参数或者称为系数，这些系数都要存储在有限位
数的寄存器中，因此存在系数的量化效应。系数的量化误差直接影响系统函数的零、极点
位置，如果发生了偏移，会使系统的频率响应偏离理论设计的频率响应，不满足实际需要。
Created by ZhuangHeng
数字信号处理第五版
量化误差严重时，极点移到单位圆上或者单位圆外，造成系统不稳定。
系数量化效应直接和寄存器的长度有关，但也和系统的结构有关，有的结构对系数的
量化误差不敏感，有的却很敏感。各种结构对系数量化误差的敏感度也是本节要研究的内
容之一。
MATLAB按二进制双精度格式表示数，表示一个数用字节位二进制数。键入
命令eps、realmin和 realmax可以显示出MATLAB浮点制表示的量化阶q
×、可以表示的最小数和最大数分别为×和×。所以
MATLAB的量化误差可以忽略不计，用MATLAB设计的滤波器系数可以看成精确的理
论值。工程实际中要把用MATLAB设计的滤波器付诸实现，必须采用嵌入式的DSP芯片
或专用数字硬件电路DSP芯片或专用数字硬件电路的字长一般为、、 bit采
用定点或浮点二进制表示数，并进行数值运算。因此，用MATLAB设计完成后，必须考虑
实际系统的有效字长，对设计结果进行量化仿真检验。当然，实际系统的有效字长越长，实
际实现的性能越逼近MATLAB设计结果。好在MATLAB提供了定点运算方真模块库
FixPoint Blockset有兴趣的读者请找相关书籍学习。
系数量化对系统频响特性的影响
数字网络或者数字滤波器的系统函数用下式表示：
式中的系数b和a必须用有限位二进制数进行量化，存储在有限长的寄存器中，经过量化
后的系数用b和a表示，量化误差用△b和△a表示，那么
aa△a
bb△b
实际的系统函数用Hz表示，公式为
显然，系数量化后的频率响应不同于原来设计的频率响应。
【例】 假设带通滤波器的系统函数如下式：
Hziz
如果用b位二进制表示上式中的系数，b采用舍人法处理尾数，试分析系数量化误
差对极点位置和频响特性的影响。
解 求解本例的系数量化与绘图程序为epm。
m例题系数量化与图绘图程序
Created by ZhuangHeng
BA
b
化前系统函数系数向量
化二进制位数
AqquantAb
prootsA
pqrootsAq
apabsp
apqabspq
下为绘图部分省略
系统函数分母系数向量A进行b位量化
算量化前的极点
算量化后的极点
算量化前极点的模
算量化后极点的模
运行程序，得到量化后的系统函数Hz为
Azi
并求出Hz和Hz的极点分别为
Pi±j
Pi±j
显然，因为系数的量化，使极点位置发生变化，算出极点的模为：IpizlIpzl
说明量化后的极点离单位圆稍远一些，会使带通滤波器的幅度特性的峰值减小，
中心频率有所移动。程序自动画出Hz和Hz的幅频特性曲线分别如图中的实线
和虚线所示。该例题说明由于系数量化效应，使极点位置发生了变化，从而改变了原来设
计的频率响应特性。
lHe 量化前
量化后
a
图 量化前后系统幅频响应曲线 第章数字信号处理的实现 应当注意，数字滤波器的系数的大小有时差别很大，如果用b位定点数表示时，以最
大的系数确定量化阶q对所有系数统一量化，必然使较小的系数相对量化误差很大，使滤
波器性能远离设计指标要求。所以工程实际中常常采用浮点制表示系数。
极点位置敏感度
下面分析系数量化误差对极零点位置的影响。如果极零点位置改变了，严重时不仅IIR
系统的频率响应会发生变化，还会影响系统的稳定性。因此研究极点位置的改变更加重要。
为了表示系数量化对极点位置的影响，引入极点位置灵敏度的概念，所谓极点灵敏度，是
指每个极点对系数偏差的敏感程度。相应的还有零点位置灵敏度，分析方法相同。下面讨
论系数量化对极点位置的影响。
Created by ZhuangHeng
口口
口口
数字信号处理第五版
式中，分母多项式Az有N个极点，用pk…N表示，系数量化
后的极点用pk…N表示，那么
pp△p
上式中极点偏差△p表示第k个极点的偏差，它应该和各个系数偏差都有关，它和各系数
偏差的关系用下式表示：
△p
的大小直接影响第；个系数偏差△a对第k个极点偏差△p的影响大小， 上式中，
愈小，△p 愈小。称 为极点p对系数a变化的灵敏度。下面推导 愈大，△p愈大，
该灵敏度和极点的关系。
a
aAp
式中
Aaπana
A
一anaa
将和式代入式，得到
i
上式即是第k个极点对系数a变化的敏感度。将上式代入式，得到
上式表示系数量化误差引起的第k个极点的偏差，由该式可以得到以下结论：
极点偏移和系数量化误差大小有关。如果系统采用定点补码制，尾数采用b位舍
入法处理，那么△a的变化范围为qqq均方误差为q因此为减小
极点偏移，应加长寄存器长度。
分母多项式中，pp是极点p指向极点p。的矢量，整个分母是所有极点不包
括p。极点指向极点p的矢量之积。如果极点密集在一起，极点间距短，式分母
Created by ZhuangHeng
就很小，那么极点对系数量化误差的敏感度高，相应的极点偏差就大。
极点偏差与系统函数的阶数N有关，阶数愈高，极点灵敏度愈高，极点偏差也愈
大。这样对于一些窄带滤波器，因为要求选择性高，势必要求阶数高，且极点密集，所以极
点的偏差会很大。严重时使极点移到单位圆上或者单位圆外，引起系统不稳定。
考虑以上因素，系统的结构最好不用高阶的直接型结构，而将其分解成一阶或者二阶
系统，再将它们进行并联或者级联，以便减小极点偏移量。
【例】 按照例数字带通滤波的设计指标：系统采样频率FkHz要求
保留 Hz频段的频率成分，幅度失真小于 dB滤除 Hz和 Hz以
上频段的频率成分，衰减大于 dB。调用MATLAB滤波器设计分析工具FDATool设计
该滤波器，并对其系数用位字长量化，其中尾数位。
直接型结构系数量化前后的零极点分布图和频响特性曲线分别如图a和b所
示。级联型结构系数量化前后的零极点分布图和频响特性曲线分别如图c和d所
示。由图可见，六阶椭圆带通滤波器的直接型结构的极点对系数量化误差的敏感度高，相
应的极点偏差大，量化误差使频响曲线偏差很大。量化后的滤波器无法使用。但级联型结
构的零极点对系数量化误差的敏感度很低，相应的极点几乎看不出偏差，量化前后频响曲
线基本重合。所以，工程上高阶滤波器一般都用级联型结构和并联型结构。
Imaginary
Imaginary
i
一考幅度
…化运度
A
幅度dB
考视
口量化后零点
干量化石概点
L
Real 频率Hz
a b
waro
一幅度
…后幅度
幅度dB
O零点
e
被点
口世化后零点
十量化后酸点
L
Real 频率Hz
c d
图 窄带滤波器系数量化前后的零极点分布图和频响特性曲线比较
第章数字信号处理的实现
Created by ZhuangHeng
数字信号处理第五版
观察图a和c发现，直接型结构和级联型结构系数量化前后的零点偏移都很
小。这是因为该滤波器的各零点之间距离较大不密集。而窄带带通滤波器的极点分布密
集，所以直接型结构的极点对系数量化误差的敏感度高，相应的极点偏差大。本例的实验
结果与理论结论一致。
数字系统中的运算量化效应
在数字网络的运算中，其中间结果和最后结果的位数，如果超出了规定的有限位二进
制数长度，则需要进行尾数处理，这样便引起了运算量化误差；运算中还可能出现溢出，造
成更大的误差；运算误差的大小除了和规定的二进制数的长度有关以外，还和网络结构有
关。下面就以上三个问题进行介绍。
运算量化效应
在定点制运算中，二进制乘法的结果尾数可能变长，需要对尾数进行截尾或舍入处理；
在浮点制运算中无论乘法还是加法都可能使二进制的位数加长，也需要对尾数进行截尾或
舍入处理。这样不管是采用定点制还是浮点制，都会因运算产生量化误差，这种误差称为
运算量化误差。下面我们仅介绍定点制的乘法量化误差。
由于输入信号是随机信号，产生的运算量化误差同样是随机的，需要进行统计分析。
运算量化误差在系统中起噪声作用，会使系统的输出信噪比降低。为了分析计算简单，假
定运算量化误差具有以下统计特性：①系统中所有的运算量化噪声都是平稳的白噪声；
②所有的运算量化噪声之间以及和信号之间均不相关；③这些噪声的概率密度都是均匀
分布的。
假设定点乘法运算按b位进行量化，量化误差用en表示。对于一个乘法支路，如图
a所示，图中节点变量vnavn经过量化后用onQavn表示，那么
enQavnvn
ünQavnvnen
这样量化以后乘法支路的统计模型如图b所示。因此系统中所有的乘法支路都和图
b一样引入一个噪声源。
en
vn vn a
vn nenvn a
a b
图 乘法支路及其量化模型
图中，有两个乘法支路，采用定点制时共引入两个噪声源，即en和en
噪声en直接输出，噪声en经过网络hn输出，输出噪声en为
enenhnen
如果尾数处理采用定点舍人法，则输出端噪声统计平均值为
Created by ZhuangHeng
xn nern
en
a
zb
en
图 考虑运算量化误差的一阶网络结构
m EenhnEen
E∑hmenmEen
m∑hmm
上式中E表示求统计平均值，m和m分别表示两个噪声源的统计平均值，这里m
m因此，
m
由于en和en互不相关，求输出端噪声方差时，可分别求其在输出端的方差，再相加。
这里，每个噪声源的方差均为
d
式中q”。输出端的噪声en的方差为
EenmEejnEenEen
式中，en和en分别表示en和en在输出端的输出；
Een
ELewE∑hmenmZhCDenD
∑ZhmhDEenmen
Zhmhsm
Zhm
cZhma
第章数字信号处理的实现
根据帕斯维尔定理式也可以用下式计算：
afHHz
式中
Hz±a
Created by ZhuangHeng
口口
口
口口
□
口
口口
口
数字信号处理第五版
网络结构对输出噪声的影响
下面我们通过一个二阶网络的例子说明不同网络结构对输出噪声的影响。
【例】 已知网络系统函数为
Hz IzI
网络采用定点补码制，尾数处理采用舍入法。试分别计算直接型、级联型和并联型结构输
出噪声功率。
解 Hz
按照以上Hz的三种表示公式，画出考虑乘法量化误差的直接型、级联型和并联型网络结
构图如图所示。下面分别计算这三种网络结构的输出信噪比。
eon
xm
z
z
nFynen
en en
esn
a
ein ean
xn 食nynen xn nFynen
z z
eon
en en
esn
b
ern
ten
c
图 例的网络结构图
直接型。
ene。nenenenhn
e×g××元HzHsd
式中
蠹fHzHzd嘉az×a
ResHzHzResHzHz
Created by ZhuangHeng
q×q
级联型。
ene。nhnenenenhn
HhnzTHz
i×fHHzd×嘉HHz
焉fHHz餐嘉aa
ReHHza
g×a×q
并联型。
ene。nenhnenenhn
HZThnhm°un
HzZThnhnun
××∑hinz××Zhn
言×g
以上式中
q
q
此例表明，对同一个系统函数Hz因乘法量化误差在输出端引起的量化噪声功率除
了与量化位数b有关外，还与网络结构形式有关。量化位数b愈长，输出量化噪声愈小；网
络结构中，输出端量化噪声以直接型最大，级联型次之，并联型最小。原因是直接型量化噪
声通过全部网络，经过反馈支路有积累作用，级联型仅一部分噪声通过全部网络，并联型
每个一阶网络的乘法运算量化噪声通过相应的一阶网络后直接送到输出端。而对于三种不
同网络结构输出端的信号功率都是一样的。设输入信号xn方差为o均值m输出
端信号功率用a表示
c∑hm焉fHHz
输出信噪比SN用信号和噪声的功率比计算
S
第章数字信号处理的实现
Created by ZhuangHeng
口
口
口口
口
数字信号处理第五版
因此，输出信噪比也同样随量化位数b增加而增加；网络结构中以并联型输出信噪比最大，
直接型最差。对于定点制，输出信噪比还与输入信号功率有关，应在保证运算中不发生溢
出的前提下，尽量增大输入信号幅度。
实际时域离散线性时不变系统可以用线性常系数差分方程表示：
yn∑bxnayni
所以，不论采用哪种结构，其中与量化有关的基本运算单元如下：
ykxkx
只要调用定点量化函数quant分别对每个基本运算单元量化，求解差分方程，即可得到量
化后的实际系统输出响应yn也可以计算enynyn分析各种结构的有限字长
效应。基本运算ykxkx的MATLAB函数qbcum为
function yqqbcukxlkxbV
本运算ykxxkx的定点量化运算函数
量化尾数位数，V为量化动态范围
klqquantklbVkqquantkbV
xlqquantxbVxqquantxbV
vlklqxlqvlqquantylbV
vkqxqvqquantvbV
yqvlqvq
防止溢出的措施
我们知道，在数字网络中有两种运算，即乘法和加法，由于存在有限寄存器长度效应，
乘法会产生乘法量化效应，加法不会产生量化误差，但却会产生溢出。例如，在定点制网络
系统中，补码二进制加结果为其真值为实际真值应是。
这样，由于加法进位，产生了溢出，形成了很大的误差。在浮点制系统中，由于动态范围
大，一般不产生溢出。下面介绍一般防止溢出的方法。
可以采用限制输入信号动态范围的方法来防止溢出。设网络节点用v表示，从输入节
点xn到v节点的单位脉冲响应为hn
∑hmxnm
lI≤xnm
式中，xlm为xn的最大值。为保证节点v不溢出，要求v那么要求：
c
上式即是对输入信号动态范围的限制。例如，一阶IIR网络，单位取样响应hnaun
a
Created by ZhuangHeng
cla
要求输入信号的动态范围为a显然该动态范围与一阶网络的极点a有关。极点愈靠
近单位圆，限制输入信号的动态范围就愈小。另外，如果输入信号幅度固定在一定范围中，
可以在输入支路上加衰减因子来防止溢出。例如，在图中，为防止溢出，输入支路上
yn xn A 加衰减因子AA。
z ynA∑hmenm a
设xnm则有 图 一阶滤波网络
IynI≤Arhm A
为防止溢出，要求yn即
Ac
对于该例，有
Ala
对于级联型或并联型结构，可在每个基本节的输入支路加衰减因子，如图中A和
A。如果xm图中A和A均按下式计算：
Ao
式中，hm是每个相应基本节的单位脉冲响应。这样可保证每个基本节的输出节点不溢
出。对于基本节内部的加法可能有溢出，但理论可以证明对补码加法，只要输出节点不溢
出，网络内部的溢出不影响结果的正确性。
A A yn
n a zb a zb
a b a b 第章数字信号处理的实现
xn A n
z a
a b
b
z
a
图 级联型与并联型的衰减因子
最后要指出的是按照式或式选择衰减因子是比较保守或者说是比较
Created by ZhuangHeng
苛刻的。经常用下式计算：
C
式中，是大于的数，如果输入信号是方差为的白噪声，可选δ≥。
数字信号处理技术的软件实现
数字信号的处理可以用软件实现，也可以用硬件实现。软件实现指的是在通用计算机
上执行数字信号处理程序。这种方法灵活，但一般不能实现实时处理。硬件实现是利用数
字信号处理专用集成电路或单片数字信号处理器DSPDigital Signal Processor来实现的。
目前，这些器件一般都照顾到数字信号处理的特点，内部带有乘法器、累加器，采用流水线
工作方法以及并行结构，多总线，速度快，并配有适合数字信号处理的指令等。一些特殊的
专用器件有：FFT专用芯片，FIR滤波器、卷积和相关等专用芯片，它的软件算法已在芯
片内部用硬件实现，随着超大规模集成电路的发展，DSP芯片成本在不断下降，从而使这
种实现方法成为数字信号处理的主导方法。本节主要介绍软件实现方法。
在第章已学习过描写系统的线性常系数差分方程，具有递推求解的特点，可以求解
系统的暂态解、稳态解以及系统的单位脉冲响应。求暂态解时，对于N阶差分方程要给定
N个初始条件；求系统的单位脉冲响应时，要令系统初始状态为零和输入信号为单位脉冲
序列。
下面通过例题说明按照差分方程求解系统输出的软件流程图。
【例】 假设两个二阶网络的级联结构如图所示。
数字信号处理第五版 xn bown b yn
ai zbi a b
a b a bs
图 例题图
从n开始加入xn信号，xx初始条件为：w
wyya、a、ay、a、bo、b、b、b、b、b均为已知参数。
要求设计求输出响应的软件流程图。
解 其差分方程为
wnawnawnbxnbxnbxn
ynaynaynbunbunbun
其软件流程图如图所示。
上面介绍了求解差分方程的软件流程图，仿真实验时用MATLAB语言求解最方便。
Created by ZhuangHeng
MATLAB语言的filter函数和 filtic 函数可以求解差分方程。我们知道，系统函数与差分方
程是等价的，系统函数的系数就是差分方程的系数。所以，根据系统函数的系数和初始条
件，调用 filter 函数和 filtic函数可以方便地求系统输出响应。下面是求系统输出响应的
MATLAB通用程序。
xnn…N 输入： aazaabobbbbbs
wDwyxx
wnawnawnboxnbxnbxn
ynawnanbwnbwnbswn
N
n
输出：yn
nn
nN
Y
结束
图 两个二阶网络的级联结构软件流程图
用 filter和 filtic函数求系统输出响应的通用程序
Bbbl…bMAaOal…aN置Hz的分子和分母多项式系数向量B和A
xninputxn 入信号xn也可以直接赋值，或读取数据文件
置初始条件 ysyy…yN
xifilticBAys初始条件计算等效初始条件的输入序列xi设xn为因果序列
用filter求系统输出信号ynn≥ ynfilterBAxnxi
【例】 设系统函数Hzbzxnaun求系统输出响应。
解 对于给定的Hz分子、分母多项式系数B、Ab。
求系统输出的程序epm如下：
m例调用 filter 函数和 filtic 函数求系统输出响应
binputb
ainputa
入差分方程系数b
入信号xn的参数a
BAb
nxnan
ysinputys
xifilticBAys
ynfilterBAxnxi
z的分子、分母多项式系数B、A
算产生输入信号xn的个样值
出初始条件y
初始条件计算等效初始条件的输入序列xi
用 filter解差分方程，求系统输出信号yn
subplotstemnyntitleabay
第章数字信号上理的实现
Created by ZhuangHeng
口
口口
口
口口
口口
口
■口
数字信号处理第五版
xlabelnylabelynaxisminynmaxyn
运行程序，并输入不同的参数b和a以及初始条件，得到系统不同的输出yn波形。
如果bay输出响应如图a所示。如果令初始状态为y
ba得到的是系统的零状态响应，如图c所示。如果令xnunb
y得到的系统响应如图b所示。如果xnunb
y得到的系统响应如图d所示。
yn
yn
o
n n
abay bbay
yn 会
oL
n n
cbay dbay
图 例题系统输出响应
以上求系统输出响应的方法，并没有涉及网络结构的问题，下面我们介绍按照网络结
构编写程序的方法。
首先将信号流图的节点进行排序，延时支路输出节点变量是其输入节点变量前一时刻
已存储的数据，起始时，作为已知值初始条件网络输入是已知数值，这样延时支路输出
节点以及网络输入节点排序k网络中可以由k节点变量计算出的节点排序k
然后由k可以计算出的节点排序k…依照这样的规律进行节点排序，直到将
全部节点排完。最后按照k从小到大写出运算次序。
图a的二阶网络排序如图b所示，图中圆圈中的数字表示排序。其运算
次序如下：
起始数据：vv
aaAa
vxnv
vv
Created by ZhuangHeng
xn
◎ Vs②
V③
b yn
④ ⑤
xn b yn
ai b
b a
①
a
◎
b
V z
①
V
a ◎ b
a b
图 二阶网络的节点排序
vbvv
ynv
数据更新：vvvv
循环执行以上步骤，可完成网络运算。也可以进行简化：、合成一步，、合成
一步。软件流程图如图所示。这种编写程序的方法的特点是充分考虑了不同结构的
特点；只要知道网络结构，不需要写出差分方程，就可编写程序；运算操作的基本公式为
vcxdy。对于图两个二阶网络级联结构，节点排序如图所示，其软件流程
图如图所示。上述软件实现思想适合各种不同的编程语言，如C语言、汇编语
言等。
输入：xnn…N
aazbobb
v
n
vavavzvbbp
vxnv
ynbvv输出yn 第章数字信号处理的实现 vv
nn
N
nN
Y
结束
图 图软件流程
Created by ZhuangHeng
口
□
口
口
口
口
口
口口
口
数字信号处理第五版
xn ◎ ②
③
bo ④
V⑤
V b ⑥ ⑦
yn
⑧
z v
①
a
◎I
b ①
①
V
a
O
ba
VSJ
①
Tvir z
a ◎
b a ◎v
bs
图 图的节点排序
输入：xnn…N
ajaajaabobjbbbabs
vvvv
vaiviajOvbivibO vnoapsaayvnbabgh
vvVVvgvsUI
N
n
Txnv
vbovv
vnvvio
ynbysznsvn
输出：yn
nn
nN
y
结束
图 图的软件流程图
数字信号处理的硬件实现简介
如前所述，数字信号处理可分为软件实现与硬件实现。但实质上这两种实现方法是不
能截然分开的。因为所谓的软件实现，需要硬件支持才能运行，而硬件实现一般也离不开
软件。最流行的通用数字信号处理单片机，通常又称为通用数字信号处理器DSP就是这
种软、硬结合的实现方式，但习惯上将其划为硬件实现。
数字信号处理的硬件实现又可分为专用硬件实现和数字信号处理器实现。前者属于硬
Created by ZhuangHeng
件实现，后者称为软硬结合实现。
所谓硬件实现，就是根据数字滤波器的数学模型和算法，设计专用数字信号处理电路
集成电路使计算程序全部硬件化。专用处理器中的硬件电路包括加法器、乘法器、存储
器、控制器和输入输出接口等。例如按照第章介绍的直接型、级联型、并联型或FFT实
现方案，用FPGA设计实现电路。硬件实现的优点是处理速度高，但灵活性差，开发周期
长。因为硬件电路一旦做好就不易改变如滤波器阶数和结构类型等。
所谓软硬结合实现，就是用通用数字信号处理器DSP实现信号处理系统。DSP实质
上是一种适用于数字信号处理的单片微处理器，其主要特点是灵活性大，适应性强，具有
可编程功能，且处理速度高DSP的指令周期已达到ns级。例如TI公司的TMS系列
DSP就是应用广泛的通用数字信号处理器的典型产品。例如，数字滤波器的DSP实现，就
是设计 DSP硬件电路，充分利用DSP的软硬件资源，开发并优化程序，实现数据采集、滤
波器单位脉冲响应hn与所采集的数字信号xn的快速卷积运算、输出滤波结果。
实际中选用何种实现方法，要视具体要求而定。例如，数字通信中的信道均衡器和雷
达信号处理中，对信号处理要求有限且具体，但要求实时性好，因而可采用专用硬件。在信
号处理算法复杂，处理种类繁多，并要求有智能化控制功能的系统中最好选用DSP实现方
法，以便简化开发过程，缩短开发周期。例如软件无线电和认知无线电系统。
自从年以来，DSP技术引发了现代电子系统设计的革命。在当今数字化时代，
DSP已经成为信号处理、通信、雷达、计算机和消费类电子产品等领域的基础器件。DSP
芯片不同于通用单片微计算机，DSP是一种对数字信号进行高速实时处理的专用单片处理
器，其处理速度比最快的CPU还快～倍。这主要是因为DSP芯片内包含硬件并行乘
法器和并行ALU并采用流水线高速操作。随着集成电路技术的发展，以及精简指令系统
计算机RISC结构的出现，DSP的处理速度不断提高。DSP的字长和处理精度也在不断提
高，从最初的位已经发展到位。以美国德州仪器TD公司为例，其产品有定点DSP和
浮点DSP字长有位、位、位和位，DSP时钟速率高达 GHz以上。例如，
TMSCx具有位数据并行读写端口，内核有个并行位ALU和个并行位
硬件乘法器。所以，DSP技术成为数字信号处理的核心技术。
很多信号处理功能过去在普通微处理器中是用微码实现的，而现在大多是基于高速DSP
硬件实现。DSP技术最主要的贡献是其可编程装置的可塑性，它兼顾了软硬件实现的优点，
可以实现复杂的线性和非线性算法，同时可以跳转到程序的不同部分。所以，相对于基于数字
逻辑电路的专用硬件实现，基于高速DSP的硬件实现开发容易，且开发周期短，更加经济高
效。随着各种新的DSP设计开发平台的出现，DSP实现系统的开发将更加容易。
第章数字信号处理的实现
随着多媒体通信、图像传输与处理、宽带无线接入等领域的高速发展，对信号处理速
度的要求不断提高，DSP实现的速度也不能满足要求。另外，随着超大规模集成电路和可
编程器件的发展，专用硬件实现方法应用越来越广泛。如卫星图像数据实时压缩编码器一
般采用硬件实现。
另外，MATLAB的Simulink 系统仿真组件用来仿真线性系统、非线性系统、连续系
Created by ZhuangHeng
口
口口
口口
品
口
数字信号处理第五版
统、离散系统、连续与离散混合系统、多采样率系统等。还利用MATLAB DSP模块库提供
的关键DSP算法模块能快速高效地进行复杂 DSP系统原理设计与仿真，与RTW
RealTime Workshop配合使用可以为实时DSP硬件生成优化的ANSIC美国国家标准C
语言代码，或把定点DSP程序编译成能在嵌入式系统中执行的C代码。这些也是DSP实
现的现代辅助工具，从事DSP工作的技术人员常常用到它。
由上述可见，不论是基于高速DSP的软硬结合实现，还是专用硬件实现技术，都涉及
很多知识和技术，不可能用一节或一章讲清楚，更不可能使读者理解、掌握并学会使用。例
如，基于高速DSP的实现所涉及的内容有DSP软硬件原理与应用技术、DSP开发平台技
术，工程实现过程包括硬件电路设计与处理程序开发等。这些内容专业性很强，都必须经
过系统学习和工程实践才能掌握。所以，信号处理工程师必须熟悉DSP的硬件结构、指令
系统、软件开发平台、开发方法与开发过程。
但是，只要掌握了数字信号处理的基本原理，再学习其各种实现技术就比较容易。所
以本书仅介绍数字信号处理硬件实现的基本概念和基本方法，以便读者建立数字信号处理
的完整概念。
Created by ZhuangHeng
第章
上机实验
数字信号处理是一门理论和实际密切结合的课程。为了深入掌握课程内容，应在学习
理论的同时，认真做习题和上机实验。上机实验不仅可以帮助读者深入理解和消化基本理
论，而且能锻炼初学者独立解决问题的能力。本章包括六个实验，前五个实验属基础理论
实验，第六个属综合应用实验。实验名称如下：
实验一：系统响应及系统稳定性
实验二：时域采样与频域采样
实验三：用FFT对信号作频谱分析
实验四：IIR数字滤波器设计及软件实现
实验五：FIR数字滤波器设计与软件实现
实验六：综合实验——数字信号处理在双音多频拨号系统中的应用
任课教师可根据教学进度，安排学生上机进行实验。建议自学的读者在学习完第章
后做实验一；在学习完第、章后做实验二和实验三；实验四在学习完第章后进行；实
验五在学习完第章后进行；实验六在学习完本课程后再进行。
实验一：系统响应及系统稳定性
实验目的
掌握求系统响应的方法。
掌握时域离散系统的时域特性。
第口章上机实验
Created by ZhuangHeng
口口
数字信号处理第五版
分析、观察及检验系统的稳定性。
实验原理与方法
在时域中，描写系统特性的方法是差分方程和单位脉冲响应，在频域可以用系统函数
描述系统特性。已知输入信号，可以由差分方程、单位脉冲响应或系统函数求出系统对于
该输入信号的响应，本实验仅在时域求解。在计算机上适合用递推法求差分方程的解，最
简单的方法是采用MATLAB语言的工具箱函数 filter 函数。也可以用MATLAB语言的工
具箱函数conv函数计算输入信号和系统的单位脉冲响应的线性卷积，求出系统的响应。
系统的时域特性指的是系统的线性时不变性质、因果性和稳定性。重点分析系统的稳
定性，包括观察系统的暂态响应和稳态响应。
系统的稳定性是指对任意有界的输入信号，系统都能得到有界的系统响应。或者系统
的单位脉冲响应满足绝对可和的条件。系统的稳定性由其差分方程的系数决定。
实际中检查系统是否稳定，不可能检查系统对所有有界的输人信号，输出是否都是有
界输出，或者检查系统的单位脉冲响应满足绝对可和的条件。可行的方法是在系统的输入
端加入单位阶跃序列，如果系统的输出趋近一个常数包括零就可以断定系统是稳定
的。系统的稳态输出是指当n→∞时系统的输出。如果系统稳定，信号加入系统后，系统
输出的开始一段称为暂态响应，随n的加大，幅度趋于稳定，达到稳态输出。
注意：在以下实验中均假设系统的初始状态为零。
实验内容及步骤
编制程序，包括产生输入信号、单位脉冲响应序列的子程序，以及用 filter 函数或
conv 函数求解系统输出响应的主程序。程序中要有绘制信号波形的功能。
给定一个低通滤波器的差分方程为
ynxnxnyn
输入信号
znRnxnun
①分别求出xnRn和xnun的系统响应，并画出其波形。
②求出系统的单位脉冲响应，画出其波形。
给定系统的单位脉冲响应为
hnRn
hnnnnδn
用线性卷积法求xnRn分别对系统hn和hn的输出响应，并画出波形。
给定一谐振器的差分方程为
ynynynbxnbxn
令b谐振器的谐振频率为 rad
①用实验方法检查系统是否稳定。输入信号为un时，画出系统输出波形。
②给定输入信号为
xnsinnsinn
Created by ZhuangHeng
求出系统的输出响应，并画出其波形。
思考题
如果输入信号为无限长序列，系统的单位脉冲响应是有限长序列，可否用线性卷
积法求系统的响应如何求
如果信号经过低通滤波器，把信号的高频分量滤掉，时域信号会有何变化用实验
内容的①的结果进行分析说明。
实验报告要求
简述在时域求系统响应的方法。
简述通过实验判断系统稳定性的方法。分析实验内容的①的稳定输出的波形。
对各实验所得结果进行简单分析和解释。
简要回答思考题。
打印程序清单和要求的各信号波形。
实验二：时域采样与频域采样
实验目的
时域采样理论与频域采样理论是数字信号处理中的重要理论。要求掌握模拟信号
采样前后频谱的变化，以及如何选择采样频率才能使采样后的信号不丢失信息；要求
掌握频域采样会引起时域周期化的概念，以及频域采样定理及其对频域采样点数选择
的指导作用。
实验原理与方法
时域采样定理的要点是：
①对模拟信号xt以T进行时域等间隔理想采样，形成的采样信号的频谱Xj是
原模拟信号频谱Xj以采样角频率ΩΩπT为周期进行周期延拓。公式为
xjFTa。÷∑xinjn
②采样频率Ω必须大于等于模拟信号最高频率的两倍以上，才能使采样信号的频谱
不产生频谱混叠。
利用计算机计算上式并不方便，下面我们导出另外一个公式，以便在计算机上进行
实验。
理想采样信号xt和模拟信号xt之间的关系为
z∑anT
第章上机实验
对上式进行傅里叶变换，得到：
Created by ZhuangHeng
数字信号处理第五版
XGin厂z②∑tnTed
xnTed
在上式的积分号内只有当tnT时，才有非零值，因此：
XGin∑znTe
上式中，在数值上xnTxn再将wΩT代入，得到：
Xjin∑zne
上式的右边就是序列的傅里叶变换Xe即
XjXer
上式说明采样信号的傅里叶变换可用相应序列的傅里叶变换得到，只要将自变量w用ΩT
代替即可。
频域采样定理的要点是：
①对信号xn的频谱函数Xe在π上等间隔采样N点，得到：
XNkXeL梦 k…N
则N点IDFTXNk得到的序列就是原序列xn以N为周期进行周期延拓后的主值区
序列，公式为
zNnIDFTXakxzniNRnn
②由上式可知，频域采样点数N必须大于等于时域离散信号的长度M即N≥M才
能使时域不产生混叠，则N点IDFTXk得到的序列xxn就是原序列xn
即xnnxn。如果NMxxn比原序列尾部多NM个零点；如果NM则
xnnIDFTXNk发生了时域混叠失真，而且xxn的长度N也比xn的长度M短，
因此，xn与xn不相同。
在数字信号处理的应用中，只要涉及时域或者频域采样，都必须服从这两个采样理论
的要点。
对比上面叙述的时域采样原理和频域采样原理，得到一个有用的结论：这两个采样理
论具有对偶性，即“时域采样频谱周期延拓，频域采样时域信号周期延拓”。因此，将它们放
在一起进行实验。
实验内容及步骤
时域采样理论的验证。给定模拟信号
xtAe sinΩtut
式中，Aa√πΩ√π rads它的幅频特性曲线如图所示。
现用DFTFFT求该模拟信号的幅频特性，以验证时域采样理论。
Created by ZhuangHeng
x
fHz
图 x的幅频特性曲线
按照xt的幅频特性曲线，选取三种采样频率，即FkHz Hz Hz。观
测时间选T ms。
为使用DFT首先用下面的公式产生时域离散信号，对三种采样频率、采样序列按顺
序用xn、xn、xn表示。
xnxnTAesinΩnTunT
因为采样频率不同，得到的xn、xn、xn的长度不同，长度点数用公式N
T。×F计算。选FFT的变换点数为M序列长度不够的尾部加零。
XkFFTxnk…M
式中，k代表的频率为
要求：编写实验程序，计算xn、xn和xn的幅度特性，并绘图显示。观察分析
频谱混叠失真。
频域采样理论的验证。给定信号如下： 第章上机实验 编写程序分别对频谱函数XeFTxn在区间π上等间隔采样 点和点，
得到Xk和Xk
XakXe一建 k…
XkXeL k…
再分别对Xk和Xk进行点和点IFFT得到xn和xn
xnIFFTXkn…
xnIFFTXkn…
分别画出Xe、Xk和Xk的幅度谱，并绘图显示 xn、xnn和xn的波形，
进行对比和分析，验证总结频域采样理论。
提示：频域采样用以下方法容易编程实现。
直接调用MATLAB函数fft计算XkFFTxn就得到Xe在π
Created by ZhuangHeng
数字信号处理第五版
的点频率域采样Xk。
抽取Xk的偶数点即可得到Xe”在π的点频率域采样Xk即
XkXkk…。
当然，也可以按照频域采样理论，先将信号rn以为周期进行周期延拓，取其
主值区点再对其进行点DFTFFT得到的就是Xe在π上的点频率
域采样Xk。
思考题
如果序列xn的长度为M希望得到其频谱Xe在π上的N点等间隔采样，
当NM时，如何用一次最少点数的DFT得到该频谱采样
实验报告及要求
运行程序，打印要求显示的图形。
分析比较实验结果，简述由实验得到的主要结论。
简要回答思考题。
附上程序清单和有关曲线。
实验三：用FFT 对信号作频谱分析
实验目的
学习用FFT对连续信号和时域离散信号进行谱分析的方法，了解可能出现的分析误差
及其原因，以便正确应用FFT。
实验原理
用FFT对信号作频谱分析是学习数字信号处理的重要内容。经常需要进行谱分析的信
号是模拟信号和时域离散信号。对信号进行谱分析的重要问题是频谱分辨率D和分析误
差。频谱分辨率直接和FFT的变换区间N有关，因为FFT能够实现的频率分辨率是
πN因此要求πN≤D。可以根据此式选择FFT的变换区间N。误差主要来自用FFT
作频谱分析时，得到的是离散谱，而信号周期信号除外是连续谱，只有当N较大时，离
散谱的包络才能逼近于连续谱，因此N要适当选择大一些。
周期信号的频谱是离散谱，只有用整数倍周期的长度作FFT得到的离散谱才能代表
周期信号的频谱。如果不知道信号周期，可以尽量选择信号的观察时间长一些。
对模拟信号进行谱分析时，首先要按照采样定理将其变成时域离散信号。如果是模拟
周期信号，也应该选取整数倍周期的长度，经过采样后形成周期序列，按照周期序列的谱
分析进行。
实验步骤及内容
对以下序列进行谱分析：
Created by ZhuangHeng
xnRn
选择FFT的变换区间N为和两种情况进行频谱分析。分别打印其幅频特性曲
线，并进行对比、分析和讨论。
对以下周期序列进行谱分析：
zncos”
xncosncos”
选择FFT的变换区间N为和两种情况分别对以上序列进行频谱分析。分别打印
其幅频特性曲线，并进行对比、分析和讨论。
对模拟周期信号进行谱分析：
xtcosπtcosπtcosπt
选择采样频率F Hz对变换区间N三种情况进行谱分析。分别打印其幅
频特性，并进行分析和讨论。
思考题
对于周期序列，如果周期不知道，如何用FFT进行谱分析
如何选择FFT的变换区间包括非周期信号和周期信号
当N时，xn和xn的幅频特性会相同吗为什么N呢
实验报告要求
完成各个实验任务和要求，附上程序清单和有关曲线。
第章上机实验
简要回答思考题。
实验四：IIR数字滤波器设计及软件实现
实验目的
熟悉用双线性变换法设计IIR 数字滤波器的原理与方法；
学会调用MATLAB信号处理工具箱中滤波器设计函数或滤波器设计分析工具
FDATool设计各种IIR 数字滤波器，学会根据滤波需求确定滤波器指标参数。
掌握IIR数字滤波器的MATLAB实现方法。
通过观察滤波器输入、输出信号的时域波形及其频谱，建立数字滤波的概念。
Created by ZhuangHeng
口
口口
口
数字信号处理第五版
实验原理
设计IIR数字滤波器一般采用间接法脉冲响应不变法和双线性变换法应用最广泛
的是双线性变换法。基本设计过程是：①将给定的数字滤波器的指标转换成过渡模拟滤波
器的指标；②设计过渡模拟滤波器；③将过渡模拟滤波器系统函数转换成数字滤波器的系
统函数。MATLAB信号处理工具箱中的各种IIR 数字滤波器设计函数都是采用双线性变
换法。第章介绍的滤波器设计函数butter、cheby 、cheby和ellip可以分别被调用来直
接设计巴特沃斯、切比雪夫、切比雪夫以及椭圆模拟与数字滤波器。本实验要求读者调
用如上函数直接设计IIR 数字滤波器。
本实验的数字滤波器的MATLAB实现是指调用MATLAB信号处理工具箱函数 filter
对给定的输入信号xn进行滤波，得到滤波后的输出信号yn。
实验内容及步骤
调用信号产生函数mstg产生由三路抑制载波调幅信号相加构成的复合信号st该
函数还会自动绘图显示st的时域波形和幅频特性曲线，如图所示。由图可见，三路
信号时域混叠无法在时域分离。但频域是分离的，所以可以通过滤波的方法在频域分离，
这就是本实验的目的。
会
Vs
ast的波形
幅度
L
fHz
bst的频谱
图 三路调幅信号st即st的时域波形和幅频特性曲线
要求将st中三路调幅信号分离，通过观察st的幅频特性曲线，分别确定可以分离
st 中三路抑制载波单频调幅信号的三个滤波器低通滤波器、带通滤波器、高通滤波器
的通带截止频率和阻带截止频率。要求滤波器的通带最大衰减为 dB阻带最小衰减为
dB。
提示：抑制载波单频调幅信号的数学表示式为
scosnfatcosmfcosπffocosπf。fo
其中，cosπft称为载波，f。为载波频率，cosπft称为单频调制信号，f。为调制正弦
Created by ZhuangHeng
波信号频率，且满足ff。由上式可见，所谓抑制载波单频调幅信号，就是两个正弦信
号相乘，它有个频率成分：和频f。f。、差频f。f。这两个频率成分关于载波频率f。
对称。所以，路抑制载波单频调幅信号的频谱图是关于载波频率f。对称的两根谱线。容
易看出，图中三路调幅信号的载波频率分别为 Hz、 Hz、 Hz。有关调
幅AM和抑制载波调幅SCAM的一般原理与概念，请参考通信原理教材。
编程序调用MATLAB滤波器设计函数ellipord和ellip分别设计这三个椭圆滤波
器，并绘图显示其损耗函数曲线。
调用滤波器实现函数 filter用三个滤波器分别对信号产生函数mstg产生的信号
st进行滤波，分离出st中的三路不同载波频率的调幅信号yn、yn和yn并绘图
显示 yn、yn和yn的时域波形，观察分离效果。
信号产生函数mstg清单
function stmstg
生信号序列向量st并显示st的时域波形和幅频曲线
tmstg 返回三路调幅信号相加形成的混合信号，长度N
N 为信号st的长度
FsTFsTpNT样频率FskHzTp为采样时间
tTNTkNfkTp
felFs 路调幅信号的载波频率fel Hz
路调幅信号的调制信号频率fml Hz fmIfel
路调幅信号的载波频率fe Hz feFs
路调幅信号的调制信号频率fm Hz fmfe
路调幅信号的载波频率fe Hz feFs
路调幅信号的调制信号频率fm Hz fmfe
生第路调幅信号 xtlcospifmlt。cospifel
生第路调幅信号 xtcospifmt。cospifet
生第路调幅信号 xtcospifmtcospifet
路调幅信号相加 stxtxtxt
算信号st的频谱 fxtfftstN
以下为绘图部分，绘制st的时域波形和幅频特性曲线
第章上机实验
subplot
plottstgridxlabelCtsylabelst
axisTpminstmaxsttitlecast的波形
subplot
stemfabsfxtmaxabsfxtgridtitlebst的频谱’
axisFs
xlabelCtHzylabel幅度
实验程序框图
实验程序框图如图所示，供读者参考。
Created by ZhuangHeng
口口
数字信号处理第五版
调用函数mstg产生st自动绘图显示st
的时域波形和幅频特性曲线
调用ellipord和ellip分别设计三个椭圆滤
波器，并绘图显示其幅频响应特性曲线
调用filter用三个滤波器分别对信号st进行滤波，分离
出三路不同载波频率的调幅信号yin、yn和yn
绘图显示yn、yn和yn的时域波形
结 束
图 实验四程序框图
思考题
请阅读信号产生函数mstg确定三路调幅信号的载波频率和调制信号频率。
信号产生函数mstg中采样点数N对st进行N点FFT可以得到根理想
谱线。如果取N可否得到根理想谱线为什么N呢请改变函数mstg
中采样点数N的值，观察频谱图验证您的判断是否正确。
修改信号产生函数mstg给每路调幅信号加入载波成分，产生调幅AM信号，重
复本实验，观察AM信号与抑制载波调幅信号的时域波形及其频谱的差别。
提示：AM信号表示式：
stAAcosπftcosπft A≥Am
实验报告要求
简述实验目的及原理。
画出实验主程序框图，打印程序清单。
绘制三个分离滤波器的损耗函数曲线。
绘制经过滤波分离出的三路抑制载波调幅信号的时域波形。
简要回答思考题。
实验五：FIR数字滤波器设计与软件实现
实验目的
掌握用窗函数法设计FIR数字滤波器的原理和方法。
Created by ZhuangHeng
掌握用等波纹最佳逼近法设计FIR数字滤波器的原理和方法。
掌握FIR滤波器的快速卷积实现原理。
学会调用MATLAB函数设计与实现FIR滤波器。
实验内容及步骤
认真复习第章中用窗函数法和等波纹最佳逼近法设计FIR数字滤波器的原理；
调用信号产生函数xtg产生具有加性噪声的信号xt并自动显示xt及其频谱，如
图所示。
ts
a信号加噪声波形
幅度
fHz
b信号加噪声的频谱
图 具有加性噪声的信号xt即xt及其频谱图
请设计低通滤波器，从高频噪声中提取xt中的单频抑制载波调幅信号，要求信号
幅频失真小于 dB将噪声频谱衰减 dB。观察xt的频谱，确定滤波器指标参数。
根据滤波器指标选择合适的窗函数，计算窗函数的长度N调用MATLAB函数
firl设计一个FIR低通滤波器。并编写程序，调用MATLAB快速卷积函数fftfilt实现对xt
的滤波。绘图显示滤波器的频响特性曲线、滤波器输出信号的幅频特性图和时域波形图。
重复滤波器指标不变，但改用等波纹最佳逼近法设计FIR 滤波器，调用
MATLAB函数 remezord和 remez设计FIR数字滤波器。比较两种设计方法设计的滤波器
阶数。
提示：
①MATLAB函数firl和fftfilt的功能及其调用格式请查阅本书节和节；
②采样频率Fs Hz采样周期TFs
③根据图b和实验要求，可选择滤波器指标参数：通带截止频率f Hz阻
带截止频率f Hz换算成数字频率，通带截止频率wπfTπ通带最大衰
为dB阻带截止频率wπfTπ阻带最小衰为 dB。
实验程序框图
实验程序框图如图所示，供读者参考。
第章
上机实验
Created by ZhuangHeng
口
口
口口
■
口口
口
口
■■■ ■
口
数字信号处理第五版
FsTFs
xtxtg
产生信号xt并显示xt及其频谱
用窗函数法或等波纹最佳逼近法设
计FIR滤波器hn
对信号xt滤波：ytffilthnxt
计算并绘图显示滤波器损耗函数
绘图显示滤波器输出信号yt及其频谱
结 束
图 实验五程序框图
思考题
如果给定通带截止频率和阻带截止频率以及阻带最小衰减，如何用窗函数法设计
线性相位低通滤波器请写出设计步骤。
如果要求用窗函数法设计带通滤波器，且给定通带上、下截止频率为wg和wm阻
带上、下截止频率为w和w试求理想带通滤波器的截止频率w和w
解释为什么对同样的技术指标，用等波纹最佳逼近法设计的滤波器阶数低。
实验报告要求
对两种设计FIR滤波器的方法窗函数法和等波纹最佳逼近法进行分析比较，简
述其优缺点。
附程序清单，打印实验内容要求绘图显示的曲线图。
分析总结实验结果。
简要回答思考题。
信号产生函数xtg程序清单
function xtxtg
验五信号xt产生函数，并显示信号的时域波形和幅频特性曲线
xtg产生一个长度为N有加性高频噪声的单频调幅信号xtN
样频率Fs Hz
波频率fcFsHz调制正弦波频率ffe Hz
NFsTFsTpNT
tTNT
Created by ZhuangHeng
波频率feFs单频调制信号频率为fFe fcFsffe
生单频正弦波调制信号mt频率为f mtcospif
生载波正弦波信号ct频率为fe ctcospifet
乘产生单频调幅信号xt xtmtct
ntrandN 生随机噪声nt
设计高通滤波器 hn用于滤除噪声nt中的低频成分，生成高通噪声
fpfsRpAs波器指标
算remezord 函数所需参数fmdev fbfpfsm
devAsRpRp
nfomoWremezordfbmdevFs定 remez函数所需参数
hnremeznfomoW 用 remez函数进行设计，用于滤除噪声nt中的低频成分
ytfilterhnnt 除随机噪声中低频成分，生成高通噪声yt
以下为绘图部分
xtxtyt声加信号
fstfftxtNkNfkTp
subplotplottxtgridxlabeltsylabelxt
axisTpminxtmaxxttitlea信号加噪声波形′
subplotplotfabsfstmaxabsfstgridtitleb信号加噪声的频谱′
axisFsxlabelCtHzylabelC幅度
实验六：数字信号处理在双音多频拨号系统中的应用
引言
双音多频Dual Tone Multi FrequencyDTMF信号是音频电话中的拨号信号，由美
国ATT贝尔公司实验室研制，并用于电话网络中。这种信号制式具有很高的拨号速
度，且容易自动监测识别，很快就代替了原有的用脉冲计数方式的拨号制式。这种双音多
频信号制式不仅用在电话网络中，还可以用于传输十进制数据的其他通信系统中，如电子
邮件和银行系统中。这些系统中用户可以用电话发送DTMF 信号，选择语音菜单进行
操作。
第章上机实验
DTMF信号系统是一个典型的小型信号处理系统，它用数字方法产生模拟信号并进行
传输，其中还用到了DA变换器；在接收端用AD变换器将其转换成数字信号，并进行数
字信号处理与识别。为了提高系统的检测速度并降低成本，还开发出一种特殊的DFT算
法，称为戈泽尔Goertzel算法，这种算法既可以用硬件专用芯片实现，也可以用软件实
现。下面首先介绍双音多频信号的产生方法和检测方法，包括戈泽尔算法，最后进行模拟
实验。下面先介绍电话中的DTMF 信号的组成。
在电话中，数字～的中每一个都用两个不同的单音频传输，所用的个频率分成高
频带和低频带两组，低频带有四个频率： Hz Hz Hz和 Hz高频带也有
Created by ZhuangHeng
数字信号处理第五版
四个频率： Hz Hz Hz和 Hz。每一个数字均由高、低频带中各一个
频率构成，例如用 Hz和 Hz两个频率，信号用sinπftsinπft表示，其
中f Hzf Hz。这样个频率形成种不同的双频信号。具体号码以及符
号对应的频率如表所示。表中最后一列在电话中暂时未用。
表 双频拨号的频率分配
DTMF 信号在电话中有两种作用，一个是用拨号信号去控制交换机接通被叫的用户电
话机，另一个作用是控制电话机的各种动作，如播放留言、语音信箱等。
电话中的双音多频DTMF信号的产生与检测
双音多频信号的产生
假设时间连续的DTMF 信号用xtsinπfsinπfL表示，式中f和f是
按照表选择的两个频率，秀代表低频带中的一个频率，f。代表高频带中的一个频
率。显然采用数字方法产生DTMF信号，方便而且体积小。下面介绍采用数字方法产生
DTMF信号。规定用kHz对DTMF信号进行采样，采样后得到时域离散信号为
列
行
Hz Hz Hz Hz
Hz A
Hz B
Hz C
Hz 井 D
xnsinsin
形成上面序列的方法有两种，即计算法和查表法。用计算法求正弦波的序列值容易，
但实际中要占用一些计算时间，影响运行速度。查表法是预先将正弦波的各序列值计算出
来，寄存在存储器中，运行时只要按顺序和一定的速度取出便可。这种方法要占用一定的
存储空间，但是速度快。
由于采样频率是 Hz因此要求每ms输出一个样本，得到的序列再送到DA
变换器和平滑滤波器，输出便是连续时间的DTMF信号。DTMF信号通过电话线路送到交
换机。
双音多频信号的检测
在接收端，要对收到的双音多频信号进行检测，检测两个正弦波的频率是多少，以判
断所对应的十进制数字或者符号。显然，这里仍然要用数字方法进行检测，因此要将收到
的时间连续DTMF信号经过AD变换，变成数字信号进行检测。检测的方法有两种，一
种是用一组滤波器提取所关心的频率，根据有输出信号的个滤波器判断相应的数字或符
号；另一种是用DFTFFT对双音多频信号进行频谱分析，由信号的幅度谱判断信号的两
Created by ZhuangHeng
个频率，最后确定相应的数字或符号。当检测的音频数目较少时，用滤波器组实现更为合
适。FFT是DFT的快速算法，但当DFT的变换区间较小时，FFT快速算法的效果并不明
显，而且还要占用很多内存，因此不如直接用DFT合适。下面介绍Goertzel算法，这种算
法的实质是直接计算DFT的一种线性滤波方法。这里略去Goertzel算法的介绍请参考文
献可以直接调用MATLAB信号处理工具箱中戈泽尔算法的函数Goertzel计算N
点DFT的几个感兴趣的频点的值。
检测DTMF信号的DFT参数选择
用DFT检测模拟DTMF 信号所含有的两个音频频率，是一个用DFT对模拟信号进行
频谱分析的问题。根据第章用DFT对模拟信号进行谱分析的理论，确定三个参数：①采
样频率F② DFT的变换点数N③对信号的观察时间的长度T。这三个参数不能随意
选取，要根据对信号频谱分析的要求进行确定。这里对信号频谱分析也有三个要求：①频
率分辨率；②谱分析的频谱范围；③检测频率的准确性。
频谱分析的分辨率
观察要检测的个频率，相邻间隔最小的是第一和第二个频率，间隔是 Hz要求
DFT最少能够分辨相隔 Hz的两个频率，即要求 F Hz。DFT的分辨率和对信号
的观察时间T。有关，TmFms。考虑到可靠性，留有富余量，要求按
键的时间大于 ms。
频谱分析的频率范围
要检测的信号频率范围是 Hz但考虑到存在语音干扰，除了检测这个频
率外，还要检测它们的二次倍频的幅度大小，波形正常且干扰小的正弦波的二次倍频是很
小的，如果发现二次谐波很大，则不能确定这是DTMF信号。这样，频谱分析的频率范围
为～ Hz。按照采样定理，最高频率不能超过折叠频率，即F≥ Hz由此
要求最小的采样频率应为 kHz。因为数字电话总系统已经规定FkHz因此对频
谱分析范围的要求是一定满足的。按照TmmsFkHz算出对信号最少的采
样点数为NmmTpmm·F≈。 第章上机实验
检测频率的准确性
这是一个用DFT检测正弦波频率是否准确的问题。序列的N点DFT是对序列频谱函
数在～π区间的N点等间隔采样，如果是一个周期序列，截取周期序列的整数倍周期，
进行DFT其采样点刚好在周期信号的频率上，DFT的幅度最大处就是信号的准确频率。
分析这些DTMF信号，不可能经过采样得到周期序列，因此存在检测频率的准确性问题。
DFT的频率采样点频率为wπkNk…N相应的模拟域采样点
频率为fFkNk…N希望选择一个合适的N使用该公式算出的
f能接近要检测的频率，或者用个频率中的任一个频率f代入公式fFkN中时，
得到的k值最接近整数值，这样虽然用幅度最大点检测的频率有误差，但可以准确判断所
对应的DTMF频率，即可以准确判断所对应的数字或符号。经过分析研究认为N是
最好的。按照FkHzN算出个基频及其二次谐波对应的k值以及k取整数
Created by ZhuangHeng
口口
口
口
口
口
口口
口口
口口
口
数字信号处理第五版
时的频率误差见表。
表 个基频及其二次谐波对应的k值以及k取整数时的频率误差
通过以上分析，确定FkHzNTms。键入数字时，按键时间大
于ms。
个基频
Hz
最近的
整数k值
DFT的
k值
绝对误差 二次谐波
Hz
对应的
k值
最近的
整数k值 绝对误差
DTMF信号的产生与识别仿真实验
下面先介绍MATLAB工具箱函数goertzel然后介绍DTMF 信号的产生与识别仿真
实验程序。goerztel函数的调用格式为
XgkgoertzelxnK
其中，xn是被变换的时域序列，用于DTMF信号检测时，xn就是DTMF 信号的个采
样值；K是要求计算的DFTxn的频点序号向量，用N表示xn的长度，则要求≤K≤N。由
表可知，如果只计算DTMF信号个基频时，
K
如果同时计算个基频及其二次谐波时，
K
Xgk是变换结果向量，其中存放的是由K指定的频率点的DFTxn的值。设XK
DFTxn则XgkiXKii…lengthK。
DTMF信号的产生与识别仿真实验在MATLAB环境下进行，编写仿真程序，运行程
序，送入位电话号码，程序自动产生与每一位号码数字相应的DTMF信号，并送出双频
声音；再用DFT进行谱分析，显示每一位号码数字的DTMF信号的DFT幅度谱，按照幅
度谱的最大值确定对应的频率；接着按照频率确定每一位对应的号码数字；最后输出位
电话号码。
本实验程序较复杂，所以将仿真程序提供给读者，只要求读者读懂程序，直接运行程
序仿真。程序名为exp。程序分四段：第一段～行设置参数，并读入位电话号码：
第二段行根据键入的位电话号码产生时域离散DTMF信号，并连续发出位号
Created by ZhuangHeng
码对应的双音频声音；第三段行对时域离散DTMF信号进行频率检测，画出幅度
谱；第四段～行根据幅度谱的两个峰值，分别查找并确定输入的位电话号码。根
据程序中的注释很容易分析编程思想和处理算法。程序清单如下：
TMF双音多频拨号信号的生成和检测仿真程序：expm
tmMF信号代表的个数
NK个基频对应的个k值
频率向量 f
频率向量
TNinput键入位电话号码 入位数字
收端电话号码初值为零 TNr
别对每位号码数字处理：产生信号，发声，检测 for m
dfixTNm 算出第m位号码数字
TNTNdm
for p
for q
if tmpqabsdbreakend 检测与第m位号码相符的列号q
end
if tmpqabsdbreakend 检测与第m位号码相符的行号p
end
n 了发声，加长序列
xsinpinfpsinpinfq成双频信号
soundx 出声音
pause 邻号码响声之间加秒停顿
收检测端的程序
XgoertzelxNK Goertzel算法计算八点DFT样本
valabsX 出八点DFT的模
subplotstemKvalgridxlabelkylabelCXk”
■
第章上机实验
出点DFT的幅度
axis
limit 频检测门限为
for s
if valslimitbreakend 找列号
end
for r
if valrlimitbreakend找行号
end
TNrTNrtmrsm位电话号码表示成一个位数，以便显示
end
disp接收端检测到的号码为：
Created by ZhuangHeng
口口
口口
a口
口
数字信号处理第五版
dispTNr 示接收到的位电话号码
运行程序，根据提示键入位电话号码回车后可以听见位电话号码对应的
DTMF信号的声音，并输出相应的幅频谱图如图所示，左上角的第一个图在k
和k两点出现峰值，所以对应第一位号码数字。最后显示检测到的电话号码
。
实验内容
运行仿真程序expm任意送入位电话号码，打印出相应的幅度谱。观察程序
运行结果，对照表和表判断程序谱分析的正确性。
Xk xk
l
业 逆
k k
Xk Xk
ol i
k k
Xk xx
ol o
k k
图 位电话号码的DTMF信号在个近似基频点的DFT幅度
分析该仿真程序，将产生、检测和识别位电话号码的程序改为能产生、检测和
识别位的程序，并运行一次，打印出相应的幅度谱和位电话号码。
实验报告
打印位和位电话号码DTMF信号的幅度谱。
简述DTMF信号的参数：采样频率、DFT的变换点数以及观测时间的确定原则。
Created by ZhuangHeng
附录
附录A 用Masson公式求网络传输函数Hz
已知信号流图，按照Masson公式可以直接写出传输函数HzMasson公式为
HaT A
式中，△称为流图特征式，其计算公式如下：
△∑L∑LL∑LLL…
∑L 式中： 表示所有环路增益之和；
∑LiL 表示每两个互不接触的环路增益乘积之和；
LLL表示每三个互不接触的环路增益乘积之和；
附录
T表示从输入节点到输出节点的第k条前向通路的增益；
△。表示不与第k条前向通路接触的那部分流图的△值。
例如，利用Masson公式求图A所示流图的系统函数Hz图中有四个环路：
L由x→x→x
L由x→x→x→x→x→x
L由x→x→x→x→x
L由x→x→x→x
它们的环路增益分别为：
LHGLHHHHG
LHHHGLHHG
互不接触的环路有一对，两个环路增益乘积为
LLHGHHG
Created by ZhuangHeng
口
数字信号处理第五版
H H
xn H H H H
yn
H
G G
图A
没有三个互不接触的环路，因此
△HGHHHHGHHHGHHGHGHHG
从输入节点到输出节点有三条前向通路：
Txn→x→x→x→x→xs→yn
THHHHH
Txn→x→a→x→xg→yn
THHHH
Taxn→x→x→x→yn
THHH
由于前向通路T和T。没有不接触的环路，所以，△△与前向通路T不接
触的环路只有L因此△HG最后得到网络的传输函数为
HzTiATAT△
附录B MATLAB信号处理工具箱函数索引表
版本R
分 类 函 数 名 功 能说 明 本函数首次出现
所在的章节或例题
angle 相角 节
freqs 模拟系统频率响应
freqspace 为频率响应设定频率间隔
一
freqz 数字滤波器频率响应 节，例
滤波器分析
abs 幅值 节
freqzplot 频率响应绘制
fvtool 滤波器可视化工具
grpdelay 群时延
一
impz 脉冲响应离散的
unwrap 修正相位，使其范围不限于主角士π
zplane 画出离散的零极点增益 节，例
Created by ZhuangHeng
续表一
分 类 函 数 名 功 能 说 明 本函数首次出现
所在的章节或例题
conv 二维卷积
deconv 解卷积
fftfilt 重叠相加滤波器实现 节，例
filter 滤波器实现 节
filter 二维滤波器实现
一
滤波器实现
conv 卷积计算
一
filtfilt 零相位滤波
filtic 确定滤波器原始条件 节
latefilt 格形滤波器实现
一
medfilt 一维中值滤波
一
sgolayfilt Savitzky Golay滤波器实现
sosfilt 二阶环节biquad滤波器实现
upfirdn 先高采样，后FIP滤波，再低采样
cremez 复非线性相位等波动FIR滤波器设计
firl 基于窗函数FIR滤波器设计 节，例
例例
fir 基于窗函数的任意响应FIR滤波器设计 节
fircls 约束最小二乘法任意响应滤波器设计
一
firelsl 约束最小二乘法低通和高通滤波器设计
FIR滤波器设计
convmtx 卷积矩阵
一
firls 最小二乘法FIR滤波器设计
firrcos 上升余弦FIR滤波器设计
intfilt 插值FIR滤波器设计
kaiserord 基于窗函数的Kaiser滤波器阶数选择
remez Parks MeClellan最适合FIR滤波器设计 节，例
例例
remezord Parks MeClellan滤波器阶数估计 节
sgolay Savitzky Golay FIR平滑滤波器设计
附录
Created by ZhuangHeng
数字信号处理第五版
续表二
分 类 函 数 名 功 能 说 明 本函数首次出现
所在的章节或例题
chebyl 切比雪夫I型滤波器设计 节
IIR数字
滤波器设计
butter 巴特沃斯滤波器设计 例例
cheby 切比雪夫Ⅱ型滤波器设计 节
ellip 椭圆型滤波器设计 节，例
maxflat 归一化的巴特沃斯低通滤波器设计
yulewalk 耶鲁—沃克滤波器设计
IIR滤波器
阶数估算
buttord 巴特沃斯滤波器阶数选择 节，例
cheblord 切比雪夫I型滤波器阶数选择 节，例
chebord 切比雪夫Ⅱ型滤波器阶数选择 节，例
ellipord 椭圆形滤波器阶数选择 节，例
buttap 巴特沃斯滤波器原型 节
模拟低通
滤波器原型
besselap 贝塞尔滤波器原型
cheblap 切比雪夫I型滤波器原型通带波动 节
chebap 切比雪夫Ⅱ型滤波器原型阻带波动 节
ellipap 椭圆滤波器原型 节
butter 巴特沃斯滤波器设计
模拟低通
滤波器设计
besself 贝塞尔模拟滤波器设计
cheby 切比雪夫I型滤波器设计 节，例
cheby 切比雪夫Ⅱ型滤波器设计 节，例
ellip 椭圆滤波器设计 节
模拟滤波器
频带变换
lpbp 低通向带通模拟滤波器变换
Ipbs 低通向带阻模拟滤波器变换
一
lphp 低通向高通模拟滤波器变换 例
lplp 低通向低通模拟滤波器变换
滤波器离散化
bilinear 有预先修正选项的双线性变换 例
impinvar 脉冲响应不变法模拟向数字的转换 节，例
Created by ZhuangHeng
续表三
分 类 函 数 名 功 能 说 明 本函数首次出现
所在的章节或例题
polystab 使多项式稳定
polyscale 多项式根乘以倍率
residuez Z变换部分分式展开
一
sosss 级联二阶环节向状态空间转换
sostf 级联二阶环节向传递函数转换 节
soszp 级联二阶环节向零极增益转换
sssos 状态空间转换为二阶环节级联
sstf 状态空间向传递函数转换
线性系统变换
latetf 格形或者格形梯形向传递函数转换 节，节
sszp 状态空间向零极增益转换
tfate 传递函数向格形或者格形梯形转换 节，节，
节
tfsos 传递函数向级联二阶环节转换 节，例
节
tfss 状态空间向传递函数转换
一
tfzp 传递函数向零极增益转换
一
zpsos 零极增益向级联二阶环节转换
zpss 零极增益向状态空间转换
zptf 零级增益向传递函数转换
一
barthannwin 修正巴特利特一汉宁窗 二
blackman 布莱克曼窗函数
blackmanharris 最小四项 BlackmanHarris窗函数
bohmanwin Bohman 窗函数
chebwin 切比雪夫窗函数
一
gausswin 高斯窗函数
一
窗函数
bartlett Bartlett 窗函数 节
hamming 哈明窗函数
一
hanning 汉宁窗函数
一
kaiser 凯泽窗函数
nutallwin Nuttall最小四项BlackmanHarris窗函数
boxcar 矩形窗函数
triang 三角窗函数
tukeywin Tukey 窗函数
一
window 窗函数引入
■附录
Created by ZhuangHeng
口
口
口
口口
口口
口
数字信号处理第五版
续表四
分 类 函 数 名 功 能说 明 本函数首次出现
所在的章节或例题
czt 线性调频Z变换
一
det 离散的余弦变换
dftmtx 离散傅里叶变换矩阵
一
fft 快速傅里叶变换 节，例
fft 二维快速傅里叶变换 变换
bitrevorder 将输入变换成倒序排列
一
fftshift 交换矢量的一半 节
goertzel 计算 DFT的Goertzel算法
hilbert Hilbert 变换
idet 离散的逆余弦变换
ifft 快速傅里叶逆变换 节
ifft 二维快速傅里叶逆变换
一
倒谱分析
cceps 复倒谱
icceps 逆复倒谱
rceps 实例谱和最小相位重建
corrcoef 相关系数
corrmtx 自相关矩阵
cov 协方差矩阵
一
csd 互相关谱密度
pburg 用Burg方法功率谱估计
pcov 用协方差方法功率谱估计
peig 用特征向量方法功率谱估计
periodogram 周期谱图方法功率谱估计
pmcov 用修改协方差方法的功率谱估计
统计信号处理和
谱分析
cohere 相干函数
一
pmtm 用Thomson 多带方法功率谱估计
pmusic 用MUSIC方法的功率谱估计
psdplot 绘制功率谱密度数据
一
pwelch 用Welch方法功率谱估计
pyulear 用耶鲁一沃克AR方法的功率谱估计
rooteig 用特征向量法作正弦频率功率谱估计
rootmusie 用MUSIC法作正弦频率功率谱估计
tfe 传递函数估计
xcorr 互相关函数或自相关函数 节
xcorr 二维互相关
一
xcov 协方差函数
一
Created by ZhuangHeng
续表五
分 类 函 数 名 功能 说 明 本函数首次出现
所在的章节或例题
arcov 用协方差方法AR参数的建模
armcov 用修改协方差方法AR参数的建模
一
aryule 用耶鲁沃克方法AR参数的建模
一
参数建模
arburg 用Burg方法AR参数的建模
ident 参看系统辨识工具箱
一
invfreqs 模拟滤波器向频率响应拟合
invfreqz 离散滤波器向频率响应拟合
一
prony Prony离散滤波器拟合时间响应
一
stmcb Steiglitz MeBride 迭代的ARMA建模
一
rclar 反射系数向对数区域比转换
一
线性预测
reis 反射系数向反正弦参数转换
一
rcpoly 反射系数向预测多项式转换
一
rlevinson 逆Levinson Durbin递归
一
schurre Schur算法
downsample 抽取输入信号
interp 整数因子内插 节
多采样率
信号处理
decimate 整数因子抽取 节
interpl 通用一维插值透入MATLAB实现箱
resample 用新取样速度再抽样 节
spline 三次样条内插
upfirdn 先内插，后FIR 滤波，再抽取 节
upsample 对输入信号内插
一
dric Dirichlet周期性sinc函数
gauspuls 高斯高频脉冲发生器
gmonopuls 高斯单脉冲发生器
一
pulstran 脉冲序列发生器
波形产生
chirp 扫频的频率余弦发生器
rectpuls 采样的非周期性的方波发生器
sawtooth 锯齿函数
sinc sinc或者sinπxπx函数
square 方波函数
tripuls 采样的非周期性的三角形发生器
vco 压控振荡器
■附录
Created by ZhuangHeng
数字信号处理第五版
续表六
分 类 函 数 名 功 能 说 明 本函数首次出现
所在的章节或例题
cellsos 将单元阵列转换为二阶级联矩阵
cplxpair 把矢量变为复共轭对
demod 解调
dpss 离散的扩展球形序列Slepian序列
dpssclear 从数据库去除离散的扩展球形序列
一
dpssdir 离散的扩展球形序列数据库子目录
dpssload 从数据库下载离散的扩展球形序列
一
dpsssave 向数据库写人离散的扩展球形序列 专门的运算
buffer 把一个矢量缓冲到数据帧的矩阵中去
一
eqtflength 使离散时间传递函数分子、分母系数等长
modulate 为通信仿真调制
seqperiod 在一个矢量中找到最小长度重复序列
soscell 将二阶级联矩阵转换为单元阵列
specgram 语音信号谱图
stem 画出离散数据序列
strips 画出条形图
udecode 使输入二进制码均匀解码
uencode 使输入信号均匀编码为N位二进制码
图形用户
界面工具
fdatool 滤波器分析设计工具 节
sptool 信号处理工具
音频支持这
些函数不是工
具箱函数，属于
MATLAB基本
部分
sound 重放矢量成为声音
soundsc 声音自动定标和重放矢量数
wavplay 使用视窗音频的输出装置重放声音
一
wavread 读微软wav声音文件
wavrecord 使用视窗音频的输入装置记录声音
wavwrite 写微软wav声音文件
Created by ZhuangHeng