1.2 数字图像处理的起源 ……………………2
1.3 使用数字图像处理领域的实例…………4
1.3.1 伽马射线成像 ………………………5
1.3.2 X射线成像 ……………………………5
1.3.3 紫外波段成像 ………………………7
1.3.4 可见光及红外波段成像 …………………7
1.3.5 微波波段成像 ………………10
1.3.6 无线电波段成像……………………10
1.3.7 使用其他成像方式的例子…………11
1.4 数字图像处理的基本步骤…………14
1.5 图像处理系统的组成……15
小结……………………………17
参考文献……………………………………17
第2章 数字图像基础 ………………20
引言……………………20
2.1 视觉感知要素…………………………20
2.1.1 人眼的结构 ………………………20
2.1.2 眼睛中图像的形成…………………22
2.1.3 亮度适应和辨别……………………22
2.2 光和电磁波谱 …………………………24
2.3 图像感知和获取 ……………26
2.3.1 使用单个传感器获取图像…27
2.3.2 使用条带传感器获取图像…27
2.3.3 使用传感器阵列获取图像…28
2.3.4 简单的图像形成模型 ………………28
2.4 图像取样和量化 ……………………30
2.4.1 取样和量化的基本概念 ……………30
2.4.2 数字图像表示 ………………………31
2.4.3 空间和灰度分辨率…………………34
2.4.4 图像内插……………………………36
2.5 像素间的一些基本关系………38
2.5.1 相邻像素……………………………38
2.5.2 邻接性、连通性、区域和边界…38
2.5.3 距离度量…………………………40
2.6 数字图像处理中所用数学工具的介绍…41
2.6.1 阵列与矩阵操作……………………41
2.6.2 线性操作与非线性操作 ……………42
2.6.3 算术操作 ……………42
2.6.4 集合和逻辑操作……………………46
2.6.5 空间操作 ………………………49
目 录
第1章 绪论 …………1 2.6.6 向量与矩阵操作……………………53
引言………………………………………1 2.6.7 图像变换 ……………………………54
1.1 什么是数字图像处理 ……………………1 2.6.8 概率方法 ……………………………56
小结 ……………………………………57
参考文献 ……………………………………58
习题 ………………………………………58
第3章 灰度变换与空间滤波……62
引言……………………………………62
3.1 背景知识…………62
3.1.1 灰度变换和空间滤波基础 ……………62
3.1.2 关于本章中的例子…………………63
3.2 一些基本的灰度变换函数 ………………64
3.2.1 图像反转 ……………………………64
3.2.2 对数变换 ………………64
3.2.3 幂律(伽马)变换 ……………………66
3.2.4 分段线性变换函数 ……………………68
3.3 直方图处理 ……………………………72
3.3.1 直方图均衡………………………72
3.3.2 直方图匹配(规定化)…………………77
3.3.3 局部直方图处理………………………83
3.3.4 在图像增强中使用直方图统计 ………85
3.4 空间滤波基础………………………………88
3.4.1 空间滤波机理…………………………88
3.4.2 空间相关与卷积 ………………………89
3.4.3 线性滤波的向量表示…………………92
3.4.4 空间滤波器模板的产生………………93
3.5 平滑空间滤波器………………………93
3.5.1 平滑线性滤波器 ………………………93
3.5.2 统计排序(非线性)滤波器………………96
3.6 锐化空间滤波器…………………………97
3.6.1 基础………………………………97
3.6.2 使用二阶微分进行图像锐化——
拉普拉斯算子…………………………99
3.6.3 非锐化掩蔽和高提升滤波……………100
3.6.4 使用一阶微分对(非线性)图像锐
化——梯度…………………………101
3.7 混合空间增强法………………………103
3.8 使用模糊技术进行灰度变换和
空间滤波………………………………105
3.8.1 引言……………………………106
3.8.2 模糊集合论原理……………………106
3.8.3 模糊集合应用…………………………110
3.8.4 使用模糊集合进行灰度变换…………116
·15·
3.8.5 使用模糊集合进行空间滤波…………117
小结……………………………………119
参考文献…………………………………119
习题……………………………………120
第4章 频率域滤波 …………………124
引言……………………………………124
4.1 背景……………………………124
4.1.1 傅里叶级数和变换简史 ……………124
4.1.2 关于本章中的例子…………………125
4.2 基本概念……………………………125
4.2.1 复数…………………………………125
4.2.2 傅里叶级数 …………………………126
4.2.3 冲激及其取样特性…………………126
4.2.4 连续变量函数的傅里叶变换……128
4.2.5 卷积……………………………130
4.3 取样和取样函数的傅里叶变换 ………131
4.3.1 取样………………………………131
4.3.2 取样函数的傅里叶变换 ……………132
4.3.3 取样定理……………………………134
4.3.4 混淆………………………………135
4.3.5 由取样后的数据重建(复原函数 ………137
4.4 单变量的离散傅里叶变换(DFT)…138
4.4.1 由取样后的函数的连续变换得
到DFT…………………………138
4.4.2 取样和频率间隔间的关系…………140
4.5 两个变量的函数的扩展…141
4.5.1 二维冲激及其取样特性 ……………141
4.5.2 二维连续傅里叶变换对 ……………141
4.5.3 二维取样和二维取样定理…………142
4.5.4 图像中的混淆 ………………………143
4.5.5 二维离散傅里叶变换及其反变换 …147
4.6 二维离散傅里叶变换的一些性质 ……148
4.6.1 空间和频率间隔的关系 ……………148
4.6.2 平移和旋转 …………………………148
4.6.3 周期性………………………………148
4.6.4 对称性……………………………150
4.6.5 傅里叶谱和相角………………………154
4.6.6 二维卷积定理 ………………………157
4.6.7 二维离散傅里叶变换性质的小结 …159
4.7 频率域滤波基础 ……………………161
4.7.1 频率域的其他特性…………………161
4.7.2 频率域滤波基础………………………162
4.7.3 频率域滤波步骤小结 ………………165
4.7.4 空间和频率域滤波间的对应……166
4.8 使用频率域滤波器平滑图像……………169
4.8.1 理想低通滤波器………………………169
4.8.2 布特沃斯低通滤波器……172
4.8.3 高斯低通滤波器………………………173
4.8.4 低通滤波的其他例子 ………………174
4.9 使用频率域滤波器锐化图像 ……………176
4.9.1 理想高通滤波器 ………………………176
4.9.2 布特沃斯高通滤波器 ………………178
4.9.3 高斯高通滤波器………………………178
4.9.4 频率域的拉普拉斯算子………………179
4.9.5 钝化模板、高提升滤波和高频
强调滤波 ……………………………180
4.9.6 同态滤波 ……………………………182
4.10 选择性滤波……………………………184
4.10.1 带阻滤波器和带通滤波器 …………184
4.10.2 陷波滤波器 …………………………185
4.11 实现………………………187
4.11.1 二维DFT的可分性………………187
4.11.2 用DFT算法计算IDFT ……………187
4.11.3 快速傅里叶变换(FFT)……………187
4.11.4 关于滤波器设计的一些注释…………190
小结………………………………………190
参考文献 ……………………………………190
习题………………………………………191
第5章 图像复原与重建 ………………196
引言………………………………………196
5.1 图像退化/复原过程的模型 …………197
5.2 噪声模型…………………………………197
5.2.1 噪声的空间和频率特性………………197
5.2.2 一些重要的噪声概率密度函数 ……198
5.2.3 周期噪声 ……………………………201
5.2.4 噪声参数的估计…………………202
5.3 只存在噪声的复原——空间滤波 ……203
5.3.1 均值滤波器…………………………203
5.3.2 统计排序滤波器 ………………………205
5.3.3 自适应滤波器………………………208
5.4 用频率域滤波消除周期噪声 …………211
5.4.1 带阻滤波器………………………211
5.4.2 带通滤波器………………………211
5.4.3 陷波滤波器…………………………212
5.4.4 最佳陷波滤波 …………………………213
5.5 线性、位置不变的退化 ………………216
5.6 估计退化函数……………………………218
5.6.1 图像观察估计…………………………218
5.6.2 试验估计……………………………218
5.6.3 建模估计 ………………………219
5.7 逆滤波………………………………221
5.8 最小均方误差(维纳)滤波 ………………222
5.9 约束最小二乘方滤波……………………224
5.10几何均值滤波…………………………227
5.11 由投影重建图像…………………………228
5.11.1 引言 …………………………228
·16·
5.11.2 计算机断层(CT)原理 ……………230
5.11.3 投影和雷登变换 ……………………232
5.11.4 傅里叶切片定理 ……………………235
5.11.5 使用平行射线束滤波反投影的重建…236
5.11.6 使用扇形射线束滤波反投影的重建…240
小结……………………………………244
参考文献 …………………………………………244
习题………………………………………245
第6章 彩色图像处理 …………………249
引言………………………………249
6.1 彩色基础 ………………………………249
6.2 彩色模型 ……………………………………254
6.2.1 RGB彩色模型 ………………………254
6.2.2 CMY和CMYK彩色模型 …………257
6.2.3 HSI彩色模型 ………………………257
6.3 伪彩色图像处理 …………………………262
6.3.1 灰度分层……………………………262
6.3.2 灰度到彩色的变换 …………………265
6.4 全彩色图像处理基础 …………………267
6.5 彩色变换 …………………………………268
6.5.1 公式 ……………………………269
6.5.2 补色 ………………………………271
6.5.3 彩色分层……………………………271
6.5.4 色调和彩色校正……………………273
6.5.5 直方图处理………………………275
6.6 平滑和锐化……………………………276
6.6.1 彩色图像平滑 ………………………276
6.6.2 彩色图像锐化 ………………………278
6.7 基于彩色的图像分割 …………………279
6.7.1 HSI彩色空间的分割 …………………279
6.7.2 RGB向量空间中的分割 ……………279
6.7.3 彩色边缘检测 ……………………281
6.8 彩色图像中的噪声 ……………………283
6.9 彩色图像压缩………………………284
小结………………………………………285
参考文献……………………………………285
习题……………………………………286
第7章 小波和多分辨率处理………289
引言………………………………………289
7.1 背景………………………………289
7.1.1 图像金字塔 ………………………290
7.1.2 子带编码 …………………………292
7.1.3 哈尔变换 ……………………………297
7.2 多分辨率展开………………………300
7.2.1 级数展开 ……………………………300
7.2.2 尺度函数 ……………………………301
7.2.3 小波函数 ………………304
7.3 一维小波变换 …………………………306
7.3.1 小波级数展开…………………………306
7.3.2 离散小波变换…………………………308
7.3.3 连续小波变换 ……………………………309
7.4 快速小波变换………………………311
7.5 二维小波变换…………………………317
7.6 小波包 ………………………………322
小结………………………………………330
参考文献 ……………………………………330
习题………………………………………331
第8章 图像压缩……………………334
引言……………………………………334
8.1 基础知识 ………………………………335
8.1.1 编码冗余 ……………………………336
8.1.2 空间冗余和时间冗余 ………………337
8.1.3 不相关的信息………………………337
8.1.4 图像信息的度量……………………338
8.1.5 保真度准则…………………………340
8.1.6 图像压缩模型………………………341
8.1.7 图像格式、容器和压缩标准…………343
8.2 一些基本的压缩方法……………………345
8.2.1 霍夫曼编码………………………345
8.2.2 Golomb编码 ………………………346
8.2.3 算术编码 ……………………………350
8.2.4 LZW编码…………………………351
8.2.5 行程编码 ……………………………353
8.2.6 基于符号的编码……………………357
8.2.7 比特平面编码…………………………359
8.2.8 块变换编码……………………………361
8.2.9 预测编码 ……………………………373
8.2.10小波编码 ……………………………387
8.3 数字图像水印…………………………394
小结 ………………………………………398
参考文献 ……………………………………398
习题………………………………………399
第9章 形态学图像处理………………402
引言………………………………………402
9.1 预备知识 ………………………………402
9.2 腐蚀和膨胀 ……………………………404
9.2.1 腐蚀 …………………………………………404
9.2.2 膨胀 …………………………………………406
9.2.3 对偶性………………………………407
9.3 开操作与闭操作…………………………407
9.4 击中或击不中变换 …………………………411
9.5一些基本的形态学算法…………………412
9.5.1 边界提取 ……………………………412
9.5.2 孔洞填充……………………………413
9.5.3 连通分量的提取 ……………………414
9.5.4凸壳………………………………416
·17·
9.5.5 细化 ……………………………417
9.5.6 粗化 ………………………………418
9.5.7 骨架 ………………………………418
9.5.8 裁剪 ………………………………420
9.5.9 形态学重建……………………421
9.5.10 二值图像形态学操作小结……………426
9.6 灰度级形态学…………………………428
9.6.1 腐蚀和膨胀 …………………………428
9.6.2 开操作和闭操作…………………430
9.6.3 一些基本的灰度级形态学算法……431
9.6.4 灰度级形态学重建…………………435
小结………………………………………437
参考文献……………………………………437
习题………………………………………438
第10章 图像分割…443
引言………………………443
10.1 基础知识…………………………443
10.2 点、线和边缘检测……………………445
10.2.1 背景知识…………………………445
10.2.2 孤立点的检测……………………447
10.2.3 线检测 …………………………449
10.2.4 边缘模型 ………………………450
10.2.5 基本边缘检测…………………454
10.2.6 更先进的边缘检测技术 …………459
10.2.7 边缘连接和边界检测 ……………467
10.3 阈值处理 ……………………………476
10.3.1 基础知识 ………………………476
10.3.2 基本的全局阈值处理 ……………478
10.3.3 用Otsu方法的最佳全局阈值处理…479
10.3.4 用图像平滑改善全局阈值处理…483
10.3.5 利用边缘改进全局阈值处理……484
10.3.6 多阈值处理 ……………………487
10.3.7 可变阈值处理…………………488
10.3.8 多变量阈值处理…………………492
10.4 基于区域的分割……………………493
10.4.1 区域生长…………………………493
10.4.2 区域分裂与聚合………495
10.5 用形态学分水岭的分割 ……………497
10.5.1 背景知识 ………………………497
10.5.2 水坝构建 …………………………498
10.5.3 分水岭分割算法…………499
10.5.4 标记的使用……………………501
10.6 分割中运动的应用……………………502
10.6.1 空间域技术 ………………………502
10.6.2 频率域技术 ………………………504
小结…………………………507
·18·
参考文献 ……………………………………507
习题…………………………………………508
第11章 表示和描述…………………514
引言………………………………………514
11.1 表示…………………………………514
11.1.1 边界追踪……………………………514
11.1.2 链码 ……………………………516
11.1.3 使用最小周长多边形的多边形近似…518
11.1.4 其他多边形近似方法………………522
11.1.5 标记图 ………………………523
11.1.6 边界线段…………………………525
11.1.7 骨架………………………………525
11.2 边界描绘子……………………………527
11.2.1 一些简单的描绘子 ………………527
11.2.2 形状数 ……………………………528
11.2.3 傅里叶描绘子………………………529
11.2.4 统计矩 ……………………………531
11.3 区域描绘子……………………………532
11.3.1 一些简单的描绘子 ………………532
11.3.2 拓扑描绘子………………………532
11.3.3 纹理……………………………534
11.3.4 不变矩 ……………………………542
11.4 使用主分量进行描绘 …………………544
11.5 关系描绘子……………………………550
小结…………………………………………553
参考文献 ……………………………………553
习题………………………………………554
第12章 目标识别 ……………………557
引言 …………………………………………………557
12.1 模式和模式类…………………………557
12.2 基于决策理论方法的识别……………560
12.2.1 匹配……………………………560
12.2.2 最佳统计分类器…………………564
12.2.3 神经网络…………………………570
12.3 结构方法………………………………585
12.3.1 匹配形状数………………………585
12.3.2 串匹配 …………………………586
小结………………………………587
参考文献 ……………………………………588
习题…………………………………………588
附录A 图像压缩编码表……………591
附录B 参考书目……………………595
索引………………………620
第1章 绪 论
百闻不如一见。
——无名氏
引言
数字图像处理方法的重要性源于两个主要应用领域：改善图示信息以便人们解释；为存储、传
输和表示而对图像数据进行处理，以便于机器自动理解。本章有几个主要目的：(1)定义我们称之为
图像处理领域的范围；(2)从历史观点回顾图像处理的起源；(3)通过考察一些主要的应用领域，给出
图像处理技术状况的概念；(4)简要讨论数字图像处理中所用的主要方法；(5)概述通用目的的典型图
像处理系统的组成；(6)列出公开发表的数字图像处理领域的一些图书和文献。
1.1 什么是数字图像处理
一幅图像可定义为一个二维函数f(x,y),其中x和y是空间(平面)坐标，而在任何一对空间坐标(x,y)
处的幅值f称为图像在该点处的强度或灰度。当x,y和灰度值f是有限的离散数值时，我们称该图像为
数字图像。数字图像处理是指借助于数字计算机来处理数字图像。注意，数字图像是由有限数量的元
素组成的，每个元素都有一个特定的位置和幅值。这些元素称为图画元素、图像元素或像素。像素是
广泛用于表示数字图像元素的术语。在第2章，我们将用更正式的术语来考虑这些定义。
视觉是人类最高级的的感知，所以，图像在人类感知中扮演着最重要的角色并不奇怪。然而，
人类的感知仅限于电磁波谱的视觉波段，与人类不同，成像机器几乎可以覆盖从伽马射线到无线电波
的整个电磁波谱。它们可以对非人类所习惯的那些图像源进行加工，这些图像源包括超声波、电子显
微镜和计算机产生的图像。因而，数字图像处理涉及很宽泛的各种各样的应用领域。
关于图像处理止于哪里或其他相关领域(如图像分析和计算机视觉)从哪里开始，在创造人之间
并没有一致的看法。有时，用处理的输入和输出内容都是图像这一规范来界定图像处理的范围。我们
认为这有点局限，是人为的界定。例如，在这种定义下，甚至像计算一幅图像的平均灰度(结果为一
个数字)这样简单的任务都不能算是图像处理。另一方面，有些领域(如计算机视觉)的最终目标是使
用计算机来模拟人的视觉，包括理解并根据视觉输入采取行动等。该领域本身是人工智能(AD)的一个
分支，其目的是模仿人类智能。人工智能领域处在其发展过程的初级阶段，它的发展比预期的慢得多。
图像分析(也称为图像理解)领域则处在图像处理和计算机视觉之间。
①每页下方阴影框中的数字表示译文对应的原书页码，索引中的页码为原书页码。—编者注 z2
2 数字图像处理(第三版)
从图像处理到计算机视觉的这个连续统一体内并没有明确的界限。然而，一种有用的范例是在
这个连续的统一体中考虑三种典型的计算处理，即低级、中级和高级处理。低级处理涉及初级操作，
如降低噪声的图像预处理、对比度增强和图像尖锐化。低级处理以输入、输出都是图像为特征。中级
处理涉及诸多任务，譬如(把一幅图像分为不同区域或目标的)分割，减少这些目标物的描述，以使其
更适合计算机处理及对不同目标的分类(识别)。中级图像处理以输入为图像但输出是从这些图像中提
取的特征(如边缘、轮廓及各物体的标识等)为特点。最后，高级处理涉及“理解”已识别目标的总体，
就像在图像分析中那样，以及在连续统一体的远端执行与视觉相关的认知功能。
基于上述讨论我们可以看到，图像处理和图像分析之间合乎逻辑的重叠部分就是图像中各个区
域或目标的识别这一领域。这样，在本书中，我们就将数字图像处理界定为其输入和输出都是图像的
处理，另外，包含从图像中提取特征的处理，直至包括各个目标的识别。作为一个澄清这些概念的说
明，我们考虑文本自动分析这一领域。获取包含有文本的区域的一幅图像，对该图像进行预处理，以
提取(分割)各个字符，以适合于计算机处理的形式描述这些字符，识别这些个别字符，这些都在本书
界定的数字图像处理范畴内。理解一页的内容可能要根据“理解”词句的复杂度从图像分析领域甚至
计算机视觉来考虑。这很快就会变得很明显，就像我们已定义的那样，数字图像处理可成功地用于具
有特殊社会和经济价值的广泛领域。后面各章中给出的概念是这些应用领域中所用方法的基础。
1.2 数字图像处理的起源
数字图像的最早应用之一是在报纸业，当时，图片第一次通过海底电缆从伦敦传往纽约。早在20
世纪20年代曾引人巴特兰(Bartlane)电缆图片传输系统，把横跨大西洋传送一幅图片所需的时间从一
个多星期减少到了3小时。为了用电缆传输图片，首先使用特殊的打印设备对图片编码，然后，在接
收端重构这些图片。图1.1 就是用这种方法传送并利用装有打印机字体的电报打印机模拟中间色调还
原出来的图像。
这些早期数字图片视觉质量的改进中的初始问题涉及打印过程的选择和亮度等级的分布。用于
得到图1.1所示图像的打印方法到1921年底就被彻底淘汰了，转而支持一种基于照相还原的技术，即
在电报接收端使用穿孔纸带来还原图片。图1.2显示了使用这种方法得到的一幅图像。与图1.1相比，
它在色调质量和分辨率方面的改进都很明显。
图1.1 1921年由电报打印机采用特殊字体在编码纸带
上产生的数字图片(原图像由McFarlane 提供)
图1.2 1922年在信号两次穿越大西洋后，由穿孔纸
带得到的数字图片(原图像由McFarlane提供)
早期的巴特兰系统可以使用5个不同的灰度级来编码图像。到1929年，这一能力已增大到15级。
图1.3所示的这种典型图像就是用15级色调设备得到的。在这一时期，由于引入了一种使用编码图片
纸带调制光束而使底片感光的系统，因而明显地改善了还原过程。
①本书后面提供的参考文献按作者姓氏的字母顺序列出。
第1章 绪 论 3
虽然刚才引用的例子中涉及数字图像，但并不认为它
们就是我们定义的数字图像处理，因为创建这些图像时并
未涉及计算。因此，数字图像处理的历史与数字计算机的
发展密切相关。事实上，数字图像要求非常大的存储和计
算能力，因此数字图像处理领域的发展必须依靠数字计算
机及数据存储、显示和传输等相关支撑技术的发展。
计算机的概念可追溯到5000多年前亚洲算盘的发
明。更近一些，过去两个世纪以来已有的发展也奠定了我
们今天称之为计算机的基础。然而，我们称之为现代计算
机的基础还要回溯到20世纪40年代由约翰·冯·诺依曼
提出的两个重要概念：(1)保存程序和数据的存储器；
图1.3 美国将军潘兴和法国元帅福熙的照片，
该照片未加修饰，是在1929年从伦
敦到纽约使用15级色调设备通过电
(2)条件分支。这两个概念是中央处理单元(CPU)的基 缆传送的(原图像由McFarlane 提供)
础，今天，它是计算机的心脏。从冯·诺依曼开始，已
有的一系列重要的进展使得计算机强大到足以用于数字图像处理。
简单地说，这些进展可归纳为如下几点：(1)1948年美国贝尔实验室发明了晶体管；(2)20世纪
50年代和20世纪60年代高级编程语言COBOL(Common Business-Oriented Language)和FORTRAN
(Fornula Translator)的开发；(3)1958年美国德州仪器公司发明了集成电路(IC);(4)20世纪60年代
早期操作系统的开发；(5)20世纪70年代早期 Intel 公司开发了微处理器(由中央处理单元、存储器和
输入/输出控制组成的单一芯片);(6)1981年IBM公司推出了个人计算机；(7)元器件的逐步小型化，
随着20世纪70年代末大规模集成电路(LI)开始出现，20世纪80年代出现了甚大规模集成电路(VLSD,
现在出现了超大规模集成电路(ULSD)。伴随着这些进展，数字图像处理的两个基本需求——大容量存
储和显示系统领域也随之快速发展。
第一台功能强大到足以执行有意义图像处理任务的大型计算机出现在20世纪60年代初。我们今
天称之为数字图像处理的诞生可追溯至这一时期这些机器的使用和空间项目的开发。这两大发展的结
合把人们的注意力集中到数字图像处理概念的潜能上。利用计算机技术改善空间探测器发回的图像的
工作始于1964年美国加利福尼亚的喷气推进实验室(加里福尼亚，帕萨第那)。当时由“徘徊者7号”
卫星传送的月球图像由一台计算机进行了处理，以校正航天器上电视摄像机中各种类型的图像畸变。
图1.4显示了由“徘徊者7号”于1964年7月31日上午(东
部白天时间)9点09分在撞击月球表面前约17分钟时摄取
的第一张月球图像[网状标记用于第 2章讨论的几何校
正]。这也是由美国航天器拍摄的第一幅月球图像。“徘徊者
7号”积累的图像处理方法可作为增强和复原图像方法的基
础，譬如“探索者”登月飞行、“水手号”火星飞越任务及
“阿波罗”载人登月和其他任务。
在空间应用的同时，数字图像处理技术在20世纪60年
代末和20世纪70年代初开始用于医学成像、地球资源遥感
监测和天文学等领域。早在20世纪70年代发明的计算机图1.4 美国航天器传回的第一张月球照片，
轴向断层术，简称为计算机断层(CT),是图像处理在医学 它是由“徘徊者7号”探测器在撞
击月球表面前17分钟于美国东部 诊断领域最重要的应用之一。计算机轴向断层术是一种处
时间1964年7月31日上午9点09 理方法，在这种处理中，检测器环围绕着一个物体(或病
分拍摄的(原图像由NASA提供) 人),并且一个与该环同心的X射线源(与检测器环同心)绕 8-器
见：即
4 数字图像处理(第三版)
着物体旋转。X射线穿过物体并由环中对面的检测器进行收集。当X射线源旋转时，重复这一过程。
断层由一些算法组成，这些算法使用感知的数据来重建通过物体的“切片”图像。当物体沿垂直于检测
器环的方向运动时，就产生一系列这样的“切片”,这些切片组成该物体内部的三维再现。断层摄影术是
由Godfrey N.Hounsfield先生和Allan M.Cormack 教授分别发明的。由于这项发明，他们共同获得了
1979年的诺贝尔医学奖。有趣的是，X射线是1895年由Wilhelm Conrad Roentgen(威廉·康拉德·伦琴)
发现的，由于这一发现，他获得了1901年的诺贝尔物理学奖。今天，这两个相差近100年的发明引
领着图像处理的一些最重要的应用。
从20世纪60年代至今，图像处理领域一直在生机勃勃地发展。除了医学和空间项目应用外，
数字图像处理技术现在已用于更广泛的范围。计算机方法用于增强对比度或将灰度编码为彩色，以便
于解释工业、医学及生物科学等领域中的X射线图像和其他图像。地理学者使用相同或相似的技术，
从航空和卫星成像中研究污染模式。图像增强和复原方法用于处理不可修复物体的退化图像，或太昂
贵以至于不可复制的实验结果。在考古学领域，使用图像处理方法已成功地复原了模糊的图片，这些
图片是丢失或损坏的稀有物品的唯一现有的记录。在物理学和相关领域，计算机技术通常用于增强如
高能等离子和电子显微镜等领域的实验图像。类似地，图像处理技术也成功地应用在天文学、生物学、
核医学、法律实施、国防及工业领域中。
这些例子说明图像处理的结果主要用于人类解译。本章开始时曾提到，数字图像处理技术的第
二个主要应用领域是解决机器感知的问题。在这种情况下，兴趣在于以更适合计算机处理的形式从图
像中提取信息的过程。通常，该信息类似于人类用于解译一幅图像内容的视觉特性。例如，机器感知
中使用的信息类型的例子有统计矩、傅里叶变换系数和多维距离度量。在机器感知中，使用图像处理
技术的典型问题是自动字符识别、产品装配线和检测的工业机器视觉、军事识别、指纹的自动处理、
X射线和血样分类、用于天气预报和环境评估的航空图像与卫星图像的机器处理。计算机价格性能比
的不断下降、万维网和互联网规模的不断扩张及网络通信带宽的提高，为数字图像处理技术的持续发
展提供了前所未有的机会。下一节中将说明某些这样的应用领域。
1.3 使用数字图像处理领域的实例
今天，几乎不存在与数字图像处理无关的技术领域。这里讨论的范围只能覆盖其应用领域的一
小部分。然而，由于篇幅的限制，本节的内容无疑将围绕数字图像处理的广度和重要性展开。本节将
介绍一些应用领域，其中每个领域都要使用后续各章中讲解的常用数字图像处理技术。本节中所示的
许多图像会在本书后面给出的多个例子中引用。所显示的所有图像都是数字图像。
数字图像处理的应用领域多种多样，所以本书在组织形式上力图覆盖该技术领域的广度。阐述
数字图像处理应用范围的一种最简方法是根据信息源来分类(如可见光或X射线等)。在今天的应用
中，最主要的图像能源是电磁能谱，其他主要图像能源包括声波、超声波和电子(以用于电子显微镜
中的电子束形式)。用于建模和可视化的合成图像由计算机产生。本节简要讨论如何生成各种类别的
图像及这些图像适用的领域。把图像变换为数字图像的方法则在下一章中讨论。
以电磁波谱辐射为基础的图像是我们最熟悉的，特别是X射线和可见光谱波段的图像。电磁波
可定义为以各种波长传播的正弦波，或视为无质量的粒子流，每个粒子以波的形式传播并以光的速度
运动。每个无质量的粒子包含一定的能量(或一束能量),每束能量称为一个光子。如果光谱波段根据
光子能量进行分组，则可得到图1.5所示的光谱，范围从伽马射线(最高能量)到无线电波(最低能量)。
如图所示，加底纹的条带表明了这样一个事实，即电磁波谱的各个波段之间并没有明确的界线，而是
由一个波段平滑地过渡到另一个波段。
第1章 绪 论 5
一个光子的能量(电子伏特)
10° 103 10? 103 10101 10 10 10 10 10 10* 10
伽马射线 X射线 紫外线可见光 红外线 微波 无线电波
图1.5 根据光子能量排列的电磁波谱
1.3.1 伽马射线成像
伽马射线成像的主要用途包括核医学和天文观测。在核医学中，这种方法是将放射性同位素注
射到人体内，当这种物质衰变时就会放射出伽马射线，然后用伽马射线检测仪收集到的放射线来产生
图像。图1.6(a)显示了一幅使用伽马射线成像得到的人体骨骼扫描图像。这类图像用于骨骼病变的定
位，譬如感染或肿瘤。图1.6(b)显示了另一种主要形态的核成像，称为正电子放射断层(PET),其原
理与1.2节中提及的X射线断层相同。然而，与使用外部X射线源不同。它给病人注入放射性同位素，
同位素衰变时放射出正电子。当正电子遇上一个电子时，两者湮没并放射出两束伽马射线。检测到这
些射线后，就可利用断层技术的基本原理创建断层图像。图1.6(b)所示的图像是构成病人三维再现图
像序列中的一幅图像。这幅图像表明脑部和肺部各有一个肿瘤，即很容易看到的小的白色团块。
大约在15000年前，天鹅星座中的星球发生大爆炸，产生了一团过热的稳定气云(即天鹅星座环),
该气云以彩色阵列形式发光。图1.6(c)显示了在伽马射线波段成像的天鹅星座环。与图1.6(a)和图1.6(b)
不同，该图像是利用被成像物体的自然辐射得到的。最后，图1.6(d)显示了一幅来自核反应堆真空管
的伽马辐射图像，在图像的左下方可以看到较强的辐射区。
a b
c d
图1.6 伽马射线成像实例：(a)骨骼扫描图像；(b)PET图像；(c)天鹅星座环图像；(d)来自反应堆真空管的
伽马辐射(亮点)[图(a)由G.E.Medical Systems公司提供，图(b)由CTI PETSystems公司的Michacl E
Casey 博士提供，图(c)由NASA提供，图(d)由密歇根大学的Zhong He和David K.Wehe教授提供]
1.3.2 X射线成像
X射线是最早用于成像的电磁辐射源之一。最熟悉的X射线应用是医学诊断，但是X射线还被
广泛用于工业和其他领域，如天文学。用于医学和工业成像的X射线是由X射线管产生的，X射线 m!己
水;的
6 数字图像处理(第三版)
管是带有阴极和阳极的真空管。阴极加热释放自由电子，这些电子以很高的速度向阳极流动，当电子
撞击一个原子核时，能量被释放并形成X射线辐射。X射线的能量由另一边的阳极电压控制，而X
射线的数量由施加于阴极灯丝的电流控制。图1.7(a)显示了一幅大家熟悉的位于X射线源和对X射
线能量敏感的胶片之间的病人胸部图像。X射线的强度受射线穿过病人时的吸收量调制，最终能量落
在胶片上并使胶片感光，这与光使得胶片感光的原理是一样的。在数字射线照相术中，数字图像可用
两种方法得到：(1)使用数字化的X射线胶片；(2)X射线穿过病人身体后直接落到某个装置上(譬如
荧光屏),该装置把X射线转换为光信号。然后，转换而来的光信号由高灵敏度的数字系统捕获。
第2章和第4章将详细地讨论数字化问题。
d
图1.7 X射线成像实例：(a)胸部X射线图像；(b)主动脉造影图像；(c)头部CT图像；(d)电
路板图像；(e)天鹅星座环图像[图(a)和图(c)由Vanderbilt大学医学中心辐射学与放射
学系的David R.Pickens博士提供，图(b)由密歇根大学医学院解剖学分部的Thomas R
Gest博士提供，图(d)由Lixi公司的Joseph E.Pascente先生提供，图(e)由NASA提供]
血管照相术是对比度增强辐射成像领域中的另一个主要应用。该过程用于得到血管的图像(称为
血管造影照片)。一根导管(柔软且中空的小管)插入动脉或静脉，导管穿过血管并被引导到要研究的
区域。当导管到达所研究的部位时，将X射线造影剂注入导管。这会增强血管的对比度，并可以让
放射线学者观察到任何病变或阻塞。图1.7(b)显示了一个主动脉血管造影照片的例子。在图像的左下
方，可以看到插入到血管中的导管。注意，在图像中，可看到造影剂流向肾脏时大血管的强烈对比效
果。正如第2章将要讨论的那样，血管照相术是数字图像处理的主要应用领域，在该领域，图像相减
用于进一步增强被研究的血管。
X射线在医学成像中的另一个重要应用是计算机轴向断层(CAT)。由于该技术的分辨率和三维能
力，CAT扫描早在20世纪70年代第一次付诸使用时就引起了医疗手段的革命。正如1.2节提到的那
样，每幅CAT 图像都是垂直穿过病人的一个“切片",当病人纵向移动时可产生大量的“切片”,这
第1章 绪 论 7
些图像组合在一起就构成了人体内部的三维描绘图像，其纵向分辨率与切片数量成正比。图1.7(c)显
示了一幅典型的头部CAT切片图像。
与刚刚讨论的有些类似的技术也可用于工业处理，但通常使用的是更高能量的X射线。图1.7(d)
显示了一块电路板的X射线图像。这样的图像是X射线在上百种典型工业应用中的代表性图像，用
于检测电路板中的制造缺陷，如元件缺失或断线等。当元件可被X射线穿透时，CAT 扫描很有用，
譬如塑料元件，甚至更大的物体，如固体推进剂火箭发动机。图1.7(e)显示了天文学中X射线成像的
一个例子。这幅图像是图1.6(c)中的天鹅星座环，但此时是X射线波段成像。
1.3.3 紫外波段成像
紫外“光”的应用多种多样，包括平板印刷术、工业检测、显微镜方法、激光、生物成像和天
文观测等。我们仅用显微镜方法和天文观测作为例子来说明这一波段的成像。
紫外光用于荧光显微镜方法中，这是显微镜方法中发展最快的领域之一。荧光是在19世纪中叶
发现的一种现象。当时，当紫外光直接照射到矿物质上时，首次发现荧石发出了荧光。紫外光本身并
不可见，但当紫外辐射光子与荧光材料内原子中的电子碰撞时，它把电子提高到较高的能级，随后
受激电子释放到较低的能级并以可见光范围内的低能光子形式发光。荧光显微镜方法的基本任务是
用激发光照射一个样品，然后从较强的激发光中分离出较弱的荧光，这样，仅有辐射光到达人眼或
其他检测器，以允许检测足够的对比度而得到照射在暗背景上的荧光区。非荧光材料的背景越暗，
设备越有效。
荧光显微镜方法在研究可产生荧光的材料时的确是一种很优秀的方法，无论是以它们的自然形
式(原发荧光),还是经化学处理后具有荧光能力(次生荧光)。图1.8(a)和图1.8(b)显示了使用荧光显
微镜方法所得到的典型结果。图1.8(a)显示了普通玉米的荧光显微镜图像，图1.8(b)显示了被一种谷
类疾病“黑穗病”感染了的玉米图像，黑穗病是草、洋葱、高粱等被700多种寄生真菌感染后出现的
病害。玉米黑穗病是一种严重的病害，因为玉米是世界上最主要的食品来源之一。图1.8(c)显示了在
紫外波段的高能区域成像的天鹅星座环。
ab c
图1.8 紫外光成像实例：(a)普通玉米图像；(b)患黑穗病的玉米图像；(c)天鹅星座环图像
[图(a)和图(b)由佛罗里达州立大学的Michael W.Davidson博士提供，图(c)由NASA提供]
1.3.4 可见光及红外波段成像
由于电磁波谱可见光波段在所有波段中是我们最熟悉的，因此，这一波段的成像应用领域远远
超过其他波段的成像应用领域就不足为奇了。红外波段常用于与可见光相结合成像，为便于说明，本
节把可见光和红外光合并在一起讨论。下面的讨论将涉及光显微镜方法、天文学、遥感、工业和法律
实施等方面的应用。 3;3
呢-5
8 数字图像处理(第三版)
图1.9显示了一些可见光显微技术得到的图像。这些例子涵盖了从制药和微检测到材料特征的范
围。甚至仅在显微镜方法中，其应用领域如此之多，以至于不能在这里详细列出。当然，把这些图像
用于从增强到测量这些范围概念化可能并不困难。
a b c def
图1.9 光显微镜图像实例：(a)已放大250倍的紫杉酚(抗癌剂);(b)已放大40倍的胆固醇；(c)已放
大60倍的微处理器；(d)已放大600倍的镍氧化物胶片；(e)已放大1750倍的音频CD表面：
(1已放大450倍的有机超导体(这些图像由佛罗里达州立大学的MichaclW.Davidson博士提供)
可见光处理的另一个主要应用领域是遥感，遥感通常包括可见光和红外波谱范围的一些波段。表1.1
显示了NASA的LANDSAT 卫星中的所谓主要波段。LANDSAT 卫星的主要功能是从空间获得并传
送地球的图像，其目的是监测该行星的环境条件。波段用波长来表示，I μm等于10*m(我们讨论的
是电磁波谱的波长范围，第2章将详细讨论)。注意表1.1中每个波段的特征与用途。
为了阐述这类多光谱成像的基本性能，考虑图1.10,它为表1.1中的每个频谱波段显示了一幅图
像。成像区域是美国华盛顿特区，包括建筑物、道路、植被和穿过城市的主要河流(波拖马可河)等特
征。人口中心地区的图像常被用来评估人口增长和变迁方式、污染及其他有害环境的因素。可见光和
红外光特征之间的区别在这些图像中是十分明显的。例如，在波段4和波段5中，从其周围环境可以
看出如何较好地界定河流。
表1.1 NASA的LANDSAT 卫星的主要波段
波段号 名 称 波长(μm) 特征和用途
1 可见蓝光 0.45-0.52 对水体有最大的穿透性
2 可见绿光 0.52-0.60 适用于度量植物活力
3 可见红光 0.63-0.69 植被辨别
4 近红外光 0.76-0.90 生物团和海岸线测绘
5 中红外光 1.55-1.75 土壤和植被含水量
6 热红外光 10.4-12.5 土壤温度，热量测绘
7 中红外光 2.08-2.35 矿物测绘
1 2 3
4 5 6 7
图1.10 美国华盛顿特区的LANDSAT 卫星图像。图中的数字与表1.1中的波段号对应(图像由NASA提供)
第1章 绪 论
天气观测与预报也是卫星多光谱成像的主要应用领
域。例如，图1.11是由美国国家海洋和大气管理(NOAA)
卫星在可见光及红外波段使用传感器拍摄的飓风图像，
该图像中的飓风眼清晰可见。
9
图1.12和图1.13显示了红外成像的一个应用。这些
图像是“全世界夜间灯光”数据集的一部分，它可以提
供全球人类居住区的汇总情况。图像是由安装在NOAA
DMSP(防卫气象卫星计划)卫星上的红外成像系统生成
的。红外成像系统工作于10.0~13.4 μm 波段，具有独特
的功能，可观察地球表面微弱的接近可见光的近红外发
图1.11 2005年8月29日拍摄的“卡特里娜”
飓风的卫星图像(图像由NOAA提供)
射光，包括城市、小镇、村庄、气体火焰及火光。即使在图像处理方面没有正式地训练过，编写一个
计算机程序，用这些图像来估计世界不同地区使用电能的百分比也并不困难。
图1.12 美洲的红外卫星图像。小灰色图
仅供参考(图像由NOAA提供)
图1.13 世界居住区的红外卫星图像。小灰
色图仅供参考(图像由NOAA提供)
可见光谱中的一个主要成像领域是生产产品的自动视觉检测。图1.14显示了一些例子。图1.14(a)
是CD-ROM驱动器的一个控制板。对这类产品的一种典型图像处理任务是检测丢失的部件(图像右上
角1/4处的黑色方块是一个丢失部件的例子)。图1.14(b)是药丸胶囊的图像，这里的目标是用机器寻
找缺失的药丸。图1.14(c)显示了一种应用，在该应用中，图像处理技术用来寻找未装满到要求液位
的瓶子。图1.14(d)显示了一个清澈的塑料部件，部件内带有不可接受数量的气泡。这些异常检测是
工业检测的主旨，这类检测也涉及其他产品，如木材和布匹。图1.14(e)显示了一批谷物，通过颜色
和存在的异常(如变黑的小片)等进行检测。最后，图1.14(①显示了一幅含有掺杂物的目镜图像(位于
人眼处的镜头),使用了一种“结构光”照明技术加以突出，以便更容易检测平面镜头中心处出现的
镜头畸变。在类似钟表表盘的1点和5点处的刻痕是由钳子造成的损坏，而其他的多数小斑点则是残
片。这类检测的目标是在包装之前自动找出损坏的或未正确加工的装配。
作为可见光谱中图像处理的最后说明，考虑图1.15。图1.15(a)显示了一幅拇指指纹图像。指纹
图像通常由计算机处理，该处理不是增强指纹图像就是寻找特征，以便自动搜索数据库，寻找潜在的
匹配。图1.15(b)显示了一幅纸币图像。数字图像处理在该领域的应用包括自动计数、法律实施、为 3～
心手
10 数字图像处理(第三版)
追踪和鉴别钱币读取序列号等。图1.15(c)和图1.15(d)所示的两幅汽车图像是自动读取车牌的例子。
明亮的矩形指示成像系统检测车牌的区域。黑色的矩形显示了系统自动读取车牌内容后的结果。车牌
和其他字符识别广泛用于交通监测和监视中。
a b c d e f
a b c
d
0o
8028-18126
8126
MM PK41965
A165
图1.14 使用数字图像处理技术检查产品的一些例子：
(a)一块电路板控制器图像：(b)封装的药丸
图像；(c)瓶子图像；(d)清澈的塑料产品中的
气泡图像；(e)谷物图像；(4)目镜搀杂物图像
[图f由Percptics公司的Pete Sites先生提供]
图1.15 可见光谱成像的其他几个例子：(a)拇指指纹图
像；(b)纸币图像；(c)~(d)自动读取车牌图像
[图(a)由美国国家标准与技术研究所提供，图(c)
和图(d)由Perceptics公司的Juan Herera博士提供]
1.3.5 微波波段成像
微波波段成像的典型应用是雷达。成像雷达的独特之处是在任何范围和任何时间内，不考虑气
候、周围光照条件的收集数据的能力。某些雷达波可以穿透云层，在一定条件下还可以穿透植被、冰
层和极干燥的沙漠。在许多情况下，雷达是探测地球表面不可接近地区的唯一方法。成像雷达的工作
原理就像一台闪光照相机，它自己提供照明(微波脉冲)去
照亮地面上的一个区域，并得到一幅快照图像。与照相机
镜头不同，雷达使用天线和数字计算机记录图像。在雷达
图像中，能看到的只是反射到雷达天线的微波能量。
图1.16显示了一幅西藏东南方高低不平山区的星载雷
达图像，拉萨市约在东边90 km处，右下角是广阔的拉萨
河谷，这是西藏农民和牧民包括曼巴居住的地方。这一地
区的山峰海拔高度约为5800 m,其谷底位于海拔4300 m
处。注意，图像的清晰度和细节未被云层及其他大气条件
阻挡，通常这些因素在可见光波段会影响图像。
图1.16 西藏东南部山区的星载雷达
图像(图像由NASA提供)
1.3.6 无线电波段成像
正像波谱另一端(伽马射线)的成像情况那样，无线电波段成像主要应用于医学和天文学。在医
学中，无线电波用于核磁共振成像(MRI)。该技术是把病人放在强磁场中，并让无线电波短脉冲通过
第1章 绪 论 11
病人的身体，每个脉冲将导致由病人的组织发射的无线电响应脉冲，这些信号发生的位置和强度由计
算机确定，从而产生病人的一幅二维剖面图像。MRI可以在任何平面产生图像。图1.17显示了人的膝
盖和脊椎的图像。
a b
图1.17 人的MRI图像：(a)膝盖图像：(b)脊椎图像[图(a)由密歇根大学医学院解剖学分部的Thomas R.
Gest博士提供，图(b)由Vanderbilt大学医学中心辐射学与放射学系的David R.Pickens博士提供]
图1.18最右边的图像显示了无线电波段的蟹状脉冲星(Crab Pulsar)图像，为了进行有意义的比较，
还显示了使用前面讨论的一些波段拍摄的相同区域的图像。注意，每一幅图像都给出了完全不同的脉
冲星“视图”。
伽马 X射线 可见光 红外 无线电波
图1.18 覆盖电磁波谱的(位于图像中心的)蟹状脉冲星图像(图像由NASA提供)
1.3.7 使用其他成像方式的例子
虽然电磁波谱成像一直占主导地位，但大量的其他成像方式也很重要。特别地，本节讨论声波
成像、电子显微镜方法和(由计算机产生的)合成成像。
利用“声音”成像在地质勘探、工业和医学中得到了应用。地质应用采用的是声谱中的低端声
波(几百赫兹),其他应用领域的成像使用超声波(百万赫兹)。图像处理在地质中的最重要商业应用是
矿产和石油勘探。为了透过地表获取图像，主要方法之一是利用一辆大型卡车和一个大的钢制平板，
平板由卡车压在地面上，同时卡车以100 Hz的频率振动。返回声波的强度和速度由地表下面的成分
决定。这些声波经过计算机分析后，可由分析结果生成图像。
为了从海洋获取图像，能源通常由两个位于船后部的空气枪组成。返回的声波由置于船后部电
缆中的水听器检测，电缆不是放置在海底，就是用浮子悬吊着(垂直电缆)。两把空气枪交替加压至2000
psi(磅/平方英寸)左右，然后使之爆发。船的匀速运动提供了横向运动，这种横向运动与返回的声
波一起产生一幅海洋底部地下的合成三维图像。
图1.19显示了一个周知的三维模型的剖面图像，与此图像对照，测试地震成像算法的性能。箭头
指向碳氢化合物(油或气)的油气阱。这一目标比周围地层明亮，因为目标区域内的密度变化较大。地
震解释人员寻找这些亮点来发现油气。上面的地层也是亮的，但其亮度变化不像对面地层的亮度那样
强。许多地震重建算法由于以上缺点使得对该目标成像比较困难。 志;内
12 数字图像处理(第三版)
虽然超声波成像常用于制造业，
但这一技术最为熟知的应用是在医学
领域，特别是妇产科。在妇产科，医
生对未出生的胎儿成像，以确定其发
育的健康状况。这一检测的副产品是
确定胎儿的性别。超声波图像是利用 图1.19 地震模型的剖面图像。箭头指向碳氢化合物(油或气的油气
阱(图像由美国 Sandia国家实验室的Curtis Ober博士提供) 下面的基本步骤生成的：
1.超声波系统(一台计算机、由超声波源和接收器组成的超声波探头及一台显示器)向人体发射
高频(1-5MHz)声波脉冲。
2.声波传入体内并碰撞组织间的边界(举例来说，就是流体和软组织之间的边界，及软组织和
骨骼之间的边界)。一部分声波反射回探头；一部分声波则继续传播，直到它们到达另一个边
界并被反射。
3.反射波被探头拾取并传给计算机。
4.计算机根据声波在组织中的传播速度(1540m/s)和每个回波的返回时间，计算从探头到组织
或器官边界的距离。
5.系统在屏幕上显示回波的距离和亮度，形成一幅二维图像。
在典型的超声波成像中，每秒钟有上百万个脉冲与回波发出和接收。探头可沿身体表面以不同
角度运动，以便得到各种观察图像。图1.20显示了几个例子。
a b
c d
图1.20 超声波成像示例：(a)胎儿图像；(b)胎儿的另一幅观察图像；(c)甲状腺图像：(d)有
损伤的肌肉层图像(原图像由 Siemems Medical Systems公司的Ultrasound Group提供)
我们继续使用电子显微镜方法的某些例子来讨论成像方式。电子显微镜的功能与光学显微镜一
样，只不过是用一个聚焦的电子波束代替光束形成图像标本。电子显微镜的操作包括下面几个基本步
骤：由电子源产生一个电子流，用正电势朝着标本加速。该电子束用金属小孔和电磁透镜限制并聚焦
为一个细的单色波束。然后使用一个磁透镜将单色电子束聚焦到样本上。在样本内部产生交互照射并
影响电子束。这些交互作用和影响被检测并转换为一幅图像，这种方式与光被物体反射或吸收的方式
一样。所有电子显微镜均执行这些基本步骤。
透射电子显微镜(TEM)的工作原理很像一台幻灯片投影仪。投影仪发射出一束透过幻灯片的
第1章 绪 论 13
光；当光通过幻灯片时，它由幻灯片的内容调节。这一发射出的光束然后被投射到观察屏上，形成
幻灯片的放大图像。除了发射的是一个电子束通过样本(相当于幻灯片)之外，TEM 以相同的方式工
作。穿过样本的部分电子束被投射到荧光屏上，而电子与荧光物质的相互作用就产生了光，从而得到
可观察的图像。另一方面，扫描电子显微镜(SEM)实际上扫描电子束并记录每一位置上电子束与样
本的相互作用。这会在荧光屏上产生一个点。一幅完整的图像由通过样本的电子束光栅扫描形成，
这非常像电视摄像机。电子与荧光屏相互作用并产生光。SEM适合于“大块”样品，而TEM要求
非常薄的样品。
电子显微镜有非常高的放大能力。光学显微镜的放大倍数限制在1000左右，电子显微镜的放大
倍数可达到10000或更大。图1.21显示了两幅由于过热而造成损坏的样本图像。
a b
图1.21(a)因过热而损坏的钨丝放大250倍的SEM图像(注意左下方的碎片);(b)已损坏集成电
路的2500倍SEM图像。白色纤维是由热破坏造成氧化的结果[图(a)由俄勒冈大学地质
科学系的Michael Shaffer先生提供，图(b)由加拿大McMaster大学的J.M.Hudak 博士提供]
下面我们通过简略浏览一些图像来结束对成像模式的讨论，这些图像不是来自物理对象，而是
用计算机产生的。分形是由计算机生成图像的显著例子(Lu[1997])。基本上，分形只不过是一种基本
模式根据某些数学规则的迭代复制。例如.“贴瓷砖”是产生分形图像的最简方法之一。一个方块可
细分为4个小方块，每个小方块又可进一步细分为4个更小的方块，等等。为了填充每个小方块，根
据规则的复杂性，一些漂亮的瓷砖图像可用这一方法产生。当然，几何形状可以是任意的。例如，分
形图像可以从一个中心点向外辐射生长。图1.22(a)显示了使用这种方法生成的分形图像。图1.22(b)
显示了另一幅分形图像(“月球表面”),它为前述章节所用过的空间图像提供了一个有趣的模拟。
a h c d
图1.22(a)~(b)分形图像；(c)-(d)由所示物体的三维计算机模型生成的图像[图(a)和图(b)
由Swarthmore学院的MelissaD.Binde先生提供，图(c)和图(d)由NASA提供]
分形图像朝着具有艺术性的，并根据某一规则的子图像元素生长的数学公式表示的方向发展。
它们有时会用做随机纹理。借助于计算机生成更结构化的图像依赖于三维建模。三维建模是图像处理
和计算机图形学的交叉领域，也是许多三维可视化系统(如光模拟器)的基础。图1.22(c)和图1.22(d)
显示了计算机生成的图像例子。因为原始物体是以三维方式创建的，所以可以在任何角度由三维物体
的平面投影来生成图像。这种类型的图像可用于医学培训及其他主要应用，如刑事法庭和需要产生特
殊效果的场合。 马;去
14 数字图像处理(第三版)
1.4 数字图像处理的基本步骤
把后续各章涉及的内容划分为1.1节定义的两个主要类别是有帮助的：一类是其输入和输出都是
图像；另一类是其输入可能是图像但输出是从这些图像中提取的属性。这种组织结构总结于图1.23中。
该图并不意味着每种处理都用于图像。相反，目的是给出所有方法的一个概念，这些方法可以针对不
同的目的、不同的目标运用于图像。这一节的讨论也可以看成是本书其余部分内容的综述。
这些处理的输出通常为图像
安;5
第6章
彩色图像处理
第7章
小波与多
分辨率处理
T
第8章
压缩
立
第9章
形态学处理
第5章 图像复原
知识库
第10章
分割
第3章和第4章
图像滤波与增强
第11章
表示和描述 这些处理的输出通常为图像属性
第2章 第12章
问题域 图像获取 目标识别
图1.23 数字图像处理的基本步骤，方框中指出的章号是方框中讨论内容的位置
图像获取是图1.23中的第一步处理。1.3节的讨论给出了关于数字图像起源的一些提示。这个主
题在第2章中将更具体地进行研究，这一章还要介绍一些贯穿全书的基本数字图像的概念。注意，图
像获取与给出一幅数字形式的图像一样简单。通常，图像获取阶段包括图像预处理，譬如图像缩放。
图像增强是对一幅图像进行某种操作，使其结果在特定应用中比原始图像更适合进行处理。特
定一词在这里很重要，因为一开始增强技术就建立在面向问题的基础之上。例如，对于增强X射线
图像十分有用的方法，对于增强电磁波谱中红外波段获取的卫星图像可能就不是最好的方法。
没有图像增强的通用“理论”。当为视觉解释而处理一幅图像时，观察者就是特殊方法工作好坏
的最终裁判者。增强技术是如此多种多样，以至于有众多不同的图像处理方法，因此在没有广泛背景
介绍的情况下，在一章中组织出适合于增强技术有意义的主体是很困难的。基于这个原因，也基于图
像处理领域的初学者通常看到图像增强应用在视觉上是很吸引人的、有趣的且理解起来相对简单的，
所以在第2章、第3章和第4章中，当我们介绍新概念时，都会以图像增强作为例子。后两章中的内
容涉及许多用于增强图像的传统方法。因此，使用来自图像增强的例子介绍早些章节阐述的新图像处
理方法，不仅节省了本书处理图像增强的额外章节，而且更重要的是，对于向新学习者介绍本书早期
处理技术细节也是有效的方法。然而，正像您将看到的本书其余内容的进展那样，这些章节阐述的内
容可应用于比图像增强宽泛得多的问题。
图像复原也是改进图像外观的一个处理领域。然而，与图像增强不同，图像增强是主观的，而
图像复原是客观的；在某种意义上说，复原技术倾向于以图像退化的数学或概率模型为基础。另一方
面，增强以什么是好的增强效果这种人的主观偏爱为基础。
彩色图像处理已经成为一个重要领域，因为互联网上数字图像的使用在在不断增长。第6章涵
第1章 绪 论 15
盖了许多彩色模型和数字域的彩色处理的基本概念。在后续各章中，彩色也是提取图像中感兴趣特征
的基础。
小波是以不同分辨率来描述图像的基础。特别是，本书中为图像数据压缩和金字塔表示使用了
小波，在这里，图像被成功地细分为较小的区域。
正如其名称指出的那样，压缩指的是减少图像存储量或降低传输图像带宽的处理。虽然存储技
术在过去的10年里已有明显改进，但对于传输能力我们还不能这样说。尤其在互联网的应用上更是
如此，互联网是以大量图片内容为特征的。多数计算机用户都很熟悉(也许并未注意)图像压缩所用的
图像文件扩展名，如JPG文件扩展名用于JPEG(联合图片专家组)图像压缩标准。
形态学处理涉及提取图像分量的工具，这些分量在表示和描述形状方面很有用。正如1.1节所指
出的那样，这一章的内容将从输出图像处理到输出图像属性处理的转换开始。
分割过程将一幅图像划分为它的组成部分或目标。通常，自动分割是数字图像处理中最困难的
任务之一。成功地把目标逐一识别出来是一个艰难的分割过程。另一方面，很弱的且不稳定的分割算
法几乎总是会导致最终失败。通常，分割越准确，识别越成功。
表示与描述几乎总是在分割阶段的输出之后，通常这一输出是未加工的像素数据，这些数据不
是构成一个区域的边界(即分隔一个图像区域与另一个图像区域的像素集合),就是构成该区域本身的
所有点。无论哪种情况，把数据转换成适合计算机处理的形式都是必要的。首先，必须确定数据是应
表示为一条边界还是应表示为整个区域。如果关注的是外部形状特征，譬如角点和拐点，则表示为边
界是合适的。如果我们关注的是内部特性，例如纹理或骨架形状，则区域表示是合适的。在某些应用
中，这些表示彼此是互补的。选择一种表示仅是解决把原始数据转换为适合计算机进行后续处理的形式
的一部分。为了描述数据以使感兴趣的特征更明显，必须确定一种方法。描述又称为特征选择，涉及
提取特征，它可得到某些感兴趣的定量信息，或是区分一组目标与其他目标的基础。
识别是基于目标的描述给该目标赋予标志(譬如“车辆”)的过程。如1.1节详细介绍的那样，我
们通过阐述识别个别目标的方法来结束数字图像处理的讨论。
到目前为止，我们还没有谈到关于先验知识及图1.23中知识库与各个处理模块之间的关系的内容。
有关问题域的知识已经以知识库的形式编码并存入图像处理系统中。这一知识可能像一幅图像详细描
述区域那样简单，在这里定位已知的感兴趣的信息，可将限制性的搜索引导到要寻找的信息处。知识
库也可能相当复杂，如材料检测问题中所有主要缺陷的相关列表，或者包含变化检测应用中一个区域
的高分辨率卫星图像的图像数据库。除了引导每个处理模块的操作外，知识库还要控制模块之间的交
互。这一特性由图1.23中处理模块和知识库之间的双头箭头表示，而单头箭头则用于连接处理模块。
虽然没有专门地讨论图像显示，但要记住图像显示是很重要的，观察图像处理的结果可在图1.23
中的任何阶段的输出处执行。还应注意，不是所有的图像处理应用都需要图1.23给出的复杂交互。事
实上，在某些情况下甚至并不需要所有这些模块。例如，用于人眼视觉解释的图像增强就很少要求使
用图1.23中的任何其他步骤。然而，通常随着图像处理任务复杂性的增加，需要做更多处理才能解决
问题。
1.5 图像处理系统的组成
20世纪80年代中叶，世界各地售出的各种型号的图像处理系统，基本上都是由许多主机及与这
些主机配套的外设组成的。20世纪 80年代末90年代初，市场已转为将图像处理硬件设计为与工业
标准总线兼容，并能配合工程工作站机箱和个人计算机的单板形式。除了降低成本外，这一市场转型
还如催化剂一样催生了大量的新公司，这些公司的任务是开发用于图像处理的软件。 1志
;15
16 数宇图像处理(第三版)
虽然针对如处理卫星图像的大规模图像应用的大型图像处理系统一直在出售，但趋势是朝着小
型化和通用化的小型机并带有专用图像处理硬件的混合型系统方向发展。图1.24显示了用于数字图像
处理的一个典型通用系统的组成。下面几段讨论每个组件的功能，从图像感知开始。
关于感知，需要两个部件来获取数字图像。第一
个部件是物理设备，该设备对我们希望成像的目标辐
网络
射的能量很敏感。第二个部件称为数字化器，数字化
器是一种把物理感知装置的输出转换为数字形式的设
备。例如，在数字视频摄像机中，传感器产生一个与
光强成正比的输出，数字化器把该输出转换为数字数
据。这些主题包含在第2章中。
专用图像处理硬件通常由刚刚谈到的数字化器与 图像传感器 执行其他原始操作的硬件[如算术逻辑单元(ALU)]
个 组成，算术逻辑单元对整个图像并行执行算术与逻辑
问题域 运算。如何使用ALU的一个例子是与数字化一样快
图1.24 通用图像处理系统的组成 的图像取平均操作，这一操作的目的是降低噪声。这
种类型的硬件有时称为前端子系统，其显著特点是速度快。换句话说，该单元执行要求快速数据吞吐
的功能(譬如以30帧/秒的速率来数字化和平均视频图像),典型的主机不能胜任该工作。
图像处理系统中的计算机是通用计算机，其范围从PC到超级计算机。有时在专门应用中也采用
特殊设计的计算机，以达到所要求的性能水平。但是，这里感兴趣的还是通用图像处理系统。在这些
系统中，几乎任何配置较好的PC对于离线图像处理任务都是适合的。
图像处理软件由执行特定任务的专用模块组成。一个设计优良的软件包还包括为用户写代码的
能力，例如，最小化就可以使用专用模块。更完善的软件包允许那些模块的集成，并至少用一种计算
机语言编写通用软件命令集。
大容量存储能力在图像处理应用中是必需的。一幅图像的尺寸是1024×1024像素，每像素的灰度是
8比特，如果图像不压缩，则需要1 MB的存储空间。在处理几千幅甚至几百万幅图像时，在图像处理系
统中提供足够的存储空间将是一个极大的挑战。图像处理应用的数字存储分为三个主要的类别：(1)处理
期间的短期存储；(2)关系到快速调用的在线存储；(3)档案存储，其特点是不频繁访问。存储是以字
节(8比特)、千字节(1000字节)、兆字节(100万字节)、吉字节(10亿字节)或太字节(TB)来计量的。
提供短期存储的一种方法是使用计算机内存。另一种方法是采用专用的存储板，这种存储板称为
帧缓存，它们可以存储一帧或多帧图像并可快速访问，通常以视频速率(30帧/秒)访问。后一种方法
实质上允许瞬时缩放、滚动(垂直移动)和摇动(水平移动)图像。帧缓冲器通常放在专用图像处理硬件
单元中，如图1.24所示。在线存储通常采用磁盘或光介质存储。在线存储的关键特性参数是对存储数
据的访问频率。最后，档案存储是以大容量存储要求为特征的，但无须频繁访问。放在类似于投币电
唱机的盒子内的磁带和光盘是通常使用的档案存储介质。
今天使用的图像显示器主要是彩色电视监视器(更好一些的是平面屏幕)。监视器由图像和图形
显示卡的输出驱动，它们是计算机系统的一个集成部分。对于图像显示应用不可能没有这样的要求，
即作为计算机系统的一部分，其显示卡应满足商用性要求，在有些情况下还要求立体显示。立体显示
是采用戴在用户头上的目镜上嵌有的两个小的显示屏的头盔来实现的。
用于记录图像的硬拷贝设备包括激光打印机、胶片相机、热敏装置、喷墨装置和数字单元，如
CD-ROM 等。胶片的分辨率最高，但纸作为书写材料是首选的介质。为了表现图像，图像可显示在
透明胶片上，或者使用图像投影设备显示在数字介质中。后者作为图像表现的标准正在被逐步接受。
图像显示器 计算机 大容量存储
硬拷贝 专用图像
处理硬件 图像处理软件
第1章 绪论 17
网络在今天所用的计算机系统中几乎都是默认的功能。因为大数据量在图像处理应用中是固有
的，在图像传输中主要考虑的问题是带宽。在专用网络中，这不是一个典型问题，但通过互联网的远
程通信就不总是有效的了。幸运的是，随着光纤与其他宽带技术的发展，这一状况正在迅速得到改善。
小结
本章呈现的材料的主要目的是对数字图像处理的起源、重要意义、该技术当前及未来的应用领
域提供概括性的介绍。由于篇幅所限，本章中涉及主题的覆盖面必然不太全面，但是在数字图像处理
的知识宽度和应用范围方面应该已经给读者留下了一个清晰的印象。在后面的章节中，将进行图像处
理的理论和应用方面的阐述，并提供大量的实例，以进一步理解这些技术的应用。学完本书的最后一
章后，读者应能了解数字图像处理领域的大多数当前研究进展情况。
参考文献
后续各章末尾的参考资料致力于那些章节讨论的特定话题，并在本书末尾对参考书提供了线索。然而，
为了在这一章集中汇总一下关于图像处理和相关主题的材料，我们采用不同的方式列出主要杂志。这里还
提供了一个书目列表，以便读者可以快速了解本领域的历史和当前的发展动态。这一章引用的参考材料主
要是图像处理方面的一般性的、易于理解的已出版文献。
关于图像处理及相关题目的主要参考杂志包括：IEEETransactions on Image Processing;IEEETransactions
on Patten Analysis and Machine Inteligence;Computer Vision.Graphics,and Image Processing(1991年前);
Computer Vision and Image Understanding;IEEE Transactions on Systems,Man and Cybemetics; Arificial
Intelligence;Patem Recognition;Puttem Recognirion Letters; Joumal of the Oprical Society of America(1984年前);
Jounal of the Optical Sociery of America-A:Optics,Image Science and Vision; Optical Engineering:Applied
Optics Information Processing:IEEE Transaction on Medical Imaging; Jounal of Electronic Imaging:IEEE
Transactions on Information Theory;IEEE Transactions on Communications;IEEE Transactions on Acoustics,
Speech and Signal Processing:Proceedings of the IEEE;以及1980年前的IEEE Transactions on Computer专刊。
国际光学工程协会(SPIE)的出版物也很重要。
下面按出版年份反序列出了包含有数字图像处理补充材料的书籍(偏重于近年来出版的书籍)。这些书
籍给出了该领域过去30多年来的发展概述，同时选择了各种形式的论著。它们的覆盖范围从基础理论的教
科书，到提供技术综述的手册，以及包含该领域当前研究的代表性材料的编辑书籍。
Prince,J.L. and Links,J.M.[2006].Medical Imaging, Signals, and Systems, Prentice
Hall,Upper Saddle River,NJ.
Bezdek,J.C.et al.[2005].Fuzzy Models and A/gorithms for Pattern Recognition and
Image Processing,Springer,New York.
Davies.E.R.[2005].Machine Vision:Theory,A/gorithms,Practicalities.Morgan Kauf mann.San Francisco,CA.
Rangayyan,R.M.[2005].Biomedical Image Analysis,CRCPress,Boca Raton,FL
Umbaugh,S.E.[2005].Computer Imaging:Digital Image Analysis and Processing.CRC
Press,Boca Raton,FL.
Gonzalez,R.C,Woods,R.E,and Eddins,S.L.[2004].Digital Image Processing Using
MATLAB,Prentice Hall,Upper Saddle River,NJ.
Snyder, W.E.and Qi,Hairong [2004].Machine Vision,Cambridge University Press,
New York.
Klette,R.and Rosenfeld,A.[2004].Digital Geometry-Geometric Methods for Digital Picture Analysis,Morgan Kaufmann,San Francisco,CA. 送1因
5～5
18 数字图像处理(第三版)
Won,C.S.and Gray,R.M.[2004].Stochastic Image Processing,Kluwer Academic/Plenum
Publishers,New York.
Soille,P.[2003]. Morphological Image Analysis:Principles and Applications,2nd ed.,
Springer-Verlag,New York.
Dougherty,E.R.and Lotufo,R.A.[2003].Hands-on Morphological Image Processing,
SPIE-The International Society for Optical Engineering, Bellingham,WA.
Gonzalez,R.C.and Woods,R.E.[2002].Digital Image Processing,2nd ed.,Prentice
Hall,Upper Saddle River,NJ.
Forsyth, D.F.and Ponce,J.[2002]. Computer Vision-A Modern Approach, Prentice
Hall,Upper Saddle River,NJ.
Duda,R.O.,Hart,P.E.,and Stork,D.G.[2001]. Pattern Classification,2nd ed.,John
Wiley &Sons,New York.
Pratt,W.K.[2001].Digital ImageProcessing,3rd ed.,John Wiley &Sons,New York.
Ritter, G.X.and Wilson,J.N.[2001]. Handbook of Computer Vision Algorithms in
Image Algebra,CRC Press,Boca Raton, FL.
Shapiro,L.G.and Stockman,G.C.[2001].Computer Vision,Prentice Hall,Upper Saddle
River,NJ.
Dougherty,E.R.(ed.)[2000]. Random Processes for Image and Signal Processing,
IEEE Press,New York.
Etienne,E.K.and Nachtegael,M.(eds.).[2000].Fuzzy Techniques in Image Processing,
Springer-Verlag,New York.
Goutsias,J,Vincent,L.,and Bloomberg,D.S.(eds).[2000].Mathematical Morphology and Its Applications to Image and Signal Processing,Kluwer Academic Publishers,
Boston,MA.
Mallot,A.H.[2000].Computational Vision,The MIT Press,Cambridge,MA.
Marchand-Maillet,S.and Sharaiha,Y.M.[2000].Binary Digital Image Processing:A
Discrete Approach,Academic Press,New York.
Mitra,S.K.and Sicuranza,G.L.(eds.)[2000].Nonlinear Image Processing,Academic
Press,NewYork.
Edelman,S.[1999]. Representation and Recognition in Vision,The MIT Press, Cam bridge,MA.
Lillesand,T.M.and Kiefer,R.W.[1999].RemoteSensing and Image Interpretation,John
Wiley & Sons,NewYork.
Mather,PM.[1999].Computer Processing of Remotely Sensed Images:An Introduction,
John Wiley & Sons,New York.
Petrou,M.and Bosdogianni,P.[1999].Image Processing:The Fundamentals,John Wiley & Sons,UK.
Russ,J.C.[1999].The Image Processing Handbook,3rd ed.,CRC Press,Boca Raton,FL.
Smirnov,A.[1999].Processing of MultidimensionalSignals,Springer-Verlag,New York.
Sonka,M., Hlavac,V., and Boyle,R.[1999].Image Processing,Analysis, and Computer
Vision,PWS Publishing,New York.
Haskell,B.G.and Netravali,A.N.[1997].Digital Pictures:Representation, Compression,
and Standards,Perseus Publishing,New York.
Jahne,B.[1997].Digital Image Processing:Concept,Algorithms and ScientificApplica tions, Springer-Verlag,New York.
Castleman,K.R.[1996].Digital Image Processing,2nd ed.,Prentice Hall,Upper Saddle
River,NJ.
Geladi,Pand Grahn,H.[1996].Multivariate Image Analysis,John Wiley & Sons,New York.
Bracewell,R.N.[1995].Two-Dimensional Imaging,Prentice Hall,Upper Saddle River,NJ.
第1章 绪论
Sid-Ahmed, M.A.[1995].Image Processing: Theory,Algorithms, and Architectures,
McGraw-Hill,New York.
Jain,R.,Rangachar,K.,and Schunk,B.[1995].Computer Vision,McGraw-Hill,New York.
Mitiche,A.[1994].Computational Analysis ofVisual Motion,Perseus Publishing,NewYork.
Baxes,G.A.[1994].Digital Image Processing:Principles and Applications,John Wiley
& Sons,New York.
Gonzalez, R.C.and Woods, R.E.[1992].Digital Image Processing,Addison-Wesley,
Reading,MA.
Haralick,R.M.and Shapiro,L.G.[1992].Computer and Robot Vision,vols.1&2,
Addison-Wesley,Reading,MA.
Pratt,W.K.[1991]Digital Image Processing,2nd ed.,Wiley-Interscience,New York.
Lim,J.S.[1990].Tiwo-Dimensional Signal and Image Processing,Prentice Hall,Upper
Saddle River,NJ.
Jain,A.K.[1989]. Fundamentals of Digital Image Processing, Prentice Hall,Upper
Saddle River,NJ
Schalkoff, R.J.[1989].Digital Image Processing and Computer Vision,John Wiley &
Sons,New York.
Giardina,C.R.and Dougherty,E.R.[1988].Morphological Methods in Image and Signal
Processing,Prentice Hall,Upper Saddle River,NJ.
Levine,M.D.[1985].Vision in Man and Machine,McGraw-Hill, New York.
Serra,J.[1982].ImageAnalysis and Mathematical Morphology,Academic Press,New
York.
Ballard,D.H.and Brown,C.M.[1982].Computer Vision,Prentice Hall, Upper Saddle
River,NJ.
Fu, K.S.[1982].Syntactic Pattern Recognition and Applications, Prentice Hall,Upper
Saddle River,NJ.
Nevatia,R.[1982].Machine Perception,Prentice Hall,Upper Saddle River,NJ.
Pavlidis,T.[1982].Algorithms for Graphics and Image Processing,Computer Science
Press,Rockville,MD.
Rosenfeld,A.and Kak,A.C.[1982].Digital Picture Processing,2nd ed.,vols.1&2,
Academic Press,New York.
Hall,E.L.[1979].Computer Image Processing andRecognition,Academic Press,New York.
Gonzalez,R.C.and Thomason,M.G.[1978].Syntactic Pattern Recognition:An Intro duction,Addison-Wesley,Reading,MA.
Andrews,H.C.and Hunt,B.R.[1977].Digital Image Restoration,Prentice Hall,Upper
Saddle River,NJ.
Pavlidis,T.[1977].Structural Pattern Recognition,Springer-Verlag,New York.
Tou,J.T.and Gonzalez, R.C.[1974].Pattern Recognition Principles,Addison-Wesley,
Reading,MA.
Andrews,H.C.[1970].Computer Techniques in Image Processing,Academic Press,
New York.
19
5～5
宏-分
第2章 数字图像基础
要想成功，就必须弄清基础问题。
——亚里士多德
引言
本章的主要目的是介绍本书所用到的数字图像处理的一些基本概念。2.1节简述人类视觉系统的
机理，包括眼中图像的形成及对亮度的适应和鉴别能力。2.2节讨论光、电磁波谱的其他分量及它们
的成像特点。2.3节讨论成像传感器及怎样使用它们产生数字图像。2.4节介绍均匀图像取样及灰度量
化的概念。该节中讨论的其他主题包括数字图像表示、图像中取样数和灰度级变化的影响、空间和灰
度分辨率的概念，以及图像内插的原理。2.5节处理像素间的各种基本关系。最后，2.6节介绍本书用
到的主要数学工具。该节的第二个目的是帮助您开始积累一些在各种基本图像处理任务中如何运用这
些工具的感觉。这些工具及其应用范围在需要时将在本书的剩余部分再扩展。
2.1 视觉感知要素
虽然数字图像处理这一领域建立在数学和概率公式表示的基础之上，但人的直觉和分析在选择
一种技术而不选择另一种技术时会起核心作用，这种选择通常是基于主观的视觉判断做出的。因此，
将大概了解人类的视觉感知作为学习本书的起点是合适的。鉴于这一主题的复杂性和宽泛性，这里仅
涉及人类视觉的最基本方面。特别是，我们的兴趣在于人类形成并感知图像的机理和参数。我们的兴
趣还在于通过数字图像处理的一些因素来了解人类视觉的物理限制。因此，人类与电子成像设备相比，
在分辨率和对光照变化的适应能力方面不仅有趣，从实践的角度来看也很重要。
2.1.1 人眼的结构
图2.1显示了人眼的一个简化水平剖面。眼睛的形状近似为一个球体，其平均直径约为20 mm。
有三层薄膜包围着眼睛：角膜与巩膜外壳、脉络膜和视网膜。角膜是一种硬而透明的组织，覆盖着眼
睛的前表面。与角膜相连的巩膜是一层包围着眼球其余部分的不透明的膜。
脉络膜位于巩膜的正下方。脉络膜包含有血管网，它是眼睛的重要滋养源。即使是对脉络膜表面
并不严重的损害，也有可能严重地损害眼睛，引起限制血液流动的炎症。脉络膜外壳着色很重，因此
有助于减少进入眼内的外来光和眼球内反向散射光的数量。脉络膜的的最前面分为睫状体和虹膜。虹
膜的收缩和扩张控制着进入眼睛的光量。虹膜中间的开口(瞳孔)的直径是可变的，范围大约在2-8mm。
第2章 数字图像基础 21
虹膜的前面包含有眼睛的可见色素，而后面则包含
有黑色色素。
角膜 虹膜
晶状体由同心的纤维细胞层组成，并由附在睫
状体上的纤维悬挂着。晶状体包含60?0??水、
6??脂肪和比眼睛中任何其他组织都多的蛋白质。
晶状体由稍黄的色素着色，其颜色随着人的年龄的
增大而加深。在极端情况下，晶状体会过于混浊，
这通常是由白内障等疾病引起的，可能导致低下的
彩色辨别能力和视觉清晰度的损失。晶状体吸收大
约8??可见光谱，对短波长的光有较高的吸收率。
在晶状体结构中，蛋白质吸收红外光和紫外光，吸
收过量时会伤害眼睛。
前房 睫状肌
品状体
睫状小带
视轴
玻璃体
视网膜
盲点 中央凹
巩膜
眼睛最里面的膜是视网膜，它布满了整个后部 脉络膜一
的内壁。当眼睛适当地聚焦时，来自眼睛外部物体
的光在视网膜上成像。由视网膜表面分布的不连续
的光，感受器提供了图案视觉。有两类光感受器：
图2.1 人眼剖面简图 锥状体和杆状体。每只眼睛中的锥状体数量在
600~700万之间。它们主要位于视网膜的中间部分，称之为中央凹，且对颜色高度敏感。用这些锥
状体，人可以充分地分辨图像细节，因为每个锥状体都连接到自身的神经末梢。肌肉控制眼球转动，
直到感兴趣的物体图像落到中央凹上。锥状体视觉称为白昼视觉或亮视觉。
杆状体的数量更多：约有7500~15000万个杆状体分布在视网膜表面。由于分布面积较大而且几
个杆状体连接到一个神经末梢，因此减少了这些感受器感知细节的数量。杆状体用来给出视野内的一
般的总体图像。它们没有彩色感觉，而对低照明度敏感。例如，在白天呈现鲜明色彩的物体，在月光
下都没有颜色，因为此时只有杆状体受到刺激。这种现象称为暗视觉或微光视觉。
图2.2显示了右眼中通过眼睛光神经出现区的剖面的杆状体和锥状体密度。在这一区域由于没有
感受器而导致了所谓的盲点(见图2.1)。除了这一区域，感受器的分布是关于中央凹径向对称的。感
受器密度根据距中央凹的度数来度量(即离开视轴的度数，它由视轴和通过晶状体中心并相交于视网
膜的一条直线的夹角度量)。注意，图2.2中的锥状体在视网膜的中心最密(在中央凹的中心区域)。还
应注意到，从该中心向外到偏离视轴大约20°处，杆状体的密度逐渐增大，然后向外到视网膜的极限
边缘处，密度逐渐下降。
杆状体数或锥状体数/mm2
180 000[
135000
90000
45000
80
盲点
60 40 20 0 200 40
距视轴(中央凹的中心)的度数
图2.2 视网膜中杆状体和锥状体的分布
—锥状体
--杆状体
60 80 因;名
召-8
22 数字图像处理(第三版)
中央凹本身是视网膜中直径约为1.5mm 的圆形凹坑。然而，为便于后续的讨论，我们把它近
似为方形或矩形敏感元素的阵列会更有用。这样，为解释的灵活性，我们可以把中央凹看成是大小
为1.5mm×1.5mm的方形传感器阵列。在视网膜这一区域中，锥状体的密度大约为150000个/mm2。
基于这一近似，眼睛中最高敏感区域的锥状体数量约为337 000个。从自然分辨能力的角度看，恰好
与一个中等分辨率的电荷耦合元件(CCD)成像芯片具有的元素数量相当，接收器阵列不大于5mm×
5mm。尽管人类整体的智慧和视觉经验的能力使得这种比较有些肤浅，但记住，人眼分辨细节能力
的进一步讨论与当前电子成像传感器当然是可比较的。
2.1.2 眼睛中图像的形成
在普通照相机中，镜头有固定的焦距，各种距离的聚焦是通过改变镜头和成像平面间的距离实
现的，胶片放置在成像平面上(数码相机情况下是成像芯片)。在人眼中，则与此相反；晶状体和成
像区域(视网膜)之间的距离是固定的，实现正确聚焦的焦距是通过改变晶状体的形状来得到的。睫
状体中的纤维可实现这一功能，在远离或接近目标物时纤维会分别变扁或加厚晶状体。晶状体中心
和视网膜沿视轴的距离大约是17mm。焦距约为14~17mm,在眼睛放松且聚焦距离大于3m时，焦
距约为17mm。
图2.3中的几何关系说明了如何得到一幅在视网膜上形成的图像的尺度。例如，假设一个人正在
观看距其100m处的高为15m的一棵树。令h表示视网膜图像中该物体的高度，由图2.3的几何形状
可以看出15/100=h/17或h=2.55mm。正如2.1.1节指出的那样，视网膜图像主要聚焦在中央凹区域。
然后，光接收器的相对刺激作用产生感知，把辐射能转变为电脉冲，最后由大脑解码。
C
15m
100m 17mm→
图2.3 人眼观看一棵棕榈树的图解，点C是晶状体的光心
2.1.3 亮度适应和辨别 强闪光
因为数字图像作为离散的灰度集来显示，所以
眼睛对不同亮度级别之间的辨别能力在显示图像处理
结果中是一个重要的考虑因素。人的视觉系统能够
适应的光强度级别范围是很宽的——从暗阈值到强
闪光约有10个量级。实验数据指出，主观亮度(即由
人的视觉系统感知的亮度)是进入人眼的光强的对数函
B.、
主观亮度 适应范围 B?_
数。图2.4中画出的光强度与主观亮度的关系曲线说
明了这一特性。长实线代表视觉系统能适应的光强范
围。在亮视觉中，该范围大约是10?。由暗视觉逐渐过
渡到亮视觉的近似范围约为0.001~0.1mL(朗伯)(在对
数坐标中为-3~-1 mL),图中画出了该范围内这一适
应曲线的两个分支。
暗视觉
亮视觉 暗阀值-
0 -6-4-2 24
光强的对数(mL)
图2.4 显示了特殊适应级别的主观亮度感知范围
第2章 数字图像基础 23
解释图2.4中描述的令人印象深刻的动态范围的基本要点是视觉系统不能同时在一个范围内工
作。确切地说，它是通过改变其整个灵敏度来完成这一较大的变动的，这就是周知的亮度适应现象。
眼睛可以同时辨别的不同强度级别的总范围与整个适应范围相比是很小的。对于任何给定的条件集
合，视觉系统的当前灵敏度级别称为亮度适应级别，例如，它可能对应于图2.4中的亮度 Ba。较短的
交叉线表示当眼睛适应这一强度级别时人眼所能感知的主观亮度范围。注意，这一范围是有一定限制
的，级别B?或低于级别B?的刺激都被感知为不可辨别的黑色。该曲线的上部实际上不受限制，但如
果延伸太远也会失去意义，因为高得多的强度将会把适应能力提高到比B?更高的水平。
在任何特定的适应级别上，人眼辨别光强变化的能力也是值得考虑的因素。用于确定人类视觉
系统亮度辨别能力的一个著名实验，由一个注视对象和大到足以使其占有全部视野的均匀发光区组
成。这一区域是一个典型的漫反射体，譬如不透明玻璃，使用强度I可变的一个光源从后面照向该漫
反射体。在该视野中增加一个照射分量△I,形成一个持续时间很短的闪烁，该闪烁以均匀光场中央
的圆形方式出现，如图2.5所示。
如果△I不够亮，则目标不变，表明没有可觉察的变化。当△I逐渐加强时，目标会给出肯定的响
应“是”,指出一个可觉察的变化。最后，当A足够强时，目标将始终给出肯定的响应“是”。
△,/1称为韦伯比，其中△,是在背景照明为1时可辨别照明增量的50??△,/1值较小意味着可辨
别强度较小的百分比变化，这表示亮度辨别能力“较好”。相反，AI./1较大意味着要求有较大强度
的百分比变化，这表示亮度辨别能力“较差”。
作为log I的函数，log△./1曲线具有图2.6所示的一般形状。这一曲线表明，在低照明级别，
亮度辨别较差(韦伯比大),且它会随着背景照明的增加而明显改善(韦伯比降低)。曲线中的两个分支
反映了这样一个事实，即在低照明水平情况下，视觉由杆状体执行，在高照明水平情况下(表示较好
的辨别能力),视觉由锥状体执行。
1.0
0.5
0
1+△/
1
nao -0.5
-1.0
-1.5
-2.0-4 -3 -2 -1 0 2 3 4
log/
图2.5 用于表征亮度辨别的基本实验设置 图2.6 作为强度函数的典型韦伯比
如果背景照明保持恒定，并且代替闪光的其他光源的强度现在允许从不能觉察逐渐变化到总可
以被觉察，典型的观察者可以辨别总共12级到24级的不同强度变化。粗略地看，该结果与一个人观
看单色图像中的任意一点时所觉察到的不同强度的数量相关。这个结果并不意味着一幅图像可以由这
样少的强度值来表示，因为当眼睛扫视图像时，平均背景在变化，从而允许在每个新的适应级别上检
测一组不同的增量变化。最终结果是眼睛能够辨别更宽范围的整个强度。事实上，我们将在2.4.3节
说明，眼睛能够检测到用不足24级强度表示的单色图像中的令人讨厌的轮廓效应。
两种现象清楚地表明感知亮度不是简单的强度的函数。第一种现象基于这样一个事实，即视觉 ②：召
0～6
24 数字图像处理(第三版)
系统往往会在不同强度区域的边界处出现“下冲”或“上 a
冲”现象。图2.7(a)显示了这种现象的一个典型例子。虽b
然条带的强度恒定，但在靠近边界处我们实际上感知到了
带有毛边的亮度模式[见图2.7(c)]。这些看起来带有毛边
的带称为马赫带，厄恩斯特·马赫于1865年首次描述了这
一现象。 实际亮度
第二种现象称为同时对比，它与这样一个事实有关，即
感知区域的亮度并不简单地取决于其强度，如图2.8 所示。
所有的中心方块都有完全相同的强度。然而，随着背景变得更
亮，它们在眼睛里会变得更暗。一个更熟悉的例子是一张纸，
一张纸放在桌子上时，看上去似乎比较白，而当我们使用它遮
住眼睛来直视明亮的天空时，它看起来会总是呈现黑色。
感知亮度
人类感知现象的另一些例子就是错觉，在错觉中，眼
睛填充了不存在的信息或者错误地感知了物体的几何特
点。图2.9给出了一些例子。在图2.9(a)中，正方形的轮廓看
起来很清楚，尽管图像中并没有定义这样一个图形的直线。 图2.7 马赫带效应图解 在图2.9(b)中可以看到相同的效果，只是这次是一个圆；注
意，仅有几条直线就足以导致一个完整的圆的错觉。图2.9(c)中的两条水平线段的长度相同，但看起来
一条显得比另一条短。最后，图2.9(d)中45°方向的所有直线都是等间距的平行线，然而画有交叉影线
就产生了错觉，觉得这些线不再平行。错觉是人类视觉系统的一种特性，但这一特性尚未被人类完全
了解。
a b c d
口
a bc
图2.8 同时对比的几个例子。所有的中心方块都有相同的
强度，但随着背景的变亮，它们看起来逐渐变暗 图2.9 一些典型的错觉
2.2 光和电磁波谱
电磁波谱在1.3节中已做过介绍，现在我们更详细地研究这一主题。1666年，艾萨克·牛顿发现，
当一束太阳光通过一个玻璃棱镜时，显示的光束不再是白光，而是由一端为紫色而另一端为红色的连
续色谱组成。如图2.10所示，我们感受到的可见光的彩色范围只占电磁波的一小部分。在波谱的一端
是无线电波，其波长是可见光波长的几十亿倍。波谱的另一端是伽马射线，其波长比可见光小几百万
倍。电磁波谱可用波长、频率或能量来描述。波长(λ)和频率(v)的关系可用下式描述：
第2章 数字图像基础 25
λ=clv (2.2-1)
其中c是光速(2.998×10?m/s)。电磁波谱的各个分量的能量由下式给出：
E=hv (2.2-2)
其中h是普朗克常数。波长的单位是米(m),最常用的单位是微米(表示为μm.I μm=10°m)和纳米
(表示为nm,I nm=10°m)。频率用赫兹(Hz)来度量，1 Hz表示正弦波每秒1个周期。常用的能量
单位是电子伏特。
一个光子的能量(电子伏特)
10° 10 10* 10 102 10 1 10-10-2 10- 10?+10-5 10 10-710*110
频率(Hz) 10" 10 10 10* 107 10 101? 101+10 102 10" 100 10° 10° 107 10° 10°
波长(m)
10-110- 10- 10-9 108 10- 1010~10- 10- 10-2 10-1 1 10 102 10
伽马射线 X射线 紫外线 红外线 微波 无线电波
可见光谱
0.4×10- 0.5×10 0.6×10" 0.7×10
蓝色 绿色 黄色 橙色 紫外线紫色 红色 红外线
图2.10 电磁波谱。为便于解释，可见光谱已被放大，但请注意，可见光谱是电磁波谱中相当窄的一部分
电磁波可以看成是以波长λ传播的正弦波(见
图2.11),或者可以看成是没有质量的粒子流，每个
粒子以波的模式以光速传播和移动。每个无质量的粒
子包含一定的(一束)能量，每束能量称为一个光子。
—A
我们从式(2.2-2)可以看出能量与频率成正比，因此更
高频率(更短波长)的电磁现象的每个光子携带有更多
的能量。这样，无线电波有低能量光子，微波比无
图2.11 一个波长的图形表示
线电波具有较多的能量，红外波还要多，然后是可见光、紫外线、X射线和最后的伽马射线，其中伽
马射线的能量最高，这就是伽马射线对活体组织危害很大的原因。
光是一种特殊的电磁辐射，它可以被人眼感知。为便于讨论，把可见光谱(彩色)段扩展后示于
图2.10(第6章将更详细地讨论彩色)。电磁波谱的可见光波段的跨越范围约为0.43 μm(紫色)-0.79
μm(红色)。为方便起见，彩色谱分为6个主要区域：紫色、蓝色、绿色、黄色、橘黄色和红色。每种
颜色(或电磁波谱的其他分量)不是突然终止的，而是混合平滑地过渡到另一种颜色的，如图2.10所示。
人感受一个物体的颜色由物体反射光的性质决定。以所有可见波长相对平衡地反射光的物体，
对观察者而言是白色的。然而，一个物体在可见光谱的有限范围内反射时会呈现各种颜色色调。例如。
绿色物体反射波长范围为500~570 nm的光，而吸收其他波长的大部分能量。
没有颜色的光称为单色光或无色光。单色光的唯一属性是它的强度或大小。因为感知单色光的
强度从黑色到灰色变化，最后到白色，灰度级一词通常用来表示单色光的强度。在后续讨论中，我们 8～9
5-8
26 数字图像处理(第三版)
将交替地使用强度和灰度级这两个术语。从黑到白的单色光的度量值范围通常称为灰度级，而单色图
像常称为灰度图像
正如前面指出的那样，彩色光的电磁能谱跨越0.43 μm(紫色)-0.79 μm(红色)的范围。除了频率
之外，有三个基本量用于描述彩色光源的质量：发光强度、光通量和亮度。发光强度是从光源流出能
量的总量，通常用瓦特(W)来度量。用流明数(lm)度量的光通量给出观察者从光源感受到的能量。例
如，从远红外光谱范围的光源发射出的光具有实际意义的能量，但观察者却很难感知到它。它的光通
量几乎是零。最后，如2.1节所讨论的那样，亮度是光感知的主观描绘子，它实际上不能度量。它具
体体现了强度的无色概念，是描述彩色感觉的参数之一。
继续图2.10的讨论，我们注意到电磁波谱的短波长的一端是伽马射线和X射线。正如1.3.1节讨
论的那样，伽马辐射对医学和天文学成像很重要，对核环境中的辐射成像也很重要。硬(高能)X射线
用于工业应用中。胸透和牙科使用的X射线位于X射线频段的低能(软)端。软X射线波段过渡到远
紫外线的区域，而远紫外区域又与较长波长的可见光谱混合。逐步移向更高的波长，我们会遇到红外
波段，红外波段会辐射热，这使得它在依靠“热特性”成像的应用中非常有用。红外波段靠近可见光
谱的部分称为近红外区域，而该波段的另一端称为远红外区域。远红外区域的后部与微波频段混合。
这个波段是众所周知的微波炉的能源，但它还有许多其他用途，包括通信与雷达。最后，无线电波段
包括电视、调幅收音机和调频收音机。在更高的能级，从某些天体发出的无线电信号在天文观测中很
有用。1.3节给出了刚才讨论的多数波段成像的例子。
原理上，如果可以开发出一种传感器来检测由一种电磁波谱发射的能量，那么我们就可以在该
波段上对感兴趣的事件成像。但要注意的一点是，要求“看到”一个物体的电磁波的波长必须小于等
于物体的尺寸。例如，水分子直径的量级是10?1m,若要研究该分子，则需要一个能在远紫外或软
X射线范围发射的光源。这个限制与传感材料的物理特性一起确立了成像传感器功能的基本限制，譬
如今天所用的可见光、红外线和其他传感器。
虽然成像主要以电磁波发射的能量为基础，但这并不是生成图像的唯一方法。例如，如1.3.7节
讨论的物体反射的声波也可用于形成超声波图像。其他的主要数字图像源是电子显微镜的电子束和用
于图形与可视化的合成图像。
2.3 图像感知和获取
我们感兴趣的多数图像都是由“照射”源和形成图像的“场景”元素对光能的反射或吸收而产
生的。把“照射”和“场景”加上引号是为了强调这样一个事实，即比我们所熟悉的一个可见光源
每天照射普通的三维场景情况更一般。例如，照射可能由电磁能源引起，如雷达、红外线或X射
线系统。但是，正如前面指出的那样，照射也可以由非传统光源(如超声波)甚至由计算机产生的照
射模式产生。类似地，场景元素可能是熟悉的物体，但它们也可能是分子、沉积岩或人类的大脑。
依赖光源的特性，照射被物体反射或透射。第一类例子是从平坦表面反射。第二类例子是为了产生
一幅X射线照片，让X射线透过病人的身体。在某些应用中，反射能或透射能可聚焦到一个光转
换器上(如荧光屏),光转换器再把能量转换为可见光。电子显微镜和某些伽马成像应用就使用这种
方法。
图2.12显示了用于将照射能量变换为数字图像的三种主要传感器配置。原理很简单：通过将输入
电能和对特殊类型检测能源敏感的传感器材料相组合，把输入能源转变为电压。输出电压波形是传感
器的响应，通过把传感器响应数字化，从每一个传感器得到一个数字量。在这一节中，我们将关注图
像感知和生成的主要方式。图像数字化将在2.4节中讨论。
第2章 数字图像基础 27
能量 6
滤光器
电源输入 传感材料
外壳- 输出电压波形
图2.12(a)单个成像传感器；(b)条带传感器：(c)阵列传感器
2.3.1 使用单个传感器获取图像
图2.12(a)显示了单个传感器的部件。也许最熟悉的这类传感器是光二极管，它由硅材料构成，
并且其输出电压波形与入射光成正比。在传感器前面用一个滤光器改善选择性。例如，光传感器前面
的绿色(通过)滤光器有利于彩色谱的绿波段光通过。因此，传感器输出的绿光比可见光谱中的其他分
量要强。 ,—胶片
为使用单一传感器产生二维图像，在传感器和成
像区域之间必须有x方向和y方向的相对位移。图2.13
示出了一个用于高精度扫描的配置，其中底片安装在
一个鼓上，鼓的机械转动提供了一个维度的位移。单个
传感器安装引导螺杆上，它提供与转动相垂直的方向
上的移动。因为机械运动可高精度地控制，所以这一方
法是得到高分辨率图像的一种廉价方法(但速度较慢)。 图2.13 单个传感器通过运动来生成二维图像 另一种类似的机械配置使用一个平面床，传感器则在两
个方向线性移动。这些类型的机械数字化仪有时称为微密度计。
传感器- 转动
线性运动
胶片每旋转一个增量且传感器完整地从左
到右线性移动一次，输出图像的一行
使用单个传感器成像的另一个例子是将一个激光源和传感器放在一起。使用镜子来控制扫描模
式的发射光束，并将反射的激光信号引导到传感器。这种配置也可使用条形或矩形传感器获取图像，
这种配置将在后续两节中加以讨论。
2.3.2 使用条带传感器获取图像
比单个传感器更常用的几何结构是由内嵌传感器形式组成的传感器带，如图2.12(b)所示。该传
感器带在一个方向上提供成像单元。垂直于传感器带的运动在另一方向上成像，如图2.14(a)所示。
这是大多数平板扫描仪中使用的排列方式。感知设备可能内嵌有4000个或更多的传感器。内嵌传感
器常用于航空成像应用中，在这种应用中，成像系统安装在一架飞行器上，飞行器以恒定的高度和速
度飞过被成像的地区。可响应各种电磁波谱波段的一维传感器带按垂直于飞行方向来安装。成像传感
器带一次给出一幅图像的一行，传感器带的运动完成二维图像的另一个维度。透镜和其他聚焦方法用
于把扫描区域投影到传感器上。
以圆环形方式安装的传感器带用于医学和工业成像，以得到三维物体的剖面(“切片”)图像，
如图2.14(b)所示。一个旋转的X射线源提供照射，射线源对面的传感器则收集穿过物体的X射线能
量(很明显，这些传感器必须对X射线敏感)。这就是1.2节和1.3.2节中指出的医学和工业计算机轴
向断层(CAT)成像的基础。注意，传感器的输出必须由重建算法处理，重建算法的目的是把感知数据 儿一
28 数字图像处理(第三版)
转换为有意义的剖面图像(见5.11节)。换句话说，图像不可能单靠传感器的运动直接得到；它们需要
进一步的处理。由图像堆叠组成的三维数字物体是由物体与传感器环在相垂直方向的运动产生的。基
于CAT原理的其他成像模式包括核磁共振成像(MRD)和正电子发射断层(PET)成像。照射源、传感
器和图像的类型是不同的，但概念上它们与图2.14(b)中所示的基本成像方法非常相似。
a b 每线性运动一个增量。
输出图像的一行
成像区域
线性运动 图像重建 三维物体的剖面图像
传感器条带
三维物体
X射线源
传感器环
图2.14 (a)使用一个线性传感器带获取图像；(b)使用一个环形传感器带获取图像
2.3.3 使用传感器阵列获取图像
图2.12(c)显示了以二维阵列形式排列的单独的传感器。大量的电磁波和一些超声波传感装置常
以阵列形式排列。这也是我们在数字摄像机中所看到的主要排列方式。这些摄像机的典型传感器是
CCD阵列，这种阵列可制造为具有很宽范围的传感特性，并能封装为具有4000×4000个单元或更多
单元的稳定阵列。CCD 传感器广泛用于数字摄像机和其他光敏设备中。每个传感器的响应正比于投
射到传感器表面的光能总量，这一特性被用于天文学和其他要求低噪声图像的应用中。通过让传感器
累积输入光信号超过几分钟甚至几小时的方法，可达到减少噪声的目的。因为图2.12(c)所示的传感
器阵列是二维的，故其主要优点是通过将能量聚焦到阵列表面，以得到一幅完整的图像。很明显，像
前面两节中讨论的传感器排列的运动是不需要的。
这样的传感器阵列所用的主要方法示于图2.15。该图显示了来自照射源的能量是场景元素的反射
(如本节开始提到的那样，该能量也可以通过场景元素透射)。图2.15(c)所示成像系统执行的第一个功
能是收集入射能量，并将它聚焦到一个图像平面上。如果照射的是光. 在某些情况下，我们直接对源成 则成像系统的前端是一个光学透镜，该透镜把观察的场景投影到透镜的 像，就像得到太阳的图像一样
聚焦平面上，如图2.15(d)所示。与焦平面重合的传感器阵列产生与每个
传感器接收到的光的总量成正比的输出。数字或模拟电路扫描这些输出，并把它们转换成模拟信号，然
后由成像系统的其他部分数字化，输出是一幅数字图像，如图2.15(e)的图解所示。把一幅图像转换为数
字形式是2.4节的主题。
月;。
2.3.4 简单的图像形成模型
正像在1.1节中介绍的那样，我们用形如f(x,y)的二维函数来表
示图像。在空间坐标(x,y)处，f的值或幅度是一个正的标量，其物理
意义由图像源决定。当一幅图像由物理过程产生时，其亮度值正比于
物理源(如电磁波)所辐射的能量。因此，f(x,y)一定是非零的和有
限的，即
0<f(x,y)< (2.3-1)
在处理过程中或是作为解译的结
果，图像灰度可以为负值。例如。
在雷达成像中，移向雷达系统的物
体通常解释为速度为负，而远离雷
达系统的物体总是解释为速度为
正。这样。一幅速度图像就可编码
为既有正值又有负值。在存储和显
示图像时。我们通常会标定灰度。
以便最小的负值变为0(灰度标定将
在263节介绍)。
第2章 数字图像基础 29
6cde 照射(能量)源
输出(数字化后的)图像
成像系统
场景元素 (内部)图像平面
图2.15 数字图像获取过程的一个例子：(a)能量(“照射”)源；(b)场景元
素；(c)成像系统；(d)场景到图像平面的投影；(e)数字化后的图像
函数f(x,y)可由两个分量来表征：(1)入射到被观察场景的光源照射总量；(2)场景中物体所反
射的光照总量。这两个分量分别称为入射分量和反射分量，且分别表示为i(x,y)和r(x,y)。两个函数
作为一个乘积合并形成f(x,y),即
(2.3-2) f(x,y)=i(x,y)r(x,y)
其中，
0<i(x,y)<0 (2.3-3)
和
0<r(x,y)<1 (2.3-4)
式(2.3-4)指出反射分量限制在0(全吸收)和1(全反射)之间。i(x,y)的性质取决于照射源，而r(x,y)
的性质则取决于成像物体的特性。注意，这种表示方式还可用于照射光通过一个媒体形成图像的情况，
如胸透X射线照片。在这种情况下，我们应该用透射系数代替反射函数，但其限制应该与式(2.3-4)
相同，且形成的图像函数会建模为式(2.3-2)中的乘积。
例2.1 照射和反射的一些典型值。
式(2.3-3)和式(2.3-4)中给出的值是理论界限。对于可见光，下面的平均数值用数字说明了i(x,y)的
一些典型范围。在晴朗的白天，太阳在地面上可能会产生超过90000 Im/m2的照度。在有云的白天，这个
数值下降到10000 Im/m2。在晴朗的夜晚，满月情况下的照度大约为0.1 Im/m2。商用办公室的典型照度约
为1000 Im/m2。类似地，下面是r(x,y)的一些典型值：黑天鹅绒为0.01,不锈钢为0.65,白色墙为0.80,
镀银金属为0.90,雪为0.93。
令单色图像在任何坐标(x?,y?)处的强度(灰度)表示为
l=f(x?,y?) (2.3-5)
由式(2.3-2)到式(2.3-4)可知的取值范围为
L≤l≤Lmx (2.3-6)
理论上，仅要求L为正，而要求Lm为有限值。实际上，Lmm=imin'm和Lmx=imx'n。参照前
面提到的办公室的平均照度和反射值范围，我们希望Li=10和Lm=1000作为没有附加照明的室
内值的典型限制。
区间[Lmm,Lms1称为灰度级(或强度级)。实际情况下常常令该区间为[0,L-1],其中(=0为黑
色，(=L-1在灰度级中为白色。所有中间值是从黑色到白色之间变化的灰度色调。 77
巧托
30 数字图像处理(第三版)
2.4 图像取样和量化
由前一节的讨论，我们看到有多种获取图像的方法，但在所有这些方法中我们的目的是相同的，
就是从感知的数据生成数字图像。多数传感器的输出是连续的电压波 本节中关于取样的讨论较为直
形，这些波形的幅度和空间特性都与感知的物理现象有关。为了产生 观。第4章将深入探讨该主题
一幅数字图像，我们需要把连续的感知数据转换为数字形式。这种转
换包括两种处理：取样和量化。
2.4.1 取样和量化的基本概念
图2.16说明了取样和量化的基本概念。图2.16(a)显示了一幅连续图像f,我们想把它转换为数字
形式。一幅图像的x和y坐标及幅度可能都是连续的。为将它转换为数字形式，必须在坐标上和幅度
上都进行取样操作。对坐标值进行数字化称为取样，对幅值数字化称为量化。
A B d
A B
A B A B
量化
取样
图2.16 生成一幅数字图像：(a)连续图像；(b)连续图像中从A到B的一条扫
描线，用于说明取样和量化的概念；(c)取样和量化；(d)数字扫描线
图2.16(b)中的一维函数是图2.16(a)中沿线段AB的连续图像幅度值(灰度级)的曲线。随机变化
是由图像噪声引起的。为了对该函数取样，我们沿线段AB等间隔地对该函数取样，如图2.16(c)所示。
每个样本的空间位置由图形底部的垂直刻度指出。样本用放在函数曲线上的白色小方块表示。这样
的一组离散位置就给出了取样函数。然而，样本值仍(垂直)跨越了灰度值的连续范围。为了形成数
字函数，灰度值也必须转换(量化)为离散量。图2.16(c)的右侧显示了已分为8个离散区间的灰度标
尺，范围从黑到白。垂直刻度标记指出了赋予8个灰度的每一个特定值。通过对每一样本赋予8个
离散灰度级中的一个来量化连续灰度级。赋值取决于该样本与一个垂直刻度标记的垂直接近程度。
取样和量化操作生成的数字样本如图2.16(d)所示。从该图像的顶部开始逐行执行这一过程，则会产
生一幅二维数字图像。图2.16意味着除了所用的离散级数外，量化所达到的精度强烈地依赖于取样
信号的噪声。
按刚刚讨论的方式取样，假设我们有一幅在两个坐标方向上和幅度上都连续的图像。实践中，
取样方法由用于生成该图像的传感器配置决定。如图2.13所示，当一幅图像由单个传感单元与机械运
第2章 数字图像基础 31
动相结合生成时，传感器的输出可用前面讨论的方式量化。然而，空间取样是通过选择各个机械增量
的数量并在取样处激活传感器来收集数据完成的。机械运动可以非常精确地实现，因此从原理上讲，
使用这种方法对一幅图像取样可以到达的精细程度并没有限制。实践中，取样精度的限制由其他因素
决定，譬如系统的光学元件的质量。
当我们使用带状传感器来获取图像时，带中传感器的数量决定了图像中一个方向上的限制。另
一个方向上的机械运动可控制得更精确一些，但试图在一个方向上实现超过另一个方向上被传感器数
量限制的取样密度是没有意义的。对传感器输出的量化就完成了产生数字图像的过程。
当传感阵列用于图像获取时，没有运动且
阵列中传感器的数量决定了两个方向上的取样
限制。传感器输出的量化与前述相同。图2.17说
明了这个概念。图2.17(a)显示了投影到一个阵
列传感器平面上的连续图像。图2.17(b)显示了
取样和量化后的图像。很明显，数字图像的质
量在很大程度上取决于取样和量化中所用的样
本数和灰度级。然而，正如2.4.3节中表明的那
样，在选择这些参数时，图像内容是一个重要
的考虑因素。
a b
图2.17(a)已投影到一个传感器阵列上的连续
图像；(b)图像取样和量化后的结果
2.4.2 数字图像表示
令f(s,1)表示一幅具有两个连续变量s和t的连续图像函数。如前一节解释的那样，通过取样和
量化，我们可把该函数转换为数字图像。假如我们把该连续图像取样为一个二维阵列f(x,y),该阵
列包含有M行和N列，其中(x,y)是离散坐标。为表达清楚和方便起见，我们对这些离散坐标使用
整数值：x=0,1,2,…,M-1和y=0.1,2,…,N-1。这样，数字图像在原点的值就是f(0,0),第一
行中下一个坐标处的值是f(0,1)。这里，符号(0,1)表示第一行的第二个样本，它并不意味着是对图
像取样时的物理坐标值。通常，图像在任何坐标(x,y)处的值记为f(x,y),其中x和y都是整数。由
一幅图像的坐标张成的实平面部分称为空间域，x和y称为空间变量或空间坐标。
如图2.18所示，有三种基本方法表示f(x,y)。图2.18(a)是一幅函数图，用两个坐标轴决定空间位
置，第三个坐标是以两个空间变量x和y为函数的f(灰度)值。虽然我们可以在这个例子中用该图来
推断图像的结构，但是，通常复杂的图像细节太多，以至于很难由这样的图去解译。在处理的元素是
以(x,y,z)三坐标的形式表达的灰度集时，这种表示是很有用的，其中x和y是空间坐标，z是f在坐
标(x,y)处的值。在2.6.4节中，我们将探讨这种表示。
图2.18(b)是更一般的表示。它显示了f(x,y)出现在监视器或照片上的情况。这里，每个点的灰
度与该点处的f值成正比。该图中仅有三个等间隔的灰度值。如果灰度被归一化到区间[0,1]内，那么
图像中每个点的灰度都有0,0.5或1这样的值。监视器或打印机简单地把这三个值分别变换为黑色、
灰色或白色，如图2.18(b)所示。第三种表示是将f(x,y)的数值简单地显示为一个阵列(矩阵)。在这
个例子中，f的大小为600×600个元素，或360 000个数字。很清楚，打印整个矩阵是很麻烦的，且
传达的信息也不多。然而，在开发算法时，当图像的一部分被打印并作为数值进行分析时，这种表示
相当有用。图2.18(c)以图形方式传达了这一概念。
由前面几节的讨论，我们可得出一个结论，即图2.18(b)和图2.18(c)中的表示是最有用的。图像
显示允许我们快速地观察结果。数值阵列用于处理和算法开发。以公式形式，我们可将一个M×N
的数值阵列表示为 77
～7
32 数字图像处理(第三版)
f(0.1)
f(.D)
… …
f(M-1.1)
(2.4-1)
该式的两边以等效的方式定量地表达了一幅数字图像。右边是一个实数矩阵，该矩阵中的每个元素称
为图像单元、图像元素或像素。图像和像素这两个术语将在全书中表示数字图像及其元素。
a b e 原点
f(x.y) 原点
00000000000000
000000 0.0000.0
00000 00000
00.00 0000 5
000 000 00.0 00.0
曲垂重 111
000 000
000 000
0.000 0000
0.0000 00000
x
0.00000 000000
000.0000…0000000
图2.18 (a)画为表面图形的图像；(b)显示为可视灰度阵列的图像；(e)显示
为一个二维数值阵列的图像(0,0.5和1分别表示黑色、灰色和白色)
在某些讨论中，使用传统的矩阵表示法来表示数字图像及其像素更为方便： L2 (2.4-2)
显然，ay=f(x=i,y=j)=f(i,),因此式(2.4-1)和式(2.4-2)是相同的矩阵。我们甚至可以将一幅
图像表示一个向量v。例如，尺寸为MN×1的列向量由v的第一M个元素作为A的第一列来构成，
下一M个元素作为第二列，等等。我们也可以使用A的行代替列来形成这样的一个向量。只要一致，
哪种表示都是有效的。
简要地回顾图2.18,注意到，数字图像的原点位于左上角，其中正x轴向下延伸，正y轴向右延
伸。这种方便的表示基于这样的事实：许多图像显示(譬如电视显示器)扫描都是从左上角开始的，然
后一次向下移动一行。更重要的事实是矩阵的第一个元素按惯例应在阵列的左上角，因此，将
f(x,y)的原点选择在左上角于数学上是讲得通的。记住，这种表示是您所熟悉的标准的右手笛卡儿
坐标系统。我们仅说明了指向下方和指向右方的坐标轴来代替向右和向上的坐标轴。
有时，以更正式的数学术语表达取样和量化可能会很有用。令Z和R分别表示整数集和实数集。
取样处理可看成是把xy平面分为一个网格的过程，网格中每个单元的中心的坐标是笛卡儿积Z2中的
一对元素，Z2是所有有序元素对(z,z)的集合，z和z,是Z中的整数。因此，如果(x,y)是z2中的
整数，且f是把灰度值(即实数集R中的一个实数)赋给每个特定坐标对(x,y)的一个函数，则f(x,y)
①回忆可知，右手坐标系统是这样一种系统：当正x轴方向向右时，在大拇指竖直向上时，正y轴的方向为垂直于x轴的中指方
向。如图2.18(a)所示，事实上这是我们的图像坐标系统情形。
第2章 数字图像基础 33
就是一幅数字图像。显然，这种赋值过程就是前面描述的量化处理。如果灰度级也是整数(此时及后
续章节中通常为这种情况),则用Z代替R,然后，数字图像变成一
通常，将L个灰度值缩放至区间0.11 个二维函数，且它的坐标和幅值都是整数。 对于计算或算法开发目的是有用的。
这时，它们不再是整数。但多数情形
下.这些值都会被缩放到用于图像存
储和显示的整数区间[0.L-1]。
数字化过程要求针对M值、N值和离散灰度级数L做出判定。
对于M和N.除了必须取正整数外没有其他限制。然而，出于存储和
量化硬件的考虑，灰度级数典型地取为2的整数次幂，即
L=2* (2.4-3)
我们假设离散灰度级是等间隔的，且它们是区间[0,L-1]
内的整数。有时，由灰度跨越的值域非正式地称为动
态范围。这一术语在不同的场合有不同的用法。这里，
我们将图像系统的动态范围定义为系统中最大可度量灰
度与最小可检测灰度之比。作为一条规则，上限取决于
饱和度，下限取决于噪声(见图2.19)。基本上，动态范
围由系统能表示的最低和最高灰度级来确定，因此，也
是图像具有的动态范围。与这一概念紧密联系的是图像
对比度，我们定义一幅图像中最高和最低灰度级间的灰
度差为对比度。当一幅图像中像素可感知的数值有高的
动态范围时，那么我们认为该图像具有高的对比度。相
反，具有低动态范围的图像就很呆滞，看上去像冲淡了
饱和度
噪声
灰度。第3章将更加详细地讨论这些概念。
存储数字图像所需的比特数b为
b=M×N×k (2.4-4)
图2.19 显示了饱和度和噪声的一幅图像。饱和度
是指超过这个值的灰度级将被剪切掉这
样的一个最高值(注意整个饱和区域
具有恒定的高灰度级)。这种情况下的噪
声表现为粒状纹理模式。噪声，特别是
较暗图像区域(譬如玫瑰的茎)中的噪
声，掩盖了可检测的最低真实灰度级
当M=N时，该式变为
b=N2k (2.4-5)
表2.1中显示了N和k取不同值时需要用来存储方形图像的比特数。括号中的数字表示对应于每个k
值的灰度级数。当一幅图像有2个灰度级时，实际上通常称该图像为一幅“k 比特图像”。例如，有
256个可能的离散灰度值的图像称为8比特图像。注意，大小为1024×1024或更高的8比特图像的存
储需求是很重要的。
表2.1 N和k取不同值时存储所需的比特数。L是灰度级数
N/k 1(L=2) 2(L=4) 3(L=8) 4(L=16) 5(L=32) 6(L=64) 7(L=128) 8(L=256)
32 1024 2.048 3072 4096 5120 6144 7168 8192
64 4096 8192 12288 16384 20480 24576 28672 32768
128 16384 32768 49152 65536 81920 98304 114688 131072
256 65536 131072 196608 262144 327680 393216 458752 524288
512 262144 524288 786432 1048576 1310720 1572864 1835008 2097152
1024 1048576 2097152 3145728 4194304 5242880 6291456 73400328388608
2048 41943048388 608 112582912 16 777216 20971 520 25165824 229369 128 33554 432
4096 16777216 33554 432 50.331 648 67,108,864 83886 080 100 663296 117440512 134217728
8192 67108864 134217 728 201326592 268,435,456 335544 320 402 653 184 469762048 536870912 ～8
81-8
34 数字图像处理(第三版)
2.4.3 空间和灰度分辨率
直观上看，空间分辨率是图像中可辨别的最小细节的度量。在数量上，空间分辨率可以有很多
方法来说明，其中每单位距离线对数和每单位距离点数(像素数)是最通用的度量。假设我们用交替的
黑色和白色垂直线来构造一幅图形，其中线宽为W个单位(W可以小于1)。线对的宽度就是2W,每
单位距离有1/2W个线对。例如，如果一条线的宽度是0.1 mm,每单位距离(mm)就有5个线对。广
泛使用的图像分辨率的定义是每单位距离可分辨的最大线对数量(譬如每毫米100个线对)。每单位距
离点数是印刷和出版业中常用的图像分辨率的度量。在美国，这一度量通常使用每英寸点数(dpi)来
表示，例如，为给您一个质量概念，报纸用75 dpi的分辨率来印刷，杂志是133 dpi.光鲜的小册子
是175 dpi,您正在看的书页是以2044 dpi印刷的。
前一段中的关键点是空间分辨率的度量必须针对空间单位来规定才有意义。图像大小本身并不
会告诉我们全部内容。如果没有规定图像包含的空间维数，那么我们说一幅图像的分辨率为
1024×1024像素是没有意义的。尺寸本身只是在图像容量间做比较时才有帮助。例如，带有20兆
像素成像芯片的CCD 数字摄像机与8兆像素的摄像机相比有较高的分辨细节的能力，假定两部摄像
机都配备了可比较的镜头，并在相同的距离拍摄可比较的图像。
类似地，灰度分辨率是指在灰度级中可分辨的最小变化。我们有值得考虑的关于产生数字图像
的样本数的判断，但是对于灰度级来说这并不真实。基于硬件考虑，正如前一节中提到的那样，灰度
级数通常是2的整数次幂。最通用的数是8比特，在某些特殊的图像增强应用中，用16比特也是必
要的。灰度量化用32比特是很罕见的。有时，我们会发现使用10比特或12比特来数字化图像灰度
级的系统，但这些系统都是特例而不是常规系统。不像空间分辨率必须以每单位距离为基础才有意义，
而灰度分辨率指的则是用于量化灰度的比特数。例如，通常说一幅被量化为256级的图像有8比特的
灰度分辨率。因为灰度中可分辨的真实变化不仅受噪声和饱和度值的影响，也受人类感知能力的影响
(见2.1节),所以说一幅图像有8比特的灰度分辨率并不比以灰度幅值为1/256的固定增量量化为8
比特的系统能力的规定有更多的内容。
下面的两个例子分别说明了图像尺寸和灰度分辨率对可分辨细节比较的效果。在本节稍后，我
们将讨论决定感知图像质量中的两个参数是如何相互影响的。
例2.2 降低图像空间分辨率的效果说明。
图2.20显示了降低一幅图像的空间分辨率的效果。图2.20(a)到(d)显示了分辨率分别为1250 dpi,
300 dpi,150 dpi和72 dpi的图像。很自然，低分辨率的图像与原图像相比要小。例如，原图像的大小为
3692×2812像素，但72 dpi图像是一个大小为213×162的阵列。为便于比较，所有的小图像都放大到了
原图像的大小(采用2.4.4节中讨论的放大方法)。这对较小图像的归靠来说稍微有些对等之意，因此，我
们可就可见细节做可比性的说明。
图2.20(a)和图2.20(b)之间有一些较小的视觉差别，最明显的差别是大的黑针稍微有点失真。然而，
图2.20(b)的大部分还是可以接受的。事实上，300 dpi是书籍印刷所用的最小空间分辨率。因此，这里我
们不能期望看到很大的不同。图2.20(c)显示了可见的退化(例如，计时器的圆形边缘和右侧指向60处的
小针)。图2.20(d)显示了图像中多数可见特征的退化。如4.5.4节中讨论的那样，当以这样低的分辨率印
刷时，印刷和出版业会使用一些“技巧”(例如，像素尺寸的局部变化)来产生比图2.20(d)更好的结果。
此外，如2.4.4节所示，选择所用的内插方法也可以改进图2.20的结果。
例2.3 改变数字图像中灰度级数的典型效果。
在这个例子中，我们保持样本数恒定，而将灰度级数以2的整数次幂从256减少到2。图2.21(a)是
第2章 数字图像基础 35
一幅大小为452×374的CT投影图像，它以k=8(256个灰度级)显示。这样的图像是通过将X射线源固
定在一个位置，然后在任何期望的方向生成二维图像来得到的。投影图像用于指导设置CT扫描仪的参数，
包括倾斜角、切片数和范围。
图2.21(b)到图2.21(h)是在保持图像大小为452×374像素不变的情况下，比特数从k=7减小到k=1
时得到的图像。256级、128级和64级灰度图像对于所有实用目的在视觉上的效果是相同的。然而，图2.21(d)
所示的32灰度级图像中，在恒定或接近恒度灰度区域(尤其在头盖骨处)内有一组不易察觉的细小山脊状
结构。这种效果是由数字图像的平滑区域中的灰度级数不足引起的，通常称为伪轮廓，之所以这样称呼，
是因为这些山脊状结构类似于地图中的地形轮廓。伪轮廓通常在以16或更少级数的均匀设置的灰度级显
示的图像中十分明显，如图2.21(e)到图2.21(h)所示的图像。
为方便起见，作为一个粗略的经验规则，假设数值为2的整数次幂，一般来说，尺寸为256×256像素、64
灰度级、印刷在大小为5cm×5cm的版式上的图像是具有最低空间和灰度分辨率的图像，一般认为没有令
人讨厌的取样棋盘格和伪轮廓。
a bc d
图2.20 降低空间分辨率的典型效果。图像分别以(a)1250 dpi,(b)300 dpi,(e)150dpi.
(d)72dpi来显示。为清楚起见，图像添加了黑色的细边框，它们不是数据的一部分
a b
cd h
图2.21(a)大小为452×374的256灰度级图像；(b)~(d)保持图像大小不变的同时以灰
度级128,64和32显示的图像；(e)~(h)以16,8,4和2灰度级显示的图像(原图像
由Vanderbilt大学医学中心辐射学与放射学系的David R.Pickens博士提供) 恩～8
分;8
36 数字图像处理(第三版)
例2.2和例2.3中的结果说明了分别改变N和k时对图像质量产生的影响。然而，这些结果也仅
仅部分地回答了改变N和k 如何影响图像的问题，因为我们还未考虑这两个参数之间可能存在的任
何关系。Huang[1965]早期的研究试图通过实验来量化同时改变N和k时对图像质量所产生的影响。
实验由一组主观测试组成，采用了类似于图2.22 中所示的图像。妇女脸庞图像是包含较少细节的一
幅有代表性的图像，摄像师图像包含了中等程度的细节，人群图像相比之下包含有大量的细节。
a b c
图2.22 (a)具有少量细节的图像；(b)具有中等程度细节的图像
(图像由麻省理工学院提供);(c)具有大量细节的图像
通过改变N和k,生成了一组这三种类型的图像，
然后要求观察者主观地按图像的质量对图像排序。最终
结果以Nk平面中的等偏爱曲线形式汇总(图2.23中显示 5
了对应于图2.22中图像的平均等偏爱曲线)。Nk 平面中
的每一点表示一幅图像，该图像的N值和k值等于该
点的坐标。位于等偏爱曲线上的点对应于有相等的主
观判定质量的图像。实验发现等偏爱曲线倾向于向右
上方移动，但这三类图像的等偏爱曲线形状与图2.23中
所示的那些曲线类似。这并不意外，因为曲线向右上方
移动仅意味着更大的N值和k值，而这又意味着更好的
图像质量。
k
4
当前讨论内容的关键是当图像中的细节增加时，等
偏爱曲线会变得更加垂直。这一结果表明，对于有大量
细节的图像，可能只需要较少的灰度级。例如，图2.23
32
妇女脸庞图像
摄影师图像
人群图像
64 128 256 N
图2.23 图2.22中三类图像的典型等偏爱曲线
中对应于人群图像的等偏爱曲线接近垂直。这指出当N值固定时，这类图像的感觉质量与所用的灰
度级数(对于图2.23所示的灰度级范围)是近似独立的。更有趣的是，还要注意，另两类图像在样本数
增加的某些间隔内感觉质量保持相同，但灰度级数实际上降低了。对于这一结果，最可能的原因是
k的减小倾向于对比度的明显增加，人们通常感受到图像质量改善了的视觉效果。
2.4.4 图像内插
内插是在诸如放大、收缩、旋转和几何校正等任务中广泛应用的基本工具。这一节我们的主要目
标是介绍内插并用它调整图像的大小(收缩和放大),这是基本的图像重取样方法。在诸如旋转和几何
校正的应用中，内插的用法将在2.6.5节讨论。在第4章，我们还将回到这一主题，以详细地讨论图像
重取样。
从根本上看，内插是用已知数据来估计未知位置的数值的处理。我们用一个简单的例子开始讨论
该话题。假设一幅大小为500×500像素的图像要放大1.5倍到750×750像素。一种简单的放大方法
是创建一个假想的750×750网格，它与原始图像有相同的间隔，然后将其收缩，使它准确地与原图
第2章 数字图像基础 37
像匹配。显然，收缩后的750×750网格的像素间隔要小于原图像的像素间隔。为了对覆盖的每一个
点赋以灰度值，我们在原图像中寻找最接近的像素，并把该像素的灰度赋给750×750网格中的新像
素。当我们完成对网格中覆盖的所有点的灰度赋值后，就把图像扩展到原来规定的大小，得到放大后
的图像。
刚刚讨论的方法称为最近邻内插法，因为这种方法把原图像中最近邻的灰度赋给了每个新位置
(2.5节将正式讨论邻近像素)。这种方法简单，但是，本节稍后将显示该方法有产生不希望的人为缺
陷的倾向，如某些直边缘的严重失真。由于这一原因，实际上该方法并不常用。更实用的方法是双线
性内插，在该方法中，我们用4个最近邻去估计给定位置的灰度。令(x,y)为我们想要赋以灰度值的
位置(把它想象为前面描述的网格点)的坐标，并令v(x,y)表示灰度值。对于双线性内插来说，赋值
是由下面的公式得到的： 与该方法名称相反的是。双线性
内插不是一种线性内插方法。因为 v(x,y)=ax+by+cxy+d (2.4-6)
其中包含有y项
其中，4个系数可由4个用(x,y)点最近邻点写出的未知方程确定。
正如您马上将看到的那样，双线性内插给出了比最近邻内插好得多的结果，但随之而来的是计算量
的增加。
下一种复杂度较高的方法是双三次内插，它包括16个最近邻点。赋予点(x,y)的灰度值是使用
下式得到的：
x)-22 (2.4-7)
其中，16个系数可由16个用(x,y)点最近邻点写出的未知方程确定。观察式(2.4-7),如果求和的
上下限分别为0和1,则其简化为式(2.4-6)的形式。通常，双三次内插在保持细节方面比双线性
内插相对要好。双三次内插是商业图像编辑程序的标准内插方法，例如Adobe Photoshop和Corel
Photopaint。
例2.4 用于图像收缩和放大的内插方法的比较。
图2.24(a)是与2.20(d)相同的图像，它是由图2.20(a)中分辨率为1250 dpi的图像先将分辨率降低到
72 dpi(大小由原来的3692×2812收缩到213×162像素),然后将该缩小的图像再放大到原来的尺寸得到
的。图2.20(d)是采用最近邻内插法进行收缩与放大产生的。正如前面讨论的那样，图2.24(a)的结果比
较差。图2.24(b)和图2.24(c)是采用相同的过程，但分别采用双线性内插和双三次内插收缩和放大得到
的。使用双线性内插得到的结果较最近邻内插有重大改进。双三次内插的结果较双线性内插的结果稍
微清晰一些。图2.24(d)与图2.20(c)相同，它们都是由最近邻内插方法通过收缩与放大得到的。我们
前面讨论的结论是分辨率降低到150 dpi时，图像开始显现退化。图2.24(e)与图2.24(f分别显示了使用
双线性内插和双三次内插收缩和放大图像的结果。尽管分辨率从1250 dpi降低到了150 dpi,但与原图
像相比，这两种内插方法再次显示了其强大的性能。与以前一样，双三次内插得到了稍微清晰一些的
结果。
在内插中，有可能采用更多的邻点和更复杂的技术，如采用样条和小波，在某种情况下，可以
得到比刚刚讨论的方法更好的结果。对于三维图形(Watt[1993],Shirley[2002])和医学图像处理
(Lehmann et al.[1999])保留精细细节是一个特别重要的考虑，对于一般目的的数字图像处理.较
少考虑额外的计算负担是合理的，所以双线性内插和双三次内插是人们选择的典型方法。 遥～别
名～留
38 数字图像处理(第三版)
dei
图2.24(a)降低到72dpi.并使用双线性内插方法将其放大到原大小(3692×2812像素)的图像。该
图像与图2.20(d)相同；(b)使用双线性内插收缩和放大的图像；(c)与图像(b)相同但使用
双三次内插的图像；(d)~(4相同的图像序列，但它们是收缩到150dpi而不是收缩到72dpi
的图像[图2.24(d)与图2.20(e)相同]。将图2.24(e)和(1与原图2.20(a)比较，特别是后者
2.5 像素间的一些基本关系
在这一节，我们考虑数字图像中像素间的几个重要关系。正如前面提及的那样，图像由f(x,y)
表示。当在本节中引用某个特殊的像素时，我们通常会使用小写字母，如p和q。
2.5.1 相邻像素
位于坐标(x,y)处的像素p有4个水平和垂直的相邻像素，其坐标由下式给出：
(x+1, y),(x-1,y),(x,y+1),(x,y-1)
这组像素称为p的4邻域，用N?(p)表示。每个像素距(x,y)一个单位距离，如果(x,y)位于图像的
边界上，则p的某些相邻像素位于数字图像的外部。我们将在第3章处理这个问题。
p的4个对角相邻像素的坐标如下：
(x+1,y+1),(x+1,y-1).(x-1,y+D),(x-1,y-1)
并用No(p)表示。这些点与4个邻点一起称为p的8邻域，用N?(p)表示。与前面一样，如果(x,y)
位于图像的边界上，则No(p)和N?(p)中的某些邻点会落入图像的外边。
2.5.2 邻接性、连通性、区域和边界
令V是用于定义邻接性的灰度值集合。在二值图像中，如果把具有1值的像素归诸于邻接像素，
则V=(1}。在灰度图像中，概念是一样的，但是集合V一般包含有更多的元素。例如，具有可能的灰
度值范围为0到255的邻接像素中，集合V可能是这256个值的任何一个子集。考虑三种类型的邻接：
第2章 数字图像基础 39
(a)4邻接。如果q在集合N?(p)中，则具有V中数值的两个像
素p和q是4邻接的。
(b)8邻接。如果q在集合N?(p)中，则具有V中数值的两个像
素p和q是8邻接的。
(c)m邻接(混合邻接)。如果(i)q在N?(p)中，或(ii)q在No(p)
中，且集合N?(p)∩N?(q)中没有来自V中数值的像素，则
具有V中数值的两个像素p和q是m邻接的。
混合邻接是8邻接的改进。混合邻接的引入是为了消除采用8邻接时产生的二义性。例如，考
虑图2.25(a)中对于V={1}的像素排列。位于图2.25(b)上部的3个像素显示了多重(二义性)8邻接，
如虚线所示。这种二义性可以通过m邻接消除，如图2.25(c)所示。
从具有坐标(x,y)的像素p到具有坐标
(s,t)的像素q的通路(或曲线)是特定的像素
序列，其坐标为
我们分别使用符号∩和U来表示
集。详细讨论见2.6.4节。
集合的交与并。假设有集合A和B.
回忆可知它们的交集是既在集合A
中又在集合B中的成员的元素集。
这两个集合的并集是集合A的成员。
集合B的成员或两者的成员的元素
(x,y?(x?,y?),…,(x?,yn)
其中(x?,y?(x,y),(x,y)=(s,t),且像素
(x,y)和(x?,y-1)对于1≤i≤n是邻接
的。在这种情况下，n是通路的长度。如果
(x?,y?)=(x,ya),则通路是闭合通路。可
以依据特定的邻接类型定义4邻接、8邻接
或m 邻接。例如，如图2.25(b)所示，右上
点和右下点之间的通路是8通路，而图2.25(c)
中的通路是m通路。
1①1
de
图2.25 (a)像素的排列；(b)8邻接像素(邻接性由虚线所
示，注意二义性);(e)m邻接；(d)采用8邻接时，
两个值为1的区域是邻接的；(e)如果在区域和
背景间采用8邻接，则加圆圈的点是仅赋1值的
像素的边界点的一部分；01值区域的内部边界不
形成闭合通路，但其外部边界可以形成闭合通路
令S是图像中的一个像素子集。如果S
的全部像素之间存在一个通路，则可以说两个像素p和q在S中是连通的。对于S中的任何像素p.
S中连通到该像素的像素集称为S的连通分量。如果S仅有一个连通分量，则集合S称为连通集。
令R是图像中的一个像素子集。如果R是连通集，则称R为一个区域。两个区域，如果它们联
合形成一个连通集，则区域R,和R,称为邻接区域。不邻接的区域称为不连接区域。在谈到区域时，
我们考虑的是4邻接和8邻接。为使我们的定义有意义，必须指定邻接的类型。例如，如果仅使用8
邻接时，则图2.25(d)中的两个区域(由1组成的)是邻接的(根据前一段的定义，两个区域之间不存在
4通路，它们的并集不是连通集)。
假设一幅图像包含有K个不连接的区域，即R,,k=1,2,…,K,且它们都不接触图像的边界。
令R,代表所有K个区域的并集，并且令(R)代表其补集(回忆可知，集合S的补集是不在S中的点
的集合)。我们称R,中的所有点为图像的前景，而称(R)中的所有点为图像的背景。
区域R的边界(也称为边缘或轮廓)是这样的点的集合，这些点与R的补集中的点邻近。换一种方式说，
一个区域的边界是该区域中至少有一个背景邻点的像素集合。这里再强调一下，我们必须指定用于定义
邻接的连通性。例如，图2.25(e)中被圈出的点如果在区域及其背景间使用4连通，就不是1值区域边界
的成员。基于这一规则，为处理这种情况，一个区域及其背景中的点之间的邻接要根据8连通来定义。
①进行这种假设的目的在于避免处理特殊情形。这样做不会丧失一般性。因为如果一个或多个区域接触到图像的边界，我们可简
单地使用1像素宽的背景值边界来填充图像。 82
9：9
40 数字图像处理(第三版)
前述定义有时称为区域的内边界，以便与其外边界相区分，外边界对应于背景边界。在开发追
踪边界的算法时这一区别很重要。这种算法为了保证结果形成一个闭合通路，通常是沿外边界确立的。
例如，在图2.25f中，1值区域的内边界是该区域本身。这一边界并不满足先前给出的闭合通路的定
义。另一方面，区域的外边界确实形成了一个围绕该区域的闭合通路。
如果R恰巧是整幅图像(我们假设这幅图像是像素的方形集合),则边界由图像第一行、第一列
和最后一行、最后一列的像素集合来定义。这个附加定义是需要的，因为一幅图像超过边界范围之外
没有邻点。正常情况下，当我们提到一个区域时，指的是一幅图像的子集，并且区域边界中任何与图
像边缘吻合的像素都作为区域边界的一部分全部包含于其中。
边缘的概念在涉及区域和边界的讨论中常常遇到。然而，这些概念之间有一个关键区别。一个
有限区域的边界形成一条闭合通路，并且是“整体”概念。正如第 10章详细讨论的那样，边缘由具
有某些超过预先设定的阈值的导数值的像素形成。这样，边缘的概念就是基于在进行灰度级度量时不
连续点的“局部”概念。把边缘点连接成边缘线段是可能的，并且有时以与边界对应的方法连接线段，
但并不总是这样。边缘和边界吻合的一个例外是二值图像的情况。根据连通类型和所用的边缘算子(在
第10章中讨论),从二值区域提取边缘与区域边界是一样的，这很直观。在概念上，我们在第10章
才会接触到，把边缘考虑为灰度不连续和边界是闭合通路是有帮助的。
2.5.3 距离度量
对于坐标分别为(x,y).(s,t)和(v,w)的像素p.q和z,如果
(a)D(p.q)≥0[D(p.q)=0,当且仅当p=q]
(b) D(p,q)=D(q.p)且
(c)D(p,z)≤D(p,q)+D(q,z)。
则D是距离函数或度量。p和q间的欧几里得(欧氏)距离定义如下：
D.(p.9)=[x-s2+(y-)2] (2.5-1)
对于距离度量，距点(x,y)的距离小于或等于某个值r的像素是中心在(x,y)且半径为r的圆平面。
p和q间的距离D?(又称为城市街区距离)由下式定义：
D?(p.q)=|x-s|+|y-1 (2.5-2)
在这种情况下，距(x,y)的距离D?小于或等于某个值r的像素形成一个中心在(x,y)的菱形。例如，
距中心点(x,y)的距离D?小于或等于2的像素，形成固定距离的下列轮廓：
其中D?=1的像素是(x,y)的4邻域。
p和q间的Dg距离(又称为棋盘距离)由下式定义：
D?(p,q)=max(Ix-sl,ly-t) (2.5-3)
在这种情况下，距(x,y)的D&距离小于或等于某个值r的像素形成中心在(x,y)的方形。例如，距中
心点(x,y)的D?距离小于或等于2的像素形成下列固定距离的轮廓：
第2章 数字图像基础 41
2 2 2 2 2
2 1 1 1 2
2 1 0 1 2
2 1 1 1 2
2 2 2 2 2
其中Dg=1的像素是(x,y)的8邻域。
注意，p和q之间的D?距离和D?距离与任何通路无关，通路可能存在于各点之间，因为这些距
离仅与该点的坐标有关。然而，如果选择考虑m邻接，则两点间的Dm距离用点间的最短通路定义。
在这种情况下，两个像素间的距离将依赖于沿通路的像素值及其邻点值。例如，考虑如下排列的像素
并假设p.p?和p?的值为1,p?和p?的值为0或1:
P?P?
P?P?
P
假设我们考虑值为1的像素邻接[即V={1]]。如果p?和p?是0,则p和p间的最短m通路的长度(Dm
距离)是2。如果p是1,则p?和p将不再是m邻接的(见m邻接的定义),并且最短m通路的长度变
为3(通路通过点pP P?P?)。类似地评论，如果p?是1(且p?是0),在这种情况下，此时最短的m
通路距离也是3。最后，如果p?和p?都为1,则p和p?间的最短m通路的长度为4,在这种情况下，
通路通过点p P?P?Ps P?。
2.6 数字图像处理中所用数学工具的介绍
这一节有两个主要目的：(1)向您介绍我们在本书中所用的各种数学工具；(2)通过把它们用于
各种基本图像处理任务来帮助您开始建立如何使用这些工具的“感觉”。它们之中的一些在后续讨论
中将被使用多次。在后面的章节中，我们将根据需要来扩展这些工具的范围及应用。
2.6.1 阵列与矩阵操作
包含一幅或多幅图像的阵列操作是以逐像素为基础执行的。本章
前面我们曾提到，图像可以等价地被看成是矩阵。事实上，在很多情
况下，图像间的操作是用矩阵理论执行的(见2.6.6节)。基于这个原因，
阵列与矩阵操作间的区别必须搞清楚。例如，考虑下面的2×2图像：
在继续阅读前，建议读者从
本书网站上的 Tutorials 部分下载并
学习复习材料。复习材料包括关于
矩阵和向量、线性系统、集合论和
概率的简介性知识
和]
这两幅图像的阵列相乘是
]-[h]
另一方面，矩阵相乘由下式给出：
ba]-[ah+aharha+ah]
我们假设阵列操作贯穿全书，除非另做说明。例如，当我们谈到一幅图像的求幂时，意味着每个像素均
进行求幂操作；当我们谈到一幅图像除以另一幅图像时，意味着在相应的像素对之间进行相除，等等。 818
42 数字图像处理(第三版)
%-
2.6.2 线性操作与非线性操作
图像处理方法的最重要分类之一是它是线性的还是非线性的。考虑一般的算子H,该算子对于
给定的输入图像f(x,y),产生一幅输出图像g(x,y):
H[f(x,y)]=g(x,y) (2.6-1)
如果
H[a,f(x.y)+a,f,(x,y]=a,B[Lf(x,y]+a,H[f,(x,y]=ag,(x,y)+ayg,(x,y)(2.6-2)
则称H是一个线性算子，其中a,a,,f?(x,y)和f,(x,y)分别是任意常数和图像(大小相同)。式(2.6-2)
指出输出是线性操作，因为两个输入的和与分别对输入进行操作然后再求和得到的结果相同。另外，
输入乘以常数的线性操作的输出与乘以该常数的原始输入的操作的输出是相同的。第一个特性称为加
性，第二个特性称为同质性。
作为一个简单的例子，假设H是求和算子∑,即该算子的功能是对输入简单地求和。为检验其
线性，我们从式(2.6-2)的左侧开始，并且试图证明它与右侧相等：
∑[a,f(x,y)+a,f,(x,y]=∑a,f(x,y)+∑a;fj(x,y)
=a∑f(x,y)+a,∑f,(x,y)
=ag;(x,y)+a,g;(x,y)
其中第一步遵循求和是分布式的这样一个事实。因此，左边的展开等于式(2.6-2)的右边，从而我们
得出该求和算子是线性的这一结论。
另一方面，考虑最大值操作，其功能是在图像中寻找像素的最大值。针对这一目的，证明该操
作是非线性的最简方法是寻找一个测试式(2.6-2)时失败的例子。考虑下列两幅图像：
r-[23]和/?-[4]
并假设令a?=1和a?=-1。为了对线性进行测试，我们再次从式(2.6-2)的左侧开始：
mx{0[23]+-0[45}=mx[-23}=-2
下一步，做右边，我们得到
mx[23]}+(-0mx{[43]=3+-7=4
在这种情况下，式(2.6-2)的左边和右边并不相等，因此我们证明了通常求最大值的操作是非线性的。
正如您在后面三章中将要看到的那样，特别是在第4章和第5章中，线性操作特别重要，因为
它们是以大量的可用于图像处理的理论和实践结果为基础的。非线性系统很难被很好地理解，因此
其应用范围受到了更多的限制。然而，在后面的几章中，我们会碰到一些性能远优于线性操作的非
线性图像处理操作。
2.6.3 算术操作
图像间的算术操作是阵列操作，如2.6.1节中讨论的那样，其意思是算术操作在相应的像素对之
间执行。4种算术操作表示为
这些是阵列求和，而不是图像的
所有元素的求和。因此，单幅图像
的求和是该图像本身。
第2章 数字图像基础 43
s(x,y)=f(x,y)+g(x,y)
d(x,y)=f(x,y)-8(x,y)
p(x,y)=f(x,y)×g(x,y)
v(x,y)=f(x,y)+g(x,y)
(2.6-3)
它可理解为是在了和g中相应的像素对之间执行操作，其中x=0,1.2,…,M-1,y=0,1,
2,…,N-1。通常，M和N是图像的行和列。很清楚，s,d,p和v是大小为M×N的图像。注意，按
照刚才定义的方式，图像算术操作涉及相同大小的图像。下面的几个例子指出在数字图像处理中，算
术操作起着重要的作用。
例2.5 针对降噪的带噪图像相加(平均)。
令g(x,y)是无噪声图像f(x,y)被加性噪声η(x,y)污染后的图像，即
g(x,y)=f(x,y)+η(x,y) (2.6-4)
这里假设在每一对坐标(x,y)处，噪声是不相关的P,并且其均值为零。以下步骤的目的是通过一组带噪
图像{g(x,y)}的相加减少噪声。
如果噪声满足刚才声明的约束，那么可以证明(见习题2.20),如果图像g(x,y)是通过对K幅不同的
噪声图像进行平均形成的：
8(x,=卡28(x》 (2.6-5)
然后，遵循
E{g(x,y}=f(x,y) (2.6-6)
和
2=k元 (2.6-7)
式中E{g(x,y}是g的期望值，o2c,和2,分别是g和；在所有坐标(x,y)处的方差。在平均图像中
的任意一点处的标准差(方差的均方根)是
0=/km (2.6-8)
随着K的增大，式(2.6-7)和式(2.6-8)指出，在每个位置(x,y)处的像素值的变化(就像方差或标准差度量的
那样)将减小。因为E{g(x,y}}=f(x,y),这意味着在求平均过程中所使用的带噪图像的数量增加时，
g(x,y)将逼近f(x,y)。实际上，为了避免输出图像带来模糊和其他人为缺陷，图像g;(x,y)必须已配准
(对齐)。
图像平均的一种重要应用是在天文学领域，在该领域，由于在非常低
的照度下成像常常会导致传感器噪声，以至于单幅图像无法分析。图2.26(a)
显示了一幅8比特图像，其中加入了均值为0、标准差为64个灰度级的高
斯噪声模拟退化。这些典型的低照度条件下获取的图像，对所有实用目的
来说都是不可用的。图2.26(b)~①显示了分别对5,10.20,50和100幅图
①回忆可知，均值为m的随机变量z的方差定义为E(z-m2,其中E)是该参量的期望值。两个随机变量2和z,的协方差
定义为E(z-m,Kz,-m,。如果变量是不相关的，则它们的协方差为零
该例中显示的图像来自称为NGC
约1.4亿光年，位于南半球长蛇座方
3314的Pair 星系，由NASA的哈勃
向。最亮的几颗星在由星尘组成的
空间望远镜拍摄。NGC 3314离地球
前星系的中心处形成了风车形状。
习：器
818
44 数字图像处理(第三版)
像平均的结果。我们看到，图2.26(e),由K=50得到的结果已经相当清晰。图2.26(f)的图像是由100幅带
噪图像平均得到的结果，与图2.26(e)比较仅稍微有些改进。
相加是连续积分的离散形式。在天文观测中，一种与刚刚描述的方法等同的处理是使用CCD(见2.3.3
节)或类似传感器的累积能力，通过长时间地观察同一场景来达到降噪的目的。冷却也常常用于降低传
感器噪声。然而，最终结果类似于对一组噪声数字图像进行平均操作。
ai
图2.26 (a)被加性高斯噪声污染的Galaxy Pair NGC3314图像；(b)~(1)分别
对5,10,20,50,100幅噪声图像平均的结果(原图像由NASA提供)
例2.6 增强差别的图像相减。
图像相减经常用于增强图像之间的差。例如，图2.27(b)中的图像是通过把图2.27(a)中的每一个像素
的最低有效比特置0得到的。在视觉上，这些图像都不可辨别。然而，如图2.27(c)所示，从一幅图像减
去另一幅图像，则清楚地显示了它们的差别。在差值图像中，黑(0)值指出了在该位置图2.27(a)和图2.27(b)
之间没有差别。
作为另一个例子，我们简单地讨论称之为模板模式放射成像的医学成像领域，这是图像相减在商业
上成功的和高受益的应用。考虑如下形式的图像差：
g(x,y)=f(x,y)-h(x,y) (2.6-9)
在这种情况下，模板h(x,y)是病人身体一个区域的X射线图像，该图
像由放在X射线源对面的、强化了的电视摄像机(代替传统的X射线
胶片)获取。过程由以下几步组成：将一种X射线造影剂注人病人的血
流中，摄取一系列与h(x,y)解剖区域相同的所谓的活体图像[它们的样品表示为f(x,y)],从一系列
注射过造影剂的活体图像中减去模板h(x,y)。从每一幅活体图像中减去模板的最终结果是这样的区
域，即出现在输出图像g(x,y)中用以区分f(x,y)和h(x,y)之间的差别的区域，目的是增强细节。因
为图像可以按电视速率获取，这一过程基本上给出了一段显示造影剂怎样在被观察区域通过动脉传
播的影片。
图2.28(a)显示了在碘介质注射到血流中前，病人头部上方的一幅模板的X射线图像，图2.28(b)是在
注射碘介质后得到的一幅活体图像。图2.28(c)是图2.8(a)与图2.8(b)的差。在这幅图像中，一些细的血管
结构清晰可见。图2.28(d)的差别很清楚，它是由(c)增强了对比度后得到的(下一章中将讨论对比度增强)。
图2.28(d)是介质在大脑内怎样通过血管传播的一幅清晰的“图”。
通过图像相减来更改检测也用于图
像分割，图像分割是第10章的主题。
第2章 数字图像基础 45
a bc
图2.27(a)华盛顿特区的红外图像；(b)将图像(a)中的每一个最低阶比特置0
得到的图像；(c)两幅图像的差，为清楚起见，图像已标定到区间[0.255]
a bc d
图2.28 数字减影血管造影：(a)模板图像；(b)活体图像；(c)图(a)和图(b)的差值图像；
(d)增强后的差值图像[图(a)和图(b)由荷兰Urecht大学图像科学研究所医学中心提供]
例2.7 使用图像相乘和相除来校正阴影。
图像相乘(或相除)的一种重要应用是阴影校正。假设一个成像传感器产生可由f(x,y)表示的完美图
像与阴影函数h(x,y)的乘积来建模的图像，即g(x,y)=f(x,y)h(x,y)。如果h(x,y)已知，那么我们可
以使用h(x,y)的反函数[即g(x,y)/h(x,y)]乘以感知图像的方法得到f(x,y)。如果h(x,y)未知，但图
像系统可以访问，我们可以通过对具有恒定灰度的目标成像得到一个近似的阴影函数。当传感器不可用
时，我们常常如在9.6节讨论的那样直接从图像估计阴影模式。图2.29显示了阴影校正的一个例子。
图像相乘的另一种普通应用是模板操作，也称为感兴趣区域(ROI)操作。图2.30中说明的处理仅将
模板图像与一幅给定的图像相乘，模板图像的ROI区域为1,其他区域为0。模板图像中的ROI可能不
止一个，虽然由于实现容易而常常使用矩形形状，但ROI的形状可以是任意的。
a bc
图2.29 阴影校正：(a)钨丝及其支撑物的阴影SEM图像，该图像放大了近130倍；(b)阴影模式；(c)图(b)
的倒数与图(a)相乘的结果(原图像由俄勒冈 Eugene大学地质科学系的Michael Shaffer 提供)
在结束这一节的讨论之前，对图像算术操作的实现做些评述是有益的。实际上，大多数图像使
用8比特显示(即使24比特的彩色图像也是由分立的三个8比特通道组成的)。这样，我们认为图像
的灰度值范围为0~255。当图像以标准格式存储时，如TIFF或JPEG,图像的灰度值将自动转换到该
范围。然而，转换所用的方法取决于所用的系统。例如，两幅8比特图像以不同的取值范围可以是最
小的-255到最大的+255.图像之和的值可能在0到510的范围。许多软件包在把图像转换为8比特 8;巨
巨;言
46 数字图像处理(第三版)
图像时，仅简单地把所有的负值转换为0,而把超过255的值转换为255。给定一幅图像f,保证图像
间算术操作的整个值域落入某个固定比特数的方法如下。首先，我们执行操作
fm=f-min(f) (2.6-10)
a bc
图2.30(a)牙齿的X射线数字图像；(b)使用填充物隔离牙齿的ROI模
板(白色对应于1,黑色对应于0);(c)图(a)和图(b)相乘的结果
该操作生成其最小值为0的一幅图像。然后，执行操作
f?=K[fm/max(fm] (2.6-11)
该操作生成一幅标定的图像f,,其值在[0,K]范围内。在处理8比特图像时，置K=255,我们得到一
幅灰度范围从0到255的全部8比特的满标度图像。类似的方法可用于16比特或更高比特的图像。
这种方法可用于所有的算术操作。在执行除法操作时，我们还有额外的要求，即需要将一个较小的数
加到除数图像的像素上，以避免用0去除。
2.6.4 集合和逻辑操作
在这一节，我们简单介绍一些重要的集合和逻辑操作。我们还将介绍模糊集合的概念。
基本集合操作
令A为一个实数序对组成的集合。如果a=(a,a?)是A的一个元素，则将其写成
a∈ A (2.6-12)
同样，如果a不是A的一个元素，则写成
aEA (2.6-13)
不包含任何元素的集合称为空集，用符号?表示。
集合由两个大括号中的内容表示，即{}。例如，当我们将一个表达式写成C={wlw=-d,deD}
的形式时，所表达的意思是：集合C是元素w的集合，而w是通过用-1与集合D中的所有元素相
乘得到的。该集合用于图像处理的一种方法是令集合的元素为图像中表示区域(物体)的像素的坐标(整
数序对)。
如果集合A中的每个元素又是另一个集合B中的一个元素，则称A为B的子集，表示为
ACB (2.6-14)
两个集合A和B的并集表示为
C=AUB (2.6-15)
这个集合包含集合A和B中的所有元素。类似地，两个集合A和B的交集表示为
D=A∩B (2.6-16)
这个集合包含的元素同时属于集合A和B。如果A和B两个集合没有共同的元素，则称这两个集合
是不相容的或互斥的。此时，
第2章 数字图像基础 47
A∩B=0 (2.6-17)
全集 U是给定应用中的所有元素的集合。根据这一定义，给定应用的所有集合元素是对于该应
用所定义的全部成员。例如，如果处理实数集合，则集合的全集是实数域，它包含所有的实数。在图
像处理中，我们一般将全集定义为包含图像中所有像素的正方形。
集合A的补集是不包含于集合A的元素所组成的集合，表示为
A?={wlwe A} (2.6-18)
集合A和B的差表示为A-B,定义为
A-B={wl we A,we B}=A∩B° (2.6-19)
我们可以看出，这个集合中的元素属于A,而不属于B。例如，我们可以根据U并做集合的差操作来
定义A,即A=U-A。
图2.31说明了前述概念，全集是包含在所示正方形中的坐标的集合，并且集合A和B是包含在
所示边界内的坐标的集合。在每一幅图中，集合操作的结果用灰色显示①。
在前面的讨论中，集合成员是以位置(坐标)为基础的。当处理图像时，一个隐含的假设是集合
内所有像素的灰度是相同的，因为我们还没有定义关于灰度值的集合操作(即我们还未指定两个集合
的交集中的灰度是什么)。图2.31所示操作的唯一方法可以这样确定，如果包含这两个集合的图像是
二值的，在这种情况下，我们可以说集合成员是基于坐标的，并假设这两个集合的所有成员具有相同
的灰度。我们将在下一节做更详细的讨论。
a b e d e
A
AUB A∩B A-B|
B
u A°
图2.31(a)二维空间中的两个坐标集合A和B;(b)A和B的并集；(c)A和B的交集；
(d)A的补集；(e)A和B的差。在(b)到(e)中，阴影区域表示指定集合操作的成员
在处理灰度图像时，前述的概念就不适用了，因为我们必须指定来自集合操作结果的所有像素
的灰度。事实上，正如您将在3.8节和9.6节中看到的那样，灰度值的并集操作和交集操作通常分别
定义为相应像素对的最大和最小，而补集操作定义为常数与图像中每个像素的灰度间的两两之差。我
们处理相应像素对的事实告诉我们，灰度级集合操作是如2.6.1节定义的阵列操作。下面的例子是涉
及灰度级图像的集合操作的简单说明。我们将进一步讨论上面两节提到的概念。
例2.8 图像灰度的集合操作。
令灰度级图像的元素用集合A来表示，如24.2节提到的那样，这些元素是三元组形式(x,y,z),其中x和
y是空间坐标，z是灰度。我们可以将A的补集定义为A°={(x,y,K-z)I(x,y,z)∈A},它简单地表明像素集
合A中的灰度已从常数K中减去。该常数等于2*-1,其中k是用于表示z的灰度的比特数。令A表示图232(a)
中的8比特灰度图像，并且假设我们想要用集合操作形成一个负A。简单地形成集合A,=A=
{(x,y,255-z)l(x,y,z)∈A}。注意，坐标依旧，因此A,是与A大小相同的图像。图232(b)示出了这一结果。
①式(26-12)至式(26-19)中的操作是代数集的基础，它从AUB=BUA和A∩B=B∩A这样的交换律开始，形成了集合操作
的广泛理论基础。尽管代数集的处理超出了当前讨论的范围，但读者应了解这一点。 医;图
原;g
48 数字图像处理(第三版)
两个灰度集合A和B的并集可定义为集合
AUB={max(a,b)lae A,beB}
也就是说，两个灰度集合(图像)的并集是一个由空间相应元素对间的最大灰度形成的阵列。再一次注意
到坐标同样不变，因此A和B的并集是大小与这两幅图像相同的图像。正如说明的那样，假设A仍表示
图2.32(a)中的图像，并且令B表示与A大小相同的方形阵列，但其中所有的z值等于A中元素的平均灰
度m的3倍。图2.32(c)显示了执行这种并集操作的结果，其中所有超过3m的值呈现为A的值，而所有
其他像素的值为3m,即中间灰度值。
a bc
图2.32 灰度级图像的集合操作：(a)原图像；(b)使用补集操作得到的负像；
(c)图(a)与常数图像的并集(原图像由G.E.Medical Systems公司提供)
逻辑操作 N41
在处理二值图像时，我们可以把图像想象为
像素集合的前景(1值)与背景(0值)。然后，如
果我们将区域(目标)定义为由前景像素组成，则
(AAND(0一
图2.31中说明的集合操作就变成了二值图像中目
标坐标间的操作。处理二值图像时，OR、AND
和NOT 逻辑操作就是指普通的并、交和求补操
作，其中“逻辑”一词来自逻辑理论，在逻辑理
论中，1代表真，0代表假。
(A)OR()7
考虑由前景像素组成的区域(集合)A和B。
这两个集合的OR(或)操作结果不是属于A,就
是属于B,或者属于两者。AND操作是共同属于
A和B的元素的集合。集合A的NOT 操作是不
在A中的元素的集合。因为我们要处理图像，如
果A是给定的前景像素的集合，那么NOT(A)是
图像中不在A中的所有像素的集合，这些像素是
背景像素，并有可能是其他前景像素。我们可以
将该操作想象为：把A中的所有像素转换为0(黑
色),并把所有不在A中的元素转换为1(白色)。
(A)ANDINOT(Nz
管
(4)xoR(
图2.33 涉及前景(白色像素的逻辑操作的说明。黑
色代表二进制数0,白色代表二进制数1。虚
线不是结果的一部分，仅作为参考显示
第2章 数字图像基础 49
图2.33说明了这些操作。注意，显示该操作结果的第4行是前景像素集合，它属于A但不属于B.这
就是式(2.6-19)中集合差的定义。图中的最后一行是XOR(异或)操作的结果，该结果是属于A或B
的前景像素的集合，但不是两者的前景像素的集合。可以说，前述操作是区域间的操作，很清楚，区
域可以是不规则的和大小不同的。这与早些时候讨论的灰度级操作对立了，前面的灰度操作是阵列操
作并要求空间维数相同。也就是说，灰度集合操作涉及整个图像，而不是图像的区域。
我们仅在实现AND,OR和NOT逻辑算子时需要涉及理论知识，因为这三个算子是功能完备的。
换句话说，任何其他逻辑操作都可以仅用这三个基本函数执行，如图2.33中的第4行所示，在这里，
我们用AND和NOT实现了差集操作。逻辑操作广泛用于图像形态学处理，这是第9章的主题。
模糊集合
前述的集合和逻辑结果是“干脆”的概念，在这种意义下，元素要么是要么不是集合中的成员
这在某些应用中受到严重限制。考虑一个简单的例子。假如我们希望把世界上的所有人分为年轻人和
非年轻人。使用“干脆”的集合，令U代表所有的人，令A是U的子集，我们把它称为年轻人集合。
为了形成集合A,我们需要一个隶属度函数，该函数可以对U中的每个元素(人)赋1值或0值。如
果U中的元素赋值为1,则该元素就是A的一个成员，否则就不是A的一个成员。因为我们是在处
理二值逻辑，隶属度函数简单地定义为一个阈值，低于该阈值的人考虑为年轻人，高于该阈值的人考
虑为非年轻人。假如我们定义任何20岁或更年轻的人是年轻人。我们面临一个直接的困难：年龄为20岁
零1秒的人将不是年轻人集合的成员。这一限制出现在我们用于分类年轻人年龄的阈值上。什么是我
们意味的“年轻”需要更多的灵活性，即需要从年轻到非年轻逐步过渡。模糊集合理论使用隶属度函
数来实现这种概念，该函数在数值1(定义为年轻)和0(定义为非年轻)之间逐步过渡。使用模糊集合，
我们可以声明一个人的年轻度为50年轻和非年轻过渡的中间)。换句话说，年龄是一个不精确的概
念，而模糊逻辑提供处理这种概念的工具。我们将在3.8节中详细探讨模糊集合。
2.6.5 空间操作
空间操作直接在给定图像的像素上执行。我们把空间操作分为三大类：(1)单像素操作；(2)邻
域操作；(3)几何空间变换。 s=T(2)
单像素操作 255
我们在数字图像中执行的最简单的操作就是以灰度
为基础改变单个像素的值。这类处理可以用一个形如下
式的变换函数T来描述： s
s=T(z) (2.6-20)
其中，z是原图像中像素的灰度，s是处理后的图像中
相应像素的(映射)灰度。例如，图2.34示出了得到一
幅8比特负图像的变换，图2.32(b)中的图像是利用集
合操作得到的。我们将在第3章中讨论指定灰度变换功
能的一些技术。
0 255 Z
图2.34 用于得到8比特图像的负图像的灰
度变换函数。虚线箭头显示了任意
输入灰度值z到对应输出值s。的变换
邻域操作
令S。代表图像f中以任意一点(x,y)为中心的一个邻域的坐标集。邻域处理在输出图像g中的相
同坐标处生成一个相应的像素，该像素的值由输入图像中坐标在S。内的像素经指定操作决定。例如， 3～5
50 数字图像处理(第三版)
假设指定的操作是计算在大小为m×n、中心在(x,y)的矩形邻域中的像素的平均值。这个区域中像素的
位置组成集合S。图2.35(a)和(b)说明了这一过程。我们可以用公式的形式将这一操作描述为
8Cx=—∑ roe (2.6-21)
其中，r和c是像素的行和列坐标，这些坐标是S,中的成员。图像g是这样得到的：改变坐标(x,y),
以便邻域的中心在图像f中从一个像素到另一个像素移动，并在每一个新位置重复邻域操作。例如，
图2.35(d)中的图像是使用大小为41×41的邻域按这种方式创建的。最终结果是在原图像中执行局部
模糊。例如，这种类型的处理可消除小的细节，并在图像中相应的大区域实施“斑点”补偿。我们将
在第3章、第5章和本书的其他几处地方讨论邻域处理。
受唇
a b cd
图2.35 使用邻域处理的局部平均：(a)~(b)说明了矩形邻域的过程；(c)1.3.2节讨论过的大动脉
血管造影；(d)将m=n=41代人式(26-21)后的结果。图像大小为790×686像素
几何空间变换和图像配准
几何变换改进图像中像素间的空间关系。这些变换通常称为橡皮膜变换，因为它们可看成是在
一块橡皮膜上印刷一幅图像，然后根据预定的一组规则拉伸该薄膜。在数字图像处理中，几何变换由
两个基本操作组成：(1)坐标的空间变换；(2)灰度内插，即对空间变换后的像素赋灰度值。
坐标变换可由下式表示：
n
m
(xy
S
图像厂
(5y)
该像素的值是S,中
像素的平均值
图像8
(x,y)=T((v,w)} (2.6-22)
其中，(v,w)是原图像中像素的坐标，(x,y)是变换后图像中像素的坐标。例如，变换(x,y)=T[(v,w)}=
(v/2,w/2)在两个方向上把原图像缩小一半。最常用的空间坐标变换之一是仿射变换(Wolberg[1990]),
其一般形式如下：
uyw- (2.6-23)
这个变换可根据矩阵T中元素所选择的值，对一组坐标点做尺度、旋转、平移或偏移。表2.2说明了
用于实现这些变换的矩阵值。式(2.6-23)中矩阵表示的真实作用提供了一个把一系列操作连接在一起
的框架。例如，如果我们想要调整一幅图像的大小，对其旋转，把处理结果移动到某一位置，我们可
以简单地构成一个3×3矩阵，去乘来自表2.2的尺度、旋转和平移矩阵。
前面的变换把一幅图像上的像素重新定位到一个新位置。为了完成该处理，我们还必须对这些
新位置赋灰度值。该任务可用灰度内插的方法完成。灰度内插这一主题已在2.4.4节讨论过。在那一节
开始，我们用一个放大图像的例子讨论了给新像素位置赋灰度值的问题。正像在表2.2 中第二行详细
第2章 数字图像基础 51
表述的那样，放大是简单的尺度变换，并且其分析类似于我们对图像放大那样，可用于从表2.2的其
他变换得到的对重定位像素赋灰度值问题。如2.44节那样，在做这些变换时，我们可考虑最近邻、
双线性和双三次内插技术。
表2.2 基于式(2.6-23)的仿射变换
变换名称 仿射矩阵T 坐标公式 例子
恒等变换 x=
y=w
y
x
尺度变换 x=c?
y=c,w
x=vcosθ-wsinθ 旋转变换 y=vsinθ+wcosθ
平移变换 x=v+t
y=w+1, T
(垂直)偏移变换 x=vs,+w
y=w
(水平)偏移变换 x=V
y=sv+w
实际上，我们可以按两种基本方法来使用式(2.6-23)。第一种方法称为前向映射，它由扫描输入
图像的像素，并在每个位置(v,w)用式(2.6-23)直接计算输出图像中相应像素的空间位置(x,y)组成。
前向映射算法的一个问题是输入图像中的两个或更多个像素可被变换到输出图像中的同一位置，这就
产生了如何把多个输出值合并到一个输出像素的问题。另外，一种可能是某些输出位置可能完全没有
要赋值的像素。第二种方法，称为反向映射，扫描输出像素的位置，并在每一个位置(x,y)使用
(v,w)=T?1(x,y)计算输入图像中的相应位置。然后，内插(使用2.44节讨论的技术之一)是用最近的
输入像素之一决定输出像素的灰度值的。对于实现来说，反向映射比前向映射更有效，因而被许多空
间变换的商业实现所采用(如MATLAB就采用该方法)。
例2.9 图像旋转与灰度内插。
本例的目的是用仿射变换说明图像旋转。图2.36(a)显示了一幅300 dpi的图像，图2.36(b)~(d)是将
原图像旋转21°并分别使用最近邻、双线性和双三次内插后的结果。旋转是在保持直线特性方面最苛求
的几何变换之一。正如我们在图中所看到的那样，最近邻内插产生了最大的锯齿边缘，如2.4.4节那样，
双线性内插得到了明显改进的结果。如以前那样，使用双三次内插产生了稍微清晰一些的结果。事实上，
后目
52 数字图像处理(第三版)
如果您比较图2.36(c)和图2.36(d)中放大了的细节，您将在子图像的中间注意到由亮到暗变换所引入的大
量垂直灰度块，而图2.36(c)中的垂直灰度块数量要比图2.36(d)中的相应垂直灰度块数量多，说明
字母的边缘更清晰。类似的结果可用表2.2中的其他空间变换按要求的内插得到(恒等变换不会得到类似
的结果，增量为整数个像素的平移变换也不会得到类似的结果)。这个例子是使用前一段讨论的反向映射
方法实现的。
TABG
a bed
图2.36(a)字母T的300 dpi图像；(b)旋转21°并用最近邻内插给经空间变换后的像素
赋灰度值后的图像；(c)旋转21°并用双线性内插赋灰度值后的图像；(d)旋转
21°并用双三次内插赋灰度值后的图像。放大部分显示了三种内插方法的边缘细节
图像配准是数字图像处理的一种重要应用，用于对齐两幅或多幅相同场景的图像。在前述讨论
中，已经知道了为达到希望的几何变换的变换函数形式。在图像配准中，我们有可用的输入图像和输
出图像，但是，从输入图像产生输出图像的特定变换通常是不知道的。这样，问题就是估计变换函数，
然后用它配准两幅图像。为搞清楚该术语，输入图像是我们希望变换的图像，而我们所谓的参考图像
是我们想要配准输入图像的图像。
例如，感兴趣的是对齐(配准)在近似相同时间但使用不同成像系统获取的两幅或多幅图像，如
一幅是用MRI(核磁共振成像)扫描器获取的图像，另一幅是用PET(正电子断层)扫描器获取的图像；
或在不同的时间使用相同的设备获取的图像，如给定位置间隔几天、几个月甚至几年的卫星图像。无
论哪种情况，合并这些图像或执行定量分析，以及做比较，都要求对由观察视角、距离、方向、传感
器分辨率、目标位置移动及其他因素导致的几何畸变进行修正。
解决刚才讨论的这个问题的主要方法之一是使用约束点(也称为控制点),这些点是在输入图像
和参考图像中其位置恰好已知的相应点。有很多选择约束点的方法，可以交互式地选择这些点，也可
以使用试图自动检测这些点的算法。在某些应用中，成像系统在成像传感器中会嵌入有形的人为物质
(如小的金属物)。这会在系统获取的图像上直接产生一系列已知点(称为网状标记),这些点都用做建
立约束点的指导。
估计变换函数问题是建模问题之一。例如，假设在输入图像和参考图像中有一组4个约束点。
基于双线性近似的简单模型由如下两式给出：
x=c?V+c?w+c?vw+c? (2.6-24)
和
y=C?V+c?w+c?vw+c? (2.6-25)
其中，在估计阶段，(v,w)和(x,y)分别是输入图像和参考图像中约束点的坐标。如果在两幅图像中
我们有4对相应的约束点，则可用式(2.6-24)和式(2.6-25)写出8个方程，然后用它们解出8个未知
参数c,c?,…,cg。这些参数就组成了一个模型，该模型把一幅图像的像素变换为另一幅需要配准的
图像的像素位置。
一旦我们有了系数，式(2.6-24)和式(2.6-25)就成为我们变换输入图像中的所有像素并生成期望
的新图像的工具，如果约束点选择得正确，新图像就能与参考图像配准。在4个约束点不足以得到令
第2章 数字图像基础 53
人满意的配准的情况下，常常使用的一种方法是选择大量的约束点，如同一个子图像那样，用一组4个
约束点形成四边形来处理。子图像用上述方法处理，四边形内部的所有像素使用由这些约束点求出的
系数进行变换。然后，移动到另一组4约束点，并重复上述过程，直到所有的四边形区域均被处理为
止。当然，也可使用比四边形更复杂的区域并采用更复杂的模型，例如使用最小均方算法的拟合多
项式。通常，控制点的数量和解决问题所要求的模型的复杂程度取决于几何畸变的严重程度。最后，
应牢记式(2.6-24)和式(2.6-25)所定义的变换，或任何针对该问题的其他模型，以及输入图像中像素
空间坐标的简单映射。我们还需要使用前面讨论的方法执行灰度内插，以便给这些像素灰度值赋。
例2.10 图像配准。
图2.37(a)显示了一幅参考图像，图2.37(b)显示了相同的图像，但因垂直和水平切变产生了几何畸变。
我们的目标是使用参考图像得到约束点，然后用约束点配准这两幅图像。我们(手工)选择的约束点靠近图
像的角点，由白色小方形点表示(因为畸变是在两个方向上的线性切变，因此仅需要4个约束点)。图2.37(c)
显示了使用前面讨论过的这些约束点来实现配准的结果。我们注意到，配准并不完美，因为图2.37(c)中有
明显的黑边。图2.37(d)更清楚地显示了参考图像和校正后的图像间配准的细小不足。导致这种差别的原
因是手工选择约束点时的误差。当畸变很严重时，使用约束点很难实现完美的匹配。
a bed
a a a a a a a …a
 a a a a aa a
q
aaa a a a aa
图2.37 图像配准：(a)参考图像；(b)输入图像(几何畸变图像),相应的约束点以靠近角点的白色小方
块显示；(c)配准后的图像(注意边界上的误差);(d)图(a)和图(c)的差，显示了更多的配准误差
2.6.6 向量与矩阵操作
多光谱图像处理是使用向量和矩阵操作的典型领域。例如，在第6章中，您将学习在RGB彩色
空间中如何使用红色、绿色、蓝色分量图像来形成如图2.38说明的彩 关于向量和矩阵的简单介 色图像。这里，我们看到RGB 图像的每一个像素都有三个分量，这 绍，请读者参阅本书网站上的Tutorial
些分量可组织成一个列向量的形式： 部分。
(2.6-26)
其中，z,是红色图像中像素的亮度，其他两个元素是相应的绿色图像和蓝色图像中像素的亮度。这样，
大小为M×N的RGB彩色图像就可用这一大小的三个分量图像来表示，或者总共用MN个三维向量
来表示。普通的多光谱情况包括n幅分量图像(见图1.10),将形成n维向量。在第6章、第10章、
第11章和第12章，我们都使用这种形式的向量表示。
一旦像素被表示为向量，我们就可以使用向量矩阵理论这一工具。例如，一个像素向量z和一个
任意点a在n维空间的欧氏距离D可以用一个向量积来定义： 匠;日
1～1
54 数字图像处理(第三版)
Diz.a)-[z-a](z-a)=[(z-a2+(z-a,2+…+(2,-a,PF (2.6-27)
我们看到，这是式(2.5-1)定义的二维欧氏距离的通式。式(2.6-27)有时称为向量范数，表示为|z-a。
在后面的章节中，我们将多次使用距离计算。
像素向量的另一个重要优点是由下式表
示的线性变换：
w=A(z-a) (2.6-28)
其中，A是大小为m×n的矩阵，z和a是
n×1大小的列向量。正如您将要学到的那样，
这种类型的变换在图像处理中有很多有用的
用途。
分量图像3(蓝色)
分量图像2(绿色)
分量图像1(红色)
图2.38 三幅RGB分量图像中的相应像素值形成一个向量
如式(2.4-2)表示的那样，整个图像可当做矩阵(或向量)来处理，这是在解决大量数字图像处理
问题时有重要意义的事实。例如，我们可以把一幅大小为M×N的图像描述为一个MN×1维向量，
方法是用图像的第一行作为该向量的前N个元素，第二行作为下N个元素，等等。用这种方法形成
的图像，我们可以表达应用更广范围的、下列表示的图像线性处理：
g=Hf+n (2.6-29)
其中，f表示输入图像的MN×1向量，n表示一个M×N噪声模式的MN×1向量，g表示处理后图像
的MN×1向量，H是用于对输入图像进行线性处理的MN×MN 矩阵(见2.6.2节关于线性处理的介
绍)。例如，像在5.9节将要讨论的那样，使用式(2.6-29)为图像复原开发一整套通用技术是可能的。
在下一节中，我们会再次接触矩阵这一主题，并在第5章、第8章、第11章和第12章显示矩阵在图
像处理中的其他用途。
2.6.7 图像变换
到目前为止，讨论的所有图像处理方法都是直接在图像像素上进行操作，即直接工作在空间域。
在有些情况下，通过变换输入图像来表达图像处理任务，在变换域执行指定的任务，之后再用反变换
返回到空间域会更好。随着本书学习的深入，您会遇到许多不同的变换。表示为T(u,v)的二维线性
变换是一类特别重要的变换，其通用形式可表达为
ra.)-22rayrcx,yu,y (2.6-30)
其中，f(x,y)是输入图像，r(x,y,u,v)称为正变换核，式(2.6-30)对u=0,1,2,….M-1和v=
0,1,2,…,N-1进行计算。与以前一样，x和y是空间变量，M和N是f的行和列，u和v称为变换
变量。T(u,v)称为f(x,y)的正变换。给定T(u,v)后，我们可以用T(u,v)的反变换还原f(x,y):
rax,=2ZTu DSst,yuD (2.6-31)
其中，x=0,1,2,…,M-1,y=0,1,2,…,N-1,s(x,y,u,v)称为反变换核。式(2.6-30)和式(2.6-31)
一起称为变换对。
图2.39显示了在线性变换域执行图像处理的基本步骤。首先，变换输入图像，然后用预定义的操
作修改该变换，最后，输出图像由计算修改后的变换的反变换得到。这样，我们可以看出，该过程是
从空间域到变换域，然后返回到空间域。
第2章 数字图像基础 55
变换 T(u.v) f(x,y) 运算R
R[T(u.)] 反变换 g(x,y)
空间域 空间域
变换城
图2.39 线性变换域中操作的一般方法
例2.11 变换域图像处理。
图2.40显示了图2.39中步骤的一个例子。在这种情况下，所用的变换是傅里叶变换，在本节稍后我
们将简单提一下它，第4章将对其进行详细介绍。图2.40(a)是一幅被正弦干扰污染了的图像，图2.40(b)
是该图像傅里叶变换的幅度，它是图2.39中第一阶段的输出。正如您将在第4章学习的那样，空间域中的
正弦干扰在变换域以较亮的脉冲方式出现。在这种情况下，脉冲是图2.40(b)中可见的圆形模式。图2.40(c)
显示了一个模板图像(称为滤波器),白和黑分别代表1和0。对于该例子，图2.39第二个方框内的操作是
变换的结果与模板相乘，以可靠地消除干扰脉冲。图2.40(d)显示了最终结果，该结果是通过计算修改后
的变换的反变换得到的。事实上，您恰好可以看到基准标志(淡淡的十字),它用于图像对准。
a bcd
图2.40(a)被正弦干扰污染了的图像；(b)傅里叶变换的幅度，显示了干扰能量脉冲：()用于消
除能量脉冲的模板；(d)计算修改后的傅里叶变换的反变换的结果(原图像由NASA提供)
如果
r(x,y,u,V)=r(x,u)r?(y.v) (2.6-32)
那么所谓的正向变换核是可分的。另外，如果r(x,y)等于z?(x,y),则称变换核是对称的，从而有
r(x,y,u,v)=r(x,u)(y,v) (2.6-33)
在前面的公式中，若用s代替r,则同样的说明适用于反变换核。
例211中讨论的二维傅里叶变换有如下正、反变换核：
r(x,y,u.v)=e-j2n(ur/M+y/N) (2.6-34)
和
s(x,y,u,)=Me/te/m (2.6-35)
其中，j=√-1,因此这些核是复数。将这些核代入式(2.6-30)和式(2.6-31)给出的通用变换公式中，
可得出离散傅里叶变换对：
ra.y-22rasee (2.6-36)
和
raxy)-六2rma,ye (2.6-37)
从基础意义上说，这些公式在数字图像处理中是很重要的，在第4章中，我们将投入更多的篇幅从基
本原理入手推导它们，然后在较宽的应用范围使用它们。 巨;司
国;同
56 数字图像处理(第三版)
证明傅里叶核的可分性和对称性并不困难(见习题2.25),并且可分的和对称的核允许用一维傅里
叶变换计算二维傅里叶变换(见习题2.26)。当变换对的正、反变换核满足这两个条件，且f(x,y)是
大小为M×M的方形图像时，式(2.6-30)和式(2.6-31)可表示为矩阵形式：
T=AFA (2.6-38)
其中，F是包含元素f(x,y)的M×M矩阵[见式(2.4-2)];A是有元素a;=f(i.j)的M×M矩阵，
T是M×M变换的结果，其值为T(u,v),u,v=0,1.2,…,M-1。
为得到反变换，我们用反变换矩阵B前乘和后乘式(2.6-38):
BTB=BAFAB (2.6-39)
如果B=A?1,则
F=BTB (2.6-40)
该式指出F[其所有元素均等于f(x,y)]可完全由其正向变换复原。如果B≠A?1,则用式(2.6-40)
可得到一个近似：
F=BAFAB (2.6-41)
除了傅里叶变换之外，一些重要的变换，如沃尔什变换、哈达玛变换、离散余弦变换、哈尔变
换和斜变换等，可用式(2.6-30)和式(2.6-31)的形式描述，或等价地用式(2.6-38)和式(2.6-40)的形式
描述。我们将在后续章节讨论这些变换和其他类型的图像变换。
2.6.8 概率方法
概率以很多方式用于图像处理工作中。最简单的方式是当我们以
随机量处理灰度值时。例如，令z,i=0.1,2,…,L-1 表示一幅
M×N大小数字图像中所有可能的灰度值，则在给定图像中灰度级
z出现的概率p(z)可估计为
p(z)=MN
关于概率论的简介，请读者
查阅本书网站上的Tutoriaks 部分。
(2.6-42)
其中，n是灰度z,在图像中出现的次数，MN是像素总数。显然，
u)=1 (2.6-43)
一旦我们知道了p(z),就可以得出许多重要的图像特性。例如，平均灰度由下式给出：
m=2z) (2.6-44)
类似地，灰度的方差是
c2=2(-m2rz) (2.6-45)
方差是z值关于均值的展开度的度量，因此它是图像对比度的有用度量。通常，随机变量z关于均值
的第n阶矩定义为
3)=2(-m°pa) (2.6-46)
我们看到，H?(z)=1,μ?(z)=0且μ?(z)=o2。反之，均值和方差对于图像的视觉特性有明显的直接
第2章 数字图像基础 57
关系，高阶矩更敏感。例如，一个正三阶矩指出其灰度倾向于比均值高，负三阶矩则指出相反的条件，
并且零三阶矩告诉我们灰度近似相等地分布在均值的两侧。这些特性对于计算目的很有用，但它们一
般不能告诉我们更多图像外观的内容。
例2.12 图像灰度对比度度量时标准差值的比较。
图2.41显示了分别展示低、中、高对比度的三幅8比特图像。在这
三幅图像中，像素灰度的标准差分别是14.3,31.6和49.2个灰度级。相应
的方差值分别是204.3,997.8,2424.9。两组数值告诉我们相同的内容，但
这三幅图像可能的灰度值范围是[0,255],与该范围相关的标准差值与方
差相比要直观得多。
方差的单位是灰度值的平方。在
比较对比度值时，我们通常替代使
用标准差σ(方差的均方根》,因为
其维数直接取决于灰度值。
a bc
图2.41 展示了(a)低对比度、(b)中对比度和(c)高对比度的图像
在本书的进展中，您将看到，在开发图像处理算法中，概率的概念起着核心角色的作用。例如，
在第3章，我们利用式(2.6-42)的概率度量推导灰度变换算法。在第5章中，我们使用概率和矩阵公
式开发图像复原算法。在第10章中，概率被用于图像分割，而在第11章中，我们用概率描述纹理。
在第12章中，我们以概率公式为基础，导出最佳目标识别技术。
到目前为止，我们已经讨论了将概率应用到单幅二维图像上的单个随机变量(灰度)的问题。如
果考虑序列图像，我们可能解释成为时间的第三个变量。处理这一附加复杂性的工具是随机图像处理
技术(“stochastic”一词来自希腊语，其大意是在处理结果中随意地瞄准目标)。我们可以进一步将整
个图像考虑为一个空间随机事件(相对于一个点)。基于这一概念所需要的处理工具是来自随机域的技
术。在5.8节中，我们将给出一个例子，说明如何像随机事件那样处理整个图像，但关于随机过程和
随机域的讨论超出了本书的范围。本节末尾提供的参考文献是阅读这些主题的起点。
小结
本章内容为后续讨论提供了主要的背景知识。对人类视觉系统的论述虽然简单，但提供了人眼
感知图像信息能力的一个基本概念。关于光和电磁波谱的讨论是理解本书所用的许多图像来源的基
础。类似地，2.3.4节给出的图像模型也是第4章中称为同态滤波图像增强技术的基础。
2.4节介绍的取样和内插的概念是您在实践中可能遇到的许多数字现象的基础。当您掌握了傅里
叶变换和频率域的概念后，在第4章中我们还将回到取样及其分支问题的讨论。
2.5节介绍的概念是基于像素邻域处理技术的基本组成部分。例如，如下一章和第5章所示的那
样，邻域处理方法是许多图像增强和复原过程的核心。在第9章中，我们将采用邻域操作对图像做形
态学处理，在第10章中，我们用邻域处理进行图像分割，在第11章中，我们用它们进行图像描述。
在应用方面，邻域处理由于处理速度快，且硬件和/或固件实现简单，故在图像处理商业应用方面得
到了人们的偏爱。
2.6 节的内容在您阅读全书时始终很好地为您提供帮助。虽然讨论的水平确实是介绍性的，但对 日;唇
8-三
58 数字图像处理(第三版)
于您建立数字图像处理的概念是合适的。正如在该节中我们提到的那样，介绍的那些工具在后续章节
中是必需的。不是一个章节或附录这样一个地方就能对数学概念充分地论述，您将发现，在后续章节
中对来自2.6节的数学工具进行必要的扩展，及如何运用它们解决图像处理的问题来说更有意义。
参考文献
2.1 节中有关人眼结构的阅读资料可在Atchison和Smith[2000]及Oyster[1999]中找到。阅读资料见
Regan[2000]和Gordon[1997]。Hubel[1988]的书和Comsweet[1970]的经典书籍也很重要。Bom和Wol[1999]
是讨论光和电磁波理论的基本参考资料。电磁能传播包含在Felsen和Marcuvitz[1994]的详细论述中。
图像感知领域非常宽泛且发展非常快。关于光传感器和其他成像传感器的一个优秀信息源是国际光学
工程学会(SPIE)。下面是SPIE在这一领域具有代表性的出版物：Blouke等人[2001]、Hoover和Doty[1996]
及Freeman[1987]的著述。
2.3.4节给出的图像模型来自Oppenheim,Schafer和Stockham[1968]的论著。该节中所用的照度值和反
射值的参考文献是(IESNA光学手册)IESNA Lighting Handbook{2000]提供的。关于图像取样及其一些效应
(譬如混淆效应)的其他读物见Bracewel[1995]。我们将在第4章中更详细地讨论这个主题。2.4.3节提到的
作为取样和量化的函数的感知图像质量方面的早期实验是由Huang[1965]报告的。在降低图像取样数和灰度
级的同时，尽量减少随之而来的退化仍是当前人们感兴趣的主题，如Papamarkos和Atsalakis[2000]的例证。
关于图像收缩和放大方面的进一步读物见Sid-Ahmed[1995],Unser 等人[1995],Umbaugh[2005]和Lehmann
等人[1999]的文献。2.5节涵盖主题的进一步读物，见Rosenfeld和Kak[1982],Marchand-Maillet和Sharaiha
[2000]及Ritter和Wilson[2001]提供的材料。
图像处理中关于线性系统(见2.6.2节)的附加读物可在Castleman[1996]中找到。使用图像平均来消除
噪声的方法(见2.6.3节)由Kohler和Howel[1963]首次提出。关于随机变量求和的均值和方差的期望值的
材料见Peebles[1993]。图像相减(见2.6.3节)是一种广泛用于检测变化的通用图像处理工具。为使得图像相
减有意义，配准被减图像是必要的，或者必须识别出由于移动导致的人为缺陷。由Meijering等人[1999,2001]
撰写的两篇论文给出了用于实现这些目的的技术。
2.6.4节的基本参考文献是Cameron[2005]。这一主题的更高级的读物见Tourlakis[2003]的著作。关于模
糊集合的介绍见3.8节和第3章中的相关参考文献。单点和邻域处理(见2.6.5节)的进一步细节见3.2节到
3.4节及第3章中关于这些主题的参考文献。关于几何空间变换见Wolberg[1990]的材料。
Noble和Daniel[1988]的著述是矩阵和向量操作(2.6.6节)的基本参考材料。关于傅里叶变换(见2.6.7节)
的详细讨论见第4章，数字图像处理中使用的其他类型变换的例子见第7章、第8章和第11章。关于概率和
随机变量(见2.6.8节)的基本介绍见Peebles[1993],Papoulis[1991]的著述是该话题的更进一步论述。关于随机
和随机域图像处理的基础材料，见Rosenfeld和Kak[1982],Jihne[2002]和Won及Gray[2004]的著述。
本章中给出的许多技术的软件实现细节见Gonzalez,Woods和Eddins[2004]的书籍。
习题
★2.1 使用2.1节提供的背景信息，如果纸上的一个打印点离眼睛0.3m远，请采用纯几何方法，估计眼睛
能辨别的最小打印点的直径。为简单起见，假设在中央凹处的像点变得远比视网膜区域的感受器(锥
状体)的直径小时，视觉系统已不能检测到该点。进一步假设中央凹可建模为直径为1.5mm 的圆形阵
列，并且锥状体间的间隔在该阵列上均匀分布。
标有星号的习题的详细答案
可在本书的网站上找到。该网站上还
包含有基于本章内容建议的项目。
第2章 数字图像基础 59
2.2 当我们在白天进入一家黑暗的剧场时，在能看清并找到空座时要用一段时间适应。2.1节描述的视
觉过程在这种情况下起什么作用?
★2.3 虽然图2.10中未显示，但交流电的确是电磁波谱的一部分。美国的商用交流电频率是77 Hz。问
这一波谱分量的波长是多少米?
2.4 设计一个研究细胞、细菌、病毒和蛋白质边界形状的图像系统前端。在这种情况下，前端由光
源和相应的图像摄像机组成。要求围成各个类别的圆形的直径分别为25 μm,0.5 μm,0.05 μm和
0.005 μm。
(a)能用单个传感器和摄像机解决这一成像问题吗?如果回答是肯定的，试给出照射波长和所需
的摄影机类型。这里的“类型”指的是摄像机最敏感的电磁波谱波段(譬如红外波段)。
(b)如果(a)中您的回答是否定的，那么您建议采用哪种类型的照明光源和相应的图像传感器?指
出(a)中所要求的光源和摄像机。要用最少数量的照明光源和摄像机解决这个问题。“解决这
个问题”是指能够分别检测直径为25μm,0.5μm,0.05μm和0.005μm的环形细节。
2.5 14 mm×14 mm的CCD摄像机芯片有2048×2048个元素，将它聚焦到相距0.5m远的一个方形平
坦区域。该摄像机每毫米能分辨多少线对?摄像机配备了一个35mm 镜头。(提示：成像处理模
型如图2.3所示，但使用摄像机镜头的焦距替代眼睛的焦距。)
★2.6 一家汽车制造商想在一条限量版跑车生产线上将一些零件自动安放到跑车的保险杠上。这一部件
就是彩色坐标，为选择合适的保险杠零件，机器人需要知道每辆车的颜色。模型有4种颜色：蓝
色、绿色、红色和白色。请提出一种基于成像的解决方案。您怎样解决自动确定每辆跑车颜色的
问题?记住，在选择零件时价格是最主要的考虑因素。
2.7 假设中心在(x?,y?)的平坦区域被一个强度分布为
i(x,y)=Ke[-P+0-?]
的光源照射。为简单起见，假设该区域的反射是恒定的并且等于1.0,令K=255。如果图像使用k
比特的强度分辨率进行数字化，且眼睛可检测相邻像素间的4种灰度突变，请问k取何值时会出
现可见的伪轮廓?
2.8 画出习题2.7中k=4时的图像。
★2.9 数字数据传输通常用波特率度量，其定义为每秒钟传输的比特数。通常，传输是以一个开始比特、
一个字节(8比特)的信息和一个停止比特组成的包完成的。利用这些事实，回答下列问题：
(a)使用33.6K 波特的调制解调器传输一幅大小为2048×2048的256 灰度级的图像，需要几分钟
时间?
(b)波特率为3000K时，这是典型的电话DSL(数字用户线)的媒体速度，传输要用多长时间?
2.10 高清晰度电视(HDTV)使用1080条水平电视线隔行扫描来产生图像(每隔一行在显像管表面画一条
线，每两场形成一帧，每场用时1/60秒)。图像的宽高比是16:9。在水平行数固定的情况下，求
图像的垂直分辨率。一家公司已经设计了一种图像获取系统，该系统由HDTV图像生成数字图像。
在该系统中，每条(水平)电视行的分辨率与图像的宽高比成正比，彩色图像的每个像素都有24比
特的灰度分辨率，红色、绿色、蓝色图像各8比特。这三幅原色图像形成彩色图像。存储90分钟
的一部HDTV电影需要多少比特?
★2.11 考虑两个图像子集S,和S?,如下页右图所示。对于V=(1),确定这两个子集是(a)4邻接的、(b)8邻
接的，还是(c)m邻接的?
★2.12 提出将一个像素宽度的8通路转换为4通路的一种算法。 阅
臣因
60 数字图像处理(第三版)
2.13 提出将一个像素宽度的m通路转换为4通路的一种算法。
2.14 参阅2.5.2 节末尾的讨论，在该讨论中，我们将背景定 S?
0[0 0 0 0 0 义为(R)°,即图像中所有区域的并集的补集。在某些
1 0
一
0 0 0 应用中，定义一个像素(R)的子集为背景是有利的， 1 1 0 1 0 0
该子集不是孔洞像素区域(非正式地，认为孔洞是由区 0 0. 1 0
域像素围绕着的背景像素子集)。如何修改这一定义， 1 0 0 0
以便从(R)中排除孔洞像素?像“背景是非孔洞像素
的(R,)像素的子集”这样的答案是不能接受的。(提示：利用连通性这一概念。)
S?
0 1 0
1 0 0 1
1 0 0 0
0 0. 00
0
2.15 考虑右图的图像分割。
★(a)令V=(0.1,2},计算p和q间4、8和m通路的最短长度。如果在这
两点间不存在一个特殊通路，试解释原因。
(b)令V=(2,3.4},重复问题(a)。
2.16★(a)对于点p和q间的D.距离等于这两点间最短4通路的情况，给出需
要的条件。
(b)这个通路唯一吗?
2.17 对于Dg距离，重做习题2.16。
★2.18 在下一章，将讨论一些算子，其功能是在一个很小的子图像区域S中计算像素值的总和。证明这
些算子都是线性算子。
2.19 一个数集的中值ξ定义为这样一个值，该数集中的一半数值比它小，另一半数值比它大。例如，
数集(2,3,8,20,21,25,31}的中值是20。试证明计算子图像区域S的中值的算子是非线性的。
★2.20 证明式(2.6-6)和式(2.6-7)的正确性。[提示：从式(2.6-4)开始，并且利用这样一个事实：一个和
的期望值就是期望值的和。]
2.21 考虑两幅8比特图像，它们的灰度级跨越从0到255的全部范围。
(a)讨论从图像(1)中重复减去图像(2)的限制效应。假设结果仍然用8比特表示。
(b)如果颠倒图像的顺序，会产生不同的结果吗?
★2.22 图像相减通常用于在生产线上检测缺失的元件。方法是存储一幅对应于正确组装的“金”图像；
然后，从相同产品的传人图像中减去该图像。理想情况下，如果新产品组装正确，则差值应为零。
对于缺失元件的产品，在不同于金图像的位置，差值图像将不为零。在实际中，您认为在什么条
件下使用这种方法工作才是合适的?
2.23 ★(a)参考图2.31,画出集合(A-B)U(B-A)。
(b)给出下图中集合A,B,C中所示的阴影集合的表达式。每幅图中的阴影区域组成一个集合，因
此应该对这三幅图的每一个阴影区域给出一个表达式。
A
B C
2.24 使用三角形区域替代四边形区域时，所得到的类似于式(2.6-24)和式(2.6-25)的等式是什么?
2.25 证明式(2.6-34)和式(2.6-35)中的傅里叶核是可分的和对称的。
第2章 数字图像基础 61
★2.26 证明具有可分性、对称性的二维变换核可以用(1)沿输入的行(列)的一维变换来计算；接着(2)用
第一步结果的列(行)的一维变换来计算。
2.27 一家工厂生产半透明的微型聚合物方形产品。要求进行100??觉检测来严格控制质量，工厂管理
者发现人工检测越来越昂贵，于是检测改为半自动方式。在每个检测位置，机械装置把聚合物方
形产品放在一盏灯的上方，灯位于光学系统的下方，该光学系统产生方形产品的放大图像，图像
完全落在大小为80 mm×80 mm的观察屏上。缺陷以暗的斑点的形式出现，检测者的工作是观察
屏幕。如果在屏幕上一个样品中出现了多个直径大于或等于0.8 mm的黑色斑点，则丢弃该样品。
管理者相信，如果能找到一种全自动的处理方法，利润将提高50??她还相信项目的成功会是她
升迁为法人的阶梯。经过大量调研之后，管理者确定了解决这一问题的方法，即用CCD电视摄像
机去观察每个检测屏幕，并把摄像机的输出送到能够检测斑点的图像处理系统中，测量它们的直
径，并触发以前由检测员操作的接收和丢弃按钮。她可以找到一个系统，只要最小的缺陷在数字
图像中至少为2×2 像素的区域发生，就可以完成该工作。假设管理者聘任您来帮助她确定摄像机
和镜头系统的参数，但要求您使用现有的元件。对于镜头，假设该约束条件意味着任何25mm,35mm
直至200 mm 焦距的整数倍。对于摄像机，这意味着分辨率为512×512像素、1024×1024像素或
2048×2048像素。这些摄像机中的各个成像元素是大小为8μm×8μm的方形，成像元素间的间距
2 μm。对于该应用，摄像机要远贵于镜头，因此该问题应以选择镜头为基础，尽可能使用最低分
辨率的摄像机来解决。作为一名顾问，请您提供一份书面建议，对您的结论给出合理且详细的分
析。使用习题2.5中建议的相同成像几何。
医;因
巨·目
第3章 灰度变换与空间滤波
它的与众不同之处在于，是透过光线看阴影还是透过阴影看亮度。
——大卫·林赛
引言
术语空间域指图像平面本身，这类图像处理方法直接以图像中的像素操作为基础。这是相对于
变换域中的图像处理而言的，正如2.6.7节所介绍的和第4章将要详细讨论的那样，变换域的图像处
理首先把一幅图像变换到变换域，在变换域中进行处理，然后通过反变换把处理结果返回到空间域。
空间域处理主要分为灰度变换和空间滤波两类。正像本章您将了解到的那样，灰度变换在图像的单个
像素上操作，主要以对比度和阈值处理为目的。空间滤波涉及改善性能的操作，如通过图像中每一个
像素的邻域处理来锐化图像。接下来几节我们将讨论一些经典的灰度变换和空间滤波技术。我们还将
讨论模糊技术的某些细节，以便允许我们在灰度变换和空间滤波算法的公式化表示中并入不太精确的
以知识为基础的信息。
3.1 背景知识
3.1.1 灰度变换和空间滤波基础
本节讨论的所有图像处理技术都是在空间域进行的。由2.4.2节的讨论，我们知道空间域就是简
单的包含图像像素的平面。如2.6.7节定义的那样，与(第4章的主题)频率域相反，空间域技术直
接在图像像素上操作，例如，对于频率域来说，其操作在图像的傅里叶变换上执行，而不针对图像本
身。正如您将在阅读全书的过程中了解到的那样，某些图像处理任务在空间域中执行更容易或更有意
义，而另一些任务则更适合使用其他方法。通常，空间域技术在计算上更有效，且在执行上需要较少
的处理资源。
本章讨论的空间域处理可由下式表示：
g(x,y)=T[f(x,y)] (3.1-1)
其中f(x,y)是输入图像，g(x,y)是处理后的图像，T是在点(x,y)的
邻域上定义的关于f的一种算子。算子可应用于单幅图像(本章中我
们的主要关注点)或图像集合，例如，如2.6.3节中讨论的那样，为降
有时也使用其他形状的邻域，如
圆的数字近似，但矩形邻域是到目
前为止最好的邻域，因为它们在计
算机上实现起来更为容易。
第3章 灰度变换与空间滤波 63
低噪声而对图像序列执行逐像素的求和操作。图3.1显示了式(3.1-1)在单幅图像上的基本实现。所示
的点(x,y)是图像中的一个任意位置，包含该点的小区域是点(x,y)的邻域，如2.6.5节解释的那样。
典型地，邻域是中心在(x,y)的矩形，其尺寸比图像小得多。
图3.1 中给出的处理由以下几步组成：邻域原点从一 原点
个像素向另一个像素移动，对邻域中的像素应用算子T,
(x.y) 并在该位置产生输出。这样，对于任意指定的位置(x,y),
输出图像g在这些坐标处的值就等于对f中以(x,y)为原 (s,y)的3×3邻域 点的邻域应用算子T的结果。例如，假设该邻域是大小为
图像厂 3×3的正方形，算子T定义为"计算该邻域的平均灰度"。
考虑图像中的任意位置，譬如(100,150)。假设该邻域的 空间域
K 原点位于其中心处，则在该位置的结果g(100,150)是计算
f(100,150)和它的8个邻点的和，再除以9(即由邻域包
围的像素灰度的平均值)。然后，邻域的原点移动到下一
个位置，并重复前面的过程，产生下一个输出图像g的值。
图3.1 空间域一幅图像中关于点(x,y)的一个
3×3邻域。邻域在图像中从一个像个素
到另一个像素移动来生成一幅输出图像
典型地，该处理从输入图像的左上角开始，以水平扫描的方式逐像素地处理，每次一行。当该邻域的
原点位于图像的边界上时，部分邻域将位于图像的外部。此时，不是在用T做指定的计算时忽略外侧
邻点，就是用0或其他指定的灰度值填充图像的边缘。被填充边界的厚度取决于邻域的大小。在3.4.1
节中，我们将再回到这一问题。
就像我们在3.4节中详细讨论的那样，刚刚描述的过程称为空间滤波，其中，邻域与预定义的操
作一起称为空间滤波器(也称为空间掩模、核、模板或窗口)。在邻域中执行的操作类型决定了滤波处
理的特性。
最小邻域的大小为1×1。在这种情况下，g仅取决于点(x,y)处的f值，而式(3.1-1)中的T则成
为一个形如下式的灰度(也称为灰度级或映射)变换函数：
s=T(r) (3.1-2)
其中，为表达方便，令r和s分别表示变量，即g和f在任意点(x,y)处的灰度。例如，如果T(r)有
如图3.2(a)所示的形式，对f中每一个像素施以变换产生相应的g的像素的效果将比原始图像有更高
的对比度，即低于k的灰度级更暗，而高于k的灰度级更亮。这种技术有时称为对比度拉伸(见3.2.4
节),在该技术中，低于k的r值被变换函数压缩在一个较窄的范围s内，接近黑色；而高于k的r值
则与此相反。很明显，灰度值r?经映射得到了相应的值s。。在如图3.2(b)所示的极限情况下，T(r)
产生了一幅两级(二值)图像。这种形式的映射称为阈值处理函数。有些相当简单但功能强大的处理方
法，可以使用灰度变换函数用公式加以表达。在这一章中，我们主要使用灰度变换函数来进行图像增
强。在第10章中，我们将使用灰度变换函数来进行图像分割。其结果仅取决于一个点处的灰度的方
法有时称为点处理技术，与此相反，本节早些时候讨论的方法则称为邻域处理技术。
3.1.2 关于本章中的例子
虽然灰度变换和空间滤波覆盖了相当宽的应用范围，但本章中的多数例子是图像增强应用。增
强处理是对图像进行加工，使其结果对于特定的应用比原始图像更合适的一种处理。“特定”一词在
这里很重要，它一开始就确定增强技术是面向问题的。例如，对于增强X射线图像非常有用的方法，
可能并不是增强由电磁波谱中远红外波段拍摄的图像的最好方法。图像增强没有通用的“理论”。当
为视觉解释而处理一幅图像时，观察者将是判定一种特定方法好与坏的最终裁判员。在处理机器感知 品
64 数字图像处理(第三版)
时，一种给定的技术很易于量化。例如，在自动字符识别系统中，最合适的增强方法就是可得到最好
识别率的方法，这里不考虑一种方法较另一种方法的计算量的要求。
a b s=T() s=T()
s=T(o)
圈;因
燃 T(r) 暗一 鼎事事光 T()
k
暗→亮
k
暗→亮
图3.2 灰度变换函数：(a)对比度拉伸函数；(b)阀值处理函数
然而，不管应用或使用过的方法，图像增强是视觉上最具吸引力的图像处理领域之一。理所当
然地，图像处理的初学者通常会寻找重要的且理解起来相对简单的增强应用。因此，使用图像增强的
例子来说明本章中论述的空间处理方法，不仅可以节省本书中处理图像增强的额外的章节，而且更重
要的是对初学者介绍空间域处理技术的细节的更有效方法。正如您将要看到的那样，随着本书的进程，
本章叙述的基本内容可用于比图像增强宽得多的范围。
3.2 一些基本的灰度变换函数
灰度变换是所有图像处理技术中最简单的技术。r和s分别代表处理前后的像素值。如前一节指
出的那样，这些值与s=T(r)表达式的形式有关，其中T是把像素值r映射到像素值s的一种变换。由
于我们处理的是数字量，所以变换函数的值通常存储在一个一维阵列中，且从r到s的映射是通过查
找表实现的。对于8比特环境，包含T的值的一个查找表将有256条记录。
作为关于灰度变换的介绍，考虑图3.3,该图显示了图像增强常用的三类基本函数：线性函数(反
转和恒等变换)、对数函数(对数和反对数变换)和幂律函数(n次幂和n次根变换)。恒等函数是最一
般的情况，其输出灰度等于输入灰度的变换，在图3.3中包括它仅仅为了完整性考虑。
3.2.1 图像反转
使用图3.3中所示的反转变换，可得到灰度级范围为[0,L-1]的一幅图像的反转图像，该反转图
像由下式给出：
s=L-1-r (3.2-1)
使用这种方式反转一幅图像的灰度级，可得到等效的照片底片。这种类型的处理特别适用于增强嵌人
在一幅图像的暗区域中的白色或灰色细节，特别是当黑色面积在尺寸上占主导地位时。图3.4显示了
一个例子。原图像是一幅数字乳房X射线照片，其中显示有一小块病变。尽管事实上两幅图在视觉
内容上都一样，但应注意，在这种特殊情况下，分析乳房组织时使用反转图像会容易得多。
3.2.2 对数变换
图3.3中的对数变换的通用形式为
s=clog(l+r) (3.2-2)
第3章 灰度变换与空间滤波 65
其中c是一个常数，并假设r≥0。图3.3中对数曲线的形状表明，该变换将输入中范围较窄的低灰度值
映射为输出中较宽范围的灰度值，相反地，对高的输入灰度值也是如此。我们使用这种类型的变换来扩
展图像中的暗像素的值，同时压缩更高灰度级的值。反对数变换的作用与此相反。
L-1
反转变换
3L/4 第n次根
输出灰度级 对数变换
L/2 第n次幂
L/4
恒等变换 反对数变换
嗜 L/4 L/2 3L/4 L-1
输入灰度级r
图3.3 一些基本的灰度变换函数。所有曲线已被缩放到适合显示的范围
a b
图3.4 (a)原始数字乳房X射线照片；(b)使用式(3.2-1)给出的反转
变换得到的反转图像(图像由G.E.MedicalSystems公司提供)
具有图3.3所示对数函数的一般形状的任何曲线，都能完成图像灰度级的扩展/压缩，但是，下一
节讨论的幂律变换对于这个目更为通用。对数函数有个重要特征，即它压缩像素值变化较大的图像的
动态范围。像素值有较大动态范围的一个典型应用说明是傅里叶频谱，这将在第4章中讨论。现在，
我们只关注图像的频谱特征。通常，频谱值的范围从0到10?,甚至更高。尽管计算机能毫无问题地
处理这一范围的数字，但图像的显示系统通常不能如实地再现如此大范围的灰度值。因而，最终结果
是许多重要的灰度细节在典型的傅里叶频谱的显示中丢失了。
作为对数变换的说明，图3.5(a)显示了值域为0~1.5×10°的傅里叶频谱。当这些值在一个8比
特系统中被线性地缩放显示时，最亮的像素将支配该显示，频谱中的低值(恰恰是重要的)将损失掉。
图3.5(a)中相对较小的图像区域，鲜明地体现了这种支配性的效果，而作为黑色则观察不到。替代这种
显示数值的方法，如果我们先对这些频谱值应用式(3.3-2)(此时c=1),那么得到的值的范围就变为 -1
1～1
66 数字图像处理(第三版)
0~6.2。图3.5(b)显示了线性地缩放这个新值域并在同一个8比特显示系统中显示频谱的结果。由这
些图片可以看出，与未改进显示的频谱相比，这幅图像中可见细节的丰富程度是很显然的。我们在关
于图像处理的出版物中所看到的绝大多数傅里叶频谱都用这种方式标定过。
a b
图3.5(a)傅里叶频谱；(b)应用式(3.2-2)中的对数变换(c=1)的结果
3.2.3 幂律(伽马)变换
幂律变换的基本形式为
s=cr (3.2-3)
其中c和γ为正常数。有时考虑到偏移量(即输入为0时的一个可度量输出),式(3.2-3)也写为s=
c(r+E)。然而，偏移量一般是显示标定问题，因而作为一个结果，通常在式(3.2-3)中忽略不计。对
于不同的γ值，s与r的关系曲线如图3.6所示。与对数变换的情况类似，部分γ值的幂律曲线将较窄
范围的暗色输入值映射为较宽范围的输出值，相反地，对于输入高灰度级值时也成立。然而，与对数
函数不同的是，我们注意到，随着γ值的变化，将简单地得到一族可能的变换曲线。正如所预期的那
样，在图3.6中，我们看到，γ>1的值所生成的曲线和γ<1的值所生成的曲线的效果完全相反。最
后，我们注意到式(3.2-3)在c=γ=1时简化成了恒等变换。
L-1
z=0.04
Z=0.10
31./4 x=020
y=0.40 输出灰度级s y=0.67
L/2 y=1
y=15
r=25
L/4 y=5.0
10.0
y=25.0
% L/4 L/2 3L/4 L-1
输入灰度级：
图3.6 不同γ值的s=cr'曲线(所有情况c=1)。所有曲线均已被缩放到适合于显示的范围
第3章 灰度变换与空间滤波 67
用于图像获取、打印和显示的各种设备根据幂律来产生响应。习惯上，幂律方程中的指数称为
伽马[故在式(3.2-3)中使用这一符号]。用于校正这些幂律响应现象的处理称为伽马校正。例如，阴
极射线管(CRT)设备有一个灰度-电压响应，该响应是一个指数变化范围约为1.8~2.5的幂函数。在
图3.6中，用γ=2.5时的参考曲线，我们看到，这种显示系统产生的图像往往要比期望的图像暗。这
个结果在图3.7加以说明。图3.7(a)显示了一幅输入到监视器的简单灰度斜坡(渐变)图像。如期望的那
样，监视器表现了输出比输入暗，如图3.7(b)所示。在这种情况下，伽马校正很简单。我们需要做的只
是将图像输入到监视器前进行预处理，即进行s=r12?=r?变换。结果如图3.7(c)所示。当输入到相同
的监视器时，这一伽马校正过的输入产生外观上接近于原图像的输出，如图3.7(d)所示。类似的分析也
适用于其他图像设备，如扫描仪和打印机。唯一的不同是随设备而定的伽马值(Poynton[1996])。
a b
cd
原图像 伽马校正 在监视器上观察到的原图像
经伽马校正后的图像 在同一监视器上观察到
的经伽马校正后的图像
图3.7(a)亮度斜坡图像；(b)具有伽马值为2.5的模拟监视器上观察到的图像；(c)经伽马校
正后的图像；(d)在同一监视器上观察到的经伽马校正后的图像。比较图(d)和图(a)
如果所关注的是在计算机屏幕上精确显示图像，则伽马校正是很重要的。不恰当校正的图像看
起不是太亮，就是太暗。试图精确再现彩色也需要伽马校正的一些知识，因为改变伽马值不仅会改变
亮度，而且会改变彩色图像中红、绿、蓝的比率。随着数字图像在互联网上商业应用的增多，在过去几
年里，伽马校正逐渐变得越来越重要。为流行网站创建被几百万人浏览的图像是很平常的事，因为大多
数浏览者会有不同的监视器和/或监视器设置。有些计算机系统甚至会内置部分伽马校正。此外，目前
的图像标准并不包含创建图像的伽马值，因此，问题进一步复杂化了。由于这些限制，当在网站中存
储图像时，一种合理的方法是用伽马值对图像进行预处理，此伽马值代表了在开放的市场中，在任意
给定时间点，各种型号的监视器和计算机系统所期望的“平均值”。
例3.1 使用幂律变换进行对比度增强。
除伽马校正外，幂律变换在通用对比度操作中也很有用。图3.8(a)显示了人体胸部以上脊椎骨折错位
和脊髓受到影响的一幅核磁共振(MRD)图像。在胸椎垂直中心附近，即图中从上往下约1/4处，骨折显而
易见。由于所给图像整体偏暗，因而需要扩展灰度级。这可以使用指数为分数的幂律变换来完成。使用
式(3.2-3)给出的幂律变换来处理图3.8(a),得到示于图中的其他几幅图像。对应于图(b)到图(d)的伽马值 ～1
3～1
68 数字图像处理(第三版)
分别为0.6,0.4和0.3(c始终为1)。我们注意到，随着伽马值从0.6减小到0.4,更多的细节变得可见了。
当伽马值进一步减小到0.3时，背景中的细节得到了进一步增强，但对比度会降低到图像开始有轻微“冲
淡”外观的那一点，尤其是在背景中。比较所有的结果，我们看到在对比度和可辨别细节方面的最好增
强在γ=0.4时。在这幅特定的图像中，γ=0.3的值是一个近似极限点，低于该值对比度会下降到令人难
以接受的水平。
a bcd
图3.8(a)人体脊椎骨折的核磁共振图像(MRI);(b)~(d)令c=1而γ分别等于0.6,04,0.3时应用式(3.2-3)
给出的变换的结果(原图像由Vanderbilt大学医学中心辐射学与放射学系的David R.Pickens博士提供)
例3.2 幂律变换的另一个说明。
图3.9(a)显示了一个与图3.8(a)相反的问题。要处理的图像现在有“冲淡”的外观，这表明灰度级的
压缩是必需的。这可以用式(3.2-3)并令γ>1来完成。令γ=3.0,4.0和5.0时，图3.9(a)的处理结果如图3.9(b)
到(d)所示。伽马值取 3.0和4.0时，可得到合适的结果，且后者由于有较高的对比度而显示出更令人满
意的效果。γ=5.0时得到的结果中有些地方太暗，因而丢失了一些细节，如左上方主路左侧的暗色区域
就是这样的一个例子。
a bc d
图3.9(a)航拍图像；(b)~(d)令c=1且γ分别等于3.0,4.0和5.0时
应用式(3.2-3)给出的变换的结果(此例的原图像由NASA提供)
3.2.4 分段线性变换函数
对前面三节中所讨论方法的一个补充方法是使用分段线性函数。分段线性函数较我们已经讨论过
的函数类型的的主要优点是分段线性函数的形式可以是任意复杂的。事实上，正如您马上将要看到的
那样，一些重要变换的实际实现可仅由分段函数来明确地表达。分段函数的主要缺点是它的技术说明
要求用户输入。
对比度拉伸
最简单的分段线性函数之一是对比度拉伸变换。低对比度图像可由照明不足、成像传感器动态
范围太小，甚至在图像获取过程中镜头光圈设置错误引起。对比度拉伸是扩展图像灰度级动态范围的
处理，因此，它可以跨越记录介质和显示装置的全部灰度范围。
第3章 灰度变换与空间滤波 69
图3.10(a)显示了一个用于对比度拉伸的典型变换。点(,s?)和点(?,s?)的位置控制变换函数的
形状。如果r=s?且r?=s?,则变换为一线性函数，将产生一个没有变化的灰度级。若?=?,s,=0
且s?=L-1,则变换变为阈值处理函数，并产生一幅二值图像，如图 3.2(b)所示。(Y,s,)和(r?,s?)
的中间值产生输出图像的不同程度的灰度级扩展，从而来影响输出图像的对比度。一般情况下，假设
r?≤r?且s?≤S?,函数是单值的且单调递增的。这一条件保持了灰度级的次序，从而避免了在处理后的
图像中产生人为的灰度错误。
L-1
3L/4
输出灰度级 L/2
L/4
0-
0
r?sz)
T(r)
r1.s)
L/4L/2 3L/4L-1
输入灰度级! a bc d
图3.10 对比度拉伸：(a)变换函数的形式；(b)低对比度图像；(c)对比度拉伸的结果；(d)阀值处理
的结果(原图像由位于堪培拉的澳大利亚国立大学生物科学研究院的Roger Heady博士提供)
图3.10(b)显示了一幅8比特低对比度图像。图3.10(c)显示了对比拉伸后的效果，得到该效果的参数
设置如下：(r,S,)=(rm,0)且(?,s?)=(m,L-1),其中rm和r分别表示图像中的最小灰度级和最
大灰度级。因此，变换函数把灰度级由其原范围线性地拉伸至整个范围[0,L-1]。最后，图3.10(d)显示
了使用前面定义的(j,s?)=(m,0)和(r?,S?)=(m,L-1)的阀值处理函数后的结果，其中，m是图像的平
均灰度级。作为这些结果的基础的原图像是电子显微镜扫描的放大约700倍的花粉图像。
灰度级分层
突出图像中特定灰度范围的亮度通常是重要的，其应用包括增强特征，如卫星图像中大量的水
和X射线图像中的缺陷。通常称之为灰度级分层的处理可以有许多方法实现，但是它们中的大多数
是两种基本方法的变形。一种方法是将感兴趣范围内的所有灰度值显示为一个值(譬如“白色”),而
将其他灰度值显示为另一个值(譬如“黑色”)。如图3.11(a)所示，该变换产生了一幅二值图像。第
二种方法以图3.11(b)所示的变换为基础，使感兴趣范围的灰度变亮(或变暗),而保持图像中的其他
灰度级不变。
a b L-1 L-1
5
T(r) 5
T()
0 A B L-1 0 A B L-1
图3.11 (a)这一变换突出了范围[A,B]内的灰度，而将所有其他灰度降低到了一个更低
的级别：(b)这一变换突出了范围[A,B]内的灰度，而保持所有其他灰度级不变 1;1
70 数字图像处理(第三版)
例3.3 灰度级分层。
图3.12(a)是一幅靠近肾脏区域的大动脉血管造影照片(见1.3.2节对这幅图像更详细的解释)。该例的
目的是使用灰度级分层来突出主要血管，使其更亮一些，如同注射造影剂的效果那样。图3.12(b)显示了
使用图3.11(a)给出的变换的结果，所选范围接近数值的顶端，因为感兴趣的范围比背景亮。该变换的最
终结果是血管和肾脏部分显现白色，而其他灰度显示为黑色。这种类型的增强产生了一幅二值图像，这
对于研究(用于检测血管堵塞的)造影剂的流动是很有用的。
另一方面，如果我们的兴趣在于研究感兴趣区域的实际灰度值，则可使用图3.11(b)中的变换。
图3.12(c)显示了使用这样一个变换后的结果：近似等于平均灰度的中等灰度区域的灰度范围设置为黑色，
而其他灰度保持不变。这里，我们看到主血管和肾脏区域部分的灰度级色调保持不变。当我们的兴趣是
测量系列图像中造影剂随时间流动时，这种结果是很有用的。
a b e
图3.12(a)大动脉血管造影照片；(b)使用图3.11(a)中说明的分层变换的结果，所选的重要灰度
范围为灰度级的高端；(c)使用图3.11(b)中的变换的结果，所选区域置为黑色，以便血
管和肾脏区域的灰度保持不变(原图像由密歇根大学医学院的Thomas R.Gest博士提供)
比特平面分层
像素是由比特组成的数字。例如，在256级灰度图像中，每个像素的灰度是由8比特(也就是1个
字节)组成的。代替突出灰度级范围，我们可突出特定比特来为整个图像外观作出贡献。如图3.13说
明的那样，一幅8比特图像可考虑为由8个1比特平面组成，其中平面1包含图像中所有像素的最低
阶比特，而平面8包含图像中所有像素的最高阶比特。
居;高
一个8比特字节- 比特平面8
(最高阶比特)
比特平面1
(最低阶比特)
图3.13 一幅8比特图像的比特平面表示
图3.14(a)显示了一幅8比特灰度图像，图3.14(b)到图3.14(i)是其8个1比特平面，图3.14(b)对
应于最低阶比特。很明显，4个高阶比特平面，特别是最后两个比特平面，包含了在视觉上很重要的
大多数数据。低阶比特平面在图像中贡献了更精细的灰度细节。原图像有一个灰度为194的灰色边。
注意，对应于某些比特平面的灰度边界是黑色(0),而其他灰度边界是白色(1)。为了解其原因，考虑
第3章 灰度变换与空间滤波 71
一个像素，譬如，图3.14(a)的最低边界的中部。从最高阶平面开始，这些比特平面中的相应像素的
值分别为11000010,它是十进制数194的二进制表示。原图像中任意一个像素的值，可以类似地
由这些比特平面中对应的二进制像素值来重建。
性：
图3.14 一幅大小为500×1192像素的8比特灰度图像：(b)~(i)比特平面1到8.
其中比特平面1对应于最低阶比特。每个比特平面都是一幅二值图像
根据灰度变换函数，显示一幅8比特图像的第8个比特平面并不困难，它可用阈值灰度变换函
数处理输入图像得到二值图像，该函数将0~127之间的所有灰度映射为0,而将128~255之间的所有
灰度映射为1。图3.14(i)中的二值图像就是使用这种方式得到的。得到生成其他比特平面的灰度变换
函数的方法，将作为一个练习留给读者(见习题3.4)。
把一幅图像分解为比特平面，对于分析图像中每个比特的相对重要性是很有用的，这一处理可
帮助我们确定用于量化该图像的比特数的充分性。此外，这种类型的分解对图像压缩(第8章的主题)
也很有用，在图像压缩中，重建一幅图像时所用的平面要比全部平面少。例如，图3.15(a)显示了使用
比特平面8和比特平面7重建的一幅图像。重建是使用第 n个平面的像素乘以常数2”1来完成的。与
把第n个有意义的二进制比特变换成十进制相比，这并没有做更多的事。所用的每个比特平面与一个
相应的常数相乘，然后将所有的比特平面相加得到灰度图像。这样，为得到图3.15(a),我们用128乘
以比特平面8,用64乘以比特平面7,然后把这两个比特平面相加。虽然原图像的主要特征被复原了，
但重建后的图像显得有些平淡，特别是在背景区域。这并不奇怪，因为两个平面仅能产生4个不同的
灰度级。把平面6加入到重建中可改善这种情况，如图3.15(b)所示。注意，该图像的背景有可感知
的伪轮廓。这一效应可通过在重建中加入第5个平面来显著降低，如图3.15(c)所示。在重建中使用
更多的平面对图像的外观不会有更大的贡献。因而，我们可以得出这样的结论：存储4个高阶比特平
面将允许我们以可接受的细节来重建原图像。存储这4个平面代替原始图像可减少50??存储量(不
考虑存储体系结构问题)。
a bc
图3.15 (a)使用比特平面8和7重建的图像；(b)使用比特平面8.7和6重建的图像；
(c)使用比特平面8,7,6和5重建的图像。将图(c)与图3.14(a)进行比较 三;国
142
72 数字图像处理(第三版)
3.3 直方图处理
灰度级范围为[0,L-1]的数字图像的直方图是离散函数h(r)=n,其中r是第k级灰度值，n
是图像中灰度为r的像素个数。在实践中，经常用乘积MN表示的图像像素的总数除它的每个分量来
归一化直方图，通常M和N是图像的行和列的维数。因此，归一化后
的直方图由p(r)=n,/MN 给出，其中k=0,1,…,L-1。简单地说， 顾，请读者参阅本书的网站。
关于基本概率论的简要回
p(r)是灰度级r在图像中出现的概率的一个估计。归一化直方图的
所有分量之和应等于1。
直方图是多种空间域处理技术的基础。直方图操作可用于图像增强，如本节所示。除了提供有
用的图像统计资料外，在后续章节中我们还会看到直方图中的固有信息在其他图像处理应用中也非常
有用，如图像压缩与分割。直方图在软件中计算简单，而且有助于商用硬件实现，因此已成为实时图
像处理的一种流行工具。
作为灰度变换的直方图处理的介绍，我们考虑图3.16,它是图3.10所示的以4个基本灰度级为特征
的花粉图像：暗图像、亮图像、低对比度图像和高对比度图像。图的右侧显示了与这些图像对应的直方
图。每个直方图的水平轴对应于灰度值x,垂直轴对应于值h(r)=n,或归一化后的值p(r)=n /MN。
这样，直方图就可以简单地被看成是h(r)=n,对应于r或p(r)=n,/MN对应于r的图形。
我们注意到，在暗图像中，直方图的分量集中在灰度级的低(暗)端。类似地，亮图像直方图的
分量则倾向于灰度级的高端。低对比度图像具有较窄的直方图，且集中于灰度级的中部。对于单色图
像，这意味着暗淡，好像灰度被冲淡了一样。最后，我们看到，高对比度图像中直方图的分量覆盖了
很宽的灰度级范围，而且像素的分布没有太不均匀，只有少量垂线比其他的高许多。直观上，可以得
出这样的结论：若一幅图像的像素倾向于占据整个可能的灰度级并且分布均匀，则该图像会有高对比
度的外观并展示灰色调的较大变化。最终效果将是一幅灰度细节丰富且动态范围较大的图像。很快将
会证明，仅仅依靠输入图像直方图中的可用信息就可开发出一个变换函数来自动地实现这种效果。
3.3.1 直方图均衡
考虑连续灰度值，并用变量r表示待处理图像的灰度。通常，我们假设r的取值区间为[0,L-1],
且r=0表示黑色，r=L-1表示白色。在r满足这些条件的情况下，我们将注意力集中在变换形式
s=T(r),0≤r≤L-1 (3.3-1)
上(灰度映射),对于输入图像中每个具有r值的像素值产生一个输出灰度值s。我们假设
(a)T(r)在区间0≤r≤L-1上为单调递增函数。
(b)当0≤r≤L-1时，0≤T(r)≤L-1。
在稍后讨论的一些公式中，我们用反函数
r=T?1(s),0≤s≤L-1 (3.3-2)
在这种情况下，条件(a)改为
(a')T(r)在区间0≤r≤L-1上是一个严格单调递增函数。
①如果对于z>r有T(?)≥T(g),则称函数T(r)是单调递增的。如果对于z>r有T()>T(),则称函数T(r)是严格单调
递增的。类似的定义适用于单调递减函数。
第3章 灰度变换与空间滤波 73
暗图像的直方图
亮图像的直方图
低对比度图像的直方图
高对比度图像的直方图
图3.16 4种基本的图像类型：暗图像、亮图像、低对比度图像和高对比度图像，以及与它们相对应的直方图
条件(a)中要求T(r)为单调递增函数是为了保证输出灰度值不少于相应的输入值，防止灰度反变
换时产生人为缺陷。条件(b)保证输出灰度的范围与输入灰度的范围相同。最后，条件(a')保证从s
到r的反映射是一对一的，防止出现二义性。图3.17(a)显示了满足条件(a)和(b)的一个变换函数。在
这里我们看到，多值映射到单值是可能的，并且仍然满足这两个条件。也就是说，单调变换函数执行
一对一或多对一映射。当从r到s映射时，这是很完美的。然而，如果我们想要唯一地从映射的值恢
复r值(反映射由反向箭头表示),图3.17(a)就存在一个问题。图3.17(a)中s,的反映射是可能的，但
是，s,的反映射是一个范围的值，通常，要防止由s,恢复原始的r值的问题。如图3.17(b)所示，
T(r)要求是严格单调的，以保证反映射是单值的(即两个方向上的映射都是一对一的)。这是我们在
本章后面推导一些重要直方图处理技术的理论要求。因为在实践中我们处理的是整数灰度值，必须把
所有结果四舍五入为最接近的整数值。因此，当严格单调不满足时，我们就要使用寻找最接近整数匹
配的方法来解决非唯一反变换的问题。例3.8对此给出了说明。 医;
居：固
74 数字图像处理(第三版)
a b TO) T()
L-1 L-1
单个值5 T(r)- T(n
单个值s
0
0 多个值 单个值L-1 L-1
图3.17 (a)非单调递增函数，显示了将多个值映射为单个值的方
式；(b)严格单调递增函数。这是一个双向的一一映射
一幅图像的灰度级可看成是区间[0,L-1]内的随机变量。随机变量的基本描绘子是其概率密度函
数(PDF)。令p,(r)和p?(s)分别表示随机变量r和s的概率密度函数，其中p的下标用于指示p,和
p,是不同的函数。由基本概率论得到的一个基本结果是，如果p,(r)和T(r)已知，且在感兴趣的值
域上T(r)是连续且可微的，则变换(映射)后的变量s的PDF可由下面的简单公式得到：
p,(S)=p,0) (3.3-3)
这样，我们看到，输出灰度变量s的PDF就由输入灰度的PDF和所用的变换函数决定[回忆可知r
和s由T(r)关联起来]。
在图像处理中特别重要的变换函数有如下形式：
s=T(r)=(L-D?。p,(w)dw (3.3-4)
其中，w是积分的假变量。公式右边是随机变量r的累积分布函数(CDF)。因为PDF总为正，回忆
一下，一个函数的积分是该函数下方的面积，遵循式(3.3-4)的变换函数满足条件(a),因为函数下的
面积不随r的增大而减小。当在该等式中上限是r=(L-1)时，则积分值等于1(PDF曲线下方的面积
总是1),所以s的最大值是(L-1),并且条件(b)也是满足的。
为寻找刚才讨论的相应变换的p,(s),我们使用式(3.3-3)。我们由基本积分学中的莱布尼茨准则
知道，关于上限的定积分的导数是被积函数在该上限的值，即
d=dr(=(L-D[J。p,(whdu]=(L-Dp,() (3.3-5)
把dr/ds的这个结果代入式(3.3-3),并记住概率密度值为正，得到
D.O)=p,=p.)a-DP.云os≤L-1 (3.3-6)
从该公式的最后一行中的p?(s)可知，这是一个均匀概率密度函数。简而言之，我们已证明执行式(3.3-4)
的灰度变换将得到一个随机变量s,该随机变量由一个均匀PDF 表征。特别要注意，由该式可知T(r)
取决于p,(r),但正如式(3.3-6)所指出的那样，得到的p,(s)始终是均匀的，它与p,(r)的形式无关。
图3.18说明了这些概念。
第3章 灰度变换与空间滤波 75
a b p,(r) p,(s)
A
式(3.3-4)→
一
0 L-1 0 L
图3.18 (a)一个任意的PDF;(b)对所有灰度级r应用式(3.3-4)中的变
换的结果。具有均匀PDF的结果灰度s与r的PDF的形式无关
例3.4 式(3.3-4)和式(3.3-6)的说明。
为牢记这一概念，考虑下面这个简单的例子。假设图像中的(连续)灰度值有如下PDF:
从式(3.3-4)有
s=T(r)=(L-D?。p,(wdw=--J。wdw=
假设我们接着使用这个变换得到一幅灰度为s的新图像；也就是说，s值是通过求输人图像的相应灰度值
的平方，然后除以(L-1)形成的。例如，考虑一幅L=10的图像，并且假设输入图像中任意位置(x,y)处
的像素有灰度r=3。则新图像中在该位置的像素是s=T(r)=r2/9=1。我们可以把p,(r)代入式(3.3-6),
并用s=r2/(L-1)这样的事实验证新图像中的灰度的PDF是均匀的，即
nO=.-|-|--去
其中，最后一步遵循了这样一个事实，即r是非负的并且假设L>1。正如所期望的那样，结果是一个均
匀的PDF。
对于离散值，我们处理其概率(直方图值)与求和来替代处理概率密度函数与积分。正如前面提
到的那样，一幅数字图像中灰度级r出现的概率近似为
P,(r)=MN,k=0,1,2,…,L-1 (3.3-7)
其中，MN是图像中像素的总数，n,是灰度为r的像素个数，L是图像中可能的灰度级的数量(即对8比
特图像是256)。正像本节开始说明的那样，与r相对的p,(x)图形通常称为直方图。
式(3.3-4)中变换的离散形式为
=TVn)=4-D≥p,(r)=n,k=0.1.2…,L-1 (3.3-8)
①先前声明的单调性条件同样适用于离散情形。我们简单地将变量的值限制为离散值 医声
酬一要
76 数字图像处理(第三版)
这样，已处理的图像(即输出图像)通过式(3.3-8)将输入图像中灰度级为 r的各像素映射到输出图像中
灰度级为s的对应像素得到。在这个公式中，变换(映射)T(r)称为直方图均街或直方图线性变换。
不难证明(见习题3.10)该变换函数满足本节前面所述的条件(a)和(b)。
例3.5 直方图均衡的简单说明。
在继续之前，通过一个简单的例子来说明直方图均衡的工作原理是有帮助的。假设一幅大小为
64×64像素(MN=4096)的3比特图像(L=8)的灰度分布如表3.1所示，其中灰度级是范围[0,L-1]=[0,7
中的整数。
表3.1 大小为64×64像素的3比特数字图像的灰度分布和直方图值
n pKn)=n/MN
r0
r=1
r?=2 =3
?=4 ?=5
790 0.19
1023
850 0.25 0.21
656
r=6
万=7
329 245 122
0.16
0.08
0.06 0.03
81 0.02
假设图像的直方图如图3.19(a)所示。直方图均衡变换函数的值使用式(3.3-8)得到。例如，
o=TV6)=2D.G)=7p,C6)=133
类似地，有
=TO)=72D,C)=7P(G)+7P,(x)=308
及s?=4.55,s?=5.67,s?=6.23,s?=6.65,s?=6.86,s=7.00。该变换函数的形状为阶梯形状，如图3.19(b)
所示。
在这一点上，s值一直是分数，因为它们是通过求概率值的和产生的，因此我们要把它们近似为最接近
的整数：
So=1.33→1 s?=6.23→6
S?=3.08→3 ss=6.65→7
S?=4.55.→5s?=6.86→7
s?=5.67→6 s=7.00→7
这些是均衡后的直方图的值。很明显，只有5个不同的灰度级。因为o=0被映射为so=1,在均衡后的
图像中有790个像素具有该值(见表3.1)。另外，在图像中有1023个像素取s?=3这个值，有850个像素
取s?=5这个值。然而，r?和r,都被映射为同一个值6,所以在均衡后的图像中有(656+329)=985个像素
取这个值。类似地，在均衡后的图像中有(245+122+81)=448个像素取7这个值。使用MN=4096除这
些数就得到了图3.19(c)所示的均衡后的直方图。
因为直方图是PDF的近似，而且在处理中不允许造成新的灰度级，所以在实际的直方图均衡应用中，
很少见到完美平坦的直方图。因此，不像连续的情况，通常不能证明离散直方图均衡会导致均匀的直方
图。然而，正像您将很快看到的那样，式(3.3-8)具有展开输入图像直方图的趋势，均衡后的图像的灰度
级跨越更宽灰度级范围。最终结果是增强了对比度。
在本节前面，讨论了具有覆盖整个灰度范围的灰度值的许多优点。除了产生有这样的趋势的灰
度之外，刚才推导的方法还有一个额外的优点，即它是完全“自动的”。换句话说，给定一幅图像，
第3章 灰度变换与空间滤波 77
直方图均衡化的处理仅涉及执行式(3.3-8),该式以可直接从已知图像提取的信息为基础，而不需要
更多的参数说明。我们还注意到实现该技术所要求的计算的简单性。
a bcp?(rA) S P?(sA)
0.25 7.0 0.25
0.20 5.6 0.20
0.15 4.2 0.15
0.10 2.8 T() 0.10
0.05 1,4 0.05
r Sk 01 2 34 5 67 01 2 34 567 01 2 34 567
图3.19 3比特(8个灰度级)图像的直方图均衡示例：(a)原始直方图；(b)变换函数；(c)均衡后的直方图
从s回到r的反变换形式表示为
r=T?1(s),k=0,1,2,…,L-1 (3.3-9)
可以证明(见习题3.10),只要灰度级n,k=0,1,2,…,L-1在输入图像中一个也不缺，即图像直方图
中没有哪个分量为0,反变换就满足条件(a)和(b)。尽管反变换不用于直方图均衡，但它在下一节研
究的直方图匹配方案中起核心作用。
例3.6 直方图均衡。
图3.20左边一列显示了来自图3.16的4幅图像，
中间一列显示了对每一幅图像执行直方图均衡后的
结果。从上到下的前三种结果显示了重要的改进效
果。正如所预期的那样，直方图均衡对第四幅图像
未产生太大的效果，这是因为这幅图像的灰度已经
扩展到了全部灰度级范围。图3.21 显示了用于产生
图 3.20中均衡后的图像的变换函数。这些函数是使
用式(3.3-8)产生的。很明显，变换(4)的形状近似为
线性形状，这指出输入被映射为近似相等的输出。
图3.20中的第三列显示了均衡后的图像的直方
图。有趣的是，尽管这些直方图不同，但直方图均衡
后的图像本身在视觉上却是非常相似的。但这并非
是不希望的，因为左边一列图像之间的差异仅仅是对
比度上的，而不是内容上的。换句话说，因为图像有
相同的内容，直方图均衡导致的对比度增强足以补
偿图像在视觉上难以区分灰度级的差别。在给出原
始图像间的重要对比度差别后，该例说明了直方图
均衡作为自适应对比度增强工具的强大作用。 图3.20 左边一列：来自图3.16的图像。
中间一列：均衡后的相应图像。右
3.3.2 直方图匹配(规定化) 边一列：中间一列图像的直方图
如前所述，直方图均衡能自动地确定变换函数，该函数寻求产生有均匀直方图的输出图像。当
需要自动增强时，这是一种好方法，因为由这种技术得到的结果可以预知，并且这种方法实现起来 引～名
引-3
78 数字图像处理(第三版)
也很简单。我们将在本节中指出，对于某些应用，采用均匀直方图的基本增强并不是最好的方法。特
别地，有时我们希望处理后的图像具有规定的直方图形状可能更有用。这种用于产生处理后有特殊直
方图的方法称为直方图匹配或直方图规定化。
255
192
(1) (4)
128
(2)
64 (3)
0
0 64 128 192 255
图3.21 直方图均衡的变换函数。变换(1)到(4)是使用式(3.3-8)
由图3.20左边一列图像(从上到下)的直方图得到的
现在我们暂时回到连续灰度r和z(看成是连续随机变量),并令p,(r)和p?(z)表示它们所对应的
连续概率密度函数。在这种表示方法中，r和z分别表示输入图像和输出(已处理)图像的灰度级。我
们可以由给定的输入图像估计p,(r),而p?(z)是我们希望输出图像所具有的指定概率密度函数。
令s为一个有如下特性的随机变量：
s=T(r)=(L-D?。p,(w)dw (3.3-10)
其中，如前面一样，w为积分假变量。我们发现这个表达式是式(3.3-4)给出的直方图均衡的连续形式。
接着，我们定义一个有如下特性的随机变量z:
G(z)=(L-D?。p:(1)dr=5 (3.3-11)
其中，t为积分假变量。由这两个等式可得G(z)=T(r),因此z必须满足下列条件：
z=G?'[T(r)]=G-'(s) (3.3-12)
一旦由输入图像估计出p,(r),变换函数T(r)就可由式(3.3-10)得到。类似地，因为p?(z)已知，变
换函数G(z)可由式(3.3-11)得到。
式(3.3-10)到式(3.3-12)表明，使用下列步骤，可由一幅给定图像得到一幅其灰度级具有指定概
率密度函数的图像：
1.由输入图像得到p,(r),并由式(3.3-10)求得s的值。
2.使用式(3.3-11)中指定的PDF求得变换函数G(z)。
3.求得反变换函数z=G-1(s);因为z是由s得到的，所以该处理是s到z的映射，而后者正是
我们期望的值。
4.首先用式(3.3-10)对输入图像进行均衡得到输出图像；该图像的像素值是s值。对均衡后的图
像中具有s值的每个像素执行反映射z=G?'(s),得到输出图像中的相应像素。当所有的像
素都处理完后，输出图像的PDF将等于指定的PDF。
第3章 灰度变换与空间滤波 79
例3.7 直方图规定化。
假设采用连续灰度值，并假设一幅图像的灰度PDF为p,(r)=2r/(L-D2,0≤r≤(L-1),对于其他
r值有p,(r)=0。寻找一个变换函数，使得产生的图像的灰度PDF是p?(z)=3z2/(L-D3,0≤z≤(L-),
而对于其他z值有p?(z)=0。
首先，我们对区间[0,L-1]寻找直方图均衡变换：
s=T()=(L-D?。p,owdw=c-J'wdw=-D
由定义可知，对于范围[0,L-1]外的值，该变换为0。输入灰度值的平方除以(L-D)2将产生一幅灰度为s
并具有均匀PDF的图像，因为这是早些时候讨论的直方图均衡变换。
我们感兴趣的是具有规定直方图的图像，因此，我们在[0,L-1]区间寻找下一个直方图均衡变换：
Gi2)=(C-D?。n.(wdv=c-Jwd=C-2
由定义可知在该区间外这个函数也为0。最后，我们要求G(z)=s,但G(z)=z3/(L-1D2;因此
z3/(L-1)2=s,并且有
z=[(L-D2s]/3
如果我们用(L-D2乘以直方图均衡过的每一个像素，取该乘积的1/3次幂，结果将是一幅我们所期望的
图像，该图像在区间[0,L-1]内z的灰度的PDF为p?(z)=3z2/(L-D3。
因为s=r2/(L-1),我们可以直接由输入图像的灰度r生成z:
=IL-P=[a-rc]-[a-0e]"
这样，原图像中每一个像素值的平方与(L-D)相乘，然后再取该乘积的1/3次幂，将得到其灰度级z具有
规定PDF的图像。我们看到，均衡输入图像的中间一步可以跳过；我们需要的是得到将r映射为s的变
换函数T(r)。然后，这两步可以合并为从r到z的一步变换。
正如前边的例子所示，直方图规定化在原理上是简单的。在实践中，一个共同的困难是寻找
T(r)和G?1的有意义的表达式。幸运的是，在处理离散量时，问题可被大大简化。这里仅希望得到
一个近似的直方图.所以，付出的代价与直方图均衡一样。然而，不管这些，可以得到一些非常有用
的结果，尽管结果是粗糙的近似。
式(3.3-10)的离散形式是式(3.3-8)中的直方图均衡变换，为方便起见，我们重写如下：
=TO)=(-D2P.)=-zm,k=0,1.2…,L-1 (3.3-13)
与前面一样，其中MN 是图像的像素总数，n,是具有灰度值r,的像素数，L是图像中可能的灰度级
数。类似地，给定一个规定的s,值，式(3.3-11)的离散形式涉及计算变换函数
G(z)=(L-DLP.(2) (3.3-14)
对一个q值，有
G(Z,)=s (3.3-15) 至;因
园运
80 数字图像处理(第三版)
其中，p?(z)是规定的直方图的第；个值。与前面一样，我们用反变换找到期望的值z:
z=G1(s) (3.3-16)
换句话说，该操作对每一个s值给出一个z值；这样，就形成了从s到z的一个映射。
实践中，我们不需要计算G的反变换。因为我们处理的灰度级是整数(如8比特图像的灰度级是
从0到255),使用式(3.3-14)计算q=0,1.2,…,L-1时的所有可能G值是一件简单的事情。标定这些
值，并四舍五入为区间[0,L-1]内的最接近整数。将这些值存储在一个表中。然后，给定一个特殊的
s,值后，我们可以查找存储在表中的最匹配的值。例如，如果在表中第64个输入接近s,则q=63(注
意，我们是从0开始计数的),故z?是式(3.3-15)的最优解。这样，给定的s值就与z?关联在一起(即
规定的s,值将映射为z?)。因为z项是用于规定的直方图p?(z)作为基础所用的灰度，它遵循
20=0,z=1,…,ZL-1=L-1,因此，z63的灰度值为63。重复该过程，我们将找到每个s,值到z,值的
映射，它们是式(3.3-15)的最接近的解。这些映射也是直方图规定化问题的解。
回忆s,是直方图均衡后的图像的值，我们可以总结直方图规定化过程如下：
1.计算给定图像的直方图p,(r),并用它寻找式(3.3-13)的直方图均衡变换。把s,四舍五入为范
围[0,L-1]内的整数。
2.用式(3.3-14)对q=0,1,2,…,L-1计算变换函数G的所有值，其中p?(z)是规定的直方图的
值。把G的值四舍五入为范围[0,L-1]内的整数。将G的值存储在一个表中。
3.对每一个值&,k=0,1,2,…,L-1,使用步骤2存储的G值寻找相应的z,值，以使G(z,)最接
近s,,并存储这些从s到z的映射。当满足给定s的z,值多于一个时(即映射不唯一时),按
惯例选择最小的值。
4.首先对输入图像进行均衡，然后使用步骤3找到的映射把该图像中的每个均衡后的像素值s
映射为直方图规定化后的图像中的相应z,值，形成直方图规定化后的图像。正如连续情况那
样，均衡输入图像的中间步骤是概念上的。它可以用合并两个变换函数T和G?1跳过这一步，
如例3.8所示。
如早些时候提到的那样，对于满足条件(a')和(b)的G-1.G必须是严格单调的，根据式(3.3-14),
它意味着规定的直方图的任何p?(z)值都不能为零(见习题3.10)。当工作在离散数值的情况时，该条
件可能不满足的事实并不是一个严重的实现问题，如上面的步骤3中指出的那样。下面的例子用数字
说明了这一情况。
例3.8 直方图规定化的一个简单例子。
再次考虑例3.5中大小为64×64的假设图像，其直方图重复显示在图3.22(a)中。希望变换该直方图，
以便使其具有表3.2中第二列规定的值。图3.22(b)显示了该直方图的大概形状。
表3.2 规定直方图和实际直方图(第三列的值来自例3.8中的计算结果)
乙 规定的p,(z) 实际的p,(z)
=0 0.00 0.00
z=1 Z=2
0.00 0.00
0.00 0.00
4=3 0.15 0.19
2=4 0.20 0.25
z=5
4=6
0.30 0.21
0.20 0.24
S=7 0.15 0.11
第3章 灰度变换与空间滤波 81
a b
c d p,(ra) P.(2)
0.30 0.30
0.25 0.25
0.20 0.20
0.15 0.15
0.10 0.10
0.05 0.05
0 23456 7 0 2 34 5 6 7
G(z) P.(Z)
7
6- 0.25
5-
4
0.20
0.15 1
0.10
0.05
0 1 2 3 4 5 67 0 i2 34 567
图3.22 (a)一幅3比特图像的直方图；(b)规定的直方图；(e)从规定的直方图
得到的变换函数；(d)执行直方图规定化的结果。请比较图(b)和图(d)
过程的第一步是得到标定的直方图均衡后的值，就像在例3.5中那样：
So=1 s?=5 s?=6 s?=7
s?=3 s?=6 sy=7 s=7
接着，我们使用式(3.3-14)来计算变换函数G的所有值：
ct)=72D(z)=000
类似地，有
ct)=220(3)=IP()+PdzJ=000
和
G(z?)=0.00,G(Z)=2.45,G(z?)=5.95,G(z?)=1.05,G(z?)=4.55,G(z)=7.00。
如例3.5那样，要把这些分数值转换为有效区间[0.7]内的整数。结果是
G(z?)=0.00→0 G(z?)=2.45→2
G(z)=0.00→0 G(z?)=4.55→5
G(z?)=0.00→0 G(z?)=5.95→6
G(z?)=1.05→1 G(z?)=7.00→7
这些结果总结在表3.3中，变换函数画在图3.22(c)中。观察发现G并不是严格单调的，所以违反了条件
(a')。因此，我们使用算法的步骤3中描述的方法来处理这种情况。
在过程的第三步中，我们找到z的最小值，所以值G(z,)最接近s,。我们对每一个s值这样做，以
产生从s到z所需要的映射。例如，so=1,我们看到G(z?)=1,在这种情况下，这是完美的匹配，因此
我们有对应s?→z。也就是说，直方图均衡后的图像中的每个值为1的像素映射为直方图规定化后的图
像中(相应位置上)的值为3的像素。继续采用这一方法，我们得到表3.4中的映射。 5;引
名～引
82 数字图像处理(第三版)
表3.3 变换函数G关于z的所有
可能值(已四舍五入并排序)
表3.4 将所有的s.值映射到相应的z,值
S 乙 Z。 G(z) 1 3
Z=0 0 3 4
z=1 0
=2 0
5 5
Z=3 1
6 6
Z=4 2 7 7
z=5 5
Z=6 6
Z=7 7
在过程的最后一步中，我们使用表3.4中的映射把直方图均衡后的图像中的每个像素映射为新创建的
直方图规定化图像中的相应像素。结果直方图的值列在表3.2的第三列，直方图画在图3.22(d)中。P?(Z,)
的值是使用例3.5中的相同过程得到的。例如，我们在表3.4中看到，s=1映射为z=3,在直方图均衡后
的图像中有790个像素取1值。因此，p?(z?)=790/4096=0.19。
虽然示于图3.22(d)中的最终结果并不完全与规定的直方图匹配，但我们达到了将灰度明确地移向灰
度级高端的目的。正如早些时候提到的那样，得到直方图均衡后图像的中间步骤对于解释该过程是有帮
助的，但它并不是需要的。相反，我们可以在表中的第三列列出从r到s的映射和从s到z的映射。然后，
我们使用这些映射把原始像素直接映射到直方图规定化后的图像的像素。
例3.9 直方图均衡与直方图匹配的比较。
图3.23(a)显示了火星卫星(Phobos)图像，该图像由NASA的火星表面探测器拍摄。图3.23(b)显示
了图3.23(a)的直方图。图像的大部分是暗色区域，产生了像素集中于灰度级暗端的直方图的特点。乍看
之下，会得到直方图均衡化是增强该图像的一个好办法的结论，以便使暗区域的细节更清楚。下面的讨
论将证明事实并非如此。
a b
7.00
5.25
像素数(×10, 3.50
1.75
0
0 64 128 192 255
灰度
图3.23(a)由NASA的火星表面探测器拍摄的火星卫星(Phobos)图像；(b)直方图(原图像由NASA提供)
图3.24(a)显示了由图3.23(b)所示直方图得到的直方图均衡变换[式(3.3-8)或式(3.3-13)]。这个变
换函数最相关的特征是它从灰度0快速上升到接近190。这是因为输入直方图中有大量的像素灰度接近0。
当这种变换应用于输入图像的灰度，以获得直方图的均衡效果时，最终结果是把非常窄的暗像素区间映
射到输出图像灰度级的高端。因为输入图像的大量像素在此区间有精确的灰度值，所以我们希望结果是
具有明亮、“冲淡”外观的图像。如图3.24(b)所示，情况确实如此。该图像的直方图示于图3.24(c)。注
意，所有灰度级基本上都偏向了灰度范围的上半部。
第3章 灰度变换与空间滤波 83
255
192
输出灰度 128
64
64 128 192 255
输入灰度
7.00
5.25
像素数(×10+) 3.50 a b e
1.75
0
0 64 128 192 255
灰度
图3.24(a)直方图均衡的变换函数；(b)直方图均衡后的图像(注意“冲淡”的外观);(c)图(b)的直方图
由于图3.24(a)中变换函数的问题是由原图像中大量灰度接近于0的像素引起的，一种合理的方法是
修改图像的直方图，以便使其不再有这一属性。图3.25(a)显示了一个人为规定的函数，该函数保持了原
有直方图的基本形状，但在图像灰度暗区的灰度值却有更平滑的过渡。将这个函数取样为256个等间隔
的离散值，就生成了所需的规定的直方图。使用式(3.3-14)从这一直方图得到的变换函数G(z),该变换
在图3.25(b)中标注为变换(1)。类似地，由式(3.3-16)(使用前面讨论的逐步过程得到)导出的反变换函
数G?'(s)在图3.25(b)中标注为变换(2)。图3.25(c)中增强后的图像是把变换(2)用于图3.24(b)中直方图
均衡化后的图像的像素得到的。比较这两幅图像可以看出，在使用直方图均衡得到的结果的基础上，直方
图规定化图像的改进是很明显的。注意，原始直方图的细小改变会使图像的外观得到显著改进。图3.25(d)
显示了图3.25(c)的直方图。该直方图最容易辨别的特征是其低端已向右移向灰度级的较亮区域(但并不过
分),这正是我们所希望的。
到目前为止，虽然我们对直方图规定化已经很清楚了，但在结束这一节之前，我们要强调直方
图规定化在大多数时候都是试凑过程。这正像前边的例子中我们所做的那样，一个可用的指导路线是
用手边的问题学习。但是，有时可能会遇到这样的情况，即定义“平均”直方图的外观，并把它作为
规定的直方图。在这种情况下，直方图规定化就变成了一种直接的处理。然而，一般来说，并没有规
定直方图的规则，对于任何一个给定的增强任务都必须借助于实际分析。
3.3.3 局部直方图处理
前两节讨论的直方图处理方法是全局性的，在某种意义上，像素被基于整幅图像的灰度分布的变
换函数修改。虽然这种全局方法适用于整个图像的增强，但存在这样的情况，增强图像中小区域的细
节也是需要的。这些区域中，一些像素的影响在全局变换的计算中可能被忽略了，因为全局变换没有
必要保证期望的局部增强。解决方法是以图像中每个像素的邻域中的灰度分布为基础设计变换函数。 同～密
161
84 数字图像处理(第三版)
a c 7.00 h
d
像数数(×105 5.25
3.50
1.75
0
0 64 128 192 255
灰度 255
192
输出灰度 (1)-
128
(2)
64
哈
图3.25(a)规定的直方图；(b)变换；
64 128 192 255
输入灰度
7.00
(c)使用曲线(2)映射得到的
增强图像；(d)图(c)的直方图
5.25 像素数(×10) 3.50
1.75
0
0 64 128 192 255
灰度
前面描述的直方图处理技术很容易适应局部增强。该过程是定义一个邻域，并把该区域的中心
从一个像素移至另一个像素。在每个位置，计算邻域中的点的直方图，并且得到的不是直方图均衡化，
就是规定化变换函数。这个函数最终用于映射邻域中心像素的灰度。然后，邻域的中心被移至一个相
邻像素位置，并重复该过程。当邻域进行逐像素平移时，由于只有邻域中的一行或一列改变，所以可
在每一步移动中，以新数据更新前一个位置得到的直方图(见习题3.12)。这种方法与区域每移动一个
像素位置就计算邻域中所有像素的直方图相比有明显的优点。有时用于减少计算量的另一种方法是使
用非重叠区域，但这种方法通常会产生我们不希望的“棋盘”效应。
例3.10 局部直方图均衡。
图3.26(a)显示了一幅大小为512×512的8比特图像，初看之下，该图像在灰色背景上包含5个黑色
方块。图像有轻微的噪声，但是噪声感觉不到。图3.26(b)显示了全局直方图均衡的结果。当用直方图均
衡平滑噪声区域时，情况经常如此。该图像显示噪声明显地增强了。然而，除了噪声之外，图3.26(b)与
原图像相比并未显示新的重要细节，只是不明显地给出了左上方和右下方方块中包含有一个物体。图3.26(c)
是使用大小为3×3的邻域的局部直方图均衡得到的。这里，我们看到了包含在暗色方块中的物体。这些
物体的灰度值太接近大方块的灰度，而且它们太小，全局直方图均衡化不足以影响这些细节的显示。
和
2=22ICy-m2 (3.3-21)
其中，x=0,1,2,…,M-1,y=0,1,2,…,N-1。换句话说，众所周
知，一幅图像的平均灰度可以由求所有像素的灰度值之和并用图像中
的像素总数去除而得到。类似的解释适用于式(3.3-21)。如下面的例
子所示，使用这两个公式得到的结果等同于使用式(3.3-18)和式(3.3-19)
第3章 灰度变换与空间滤波 85
a bc
图3.26(a)原图像；(b)全局直方图均衡的结果；(c)使用大
小为3×3的邻域对图(a)应用局部直方图均衡的结果
3.3.4 在图像增强中使用直方图统计
直接从直方图获得的统计参数可用于图像增强。令r表示在区间[0,L-1]上代表灰度值的一个离
散随机变量，并令p(r)表示对应于r,值的归一化直方图分量。如前面指出的那样，我们可以把p(r)
看成是得到直方图的那幅图像的灰度r出现的概率的估计。
像2.6.8节讨论的那样，r关于其均值的n阶矩定义为
H.()=20-m°nr) (3.3-17)
其中，m是r的均值(平均灰度，即图像中像素的平均灰度):
m=2m) (3.3-18)
二阶矩特别重要：
A?()=2w-m2P)
我们遵守使用m来表示均值的约
定。请不要将它与用于表示一个大
小为mxn的邻域的行数的相同符号
混淆，因为在表示邻域的行数时。
我们也遵守了符号表示约定。
(3.3-19)
我们将该表达式称为灰度方差，通常用σ2表示(回忆一下，标准差是方差的平方根)。均值是平均灰
度的度量，方差(或标准差)是图像对比度的度量。显然，一旦从给定的图像得到了直方图，用前边的
表达式就很容易计算所有的矩。
在仅处理均值和方差时，实际上通常直接从取样值来估计它们，而不必计算直方图。近似地，
这些估计称为取样均值和取样方差。它们可以根据基本的统计学由下面熟悉的形式给出：
m=六Z2r(x》 (3.3-20)
式(33-21)中的分母有时写为
式(33-19)[在后一公式中的直方图
是由式(33-21)使用的同一幅图像计
MN-1而不是MN 这样做的目
算得到的时]一致更感兴趣。因此，
的是获得方差的一个所谓的无偏
我们要求 MN项。对于实际大小的
估计。但是，我们对式(3.3.21)和
任何图像，差别可以忽略不计。 医;同
臣;同
86 数字图像处理(第三版)
得到的结果，前提是这些公式中使用的直方图是由式(3.3-20)和式(3.3-21)中使用的同一幅图像计算
得到的。
例3.11 直方图统计计算。
在继续讨论之前，通过一个简单的数字例子巩固一下概念是有必要的。考虑下面的大小为5×5的2
比特图像：
0 0 1 1 2
12301
33220
23100
11322
像素由2比特表示；因此，L=4且灰度级在[0,3]范围内。总像素数是25,因此，直方图分量为
P(G)=2=0.24,p(n)=2=0.28
P(?)=2=0.28,p(s)=5=0.20
其中，p(r)中的分子是具有灰度级r的图像中的像素数。我们可用式(3.3-18)计算图像中灰度级的平均值：
m=2mt)=OK024)+0x028)+(2x028)+(3020)=144
令f(x,y)表示前面的5×5阵列，使用式(3.3-20)我们得到
m-去22rua=144
如期望的那样，结果一致。类似地，使用式(3.3-19)或式(3.3-21)得到的方差相同(均为1.1264)。
我们考虑用于增强目的的均值和方差的两种应用。全局均值和方差是在整幅图像上计算的，这
对于全面灰度和对比度的总体调整是有用的。这些参数的一种更强有力的应用是局部增强，在局部增
强中，局部均值和方差是根据图像中每一像素的邻域内的图像特征进行改变的基础。
令(x,y)表示给定图像中任意像素的坐标，S。表示规定大小的以(x,y)为中心的邻域(子图像)。
该邻域中像素的均值由下式给出：
m.=2mP() (3.3-22)
其中，ps,是区域S。中像素的直方图。该直方图有L个分量，对应于输入图像中L个可能的灰度值。
然而，许多分量是0,具体取决于S。的大小。例如，如果邻域大小为3×3且L=256.那么该邻域的
直方图的256个分量中仅1和9之间的分量非零。这些非零值将对应S。中的不同灰度数(在3×3区
域中可能的不同灰度的最大数是9,最小数是1)。
类似地，邻域中像素的方差由下式给出：
吃=20-m,Pp?(C) (3.3-23)
和前面一样，局部均值是邻域S。中平均灰度的度量，局部方差(或标准差)是邻域中灰度对比度的度
第3章 灰度变换与空间滤波 87
量。对邻域，我们可写出类似于式(3.3-20)和式(3.3-21)的表达式，即简单地对邻域中的像素值求和，
并除以邻域中的像素数。
正如下面的例子说明的那样，使用局部均值和方差进行图像处理的一个重要方面是它的灵活性，它
们提供了简单而强有力的基于统计度量的增强技术，而统计度量与图像的外观有紧密的、可预测的关系。
例3.12 使用直方图统计的局部增强。
图3.27(a)显示了一根绕在支架上的钨丝的SEM(扫描电子显微镜)图像。图像中央的钨丝及其支架很
清楚并很容易分析。在该图像的右侧即图像的暗侧，有另一根钨丝的结构，但几乎不能察觉到，其大小
和特征当然也不容易辨认。通过对比度操作进行局部增强是解决这种图像中包含部分隐含特征问题的理
想方法。
a b c
图3.27(a)放大了约130倍的钨丝的SME图像；(b)全局直方图均衡的结果；(c)使用局部直
方图统计增强后的图像(原图像由俄勒冈大学地质科学系的Michael Shaffer先生提供)
在这种特殊情况中，问题是增强暗色区域，但同时尽可能保留明亮区域不变，因为明亮区域并不需
要增强。我们可以使用本节介绍的概念来阐明一种增强方法，这种方法能分辨暗区域与亮区域的不同，
同时只增强暗区域。判断一个区域在点(x,y)是暗还是亮的方法是把局部平均灰度ms。与表示为m。并称
之为全局均值的平均图像灰度进行比较。这种量可使用整个图像并用式(3.3-18)或式(3.3-20)得到。这样，
我们就有了增强方案的基础：如果m,≤komg,其中k。是一个值小于10的正常数，那么我们将把点
(x,y)处的像素考虑为处理的候选点。
因为我们感兴趣的是增强低对比度的区域，所以还需要一种度量方法来确定一个区域的对比度是否
可作为增强的候选点。因此，如果σs,≤k?og,则认为在点(x,y)处的像素是增强的候选点，其中σg是
由式(3.3-19)或式(3.3-21)得到的全局标准差，k?为正常数。如果我们的兴趣是增强亮区域，则该常数大
于1.0,对于暗区，则小于1.0。
最后，我们需要限制能够接受的最低的对比度值，否则该过程会试图增强标准差为零的恒定区域。
因此，我们通过要求ko?≤0s,k?<k?,对局部标准差设置一个较低的限制值。满足局部增强所有条件
的一个位于点(x,y)处的像素，可简单地通过将像素值乘以一个指定常数E来处理，以便相对于图像的其
他部分增大(或减小)其灰度值。不满足增强条件的像素则保持不变。
以上增强方法可总结如下：令f(x,y)表示在图像任意坐标(x,y)处的像素值，而令g(x,y)表示这些
坐标处相应的增强的像素值，则对于x=0,1,2,…,M-1,y=0,1,2,…,N-1,有
u)-(ay ms≤koma且kog≤os,≤k?c
其他 (3.3-24)
其中，如前所述，E,ko,k?和k?是规定的参数；m。是输入图像的全局均值；o?是输人图像的标准差。
参数ms。和σs,分别是局部均值和标准差。按惯例，M和N是图像行和列的维数。 层到
8-1
88 数字图像处理(第三版)
通常，式(3.3-24)中选择参数需要做一些试验，以熟悉一幅给定的图像或一类图像。在这种情况下，
常常选择下列数值：E=4.0,k?=0.4,k?=0.02和k?=0.4。之所以对E选择相对较低的值4.0,原因在于
当E与将被增强区域(暗色区域)中的灰度相乘后，结果仍会趋于灰度级的暗端，从而保持图像的视觉平
衡。选择的k。值比全局均值的一半略小，因为我们观察一幅图像时，我们了解到需要增强的区域确实比
全局平均值的一半还要暗。类似的分析可指导 k,和k?值的选择。这些常数的选择通常并不困难，但这些
明确的选择必须以对具体增强问题的逻辑分析为指导。最后，为保留细节和尽量减少计算负担，局部区
域S,的大小应尽可能小。因此，我们选择大小为3×3的小区域。
作为比较的基础，我们使用全局直方图均衡增强一幅图像。图3.27(b)显示了这一结果。暗区域被改
进了，但辨别细节还是很困难，亮区域也变化了，这是我们不想做的事情。图3.27(c)显示了使用上面描
述的局部统计方法处理的结果。该图像与图3.27(a)中的原图像或图3.27(b)中经直方图均衡后的结果相比，
我们注意到，图3.27(c)的右边显示出了明显的细节。观察该例子，暗灯丝中的脊线现在非常清楚。值得
注意的是，左侧的亮灰度区域被完整地保留了，这是我们的初始目的之一。
3.4 空间滤波基础
在这一节，我们介绍空间滤波图像处理的几个基本概念。空间滤波是图像处理领域应用广泛的
主要工具之一。因此，我们应充分理解这些基本概念。正如在本章开始时提到的那样，本节的例子多
数涉及使用空间滤波来增强图像。空间滤波的其他应用将在后面几章中讨论。
滤波一词借用于频域处理，频率域处理是下一章的主题，在下一章中，“滤波”是指接受(通过)
或拒绝一定的频率分量。例如，通过低频的滤波器称为低通滤波器。低通滤波器的最终效果是模糊
(平滑)一幅图像。我们可以用空间滤波器(也称为空间掩模、核、模 关于线性的讨论，请参阅262节。 板和窗口)直接作用于图像本身而完成类似的平滑。事实上，如第 4
章所示，线性空间滤波与频率域滤波之间存在一一对应的关系。然而，空间滤波可提供相当多的功能，
就像您稍后将要看到的那样，它们还可用于非线性滤波，而这在频率域中是做不到的。
3.4.1 空间滤波机理
在图3.1中，我们简单解释过，空间滤波器由(1)一个邻域(典型地是一个较小的矩形),(2)对该
邻域包围的图像像素执行的预定义操作组成。滤波产生一个新像素，新像素的坐标等于邻域中心的坐
标，像素的值是滤波操作的结果①。滤波器的中心访问输入图像中的每个像素，就生成了处理(滤波)
后的图像。如果在图像像素上执行的是线性操作，则该滤波器称为线性空间滤波器。否则，滤波器
就称为非线性空间滤波器。首先，我们重点关注线性滤波器，然后，说明某些简单的非线性滤波器。
5.3节将包含更多的非线性滤波器及其应用的更全面的内容。
图3.28说明了使用3×3邻域的线性空间滤波的机理。在图像中的任意一点(x,y),滤波器的响应
g(x,y)是滤波器系数与由该滤波器包围的图像像素的乘积之和：
g(x,y)=w(-1,-Df(x-1,y-1)+w(-1,0)f(x-1,y)+…+w(0,0)f(x,y)+…+w(L,D)f(x+L,y+1)
很明显，滤波器的中心系数 w(0,0)对准位置(x,y)的像素。对于一个大小为m×n的模板，我们假设
m=2a+1且n=2b+1,其中a,b为正整数。这意味着在后续的讨论中，我们关注的是奇数尺寸的滤
①滤波后的像素值通常会赋给新创建图像中的对应位置，以容纳滤波的结果。滤波后的像素代替原图像中对应位置的值的情形很
少见，因为这会在改变图像内容的同时执行滤波操作。
第3章 灰度变换与空间滤波 89
波器，其最小尺寸为3×3。一般来说，使用大小为mxn的滤波器对
大小为M×N的图像进行线性空间滤波，可由下式表示：
8(x,)=2msDf(x+3.y+)
当然，也可以使用偶数尺寸的滤
波器，或使用混合有偶数尺寸和奇数
尺寸的滤波器。但是，使用奇数尺寸
的滤波器可简化索引、并更为直观.
因为滤波器的中心落在整数值上。
其中，x和y是可变的，以便w中的每个像素可访问f中的每个像素。
一图像原点
滤波器模板
图像像素-
图像
/x-1.y-1)
f(r,y-1)
/x+L.y-1)
滤波器下方的
图像部分的像素
图3.28 使用大小为3×3的滤波器模板的线性空间滤波的机理。表示
滤波器模板系数的坐标所选择的形式简化了线性滤波的表达式
3.4.2 空间相关与卷积
在执行线性空间滤波时，必须清楚地理解两个相近的概念。一个是相关，另一个是卷积。如前
节描述的那样，相关是滤波器模板移过图像并计算每个位置乘积之和的处理。卷积的机理相似，但滤
波器首先要旋转180°。解释这两个概念的区别的最好方法是举一个例子。我们从一个一维示例开始。
图3.29(a)显示了一个一维函数f和一个滤波器w,图3.29(b)显示了执行相关的起始位置。我们
注意到的第一件事情是存在未覆盖的部分函数。该问题的解决办法是在f的任意一侧补上足够的0,
以便使w中的每一个像素都可访问到f中的每一个像素。如果滤波器 零填充并不是唯一的选择。例如。 的尺寸是m,那么我们需要在f的一侧补m-1个0。图3.29(c)显示 我们可在f的两侧复制第一个元素和
了适当填充过的函数。相关的第一个值是如图3.29(c)所示的初始位 最后一个元素m-1次，或镜像第一
个元素和最后一个元素m-1次、并 置的f和w的乘积之和(乘积之和为0)。这相当于位移x=0。为了得
为填充使用镜像后的值 到相关的第二个值，我们把 w 向右移动一个像素位置(位移x=1),
并计算乘积之和。结果还是0。事实上，当x=3时才第一次出现非零结果，在这种情况下，w中的8
覆盖f中的1,相关的结果是8。按这种方法进行，我们可以得到图3.29(g)中的全部相关结果。注意。
x取了12个值(即x=0,1,2,…,11)使w滑过f,以便w中的每一个像素访问f中的每一个像素。通
e(-1,0) e(-1.1 u(-1,-1
e(0.-1|w(0.0 e(0.1)
w(1.-1| w(1.0) e(1.1)
fux-1.y) /(x-1.y+1 滤波器系数
f(,y) (x,y+1)
fx+1.y) /ux+1.y+1)
复～可
;至
90 数字图像处理(第三版)
常，我们喜欢使用大小与f相同的相关阵列，在这种情况下，我们将全部相关结果裁剪到原函数大小，
如图3.29(h)所示。
相关 卷积
8。(a) 12328 —原点 00010000
旋转了180°的w
82321(i)
(b) 00010000 J)
82321
零填充 0100 0000000100000000(k)
82321
(d) 0000000100000000
12328 t移动一次后的位置
0000000100000000(1)
82321
(e)0000000100000000
12328
0000000100000000(m)
82321
移动四次后的位置
() 0000000100000000
12328
最终位置
0000030100000000(n)
82321
(g)
全部相关结果
000823210000
全部卷积结果
000123280000 (o)
裁剪后的相关结果 载剪后的卷积结果
(h) 08232100 01 232800 (p)
图3.29 具有离散单位冲激的滤波器的一维相关与卷积的说明
从前一段的讨论可知，有两个要点需要注意，第一，相关是滤波器位移的函数。换句话说，相
关的第一个值对应于滤波器的零位移，第二个值对应于一个单元位移，等等。第二，滤波器w与包
含有全部0和单个1的函数相关，得到的结果是w的一个拷贝，但旋转了180°。我们将包含单个1
而其余都是0的函数称为离散单位冲激。因此，我们得出结论：一个函数与离散单位冲激相关，在该
冲激位置产生这个函数的一个翻转的版本。
卷积的概念是线性系统理论的基石。正如您将在第4章学到的那样，卷积的基本特性是某个函
数与某个单位冲激卷积，得到一个在该冲激处的这个函数的拷贝。在前一段中我们看到，相关操作也
得到函数的一个拷贝，但该拷贝旋转了180°。因此，如果我们预先旋转滤波器，并执行相同的滑动
乘积求和操作，就应该能得到希望的结果。如图3.29右边一列所示的 注意，旋转180°等同于水平翻转 那样，情况的确如此。由此，我们看到，为了执行卷积，我们需要做 该函数。
的是把一个函数旋转180°,然后执行相关中的相同操作。正如其结果
所示，我们旋转两个函数的做法没有区别。
如图3.30所示，前面的概念很容易扩展到图像。对于大小为m×n的滤波器，我们在图像的顶部和
第3章 灰度变换与空间滤波 91
底部至少填充m-1行0,在左侧和右侧填充n-1列0。在这种情况下，m和n等于3.因此，如图3.30(b)
所示，我们用两行0填充图像的顶部和底部，用两列0填充图像的左侧和右侧。图3.30(c)显示了执行
相关操作的滤波器模板的初始位置，图3.30(d)显示了所有相关操作的结果。图3.30(e)显示了裁剪后
的相应结果。再一次注意到，结果旋转了180°。对于卷积，与前面一样，我们预先旋转模板，然后
使用刚才描述的方法对乘积做滑动求和操作。图3.30f)到(h)显示了
结果。您再次看到，一个函数与一个冲激卷积，在该冲激的位置复制
了这个函数。这很清楚，如果滤波器模板是对称的，相关和卷积将得
到相同的结果。
填充后的/
00
原点f(x,y)
0 0)
1 123 w(x,y) 0 0在0 0
000000000
0
456
789
0000000
0:0000a000
(a)
位
(b)
全部相关结果 裁剪后的相关结果
0 0:10100
14 5 6i —8— 9870
h 06 54住 0t0321
00t0
00
000 在 u
000 00D
-0t0 000作
(c) (d)
在二维情况下，旋转180°等同于
沿一个坐标轴翻转模板、然后沿另
一个坐标轴再次翻转模板。
(e)
一旋转后的w 全部卷积结果 裁剪后的卷积结果
98-元 00
i6 5 01230 4560
07890
000难
000 00000
00000 注在000
000000 000
(1) (g) (h)
图3.30 二维滤波器与二维离散单位冲激的相关(中间一行)和卷积(最后一行)。为便于视觉分析，0显示为灰色
替代包含单个1,如果图3.30中的图像f包含一个与w完全相等的区域，当w位于f的区域的
中心时，相关函数(归一化后)的值将是最大的。这样，正像您将在第 12章看到的那样，相关还可以
用于寻找图像中的匹配。
以公式形式总结一下前面的讨论。一个大小为m×n的滤波器w(x,y)与一幅图像f(x,y)做相关
操作，可表示为w(x,y)☆f(x,y),它由上一节末尾列出的公式给出，为方便起见我们重写如下：
Mx,ykrox,y=2Zws.0fx+3,y+) (3.4-1)
这一等式对所有位移变量x和y求值，以便w的所有元素访问f的每一个像素，其中我们假设厂已被园
170
92 数字图像处理(第三版)
适当地填充。正如早些时候解释的那样，a=(m-D)/2,b=(n-1/2,同时，为表示方便，我们假设
m和n是奇整数。
类似地，w(x,y)和f(x,y)的卷积表示为w(x,y)★f(x,y)①,它由下式给出：
Mx.y)*f(x,)=Zms.Dfx-5,y-) (3.4-2)
其中等式右侧的减号表示翻转f(即旋转180°)。为简化符号表示，我
们遵循惯例，翻转和移位 w而不是f。结果是一样的。与相关一样，
该式也对所有位移变量x和y求值，因此，w的每一个元素访问f中的每一个像素，同样我们也假设
f已被适当地填充了。您可以对3×3模板展开式(3.4-2),并自己证明使用该式的结果与图3.30中的例
子是一样的。在实践中，我们常常用一个算法实现式(3.4-1)。如果我们想要执行相关，可将w输入
到算法中；如果要执行卷积，可将旋转180°后的w输入到算法中。反过来，如果代之以执行式(3.4-2)
也是可用的。
如之前提及的那样，卷积是线性系统理论的基础。我们将在第 4章中学到，一个函数与单位冲
激的卷积，相当于在单位冲激的位置处复制该函数，这一特性在大量重要的推导中扮演核心的角色。
我们将在第 4章关于傅星叶变换和卷积定理的内容中再次回顾卷积。然而，不像式(3.4-2),我们将
要处理的卷积是相同尺寸的。公式的形式是一样的，但求和限不一样。
使用相关或卷积执行空间滤波是优先选择的方法。事实上，因为无论是式(3.4-1)还是式(3.4-2),
都可以通过简单地旋转滤波器去执行其功能，重要的是在给定的滤波任务中，按对应于期望操作的方
式来指定滤波器模板。本章中的所有线性空间滤波结果都基于式(3.4-1)。
最后，我们指出，在图像处理文献中，您很可能会遇到卷积滤波器、卷积模板或卷积核这些术
语。按惯例，这些术语用来表示一种空间滤波器，并且滤波器未必用于真正的卷积。类似地，模板与
图像的卷积通常用于表示我们刚刚讨论的滑动乘积求和处理，而不必区分相关与卷积间的差别。更合
适的是，它通常用于表示两种操作之一。这一不太严密的术语是产生混淆的根源。
3.4.3 线性滤波的向量表示
当我们的兴趣在于相关或卷积的模板的响应特性R时，有时写成乘积的求和形式是方便的：
R=Wz+略3+…--2wz=wz (3.4-3)
其中w项是一个大小为mxn的滤波器的系数，z为由滤波器覆盖的相
应图像的灰度值。如果我们的兴趣是使用式(3.4-3)来做相关，我们可用
给定的模板。为了使用相同的公式进行卷积操作，如上节描述的那样，
我们可以简单地把模板旋转180°。它意味着式(3.4-3)对特定的坐标对(x,y)
是成立的。在下一节中，您将了解为什么这一表示法对于描述给定的线
性滤波器的特性是方便的。
通常，在含义明确的情况下，我们用
式和式(35-1)
函数g(x,y)而不用w(x,yf(x,y)
或w(x.y)★/(x,y)来表示相关或卷积
的结果。例如，参见前一节末尾的等
关于向量和矩阵的基本知
识，请读者查阅本书网站上的
Tutorials部分。
w 2
4 s
m1
作为一个例子，图3.31显示了一个带有标号的普通3×3模板。在这
种情况下，式(3.4-3)变为
图3.31 普通3×3滤波器
模板的另一种表示
①因为卷积满足交换律，故有w(x,y)★f(x.y)-f(x,y)★w(x,y)。相关则不满足交换律，这一点可通过颠倒图3.29(a)中函数的
顺序看出
第3章 灰度变换与空间滤波 93
R=Mz+2+…+3=z=w22 (3.4-4)
其中，w是由模板的系数形成的9维向量，z是由模板包含的图像灰度形成的9维向量。
3.4.4 空间滤波器模板的产生
生成一个大小为m×n的线性空间滤波器要求指定mn 个模板系数，这些系数是根据该滤波器支
持什么样的操作来选择的，记住，我们使用线性滤波所能做的所有事情是实现乘积求和操作。例如，
假设我们想要将图像中的这些像素替换为以这些像素为中心的3×3邻域的平均灰度。在图像中任意
位置(x,y)的灰度平均值是以(x,y)为中心的3×3邻域中的9个灰度值之和除以9。令z,i=1,2,…,9
表示这些灰度，那么平均灰度为
R=2
但该式与系数值为w,=1/9的式(3.4-4)相同。换句话说，使用系数为1/9的3×3模板进行线性滤波操
作可实现所希望的平均。正如我们在下一节中将要讨论的那样，这一操作将导致图像平滑。在下面几
节中，我们讨论基于这种方法的其他几个滤波器模板。
在某些应用中，我们有一个具有两个变量的连续函数，其目的是基于该函数得到一个空间滤波
模板。例如，一个具有两个变量的高斯函数有如下基本形式：
h(x,y)=e
其中，σ是标准差，并且，通常我们假设坐标x和y是整数。譬如，为了从该函数产生一个大小为
3×3的滤波器模板，我们关于其中心进行取样。这样，就有w=h(-1,-1),w?=h(-1,0),…,
wg=h(1.1)。使用类似的方式可产生一个m×n滤波器模板。回顾一下，二维高斯函数具有钟形形状，
并且其标准差控制钟形的“紧度”。
产生非线性滤波器要求我们确定邻域的大小，以及将对包含在邻域内的图像像素执行的操作。
例如，回忆可知最大操作是非线性的(见2.6.2节),以一幅图像中任意一点(x,y)为中心的一个5×5最
大滤波器得到25个像素中的最大灰度值，并将该值赋给处理后图像中位置为(x,y)的像素。非线性
滤波器功能非常强大，正如我们在本章稍后和第5章中所显示的那样，在某些应用中它可执行超出线
性滤波器能力的功能。
3.5 平滑空间滤波器
平滑滤波器用于模糊处理和降低噪声。模糊处理经常用于预处理任务中，例如在(大)目标提取
之前去除图像中的一些琐碎细节，以及桥接直线或曲线的缝隙。通过线性滤波和非线性滤波模糊处理，
可以降低噪声。
3.5.1 平滑线性滤波器
平滑线性空间滤波器的输出(响应)是包含在滤波器模板邻域内的像素的简单平均值。这些滤波
器有时也称为均值滤波器。正如前节提到的那样，也可以把它们归入低通滤波器。
平滑滤波器的基本概念非常直观。它使用滤波器模板确定的邻域内像素的平均灰度值代替图像
中每个像素的值，这种处理的结果降低了图像灰度的“尖锐”变化。由于典型的随机噪声由灰度级
173
174
94 数字图像处理(第三版)
的急剧变化组成，因此，常见的平滑处理应用就是降低噪声。然而，由于图像边缘(几乎总是一幅图
像希望有的特性)也是由图像灰度尖锐变化带来的特性，所以均值滤波处理还是存在着不希望有的边
缘模糊的负面效应。另外，这类处理的其他应用包括如2.4.3节讨论过的由于灰度级数量不足而引起
的伪轮廓效应的平滑处理。均值滤波器的主要应用是去除图像中的不相关细节，其中“不相关”是指
与滤波器模板尺寸相比较小的像素区域。这将在这一节稍后的应用中加以说明。
图3.32显示了两个3×3平滑滤波器。第一个滤波器产生模板下方的标准像素平均值。把模板系
数代入式(3.4-4)即可清楚地看出这一点：
R=2
R是由模板定义的3×3邻域内像素灰度的平均值。注意，代替上式中的1/9,滤波器的系数全为“1”。
这里的概念是系数取1值时计算更有效。在滤波处理之后，整个图像除以9。一个mxn模板应有等
于1/mn的归一化常数。所有系数都相等的空间均值滤波器有时称为盒状滤波器。
图3.32所示的第二个模板更为重要一些。该模板产生所谓的加权平均，使用这一术语是指用不同
的系数乘以像素，即一些像素的重要性(权重)比另一些像素的重要性更大。在图3.32(b)所示的模板
中，处于该模板中心位置的像素所乘的值比其他任何像素所乘的值都要大，因此，在均值计算中为该
像素提供更大的重要性。其他像素如同是模板中心距离的函数那样赋以成反比的权重。由于对角项离
中心比离正交方向相邻的像素(参数为√2)更远，所以它的权重比与中心直接相邻的像素更小。赋予
中心点最高权重，然后随着距中心点距离的增加而减小系数值的加权策略的目的是在平滑处理中试图
降低模糊。我们也可以选择其他权重来达到相同的目的。然而，图3.32(b)所示模板中所有系数的和
等于16,对于计算机计算来说是一个有吸引力的特性，因为它是2的整数次幂。在实践中，由于这
些模板在一幅图像中任何一个位置所跨过的区域很小，通常很难看出使用图3.32中的各种模板或类似
方式进行平滑处理后的图像之间的区别。
;因
1 1 1
1 1
1 1 1
1 2 1
2 4 2
1 2 1
a b
贵×[ 1 话×
图3.32 两个3×3平滑(均值)滤波器模板。每个模板前面的乘
数等于1除以所有系数之和，这是计算平均值所要求的
参见式(3.4-1),一幅M×N的图像经过一个大小为m×n(m和n是奇数)的加权均值滤波器滤波
的过程可由下式给出：
(3.5-1)
上式中的参数见式(3.4-1)中的定义。正如前面说过的那样，它可以这样理解，即一幅完全滤波的图
像是通过对x=0,1,2,…,M-1和y=0.1,2,…,N-1执行式(3.5-1)得到的。式(3.5-1)中的分母部分
简单地表示为模板的各系数之和，它是一个仅需计算一次的常数。
第3章 灰度变换与空间滤波 95
例3.13 使用各种尺寸模板的图像平滑。
与滤波器模板尺寸有关的图像平滑效果如图3.33所示，图中显示了一幅原图像以及分别用尺寸为m=3,
5,9,15和35像素的方形均值滤波器得到的相应平滑结果。这些结果的主要特点如下：当m=3时，可以观
察到在整幅图像中有轻微的模糊，但正如所希望的那样，当图像细节与滤波器模板近似相同时，图像中一
些细节受到的影响比较大。例如，图像中的3×3与5×5黑方块、较小的字母“a”和细颗粒噪声，与图像
的其他部分相比，要更模糊一些。注意，噪声显著地降低了，字母的锯齿状边缘也令人满意地被平滑了。
m=5时的结果基本类似，但模糊程度稍微有所增加。在m=9时，可以明显地看出图像更加模糊，
而且有20??黑色圆圈几乎不能像在前三幅图像中那样与背景明显地区分开来，这表明当目标的灰度与
其相邻像素的灰度接近时，会导致模糊目标的混合效应。m=15和35时，就图像中目标物的尺寸来说，
已属极端情况。这种极端类型的模糊处理通常用于去除图像中的一些小物体。例如，在图3.35(1中，三个
小方框、两个小圆圈以及大部分噪声矩形区域已融入到背景中。注意，在这幅图中还有明显的黑的边界。
这是我们用0(黑色)填充原图像的边界，经过滤波后再去除填充区域的结果。某些黑色混入了所有滤波后
的图像，但对于使用较大滤波器平滑的图像，这就成为问题了。
…a …a ∴a
aa a a a a aa a aaa a a a a aa a a a a a
…a
aaaa aa
…a
aaa a 步 dei
图3.33(a)大小为500×500像素的原图像；(b)-(f用大小分别为m=3,5,9,15和35的方形均值滤波模板平滑
处理的结果。顶部的黑色方块大小分别为3,5,9.15,25,35,45和55个像素，它们的边界相隔25个像素。
底部字母的大小在10点到24点之间，增量为2个点；顶部的最大字母为60点。垂直线段条宽为5个像
素，高为100个像素，线条间距为20个像素。圆的直径为25个像素，它们的边界相隔15个像素，灰度
级为0?100??黑色范围内，以20??加。图像背景为黑色的10??噪声矩形区域大小为50×120像素
正像早些时候提到的那样，空间均值处理的一个重要应用是为了对感兴趣的物体得到一个粗略
的描述而模糊一幅图像，这样，那些较小物体的灰度就与背景混合在一起了，较大物体变得像“斑点”
而易于检测。模板的大小由那些即将融入背景中的物体尺寸来决定。作为实例，考虑图3.34(a),它
是绕地轨道上的哈勃望远镜拍摄的一幅图像。图3.34(b)显示了应用15×15均值滤波器模板对该图像
处理后的结果。我们可以看到，图像中的一些部分或者融入背景中，或者其亮度明显降低了。像这样
利用阈值处理并基于物体亮度来消除某些物体的操作是很典型的。使用等于模糊图像最高亮度25%
的阈值，并用图3.2(b)的阈值函数处理的结果示于图3.34(c)中。将该结果与原图像比较，我们看到，
考虑图像中最大、最亮物体的表达方式是合理的。 m1
退;臣
96 数字图像处理(第三版)
ab e
图3.34 (a)来自哈勃太空望远镜的大小为528×485像素的图像；(b)由15×15均值模
板滤波过的图像；(c)对图(b)进行阈值处理后的结果(原图像由NASA提供)
3.5.2 统计排序(非线性)滤波器
统计排序滤波器是一种非线性空间滤波器，这种滤波器的响应以滤波器包围的图像区域中所包
含的像素的排序(排队)为基础，然后使用统计排序结果决定的值代替中心像素的值。这一类中最知名
的滤波器是中值滤波器，正如其名暗示的那样，它是将像素邻域内灰度的中值(在中值计算中包括原
像素值)代替该像素的值。中值滤波器的使用非常普遍，这是因为对于一定类型的随机噪声，它提供
了一种优秀的去噪能力，而且比相同尺寸的线性平滑滤波器的模糊程度明显要低。中值滤波器对处理
脉冲噪声非常有效，该种噪声也称为椒盐噪声，因为这种噪声是以黑白点的形式叠加在图像上的。
一个数值集合的中值ξ是这样的数值，即数值集合中有一半小于或等于ξ,还有一半大于或等于
5。为了对一幅图像上的某个点进行中值滤波处理，首先将邻域内的像素分类排序，确定其中值，并
将中值赋予滤波后图像中的相应像素点。例如，对于一个3×3邻域，其中值是第5个最大的值，而
在一个5×5邻域中，中值就是第13个最大的值，等等。当一个邻域中的一些像素值相同时，所有相
等的值都可以作为中值。假如，在一个3×3邻域内有一系列像素值(10,20,20,20,15,20,20,25.100),
对这些值排序后为(10,15,20,20,20,20,20,25,100),那么其中值就是20。这样，中值滤波器的主要
功能是使拥有不同灰度的点看起来更接近于它的相邻点。事实上，我们使用m×m中值滤波器来去除
那些相对于其邻域像素更亮或更暗并且其区域小于m2/2(滤波器区域的一半)的孤立像素族。在这种
情况下，“去除”的意思是强制为邻域的中值灰度。较大的族所受到的影响明显较小。
在图像处理中，尽管中值滤波器是使用得最为广泛的统计排序滤波器，但并不意味着它是唯一
的。中值象征一系列像素值排序后的第 50??值，但根据基本统计学可知，排序也适用于其他不同
的情况。例如，可以取第 100??值，即所谓的最大值滤波器，这种滤波器在搜寻一幅图像中的最
亮点时非常有用。一个3×3的最大值滤波器的响应可以由公式R=max{zIk=1,2,…,9}给出。相
反，取第 0??值的滤波器就是所谓的最小值滤波器，它可用于相反 关于百分比的内容，请参阅1035节 的目的。中值、最大值、最小值和其他非线性滤波器将在5.3节中详
细介绍。
例3.14 利用中值滤波降噪。
图3.35(a)显示了一幅被椒盐噪声污染的电路板的X射线图像。为了说明这种情况下的中值滤波器处
理效果比均值滤波器更好。我们在图3.35(b)中显示了用3×3邻域均值模板处理噪声图像的结果，而在
图3.35(c)中显示了用3×3中值滤波器处理噪声图像的结果。均值滤波模糊了图像，并且噪声去除性
能也很差。在这种情况下，中值滤波要远远优于均值滤波是很明显的。通常，中值滤波比均值滤波
更适合去除椒盐噪声。
第3章 灰度变换与空间滤波 97
a bc
图3.35(a)被椒盐噪声污染的电路板X射线图像；(b)用3×3均值模板降噪后的图像：(c)用
3×3中值滤波器降噪后的图像(原图像由Lixi公司的Joseph E.Pascente先生提供)
3.6 锐化空间滤波器
锐化处理的主要目的是突出灰度的过渡部分。图像锐化的用途多种多样，应用范围从电子印刷
和医学成像到工业检测和军事系统的制导等。在上一节中，我们了解到，图像模糊可通过在空间域用
像素邻域平均法实现。因为均值处理与积分类似，在逻辑上，我们可以得出锐化处理可由空间微分来
实现这一结论。事实上，的确如此，且本节将讨论由数字微分来定义和实现锐化算子的各种方法。基
本上，微分算子的响应强度与图像在用算子操作的这一点的突变程度成正比，这样，图像微分增强边
缘和其他突变(如噪声),而削弱灰度变化缓慢的区域。
3.6.1 基础
在以下两节中，我们将分别详细讨论基于一阶和二阶微分的锐化滤波器。在讨论具体滤波器之
前，我们先回顾一下数字意义上微分的某些基本性质。为简化说明，我们主要集中讨论一阶微分的性
质。我们最感兴趣的是恒定灰度区域中，突变的开始点与结束点(台阶和斜坡突变)及沿着灰度斜坡处
的微分性质。正如您将在第10章看到的那样，这些类型的突变可以用来对图像中的噪声点、线与边
缘建模。这些图像特性过渡期的微分性质也很重要。
数字函数的微分可以用不同的术语定义。也有各种方法定义这些差别。然而，对于一阶微分的任
何定义都必须保证以下几点：(1)在恒定灰度区域的微分值为零；(2)在灰度台阶或斜坡处微分值非零；
(3)沿着斜坡的微分值非零。类似地，任何二阶微分的定义必须保证以下几点：(1)在恒定区域微分值为
零；(2)在灰度台阶或斜坡的起点处微分值非零；(3)沿着斜坡的微分值非零。因为我们处理的是数字量，
其值是有限的，故最大灰度级的变化也是有限的，并且变化发生的最短距离是在两相邻像素之间。
对于一维函数f(x),其一阶微分的基本定义是差值
=f(x+D-f(x) (3.6-1)
其中，为了与二维图像函数f(x,y)的微分保持一致，我们使用了偏
导数符号。对于二维函数，我们将沿着两个空间轴处理偏微分。当前讨论的空间微分的应用并不影响
我们试图采用的任何方法的本质。很清楚，当函数中只有一个变量时，of/ax=df/dx;对于二阶微
分，这同样也成立。
我们将二阶微分定义为如下差分：
=f(x+D)+f(x-D-2F(x)
在10.2.1节中，我们将会回到
式(3.6-1),并给出由泰勒级数推导
出它的方法。现在，我们只须把它
当做一个定义来接受即可。
(3.6-2) 述：邑
182
98 数字图像处理(第三版)
很容易验证这两个定义满足前面所说的条件。为了解这一点，并考察数字函数一阶和二阶微分间的异
同点，考虑图3.36中的例子。
图3.36(b)(图的中间)显示了一段扫描线。小方块中的数值是扫描线中的灰度值，它们作为黑点
画在上方的图3.36(a)中。用虚线连接这些点是为了帮助我们看得更清楚。正如图中所示，扫描线包
含一个灰度斜坡、三个恒定灰度段和一个灰度台阶。圆圈指出了灰度变化的起点和终点。用前面两个
定义计算出的图3.36(b)中扫描线的一阶微分和二阶微分画在图3.36(c)中。当在点x处计算一阶微分
时，我们用下一个点的函数值减去该点的函数值。因此，这是一个“预测未来”的操作。类似地，为
了在x点计算二阶微分，在计算中我们使用前一个点和下一个点。为了避免前一个点和下一个点处于
扫描线之外的情况，我们在图3.36中显示了从序列中第二个点到倒数第二个点的微分计算。
灰度过渡 6
b
c
5 恒定灰度
4 斜坡 台阶 灰度 3
2
1
0l
扫描线 6 6 6 6 5 4 3 2 1 1 I 1 1 6 6 6 6 6 x
一阶微分 00-1-1-1-1-1 00000500 00
二阶微分 00-1000 0 1 00 0 05-5 000
5 只
4
3
2
1
东度 0 回回 口-□-口-□
-1 零交叉
-2
-3
-4 ·一阶微分
口 二阶微分
-5
图3.36 表示一幅图像中一段水平灰度剖面的一维数字函数的一阶微分和二阶微分
的说明。在图(a)和图(c)中，为便于观看，已用虚线将数据点连接起来
让我们从左到右横贯剖面图，考虑一阶微分和二阶微分的性质。首先，我们遇到的是如图3.36(b)
和(c)所示的恒定灰度区域，一阶微分和二阶微分都是零，因此，两者都满足条件(1)。接着，我们遇
到紧随台阶的一个灰度斜坡，并且我们注意到在斜坡起点和台阶处的一阶微分不为零，类似地，在斜
坡和台阶的起点和终点的二阶微分也不为零；因此，两个微分特性都满足条件(2)。最后，我们看到，
两个微分特性也都满足条件(3),因为对于斜坡来说一阶微分不是零，二阶微分是零。请注意斜坡或
台阶的起点和终点处二阶微分的符号变化。事实上，我们在图3.36(c)中看到，在一个台阶的过渡中，
连接这两个值的线段在两个端点的中间与水平轴相交。正如在第10章中我们将要看到的那样，零交
又对于边缘定位是非常有用的。
数字图像中的边缘在灰度上常常类似于斜坡过渡，这样就导致图像的一阶微分产生较粗的边缘，
因为沿着斜坡的微分非零。另一方面，二阶微分产生由零分开的一个像素宽的双边缘。由此，我们
第3章 灰度变换与空间滤波 99
得出结论，二阶微分在增强细节方面要比一阶微分好得多，这是一个适合锐化图像的理想特性。正
像在本节稍后将要了解的那样，二阶微分比一阶微分执行上要容易得多，所以，我们开始主要注意
二阶微分。
3.6.2 使用二阶微分进行图像锐化——拉普拉斯算子
在这一节，我们考虑二维函数二阶微分的实现及其在图像锐化处理中的应用。在第10章中，我
们将再回到微分问题上来，在第10章我们将把它广泛用于图像分割。这种方法基本上是由定义一个
二阶微分的离散公式，然后构造一个基于该公式的滤波器模板组成的。我们最关注的是一种各向同性
滤波器，这种滤波器的响应与滤波器作用的图像的突变方向无关。也就是说，各向同性滤波器是旋转
不变的，即将原图像旋转后进行滤波处理给出的结果与先对图像滤波然后再旋转的结果相同。
可以证明(Rosenfeld and Kak[1982]),最简单的各向同性微分算子是拉普拉斯算子。一个二维图
像函数f(x,y)的拉普拉斯算子定义为
vF=r (3.6-3)
因为任意阶微分都是线性操作，所以拉普拉斯变换也是一个线性算子。为了以离散形式描述这一公式，
我们使用式(3.6-2)的定义，记住，我们必须支持第二个变量。在x方向上，我们有
=rux+1,y+fa-L.,)-2f0x.) (3.6-4)
类似地，在y方向上我们有
=r(ay+D+f(x,y-D-2f(x, (3.6-5)
所以，遵循这三个公式，两个变量的离散拉普拉斯算子是
v2f(x,y)=f(x+1,y)+f(x-1,y)+fx,y+1)+f(x.y-D-4f(x,y) (3.6-6)
这个公式可以用图3.37(a)的滤波模板来实现，该图给出了以90°为增量进行旋转的一个各向同性结
果。实现机理与3.5.1节中给出的线性平滑滤波器一样。我们在这里只是简单地使用了不同的系数。
对角线方向也可以这样组成：在数字拉普拉斯变换的定义中，在式(3.6-6)中添入两项，即两个
对角线方向各加一个。每个新添加项的形式与式(3.6-4)或式(3.6-5)类似，只是其坐标轴的方向沿着
对角线方向。由于每个对角线方向上的项还包含一个-2f(x,y),所以现在从不同方向的项中总共应
减去-8f(x,y)。图3.37(b)显示了执行这一新定义的模板。这种模板对45°增幅的结果是各向同性的。
您在实践中可能常见图 3.37(c)和(d)所示的拉普拉斯模板。它们是由我们在式(3.6-4)和式(3.6-5)中
用过的二阶微分的定义得到的，只是其中的1是负的。正因为如此，它们产生了等效的结果，但是，
当将拉普拉斯滤波后的图像与其他图像合并(相加或相减)时，必须考虑符号上的差别。
由于拉普拉斯是一种微分算子，因此其应用强调的是图像中灰度的突变，并不强调灰度级缓慢
变化的区域。这将产生把浅灰色边线和突变点叠加到暗色背景中的图像。将原图像和拉普拉斯图像叠
加在一起的简单方法，可以复原背景特性并保持拉普拉斯锐化处理的效果。正如上一段中讲到的那样，
记住所使用的拉普拉斯定义是很重要的。如果所使用的定义具有负的中心系数，那么必须将原图像减
去经拉普拉斯变换后的图像而不是加上它，从而得到锐化结果。所以，我们使用拉普拉斯对图像增强
的基本方法可表示为下式： 1：1
医室
100 数字图像处理(第三版)
8(x,y)=f(x,y)+c[v2f(x,y] (3.6-7)
其中，f(x,y)和g(x,y)分别是输入图像和锐化后的图像。如果使用图3.37(a)或图3.37(b)中的拉普
拉斯滤波器，则常数c=-1,如果使用另外两个滤波器，则常数c=1。
0 1 0 1 1 1 0 -1 0 -1 -1 -1
1 -4
一
1 -8 1 -1 4 -1 -1 8 -1
0 1 0 1 1 1 0 -1 0 -1 -1 -1
a bcd
图3.37 (a)实现式(3.6-6)所用的滤波器模板；(b)用于实现带有对角项的该
公式的扩展的模板；(c)~(d)实践中常用的其他两个拉普拉斯实现
例3.15 使用拉普拉斯的图像锐化。
图3.38(a)显示了一幅月球北极的稍微模糊的图像。图3.38(b)显示了使用图3.37(b)中的拉普拉斯模
板对该图像滤波后的结果。由于拉普拉斯图像中既有正值又有负值，并且所有负值在显示时都修剪为0,
所以图像的大部分是黑色的。
一个典型的标定拉普拉斯图像的方法是对它的最小值加一个新的代替0的最小值，然后将结果标定
到整个灰度范围[0,L-1]内，如同式(2.6-10)和式(2.6-11)中解释的那样。图3.38(c)是用这种方法标定过
的图像。注意，该图像的支配特性是边缘和灰度的不连续处。前述的黑色背景由于标定现在已变成灰色。
这一呈现浅灰色的外观是被适当标定的典型拉普拉斯图像。图3.38(d)显示了在c=-1时使用式(3.6-7)得
到的结果。该图像的细节比原图像更清晰。将原图像加到拉普拉斯的处理结果中，可以使图像中的各灰度
值得到复原，而且通过拉普拉斯增强了图像中灰度突变处的对比度。最终结果是使图像中的细节部分得到
了增强，并良好地保留了图像的背景色调。最后，图3.38(e)显示了使用图3.37(b)中的滤波器重复前述过程
处理的结果。在这里，我们注意到图3.38(d)的清晰度的重要改进。因为使用了图3.37(b)的滤波器导致在
对角方向上产生了额外的区别(锐化),这并不意外。像图3.38(d)和图3.38(e)显示的这些结果使得拉普拉
斯成为锐化数字图像的一种工具。
a bcd e
图3.38 (a)月球北极的模糊图像；(b)未标定的拉普拉斯滤波后的图像；(c)标定的拉普拉斯滤波后的图像；
(d)用图3.37(a)中的模板锐化后的图像；(e)用图3.37(b)中的模板锐化后的图像(原图像由NASA提供)
3.6.3 非锐化掩蔽和高提升滤波
在印刷和出版界已用了多年的图像锐化处理过程是从原图像中减去一幅非锐化(平滑过的)版
本。这个称为非锐化掩蔽的处理过程由下列步骤组成：
1.模糊原图像。
2.从原图像中减去模糊图像(产生的差值图像称为模板)。
3.将模板加到原图像上。
第3章 灰度变换与空间滤波 101
令f(x,y)表示模糊图像，非锐化掩蔽以公式形式描述如下。首先，我们得到模板：
8mmk(x,y)=f(x,y)-f(x,y) (3.6-8) b
然后，在原图像上加上该模板的一个权重部分： 原始信号
8(x,y)=f(x,y)+k*8mk(x,y) (3.6-9)
通常，我们会在上式中包含一个权重系数k(k≥0)。当
k=1时，我们得到上面定义的非锐化掩蔽。当k>1时，
该处理称为高提升滤波。选择k<1则不强调非锐化模
板的贡献。
模糊后的信号
图3.39解释了非锐化掩蔽是如何工作的。图3.39(a)
中的灰度剖面图可以解释为通过垂直边缘的水平扫描
线，垂直边缘是图像中从暗区到亮区的过渡。图3.39(b)
显示了平滑后的结果，为了参考，该结果叠加在原始信
锐化后的信号 号(显示为虚线)上。图3.39(c)是非锐化模板，它是从原
始信号中减去模糊信号得到的。通过将该结果与对应于图
钝化模板
3.36(a)中斜坡的图3.36(c)中的部分比较，我们注意到， 图3.39 非锐化掩蔽机理的说明：(a)原始信号；
图3.39(c)中的非锐化模板与我们使用二阶微分得到的结 (b)模糊信号，为便于参考，原始信号使
果非常相似。图3.39(d)是最后锐化的结果，它是通过把 用虚线显示；(c)非锐化模板；(d)将
图(c)和图(a)相加得到的锐化后的信号 模板加到原始信号上得到的。现在强调(锐化)了信号
中出现灰度斜率变化的点。观察添加到原信号中的负值。这样，如果原图像有任何零值，或如果选
择的k值大到足以使模板峰值大于原信号中的最小值时，那么最终的结果可能会存在负灰度。负值
将导致边缘周围有暗的晕轮，如果k足够大，将产生不好的结果。
例3.16 使用非锐化掩蔽进行图像锐化。
图 3.40(a)显示了一幅在暗灰背景上稍微有点模糊的白文本图像。图3.40(b)是使用大小为5×5且
σ=3的高斯平滑滤波器得到的结果(见3.4.4节)。图3.40(c)是使用式(3.6-8)得到的非锐化模板。图3.40(d)
是用[式(3.6-9),k=1]非锐化模板得到的结果。该图像较原图像稍微有点改进，但是，我们可以做得更
好。图3.40(e)显示了使用式(3.6-9)并且令k=4.5的结果，这是我们可用的最大可能值，并且在最终结果
中始终保持所有值为正。该图像与原图像相比有重大的改进。
DIP-XE |DIP-XE DIP-XE DIP-XE a be d e
图3.40(a)原图像；(b)使用高斯滤波器模糊的结果；(c)非锐化模
板：(d)使用非锐化掩蔽的结果；(e)使用高提升滤波的结果
3.6.4 使用一阶微分对(非线性)图像锐化——梯度
图像处理中的一阶微分是用梯度幅值来实现的。对于函数f(x,y),f在坐标(x,y)处的梯度定义
为二维列向量 1
10.2.5 节将详细讨论梯度。这里。
我们仅对使用梯度幅值锐化图像感 (3.6-10)
兴趣。 ③：西
畜
102 数字图像处理(第三版)
该向量具有重要的几何特性，即它指出了在位置(x,y)处f的最大变化率的方向。
向量Vf的幅度值(长度)表示为M(x,y),即
M(x,y)=mag(VA)=√82+8} (3.6-11)
它是梯度向量方向变化率在(x.y)处的值。注意，M(x,y)是与原图像大小相同的图像，它是当x和y
允许在f中的所有像素位置变化时产生的。在实践中，该图像通常称为梯度图像(或含义很清楚时，
可简称为梯度)。
因为梯度向量的分量是微分，所以它们是线性算子。然而，该向量的幅度不是线性算子，因为
求幅度是做平方和平方根操作。另一方面，式(3.6-10)中的偏微分不是旋转不变的(各向同性),而梯
度向量的幅度是旋转不变的。在某些实现中，用绝对值来近似平方和平方根操作更适合计算：
M(x,y)=|s|+|8l (3.6-12)
该表达式仍保留了灰度的相对变化，但是通常各向同性特性丢失了。然而，像拉普拉斯的情况那样，
在下面章节定义的离散梯度的各向同性仅仅在有限旋转增量的情况下被保留了，它依赖于所用的近似
微分的滤波器模板。正如结果那样，用于近似梯度的最常用模板在90°的倍数时是各向同性的。这些
结果与我们使用式(3.6-11)还是使用式(3.6-12)无关，因此，如果我们选择这样做，使用后一公式对
结果并无影响。
正如在拉普拉斯情况下那样，我们现在对前面的公式定义一个离散近似，并由此形成合适的滤
波模板。为简化下面的讨论，我们将使用图3.41(a)中的符号来表示一个3×3区域内图像点的灰度。
例如，使用图 3.28 中引入的符号，令中心点z,表示任意位置(x,y)处的f(x,y);z表示为
f(x-1,y-D);等等。正如 3.6.1节指出的那样，满足3.6.1节声明的条件的对一阶微分的最简近似是
8x=(zg-zs)和g,=(z?s)。在早期数字图像处理的研究中，由Roberts[1965]提出的其他两个定
义使用交叉差分：
8x=(Z-z)和gy=(Zg-Z6) (3.6-13)
如果我们使用式(3.6-11)和式(3.6-13),我们计算梯度图像为
M(x,y)=[(z,-z?2+(zg-z2]“2 (3.6-14)
如果我们用式(3.6-12)和式(3.6-13),则
M(x,y)=|z-z|+|z?-z? (3.6-15)
按之前的描述方式，很容易理解x和y会随图像的维数变化。式(3.6-13)中所需的偏微分项可以用图3.41(b)
中的两个线性滤波器模板来实现。这些模板称为罗伯特交叉梯度算子。
偶数尺寸的模板很难实现，因为它们没有对称中心。我们感兴趣的最小模板是3×3模板。使用
以z,为中心的一个3×3邻域对g和g,的近似如下式所示：
8==(27+2Z+Z)-(z+2z?+2) (3.6-16)
和
8,==(z+2?)-(z+2z+2) (3.6-17)
这两个公式可以使用图3.41(d)和图3.41(e)中的模板来实现。使用图3.41(d)中的模板实现的3×3图像
区域的第三行和第一行的差近似x方向的偏微分，另一个模板中的第三列和第一列的差近似了y方
向的微分。用这些模板计算偏微分之后，我们就得到了之前所说的梯度幅值。例如，将g,和g,代
第3章 灰度变换与空间滤波 103
入式(3.6-12)得到
M(x,y)=(z?+2zg+z)-(z+2z?+zy|+|(y+2z?+z)-(z+2z+z)| (3.6-18)
图3.41(d)和图3.41(e)中的模板称为Soble 算子。中心系数使用权重2的思想是通过突出中心点的作
用而达到平滑的目的(第10章中将详细介绍该思想)。注意，图3.41所示的所有模板中的系数总和为0.
这正如微分算子的期望值那样，表明灰度恒定区域的响应为0。
a bc d e
Z Z? Z
-1 -2 -1 -1 0 1
Z -1 0 0 -1 0 0 0 -2 0 2
Z Z 0 1 1 0 1 2 1 -1 0 1
图3.41(a)一幅图像的3×3区域(z是灰度值);(b)-(c)罗伯特交叉梯度算
子；(d)~(e)所有的模板系数之和为零，如微分算子预料的那样
正如之前提到的那样，g和g,的计算是线性操作，因为它们涉及微分操作，因此可以使用图3.41
中的空间模板如乘积求和那样实现。使用梯度进行非线性锐化是包括平方和平方根的M(x,y)的计
算，或者使用绝对值计算代替，所有这些计算都是非线性操作。该操作是在得到g,和g,线性操作后
执行的操作。
例3.17 使用梯度进行边缘增强。
梯度处理经常用于工业检测，不是辅助人工检测产品缺陷，就是更为通用地作为自动检测的预处理。
我们将在第10章和第11章对此做更多的介绍。考虑一个简单的例子来展示梯度法如何用于增强缺陷并消
除慢变化背景的特性是有益的。在这个例子中，增强用做自动检测的预处理步骤，而不用于人为分析。
图3.42(a)显示了一幅隐形眼镜的光学图像，
它由设计用于突出缺陷的发光装置来照明，例如
4点钟方向和5点钟方向眼镜边界中的两个边缘
a b
缺陷。图3.42(b)显示了使用式(3.6-12)及图3.41(d)
与图3.41(e)中的两个Sobel模板得到的梯度图像。
在该图像中，边缘缺陷清晰可见，并且还有一个
附加的优点，即灰度不变或变化缓慢的图案阴影
被去除了，从而简化了自动检测所要求的计算任
务。梯度处理还可以用于突出灰度图像中看不见的
小斑点(这样的小斑点可能是外来物、保护液中的气
泡或眼镜中的小缺陷)。在灰度平坦区域中增强小突
变的能力是梯度处理的另一个重要特性。
图3.42(a)隐形眼镜的光学图像(注意4点钟和
5点钟方向边界上的缺陷);(b)Sobel梯度
(原图像由 Percepics公司的Pete Sites提供)
3.7 混合空间增强法
到目前为止，除了一些特殊情况，如带有阈值处理(图3.34)的混合模糊，我们主要关注的还是单
一的增强法。通常，为了达到令人满意的结果，对给定的任务需要应用多种互补的图像增强技术。在
本节，我们将通过一个例子来说明怎样将本章中提到的多种图像增强方法结合起来，从而完成困难的
图像增强任务。 ;三
3 ;图
104 数字图像处理(第三版)
图3.43(a)所示的图像是一幅人体骨骼核扫描图像，常用于检查人体疾病，如骨骼感染和肿瘤。
我们的目的是通过图像锐化突出骨骼的更多细节来增强图像。由于图像灰度的动态范围很窄并且有很高
的噪声内容，所以很难对其进行增强。对此我们采取的策略是，首先用拉普拉斯法突出图像中的小细节.
然后用梯度法突出其边缘。平滑过的梯度图像将用于掩蔽拉普拉斯图像(关于掩蔽的说明见图2.30),稍
后会对此简短说明。最后，我们将试图使用灰度变换来增大图像的灰度动态范围。
图3.43(b)显示了使用图3.37(d)中的滤波器得到的原图像的拉普拉斯操作的结果。该图像使用与
图3.38(c)相同的技术标定过(只为便于显示)。然后，根据式(3.6-7),简单地将图3.43(a)与图3.43(b)
相加就可以得到一幅经过锐化过的图像。只要看一下图3.43(b)中的噪声水平，就可以预料到，如果
将图3.43(a)和图3.43(b)相加，会导致相当多的噪声，这一点可以在图3.43(c)中得到证实。于是可立
刻想到，降低噪声的一种方法是使用中值滤波器。然而，中值滤波器是一种非线性滤波器，它有可能
改变图像的性质。这在医学图像处理中是不能接受的。
a bcd
图3.43(a)全身骨骼扫描图像；(b)图(a)经拉普拉斯操作后的结果；(c)将图(a)
和图(b)相加得到的锐化图像；(d)图(a)经Sobel梯度处理后的结果
efgh
图3.43(续)(e)使用5×5均值滤波器平滑后的Sobel图像：(1由图(c)和图(e)相乘形成的掩蔽
图像；(g)由图(a)和图(f求和得到的锐化后的图像；(h)对图(g)应用幂律变换得
到的最终结果。请将图(g)与图(a)比较(原图像由G.E.Medical Systems公司提供)
另一种方法是使用原图像梯度操作的平滑形式所形成的一个模板。这种方法的动机很直接，并
且基于3.6.1节中讲过的一阶和二阶微分的性质。拉普拉斯操作作为一种二阶微分算子，在图像细节
的增强处理方面有一定的优点，在增强细节方面它是最好的。但这会导致它产生比梯度操作更多的噪
第3章 灰度变换与空间滤波 105
声。这些噪声在平滑区内域更令人讨厌，因为在这些区域它非常显眼。梯度变换在灰度变化的区域(灰
度斜坡或台阶)的平均响应要比拉普拉斯操作的平均响应更强烈。梯度操作对噪声和小细节的响应要
比拉普拉斯操作的响应弱，而且可以通过均值滤波器对其进行平滑处理而进一步降低。这时，其思路
是对梯度图像进行平滑处理并用拉普拉斯图像与它相乘。在这种情况下，可以将平滑后的梯度图像看
成是一个模板图像。乘积会保留灰度变化强烈区域的细节，同时降低灰度变化相对平坦区域的噪声。
这种处理可以粗略地看成是将拉普拉斯操作与梯度操作的优点相结合。将结果加到原图像上，就可以
得到最终的锐化图像。
图3.43(d)显示了原图像使用式(3.6-12)给出的 Sobel 梯度操作的结果。分量g,和g,分别使用
图3.41(d)和图3.41(e)中的模板获得。正如所期望的那样，该图像中的边缘要比拉普拉斯图像中的
边缘突出许多。图3.43(e)中平滑后的梯度图像是使用大小为5×5的一个均值滤波器得到的。为便于
显示，两幅梯度图像已与拉普拉期图像相同的方式进行了标定。因为梯度图像的最小可能值是0.
故标定后的梯度图像中背景是黑色的，而不是标定后的拉普拉斯图像中的灰色。图3.43(d)和图3.43(e)
比图3.43(b)亮的事实再次表明，具有重要边缘内容的梯度图像的值一般要比拉普拉斯图像的值高。
拉普拉斯图像与平滑后的梯度图像的乘积显示在图3.43(f)中。注意强边缘的优势和可见噪声的
相对减少，这是使用一幅平滑后的梯度图像来掩蔽拉普拉斯图像的关键目的。将乘积图像与原图像相
加就产生了图3.43(g)所示的锐化图像。与原图像相比，该图像中大部分细节的清晰度的增加都很明显，
包括肋骨、脊椎骨、骨盆及颅骨。单独使用拉普拉斯操作或者梯度操作不可能达到这种类型的改进。
以上讨论的锐化过程从感知方法上没有影响图像灰度的动态范围。这样，增强处理任务的最后
一步就是增大锐化后图像的动态范围。正如 3.2节和 3.3节中详细讨论的那样，有很多可以完成这一
目标的灰度变换函数。从3.3.2节的结果可以知道，对类似此处灰度分布比较暗的图像进行直方图均
衡的效果似乎并不好。直方图规定化可能是一种解决方法，但待处理图像的暗特性用幂律变换处理更
好。由于我们希望能够扩展灰度范围，所以式(3.2-3)中的γ值必须小于1。通过用这一公式进行一些
实验后，我们得到了图3.43(h)所示的结果，此时γ=0.5,c=1。将这幅图像与图3.43(g)相比较，我
们可以看到图3.43(h)中出现了许多重要的新细节。围绕着手腕、手掌、脚踝和脚掌区域都是这种效
果的很好例子。人体的整个骨架结构也很显著,包括手臂骨和腿骨。我们还注意到，人体轮廓及人体
组织的清晰度不高，这是由于通过扩大灰度动态范围显现细节的同时也增大了噪声，但图3.43(h)与
原图像相比还是显示出了视觉效果的显著改进。
刚才讨论的方法是有代表性的处理形式，为了达到那些用一种方法无法实现的效果，可以把多
种方法结合起来。得到期望结果所使用的方法取决于应用。在这个例子中，所示图像类型的最终用户
很可能是放射线学者。但也存在超出我们讨论范围的多数原因，如物理学家就不依赖于增强的结果来
达到诊断目的。然而，如果将突出一些细节作为进一步分析一幅原图像或一系列图像的线索，则增强
后的图像是非常有用的。而在其他领域，增强处理后的结果可能就是最终的“产品”。在印刷工业、
基于图像的产品检测、法院取证、显微、监视及其许多他领域，增强的主要目的是得到一幅具有较高
视觉细节内容的图像。
3.8 使用模糊技术进行灰度变换和空间滤波
我们以介绍模糊集合及其在灰度变换和空间滤波中的应用来结束本章，灰度变换和空间滤波是前几
节探讨的主题。正如它所证明的那样，这两种应用是图像处理中最常使用模糊技术的领域。在本章最后
的参考文献提供了关于模糊集和模糊集在图像处理中的应用方面的切入点。如在下面的讨论中您将看到
的那样，模糊集合在解决那些不以精确概念为基础来表述的问题时，为体现人类知识提供了一个框架。 固：图
容：恩
106 数字图像处理(第三版)
3.8.1 引言
如2.6.4节注释的那样，一个集合是对象(元素)的聚集，集合论是处理集合中操作的工具集。与数
学逻辑一样，集合论理所当然也是经典数学的基础之一。集合论的核心是集合成员的概念。我们习惯
于处理所谓的“干脆的”集合，它们的成员在传统的二值布尔逻辑情况下，不是真就是假，用1表示
真，用0表示假。例如，令Z表示为所有人员的集合，并且我们想要定义集合Z的一个称为年轻人集
合的子集A。为了形成该子集，我们需要定义一个隶属度函数，它可以对Z中的每一个成员z赋一个1
值或0值。因为我们处理二值逻辑，隶属度函数简单地定义一个阈值，等于或低于该阈值的人考虑为
年轻人，而在阈值之上的人考虑为非年轻人。图3.44(a)用20岁的年龄 隶属度函数也称为特征函数
阈值总结了这一概念，并令HA(z)表示刚才讨论的隶属度函数。
μ μ a b
1
HA(2) 1 μa(2)
求属度 0.5 0.5
0
0 10 20 30 40 50… 年龄(z)0
0 10 20 30 40 50… 年龄(2)
图3.44 用于产生(a)一个“干脆的”集合和(b)一个模糊集合的隶属度函数
使用这一表达，我们立即会面临一个困难：年龄为20岁的人被认为是年轻人，但年龄为20岁
零1秒的人就不是年轻人集合的成员。这是使用“干脆的”集合的一个基本问题，它在许多实际应用
中限制了经典集合论的用途。
我们需要的所谓年轻的意思是更弹性地在年轻和非年轻间的渐进过渡。图3.44(b)显示了一种可
能性。该函数的关键特性是无限制的评价，这样就可在年轻和非年轻之间允许连续地过渡。这就使
得它可能有“年轻”的程度。现在我们可以做一个声明：如一个人是年轻人(曲线上端的平坦部分),
相对年轻的人(斜坡开始处),50??轻的人(斜坡的中间),不那么年轻的人(斜坡的末端),等等[注
意图3.44(b)中曲线的斜率引入了什么是“年轻”的更加模糊的概念]。这些模糊的声明与我们不太严
密地谈论年龄时是一致的。这样，我们可以用模糊逻辑基础解释非限制评价隶属度函数，并且把使用
它们生成的集合看成是模糊集合。这些概念将在下一节中被形式化。
3.8.2 模糊集合论原理
模糊集合论是由L.A.Zadeh在40多年前的一篇论文中引入的(Zadeh[1965])。如下面的讨论那样，
模糊集合为处理不严密信息提供了一种形式。
为表达给定应用中集合的广泛 定义 性，我们采用传统的模糊集合表示
令Z为元素(对象)集，z表示Z的一类元素，即Z={z]。该集合 法，即集合符号 Z而不是更为传统
的集合符号U. 称为论域。Z中的模糊集合A由隶属度函数μ(z)表征，它是与Z的
元素相关的在区间[0,1]内的一个实数。HA(z)在z处的值表示A中z的隶属度等级。最接近μ(z)的
值与在A中的z的较高的隶属度等级趋于一致，而当HA(z)接近于0时，则相反。“属于”这个概念
在普通集合中很熟悉，但在模糊集合论中却具有不同的含义。对于普通集合，我们说一个元素属于或
①文献中也使用术语模糊子集来表示A是Z的子集，但模糊集合使用得更为频繁。
第3章 灰度变换与空间滤波 107
不属于一个集合；而对于模糊集合，我们说对于μA(z)=1的所有z都是集合的完全成员，对于
HA(z)=0的所有z都不是集合的成员，而μA(z)的值介于0和1之间的所有z是集合的部分成员。
因此，模糊集合是一个由z值和(赋予z成员等级的)相应隶属度函数组成的序对，即
A={2,HA(z)Iz∈Z} (3.8-1)
当变量连续的时候，该式中集合A有无限个元素。当z的值是离散值时，我们可明确地地说明A的
元素。例如，如果图3.44中的年龄增量限制为整数年，则有
A={(1,D,(2,1).(3,1),…,(20,1),(21,0.9),(22,0.8),…,(25,0.5)(24,0.4),…,(29,0.D}
这里，作为一个例子，元素(22,0.8)表示年龄22在集合中的隶属度等级为0.8。年龄为20岁和低于20
岁的所有成员都是该集合的完全成员，而年龄为30岁和高于30岁的成员都不是集合的成员。注意，
该集合的曲线是图3.44(b)中曲线上的离散点，所以μA(z)完全定义了A。从另一角度观察，我们发现
一个(离散)模糊集合只不过是一个函数的点的集合，该函数将问题域(论域)中的每个元素映射为一个
大于0而小于或等于1的数。这样，我们通常可以交替使用术语模糊集合和隶属度函数。
当H(z)仅有两个值时，例如0和1,隶属度函数退化成我们熟悉的普通(干脆的)集合A的特征
函数。这样，普通集合就是模糊集合的一种特殊情况。下面，我们考虑涉及模糊集合的几个定义，这
些定义是普通集合中相应定义的扩展。
空集：当且仅当Z中的隶属度函数等于零，模糊集合为空集。
相等：当且仅当对于所有的z∈Z有μA(z)=μ?(z),两个模糊集合A和B相等。
补集：由A或NOT(A)表示模糊集合A的补集(NOT),定义为其隶属度函数是
μx(z)=1-μA(z) (3.8-2)
的集合，对于所有的z∈Z。
子集：当且仅当对于所有的z∈Z,有
HA(z)≤μa(z) (3.8-3)
模糊集合A是模糊集合B的子集。
并集：对于所有的z∈Z,两个模糊集合A和B的并集是具有隶属度函数
Hu(z)=max[μA(z),μg(z)] (3.8-4)
的并集U(OR),表示为AUB或AOR B。
交集：两个模糊集合A和B的交集是对于所有的z∈Z,具有隶属度函数
μ?(z)=min[μ(2),H?(z)] (3.8-5)
的模糊集合1.表示为ANB或A AND B。
注意，在处理模糊集合时，可使用熟悉的符号NOT,OR和AND来分别表示补、并和交。
例3.18 模糊集合定义的说明。
图3.45说明了前面的一些定义。图3.45(a)显示了两个集合A和B的隶属度函数。图3.45(b)显示了集
合A的补集的隶属度函数，图3.45(c)显示了集合A和B的并集的隶属度函数，图3.45(d)显示了这两个集
合的交集的结果。注意，这些图形是我们所熟悉的关于普通集合的补集、并集和交集。
①读者可能在文献中遇到过这样的例子，例如两个模糊集合的交集的隶属度函数曲线下的面积用阴影表示，以指出该操作的结果
这源于普通集合操作，是不正确的。在处理模糊集合时，这仅适用于沿着隶属度函数本身的点。 运;图
图;室
108 数字图像处理(第三版)
1 1
隶属度 μA(z) An(2) μx(z)=1-μa(z)
补集
0l 0L
1 I
pu(z\=max[A(=).pn(z)|
μ(2) min|μa(2),μ2)|
并集 交集
0L 0L
图3.45 (a)两个集合A和B的隶属度函数；(b)A的补集的隶属
度函数；(c)~(d)两个集合的并集和交集的隶属度函数
尽管模糊逻辑和概率均在相同的区间[0,1]上操作，但这两种操作却有明显的区别。考虑图3.44
中的例子，概率的说法可能是“一个人年轻的可能性是50??,而模糊逻辑的说法可能是“一个人
在年轻人集合中的隶属度等级是0.5"。这两种说法的区别很重要。在第一种说法中，考虑一个人不
是在年轻人的集合里，就是不在年轻人的集合里；我们仅有50??机会知道这个人属于哪个集合。
第二种说法预设一个人的年轻程度，在这种情况下其年轻程度是0.5。另外一种解释是说这是一个
“平均的”年轻人：不是真年轻，但也不是太接近不年轻。换句话说，模糊逻辑完全不是概率；它
仅仅处理一个集合中隶属度的等级。在这种情况下，模糊逻辑这一概念就在由含混和不精确而不是
随机性表征的应用中找到了用途。
一些常用的隶属度函数
实际中使用的隶属度函数类型如下所示。
三角形：
(3.8-6)
梯形：
(3.8-7)
∑:
(3.8-8)
第3章 灰度变换与空间滤波 109
S形：
一信 (3.8-9)
钟形：
ma={-Sac/2b)25 (3.8-10)
截尾高斯形：
钟形函数有时也称为π(或π)
函数
(3.8-11)
典型地，为简化公式，当写成μ(z)时，隶属度函数仅依赖于变量z。为了用式(3.8-10)的形式，
我们把式(3.8-9)作为一个例外。图3.46显示了刚才讨论的隶属度函数的几个例子。前三个函数是分段
线性的，接着的两个函数是平滑的，最后一个函数是截尾高斯函数。式(3.8-9)描述了一个重要的S
形函数，在处理模糊集合时会频繁使用这个函数。该式中S=0.5时，值z=b称为交叉点。如图3.46(d)
所示，这是曲线改变形状的那个点。不难证明b=(a+c)/2(见习题3.31)。图3.46(e)所示的钟形曲线
中，b的值定义为曲线的带宽。
心 1
0.5
0
1
0.5
0
1
0.5
0
a-b
a-b
c-b
三角形
一
梯形
0.5
z0
a a+c a-c b b+d
1
Z S形
0.5
:0 a a b C
钟形 1 截尾高斯形
0.607 2h
0.5
c+h :0 aaa+c
b
图3.46 对应于式(3.8-6)至式(3.8-11)的隶属度函数 图受
110 数字图像处理(第三版)
3.8.3 模糊集合应用
在这一节，我们将关注模糊集的应用基础，并通过一些简单且熟悉的例子来说明这些由此而来
的概念。然后，我们将这些结果应用到3.8.4节和3.8.5节的图像处理中。采用这种说明方法，使得对
该内容更容易理解，特别是对该领域的新读者。
假设我们感兴趣的是用颜色把给定的水果分为三类：生的、半熟的和成熟的。假设观察水果成
熟的各个阶段得到了如下结论：生的水果是绿色的，半熟的水果是黄色的，成熟的水果是红色的。标
志绿、黄和红是颜色感觉的含混描述。作为起点，这些标志必须以模糊形式来表达，也就是，它们必
须被模糊化。这是通过将隶属度定义为颜色(光的波长)的函数来实现的，如图3.47(a)所示。在本文
中，颜色是一个语言学上的变量，而一种特定的颜色(如有固定波长的红色)是一个语言学上的值。通
过用隶属度函数将语言学上的值z映射到区间[0,1]来模糊化，如图3.47(b)所示。
a bμ(z) μ(2)
a(2) (2) 1.0 H() Pm(2) 1.0 Pp(2) Ha(2) μm(y 隶属度 0.5 隶属度 0.5 Hsa(m)
0 0L Hm(z)
颜色(波长) 0
颜色(波长)
图3.47(a)用于模糊颜色的隶属度函数；(b)对特定颜色z的模糊化(描述颜色感觉的曲线
是钟形曲线；见6.1节的例子。但在处理模糊集合时，通常使用三角形曲线来近似)
刚刚解释的特定问题的知识可以用如下形式的IF-THEN模糊规则来形式化：
R?:IF颜色是绿色，THEN水果是生的。
OR
R?:IF颜色是黄色，THEN水果是半熟的。
OR
R?:IF颜色是红色，THEN水果是熟的。
这些规则描述了关于该问题的知识的总和；它们确实没有超出思维过程的形式化。
该过程的下一步是寻找一种使用输入(颜色)和由IF-THEN 规则描述的知识基础来创建模糊系统的
输出的方法。这一处理称为推断或推理。然而，在运用推断之前，必须处理每个规则的前提以便产生
IF-THEN 规则中THEN 左侧的部
分通常称为前提(条件),而右侧的
部分称为后果(或结论)。
品:
单个值。正如在这一节末尾所示的那样，一个
前提的多个部分可由AND和OR 链接起来。基
于3.8.2节的定义，这意味着执行最小和最大操
作。为简化说明，我们首先处理仅包含一个部分
的前提的规则。
因为我们处理的是模糊输入，输出本身也
是模糊的，因此，也必须针对输出定义隶属度
函数。图3.48 显示了我们将在该例中使用的模
糊输出的隶属度函数。注意，输出的自变量是
成熟的，它不同于输入的自变量。
1.0 He(0) Pur(0)
隶属度 人μm()
0.5
0- 10 20 30 40 50 60 70 80 90 100
成熟度(%)
图3.48 表征输出为生的、半熟的和熟的的隶属度函数
第3章 灰度变换与空间滤波 111
图3.47和图3.48与基础规则一起，包含了所要求的与输入和输出相关的所有信息。例如，我们注
意到，“红色AND 成熟”的表达与前面定义的交集(AND)操作一样。在现在的情况下，输入和输出
的隶属度函数的自变量是不同的，因此结果将是二维的。例如，图3.49(a)和图3.49(b)显示了红色和成
熟的隶属度函数，图3.49(e)显示了它们的二维关系。为了得到两个函数间AND操作的结果，回忆
式(3.8-5)可知，AND定义为两个隶属度函数的最小，即
H?(z,V)=min{p(Z),μm(v} (3.8-12)
其中，下标3表示这是基础知识中规则R?的结果。图3.49(d)显示了AND操作的结果。
式(3.8-12)是涉及两个隶属度函数的通解。在实践中，我们感兴趣的是来自一个特定输入的输出
结果。令zo表示红色的一个特定值。该输入的响应中的红色分量的隶属等级是简单的标量值μd(zo)。
我们找到与规则R?和这个特定输入对应的输出，即在μ(z?)和μ,(z,v)间执行AND 操作，并在z
处求值。如前面表明的那样，AND操作使用最小操作来实现：
Q?(v)=min{μ(Z?),μ?(z?,v} (3.8-13)
其中，Q?(v)表示由规则R?和一个特定输入导致的模糊输出。Q?中的唯一变量是所期望的输出变量v。
a bμ(2) cd μ(0)
1.0 H(2) 1.0
0.5 0.5 人(0)
0
颜色 Z 0- 成熟度
μ(Z0) μ(Z.)
、
颜色 成熟度 颜色 成熟度
图3.49 (a)与红色相关联的隶属度函数的形状；(b)相应的输出隶属度函数，两个函数由规则
R,相关联；(c)两个函数组合在一起的表示。该表示是二维的，因为在图(a)和图(b)
中的自变量是不同的；(d)图(a)和图(b)的AND操作结果，如式(3.8-5)的定义一样
为了用图形方式解释式(3.8-13),再次考虑图3.49(d),该图显示了通用函数μ?(z,v)。执行一个
正常数c的最小化操作，该函数将在该常数之上裁剪μ?(z,v)的所有值，如图3.50(a)所示。然而，我
们只对沿彩色轴的一个值(z?)感兴趣，因此，相关的结果是沿着成熟轴的截短函数的剖面，该剖面位
①注意，式(3.8-12)是由序对值[p()p()1形成的，回忆可知，序对集合通常称为笛卡儿积，由X×V表示，其中X是由
m(2)改变z生成的值集{伊(Z),Am(Z?),·H(Z},V是由μ()改变v生成的类似值集。这样，X×V=
{μ(Z)H()….((z)Pm(??，由图3.49(d)我们看到，涉及两个变量的AND操作可表达为从X×V到区间[0.1
的映射，表示为X×V→10.]。尽管我们在当前的讨论不使用这种表示，但这里提及它的原因在于我们可能会在关于模糊集
合的文献中遇到它 派
臣
112 数字图像处理(第三版)
于z处，如图3.50(b)所示[因为图3.50(a)对应于规则R?,它遵循c=H(z)]。式(3.8-13)是该剖
面的表达式。
a b
μ(z,) μe)
、 、
c
(2J μ(z)
成热度 成蜘度
图3.50(a)一个任意常数c和来自式(3.8-12)的函数μ?(z,v)的最小化结果。
最小化等价于一个AND操作；(b)在特定颜色z处的剖面(黑线)
利用同样的推理，我们可得到由其他两个规则和特定输入z导致的模糊响应，如下所示：
Q?(V)=min{Henu(z),H?(20,v} (3.8-14)
和
2?(v)=min{μern(z),H(z,v} (3.8-15)
这些公式中的每一个都是与一个特殊规则和一个特定输入有关的输出。也就是，它们描绘了前面几段
中提到的隐含处理的结果。记住，这三个响应中的每一个都是模糊集合，即使输入是一个标量值。
为得到全部的响应，我们把单个响应聚集起来。在本节开始给出的规则基础中，三个规则是由
OR操作联系起来的。这样，全部模糊输出由下式给出：
Q=QOR Q?OR Q? (3.8-16)
我们看到全部的响应是这三个单个模糊集合的并集。因为OR定义为最大操作，所以我们可将该结果
写为
Q(v)=max{min{a,(Z),μ,(z,} (3.8-17)
其中，r={1,2,3},并且s={绿色，黄色，红色}。尽管该表达式是从一个例子中推导出来的，但它完
全通用；为将其扩展到n个规则，我们可简单地令r={1,2,…,n];类似地，我们可以把s扩展到包
括任何有限数量的隶属度函数。式(3.8-16)和式(3.8-17)描述了相同的事情：模糊系统的响应Q.是
由该隐含处理每一个规则得到的单个模糊集合的并集。
图3.51 以图示方式总结了到目前为止所讨论的内容。图3.51(a)显示了在z?处计算的三个输入隶
属度函数，图3.51(b)显示了对输入 z的响应的输出。这些模糊集合是使用图3.50(b)的方法裁剪后的
剖面。注意，Q由所有的0组成，因为Hgmen(z?)=0;也就是，Q是空集，正如在3.8.2节定义的
那样。图3.51(c)显示了最终结果Q.它本身是一个由Q.Q?和Q?的并集形成的模糊集合。
我们已经成功地得到了相应于特定输入的完整输出，但我们仍然在处理一个模糊集合。最后一
步是使用称为去模糊的适当地处理，从模糊集合Q中得到一个“干脆的”输出v?。对Q去模糊而得
到“干脆的”输出有几种方法。用得最多的一种方法是计算该集合的重心(本章末尾给出的参考文献
中讨论了其他方法)。这样，如果来自式(3.8-17)的Qv)有K种可能的值Q1.Q(2),…,Q(K),则其
重心由下式给出：
第3章 灰度变换与空间滤波 113
(3.8-18)
在图3.51(c)中，用Q的离散值"计算该公式，得到v?=72.3,它指出给定的颜色z?意味着一种水果
的成熟度约为72??
μ(2)
1.0 As(2)
H(z)
b
c
Ha(Zy Hm(2)
隶减度 0.5 μscou(zi) V
He(n) 0
颜色(波长)
μ(e)
1.0
隶属度 Q
0.5 Q?
2
0
10 20 30 40 50 60 70 80 90 100
成熟度(%)
μ(r)
1.0
Q
隶属度 0.5
0-
10 20 30 40 50 60 70 80 90 100
成熟度(%)
图3.51(a)所选特定颜色z的隶属度函数；(b)由式(3.8-13)到式(3.8-15)得到
的单独的模糊集合；(c)用式(3.8-16)或式(3.8-17)得到的最终模糊集合
到目前为止，我们已经讨论了IF-THEN 规则，这些规则的前提只有一部分，例如“如果颜色是
红色”。包含更多部分的规则必须组合起来，以便得出描述该规则的整个前提的单个数字。例如，假
设我们有一个规则：IF颜色是红色OR坚固性是软的，THEN 水果是成熟的。必须为语言学变量“软的”
定义一个隶属度函数。然后，为了获得考虑前提的两部分的规则的单个数字，我们首先要使用“红色”
隶属度函数来评估一种给定的“红色”输入值，然后使用“软的”隶属度函数来评估一种给定的“坚固
度”值。因为两部分由OR 链接起来，我们使用两个结果值的最大值2。然后，该值用于“干脆的”成
①为清楚起见，图351(e)中的模糊集合Q显示为实线，但请记住，我们在本书中处理的是数字量，因此Q是一个数字函数
②使用AND将各部分连接起来的前提条件可使用最小操作进行类似的计算。 2～2
言：言
114 数字图像处理(第三版)
熟输出隶属度函数的推断处理，该函数是与规则相联系的函数。其余过程与以前一样，就像下面的总结
说明的那样。
图3.52显示了使用两个输入“颜色和坚固性”的水果例子。我们可使用该图和前述内容，把基于
规则的模糊逻辑应用中的主要步骤总结如下。
1.模糊输入 2.应用模糊逻辑操作 3.应用推理方法(最小)
(OR-最大)
绿色 硬 生的
IF颜色是绿色 OR 坚固性是硬的 THEN 水果是生的
黄色 中等硬度 半熟的
IF 颜色是黄色 OR 坚固性是中等硬度的 THEN 水果是半熟的
红色 软 成熟的
IF 颜色是红色 OR 坚固性是软的 THEN 水果是成熟的 4.应用聚合方法
(最大)
输入!
颜色(z)
输入2 5.去模糊
坚固性(c) 输出 (重心)
成熟度(v)
图3.52 说明用于实现一个基于规则的模糊系统的五个基本步骤的例子：(1)模
糊；(2)逻辑操作(该例中仅使用了OR);(3)推断；(4)聚合；(5)去模糊
1.模糊输人：如图3.52所示的前两列那样。对于每个标量输入，通过将该输入映射到区间[0.1].
在每个规则中使用可用的隶属度函数，找到相应的模糊值。
2.执行任何需要的模糊逻辑操作：必须合并前提各个部分的输出，并使用最大或最小操作生成
单个值，具体是用最大操作还是用最小操作，取决于各部分是由OR 连接还是由AND连接。
在图3.52中，前提的所有部分由OR连接，因此全部使用最大操作。前提的各部分的数量和
用于连接这些不同部分的逻辑算子的类型，会因规则的不同而不同。
3.应用一种推断方法：每个规则的前提的单个输出用来提供与规则相对应的输出。对于推断，
我们用AND,它被定义为最小操作。这就以该前提提供的值“修剪”了相应输出的隶属度函
数，如图3.52中的第三列和第四列所示。
4.对来自步骤3的模糊集合应用一种聚合方法：如图3.52中的最后一列所示，每个规则的输出
都是一个模糊集合。必须组合这些模糊集合来产生单个输出模糊集合。这里所用的方法是对
各个输出使用OR操作，因此采用了最大操作。
第3章 灰度变换与空间滤波 115
5.对最后输出的模糊集合去模糊：在最后一步中，我们得到了一个“干脆的”标量输出。这是
通过计算步骤4中得到的聚合模糊集合的重心得到的。
当变量数很大时，实践中通常使用方便的表示方法(变量，模糊集合)来将一个变量与其对应的隶
属度函数配对。例如，规则IF颜色是绿色，THEN 水果是生的，在这里可以写为IF(z,绿色)THEN(v,
生的),如以前那样，变量z和v分别表示颜色和成熟度，而绿色和生的分别是由隶属度函数μren(z)
和μed(V)定义的两个模糊集合。
通常，当处理M个IF-THEN 规则时，N个输入变量z,Z?,…,ZN和一个输出变量v,在图像处理
中最常用的模糊规则公式的类型有如下形式：
IF(z,A?)AND(z?,A??)AND…AND(Zn,A)THEN(v.B?)
IF(z,A??)AND(z?.A?)AND…AND(zn,A?N)THEN(v,B?) …
(3.8-19)
IF(z,Am)AND(z?,AM?)AND…AND(zn,A)THEN(v,BM)
ELSE(v,BE)
其中，A,是与第1个规则和第j个输入变量相关联的模糊集合，B,是与第1个规则的输出相关联的模
糊集合，并且我们已经假设规则的前提分量由AND 连接。注意，我们已介绍过与模糊集合BE相关
联的ELSE规则。当前述规则没有一个完全满足时，执行该规则；其输出后面再解释。
正如早些时候介绍的那样，必须计算每个规则的前提的所有元素，以便得到单一标量值。在图3.52
中，我们使用了最大操作，因为规则是基于模糊OR的。在式(3.8-19)中使用AND,因此我们必须用
最小操作。在式(3.8-19)中，计算第1个规则的前提产生一个标量输出λ,其由下式给出：
λ=min{H(z):j=1,2,…,} (3.8-20)
对于i=1,2,…,M,其中H(z)是模糊集合A,在第j个输入值计算
的隶属度函数。通常，λ,称为第i个规则的强度水平(或点火水平)。
根据前面的讨论，2只是用于剪切第i个规则的输出函数的一个简单
的值。
当THEN 规则的条件很难满足时，执行 ELSE 规则(我们在3.8.5节将给出一个如何使用ELSE
规则的详细例子)。当所有其他规则很弱时，它的响应应该较强。在某种意义上，可以将 ELSE 规则
看成是在其他规则的结果上执行NOT操作。从3.8.2节我们知道μNOT(A)(z)=Hx(z)=1-μA(z)。然后，
在合并(AND)所有级别的THEN 规则中利用这一概念，给出ELSE规则的如下强度水平：
λg=min{1-λ;i=1,2,…,M}
在规则集中是使用OR 还是使用
AND,取决于规则被声明的方式，
法。我们在图 3.52 中使用了OR.
而在式(3.8-19)中使用了AND。
而声明规则的方式则取决于手边的
问题。为便于读者熟悉两者的用
(3.8-21)
我们看到，如果所有THEN 规则在“最大强度”(其响应为1)处点火，则ELSE规则的响应如所期望
的那样是0。当THEN 规则的响应比较弱时，则ELSE规则的强度将增加。这就是软件编程中使用的
IF-THEN-ELSE规则的模糊规则的对应。
当在前提中处理OR时，我们可以简单地在式(3.8-19)中用OR代替AND,并在式(3.8-20)中用
最大(max)代替最小(min);式(3.8-21)保持不变。尽管可以用公式明确表达更为复杂的前提和由此导
致的结果，但仅使用AND或OR开发的公式是相当通用的，并且广泛应用于各种图像处理应用中。
本章末尾的参考文献中包含了其他(但很少使用)的模糊逻辑算子的定义，并探讨了推断(包括多个输
出)和去模糊的其他方法。本节前面的介绍作为这一话题的进一步阅读，是基础性的和服务性的。在
下两节中，我们将说明如何把模糊概念用于图像处理。 晨;退
116 数字图像处理(第三版)
208
3.8.4 使用模糊集合进行灰度变换
考虑对比度增强这样的一般问题，这是灰度变换的主要应用之一。我们可以用如下规则说明灰
度级图像对比度增强的过程：
IF一个像素是暗的，THEN使它较暗。
IF一个像素是灰的，THEN使它仍是灰的。
IF一个像素是亮的，THEN使它较亮。
记住，它们是模糊项，我们可以用图3.53(a)中的隶属度函数来表示暗、灰和亮这些概念。
在输出项中，我们可以将“较暗”考虑为暗灰度值的程度(100??黑是暗色调的极限值),将“较
亮”考虑为亮色调的程度(100??白是极限值),将“灰的”视为中间灰度级中灰度的程度。这里，
所谓的“程度”是一种特定灰度的数量。例如，80??黑是非常暗的灰色。如图3.53(b)所示，当作
为恒定灰度来解释被修改的强度时，输出隶属度函数是单一值(隶属度函数是常数)。在区间[0.1]内，
当单一值被来自相应规则的响应强度裁剪时，会出现各种程度的灰度，正如图3.52的第四列那样(但
应记住，如图中所示，我们这里仅有一个输入，而不是两个)。因为在输出隶属度函数中我们处理的
是常数，故它遵循式(3.8-18),即对于任何输入z,输出v?由下式给出：
=(2)+/)f) (3.8-22)
该表达式中分子和分母的总和比式(3.8-18)中的简单，因为输出隶属度函数是被模糊值修改(裁剪)过
的常数。
a b 1 1
Han(2) Pmm(2) Ha()
0.5 0.5
Pm(2) Pam() Hm()
0L :0- a F
图3.53 基于规则的对比度增强：(a)输入的隶属度函数；(b)输出的隶属度函数
模糊图像处理的计算量很大，因为全部模糊处理、所有规则的前提、推断、聚集和去模糊，都必须
应用到输入图像中的每个像素。这样，使用像式(3.8-22)中那样的单一值，通过简化推断、聚集和去模
糊，可有效地减少计算需求。在处理速度是重要要求的应用中，这些节省是很有意义的。
例3.19 使用基于规则的模糊集的对比度修改的图像增强的说明。
图3.45(a)显示了一幅图像，由于该图像的灰度只占灰度级很窄的范围[见图3.55(a)中的直方图],
给出的是一幅低对比度外观的图像。作为对比的基础，图3.54(b)是直方图均衡后的结果。正如该结果的
直方图显示的那样[见图3.55(b)],扩展整个灰度级的确增加了对比度，但在高端和低端引入了使图像
“过度感光”的外观。例如，爱因斯坦教授的前额和头发的细节大部分都缺失了。图3.54(c)显示了使用
前几段讨论的基于规则的对比度修改方法的结果。图3.55(c)显示了所用的叠加在原图像的直方图上的输
入隶属度函数。输出单一值选择为：v=0(黑),v=127(中间灰度)和v=255(白)。
第3章 灰度变换与空间滤波 117
a b c
图3.54 (a)低对比度图像；(b)直方图均衡后的结果；(c)用基于规则的模糊集合的对比度增强后的结果
比较图3.54(b)和图3.54(c),我们看到后者在色调上有相当大的改进。例如，注意前额和头发中的细
节与图3.54(b)中相同区域的对比。通过研究示于图3.55(d)的3.54(c)的直方图可很容易地解释这种改进
的原因。不像均衡过的图像的直方图那样，该直方图保留了原图像直方图的相同的基本特征。然而，暗
级别(直方图低端的几个高峰值)的左移很明显，从而暗化了级别。对于亮级别则相反。中间灰度稍微地
分离了，比直方图均衡化小了很多。
0 63 127 191 255
(2) Amp(2)
Am()
L0 25S 127 63 191
SS 191 12 A3 世 [o 3 177 191 255 a b
cd
图3.55 (a)~(b)图3.54(a)和(b)的直方图；(c)叠加在图(a)上的输入隶属度函数；(d)图3.54(c)的直方图
在性能上这一改进的代价是加大了处理的复杂性。当处理速度和图像吞吐量是重点考虑的问题时，可
遵循的实际方法是使用模糊集技术来决定什么是看似可很好地平衡图像的直方图。然后，使用更快的技术
如直方图规定化，通过把输入图像的直方图映射到一个或多个用模糊方法确定的“理想”直方图，来达到
类似的结果。
3.8.5 使用模糊集合进行空间滤波
当把模糊集合用于空间滤波时，基本方法是定义一个邻域特性，该特性“截获”滤波器支持检
测的本质。例如，考虑检测一幅图像中区域间的边缘。这在图像处理的应用中是很重要的，例如本节
前面讨论的锐化和第10章将要讨论的图像分割等。
我们可以开发一个基于模糊集合概念的边缘提取算法：“如果一个像素属于平滑区，则令其为白 三～
118 数字图像处理(第三版)
色，否则使其为黑色”,其中“黑色”和“白色”是模糊集合。为了用模糊术语表示“平滑区”这一
概念，我们可以考虑邻域中心处像素和邻域像素间的灰度差。对于图3.56(a)中的3×3邻域，中心像
素(标为z?)和邻域的每个像素间的灰度差形成了图3.56(b)所示的3×3子图像，其中d,表示第i个邻
点和中心点间的灰度差(即d,=z-z?,其中z?为灰度值)。四个IF-THEN 规则和一个ELSE 规则的
简单集合就可以实现本段开始提到的模糊集合概念的本质：
IF d?是0 AND d?是0 THEN z?是白色
IF d?是0 AND dg是0 THEN z,是白色
IF d?是0 AND d?是0 THEN z?是白色
IF d?是0 AND d?是0 THEN z?是白色
ELSE z,是黑色
其中，“0”也是一个模糊集合。每个规则的后项定义一
个值，中心像素(z?)的灰度被映射到该值上。也就是说，
语句“THENz?是白色”意味着位于模板中心位置的像
素的灰度被映射为白色。这些规则简单地表明，如果前
边提到的灰度差为0(在模糊意义下),则中心像素考虑为
平坦区域的一部分；否则，中心像素就考虑为边缘像素。
为简化这个例子，我们仅使用了
4邻域和中心点的灰度差。使用8邻
域可直接扩展此处显示的方法
Z1 Z3 d? d? d?
4 s d? 0 d
Zy d? d d, a b
像素邻域 灰度邻域
图3.57分别显示了模糊集合0、黑色和白色的可能
图3.56 (a)一个3×3像素邻域；(b)中心像素
和其邻点间的相应灰度差。为简化，讨
论当前应用中仅使用了d?,d?.d?和dg
的隶属度函数，其中我们使用ZE,BL和WH 以简化表示。注意，对于一幅具有L个可能灰度级的图
像，模糊集合ZE的自变量的范围是[-L+1,L-1],因为灰度差的范围可以在-(L-1)和(L-1)之间。另一
方面，输出灰度的范围如原图像中那样是[0,L-1]。图3.58以图形方式显示了上面规定的规则，其中，
标为z?的方框指出中心像素的灰度被映射到输出值WH或BL。
WH
WH
元
a b1 ZE BL WH
0
L+ 0 L-10 L-1
灰度差 灰度
图3.57 (a)模糊集合0的隶属度函数；(b)模糊集合“黑色”和“白色”的隶属度函数
IF IF
Zs ZE
ZE
规则2
IF
ZE
ZE Zs
ELSE zs BL 规则4
图3.58 边缘检测的模糊规则
ZE
Zs ZE
规则1
IF
ZE Zs
ZE
THEN
THEN
WH
WH
THEN
THEN
规则3
第3章 灰度变换与空间滤波 119
例3.20 使用基于规则的模糊集合的空间滤波增强边缘的说明。
图3.59(a)显示了一幅512×512的人的头部CT扫描图像，图3.59(b)是使用刚刚讨论的模糊空间滤波
方法的结果。注意，提取区域间边缘的方法的效果，包括大脑的轮廓(灰色区域内部)。图像中的恒定区
域呈现灰色，因为当前面讨论的灰度差接近0时，THEN 规则有一个很强的响应。这些响应依次裁剪函
数WH。输出(裁剪过的三角形区域的重心)是(L-1)/2和(L-1间的一个常数，从而在图像中产生了所看到
的浅灰色调。该图像的对比度可以通过扩展灰度级来显著地改进。例如，图3.59(c)是通过在K=L-1时
执行式(2.6-10)和式(2.6-11)中定义的灰度标定得到的。最终结果是图3.59(c)中灰度值跨过从0到(L-1)的
全部灰度级。
a b c
图3.59(a)人的头部的CT扫描图像；(b)使用图3.57中的隶属度函数和图3.58中的规则的模糊
空间滤波的结果；(c)灰度标定后的结果。(b)和(c)中淡黑色的图像边缘是为增加清晰度
添加的，它们不是数据的一部分(原像由Vanderbilt 大学的David R.Pickens博士提供)
小结
您刚刚了解到的内容是灰度变换和空间滤波中当前使用的有代表性的技术。本章中所包含的主
题都是可以作为发展领域的基础的基本材料而选择的。虽然本章中所用的大多数例子都是关于图像增
强的，但所介绍的技术都是可以通用的，并且在与图像增强完全无关的本书剩余章节中您会再次遇到
它们。在下一章中，我们将再一次注意滤波，但是使用的是频率域的概念。正如您将要看到的那样，
这里研究的线性空间滤波和频率域滤波之间存在着—一对应的关系。
参考文献
3.1 节中的内容来自Gonzalez[1986]的书籍。3.2节内容的辅助读物可以在Schowengerdt[1983],
Poyton[1996]和Russ[1999]中找到。关于图像最佳显示的内容，也可参阅Tsujii等人[1998]的论文。关于直
方图处理的早期参考文献有Hummel[1974],Gonzalez和Fites[1977及Woods和Gonzalez[1981]的著述。
Stark[2000]对自适应对比度增强的直方图均衡给出了重要的概括。对比度增强的其他方法由Centeno和
Haertel[1997]及Cheng和Xu[2000]给出了例子。严格的直方图规定化方面进一步阅读的材料见Coltuc,Bolon
和Chassery[2006]的论著。局部直方图均衡方法的延伸内容见Caselles 等人[1999]和 Zhu 等人[1999]的材
料。对于图像处理中局部统计应用和实现，可以参考Narendra和 Fitch[1981]的著述。Kim 等人[1997]介
绍了一种结合梯度处理与局部统计处理来增强图像的有趣方法。
关于线性空间滤波器及其实现的附加读物可见Umbaugh[2005],Jain[1989]及Rosenfeld和Kak[1982]的
材料。排序滤波器在这些参考材料中也有讨论。Wilbum[1998]也概括地介绍了排序滤波器。Pitas和
Venetsanopoulos[1990]所著的书中涉及了中值滤波器和其他非线性滤波器。IEEE Transaction in Image
212
214
亦
120 数字图像处理(第三版)
Processing[1996]的一期特刊中介绍了非线性图像处理的内容。有关高提升滤波的内容来自Schowengerdt[1983]
的论著。在讨论图像复原(见第5章)和边缘检测(见第10章)时，还会遇到本章中介绍的许多空间滤波器。
习题
3.8节的基础参考材料是L.A.Zadeh 撰写的关于模糊逻辑的三篇论文(Zadeh[1965,1973,1976|)。正如
它们建立的模糊逻辑及其应用基础那样，这些论文是精心书写和有详细阅读价值的。关于模糊逻辑在图
像处理中广泛应用的综述可在Kerre 和Nachtegae[2000]的书中找到。3.8.4节的中例子是以Tizhuoosb[2000]
描述的类似的应用为基础的。3.8.5节中的例子基本上来自Russo 和Ramponi[1994]的论著。模糊集合在灰
度变换和图像滤波中的应用的其他例子可分别参阅 Patrascu[2004]及Nie和Barmer[2006]的论著。前面所述的从
1965年到2006年的参考文献，是详细研究在图像处理中使用模糊集合的许多方法的起点。本章中讨论的许
多方法的软件实现可在Gonzalez,Woods和Eddins[2004]中找到。
标有星号的习题的详细解答
可在本书的网站上找到。该网站还
包含有基于本章内容的建议项目。
★3.1 为了展开一幅图像的灰度，使其最低灰度为C、最高灰度为L-1,试给出一个单调的变换函数。
3.2 一个α为正常数的指数式ear2对于构造平滑的灰度变换函数是非常有用的。从这个基本函数出发，构
造具有下列图形形状的变换函数。所示的常数是输入参数，并且您提出的变换必须以特定形式包含这
些参数(为了简化您的答案，第三条曲线中不需要参数L)。
s=7) s-T) s=T(
A B D
A/3 B/4 c
L。 L 0
(a) (b) (c)
3.3★(a)试给出实现图3.2(a)所示的对比度拉伸变换的一个连续函数。此函数不仅包含参数m,而且还
必须包含参数E.以便控制灰度值由低向高变化时函数的斜率。该函数应归一化，以使其最小
值和最大值分别为0和1。
(b)画出作为参数E的函数的一组变换，固定值m=L/4.其中L是图像中灰度的级数。
(c)为使函数如图3.2(b)的函数那样有效地执行，E的最小值是什么?换句话说，您的函数与图3.2(b)
可以不同。它仅有产生一幅二值图像相同的结果。假设使用8比特图像进行处理，并使m=128。
另外，令C是您正使用的计算机中所能表示的最小正数。
3.4 提出一组能够产生4比特单色图像所有单独比特平面的灰度分层变换(例如，变换函数T(r),当r
在[0,7]范围内时，T(r)=0,而当r在[8,15]范围内时，T(r)=15,此函数可以产生一幅8比特图像的
第4比特平面图像)。
3.5★(a)通常，如果将低阶比特平面的一半设为零值，对一幅图像的直方图有何影响?
(b)如果将高阶比特平面的一半设为零值，对一幅图像的直方图有何影响?
★3.6 试解释为什么离散直方图均衡技术一般不能得到平坦的直方图?
3.7 假设对一幅数字图像进行直方图均衡处理。试证明(对直方图均衡后的图像)进行第二次直方图均
衡处理的结果与第一次直方图均衡处理的结果相同。
3.8 在某些应用中，将输入图像的直方图模型化为高斯概率密度函数是很有用的，高斯概率密度函数的
形式为
第3章 灰度变换与空间滤波 121
p.)=
其中m和o分别是高斯概率密度函数的均值和标准差。具体处理方法是将m和o看成是给定图像
的平均灰度级和对比度。对于直方图均衡，您所用的变换函数是什么?
★3.9 假设图像的像素值是连续的，用一个例子说明有可能存在这样的情况，即由式(3.3-4)给出的变换
函数满足3.3.1节中的条件(a)和(b),但其反变换却不能满足条件(a)。
3.10(a)证明式(3.3.8)中给出的离散变换函数对直方图均衡处理满足3.3.1节中的条件(a)和(b)。
★(b)证明只有在灰度n,k=0,1,…,L-1不丢失的情况下，式(3.3-9)表示的离散直方图反变换才满
D?(z) 足3.3.1节中的条件(a')和(b)。 p.(r)
3.11 一幅灰度范围在[0.1]内的图像的概率密度函数p,(r)如右图所 2 示。现对此图像进行灰度变换，使其灰度分布为所示的p:(z)。
假设灰度值连续，求完成这一要求的变换(表示为r和z的函数)。
2
★3.12 试提出一种如3.3.3节中讨论的局部增强技术的局部直方图修正
方法。 1
3.13 有两幅图像f(x,y)和g(x,y),它们的直方图分别为h,和h,
给出根据h,和h,确定如下直方图的条件，并解释如何获得每种情形下的直方图：
051
★(a) f(x,y)+g(x,y)。
(b)f(x,y)-g(x,y)。
(c)f(x,y)×g(x,y)。
(d)f(x,y)+g(x,y)。
(e)f(x,y)*g(x,y)。
3.14 右侧所示的图像是很不同的，但它们的直方图却相同。假
设每一幅图像都用一个3×3均值模板来进行模糊处理。
(a)模糊后图像的直方图还相同吗?试解释原因。
(b)如果您的答案是不相同，画出两个直方图。
3.15 线性空间滤波的实现要求在整幅图像中移动模板的中心点，并且在每个位置计算模板系数与该位置
相应像素值的乘积之和(见3.4节)。一个低通滤波器可以用置所有系数为1的模板来实现，可使用所
谓的盒状滤波器或移动均值算法，该方法由仅更新从一个位置到下一个位置变化的计算部分组成。
★(a)以公式形式给出一个n×n滤波器的算法，说明涉及的计算规律，以及用于围绕图像移动模板
的扫描序列。
(b)大规模执行的计算量与盒状滤波器算法执行的计算量的比值，称为计算优势。在本例情况下求
出计算优势，并作为n的函数画一条曲线，其中 n>1。由于这两种处理方法的标定参数都是
1/n2,因此在获得计算优势时根本不用考虑它的影响。假设图像有为0的外部边界，这个边
界宽到足以让我们在分析中忽略边界的影响。
3.16★(a)假如采用如式(3.4-2)定义的卷积方法用空间滤波模板w(x,y)对图像f(x,y)滤波，其中模板在
两个空间方向上都小于图像。证明如下重要特性：如果模板的系数之和是0,则得到的卷积阵
列(被滤波的图像)中所有元素之和也是0(您可以忽略计算的不准确性)。另外，您可以假设图
像的边界已用合适数量的0填充过。
(b)如果用式(3.4-1)定义的相关方法来实现滤波，问得到的结果与(a)的结果相同吗? 引
22
122 数字图像处理(第三版)
3.17 讨论用一个3×3低通空间滤波器反复对一幅数字图像处理的结果，可以不考虑边界的影响。应用
5×5滤波器时有何不同?
3.18★(a)在3.5.2节中谈到，(相对于背景而言)孤立的暗或亮像素团块，在它们的面积小于中值滤波器
面积的一半时，可被中值滤波器滤除(强迫为邻域的中值)。假设滤波器尺寸为n×n,n 为奇
数，解释为什么会这样。
(b)考虑一幅有不同像素团块的图像。假设一个团块中的所有点都比背景亮或暗(同一团块中不同
时存在这两种情形),并且每个团块的面积不大于n2/2。请问 n符合什么条件时，有一个或
多个这样的团块像(a)中所说的那样被分离出来?
★3.19(a)试给出求一个nxn邻域的中值的步骤。
(b)试提出一种逐像素地移动邻域的中心来更新中值的技术。
3.20(a)在字符识别应用中，文本页用图3.2(b)所示的阈值变换函数简化为二值图像。这遵循如下过程.
即细化字符直到它们成为全“0”背景上的一串“1”。由于有噪声存在，故二值化和细化处
理导致了字符的断开，断开缝隙有1~3个像素宽。修复缝隙的一种方法是对二值图像使用
均值模板来模糊它，这样会在缝隙间桥接非零像素。试求出能执行该任务的均值模板的最小
尺寸。
(b)桥接缝隙后，为了转换回二值形式，要对图像进行阈值处理。根据您在(a)中得出的答案，完
成这一任务且不再产生断线所要求的最小阈值是多少?
★3.21 以下所示的三幅图像是分别通过尺寸为n=23,25和45的方形均值模板处理后的模糊图像。图(a)
和图(c)中左下角的垂直竖条被模糊了，但竖条与竖条之间的分割仍然很清楚。然而，尽管产生这
幅图像的模板要比处理图像(c)的小得多，但图(b)中的竖条却已经融在了一起。试解释这一现象
的原因。
a
a) (b) e)
3.22 考虑图3.34所示的应用，该应用的目的是消除图像中比q×q像素方形包围的物体小的目标。假设
想要将目标的平均灰度减少为原来平均灰度的1/10。使用这种方法，那些目标可以接近背景灰度
并用阈值法消除。给出平均模板的最小尺寸(奇数),该模板仅对整幅图像处理一次就可将平均灰
度级减少到所希望的程度。
3.23 在给定应用中，一个均值模板被用于输人图像以减少噪声，然后再用一个拉普拉斯模板来增强图
像中的细节。如果交换一下这两个步骤的顺序，结果是否会相同?
★3.24 证明如式(3.6-3)所示的拉普拉斯变换是各向同性的(旋转不变的)。您将需要下列轴旋转θ角的坐
标方程：
x=xcosθ-y'sinθ
y=xX'sinθ+y'cosθ
其中(x,y)为未旋转的坐标，而(x,y)为旋转后的坐标。
★3.25 您在图3.38 中看到中心为-8的拉普拉斯模板所得到的结果，要比中心为-4的模板所得到的结果
清晰一些。详细说明其原因。
第3章 灰度变换与空间滤波 123
3.26 参考习题3.25。
(a)若使用一个类似拉普拉斯的较大模板，如中心系数为-24的5×5模板，问是否可得到更加清晰
的结果?详细解释一下。
(b)当该模板的大小与图像大小相等时，会发生什么情况?
3.27 给定一个5×5模板，使用该模板来对一幅图像执行非锐化模板处理。假设均值图像使用高斯滤波
器得到。
★3.28 使用式(3.6-6)给出的拉普拉斯定义，证明从一幅图像中减去相应的拉普拉斯图像等同于对图像进
行非锐化模板处理。
3.29 (a)证明式(3.6-11)给出的梯度幅值是一种各向同性的操作(见习题3.24)。
(b)如果使用式(3.6-12)计算梯度，证明其将失去各向同性这一性质。
3.30 使用一台CCD电视摄像机对某一区域用于每天24小时、每月30天对同一区域进行长期观测研究。
每5分钟拍摄一次数字图像并传送到中心场所。场景的照明白天为自然光，晚上为人造光，没有
无照明的时间，因此总可以获得一幅图像。由于照明的范围总是在摄像机的线性工作范围，因此
摄像机本身并不需要使用任何补偿装置。另外，使用数字技术对图像进行后处理并归一化，这样
就使得图像与恒定照明是等效的。对此，请设计一种方法。您可以自由使用您希望的任何方法，
但必须在设计中明确给出所有的假设。
3.31 证明图3.46(d)中的交叉点由b=(a+c)/2给出。
3.32 使用3.8.2节定义的模糊集合和图3.46中的基本的隶属度函数，形成下列隶属度函数。
1 1 1
0.5 0.5 0.5
0
1
0
a-ca-ba a+ba+c a a+b Cc+d 20 a-ba=05a+b
★(a) (b) (c)
★3.33 在3.8.5节讨论的模糊滤波方法中，增大邻域的尺寸会产生什么影响?对您的回答解释其原因(您可
以用一个例子来支持您的答案)。
3.34 为了减少一幅具有区间[0,L-1]内的灰度值的含噪图像的脉冲噪声影响，如3.8.5节那样，设计一个
基于规则的模糊系统。为简化问题，仅在一个3×3邻域中使用差值d?,d?,d?和dg。在图像的任何
位置，令z,表示邻域中心的灰度。相应的输出灰度值应是么=z?+v,其中v是您的模糊系统的输
出。也就是说，您的模糊系统的输出是一个用于减少可能出现在该3×3邻域中心的噪声峰值效应
的校正因子。假设出现的噪声峰值间距足够大，因此，不必关心在同一邻域内出现多个噪声峰值。
这些峰值可以是暗的或亮的。全部使用三角形隶属度函数。
★(a)给出该问题的一条模糊语句。
★(b)指定IF-THEN 规则和ELSE规则。
(c)如图3.57那样，以图形方式指定隶属度函数。
(d)如图3.58那样，给出规则集的图形表示。
(e)请您给出一个类似于图3.52的模糊系统的简略图。
眼;同
同引
第4章 频率域滤波
滤波器：抑制或最小化某些频率的波或振荡的装置或材料。
频率：自变量单位变化期间，一个周期函数重复相同值序列的次数。
——韦伯斯特新学院词典
引言
尽管在前一章中对空间滤波做了重点研究，但如果不了解在图像滤波中如何应用傅里叶变换和
频率域的基本知识，要彻底理解这一领域也是不太可能的。您不是一位信号处理专家也能深刻理解
这些主题，关键在于要关注基本原理以及它们与数字图像处理的关系。本章将重点阐述对初学者来
说较为困难的表示方法，并强调图像特征与用于表示这些特征的数学工具之间的联系。本章主要为傅
里叶变换的基本原理打下一个基础，并介绍在基本的图像滤波中如何使用傅里叶变换。然后，在第 5
章、第8章、第10章和第11章中，我们将讨论傅里叶变换的其他应用。本章从傅里叶变换的起源
及其应用于数学、科学及工程的众多分支的要点开始讨论。然后，我们从函数取样的基本原理开始，
逐步推导一维和二维离散傅里叶变换以及频率域处理的要领。在这段阐述中，我们还要接触几个重要
的取样问题，例如，混淆，这些处理要求对频率域的理解，且在本章也有很好的覆盖。接下来是频率
域滤波的公式表示，以及与第3章中讨论的空间平滑和锐化滤波技术相对应的部分。我们以在图像处
理中实现傅里叶变换的有关问题的讨论结束本章。因为4.2节到4.4节的内容是基本背景知识，对一
维信号处理，包括傅里叶变换、取样、混淆和卷积定理很熟悉的读者可直接跳到4.5节，在这里，我
们开始讨论二维傅里叶变换及其在数字图像处理中的应用。
4.1 背景
4.1.1 傅里叶级数和变换简史
法国数学家吉恩·巴普提斯特·约瑟夫·傅里叶(Jean Baptiste Joseph Fourier)于1768年生于巴黎
与第戎之间的奥克塞里(Auxerre)镇。他被世人铭记的最大贡献记载在他于1807年发表的传记中和
1822年出版的La Theorie Analitique dela Chaleur(热分析理论)一书中。此书由 Freeman(参见 Freeman
[1878])在55年后翻译为英文。傅里叶在这个领域的贡献是，他指出任何周期函数都可以表示为不同
频率的正弦和/或余弦之和的形式，每个正弦项和/或余弦项乘以不同的系数(现在称该和为傅里叶级
数)。无论函数多么复杂，只要它是周期的，并且满足某些适度的数学条件，都可以用这样的和来表
第4章 频率域滤波 125
示。我们现在认为这是理所当然的，但在当时，这个概念第一次出现之后，一个复杂函数可以表示为
简单的正弦和余弦之和的概念一点也不直观(见图4.1),所以傅里叶思想遭到怀疑是不足为奇的。
甚至非周期函数(但该曲线下的面积是有限的)
也可以用正弦和/或余弦乘以加权函数的积分来表
示。在这种情况下的公式就是傅里叶变换，其作用
在多数理论和应用学科中甚至远大于傅里叶级数。
用傅里叶级数或变换表示的函数特征完全可以通过
傅里叶反变换来重建，而不会丢失任何信息。这是
这种表示方法的最重要特征之一，因为它可以使我
们工作于"傅里叶域",而且在返回到函数的原始
域时不会丢失任何信息。总之，傅里叶级数和变换
是解决实际问题的工具，它作为基础工具被广泛地
学习和利用。
WWWWWW
傅里叶概念的最初应用是在热扩散领域，在该
领域，人们考虑用微分方程来表示热流动，并且使
用这种方法第一次获得了结论。在过去的一个世纪
中，尤其是后50年，傅里叶的思想使整个工业和
学术界都空前繁荣。早在20世纪60年代(或更晚
些),数字计算的出现和快速傅里叶变换算法(FFT)
的“发现”在信号处理领域产生了巨大变革。这
两种核心技术第一次允许人们对从医学监视器和
扫描仪到现代电子通信的异常重要的信号进行实
际处理。
图4.1 底部的函数是其上面4个函数的和。1807年，
傅里叶关于周期函数可以表示为正弦和
余弦的加权和的概念遭到了人们的质疑
由于我们将仅处理持续时间有限的函数(图像),所以傅里叶变换是我们感兴趣的工具。在以下
一节的内容中，将介绍傅里叶变换和频率域。业已证明，傅里叶技术为研究和实现主要的图像处理算
法提供了有意义且实用的方法。在某些情况下，这些方法与我们在第3章中介绍的方法类似。
4.1.2 关于本章中的例子
如第3章那样，在这一章中，多数图像滤波例子是处理图像增强问题。例如，平滑和锐化与对
比度处理技术一样，与图像增强有传统的联系。非常自然，数字图像处理方面的初学者会发现图像增
强很有趣并很容易理解。因此，在本章中以图像增强为例不仅可节省本书额外的章节，而且更重要的
是我们将为初学者介绍频率域滤波技术提供一个有效的工具。在第5章、第8章、第10章和第11章
中，对于其他应用我们用频率域处理方法。
4.2 基本概念
为简化本章的概念出现的进程，我们暂时停止介绍为后面的章节打基础的内容的一系列基本概念。
4.2.1 复数
复数C的定义如下：
C=R+jl (4.2-1) 2：2
22
126 数字图像处理(第三版)
其中，R和1是实数，j是一个等于-1的平方根的虚数，即j=√-1。R表示复数的实部，1是复数的
虚部。实数是I=0的复数的子集。一个复数C的共轭表示为C,其定义是
C=R-jl (4.2-2)
复数从几何的角度可以被看成是平面(称为复平面)上的一个点，其横坐标是实轴(R的值),其纵坐标
是虚轴(I的值)。也就是说，复数R+j/是复平面直角坐标系统中的点(R,I)。
有时，在极坐标下表示复数很有用：
C=|C|(cosθ+jsinθ) (4.2-3)
其中，|C=√R2+I2是复平面的原点到点(R.D)的向量的长度，θ是该向量与实轴的夹角。在第一象
限中为向量画一个实轴和虚轴的简图将显示出tanθ=(1/R)或θ=arctan(I/R)。arctan 函数返回区间
[-π/2,π/2]内的一个角度。然而，因为I和R可独立为正和负，因此我们需要能够得到全域[-π,π]
内的角度。在计算θ时，可通过简单地跟踪I和R的符号来完成。许多编程语言可通过调用四象限反
正切函数来自动地计算角度。例如，MATLAB为此目的提供了函数atan2(Imag,Real)。
使用欧拉公式
e?=cosθ+jsinθ (4.2-4)
其中，e=2.718 28…,可给出极坐标下我们很熟悉的如下复数表示：
C=|c|e (4.2-5)
其中，|C|和θ的定义如上。例如，复数1+j2的极坐标表示是√5e,其中θ=64.4°或1.1弧度(rad)。
前面的公式还可以用于复函数。例如，变量a的复函数F(u)可表示为F(u)=R(u)+jlu),其中R(u)和
(u)分别是实分量函数和虚分量函数。正如前面说明的那样，复共轭函数是F'(w)=R(u)-jl(u),幅值
是|F(w|=√R(u)2+1(u)2,角度是(u)=arctan[(u)/R(u)]。在本章和下一章中，我们还会多次讨论
复函数。
4.2.2 傅里叶级数
正如4.1.1节指出的那样，具有周期T的连续变量t的周期函数fr)可以被描述为乘以适当系数的
正弦和余弦和。我们知道，这个和就是傅里叶级数，它具有如下形式：
ro=2. (4.2-6)
其中，
c=foe7d,n=0,±1,±2,… (4.2-7)
是系数。式(4.2-6)可展开为正弦与余弦之和这一事实来自欧拉公式(4.2-4)。在本章的后面，我们将
回到傅里叶级数。
4.2.3 冲激及其取样特性
线性系统和傅里叶变换研究的核心是冲激及其取样特性。连续变
量t在t=0处的单位冲激表示为8(1),其定义是
冲激并不是通常意义上的函数。
其更准确的名称是分布或广义函
数。但是，我们在文献中通常会看
到冲激函数、8函数和狄拉克δ函数
这样的名称，尽管它们都名不副实。
第4章 频率域滤波 127
80={00 (4.2-8a)
它还被限制为满足等式
?_8(@)dr=1 (4.2-8b)
物理上，如果我们把t解释为时间，那么一个冲激可看成是幅度无限、持续时间为0、具有单位面积
的尖峰信号。一个冲激具有关于如下积分的所谓取样(sifting)特性：
厂_f()δ()dr=f(0) (4.2-9)
假设f(t)在t=0处是连续的，这是实际中满足的一个典型条件。取样
特性得到函数f()在冲激位置(也就是，在前面的公式中为原点t=0)
的值。取样特性的一种更为一般的说明涉及位于任意点t。的冲激，表
示为8(t-t?)。在这种情况下，取样特性变为
_fo)8(-)dr=f(o)
sit字面上的意思是分隔，或通过
一个筛子分拣
(4.2-10)
它在冲激位置t。处得到一个函数值。例如，如果f()=cos(t),使用式(4.2-10)中的冲激δ(t-π)得到
结果f(π)=cos(π)=-1。取样概念的能力立即变得相当明显。
令x表示一个离散变量。单位离散冲激δ(x)在离散系统中的作用与处理连续变量时冲激δ(t)的
作用相同。其定义如下：
8x)={6x=0 (4.2-11a)
很明显，该定义也满足式(4.2-8b)的离散等效形式：
∑8u)=1 (4.2-11b)
离散变量的取样特性有如下形式：
∑ra&w)=f(o) (4.2-12)
或者，更一般地用位置x=x?处的离散冲激，
∑ras?u-)=r(%) (4.2-13)
如前面一样，我们看到，取样特性可简单地得到冲激位置处的函数值。图4.2 以图解方式显示了单位
离散冲激。与其连续形式不同的是，离散冲激是一个普通函数。
本节后面特别感兴趣的是冲激串sr(1),它定义为无限多个分离的周期冲激单元△T之和：
0=∑8u-AT) (4.2-14)
图4.3显示了一个冲激串。冲激可以是连续的或离散的。 受因
128 数字图像处理(第三版)
2：2
Sar(0
8(x-x)
1
x
0 Xu …-3△T-2AT-△T 0△T 2△T 3AT…
图4.2 位于x=x?处的单位离散冲激。变量x是
离散的，任何不在x=x?处的δ都是0
图4.3一个冲激串
4.2.4 连续变量函数的傅里叶变换
由3(f(1}表示的连续变量r的连续函数f(1)的傅里叶变换由下式定义①:
Sf0)=?_f()eP2dr (4.2-15)
其中，μ也是一个连续变量。因为t被积分过了，故S[f()}仅是μ的函数。为了明确表示这一事实，
我们把傅里叶变换写成3(f(1)}=F(A);也就是，为了方便，f(t)的傅里叶变换可写为
F(u)=?f(r)e-2d (4.2-16)
相反，给定F(μ),通过傅里叶反变换可以获得f(t),即f(1)=3?(F(A)},写为
f0=?[F()edp (4.2-17)
这里，我们使用了这样一个事实，即在反变换中变量μ被积分过了，并简单地写成f(t),而不是更
麻烦地表示为f(t)=3?'(F(μ))。式(4.2-16)和式(4.2-17)合起来称为傅里叶变换对。它们指出了在
4.1节中提到的一个重要事实，即一个函数可以由其变换来恢复。
用欧拉公式，我们可以把式(4.2-16)表示为
F(μ)=?_fo)[cs(2mu)-jsin(2πμ)]dr (4.2-18)
我们看到，如果f()是实数，那么其变换通常是复数。注意，傅里叶变换是f(1)乘以正弦项的
展开，正弦项的频率由μ的值决定(如早些时候提到过的，变量t被积分过了)。因为积分后左边剩下的
唯一变量是频率，故我们说傅里叶变换域是频率域。在这一章稍后，我们将详细地讨论频率域及其特性。
在我们的讨论中，t可以表示任何连续变量，频率变量μ的单位取决于t 为与前两章中使用的术语保持一
的单位。例如，如果t表示单位为秒的时间，则μ的单位为周/秒，或者 致，并在本章后面用于图像，当变
量：用于说明图像时，我们一般将变 赫兹(Hz)。如果t表示的是以米为单位的距离，则μ的单位是周/米， 量：的域称为空间域
等等。换句话说，频率域的单位是独立于输人变量的每单位周期的。
①声明傅里叶变换存在的条件一般来说很复杂(Champeney[1987),但其存在的充分条件是f(0)的绝对值或/()的平方的积分是有
限的。实践中傅里叶变换的存在性通常不是问题，但理想信号除外，因为这种正弦信号会无限扩展。这些内容可使用通用的冲
激函数来处理。我们的主要兴趣在于离散傅里叶变换对，它是所有有限函数存在的保证，后面我们很快会看到这一点=
第4章 频率域滤波 129
例4.1 求一个简单函数的傅里叶变换。
图4.4(a)中的函数的傅里叶变换可由式(4.2-16)得出：
F(μ)=?_f(e-2d=Jw2Ae?d
j2u[e=j2A[e-e]
-A[-e*]-Aw(w
其中，我们利用了三角学恒等式sinθ=(ei?-e-?)/2j。在这种情况下，傅里叶变换的复数项精细地合并
为一个实正弦函数。前面表达式的最后一步是熟知的sinc 函数：
inc(m)=S(Cm) (4.2-19)
其中，sinc(O)=1,对于m的所有其他整数值，sinc(m)=0。图4.4(b)显示了F(μ)的曲线。
通常，傅里叶变换包含复数项，且为显示目的，通常处理该变换的幅值(一个实量),该幅值称为傅
里叶谱或频谱：
P(a)=AWc
图4.4(c)显示了作为频率的函数的|F(μ)的曲线。我们注意的关键特性是F(H)和|F(u)的零值位置与“盒
状”函数的宽度 W成反比，即波瓣的高度随函数距原点的距离降低，并且函数在μ值的正方向和负方向
上无限扩展。正如您在稍后将会看到的那样，这些性质对解释图像的二维傅里叶变换谱十分有用。
a be f(0 F(A) IF(a)l
AW AW
A
-1/W
-W/2 0 W/2 0
…-2/W- 2/W… …-2/W 01/w-2/W.. -1/W
图4.4 (a)一个简单的函数；(b)该函数的傅里叶变换；(e)该函数的谱。所有函数在两个方向上都无限扩展
例4.2 冲激和冲激串的傅里叶变换。
位于原点的单位冲激的傅里叶变换由式(4.2-16)给出：
F(u)=?_8u)e =?[eP8ob=e=e°=1
其中，第三步由式(4.2-9)中的取样特性得出。这样，我们看到，一个位于空间域原点的冲激的傅里叶变
换，在频率域是一个常数。类似地，位于t=t?的一个冲激的傅里叶变换是
F(u)=?_8u-?)edr=?[e-8(-to)d=em=cos(27uo)-jsin(2mu)
公式的第三步由式(4.2-10)中的取样特性得到，最后一行由欧拉公式得到。最后两行是以复平面原点为中
心的单位圆的等效表示。 品
引
130 数字图像处理(第三版)
在4.3节，我们将利用周期冲激串的傅里叶变换。得到这个变换并不像我们得到刚才显示的单个冲激
的变换那样简单。然而，理解如何推导一个冲激串的变换是十分重要的，因此这里我们花一些时间来详
细推导它。我们从仅在形式上与式(4.2-16)和(4.2-17)的指数符号上有些不同的注释开始。这样，如果函
数f1)有傅里叶变换F(μ),则在点t求值后函数是F(1),它一定有变换f(-μ)。使用这种对称特性和上
面给出的冲激δ(t-t?)的傅里叶变换是e-,可得函数e-2的变换为δ(-μ-t?)。令-to=a,可得
e-的变换是δ(-μ+a)=δ(μ-a),其中最后一步是正确的，因为δ仅在μ=a时不为零，对于
δ(-μ+a)或δ(μ-a),结果均相同，因此这两种形式是等价的。
式(4.2-14)中的冲激串sr(1)是周期为AT的周期函数，因此由4.2.2节可知它可表示为一个傅里叶级数：
=2
其中， ce
参考图4.3,我们看到区间[-AT/2,AT/2]的积分仅包含位于原点的冲激sAr(t)。因此，上面的公式变为
-i8med--六
然后，傅里叶级数可展开为
(0=—2
我们的目的是得到该表达式的傅里叶变换。因为求和是线性过程，得到和的傅里叶变换与求各个分
量的傅里叶变换之和是相同的。这些分量是指数形式，在这个例子中，我们早些时候已确立
e}=5(u-)
因此，周期冲激串sAr(1)的傅里叶变换S(μ)是
su)=SpaO-{位2-云s2}-六26(-)
这个基本结果告诉我们，周期为△T的冲激串的傅里叶变换还是冲激串，其周期为1/AT。SAr(1)和S(μ)
之间周期的这种反比关系与图4.4中盒状函数及其变换之间的关系是类似的。这种特性在本章的其余部分
中扮演着主要角色。
4.2.5 卷积
在讨论之前，我们还需要建立一个模块。我们在3.4.2节介绍过卷积的概念。在那一节，您已了
解两个函数的卷积涉及一个函数关于原点做翻转(旋转180°)并滑过另一个函数。在滑动过程中的每
一个位移处我们执行计算，在第3章的情况下是计算乘积之和。在当前讨论中，我们的兴趣在于具有
连续变量：的两个连续函数f(t)和h(t)的卷积，因此我们必须用积分代替求和。像之前那样，这两个
函数的卷积由算子★表示，卷积定义如下：
f0)*hu)=?f(z)hu-t)dr (4.2-20)
第4章 频率域滤波 131
其中，负号表示刚刚提及的翻转，t是一个函数滑过另一个函数的位移，而t是积分假变量。现在我
们假定函数从-○扩展到。
在图3.4.2中我们说明了卷积的基本机制，而且在本章稍后和第5章中我们会再次说明它。此时，
我们的兴趣在于寻找式(4.2-20)的傅里叶变换。我们从式(4.2-15)开始：
s{r0)*hOo}=[_f(uh(-rdrler=?[r(m[J_hu-t)eardr
方括号中的项是ht-t)的傅里叶变换。我们在本章稍后将证明
3(h(t-t)}= H(μ)e-2ur,其中H(μ)是h(t)的傅里叶变换。在前
一公式中利用这一事实可得
s{f(1)*hO}=?f(r)[H()e “]dr=H(u?_f(T)ePdr=H(H)F(u)
回顾一下4.2.4节，我们将t所在的域称为空间域，而将μ所在的域称为频率域，前面的公式告诉我
们，空间域中两个函数的卷积的傅里叶变换等于两个函数的傅里叶变换在频率域中的乘积。反过来，
如果有两个变换的乘积，那么我们可以通过计算傅里叶反变换得到空间域的卷积。换句话说，
f(1)★h(t)和H(μ)F(u)是傅里叶变换对。这一结果是卷积定理的一半，并可以写为
f(1)★h()?H(μ)F(1)
如果颠倒f0r)和h()的顺序，可
以得到相同的结果，故卷积满足交
换律。
(4.2-21)
双箭头用于指示右边的表达式是通过对左边的表达式执行傅里叶变换得到的，而左边的表达式是通过
求右边的表达式的傅里叶反变换得到的。
遵循类似的推导可得到卷积定理的另一半：
f(1)h(t)?H(μ)★F(μ) (4.2-22)
它说明频率域的卷积类似于空间域的乘积，两者分别与傅里叶正、反变换相联系。正如在本章稍后您
将看到的那样，卷积定理是频率域滤波的基础。
4.3 取样和取样函数的傅里叶变换
在这一节，我们将利用4.2节的概念系统地阐述取样的数学基础。这将从基本原理开始引导我们
学习取样函数的傅里叶变换。
4.3.1 取样
用计算机处理之前，连续函数必须转换为离散值序列。正如2.4节介绍的那样，这是用取样和量
化来完成的。在下面的讨论中，我们将详细地研究取样。
参考图4.5,考虑一个连续函数f(),我们希望以独立变量t的均匀间隔(△T)取样。我们假定函
数对于t从-∞到～扩展。如4.2.3节讨论的那样，模拟取样的一种方法是用一个△T单位间隔的冲激
串作为取样函数去乘以f(l),即
jo=rOso=∑roiu-nAT) (4.3-1)
其中，f(1)表示取样后的函数。这一和式的每一个分量都是由在该冲激位置处f()的值加权后的冲激， 同;空
234
132 数字图像处理(第三版)
如图4.5(c)所示。每个取样值由加权后的冲激“强度”给出，我们可通过积分得到它。也就是，序列中的
任意取样值f由下式给出： 按AT 单位间隔取样表明取样率
等于1/AT。如果△T的单位为秒， f=?_fo8u-kAT)d=f(kAT) (4.3-2)
其中，我们利用了式(4.2-10)中δ的取样特性。式(4.3-2)对任何整数
k=…,-2,-1,0,1,2,…都成立。图4.5(d)显示了结果，它由原始函数的
等间隔取样组成。
f()
则采样率的单位是取样数/秒。如果
AT的单位是米，则取样率的单位
是取样数米，依次类推。
b
07
0
Sar(0
…-2AT-AT0 AT 2AT
f()sar(1)
-2AT-AT0 △T 2AT
A=f(kAT)
-2-1 k
0 1 2
图4.5(a)一个连续函数；(b)用于模拟取样过程的冲激串；(c)图(a)和图(b)相乘形成的取样后的函数；
(d)由积分并使用冲激的取样特性得到的取样值[图(c)中的虚线仅供参考，它不是数据的一部分]
4.3.2 取样函数的傅里叶变换
令F(μ)代表连续函数f(t)的傅里叶变换。如前节讨论的那样，取样后的相应函数f1)是fI)
与一个冲激串的乘积。由4.2.5节的卷积定理我们可知，空间域两个函数乘积的傅里叶变换是两个函
数在频率域的卷积。这样，取样后的函数f(1)的傅里叶变换F(μ)是
F(A)=S(f(0}=3{f()sar(1)}=F(u)★S(μ) (4.3-3)
其中，由例4.2可知
s(u)=六∑8-) (4.3-4)
第4章 频率域滤波 133
是冲激串sr(1)的傅里叶变换。由式(4.2-20)中的定义我们可直接得到F(μ)和S(μ)的卷积：
F(H)=F(u)*S(u)=?_F(z)S(u-t)dr
六[∑6(u--r2[Fio(u-- (4.3-5)
云ZF(u--)
其中，最后一步来自于由式(4.2-10)给出的冲激取样特性。
式(4.3-5)中最后一行的求和表明，取样后的函数f(t)的傅里叶变换F(μ)是F(μ)的一个拷贝的无
限、周期序列，也是原始连续函数的傅里叶变换。拷贝间的间隔由1/△T的值决定。很明显，虽然f(1)是
取样后的函数，但其变换F(μ)是连续的，因为它由F(μ)的几个拷贝组成，所以F(μ)是一个连续函数。
图4.6是前面结果的一个图示总结①。图4.6(a)是函数f(t)的傅里叶变换F(μ)的简图，图4.6(b)
显示了取样后的函数的变换F(μ)。正如前节提到的那样，1/AT是用于生成取样后的函数的取样率。
因此，在图4.6(b)中，取样率要足够高，以便在周期之间提供有效的间隔，并保持F(μ)的完整性。
在图4.6(c)中，取样率刚好足以保持F(μ),但在图4.6(d)中，取样率低于保持不同F(u)拷贝的最小
取样率要求，这样，就不能保持原始变换。图4.6(b)是对信号过取样后的结果，图4.6(c)和(d)分别是
对信号临界取样和欠取样后的结果。这些概念是下一节内容的基础。
a
b
F(a)
cd
0
F(u)
-2/AT -1/△T 0 1/AT 2/AT
F(μ)
-2/AT -1/△T 0 1/AT 2/△T
Fμ)
-3/△T -2/△T -1/AT 0 1/AT 2/AT 3/AT
图4.6(a)一个带限函数的傅里叶变换；(b)~(d)分别在过取样、临界取样、欠取样条件下取样后的函数的傅里叶变换
①为清楚起见，图4.6中傅里叶变换的草图及本章中的其他类似图形，忽略了变换一般是复函数这一事实。 因：冠
134 数字图像处理(第三版)
4.3.3 取样定理
我们在2.4节中直观地介绍了取样的概念。现在，我们考虑形式上的取样过程，并确立一个条件，
在该条件下，一个连续函数完全可由其取样集合来恢复。
对于以原点为中心的有限区间(带宽)[-HmxHmx1之外的频率值，其傅里叶变换为零的函数
f(t)称为带限函数。图4.7(a)就是这样一个函数，它是图4.6(a)的一个放大部分。类似地，图4.7(b)是
图4.6(c)所示临界取样后的函数的傅里叶变换更详细的视图。较低的1/AT值将导致F(μ)中的周期融
合，较高的1/△T值在周期之间会提供更为清晰的间隔。
如果能从F(μ)中包含的这个函数的拷贝的周期序列中分离出F(μ)的一个拷贝，那么我们就可
以从取样后的版本复原f(0),其中F(μ)是取样后的函数f(t)的傅里叶变换。回顾前节的讨论，F(μ)
是周期为1/AT的连续周期函数。因此，我们需要一个完整的周期来表征整个变换。这意味着我们用
傅里叶反变换从一个单周期就可恢复f(1)。
如果拷贝间的间距足够(见图4.6),从F(μ)提取一个单周期使其等于F()是可能的。根据图4.7(b),
如果12AT>μm或者
> (4.3-6)
则可保证有足够大的间距。该公式指出，如果以超过函数最高频率的两倍的取样率来获得样本，连续
的带限函数可以完全地从它的样本集来恢复。这个结论就是众所周知的取样定理①。基于这一结果，
我们可以说，如果一个连续的带限函数用取样率大于函数最高频率的两倍的取样来表示不会有信息损
失。反过来，我们也可以说，以1/△T的取样率对一个信号取样的最
大频率是Hmax=1/2AT。有时，奈奎斯特取样率对于完美函数的恢复
是充分的，但是，也存在引起困难的情况，如我们稍后在例4.3中说明
的那样。这样，取样定理就规定了取样率必须超过奈奎斯特取样率。
F(A) a b F(A)
Hm
完全等于最高频率的两倍的取样
率，称为奈奎斯特取样率。
Hma
Hm 0 Hmax 0 六 -上
图4.7(a)一个带限函数的变换，(b)对同一函数做临界取样得到的变换
为了从原理上了解如何从F(μ)复原F(μ),考虑图4.8,该图显示了一个以略高于奈奎斯特取样
率取样后的函数的傅里叶变换。图4.8(b)中的函数由下式定义：
Hu)={0其他 (4.3-7)
①取样定理是数字信号处理理论的基石。该定理由 Hary Nyqui(哈里·奈奎斯特，美国贝尔实验室的一位科学家和工程师)于1928年
最先提出。同样来自贝尔实验室的Clake E Shummon(克劳德·E·山农于1949年正式地证明了该定理。早期数字计算系统和现代通
信的出现，使得人们开始研究处理数字(取样后的)数据的方法，从而导致了人们于20世纪40年代后期重新开始关注取样定理
第4章 频率域滤波 135
当乘以图4.8(a)中的周期序列时，该函数就隔离了以原点为中心的周
期。然后，如图4.8(c)所示，通过H(μ)和F(μ)相乘我们得到F(μ):
F(μ)=H(μ)F(μ)
式(4.3-7)中的AT 抵消了式(4.3.5)
中的I/AT
(4.3-8)
一旦得到了F(μ),我们就可以用傅里叶反变换来复原f(t):
fo)=?F(μ)e'd (4.3-9)
式(4.3-7)到式(4.3-9)从理论上证明了，以函数包含的最高频率的两倍的速率取样得到的函数的样本，
来恢复一个带限函数是可能的。正如下一节我们将要讨论的那样，f(t)必须是带限的这一要求通常
意味着f(t)必须从-∞扩展到○,实际上这一条件并不满足。正如稍后将要看到的那样，限制一个
函数的持续时间会妨碍该函数的完美复原，除非是特殊的情况。
a F() b
c
一Hm Hmae
-2/AT -1/△T 0 1/△T 2/AT
H(μ)
△T
0
F(μ)=H(A)F(A)
一Hmax 0 Pmar
图4.8 使用一个理想低通滤波器提取一个带限函数的变换的一个周期
函数H(μ)称为低通滤波器，因为它通过频率范围低端的频率，但是，它会消除(滤除)所有较高
的频率。它还被称为理想低通滤波器，因为它在幅度上无限快速地过渡(在位置-μms处，在0和△T
之间，而在位置μm处正好相反),其特性用物理电子元件是不能达到的。我们可以用软件来模拟理
想滤波器，但是，像在4.7.2节中解释的那样，尽管这样，也有限制。在这一章后面，我们还有更多
的有关滤波器的内容要叙述。因为滤波器是从函数的取样恢复(重建)原始函数的手段，因此刚刚讨论
的用于此目的的滤波器称为重建滤波器。
4.3.4 混淆
在这一点上，一个合理的问题是：如果一个带限函数用低于其最高频率的两倍取样率取样将会
发生什么情况?这相当于前一节中讨论的欠取样情况。图4.9(a)与图4.6(d)相同，说明了这一情况。
以低于奈奎斯特取样率取样的最终效果是周期重叠，并且不管使用什么滤波器，都不可能分离出变换 ～2
239 4
136 数字图像处理(第三版)
的一个单周期。例如，使用图4.9(b)中的理想低通滤波器，将会得到如图4.9(c)所示的一个变换，该
变换已被来自邻近周期的频率破坏了。然后，反变换会产生t的一个破坏了的函数。由函数欠取样导
致的这种效果就是周知的频率混淆，或简称为混淆。在字面上，混淆是一个过程，在这一过程中，一
个连续函数的高频分量在取样后的函数中用低频“化妆”了。这与通常所用的混淆一词是一致的，其
意思是“错认了”。
F(μ)
Hmas Ama
-3/AT -2/AT-1/△T 0 1/△T 2/△T 3/△T
H()
AT
0
F(u)=H(a)F(u)
b
c Hma 0 Hmar
图4.9(a)一个欠取样带限函数的傅里叶变换(图中来自邻近周期的干扰显示为虚线);(b)图4.8(b)中
所用的同一个理想低通滤波器；(c)图(a)和图(b)的乘积。来自邻近周期的干扰导致了混淆，而
混淆妨碍了F(μ)的完美复原，并因此妨碍了原始带限连续函数的完美复原。请与图4.8比较
很不幸，除了下面提到的某些特殊情况外，在取样过的函数中，混淆总是存在的，尽管原始取
样过的函数是带限的，在实践中，我们必须要做的是限制函数的时间，在我们限制函数的持续时间时，
总会引进无限的频率分量。例如，假设我们想要把带限函数f(1)的持续时间限制在区间[0,7]内。我
们可以让f(1)乘以如下函数来达到：
)={6其他 (4.3-10)
这个函数具有与图4.4(a)相同的基本形状，其变换H(μ)具有无限扩展的频率分量，如图4.4(b)所示。
由卷积定理可知，乘积h(t)f(r)的变换是这两个函数的变换的卷积。虽然f()的变换是带限的，将该
变换与H(μ)卷积，它包含在另一个函数上滑动一个函数的过程，这就产生一个频率分量无限扩展的
结果。因此，没有有限持续时间的函数是带限的。反过来，一个带限函数一定从-扩展到①。
根据前一段说明的原因，我们断定，用有限长度的取样和记录工作，混淆是一个不可避免的事
实。在实践中，可以通过平滑输入函数减少高频分量的方法(如对图像采用散焦方法)来降低混淆的影
①一个重要的特例是当一个从-扩展到的函数是带限的周期函数时。此时，该函数可被截断并且仍是带限的，前提是该截
断精确包含整数个周期。单个截断的周期(及函数)可由一组满足取样定理并在截断的区间上获得的离散样本来表示
第4章 频率域滤波 137
响。这种处理称为抗混淆，它必须在函数被取样之前完成，因为混淆是一个取样问题，而取样问题不
能使用计算技术“事后取消”。
例4.3 混淆。
图4.10显示了混淆的一个经典例子。在两个方向上无限扩展的纯正弦波具有单一频率，因此它很明
显是带限的。假定图中的正弦波(现在忽略图中的大点)用式sin(πu)来表 回忆可知，1个周期秒定义为1H
示，并且水平轴对应时间r(单位为秒)。函数在t=…,-1,0,1,2,3,…处与
时间轴相交。
sin(π)的周期P是2s,其频率是1/P或1/2周期/秒。根据取样定理，如果取样率1/AT 超过某一信
号最高频率的两倍，我们可以由取样后的一组样本来复原该信号。这意味着取样率大于1个样本/秒
[2×(1/2)=1]或AT<1s时，才能恢复该信号。显然，以准确的两倍频率(1个样本/秒)的取样率对信号取
样，在t=…,-1,0,1,2,3,…处得到的样本是…sin(-π),sin(O),sin(π),sin(2π),…,它们都是零。这说明了
取样定理要求取样率超过信号最高频率两倍的原因，就像前面提及的那样。
图4.10中的大黑点是以小于1个样本/秒的取样率对信号均匀取样后得到的样本(事实上，样本间的间
隔超过了2s,它给出的取样率低于12个样本秒)。取样后的信号看上去像正弦波，但其频率是原始信号的十
分之一。这个频率低于原始连续函数中任何频率的取样后的信号是混淆的一个例子。只给出了图4.10中
的样本，在这种情况下，混淆的严重程度使得我们无法知道这些样本是不是原始函数的真实描述。正如
在这一章稍后您将要看到的那样，图像中的混淆会产生类似的误导结果。
AT
图4.10 混淆的说明。欠取样后的函数(黑点)看上去像一个频率比连续信号频率低得多的正弦
波。该正弦波的周期是2s,因此与水平轴的零交叉每秒钟出现一次，△T是样本间隔
4.3.5 由取样后的数据重建(复原)函数
在这一节，我们将说明由一组样本集合来重建函数实际上可以减少样本间的内插。即使简单地用显示
介质显示一幅图像的行为都要求来自其样本的图像重建。因此，理解取样数据重建的基础是很重要的。卷
积是这一理解的核心，因而再度显示了这一概念的重要性。
图4.8和式(4.3-8)的讨论概括了一个带限函数使用频率域方法由其样本完美复原的过程。使用卷
积定理，我们可以在空间域得到等价的结果。从式(4.3-8),F(μ)=H(μ)F(u),可知
f(t)=3'{F(A)}=31{H(u)F(μ}=h(1)★f(1) (4.3-11)
其中，最后一步来自式(4.2-21)的卷积定理。可以证明(见习题4.6),将式(4.3-1)给出的f(1)代入
式(4.3-11),然后使用式(4.2-20),可导出f(1)的如下空间域表达式：
ro=ronATsinclu-nAT/Ar] 43-12) 店
138 数字图像处理(第三版)
其中，sinc 函数由式(4.2-19)定义。这个结果并不意外，因为盒状滤波器H(μ)的傅里叶反变换是一
个sinc 函数(见例4.1)。式(4.3-12)表明，完美重建的函数是用取样值加权的sinc 函数的无限和，并且
有重要的特性，即重建的函数恒等于在多个△T的整数增量处的样本值。也就是说，对于任何
t=k△T,其中k是整数，f(1)等于第k个样本f(k△T)。这来自式(4.3-12),因为sinc(O)=1,并且
对于任何其他整数m,sinc(m)=0。样本点之间的f(1)值是由sinc 函数的和形成的内插。
式(4.3-12)要求样本间的内插有无限多项。在实际中，这意味着我们必须找到一种样本间内插有
限的近似方法。正如我们在2.4.4节中讨论的那样，在图像处理中使用的主要内插方法是最近邻法、
双线性法和双三次内插法。在4.5.4节中，我们将讨论图像内插的效果。
4.4 单变量的离散傅里叶变换(DFT)
本节的主要目的是从基本原理开始推导离散傅里叶变换。到目前为止的材料可看成是这些基本
原理的基础，因此，现在我们适当地推导DFT所必需的工具。
4.4.1 由取样后的函数的连续变换得到DFT
正如4.3.2 节讨论的那样，一个取样过的、带限的、扩展到-○到范围的函数的傅里叶变换，
也是扩展到-到范围的连续的周期函数。实践中，我们处理有限数量的样本，因此本节的目的是
推导对应于这种样本集合的DFT。
式(4.3-5)给出了关于原始函数变换的取样过的数据的变换F(μ),但是，未给出采样后函数
f(1)本身的变换F(μ)的表达式。我们直接由式(4.2-16)中给出的傅里叶变换的定义寻找这样一个
表达式：
Fu)=?foe-Pdr (4.4-1)
阮
用式(4.3-1)代替f(1),我们得到
Fu)=[ioe-[2roo0-nAne-2厂rusu-ATJe(4.4-2) -21e
其中，最后一步来自式(4.3-2)。虽然f,是离散函数，但正如我们由式(4.3-5)所知道的那样，其傅里
叶变换F(μ)是周期为1/△T的无限周期连续函数。因此，我们需要表征F(μ)的一个周期，而对一个
周期取样是DFT的基础。
假设我们想要在周期μ=0到μ=1/AT之间得到F(μ)的M个等间距的样本。这可以通过在如
下频率处取样得到：
μ=MAT,m=0,12.…M-1 (4.4-3)
把μ的这一结果代入式(4.4-2),并令F表示得到的结果，则有
r-=2re,m=1.2.M-1 (4.4-4)
第4章 频率域滤波 139
这个表达式就是我们寻找的离散傅里叶变换①。给定一个由f(1)的M个样本组成的集合{f.},式(4.4-4)
得出一个与输入样本集合离散傅里叶变换相对应的M个复数离散值的样本集合{Fm}。反之，给定
{Fm},我们可以用傅里叶反变换(IDFT)复原样本集{f}:
=六2F,n=0.2.…M-1 (4.4-5)
不难证明(见习题4.8),把式(4.4-5)的f。代入式(4.4-4)可得出Fm=Fm。类似地，把式(4.4-4)的Fm
代入式(4.4-5)得到f。=f。这意味着式(4.44)和式(4.4-5)组成了一个离散傅里叶变换对。此外，这
些恒等式指出，对于任何其值有限的样本集合，正、反傅里叶变换都是存在的。注意，这两个表达式
不明确地依赖于取样间隔△T,也不依赖于式(4.4-3)中的频率间隔。因此，离散傅里叶变换对适用于
任何均匀取样的有限离散样本集。
在前面的阐述中，我们使用m和n来表示离散变量，因为对于推导来说历来都是这样做的。然
而，特别是在二维情况下，使用x和y表示图像坐标变量并使用u和v表示频率变量更为直观，在这
里，这些变量可理解为整数。这样，式(4.4-4)和式(4.4-5)就变为
Fw)-2roae,a=0.2.M-1 (4.4-6)
和
rw=六2ra,x=0.1.2M-1 (4.4-7)
为简便起见，我们在上式中使用函数表示代替了下标2。显然，F(u)=F且f(x)=f。从这一点出
发，我们用式(4.4-6)和式(4.4-7)表示一维DFT对。某些作者通过在式(4.4-6)中包含1/M项来代替我
们在式(4.4-7)中所示的方法。这不会影响两个公式形成一个傅里叶变换对的证明。
可以证明(见习题4.9),傅里叶正变换和反变换都是无限周期的，其周期为M,即
F(u)=F(u+kM) (4.4-8)
和
f(x)=f(x+kM) (4.4-9)
其中，k是整数。
式(4.2-20)中的卷积的离散等价表示是
ra)*hx)=2rmh(x-m) (4.4-10)
x=0,1,2,…,M-1。因为在前面的公式中的函数是周期的，所以它们的卷积也是周期的。式(4.4-10)给出
了周期卷积的一个周期。由于这一原因，在这个公式中，其内在处理通常称为循环卷积，并且直接
导致DFT和它的反变换的周期性。这与我们在3.4.2节中研究的卷积形成了对比，在该卷积中，位移
①注意图4.6(b)中的区间[0.I/AT]覆盖了该变换的两个背靠背的半周期。这意味着要求重新对F。中的数据排序，以便得到一个
周期内频率从最低到最高的样本。这是为符号表示的方便性而必须付出的代价，即在m=0,1.…,M-1处采样。而不使用原点
两侧的样本，因为后者要求使用负号。4.63节将讨论对变换数据排序的过程
②使用：表示连续空间变量及使用μ表示连续频率变量时，我们一直非常小心。从现在起，我们将使用x和a来分别表示一维离
散空间变量和一维频率变量。在处理二维函数时。我们将使用c,z)和(u,v)来分别表示连续空间变量和顺率域变量。类似地，我
们将使用(x,y)和(m,v来表示与它们对应的离散变量。
考虑到对连续函数取样的结果不
是周期的，离散函数f(x)是周期函
数的原因并不明显。解释这一点的
一种非正式方法是，记住一个周期
DFT 中的取样结果。反DFT的结
果f(x)对于DFT 对的存在来说必须
是周期的。
2～2
医：附
140 数字图像处理(第三版)
值x由一个函数完全滑过另一个函数的要求来决定，且像在循环卷积中那样区间[0, M-1]是不固定的。
我们将在4.6.3节和图4.28中讨论这一区别及其意义。
最后，我们指出，式(4.2-21)和式(4.2-22)中给出的卷积定理还可用于离散变量(见习题4.10)。
4.4.2 取样和频率间隔间的关系
如果f(x)由函数f(1)以△T为单位间隔取样后的M个样本组成，则包含集合{f(x)},x=
0,1,2,…,M-1的记录的持续时间是
T=M△T (4.4-11)
离散频率域中的相应间隔△u来自式(4.4-3):
"=MA= (4.4-12)
由DFT的M个分量跨越的整个频率范围是
Q=Mau=一 (4.4-13)
这样，由式(4.4-12)和式(4.4-13)就可以看出，DFT的频率分辨率△u取决于连续函数f(1)被取样的持
续时间T,并且DFT跨越的频率范围取决于取样间隔△T。很明显，两个表达式给出了T和△T的反
转关系。
例4.4 计算DFT的机理。
图4.11(a)显示了连续函数f(1)以△T为单位间隔取样后的4个样本。图4.11(b)显示了x域中的取样
值。注意，x的值是0,1,2和3,它指出我们可以提供f(1)的任何4个样本。
由式(4.4-6)有
F(o)=2rw)=[r(O+fO+f(2)+f(3]=1+2+4+4=11
F(w)的下一个值是
ra-2rae=1e°+2c2+4e*+4c2=-3+2j
类似地，有F(2)=-(1+0j)和F(3)=-(3+2j)。注意观察，在计算F(u)的每一项时用到了f(x)的所有值。
如果给定的是F(w),并且要求计算它的反变换，那么我们可以用相同的方法进行处理，但是使用的
是反变换。例如，
ro)-ZFue-ZFu=01-3+2j-1-3-21-4=1
这与图4.11(b)一致。f(x)的其他值可以用相同的方法得到。
a b f() f(x)
5 s
4 4
3 3
2 2
1
0
+IATo+2AT+3A7 0
0 1 2 3
x
图4.11(a)一个函数；(b)该函数在x域中的样本。在图(a)中，t是一个连续变量；在图(b)中，x代表整数值
第4章 频率域滤波
4.5 两个变量的函数的扩展
在这一节，我们将把4.2节到4.4节介绍的概念扩展到两个变量。
4.5.1 二维冲激及其取样特性
两个连续变量t和z的冲激δ(t,z)被定义为如式(4.2-8)所示的形式：
80.2)={0其他
和
?_8(,2)drdz=1
如在一维情况那样，二维冲激在积分下呈现了取样特性：
[_f(0,2)8(1,2didz=f(0.0)
或者，更一般地，对位于坐标(to,z)处的冲激，有
__f(,2)δ(-to,2-2)drdz=f(to,)
如以前那样，我们看到，取样特性在冲激所在的位置产生函数f(,z)的值。
对于离散变量x和y,二维离散冲激定义为 6(x-y-yo)
8(x,)={0其他 (4.5-4)
其取样特性为
∑∑rux,yo(x,y)=r(.0) (4.5-5)
式中，f(x,y)是离散变量x和y的函数。对于一个
位于坐标(x?,yo)外的冲激(见图4.12),其取样特
性为
141
(4.5-1a)
(4.5-1b)
(4.5-2)
(4.5-3)
x V
图4.12 二维单位离散冲激。变量x和y是离散的，且
δ的值在除坐标(x?.yo)外的任何位置都为0
Z∑raybu-,y-o)=f(G,%) (4.5-6)
如以前那样，离散冲激的取样特性在该冲激所在的位置产生离散函数f(x,y)的值。
4.5.2 二维连续傅里叶变换对
令f(,z)是两个连续变量：和z的连续函数。则其二维连续傅里叶变换对由以下两个表达式给出：
F(u,v)=厂_f(1,z)e-2UH+di dz (4.5-7)
和
fu,2)=厂?_F(u.vemdpdv (45.8)
;居
如果由区间[-Hmax,Hmax1和区间[-vmax,Vmx]建立
的矩形之外的傅里叶变换是零，则函数f(t,z)称为带限
函数；即
F(μ,v)=0.|μ≥μm且M≥vn (4.5-10)
二维取样定理表明，如果取样间隔满足
AT<
和
142 数字图像处理(第三版)
其中，μ和v是频率变量。当涉及图像时，t和z解释为连续空间变量。就像一维情况那样，变量μ
和v的域定义了连续频率域。
例4.5 得到一个简单函数的二维傅里叶变换。
图4.13显示了一个模仿例4.1中一维情况的二维函数。按照类似于例4.1中使用的过程给出结果
Fu.D)=[r0,zeda=zAePdrdb=Arz[cuA][wmz2]
其幅度(谱)由下面的表达式给出：
FuL.=ArcHcm2)
图4.13(b)显示了关于原点的谱的一部分。正如一维的情况那样，在谱中零的位置与T和Z的值成反
比。这样，T和Z越大，则谱将变得更“收缩”,反之亦然。
a b IF(u,)
f(0.z) ATZ
T- A
Z
T/2 Z/2 z μ P
图4.13(a)一个二维函数；(b)该二维函数的谱的一部分(未按比例画出),
该块沿t轴越长，则沿μ轴的谱更“紧凑”。请与图4.4比较
4.5.3 二维取样和二维取样定理
类似于一维情况中的方式，二维取样可用取样函数(二维冲激串)建模：
e(0.2)=2∑8u-mAT,z-nA2) (4.5-9)
其中，△T和△Z是连续函数f(,z)沿t轴和z轴的样本 SATaz(1,z) 间的间隔。式(4.5-9)描述了沿着两个轴无限扩展的周期
冲激的集合(见图4.14)。如图4.5中说明的一维情况那样，
用sATA(1,z)乘f(t,z)可得到取样后的函数。
AZ △T
图4.14 二维冲激串
(4.5-11)
第4章 频率域滤波 143
Az< (4.5-12)
或者关于取样率的表达，
(4.5-13)
和
立>2° (4.5-14)
则连续带限函数f(t,z)可以由其一组样本无误地恢复。另一种叙述方法是：我们说，如果一个二维带
限连续函数在μ和v两个方向上由以大于该函数最高频率两倍的取样率取样获得的样本表示，则没有
信息丢失。
图4.15显示了图4.6(b)和(d)的二维等效图示。一个理想的二维盒状滤波器有图4.13(a)说明的形
式。图4.15(a)中的虚线部分说明了滤波器的位置，以便达到分离从其样本重建带限函数必要的变换
的单个周期，正如4.3.3节那样。由4.3.4节，我们知道，如果函数欠取样，则周期将会重叠，并且如
图4.15(b)所示，分离出单个周期是不可能的。在这样的条件下，将产生混淆。
a b 一个理想低通
(盒状)滤波器的位置
: : Hmax- Vma
μ μ
图4.15 (a)过取样和(b)欠取样带限函数的二维傅里叶变换
4.5.4 图像中的混淆
在这一节，我们把混淆的概念扩展到图像，并讨论一些与图像取样和重取样有关的问题。
从一维混淆展开
正如在一维情况下那样，如果只在两个坐标方向上无限扩展，二维连续变量t和z的连续函数通
常可以被带限。限制一个函数时间的非常动作将引起在频率域无限扩展的有害的频率分量，正如4.3.4
节所解释的那样。因为我们不可能对一个函数无限地取样，所以，正像在取样后的一维函数中所存在
的那样，在数字图像中混淆总是存在的。在图像中，存在两种主要的混淆现象：空间混淆和时间混淆。
如4.3.4节讨论的那样，空间混淆是由欠取样造成的。时间混淆与图像序列中图像间的时间间隔有关。
时间混淆最常见的例子之一是“车轮”效应，即在序列图像(如电影)中具有轮辐的车轮出现倒转的现
象。这是由于序列中的帧率低于轮子转动的速度引起的。
在这一章，我们重点关注空间混淆。图像中空间混淆的主要表现形式是人为引入的缺陷，如线
状特征中的锯齿、伪高光及原图像中不存在的模式的出现。下面的例子说明了图像中的混淆。 圆
6;2
144 数宇图像处理(第三版)
例4.6 图像中的混淆。
假定我们有一个很完美的成像系统，没有噪声，并能产生看上去很精细的数字图像，但它能采用的
取样数是固定的96×96个像素。如果我们用该系统去数字化棋盘模式，
这个例子应切合实际地重建。当 那么它能解决多达96×96个大小为1×1像素的方格的模式。在这种限 我们将计算机生成的模型和向量图 制下，结果图像中的每个像素将对应图案中的一个方格。我们感兴趣的 转换为数字图像时，在无噪声、无
失真的条件下对“完美”的场景取 是考察当细节(棋盘方格的大小)小于一个摄像机像素时会发生什么事
样是很常见的。 情；也就是说，当成像系统要数字化大于96×96个方格的棋盘模式时，
会发生什么情况。
图4.16(a)和(b)显示了对棋盘取样的结果，方格的边长分别为16个像素和6个像素。这些结果正如
所预料的那样。然而，当方格的大小减小到稍小于一个摄像机像素时，如图 4.16(c)所示的严重混淆的图
像就产生了。最后，如果将方格的边长减小到稍小于0.5个像素时，则会产生如图4.16(b)所示的图像。
在这种情况下，混淆的结果看上去还像是一个正常的棋盘模式。事实上，该图像是通过对其方格边长为12个
像素的棋盘图像取样得到的。最后一幅图像是较好的提醒，即混淆会产生令人完全误解的结果。
a bcd
图4.16 图像中的混淆：在图(a)和图(b)中，方格的边长分别是16个像素和6个像素，混
淆在视觉上可以忽略不计。在图(c)和图(d)中，方格的边长分别是0.9174个像素和
0.4798个像素，结果中出现了明显的混淆。注意，图(d)看起来像是一幅正常的图像
通过稍微散焦被数字化的场景来削弱高频可以降低混淆的影响。正如4.3.4节解释的那样，抗混
淆滤波在图像被取样之前在“前端”必须要做。不存在这样的事情，即事后用软件抗混淆滤波器来减
小由于违反取样定理导致的混淆的影响。大多数商业数字图像处理程序包的确都有称为反混淆的特
征。然而，如例4.7和例4.8说明的那样，该术语涉及模糊一幅数字图像以减少由重取样引起的附加混
淆，不能用于减少原始取样过的图像的混淆。一些商业数字摄像机有真正反混淆滤波嵌入，不是在镜
头上，就是在传感器本身的表面上。由于这一原因，很难使用这种摄像机拍摄的图像来说明混淆。
图像内插和重取样
就像在一维情形中那样，由样本集合完美地重建一个带限图像函数要求在空间域用 sinc 函数做
二维卷积。如4.3.5节解释的那样，这种理论上的完美重建要求使用无限求和来内插，在实践中，迫
使我们不得不寻求某种近似。在图像处理中，二维内插最普通的应用之一是调整图像的大小(放大和
缩小)。放大可看成是过取样，缩小则可看成是欠取样。这两种操作和前面几节讨论的取样概念之间
的主要区别是放大和缩小用于数字图像。
2.4.4节中已解释过内插。这里我们的兴趣在于说明最近邻、双线性和双三次内插的性能。在这
一节，我们给出一些关于取样和反混淆问题的例子。当我们想要以整数倍增加一幅图像的尺寸时，与
过取样相联系的最近邻内插的一个特殊的情况是采用像素复制的放大操作。例如，将一幅图像放大两
倍，我们可以复制每一列。这会在水平方向上将图像尺寸放大一倍。然后，我们复制这幅放大后的图
像的每一行，在垂直方向上将图像尺寸放大一倍。相同的步骤可用于以任意整数倍放大图像。每个像
素的灰度级分配由新位置是老位置的精确复制这一事实来预先确定。
采用类似于放大图像的方法可缩小图像。欠取样是通过行-列删
除来实现的(例如，为将图像缩小一半，可每隔一行和一列来删除一
不使用带限模糊方法对图像重取
样的过程称为抽取。
第4章 频率域滤波 145
行和一列)。我们可以用2.4.4节的放大网格模拟来形象化非整数参数收缩的概念，只是我们现在扩张
该网格拟合原图像，进行灰度内插，然后，再把网格缩小为规定的尺寸。为减少混淆，最好在缩小图像
之前稍微模糊一下图像(4.8节将讨论频率域模糊)。一种替代技术是对原始场景超取样，然后采用行-列删
除法来减小(重采样)其大小。这可以得到比平滑更清晰的结果，但是，很显然，它要求存取原始场景。
如果我们不能访问原始场景(在实践中，这是很典型的),那么超取样就不是一个好的选择。
例4.7 重取样后的图像中的混淆的说明。
当一幅数字图像被减小时，通常混淆效应将变得更坏。图4.17(a)是为说明混淆的影响而故意创建的
一幅图像(注意，外衣上所有隔开的较细平行线都被目标磨损了)。图4.17(a)中没有不好的人为缺陷，指
出所用的初始取样率对防止可见的混淆是有效的。在图4.17(b)中，图像用行-列删除法缩小为原大小的
50??在该图像中，混淆的影响十分明显(作为例子，可参见目标的膝盖周围的区域)。连续图像的反混淆
滤波的数字等效操作是在对图像进行重取样之前平滑图像，以衰减数字图像的高频分量。图4.17(c)显示
了在缩小其尺寸之前，使用3×3均值滤波器(见3.5节)平滑图像的结果。对图4.17(b)的改进是明显的。
为了方便比较，采用像素复制方法将图4.17(b)和图4.17(c)放大到原始尺寸。
a bc
图4.17 重取样后的图像上的混淆的说明：(a)带有视觉上可以忽略的混淆的数字图像；(b)采
用行-列删除法将图像尺寸缩小到其原始尺寸50?的结果。混淆清晰可见；(c)在调
整图像大小之前.使用一个3×3均值滤波器来模糊(a)中图像的结果。该图像比图(b)
更模糊，但混淆不再那样显眼(原图像由加州大学圣巴巴拉分校信号压缩实验室提供)
当您处理具有很强边缘内容的图像时，混淆的影响看起来就像是块状图像分量，这称为锯齿。
下面的例子说明了这一现象。
例4.8 图像缩小中锯齿现象的说明。
图4.18(a)显示了一幅计算机生成场景的1024×1024数字图像，图像中混淆可以忽略。为了使混淆
效果(在这种情况下，就是锯齿)更清楚，图4.18(b)显示了经过如下操作后的图像：将图(a)缩小到75即
256×256大小，然后，使用双线性内插法和像素复制法将该图像复原到原始大小。就像在例4.7 中那样，在
对图像重取样之前平滑该图像可使混淆的影响不太令人讨厌。图4.18(c)是在减小图像尺寸之前使用5×5均
值滤波器的结果。正如这幅图像显示的那样，锯齿有效地减少了。采用用于生成图4.18(c)的相同方法，图4.18(c)
同样经过了图像缩小与复原为其原始大小的过程。
例4.9 图像放大中锯齿现象的说明。
在前两个例子中，我们使用像素复制法来放大较小的取样后的图像。如图4.19说明的那样，通常这
并不是一种首选的方法。图4.19(a)显示了一幅放大为1024x1024像素的图像，它是从图4.18(a)所示图像
中心截出256×256的一部分通过像素复制的方法产生的。注意“斑驳”的边缘。图4.19(b)所示放大后的
图像是由相同的256×256 像素部分经双线性内插法产生的。在该结果中，边缘相当平滑。例如，瓶颈的
边缘和大棋盘方格不像图4.19(b)中那么斑驳，而与图4.19(a)相近。 院
受
146 数字图像处理(第三版)
口
a b c
图4.18 锯齿的说明：(a)一幅计算机生成场景的1024×1024数字图像，其混淆可以忽略；(b)减小(a)的原始
尺寸到25再用双线性内插恢复原始尺寸的结果。(c)减小图像尺寸的25??前，用5×5的均值
滤波模糊图像，然后再用双线性内插的结果(原图像由D.P.Mitchell,MentalLandscape,LLC提供)
a b
图4.19 图像放大：(a)一幅大小为1024×1024像素的数字图像，该图像是通过对图4.18(a)中间截取的
256×256图像使用像素复制法产生的；(b)使用双线性内插法生成的图像，图像中的锯齿明显减少
莫尔(波纹)模式
在结束这一节之前，我们考察一下另外一种人为缺陷，称之为莫尔(波纹)模式②,它们有时是使
用周期或近似周期分量对场景取样产生的。在光学中，莫尔模式指的是在两个近似等间隔的光栅之间
产生的差拍模式。这些差拍模式通常每天都会发生。例如，我们从防昆虫纱窗重叠在一起，或从电视
光栅线与条带材料间所看到的干涉那样。在数字图像处理中，当扫描介质印刷物如报纸和杂志时，或
者在具有周期分量的图像中，如果它的间隔与取样的间隔可比的时候，通常都会出现这一问题。与取
样造成的人为缺陷相比，莫尔模式更为常见。例如，图4.20显示了莫尔(波纹)效应，它是使用墨水绘
画的，并没有被数字化。分离的情况下，这些模式都是干净的，且没有干扰。然而，将一种模式叠加
到另一种模式上时，会产生一幅其频率在原始模式中均不出现的差拍模式。注意，在特殊情况下，由
两个点的模式所产生的莫尔(波纹)效应，是我们在下面的讨论很感兴趣的效应。
a bcd ef
图4.20 莫尔(波纹)效应的例子。它们是油墨画而不是数字化后的模式。
将一个模式叠加在另一个模式上在数学上等价于两个模式相乘
报纸和其他印刷材料使用所谓的半色调点，它们是黑色圆点或椭
圆点，其大小和变化的连接方式用于模拟灰色调。作为一个规则，下
①术语莫尔(moire)是一个法语单词而不是人名，它源自首先注意到某些织物上出现干涉图样的织布者；该术语是由单词mohair(马
海毛，一种使用安哥拉山羊毛织成的布)演化而来的。
彩色打印使用红点、绿点和蓝点
来产生人眼可以识别的连续颜色。
第4章 频率域滤波 147
面的数量是典型的：报纸每英寸75点(简称dpi)来印刷，杂志用133 dpi来印刷，高质量的小册子用175
dpi来印刷。图4.21显示了一幅报纸图像以75 dpi取样时产生的现象。取样格(垂直方向和水平方向)
和报纸图像上点的模式(±45°方向)相互作用，产生使得图像看起来像是布满斑点的均匀莫尔模式
(4.10.2节将讨论降低莫尔干扰模式的一种技术)。
作为相关的兴趣点，图4.22显示了一幅以400 dpi取样后以便防止莫尔(波纹)效应的报纸图像。
目标的左眼周围区域的放大图像说明如何利用中间色点产生灰度的深浅。点的大小与图像灰度成反
比。在亮区域，点较小，或完全没有点(例如，见眼白部分)。在浅灰区域，点较大，如眼睛下部
所示。在较暗的区域，当点的大小超过某个指定值(典型地为50???，允许点沿着两个指定方向
连接起来形成一个互相连接的网格(见眼睛的左侧)。在某种情况下，点仅沿一个方向连接，如眉
毛下面的右上方区域。
图421 以75dpi取样、大小为246×168像素的报纸图像，显图422一幅报纸图像及其局部放大图像，局部放大图
示了莫尔模式。这幅图像中的莫尔模式是在±45°方 像说明了如何安排半色调点以渲染灰度的色调
向的半色调点与南北方向的取样网格之间产生的干扰
4.5.5 二维离散傅里叶变换及其反变换
类似于4.3节和4.4节的材料中的推导过程，可得到下面的二维傅里叶变换(DFT):
Fu)=22raye (4.5-15)
其中，f(x,y)是大小为M×N的数字图像。与一维中的情况一样，
式(4.5-15)必须对离散变量u和v在u=0,1,2,…,M-1和v=0,1,2,…,
N-1范围内求值①。
给出变换F(u,v),我们可以使用傅里叶反变换(IDFT)得到f(x,y):
rax,y=ZZFuye (4.5-16)
其中，x=0,1,2,…,M-1,y=0,1,2,…,N-1。式(4.5-15)和式(4.5-16)构成了二维离散傅里叶变换对。
本章的其余部分是以这两个公式的特性和它们在频率域图像滤波的应用为基础的。
①如44.1节中提及的那样，记住，在本章中我们分别使用(,2)和(H,)来表示二维连续空间变量和频率域变量。在二维离散情
况下，我们使用(x,y)表示空间变量，而使用(u,v)表示频率域变量
有文献中，我们有时会在DFT而不是
IDFT的前面看到常数1/MN。这时，该
常数表示为1/√MN 并包含在正变换和
的变换对。这些公式都是正确的。但前
反变换的前面，从而创建一个更为对称
提条件是要保持 致
因;隔
圈圆
148 数字图像处理(第三版)
4.6 二维离散傅里叶变换的一些性质
在这一节，我们将介绍二维离散傅里叶变换及其反变换的一些性质。
4.6.1 空间和频率间隔的关系
空间取样和相应频率域间隔的关系如 4.4.2节中解释的那样。假定对连续函数f(,z)取样生成了一
幅数字图像f(x,y),它由分别在1和z方向所取的MxN个样点组成。令△T和△Z表示样本间的间隔(见
图4.14)。那么,相应离散频率域变量间的间隔分别由
=MA (4.6-1)
和
Av= (4.6-2)
给出。注意，频率域样本间的间隔与空间样本间的间距和样本数成反比。
4.6.2 平移和旋转
直接代入式(4.5-15)和式(4.5-16)可以证明傅里叶变换对满足下列平移特性(见习题4.16):
f(x,y)e{21,x/M+?NF(u-o,v-vo) (4.6-3)
和
f(x-x?,y-yo)?F(u,v)e-2(/M+?) (4.6-4)
也就是说，用指数项乘以f(x,y)将使 DFT的原点移到点(uo,?反之，用负指数乘以F(u,v)将使
f(x,y)的原点移到点(x?,y?)。正如我们在例4.13中说明的那样，平移不影响F(u,v)的幅度(谱)。
使用极坐标
x=rcosθ, y=rsinθ,u=wcosφ,v=0 sinφ
可得到下列变换对：
f(r,θ+0?)?F(0,φ+o) (4.6-5)
它指出，若f(x,y)旋转θ。角度，则F(u,v)也旋转相同的角度。反之，若F(u,v)旋转一个角度，
f(x,y)也旋转相同的角度。
4.6.3 周期性
如在一维情况中那样，二维傅里叶变换及其反变换在u方向和v方向是无限周期的，即
和
F(u,v)=F(u+k?M,v)=F(u,v+k?N)=F(u+k?M,v+k?N)
f(x,y)=f(x+k,M,y)=f(x,y+k?N)=f(x+k,M,y+k?N)
(4.6-6)
(4.6-7)
其中，k,和k?是整数。
变换及其反变换的周期性在基于DFT 算法的实现上是重要的特性。考虑图4.23(a)中的一维谱。
如4.4.1节描述的那样，在区间[0,M-1]中，变换数据由两个在点M2处碰面的背靠背的半个周期组
成。针对显示和滤波目的，在该区间中有一个变换的完整的周期会更为方便，因为完整周期中数据是
连续的，如图4.23(b)那样。由式(4.6-3)可得
第4章 频率域滤波 149
f(x)e2(mx/MF(u-u?)
换句话说，用一个指数项乘以f(x)将位于原点的数据F(0)移动到位置u?。如果我们令u=M/2,
则指数项变为e",因为x是整数，故它等于(-1)°。在这种情况下，
f(x)(-1)2?F(u-M/2)
即用(-1)*乘以f(x)将位于原点的数据F(O)移动到区间[0,M-1]的中心位置，像期望的那样，它对应
于图4.23(b)。
b
F()
cd
两个背靠背的
周期在此相会
-M/2 0 M/2-1 M/2M-1 M
F(n)
两个背靠背的
周期在此相会
0 -M/2
一个周期(M个样本) -M-1
F(u.v)
(0.0) iN/2-N-1
M/2
4个背靠背的
周期在此相会 M-1 F(u.r)
u
=DFT的周期 4个背靠背的
周期在此相会
□-M×N数据阵列F(u,o)
图4.23 傅里叶变换的中心：(a)显示了无限个周期的一个一维DFT;(b)在计算F(u)之前，由(-1)*乘以
f(x)得到的移位后的DFT;(c)显示了无限个周期的一个二维DFT。实线区域是由式(4.5-15)得到
的M×N数据阵列F(u,v)。该阵列由4个四分之一周期组成；(d)在计算F(u,)之前，由(-1)?*
乘以f(x,y)得到的移位后的DFT。现在数据包含一个完整的位于中心的周期，这与图(b)一样
在二维情况下，用图形来显示该情况有些困难，但原理是一样的，如图4.23(c)所示。代替使用
两个半周期，现在有4个四分之一周期在点(MI2, N/2)处碰面。虚线矩形对应于二维 DFT的无限个周
期。正像一维情况那样，如果我们移动数据，以便F(0,0)处在点(M/2,N/2)处，可简化其可视化
程度。在式(4.6-3)中令(uo,?(M/2,N/2),可得到如下表达式： 园：留
2：2
150 数字图像处理(第三版)
f(x,y)(-D)*?'?F(u-M/2,v-N/2) (4.6-8)
利用该式移动数据，以便如希望的那样，使F(0,0)处在由区间[0,M-1]和[0,N-1]定义的频率矩形的
中心处。图4.23(d)显示了这一结果。我们将在本章稍后的例4.11和图4.24中说明这些概念。
4.6.4 对称性
函数分析得到的一个重要结果是，任意实函数或虚函数w(x,y)可表示为一个奇数部分和一个偶
数部分(其中每一个都可以是实部或虚部)的和：
w(x,y)=w.(x,y)+w。(x,y) (4.6-9)
其中，偶数部分和奇数部分定义如下：
w.(x,y)C,)+2-x,-) (4.6-10a)
和
w。(x,y)=x,-2-,- (4.6-10b)
把式(4.6-10a)和式(4.6-10b)代人式(4.6-9)给出恒等式w(x,y)=w(x,y),这样，就证明了后一公式的
正确性。由前面的定义有
w.(x,y)=w.(-x,-y) (4.6-1la)
和
w。(x,y)=-w。(-x,-y) (4.6-11b)
也就是说，偶函数是对称的，奇函数是反对称的。因为DFT和IDFT 中的所有指数都是正的，当我
们谈论对称(反对称)时，我们指的是关于序列中点的对称(反对称)。在式(4.6-11)中，一维阵列中心
点右侧的指数考虑为正，其左侧考虑为负(在二维情况下类似)。在我们的操作中，仅考虑非负的指数
项更为方便，在这种情况下，奇和偶的定义变为
w(x,y)=w.(M-x,N-y) (4.6-12a)
和
w。(x,y)=-w(M-x,N-y) (4.6-12b)
其中，M和N分别是二维阵列的行数和列数。
由初等数学分析我们知道，两个偶函数或两个奇函数的积是偶函
数，而一个偶函数和一个奇函数的积是奇函数。另外，离散函数为奇
函数的唯一方法是其所有样本的和为零。这些特性导致了一个重要结
论，即对于任意一个离散偶函数w。和一个离散奇函数w。,有
22(xy)(x)=0
若要自己动手证明一个奇函数的
样本之和为零，可关于原点或跨越
一个周期的任何其他区间画出一维
正弦波的一个周期。
(4.6-13)
换句话说，因为式(4.6-13)的自变量是奇数，则求和的结果是零。函数可以是实函数或复函数。
第4章 频率域滤波 151
例4.10 偶函数和奇函数。
虽然很容易就可看出连续函数的奇偶性，当处理离散序列时，这些概念就不那么直观了。下面的说
明将帮助我们弄清前面的概念。考虑一维序列
f={f(0)f1) f(2) f(3)}={2 1 1 1}
其中，M=4。为了检验偶性，必须满足条件f(x)=f(4-x),也就是说，我们要求
f(O)=f(4),f(2)=f(2),f(1)=f(3),f(3)=f(1)
因为f(4)在被考察的范围之外，且它可以为任何值，则f(O)的值对于偶函数的测试是不重要的。我们看到，
阵列中的值满足接下来的三个条件，则该序列是偶序列。事实上，我们得出结论，任何4点偶序列必须
有下列形式：
{a bcd}
即在4点偶序列中，仅需第二点和最后一点相等。
奇序列有一个很有趣的特性，即其第一项w。(0,0)永远是0,它遵循直接源自式(4.6-10b)的一个事实。
考虑一维序列
8={8(0)g(1)g(2)g(3}={0-10 1}
由于序列中的各项满足g(x)=-8(4-x),因此我们很容易地确认这是一个奇序列。例如，g(1)=-g(3)。
任何4点奇序列都有形式
{0-b0b}
也就是说，当M是偶数时，一维奇序列有在位置0和M2处的点总是零的特性。当M是奇数时，第一
项仍必须是零，其余项形成等值的一对，但符号相反。
前面的讨论指出，序列是偶序列还是奇序列还取决于序列的长度。例如，我们已经证明序列(0 -10 1}
是奇序列。然而，序列[0 -1 01 0]既不是奇序列，也不是偶序列，虽然其“基本”结构表现为奇序
列。在解释 DFT 的结果时，这是一个重要的问题。在这一章稍后我们将 读者可自行证明这个二维序列是 说明偶函数和奇函数的 DFT 具有一些非常重要的特征。因此，常常有这 奇序列。
种情况，了解一个函数是奇函数还是偶函数在解释基于DFT 的图像结果
中扮演着重要的角色。
在二维情况中也有相同的基本考虑。例如，一个6×6的二维序列
0 0 00.0 0
0 0 0 0 0 0
0 0 -1 0 1 0
0 0-20 20
0 0 -1 0 1 0
0 0 0 0 0 0
是奇序列。但在添加另一行Q和另一列0后，导致的序列就既不是奇序列也不是偶序列。注意，该阵列
的内部结构是一个如3.6.4节讨论的Sobel模板。我们将在例4.15中再回顾这个模板。
利用前面的概念，我们可以建立 DFT 及其反变换的一些重要的对称性质。一个常用的性质是实
函数f(x,y)的傅里叶变换是共轭对称的，即
F'(u,v)=F(-u,-v) (4.6-14)
如果f(x,y)是虚函数，则其傅里叶变换是共轭反对称的：F(-u,-V)=
-F(u,v)。式(4.6-14)的证明如下：
共轭对称也称为哈密特对称。术语
反哈密特有时用于指共轭反对称。 -2
圆
152 数字图像处理(第三版)
ra-[22us-22rs
-22rayewwN=F(-u-)
其中，第三步源自f(x,y)是实函数这一事实。使用类似的方法可以证明虚函数的变换所表现出的共
轭对称性。
表4.1列出了DFT的对称性和相关的性质，这些性质在数字图像处理中很有用。回忆可知，双
箭头表示傅里叶变换对，即对于表中的任意一行，右边的性质可由拥有左边性质的函数的傅里叶变换
来满足，反之亦然。例如，第5条性质可读为：实函数f(x,y)的傅里叶变换是F(u,v),其中用(-x,-y)
代替(x,y),而f(x,y)的离散傅里叶变换F(u,v)是复函数，反之亦然。
表4.1 二维 DFT及其反变换的某些对称性质。R(u,v)和(u,v)分别是
F(u,v)的实部和虚部。术语复函数指出一个函数有非零实部和虚部
空间域 频率域
1D f(x,y)实函数 F*(u,)=F(-u.-v)
2) f(x,y)虚函数 F*(-u,-)=-F(u,)
3) f(x.y)实函数 R(u,v)偶函数：/(u,v)奇函数
4) f(x,y)虚函数 R(u,v)奇函数，I(u,v)偶函数
5) f(-x,-y)实函数 F*(u,)复函数
6) f(-x,-y)复函数 F(-u,-v)复函数
7) /(x,y)复函数 F(-u,-)复函数
8) f(x,y)实函数和偶函数 F(u,v)实函数和偶函数
9) f(x,y)实函数和奇函数 F(u,v)虚函数和奇函数
10 f(x,y)虚函数和偶函数 F(,v)虚函数和偶函数
11) f(x,y)虚函数和奇函数 F(u,v)实函数和奇函数
12) f(x,y)复函数和偶函数 F(u,v)复函数和偶函数
13) f(x,y)复函数和奇函数 F(u,v)复函数和奇函数
*回忆可知，x,y,a和v是离散(整数)变量，x和a在区间[0.M-1]内，y和v在区间[0,N-1]
内。称一个复函数是偶函数意味着其实部和虚部都是偶函数，称一个复函数为奇函数同样意味
着其实部和虚部都是奇函数
例4.11 表4.1中性质的一维说明。
根据早些时候讨论过的偶函数和奇函数的概念，以及在例4.10中的说明，下面的一维序列及它们的变
换是表4.1中所列性质的简单例子。右侧圆括号内的数字是F(u)的单个元素；类似地，在最后两个特性中，
对于f(x)也类似。
性质 f(x) F(u)
3 {1 2 34]?{(10)(-2+2j)(-2)(-2-2j)}
f{1 234}?(2.5j)(0.5-0.5j(-0.5j)(-0.5-0.5)}
{2111}?{(5)(11(1)
[0-101]?{(0)(2j)O(-2)}
j[2 11 1}((5j)j)GG}
4
8
9
10
第4章 频率域滤波 153
11 j[0 -1 0 1}?((0)(-2)(0)(2)
12((4+4j)(3+2j)(0+2j)(3+2j))?((10+10j)(4+2j)(-2+2j)(4+2j)}
13((0+0j)(1+1j)(0+0j)(-1-1j}一(0+0j)(2-2j(0+0j)(-2-2j)}
例如，在性质3中，我们看到有元素(1 234)的实函数具有傅里叶变换，该变换的实部(10-2-2 -2)
是偶函数，虚部[0 20-1]是奇函数。性质8告诉我们，一个实偶函数的傅里叶变换也是一个实偶函数。
性质12说明，一个偶复函数的傅里叶变换也是复偶函数。其他性质的例子可以用同样的方法来分析。
例4.12 证明表4.1中DFT的一些对称性质。
在这个例子中，我们证明表4.1中的一些性质，熟练运用这些重要的性质，以便为解答本章末尾的一
些习题打下基础。我们仅由左侧给出的性质证明右侧的性质。使用类似于此处给出的方式，可以用右侧
给出的性质证明左侧的性质。
考虑性质3,它读做：如果f(x,y)是实函数，则其DFT的实部是偶函数，而其虚部是奇函数；类似
地，如果一个DFT 分别具有偶函数的实部和奇函数的虚部，则其IDFT是一个实函数。这一性质的正式证明
如下。F(u,V)通常是复函数，因此它可以表示为一个实部和一个虚部之和，即F(u,V)=R(u,v)+jl(u,v)。
然后，有F'(u,v)=R(u,v)-jl(u,v)。此外，有F(-u,-v)=R(-u,-v)+jl(-u,-V)。但是，正如早期
证明的那样，如果f(x,y)是实函数，则基于前两个等式有R(u,V)=R(-u,-v)和I(u,v)=-I(-u,-v)。根
据式(4.6-11a)和式(4.6-11b)的观点，这就证明了R是一个偶函数，而I是一个奇函数。
下面，我们证明性质8。如果f(x,y)是一个实函数，那么由性质3可知F(u,v)的实部是偶函数，因
此为证明性质8,我们所要做的所有的工作是证明：如果f(x,y)是实偶函数，则F(u,v)的虚部是0(即F
是实函数)。证明步骤如下：
Fuy)=22raye
上式可写为
Fu)-220/(xye
-220(ayke
-22[偶函数Ⅱ偶函数-j奇函数][偶函数-j偶函数]
-22[偶函数]偶函数·偶函数-2j偶函数·偶函数-偶函数·偶函数
-22 -22 -2322[偶函数·偶函数 [偶函数·偶函数] [偶函数·偶函数]
=实函数
第4步来自欧拉公式以及cos和sin分别是偶函数和奇函数的事实。由性质8我们还知道，除了是实函数之外，
f也是偶函数。在倒数第二行中，包含虚部分量的仅有的一项是第二项，根据式(4.6-14)可知它是0。这样，如果
f是实偶函数，则F是实函数。正如早些时候解释的那样，因为f是实函数，所以F也是偶函数。该结论得证。
最后，我们证明性质6的正确性。由DFT的定义，
sf/-x-y)-22r-x-ye 象:
圜
154 数宇图像处理(第三版)
由于周期性，有f(-x,-y)=f(M-x,N-y)。如果现在定义m=M-x和n=N-y,则
Sf-x-=22r(mmneuuu
Sf/---22r0mme-Fe-9
结论得证。
(为确保求和本身是正确的，可用一个一维变换试一下，并手工扩展一些求和项。)因为exp[-j2π(整数)]=1,
它遵循下式： 注意此处我们未更改变量。我们
计算的是f(-x,-y)的DFT,因此只
是简单地将该函数插入到了等式
中，就像处理任何其他函数一样。
4.6.5 傅里叶谱和相角
因为通常二维DFT一般是复函数，因此可使用极坐标形式来表示：
F(u,v)=|F(u,v|ei(.) (4.6-15)
其中，幅度
|F(u,v|=[R2(u,D)+F2u,v]" (4.6-16)
称为傅里叶谱(或频谱),而
ou,y)=ac[ (4.6-17)
称为相角。回忆4.2.1节的讨论，arctan必须使用一个四象限反正切来计算，如MATLAB的atan2(Imag,
Real)函数。
最后，功率谱定义为
F(u,v)=|F(u,D2=R2(u,v)+I2(u,) (4.6-18)
如之前那样，R和1分别是F(u,v)的实部和虚部，并且，所有的计算直接对离散变量u=0,1,2,….M-1
和v=0,1,2,…,N-1进行。因此，IF(u,v),φ(u,v)和P(u,v)是大小为M×N的阵列。
实函数的傅里叶变换是共轭对称的[见式(4.6-14)],这表明谱是关于原点偶对称的：
|F(u,v|=|F(-u,-V (4.6-19)
相角关于原点奇对称：
φ(u,V)=-(-u,-v) (4.6-20)
它来自式(4.5-15)
ao-2Zux
它指出零频率项与f(x,y)的平均值成正比，即
FaO)=m~六22ra,=MwFixsy (4.6-21)
其中，子表示f的平均值。从而有
(4.6-22) |F(0,0)|=MN|F(x,)
第4章 频率域滤波 155
因为比例常数MN通常很大，典型地，IF(0.0)是谱的最大分量，它可能比其他项大几个数量级。
因为原点处的频率分量u和v是0,所以 F(0.0)有时称为变换的直流(dc)分量。这一术语源自电气工
程，在电气工程中，"de"表示直流(即频率为零的电流)。
例4.13 一个简单函数的二维傅里叶谱。
图4.24(a)显示了一幅简单的图像，图4.24(b)显示了该图像的谱，其值被标定到区间[0,255],并以图
像形式显示。空间域和频率域的原点都在左上角。在图4.24(b)中，两件事情是很明显的。如期望的那样，
变换的原点的周围区域包含了最高值(在图像中表现为最亮)。然而，注意，谱的4个角包含有类似的高值。
原因是在前一节中讨论的周期性。为中心化该谱，如式(4.6-8)指出的那样，在计算 DFT 之前，我们简单地
用(-1)*乘以(a)中的图像。图4.24(c)显示了结果，很明显它更易于观察(注意关于中心点的对称性)。由于
直流项支配着谱的值，在显示的图像中，其他灰度的动态范围被压缩了。为了给出那些细节，如3.2.2节描
述的那样，我们执行一次对数变换。图4.24(d)给出了(l+loglF(u,v))的显示，细节再现的提高是明显的。
本章和后续几章中的多数谱均按这种方式标定过。
a bed
图4.24 (a)图像；(b)在4个角显示亮点的谱；(c)中心化后的谱；(d)经对数变换后，
增加了细节的结果。谱的零交叉在垂直方向较靠近，因为图(a)中的矩形在
该方向上较长。全书所用的坐标习惯把空间域和频率域的原点放在左上角处
由式(4.6-4)和式(4.6-5)可知，谱对图像平移是不敏感的(指数项的绝对值是1),它随旋转图像以相
同的角度旋转。图4.25说明了这些特性。图4.25(b)中的谱与图4.24(d)中的谱是相同的。很清楚，在图4.24(a)
和图4.25(a)中的图像是不同的，因此，如果它们的傅里叶谱是相同的，则基于式(4.6-15),它们的相角一定
不同。图4.26确认了这一点。图4.26(a)和(b)是图4.24(a)和图4.25(a)的DFT的相角阵列(以图像显示)。
注意，相位图像之间缺少类似性，虽然它们所对应的图像间的唯一差别是简单的平移。通常，相位角图
像的视觉分析很少能得到直觉的信息。例如，在45°角方向，一个直觉的期望是图4.26(a)中的相角应对
应于图4.25(c)中的旋转图像，而不是图4.24(a)的图像。事实上，如图4.26(c)所示，旋转后图像的相位角
有一个很强的方向，它比45°小得多。
a b c d
图4.25(a)平移后的图4.24(a)中的矩形；(b)相应的谱；(c)旋转后的矩形；
(d)相应的谱。对应于平移矩形的谱与图4.24(a)中的原图像的谱相同
DFT的谱的分量决定正弦波的幅度，这些正弦波结合起来可形成结果图像。在一幅图像的DFT 屋：密
引
156 数字图像处理(第三版)
中，在任何给定的频率处，较大的幅度意味着图像中该频率的正弦波比较突出。反之，较小的幅度意
味着图像中出现的正弦波较少。如图4.26所示，虽然相位分量的贡献很不直观，但它恰恰很重要。相
位是各个正弦分量关于原点的位移的度量。这样，当二维 DFT的幅度是一个阵列时，其分量决定了
图像中的灰度，相应的相位则是一个角度的阵列，它携带较多的关于图像中可辨别的物体定位的信息。
下面的例子进一步阐明了这些概念。
a b c
图4.26 (a)对应于图4.24(a)中中心化后的矩形图像的相角阵列；(b)对应于图4.25(a)
中平移后的图像的相角阵列；(c)对应于图4.25(c)中旋转后的图像的相角阵列
例4.14 傅里叶谱和相角的进一步说明。
图4.27(b)是图4.27(a)的DFT 的相角。该阵列将通过视觉分析引导我们将其与对应图像中的特性关
联起来。然而，在决定形状特点时，相位的重要性在图4.27(c)中是很明显的，它仅仅用相位信息(也就是，
用公式IF(u,v)l=1)计算式(4.6-15)的反傅里叶变换得到。尽管灰度信息已丢失了(记住，该信息由谱携带),
但图像中关键的形状特性是不会在图4.27(a)中弄错的。
图4.27(d)是仅使用式(4.6-15)的谱并计算其IDFT 得到的。这意味着若将指数项置为1,这也同样意味
着置相位角为0,结果不会是意外的。它仅包含灰度信息，直流项占支配地位。图像中没有形状信息，因为
相位已置为零了。
最后，图4.27(e)和(1)再一次证明了在确定一幅图像的特性内容时相位所起的支配作用。图4.27(e)是
使用图4.24(a)中矩形的谱和对应于妇女图像的相角计算式(4.6-15)的IDFT得到的。妇女的形状显然支配
了这一结果。反之，矩形支配了图4.27(f),它是使用妇女图像的谱和矩形的相角计算得到的。
dei
图4.27(a)妇女图像；(b)相角；(c)仅使用相角重建的妇女图像；(d)仅使用谱
重建的妇女图像；(e)使用对应于妇女图像的相角和对应于图4.24(a)中矩
形的谱重建的妇女图像；1)使用矩形的相角和妇女图像的谱重建的图像
第4章 频率域滤波 157
4.6.6 二维卷积定理
将式(4.4-10)扩展至两个变量可得到下面的二维循环卷积的表达式：
rux,y*hax,y)=22rom,nhx-m,y-m) (4.6-23)
其中，x=0.1,2,…,M-1,y=0.1,2,…,N-1。如式(4.4-10)那样，式(4.6-23)给出了一个二维周期
序列的一个周期。二维卷积定理由下面的表达式给出：
f(x,y)*h(x,y)?F(u,v)H(u,V) (4.6-24)
反之，
f(x,y)h(x,y)?F(u,v)★H(u,) (4.6-25)
其中，F和H是使用式(4.5-15)得到的，且与之前一样，双箭头用来表示表达式的左边和右边组成了
傅里叶变换对。在本章其余部分，我们的兴趣是式(4.6-24),该式表明乘积F(u,v)H(u,v)的IDFT是
f(x,y)★h(x,y),即f和h的二维空间卷积。类似地，空间卷积的DFT是频率域中相应变换的乘积。
式(4.6-24)是线性滤波的基础，并且如4.7节中解释的那样，是本章讨论的所有滤波技术的基础。
因为在这里我们处理的是离散量，傅里叶变换的计算使用 DFT 算
法执行。如果我们选择使用两个函数变换的乘积的IDFT 来计算空间卷
积，则必须考虑在 4.6.3节中讨论过的周期性问题。我们给出一个关于
该问题的一维的例子，然后将结论扩展到两个变量。图4.28左边-列执行两个函数f和h的卷积，它
使用式(3.4-2)的一维等式，因为两个函数具有相同的尺寸，该卷积写为
ra*ha)=2rah(x-m)
这个等式与式(4.4-10)相同，但是，对位移x的要求是它必须足够大，以便使反转的h完全滑过f。换
句话说，该过程包括：(1)关于原点求h的镜像(即使h旋转180°)[见图4.28(c)],(2)以数量x平移
镜像函数[见图4.28(d)],(3)对每一个平移的x值，计算前面公式右边的全部乘积之和。依据图4.28,
这意味着对每个x值用图4.28(d)中的函数乘以图4.28(a)的函数。位移x的范围是要求h完全滑过f
的所有值。图4.28(c)显示了这两个函数的卷积。注意，卷积是位移变量x的函数，并且，在这个例
子中，要求h完全滑过f的x的范围是从0到799。
如果我们使用DFT和卷积定理得到与图4.28左列相同的结果，我们必须考虑DFT表达式中固有
的周期。这与图4.28(f)和图4.28(g)中对两个周期函数进行卷积是等价的。卷积过程与我们刚才讨论
的相同，但是，现在这两个函数是周期函数。按前一段介绍的方法处理这两个函数将得到图4.28(j)所
示的结果，很明显，它是不正确的。因为，我们卷积两个周期函数，所以卷积本身也是周期的。在
图4.28中，周期的靠近使它们互相干扰而导致所谓的缠绕错误。根据卷积定理，如果我们计算两个
400点的函数f和h的DFT,两个函数相乘，然后，计算反DFT,那么我们将得到如图4.28j)所示卷
积的400点的错误的一段。
幸运的是，解决缠绕错误问题很简单。考虑分别有A个样本和B个样本的两个函数f(x)和h(x),
可以证明(Brigham[1988]),如果我们把0添加到这两个函数中，使它们具有相同的长度，用P来表
示，然后，可以这样选择以避免缠绕：
P≥A+B-1
我们将在4.11 节中讨论计算
DFT的有效方法。
(4.6-26)召
:2
158 数字图像处理(第三版)
f(m) (m)
3 3
4号
e j
m m
0200400 0 200 400
h(m) h(m)
2 2
m m
0 200 400 0 200 400
h(-m) h(-m)
m m
0 200 400 0 200 400
h(x-m) h(x-m)
x x
m m
0 200 400 0 200 400
f(x)*g(x) f(x)*g(x)
1200 1200
600 600
x
0 200 400600 800 0 200400
傅里叶变换
计算的范围
图4.28 左列：用3.4.2节讨论的方法得到的两个离散函数的卷积。图(e)中的结果是正确的。右
列：相同函数的卷积，但考虑了DFT的周期性。注意图(j)中来自邻近周期的数据是如
何产生缠绕错误而得不到正确卷积结果的。要得到正确的结果，必须对函数进行填充
在我们的例子中，每一个函数有400个点，我们应该使用的最小
值是P=799,这意味着我们需要在每个函数的结尾处添加399个0。
这种处理称为0填充。作为练习，读者可以自己证明：如果图4.28(f)
和图4.28(g)中的函数的周期已通过至少填充399个0的方法加长了，
其结果就是一个周期卷积，其中每个周期都与图4.28(e)中的正确结果相等。对DFT使用卷积定理将
得到与图4.28(e)相同的799点的空间函数。其结论是：若要使第3章介绍的“直接”卷积公式法与
DFT方法产生的卷积结果相同，后者必须对函数补足周期再计算它们的变换。
形象地表示二维下的例子较为困难，但是，我们可以得出关于缠绕错误及对函数补0的相同的
结论。令f(x,y)和h(x,y)分别是大小为A×B和CxD像素的图像阵列。在循环卷积中的缠绕错误可以
通过对这两个函数进行零填充来避免，方法如下：
零可添加到函数的开始处，或分别
添加到函数的开始处和结尾处。但将
零添加到函数的结尾处更为简单
第4章 频率域滤波 159
,a)-{6c 0≤x≤A-1和0≤y≤B-1
A≤x≤P或B≤y≤Q (4.6-27)
和
h,(x){0C, 0≤x≤C-1和0≤y≤D-1
C≤x≤P或D≤y≤Q (4.6-28)
其中，
P≥A+C-1 (4.6-29)
和
Q≥B+D-1 (4.6-30)
填充后的图像大小为P×Q。如果两个阵列大小相同，都是M×N,则要求
P≥2M-1 (4.6-31)
和
Q≥2N-1 (4.6-32)
在4.7.2节，我们将给出一个例子来说明图像上出现缠绕错误所带来的影响。一般来说，DFT算
法对偶数尺寸的阵列执行较快，因此最好选择P和Q为满足上面方程的最小偶整数。如果两个阵列
大小相同，则意味着P和Q选择为该阵列大小的两倍。
在图4.28(a)和图4.28(b)中，两个函数的值在取样间隔的尾端方
便地变为0。如果这两个函数中有一个函数或两个函数的值在取样区
间的尾端不是0,当把0添加到函数上以消除缠绕错误时，就将创建
一个不连续的函数。这类似于用一个“盒子”与一个函数相乘，在频
率域它意味着原始变换与一个 sinc 函数的卷积(见例4.1),依次地，
这将造成一个由sinc函数的高频分量导致的所谓频率泄漏。泄漏会在
图像上产生块效应。虽然漏泄从来没有被完全消除过，但可以用另外
一个函数乘以取样函数来明显地加以减少，这个函数在取样数据的两端平滑地过渡到接近于零，从而
减弱“盒子”的(高频分量)急剧过渡。当在图像重建(如高清晰度图形)中希望保真度高的时候，这
种称为开窗或切趾的方法是重要的考虑。如果您需要开窗，较好的方法是使用二维高斯函数(见4.8.3
节)。该函数的的优点是其傅里叶变换也是高斯的，这样会产生较低的泄漏。
4.6.7 二维离散傅里叶变换性质的小结
表4.2总结了本章中介绍的主要的DFT定义。4.11.1节将讨论可分性，4.11.2节将讨论用正变换
算法得到反变换。第12章将讨论相关。
表4.3总结了一些重要的DFT对。虽然我们的关注点在离散函数上，但表中的最后两项是仅针对
连续变量推导的傅里叶变换对(注意连续变量符号的使用)。为了合适的解释，在此处包含这两项的原
因在于它们在数字图像处理中非常有用。微分对可用于推导式(3.6-3)中定义的拉普拉斯变换的频率
域公式(见问题4.26)。高斯对将在4.7.4节讨论。
表4.1到表4.3总结了使用DFT时的有用性质。这些性质中的许多种是本章剩余材料的关键内容，
有些性质则会在后续几章中用到。
一个简单的切趾函数是位于取样
据的两端过渡到0。这称为布特沃斯
高斯函数。在5.11.5节中，我们将
数据中心的三角形，它会在取样数
窗。其他一些常见的窗口是汉明窗
会回到加窗问题。
和汉宁窗。我们甚至可以使用一个
2-2
-2
160 数字图像处理(第三版)
表4.2 DFT定义及相应表达式小结
名 称 表 达 式
1)f(x,y)的离散傅里叶变换(DFT) Fa,)=22rase
2)F(u,v)的离散傅里叶反变换(IDFT) fu=六22Fa,pe
3)极坐标表示 F(u,)=|F(u,v|e(u)
4)谱 |F(u,v|=[R2(u,v)+I2u,D]“
R=Real(F);I=Imag(F)
5)相角
6)功率谱
eu,y)=cm]
P(u,)=|F(u,2
7)均值 Tux六2Zru,-六F.0)
8)周期性(k?和k?为整数) F(u,v)=F(u+k?M,v)=F(u,v+k?N)=F(u+k?M,v+k?N)
9)卷积
f(x,y)=f(x+k?M,y)=f(x,y+k?N)=f(x+k?M,y+k?N)
rax)hx)-221mnh(x-m,y-m)
10)相关 fa,yh(x,)=22f'(mmhx+m,y+m)
11)可分性 二维 DFT可以用先沿图像的行(列)计算一维 DFT变换，然后沿结果的列(行)计算
12)使用正变换算法得到傅里叶反变换
一维变换。见4.11.1节 Mwrta-22rs
该式指出，将F(u,v)输人计算正变换的算法(上式右侧)中，将得到MNf'(x,y)。
取复共轭并除以MN就可给出希望的反变换。见4.11.2节
表4.3 DFT 对的小结。第12项和第13项中的闭合表达式仅对连续变量有
效。通过对闭合形式的连续表达式取样后，它们也可用于离散变量
名 称 DFT对
见表4.1
af(x,y)+bf?(x,y)?aF(u,v)+bF?(u,V
f(x,yeP(/Mtsy/m=F(u-h,V-vo)
f(x-xo.y-yo)一F(u,v)e-2M+%M
f(x,y)(-D)→F(u-M/2,u-N/2)
r.-+e)2y-2P+-一
x=rcosθ y=rsinθu=①cosφ v=osinφ F
f(x,y)*h(x,y)? F(u,v)H(u,V)
f(x,y)h(x,y)?F(u,v)*H(u,v)
f(x,y)kh(x,y)?F(u,D)H(u,W)
xyh uyau
rcla,blc)s(b)e
sin(2max+2m?一i (8u+Muv+Nu)-8(u-Mua?v-Mo]
1)对称性
2)线性
3)平移性(一般)
4)平移到频率矩形的中心(M2,N2)
5)旋转
6)卷积定理
7)相关定理
8)离散单位冲激
9)矩形函数
10)正弦函数
第4章 频率域滤波 161
续表
名 称 DFT对
11)余弦函数 cs2m,x+27y18u+Ma.v+Mm)+8(u-Mm,v-No)
下面的傅里叶变换对仅连续变量可推导，如之前那样，用：和：表示空间变量，用μ和v表示频率变量。对连续函数取样后，
这些结果可用于DFT处理。
12)微分[右边的表达式假定f(tm,t)=0] (()rus)(2ur(mrFuy
13)高斯 (zmurFuGmyru
A2πo2e-AeA是常数)
假定这些函数已经过0填充而得到了扩展。卷积和相关满足结合律、交换律和分配律。
4.7 频率域滤波基础
在这一节中，我们将为本章剩余内容中讨论的所有滤波技术奠定基础。
4.7.1 频率域的其他特性
我们从观察式(4.5-15)开始，式中F(u,v)的每一项都包含有用指数项修改过的f(x,y)的所有值。
这样，除了不太重要的情况外，将一幅图像的某些特定分量与其变换直接联系起来通常是不可能的，
然而，关于傅里叶变换的频率分量和一幅图像的空间特性间的关系可以做出某些一般的叙述。例如，
因为频率直接关系到空间变化率.因此直观地将傅里叶变换中的频率与图像中的亮度变化模式联系起
来并不困难。我们在4.6.5节已经说明过，变化最慢的频率分量(u=v=0)与图像的平均灰度成正比。
当我们远离变换的原点时，低频对应于图像中变化缓慢的灰度分量。例如，在一幅房间图像中，这些
可能对应于墙和地板的平滑灰度变化。当我们从原点移开更远一些时，较高的频率开始对应于图像中
越来越快的灰度变化。这些是物体的边缘，或由灰度急剧变化来表征的其他图像分量。
正如2.6.7节介绍的那样，频率域中的滤波技术是以如下处理为基础的：修改傅里叶变换以达到
特殊目的，然后计算 IDFT 返回到图像域。遵循式(4.6-15),我们所用变换的两个分量是变换的幅
度(谱)和相角。4.6.5节涵盖了变换的这两个分量的基本性质。在那里，我们已了解到，相位分量
的视觉分析通常并不是很有用，然而，产生该谱的图像的大致特点提供了某些很有用的指导。例如，
考虑图4.29(a),它是一块集成电路的扫描电子显微图像，放大了近2500倍。除了器件本身的有趣结
构之外，我们注意到两个主要特性：近似±45°方向的很强的边缘和两个由热感应故障导致的白色氧
化突起物。图4.29(b)中的傅里叶谱显示了沿±45°方向的突出分量，这些分量对应于刚刚提到的边缘。
沿垂直轴仔细观察，可看到一个稍微左偏垂直轴的垂直分量，该分量是由氧化突起物的边缘导致的。
注意该频率分量与垂直轴的夹角是如何对应于长的白色物体(关于水平轴的)倾斜度的，还要注意垂直
频率分量中的零是如何对应于氧化突起物的狭窄垂直范围的。
a b
图4.29(a)已损坏集成电路的SEM图像；(b)图(a)的傅里叶谱(原图像由加拿大
安大略省哈密尔顿市McMaster大学材料研究所的J.M.Hudak博士提供) 6受
晰
162 数字图像处理(第三版)
这些对应关系通常是在频率域与空间域之间建立的典型联系。正如在本章稍后我们要说明的那
样，恰恰是这些总体联系的类型与前面提到的频率内容和图像灰度变化率之间的伴随关系，可以导致
某些非常有用的结果。在下一节中，我们将说明修改图4.29(a)的变换中的各种频率范围的效果。
4.7.2 频率域滤波基础
频率域滤波由修改一幅图像的傅里叶变换然后计算其反变换得到处理后的结果组成。由此，若
给定一幅大小为M×N的数字图像f(x,y),则我们感兴趣的基本滤波公式有如下形式：
g(x,y)=3'[H(u,)F(u,] (4.7-1)
其中，31是IDFT.F(u,v)是输入图像f(x,y)的DFT,Hu,v)是滤波函数(也简称为滤波器，或者滤波
传递函数),g(x,y)是滤波后的(输出)图像。函数F,H和g是大小与输 如果H是实对称函数而厂是实函
入图像相同的M×N阵列。如2.6.1节定义的那样，乘积H(u,v)F(u,v) 数(通常如此),则式(4.7-1)中的
IDFT理论上应生成实数量 实际上. 是由阵列相乘形成的。滤波函数修改输入图像的变换来得到处理后的
输出g(x,y)。使用关于中心对称的函数可显著地简化H(u,v)的技术条 其他计算错误引起的寄生复数项。
该反变换通常包含有由舍入误差和
件，它要求 F(u,v)也被中心化。如4.6.3节解释的那样，这是通过在 因此，我们通常取IDFT的实部来形
成函数g 计算变换前使用(-D)**乘以输入图像来完成的。
现在，我们能够考虑滤波过程的一些细节了。我们可以构建的最简单的滤波器之一是滤波器H(u,v).
它在变换的中心处是0,而在其他处是1。当我们建立乘积H(u,)F(u,v)时，该滤波器将抑制F(u,v)的直
流项而“通过”(即保留不变)所有其他项。我们从式(4.6-21)知道，直流项决定图像的平均灰度，因
此，将其置0会把输出图像的平均灰度减小为0。图4.30显示了使用式(4.7-1)时这一操作的结果。如
期望的那样，图像变得更暗了[零平均表明存在负灰度。因此，尽管图4.30说明了原理，但不是原图
像的真实描述，因为所有负灰度为显示目的都被修剪过(置为0)]。
如早些时候说明的那样，变换中的低频与图像中缓
慢变化的灰度分量有关，如室内的墙面和室外少云的天
空等。另一方面，高频由灰度的尖锐过渡造成，如边缘
和噪声等。因此，我们认为衰减高频而通过低频的滤波
器H(u,v)(近似称为低通滤波器)将模糊一幅图像，具有
相反特性的滤波器(称为高通滤波器)将增强尖锐的细
节，但是将导致图像对比度的降低。图4.31说明了这些效
应。注意图4.31(e)和图4.30之间的相似性。原因是所示
图4.30 将傅里叶变换中的F(M2,N/2)项置0, 的高通滤波器消去了直流项，导致了与图4.30相同的基本
效果。对滤波器加上一个小常数不会影响尖锐性，但是
它的确能防止直流项的消除，并保留色调，如图4.31(1所示。
对图4.29(a)中的图像滤波后的结果
式(4.7-1)涉及频率域中两个函数的乘积，由卷积定理，这意味着空间域的卷积。我们从4.6.6节
的讨论知道，如果问题中的函数未被填充，可以料到会产生混淆误差。当我们用式(4.7-1)而没有填充
时，考虑一下会发生什么情况。图4.32(a)显示了一幅简单的图像，图4.32(b)是使用图4.31(a)所示形
式的高斯低通滤波器对图像低通滤波后的结果。如预料的那样，图像被模糊了，然而，模糊是不
①许多二维 DFT的软件实现(如MATLAB)并不要求变换关于中心对称。这意味着我们必须安排滤波函数，以便其数据格式与非
中心对称变换的数据格式相同(即让原点在左上角)。最终结果是生成和显示滤波器更为困难。在我们的讨论中，为便于显示。
我们使用中心对称的变换，这对于清楚理解滤波的概念至关重要。只要保持了一致性，实践中可使用任意一种方法
第4章 频率域滤波 163
均匀的；顶部的白边被模糊了，而两侧的白边未被模糊。在应用式(4.7-1)之前，根据式(4.6-31)和
式(4.6-32)填充输入图像，将导致图4.32(c)所示的滤波后的图像。这正是我们期望的结果。
H(. (. H(m.
M/2 N/2 M/2 N/2
N/2 M/2
ai
图4.31 上一行：频率域滤波器。下一行：使用式(4.7-1)得到的相应的滤波后的图像。在图(c)
中我们使用a=0.85来得到图(f(滤波器本身的高度是1)。请将图()与图4.29(a)比较
a be
图4.32 (a)一幅简单的图像；(b)无填充时使用高斯低通滤波器的模糊结果；(c)填
充后的低通滤波的结果。请比较图(b)和图(c)中垂直边缘的明亮区域
图4.33说明了图4.32(b)和(c)之间差异的原因。图4.33中的虚线区域对应图4.32(a)中的图像。
如4.6.3节解释的那样，图4.33(a)显示了使用DFT的固有周期性。想象一下该模糊滤波器的空间表
示与该图像卷积。当滤波器通过虚线框起来的图像区域的上方时，它将包围该图像的一部分及其右上
方周期图像底部的一部分。当一个暗区域和一个亮区域在滤波器下方时，结果是一幅中等灰度的模糊
图像。然而，当滤波器通过图像的右上侧时，滤波器将只包围图像中的亮区域及其右侧的相邻区域。
一个常数的平均仍是该常数，在这个区域滤波将无效，图4.32(b)给出了结果。用0填充图像以在周
期序列的周围建立一个平坦的边界，如图 4.33(b)所示。将模糊函数与图4.33(b)所示填充过的“马赛
克”图像卷积，给出了图4.33(c)所示的正确结果。从这个例子您可以看到，错误地填充一幅图像会导
致错误的结果。如果滤波的目的仅仅是粗糙的视觉分析，那么有时可以跳过填充步骤。
到目前为止，讨论集中在输入图像的填充上，但是，还包含一个滤波器，该滤波器可以在空间
域或频率域中来规定。然而，填充是在空间域完成的，这就提出了空间填充和直接在频率域指定滤波
器间的关系这个重要问题。
初看起来，一个可能的结论是：处理频率域滤波器填充的一种方法是构建一个与图像尺寸相同
的滤波器，计算该滤波器的IDFT 得到相应的空间滤波器，在空间域填充这个空间滤波器，然后计算
其DFT返回到频率域。图4.34所示的一维例子说明了这种方法的缺陷。图4.34(a)显示了频率域中的一 居:
164 数字图像处理(第三版)
个一维理想低通滤波器。该滤波器是实的和偶对称的，因此，我们由表4.1中的性质8可知其IDFT
也是实的和偶对称的。图4.34(b)显示了用(-1)“乘以频率域滤波器的元素的结果，并计算其IDFT以
得到相应的空间滤波器。该空间函数的两端不是0,因此，如图4.34(c)所示，对该函数进行0填充创
建了两个不连续的函数(在函数的两端填充与在一端填充效果相同，只要所用的0的总数相同即可)。
a b
图4.33 使用DFT时二维图像固有的周期性。(a)未填充图像的周期性；(b)使用0填充(黑)后图像的周期性。中心的
虚线区域对应于图4.32(a)中的图像(为清楚起见，两幅图像中的细白线重叠在一起，它们不是数据的一部分)
跳
1.2 0.04 a c b d
1
0.03
0.8
0.6 0.02
0.4 0.01
0.2
0
0
-0.20 128 255 -0.010 128 256 384 511
0.04 1.2
1
0.03
0.8
0.02 0.6
0.01 0.4
0.2
0
0
-0.010 128 255 -0.2 0 128 256 384 511
图4.34 (a)在(中心对称的)频率域中指定的原始滤波器：(b)计算图(a)的IDFT得到的空间表示；(c)将图(b)填
充至其两倍长度后的结果(注意不连续点);(d)通过计算图(c)的DFT得到的相应的频率域滤波器。
注意，图(c)中的不连续导致了振铃现象(为简化视觉分析.点已连接起来，因此曲线看起来是连续的)
为了回到频率域，我们计算填充后的空间滤波器的DFT。图4.34(d)显示了这一结果。正如在例4.1
中您所预料的那样，空间滤波器中的不连续在其频率域中产生了振铃。
如果以另一种方法来观察，我们从一个例子知道，一个盒函数的傅里 理想滤波2器的定义见433节的末尾。
第4章 频率域滤波 165
叶变换是一个其频率分量无限扩展的sinc 函数，因此我们期望盒函数的反变换也有相同的属性。也
就是说，一个理想的(盒状)频率域滤波器的空间表示具有无限扩展的分量。因此，任何实现0填充的
滤波器的空间截断将引入不连续性，它通常会在频率域导致振铃现象(在这种情况下，如果它在0交
叉处做填充，可避免截尾，但我们感兴趣的是一般的过程，而不是所有的滤波器都有0交叉)。
前面的结果告诉我们，因为我们不能处理无限数量的分量，所以不可能使用理想的频率域滤波器
[见图4.34(a)].并且，同时使用零填充来避免缠绕错误。因此，需要有一个可以接受的限制性决策。
我们的目标是在频率域使用一个特定形状的滤波器(包括理想滤波器)而不必涉及截断问题。一种方法
是对图像0填充，然后，在频率域创建滤波器，其尺寸与填充过的图像一样(记住，使用DFT时，
图像和滤波器的大小必须相同)。当然，这将导致缠绕误差，因为未对该滤波器使用填充。但在实践中，
该错误可通过图像填充提供的间隔有效地减轻，它对振铃也更好。平滑滤波器(如图4.31中的那些)存
在的问题更少。特别地，为了直接在频率域使用特定形状的滤波器做处理，本章中我们采用的方法
是把图像填充为P×Q大小，并构造相同维数的滤波器。正如早些时候说明的那样，P和Q分别由
式(4.6-29)和式(4.6-30)给出。
我们将以分析滤波变换的相位角来结束这一节。因为DFT是复数阵列，我们可以将它表示为实
部和虚部：
F(u,v)=R(u,v)+j/(u,v) (4.7-2)
然后，式(4.7-1)变为
g(x,y)=3?'[H(u,v)R(u,v)+jH(u,v)I(u,v] (4.7-3)
相位角不能以刚刚描述的方法由滤波来更改，因为当虚部和实部之比由式(4.6-17)形成时，Hu,v)就消去
了。等同地影响实部和虚部而不影响相位的滤波器称为零相移滤波器。本章中仅考虑这种类型的滤波器。
即使相位角的很小变化，也会对滤波输出有很大的影响(通常是我们不希望的)。图4.35说明了如标
量一样简单的变化所带来的影响。图4.35(a)显示了用0.5乘以式(4.6-15)中的角度阵列得到的图像，不改
变IF(u,v)l,然后计算IDFT。基本形状保持不变，但灰度分布失真很大。图4.35(b)显示了用0.25乘
以相角的结果。该图像几乎无法识别。
a b
图4.35 (a)使用0.5乘以式(4.6-15)中的相角然后计算IDFT得到的图像；
(b)使用0.25乘以相角得到的结果。两种情况下的谱没有变化
4.7.3 频率域滤波步骤小结
前两节的内容可以总结如下：
1.给定一幅大小为M×N的输入图像f(x,y),从式(4.6-31)和式(4.6-32)得到填充参数P和Q。
典型地，我们选择P=2M和Q=2N
2.对f(x,y)添加必要数量的0,形成大小为P×Q的填充后的图像f,(x,y)。 医圈
166 数字图像处理(第三版)
贸
3.用(-1)***乘以f,(x,y)移到其变换的中心。
4.计算来自步骤3的图像的DFT,得到F(u,v)。
5.生成一个实的、对称的滤波函数H(u,v),其大小为P×Q.中心在(P/2.Q/2)处。用阵列相乘
形成乘积G(u,v)=H(u,v)F(u,v);即G(i,k)=Hi,k)Fi,k)。
6.得到处理后的图像： 如前所述，关于中心对称有助于
形象地描述滤波过程并生成滤波函 8,(x,y)={rea[s1'[G(u,D1]}(-1)* 数本身，但它不是基本的需求。
其中，为忽略由于计算不准确导致的寄生复分量，选择了实部，下标p指出我们处理的是填
充后的阵列。
7.通过从g,(x,y)的左上象限提取M×N区域，得到最终处理结果g(x,y)。
图4.36说明了上述步骤。图中的符号解释了每一个图像源。如果它被放大，图4.36(c)将会显示
图像中插入的黑点，因为，为了显示，负的灰度被裁剪为0了。注意图4.36(h)中图像暗边的特点，
它是使用零填充处理后由低通滤波造成的。
a b e d efgh
图4.36 (a)一幅大小为M×N的图像f;(b)大小为P×Q填充后的图像；(c)用(-1)*乘以，的结果；
(d)F,的谱：(e)大小为P×Q的关于中心对称的高斯低通滤波器；(4)乘积HF,的谱；g)(-1)”
与HF,的IDFT的实部的乘积g,;(h)裁剪g,的前M行和前N列得到的最终结果g
4.7.4 空间和频率域滤波间的对应
空间域和频率域滤波间的纽带是卷积定理。在4.7.2节，我们把频率域中的滤波定义为滤波函数
Hu,v)与输入图像的傅里叶变换F(u,v)的乘积。给定一个滤波器H(u,v),假定我们想要找出其空间域
的等价表示。如果我们令f(x,y)=δ(x,y),它来自表4.3的F(u,v)=1。然后，由式(4.7-1)可知滤波
后的输出是3'[H(u,v]。但这是频率域滤波器的反变换，它对应空间域的滤波器。反过来，遵循类
似的分析和卷积定理，给定一个空间滤波器，我们可以用该空间滤波器的傅里叶正变换得到其频率域
表示。因此，两个滤波器形成了傅里叶变换对：
h(x,y)?H(u,v) (4.7-4)
其中，h(x,y)是一个空间滤波器。因为该滤波器可以由频率域滤波器对一个冲激的响应得到，所以h(x,y)
①如果H(M,)由一个给定的空间滤波器hGx.y)生成，则可按如下方式形成A,(xLy):将该空间滤波器的大小填充为P×Q,使用(-1D)**乘
以扩展后的阵列，并计算结果的DFT来得到H(u,)。例4.15给出了这个过程。
第4章 频率域滤波 167
有时称为Hu,v)的脉冲响应。还有，因为式(4.7-4)的离散实现中的所有数值都是有限的，这样的滤波
器称为有限冲激响应(FIR)滤波器。这些仅是在本书中考虑的一类线性空间滤波器。
我们在3.4.1节中介绍了空间卷积，并讨论了其与式(3.4-2)有关的实现，它涉及不同尺寸的卷积
函数。当我们根据卷积定理和 DFT 谈到空间卷积时，正如图4.28解释的那样，它意味着我们对周期
函数卷积。由于这一原因，如之前解释的那样，式(4.6-23)称为循环卷积。此外，在DFT的意义上，
卷积包含相同尺寸的函数，反之，在式(3.4-2)中，典型地，函数是不同尺寸的。
在实践中，我们宁愿使用式(3.4-2)和较小的滤波器模板来实现卷积滤波，因为在硬件和(或)固
件实现时速度快而容易。然而，滤波的概念在频率域更直观。取两个域的特性的优点的一个方法是在
频率域规定一个滤波器，计算它的IDFT,然后，如构建较小的空间滤波模板那样，用反变换的结果
得到全尺寸的空间滤波器(更正式的方法将在4.11.4节中介绍)。这在下一节中再说明。在这一节稍
后，我们将给出相反的过程，在这里，给定一个小的空间滤波器，我们得到其全尺寸频率域表示。这
种方法在频率域分析较小的空间滤波的特性是很有用的。记住，在下面的讨论中，傅里叶变换及其反
变换是线性处理(见习题4.14),因此讨论只限于线性滤波。
在下面的讨论中，我们使用高斯滤波器来说明如何运用频率域滤波器指定第3章中讨论的一些小模板
的系数。基于高斯函数的滤波器特别重要，因为如表4.3注释的那样，一个高斯函数的正、反傅里叶变换
都是实高斯函数。为便于说明原理，这里仅讨论一维高斯滤波器。二维高斯滤波器在这一章稍后再讨论。
令H(u)表示一维频率域高斯滤波器：
H(u)=Ae2/20° (4.7-5)
其中，σ是高斯曲线的标准差。空间域中的相应滤波器由H(u)的傅里叶反变换得到(见习题4.31):
h(x)=√2πoAe-22a2 (4.7-6)
这些公式①很重要，原因有二：(1)它们是一个傅里叶变换对，两个分量都是高斯的和实的函数。这便
于分析，因为我们不必涉及复数。另外，高斯曲线很直观，并易于操作。(2)函数表现为互易的。当H(u)
有一个较宽的外形时(σ值较大),h(x)有较窄的外形，并且，反之亦然。事实上，当σ接近无限时，Hu)
接近一个常数函数，并且h(x)趋近于一个冲激，这意味着在频率域和空间域都不能滤波。
图4.37(a)和图4.37(b)显示了频率域高斯低通滤波器和空间域对应的低通滤波器的曲线。假定我们想
要使用图4.37(b)中h(x)的曲线形状作为指导规定一个小空间模板的系数。这两个滤波器之间的关键相似
性是它们的所有值都是正的。这样，我们就得出一个结论，我们使用一个全部带正系数的模板就可在空
间域中实现低通滤波(如我们在3.5.1节中所做的那样)。作为参考，图4.37(b)中显示了在3.5.1节中讨论
的两个模板。注意前一段讨论的滤波器宽度间的互易关系。频率域滤波器越窄，其衰减的低频越多，引
起的模糊越大。在空间域，这意味着必须使用较大的模板来增加模糊，正如例3.13中说明的那样。
更复杂的滤波器可以使用式(4.7-5)给出的基本高斯函数来构建。例如，我们可以用高斯函数的
差来构造一个高通滤波器：
H(u)=Ae2202-Be-2/2o} (4.7-7)
其中，A≥B,o?>0?。空间域中的相应滤波器是
h(x)=√2πo,Ae~′i-√2πo?Be-2o (4.7-8)
图4.37(c)和图4.37(d)显示了这两个公式的曲线。我们再次注意到宽度的互易性，但这里最重要的特
①像表43中提及的那样，高斯函数的闭合形式的正反傅里叶变换仅对连续函数有效。要使用离散公式，我们只需对连续的高斯
变换取样。这里使用离散变量表明我们正在处理取样后的变换。 宽
:灵
168 数字图像处理(第三版)
性是，h(x)有一个正的中心项及在其两侧的负项。显示在图 4.37(d)中的小模板“捕捉”了这一特点。
这两个模板在第3章中用做锐化滤波，即我们目前所知道的高通滤波器。
acbd H(n) H(u) hGr)
h(x)
图4.37(a)频率域中的一维高斯低通滤波器；(b)对应于图(a)的空间低通滤波器；(c)频率域中的高斯高通
滤波器；(d)对应于图(c)的空间高通滤波器。所示小二维模板是我们在第3章中用过的空间滤波器
虽然我们已经做了许多努力，但我们确信，如果没有刚刚建立的基础，要真正理解频率域滤波
是不可能的。在实践中，频率域可被视为一个“实验室”,在这里，我们取频率内容和图像表观之间
相应的优点。如本章后面多次展示的那样，有些在空间域异常困难的或不可能直接用公式表达的任务
在频率域却变得很容易。一旦我们在频率域通过实验选择了一个特定的滤波器，该方法的实际实现通
常是在空间域完成的。一种方法是指定试图捕获空间域中全部滤波器函数的“本质”的小空间模板.
正像我们在图4.37中解释的那样。更正式的方法是使以数学或统计规则为基础近似设计一个二维数字
滤波器。在4.11.4节中将再次接触这个主题。
例4.15 由小空间模板得到频率域滤波器。
在这个例子中，我们从一个空间模板开始，并说明如何产生相应的频率域滤波器。然后，我们比较
用频率域滤波和空间技术得到的滤波结果。当希望比较给定的空间模板相对于一个或多个频率域全滤波
器候选者的性能时，或者深入理解模板的性能时，这类分析是很有用的。为简单计，我们使用来自图3.41(e)
中的3×3 Sobel垂直边缘检测器。图4.38(a)显示了一幅600×600像素的图像f(x,y),我们要对它进行滤
波，图4.38(b)显示了该图像的谱。
图4.39(a)显示了这个Sobel模板h(x,y)(透视图在下面解释)。因为输入图像的大小是600×600像素，
而滤波器的大小为3×3,为避免缠绕错误，我们根据式(4.6-29)和式(4.6-30)将f和h填充为602×602像素
大小，Sobel 模板是奇对称的，它被嵌入到一个偶数尺寸的0阵列中(见例4.10)。为保持这种对称性，我
们把h(x,y)的中心放在602×602这个填充后的阵列的中心处。对滤波器生成来说，这是一个很重要的方面。
如果我们在形成h,(x,y)的过程中，关于填充后的阵列保持奇对称，则由表4.1中的性质9可知H(u,v)将完
全是虚函数。如我们在本例末尾显示的那样，这将得到用h(x,y)对图像进行空间滤波相同的结果。如果不
保持这种对称性，则结果将不再相同。
用以产生H(u,v)的过程是：(1)用(-1)*'乘以h(x,y)以便频率域滤波器“中心化”;(2)计算(1)中结果
的正 DFT;(3)考虑寄生的实部(我们知道H(u,v必须是纯虚函数),将得到的DFT的实部置0;(4)用(-1)“*
乘以该结果。最后一步反过来用(-1)*乘以H(u,v),它隐含着h(x,y)被移到h,(x,y)的中心。图4.39(a)显示
了Hu,v)的透视图，而图4.39(b)以图像的方式显示了Hu,v)。如期望的那样，该函数是奇函数，因而其关
于中心反对称。在4.7.3节略述的步骤中，函数H(u,v)被用做任何其他的频率域滤波器。
图4.39(c)是在4.7.3节略述的步骤中使用刚才得到的滤波器对图4.38(a)中的图像滤波的结果。正如
我们对推导出的滤波器所期望那样，边缘被增强了，所有的恒值灰度区域被减小为0(为了显示，灰度色
调进行了标定)。图4.39(d)显示了在3.6.4节给出的步骤中使用h(x,y)直接在空间域对同一图像滤波的结
果，结果相同。
第4章 频率域滤波 169
ab
图4.38(a)一幅建筑物的图像；(b)该图像的谱
a bc d -t 0
-2 0 2
-1 0 1
图4.39(a)一个空间模板和它的频率域中对应的滤波器的透视图：(b)以图像形式显示的滤波器；(c)在频率域中使用
图(b)中的滤波器对图4.38(a)滤波后的结果；(d)使用(a)中的空间滤波器对同一图像滤波的结果。结果相同
4.8 使用频率域滤波器平滑图像
本章剩余部分将涉及频率域中的各种滤波技术。我们从低通滤波器开始。一幅图像中的边缘和其
他尖锐的灰度转变(如噪声)对其傅里叶变换的高频内容有贡献。因此，在频率域平滑(模糊)可通过对
高频的衰减来达到；也就是用低通滤波。在这一节，我们考虑三种类型的低通滤波器：理想滤波器、
布特沃斯滤波器和高斯滤波器。这三种滤波器涵盖了从非常尖锐(理想)的滤波到非常平滑(高斯)的滤波
范围。布特沃斯滤波器有一个参数，称为滤波器的“阶数”。当阶数值较高时，布特沃斯滤波器接近于理
想滤波器。对于较低的阶数值，布特沃斯滤波器更像高斯滤波器。这样，布特沃斯滤波器可看成是两种
“极端”滤波器的过渡。本节中所有的滤波器都遵循4.7.3节概述的步骤，因此所有的滤波函数H(u,v)可
理解为大小为P×Q的离散函数，即离散频率变量的范围是u=0,1,2,…,P-1和v=0.1.2,…,Q-1。
4.8.1 理想低通滤波器
在以原点为圆心、以D?为半径的圆内，无衰减地通过所有频率，而在该圆外“切断”所有频率
的二维低通滤波器，称为理想低通滤波器(ILPF);它由下面的函数确定：
Hu)={6Duy>D (4.8-1)
其中，D?是一个正常数，D(u,v)是频率域中点(u,v)与频率矩形中心的距离，即
D(u,)=[u-P/2]2+(v-Q/2)2]2 (4.8-2)
其中，与以前一样，P和Q是用式(4.6-31)和式(4.6-32)填充后的尺寸。图4.40(a)显示了H(u,v)的透视图，
图4.40(b)显示了以图像显示的滤波器。如4.3.3节提到的那样，理想这一名称表明在半径为D?的圆 :引
园
170 数字图像处理(第三版)
内，所有频率无衰减地通过，而在此圆之外的所有频率则完全被衰减(滤除)。理想低通滤波器是关
于原点径向对称的，这意味着该滤波器完全由一个径向横截面来定义，如图4.40(c)所示。将该横截
面旋转360°得到二维滤波器。
对于一个理想低通滤波器(ILPF)横截面，在H(u,v)=1和H(u,v)=0之间的过渡点称为截止频率。
例如，在图4.40所示的情况下，截止频率为D?。ILPF的这种陡峭的截止频率不能使用电子元件来实
现，尽管它们可以在计算机上仿真。对数字图像使用这些“非物理”滤波器的效果将在本节后面讨论。
H(u,0) H(u,)
1
u
a b c D? →D(u,n)
M
图4.40(a)一个理想低通滤波器变换函数的透视图；(b)以图像形式显示的滤波器；(c)滤波器径向横截面
本章介绍的低通滤波器可用具有相同截止频率的函数研究其特性而加以比较。建立一组标准截
止频率轨迹的一种方法是计算包含规定的总图像功率值P的圆。该值是通过求每个点(u,v)处填充后
图像的功率谱分量的和得到的，其中u=0,1,…,P-1,v=0.1,….Q-1.即
r-2Su) (4.8-3)
其中，P(u,v)已在式(4.6-18)中给出。如果DFT已被中心化，那么原点位于频率矩形中心处、半径为
D?的圆将包含α??功率，其中
=100ZZPu.D/R (4.8-4)
则总和取处于圆之内或边界线上的(u,v)值。
图4.41(a)和(b)显示了一幅测试模式图像及其傅里叶谱。谱上重叠的圆的半径分别为10,30,60,
160和460像素。这些圆包围的图像功率(a???别为87.0?3.1?5.7?7.8?99.2??谱迅速衰
落，总功率的87?含在半径为10的小圆内。
a b a a a a a a aa
图441(a)大小为688×688像素的测试模式；(b)测试模式的傅里叶谱。由于填充，该谱的大小为图像大小的两
倍，但是，它是以一半大小来显示的，因此，在页面上是匹配的。在谱上重叠的圆的半径相对于全尺寸的谱图
像来说分别为10,30,60,160和460。这些半径分别包含了填充后图像功率的87.0?3.1?5.7?7.8?99.2%
第4章 频率域滤波 171
例4.16 使用一个ILPF平滑图像。
图4.42显示了应用图4.41(b)中所示半径的截止频率的ILPF的结果。图4.42(b)对所有的实际目的没
有意义，除非模糊的目标是消除图像中的所有细节，但表示最大物体的“斑点”除外。此图像中的严重
模糊表明，图像中的多数尖锐的细节信息包含在被滤波器滤除的13??功率内。随着滤波器半径的增大，
滤除的功率越来越少，导致的模糊也越来越减弱。注意，图4.42(c)到图4.42(e)中的图像都有“振铃”的
特征，随着被滤除的高频内容的数量的减少，图像的纹理变得越来越好。甚至在只滤除了总功率的2??
图像[见图4.42(e)]中，振铃现象也很明显。正如稍后您很快将要看到的那样，这种振铃现象是理想滤
波器的一种特性。最后，α= 99.2??的结果在噪声区域内有非常轻微的模糊，但大部分图像与原图像非
常接近。这表明在这种特殊情况下，图像中很少有边缘信息包含在0.8??上的谱功率中。
从这个例子中可以清楚地看到，理想低通滤波器并不是非常实用。然而，作为滤波概念发展的一部
分，研究这种滤波器的特性非常有用。同时，正如以下讨论所示，通过试图解释IⅡLPF在空间域的振铃特
性，可以得到一些有趣的见解。
aa a a a a a a
…a …a …a
aaaaa aaa a aa a aa aa a aaa di
图4.42(a)原图像；(b)-(1使用ⅡPF滤波后的结果，截止频率分别设置在半径值10,30,60,160和460
处，如图4.41(b)所示。这些滤波器移除的功率分别为总功率的13?.9?.3?.2?0.8%
ILPF 的模糊和振铃特性可用卷积定理 a b
来解释。图4.43(a)显示了半径为10的ILPF
的空间表示hx,y),图4.43(b)显示了一条
通过图像中心的水平线的灰度剖面线。由
于ILPF在频率域的剖面图类似于盒状滤
波器，因此相应的空间滤波器具有sinc函
数形状是可以预料的。空间域滤波可以通
过h(x,y)与图像卷积来实现。将图像中的
每一个像素想象为一个离散冲激，它的强
度与所在位置的灰度成正比。一个sinc函
图4.43 (a)半径为5、大小为1000×1000的ILPF的空间域表
示；(b)一条通过图像中心的水平线的灰度剖面图
数与一个冲激卷积就是在冲激处复制这个sinc 函数。sinc 函数的中心波瓣是引起模糊的主因，而外侧
较小的波瓣是造成振铃的主要原因。sinc 函数与图像中的每一个像素卷积为解释 LPF 的特性提供了
一个很好的模型。因为sinc 函数的“展开度”与H(u,v)的半径成反比，D?越大，这个空间sinc 函数
就越趋近于一个与图像卷积时根本不会导致模糊的冲激。我们现在应已习惯了这种类型的彼此相反 -受
172 数字图像处理(第三版)
的特性。在接下来的两节中，我们将说明很小的或没有振铃而达到模糊是可能的，这是低通滤波的
重要目标。
容;言
4.8.2 布特沃斯低通滤波器
截止频率位于距原点D?处的n阶布特沃斯低通滤波器(BLPF)的
传递函数定义为
Hu.)=+[DuD/D。P
布特沃斯低通滤波器的传递函数通
常写为此处表达式的平方根。由于此
处我们关心的是这种滤波器的基本形
式，因此为计算方便去掉了平方根
(4.8-5)
其中，D(u,v)由式(4.8-2)给出。图4.44显示了该BLPF函数的透视图、图像显示和径向剖面图。
a b e H(n.,e) H(u,n)
1.0
n=1 0.5 ”=23
u n=4
D? -D(u.r)
图4.44(a)布特沃斯低通滤波器传递函数的透视图；(b)显示为图像的滤波器；(c)阶数为1到4的滤波器的径向剖面
与LPF不同，BLPF 传递函数并没有在通过频率和滤除频率之间给出明显截止的尖锐的不连续性。
对于具有平滑传递函数的滤波器，可在这样一点上定义截止频率，即使得H(u,v)下降为其最大值的某个
百分比的点。在式(4.8-5)中，截止频率点是当D(u,v)=D。时的点[即H(u,v)从其最大值1下降为50???
例4.17 使用布特沃斯低通滤波器平滑图像。
图4.45显示了将式(4.8-5)中的BLPF应用于图4.45(a)的结果，其中n=2,D?等于图4.41(b)所示的
5个半径。不像图4.42所示的LPF的结果，我们注意到，此处模糊的平滑过渡是截止频率增大的函数。
此外，使用这种特殊 BLPF 处理过的任何图像中都没有可见的振铃现象，这要归因于这种滤波器在低频
和高频之间的平滑过渡。
…a .a
aaa a a a aa aaa
…a …a …a
di aaaa a a aaa a a a a a aa a a a a aa
图4.45 (a)原图像；(b)~(1使用2阶BLPF的结果，BLPF
的截止频率位于图4.41所示的半径处。与图4.42比较
第4章 频率域滤波 173
在空间域的一阶布特沃斯滤波器没有振铃现象。在二阶滤波器中，振铃现象通常很难察觉，但
更高阶数的滤波器中振铃现象会很明显。图4.46 比较了不同阶数的BLPF的空间表示(所有情况下均
使用截止频率5),还显示了通过每个滤波器中心的水平扫描线的灰度剖面图。这些滤波器是使用生成
图4.43的相同过程来获得并显示的。为便于比较，使用伽马变换[见式(3.2-3)]对图4.46中的图像进
行了额外的增强。一阶BLPF[见图4.46(a)]没有振铃和负值。二阶BLPF的确显示了轻微的振铃和
较小的负值，但远没有在ILPF 中那样明显。正如其余图像所示，在BLPF中，高阶滤波器中的振铃
现象变得很明显。20阶布特沃斯滤波器呈现出了与ILPF类似的特性(极限情况下，两个滤波器相同)。
因此，二阶的BLPF是在有效的低通滤波和可接受的振铃特性之间的好的折中。
a bcd
图446(a)-(d)阶数分别为1.2,5和20的BLPF的空间表示及相应的通过滤波器中心的灰度剖面图(所有
情况下大小均为1000×1000,且截止频率为5)。观察作为滤波器阶数的函数的振铃是如何增加的
4.8.3 高斯低通滤波器
一维高斯低通滤波器(GLPF)在4.7.4节中已介绍过，当时介绍它的目的是用来帮助寻找空间域与
频率域之间的重要联系。这些滤波器的二维形式由下式给出：
H(u,v)=e-D2(,)/202 (4.8-6)
其中，如式(4.8-2)中那样，D(u,v)是距频率矩形中心的距离。为与本节讨论的滤波器保持一致，这里
我们并未像在4.7.4节那样使用一个最高值为1的常量乘数。与以前一样，σ是关于中心的扩展度的度
量。通过令a=D?,我们可以在本节中使用其他滤波器的表示法来表示该滤波器：
H(u,v)=eD'a,sz2D (4.8-7)
其中，D?是截止频率。当D(u,v)=D?时，GLPF下降到其最大值的0.607处。
如表4.3所示，GLPF的傅里叶反变换也是高斯的。这意味着通过计算式(4.8-6)或式(4.8-7)的IDFT
得到的空间高斯滤波器将没有振铃。图4.47显示了一个GLPF函数的透视图、图像显示和径向剖面图，
表4.4总结了本节讨论的低通滤波器。
a bc H(u,D) H(u.0)
1.0
D?=10
0.607 D?=20
D?=40
Do=100
u
D(u.)
图4.47(a)一个GLPF传递函数的透视图；(b)显示为图像的滤波器；(c)不同D。值的滤波器径向剖面图 貌～受
174 数字图像处理(第三版)
表4.4 低通滤波器。D?是截止频率，n是布特沃斯滤波器的阶数
图;言
理 想 布特沃斯
H)+Dw.y/D
高 斯
Ha-0Duy H(u,v)=ez
例4.18 使用高斯低通滤波器平滑图像。
图4.48显示了将式(4.8-7)给出的GLPF应用到图4.48(a)后的结果，其中D?等于图4.41(b)中的5个
半径。正如二阶 BLPF(见图4.45)的情况那样，我们注意到模糊的平滑过渡是截止频率增大的函数。比较
图4.45(c)和图4.48(c)可以看到，对于相同的截止频率，GLPF与二阶 BLPF相比，导致的平滑效果要稍
微差一些。这正如我们所料，因为GLPF的剖面图不像二阶BLPF的剖面图那样“紧凑”。但结果还是可
以比较的，且我们可以确信在GLPF 中没有振铃。这是实际中的一个重要特性，尤其是在任何类型的人工
缺陷不可接受的情况(如医学成像)下。在需要严格控制低频和高频之间截止频率的过渡的情况下，BLPF是
更合适的选择。额外控制滤波器剖面线的代价是可能会产生振铃。
…a .a
aaa a a a a a aaaa
…a …a …a
aei aaa a a a a aaaa a a a a aa a a a a a a
图448 (a)原图像；(b)-(0使用截止频率位于图441所示半径处的GLPF对图像滤波后的结果。请比较图442和图4.45
4.8.4 低通滤波的其他例子
在下面的讨论中，我们将说明频率域中低通滤波的几个实际应用。第一个例子来自机器感知领
域，即字符识别的应用；第二个例子来自印刷和出版业；第三个例子关系到卫星图像和航空图像的处
理。类似的结果可用3.5节讨论的低通空间滤波技术得到。
图4.49显示了一幅低分辨率文本的例子。例如，我们会在传真、复印材料和历史记录中遇到这样
的文本。这个特殊的例子中并不存在其他像污点、折痕和破痕这样的困难。图4.49(a)中的放大部分
表明该文件中的字符因分辨率不足产生了失真的形状，并且许多字符已断裂。尽管人为填充这些裂缝
在视觉上并不困难，但机器识别系统在阅读这些断裂字符时却存在困难。处理这种问题的一种方法是，
通过模糊输入图像来桥接输入图像中的这些小裂缝。图4.49(b)显示了如何使用D?=80的高斯低通滤
波器的简单处理图像很好地修复了字符。这些图像的大小为444×508像素。
低通滤波是印刷和出版业常用的一种技术，在这里用来做预处理，包括 3.6.3节中讨论过的去锐
化模板。“美容”处理是低通滤波在印刷业中的另一个应用。图4.50 4.95节中将讨论频率域中的去锐 显示了低通滤波的一个应用，与清晰的原图像相比，低通滤波后的图 化模板处理。
像看上去更平滑、更柔和。对于人脸，主要目的是减少皮肤细纹的锐
第4章 频率域滤波 175
化程度和小斑点。从图4.50(b)和图4.50(c)中的放大部分可明显看出，眼睛周围的细纹已明显减少。
事实上，平滑后的图像看上去更为柔和与美观。
a b Historically, certain computer
programs were written using
only two digits rather than
four to define the appticable
year.Accordingly, the
company's software may recognize a date using "00
as 1900 rather than theveer
Historiely, certain computer
programs were written using
only two digits rather than
tour to define the apphcable
year.Accordingly. the
compary's software may
recognize adate using "00*
as 1900 rather than the wea
2000. 2000.
E ea
图4.49(a)低分辨率文本例子(注意放大图中的断裂字符):(b)使用
GLPF对图像滤波后的结果(断开的字符段已被连在一起)
a b e
图4.50 (a)原图像(784×732像素);(b)使用D?=100的GLPF对图像滤波后的结果；(e)使用D?=
80的GLPF对图像滤波后的结果。注意图(b)和图(e)中放大部分的皮肤皱纹已减少了
图4.51显示了相同图像的两种低通滤波应用，但是具有不同目的。图4.51(a)是一幅显示了部分
墨西哥海湾(暗色)和佛罗里达(亮色)的、大小为808×754的甚高分辨率辐射计(VHRR)图像，该图像
由NOAA 卫星拍摄(注意水平传感器扫描线)。水体间的边界是由环流引起的。这幅图像是直观的遥
感图像，传感器具有沿着场景扫描方向产生突出的扫描线的倾向(见例4.24中在于物理原因的说明)。
低通滤波是降低这些线的影响的粗略而简单的方法，如图4.51(b)所示(4.10节和5.4.1节中将考虑更
为有效的方法)。该图像是使用D?=50的高斯低通滤波器得到的。降低扫描线的影响可简化如洋流间
边界特征的检测。
a bc
图4.51(a)显示有突出扫描线的图像；(b)使用D?=50的GLPF对图像滤波后的结
果；(c)使用D?=20的GLPF对图像滤波后的结果(原图像由NOAA提供) gr圜
崇
176 数字图像处理(第三版)
图4.51(c)显示了使用D?=20的高斯低通滤波器对图像滤波更有意义的结果。这里，对图像滤波
的目的是尽可能模糊更多的细节，而保留大的可识别特征。例如，这种类型的滤波可以作为图像分析
系统的预处理的一部分，该系统在图像库中搜索特征。具有这种特征的一个例子可能是给定大小的湖
泊，例如佛罗里达东南部的奥基乔比湖，如图 4.51(c)所示的一个近似环形的暗区。低通滤波通过消
除比感兴趣的平均特征小的其他特征来简化分析。
4.9 使用频率域滤波器锐化图像
在前面几节中，我们说明了通过衰减图像的傅里叶变换的高频成分可以平滑图像。因为边缘和
其他灰度的急剧变化与高频分量有关，所以图像的锐化可在频率域通过高通滤波来实现，高通滤波会
衰减傅里叶变换中的低频分量而不会扰乱高频信息。如4.8节那样，我们仅考虑径向对称的零相移滤
波器。本节中的所有滤波都以4.7.3节概述的过程为基础，因此所有的滤波器函数H(u,v)都可理解为
大小为P×Q的离散函数，即离散频率变量的范围是u=0,1,2,…,P-1和v=0,1,2,…,Q-1。
一个高通滤波器是从给定的低通滤波器用下式得到：
HHp(u,v)=1-H(u,v) (4.9-1)
其中，Hu(u,v)是低通滤波器的传递函数。也就是说，被低通滤波器衰减的频率能通过高通滤波器，
反之亦然。
在本节中，我们考虑理想、布特沃斯和高斯高通滤波器。如前面几节所示，我们在频率域和空
间域分别说明这些滤波器的特性。图4.52显示了这些滤波器的典型三维图、图像表示和剖面图。像前
面一样，我们看到，布特沃斯滤波器表现为理想滤波器的锐利性和高斯滤波器的宽阔平滑性间的一种
过渡。紧随该节后面的讨论，图4.53说明了这些滤波器在空间域的形状。空间滤波器是使用用于生成
图4.43和图4.46的步骤得到和显示的。
4.9.1 理想高通滤波器
一个二维理想高通滤波器(IHPF)定义为
Ha)={iDu.y>Do。 (4.9-2)
其中，D?是截止频率，D(u,v)由式(4.8-2)给出。这个表达式直接来自式(4.8-1)和式(4.9-1)。正如所
预料的那样，IHPF与LPF是相对的，在这种情况下，IHPF把以半径为D?的圆内的所有频率置零，
而毫无衰减地通过圆外的所有频率。如同ILPF那样，IHPF 也是物理上无法实现的。但与前面一样，
我们这里出于完整性而讨论它，因为IHPF可以用来解释空间域中的振铃等现象。讨论将很简要。
因为它们与式(4.9-1)的方法有关，我们可以预料 THPF和ⅡPF一样具有相同的振铃性质，这清楚地
展示在图4.54中，这些图像由使用D分别为30,60和160个像素的各种IHPF对图4.41(a)中的原始图像
滤波后的结果组成。图4.54(a)中的振铃现象相当严重，以至于产生了失真，物体的边界也被加粗了(看一
下那个大字母“a”)。顶部3个圆的显示也不是很好，因为它们不像图像中的其他边缘那样强(这3个目
标的灰度很接近于背景灰度，产生了较小的幅度不连续)。观察图4.53(a)中IHPF的空间表示的“点”
的大小，记住，空间域滤波是空间滤波器与图像的卷积，这一概念可以帮助解释为什么较小的物体和
线条几乎显示为纯白色。特别应注意图4.54(a)中最上一行的3个小方形和垂直细条带。当D?=60时，
情况有所改善。边缘失真仍很明显，但现在我们开始看到对于较小物体的过滤。由于现在已很熟悉频
率域和空间域的相反关系，我们知道这个滤波器的点的大小要比D?=30的滤波器更小。D?=160的结果
第4章 频率域滤波 177
更像一幅高通滤波后的图像。在这里，边缘更清晰，失真更小，而且较小的物体已被正确滤除。当然，
所有图像的恒定背景在高通滤波后的图像中都是0,因为高通滤波类似于空间域中的差分。
H(a.) H(u.D)
1.0
u
-D(x,r)
H(u.e) H(uo)
1.0
a
D(u.)
H(uD) H(u.e)
1.0
D(u.n)
图4.52 顶部行：典型理想高通滤波器的透视图、图像表示和剖面图；中间行：典型布特沃斯高通滤波器
的透视图、图像表示和剖面图和；底部行：典型高斯高通滤波器的透视图、图像表示和剖面图
a b c
图4.53(a)典型的频率域理想高通滤波器的空间表示及通过滤波器中心的对应灰度剖面图；
(b)典型的频率域布特沃斯高通滤波器的空间表示及通过滤波器中心的对应灰度剖面图；
(c)典型的高斯频率域高通滤波器的空间表示及通过滤波器中心的对应灰度剖面图 爱累
黑：貌
178 数字图像处理(第三版)
a b c
图4.54 使用D?=30,60和160的IHPF对图4.41(a)中的图像滤波后的结果
4.9.2 布特沃斯高通滤波器
截止频率为D?的n阶布特沃斯高通滤波器(BHPF)定义为
Hu)=+LD/Du (4.9-3)
其中D(u,v)由式(4.8-2)给出。该表达式直接来自式(4.8-5)和式(4.9-1)。图4.52的中间一行显示了该
BHPF 函数的图像和剖面图。
与低通滤波器一样，我们可以料想到布特沃斯高通滤波器比 IHPF 更平滑。图4.55显示了D?值
与图4.54中的设置相同的2阶BHPF的特性。边缘失真比图4.54小得多，甚至对于最小的截止频率
值也一样。因为IHPF和BHPF中心区域的点的大小类似[见图4.53(a)和图4.53(b)],这两个滤波器
过滤小目标的性能就可比了。截止频率越大，使用BHPF得到的结果就越平滑。
a b c
图4.55 使用[对应于图4.41(b)中的]D?=30,60和160的2阶BHPF对图4.41(a)
中的图像高通滤波后的结果。这些结果比用IHPF得到的结果平滑得多
4.9.3 高斯高通滤波器
截止频率处在距频率矩形中心距离为D?的高斯高通滤波器(GHPF)的传递函数由下式给出：
H(u,v)=1-e-D2(.)/20% (4.9-4)
其中，D(u,v)由式(4.8-2)给出。该表达式直接来自式(4.8-7)和式(4.9-1)。图4.52的第三行显示了GHPF
函数的透视图、图像和剖面。沿用BHPF相同的形式，图4.56中显示了使用GHPF的类似结果。正如
所料，得到的结果比前两个滤波器的结果更平滑。即使是对微小物体和细线条使用高斯滤波器滤波，
结果也是较清晰的。表4.5总结了本节讨论的高通滤波器。
a b c
图4.56 使用一个D?=30,60和160的GHPF对图4.41(a)中的图像进行高通滤波后
的结果，D?对应着图4.41(b)中的各个圆圈。请与图4.54和图4.55进行比较
第4章 频率域滤波 179
表4.5 高通滤波器。D?是截止频率，n是布特沃斯滤波器的阶数
理想 布特沃斯
H+DD,
高 斯
Hav-iDuys H(u,v)=1-ezn
例4.19 使用高通滤波法和阈值法增强图像。
图4.57(a)是一幅大小为1026×962的指纹图像，其污染(一种典型的问题)是很明显的。自动指纹识别的
关键一步是增强指纹的脊线并减小污染。增强在人对指纹的解释方面也是很有用的。在这个例子中，我们使
用高通滤波法来增强脊线并减小污染效应。脊线的增强使用脊线包含高频这样一个事实来完成，而高通滤波
器不会改变高频。另一方面，滤波器减少了低频分量，而低频分量对应图像中慢变化的灰度，例如背景和污
染。这样，增强就可以通过减少除高频外的所有特征来达到，在这种情况下，高频是感兴趣的特征。
图4.57(b)是使用截止频率为50的4阶布特沃斯高通滤波器滤波后
的结果。如期望的那样，高通滤波后的图像失去了它的灰度色调，因为
直流项已被减小为0。最终结果是高通滤波后的图像中典型的暗色调已
成为主流，这样，就需要附加的处理来增强感兴趣的细节。一种简单的
方法是对滤波后的图像进行阈值处理。图4.57(c)显示了将滤波后的图像
中的所有负值设置为黑、将所有正值设置为白后的结果。注意，脊线变清晰了且污染已明显地减小了。
事实上，图4.57(a)所示图像右上方部分中几乎已看不见的脊线在图4.57(c)中已被很好地增强了。
a bc
图4.57(a)指纹图像：(b)对图(a)高通滤波后的结果：(c)对图(b)进行
阀值操作后的结果(原图像由美国国家标准和技术研究所提供)
4.9.4 频率域的拉普拉斯算子
在3.6.2节，我们已用过拉普拉斯算子对空间域图像进行增强。在这一节，我们再重温一下拉普
拉斯算子，并说明它可得到与频率域技术的等效结果。可以证明(见习题4.26)拉普拉斯算子可使用如
下滤波器在频率域实现：
H(u,v)=-4π2(u2+v2)
值D,大约为填充后图像的短维的
2.5??D.接近于原点较为理想，因
为这样会衰减低频，但低频不会完
全消除。D?在短维的2??5??一
个不错的起点。
(4.9-5)
或者，关于频率矩形的中心，使用如下滤波器：
H(u,v)=-4π2[u-P/2]2+(v-Q/2)2]=-4n2D2(u,v) (4.9-6)
其中，D(u,v)是式(4.8-2)给出的距离函数。然后，拉普拉斯图像由下式得到：
v2f(x.y)=3'{H(u,v)F(u.v} (4.9-7)
其中，F(u,v)是f(x,y)的傅里叶变换。如3.6.2节描述的那样，增强可使用下式实现：
g(x,y)=f(x,y)+cV2f(x,y) (4.9-8) 受
309 io
180 数字图像处理(第三版)
这里，c=-1,因为H(u,v)是负的。在第3章中，f(x,y)和V2f(x,y)具有可比的数值。然而，用式(4.9-7)
计算V2f(x,y)会引入已标定系数的DFT,这些系数的幅度与f的最大值相比可能要大几个量级。这
样，f与其拉普拉斯间的差别一定会被带入可比的范围。处理该问题的最容易的方法是在计算f(x,y)
的DFT之前将f(x,y)的值归一化到区间[0,1]内，并用它的最大值除V2f(x,y),从而将它带到近似区
间[-1,1]内(回忆一下，拉普拉斯算子有负值)。然后，可以应用式(4.9-8)。
在频率域，式(4.9-8)可写为
8(x,y)=S1{F(u,v)-H(u,)F(u,}=s1{1-H(u,D)F(u,}=3?1{+4π2D2(u,)IF(u,v}(4.9-9)
虽然这一结果是精致的，但它也存在刚刚提到的标定问题，且伴有归一化系数不容易计算的事实。
由于这一原因，式(4.9-8)优先选择在频率域中实现，使用式(4.9-7)计算V2f(x,y),并用前节提到的方
法来标定。
例4.20 使用拉普拉斯算子在频率域锐化图像。
图4.58(a)是与图3.38(a)一样的图像，图4.58(b)显示了使用式(4.9-8)后的结果，其中拉普拉斯算子在
频率域用式(4.9-7)计算。标定使用与公式有关的描述来完成。比较图4.58(b)和图3.38(e),我们可以看到，
频率域和空间域的结果在视觉上是相同的。很明显，在这两幅图中，对应于图3.37(b)中的拉普拉斯模板
在中心有一个-8(习题4.26)。
a b
图4.58 (a)原始模糊图像；(b)在频率域中使用拉普拉斯算子增强后的图像。请与图3.38(e)比较
4.9.5 钝化模板、高提升滤波和高频强调滤波
在这一节，我们讨论3.6.3节中介绍过的钝化模板、高提升滤波图像锐化技术。使用频率域方法，
式(3.6-8)中定义的模板由下式给出：
8mak(x,y)=f(x,y)-fp(x,y) (4.9-10)
与
fup(x,y)=3?'[H(u,v)F(u,v] (4.9-11)
其中，Hu(u,v)是一个低通滤波器，F(u,v)是f(x,y)的傅里叶变换。这里，无(x,y)是平滑后的图像，
该图像类似于式(3.6-8)中的f(x,y)。然后，如式(3.6-9)那样，有
8(x,y)=f(x,y)+k*8mk(x,y) (4.9-12)
该表达式定义了k=1时的钝化模板和k>1时的高提升滤波器。利用前面的结果，我们完全可以使用
涉及低通滤波器的频率域计算来表达式(4.9-12):
第4章 频率域滤波 181
8(x,y)=3?1{[1+k*[1-Hu(u,D)]F(u,v} (4.9-13)
用式(4.9-1),我们可以根据高通滤波器来表达该结果：
g(x,y)=31{[1+k*H(u,]F(u,v)} (4.9-14)
方括号中的表达式称为高频强调滤波器。如前面注释的那样，高通滤波器将直流项设置为0,这样，
就把滤波后的图像的平均灰度减小为0。高频强调滤波器不存在这一问题，因为高通滤波器上加了1。
常数k给出了影响最终结果的高频的比例。高频强调滤波的更一般的公式为
g(x,y)=3-1{k?+k?*HHp(u,v)]F(u,v} (4.9-15)
其中，k?≥0给出了控制距原点的偏移量[见图4.31(e)].k?≥0控制高频的贡献。
例4.21 使用高频强调滤波增强图像。
图4.59(a)显示了一幅大小为416×596的灰度级很窄的胸部X射线图像。该例子的目的是使用高频强
调滤波增强该图像。由于X射线不能使用光学镜头聚焦，因此得到的图像通常都会稍微有些模糊。因为
这幅特殊图像的灰度偏向灰度级的暗端，所以我们还利用这个机会给出一个如何使用空间域处理来补充
频率域滤波的例子。
图4.59(b)显示了使用D?=40(大约为填充后图像大小的5???一个
高斯滤波器对图像进行高通滤波后的结果。如预料的那样，滤波的结果
没有什么特征，但是，它朦胧地显示了图像中的主边缘。图4.95(c)显示
了高频强调滤波的优点，其中我们使用了式(4.9-15),且令k?=0.5,k?=
0.75。虽然图像依旧较暗，但其灰度级色调归因于低频分量没有丢失。
如3.3.1节讨论的那样，在一个窄范围灰度级中，由灰度级表征
的图像是直方图均衡处理的理想的候选者。如图4.59(d)所示，这的确是进一步增强图像的合适方法。
注意骨骼结构的清晰度和其他三幅图像中均不可见的细节。最终增强后的图像有点噪声，但当图像的
灰度级被扩展后，这是X光图像的典型现象。用高频强调和直方图均衡相结合得到的结果优于用任何
单独方法得到的结果。
图4.59(a)一幅胸部X射线图像；(b)使用高斯高通滤波器滤波后的结果。(c)使用
相同滤波器进行高频强调滤波后的结果；(d)对图(c)执行直方图均衡操作后
的结果(原图像由密歇根大学医学院解剖科学部的Thomas R.Gest 博士提供)
在医学图像处理中，像振铃这样
的人为缺陷是不能接受的。因此，
最好避免使用可能会在处理后的图
像中引入人为缺陷的滤波器。因为
空间和频率域高斯滤波器是傅里叶
变换对，因此这些滤波器会产生不
会引人人为缺陷的平滑结果。
言;三
用;言
182 数字图像处理(第三版)
4.9.6 同态滤波
2.3.4节中介绍的照射-反射模型可用于开发一种频率域处理过程，该过程通过同时压缩灰度范围
和增强对比度来改善一幅图像的表观。由2.3.4节的讨论可知，一幅图像f(x,y)可以表示为其照射分
量i(x,y)和反射分量rx,y)的乘积，即
f(x,y)=i(x,y)r(x,y) (4.9-16)
上式不能直接用于对照射和反射的频率分量进行操作，因为乘积的傅里叶变换不是变换的乘积：
s[f(x,y)]≠3[i(x,y]S[r(x,y] (4.9-17)
然而，假定我们定义
z(x,y)=Inf(x,y)=In i(x,y)+In r(x,y) (4.9-18)
则有
3{z(x,y}}=3{In f(x,y}}=3{ln i(x,y}+3{ln r(x,y}
如果灰度范围为10.Z-1]的图像f(xy
须加1.以避免处理 In(0)的情形。在
出现任何0值.则图像中的每个元素必
滤波处理结束时，再将1减去。
(4.9-19)
或
Z(u,v)=F?(u,v)+F,(u,V) (4.9-20)
其中，F(u,v)和F(u,v)分别是Ini(x,y)和In r(x,y)的傅里叶变换。
我们可以用一个滤波器H(u,v)对Zu,v)滤波，故有
S(u,v)=H(u.v)Z(u,v)=H(u,v)F?(u,V)+H(u,v)F,(u,v) (4.9-21)
在空间域中，滤波后的图像是
s(x,y)=3'{S(u,)}=3?1[H(u,v)F(u,v)]+3?1(H(u,v)F,(u,v)} (4.9-22)
由定义
i(x,y)=3?'(H(u,v)F(u,v)} (4.9-23)
和
r'(x,y)=3'{H(u,V)F,(u,v)} (4.9-24)
我们可以下列形式来表达式(4.9-23):
s(x,y)=i(x,y)+r'(x,y) (4.9-25)
最后，因为z(x,y)是通过取输入图像的自然对数形成的，我们可通过取滤波后的结果的指数这一
反处理来形成输出图像：
8(x,y)=e=ee=i?(x,y)?(x,y) (4.9-26)
其中，
i(x,y)=e(x,y (4.9-27)
和
石(x,y)=ex.y (4.9-28)
是输出(处理后)图像的照射和反射分量。
刚刚推导的滤波方法总结在图4.60中。该方法是以称之为同态系统的一类系统的特殊情况为基础
的。在这种特殊应用中，方法的关键在于照射分量和反射分量的分离，其实现形式如式(4.9-20)所示。然
后，如式(4.9-21)指出的那样，同态滤波函数Hu,v)可分别对这些分量进行操作。
第4章 频率域滤波 183
f(x,y) In DFT H(u,e) (DFT)-1 exp g(x,y)
图4.60 同态滤波步骤小结
图像的照射分量通常由慢的空间变化来表征，而反射分量往往引起突变，特别是在不同物体的
连接部分。这些特性导致图像取对数后的傅里叶变换的低频成分与照射相联系，而高频成分与反射相
联系。虽然这些联系只是粗略的近似，但它们用在图像滤波中是有益的，这正如例4.22所说明的那样。
使用同态滤波器可更好地控制照射分量和反射分量。这种控制需要指定一个滤波器函数H(u,v),
它可用不同的可控方法影响傅里叶变换的低频和高频分量。图4.61显示了这种滤波器的剖面图。如果
r和y,选定，而x<1且y>1,那么图4.61所示滤波器函数趋向于衰减低频(照射)的贡献，而增强高
频(反射)的贡献。最终结果是同时进行动态范围的压缩和对比度的增强。
图4.61所示的函数形状可用高通滤波器的基本形式来近似。例如，采用形式稍微变化一下的高斯
高通滤波器可得到函数
H(u,)=(rm-r2)[1-eve ]+r (4.9-29)
其中，D(u,v)由式(4.8-2)定义，常数c控制函数坡度的锐利度，它在γ?和γn之间过渡。这个滤波器
类似于前节讨论的高频强调滤波器。
H(u,n)
Yn
Y
D(u,D)
图4.61 圆形对称同态滤波器函数的径向剖面图。垂直轴位于频率矩形的中心，D(u,v)是距中心的距离
例4.22 使用同态滤波增强图像。
图4.62(a)显示了一幅大小为1162×746像素的全身PET(Positron Emission Tomography)扫描图像。图
像稍微有点模糊，并且由于支配显示动态范围的高灰度“热点”使得其许多低灰度特征很朦胧(这些"热
点”是由脑部的肿瘤和肺部的肿瘤导致的)。图4.62(b)是对图4.62(a)使用同态滤波得到的，使用式(4.9-29)
中的滤波器，rL=0.25,Y=2,c=1,D?=80。该滤波器的剖面看上去正好像图4.61,只是斜坡稍微有
点陡峭。 回忆可知滤波操作使用到了图像填 注意，如图4.62(b)所示，在处理后的图像，“热点”、脑部和骨架更 充，因此该滤波器的大小为P×Q
为清晰，且图像中可以见到更多的细节。对于显示的动态范围来说，
通过降低支配照射分量(热点)的影响，允许低灰度变得更可见是可能的。类似地，因为高频被同态滤
波增强了，故图像的反射分量(边缘信息)被明显地锐化了。图4.62(b)中增强后的图像较之原图像已有
很大改进。 业
184 数字图像处理(第三版)
a b
…………3
图4.62(a)全身PET扫描图像；(b)用同态滤波增强的图像(原图
像由CTI PET Systems公司的Michacl E.Casey博士提供)
4.10 选择性滤波
前两节讨论的滤波器在整个频率矩形上操作。在很多应用中，其兴趣是处理指定的频段或频率矩形
的小区域。第一类滤波器分别称为带阻滤波器或带通滤波器。第二类滤波器称为陷波滤波器。
4.10.1 带阻滤波器和带通滤波器
这种类型的滤波器很容易使用前两节的概念来构建。表4.6给出了理想、布特沃斯和高斯带阻滤
波器的表达式，其中D(u,v)是距频率矩形中点的距离，如式(4.8-2)给出的那样，D?是带宽的径向中
心，W是带宽。图4.63(a)以图像形式显示了一个高斯带阻滤波器，其中黑色是0,白色是1。
表4.6 带阻滤波器。W是带宽，D是D(u,v)距滤波器中心的距离，D?是截止频率，
n是布特沃斯滤波器的阶数。为简化表中符号的表示，我们用D来代替D(u,v
引
理想 布特沃斯 高斯
a-coc+ Hu=1-
一个带通滤波器可以用从低通滤波器得到高通滤波器的相同的方法从带阻滤波器得到：
HBp(u,v)=1-HBR(u,V) (4.10-1)
图4.63(b)以图像形式显示了一个高斯带通滤波器。
图4.63(a)带阻高斯滤波器；(b)相应的带通滤波器。为清晰起见，图(a)中添加了细黑边。它不是数据的一部分
第4章 频率域滤波 185
4.10.2 陷波滤波器
陷波滤波器是更有用的选择性滤波器。陷波滤波器拒绝(或通过)事先定义的关于频率矩形中心的
一个邻域的频率。零相移滤波器必须是关于原点对称的，因此，一个中心位于(u,vo)的陷波在位置(-u,-vo)
必须有一个对应的陷波。陷波带阻滤波器可以用中心已被平移到陷波滤波器中心的高通滤波器的乘积
来构造。一般形式为
mcu.)-IIH,aDHa, (4.10-2)
其中，H?(u,v)和H(u,v)是高通滤波器，它们的中心分别位于(u,v)和(-u,-v)处。这些中心是根
据频率矩形的中心(M/2,N/2)来确定的。对于每个滤波器，距离的计算由下式执行：
D?(u,)=[(u-M/2-uA)2+(v-N/2-vA)P2] (4.10-3)
和
D(u,)=[u-M/2+u]2+(v-N/2+v)2]" (4.10-4)
例如，下面是一个n阶布特沃斯陷波带阻滤波器，它包含三个陷波对：
aan-n+D/L+DDyP (4.10-5)
其中，D和D,由式(4.10-3)和式(4.10-4)给出。常数D?对每一个陷波对都是相同的，但对于不同的
陷波对它可以不同。其他陷波带阻滤波器可用相同的方法构建，具体取决于所选的高通滤波器。正如
早期讨论的滤波器那样，陷波带通滤波器可使用下式由陷波带阻滤波器得到：
HNp(u,V)=1-HNR(u,v) (4.10-6)
正如接下来的三个例子所示，陷波滤波的主要应用之一是选择性地修改 DFT 的局部区域。这种
类型的典型的处理是交互式完成的，它直接对DFT处理，而不需要填充。交互式地处理实际的DFT(相
对于必须从填充“平移”到实际频率值来说)的优点是没有因在滤波处理中未使用填充而导致任何缠
绕错误。此外，如我们将在5.4.4节中说明的那样，陷波滤波技术比这里讨论的以无填充的DFT为基
础的技术更有用。为得到如何随填充函数变化的DFT的概念，请见习题4.22。
例4.23 使用陷波滤波减少莫尔(波纹)模式。
图4.64(a)是来自图4.21的扫描报纸的图像，它显示了突出的莫尔模式，图4.64(b)是它的谱。我们从
表4.3知道，作为周期函数的一个纯正弦的傅里叶变换是一对共轭对称的冲激。在图4.64(b)中，对称的"类
冲激”是莫尔模式的近似周期性的结果。我们可以利用陷波滤波来减小这些脉冲。
图4.64(c)显示了使用一个布特沃斯陷波带阻滤波器乘以图4.64(a)的DFT的结果，对所有陷波对，该
滤波器的参数为D?=3和n=4。半径值选择为(用频谱的视觉检测)包围脉冲的全部能量，将n值选择为给
出陷波的适度过渡形状。陷波的中心位置由其频谱交互地确定。图4.64(d)显示了使用该滤波器并遵照4.7.3节
给出的过程所得到的结果。考虑到低分辨率和原图像的退化，改进是明显的。 言
眼;园
186 数字图像处理(第三版)
a bcd
图4.64 (a)显示了莫尔模式的取样过的报纸图像；(b)该图像的谱；(e)布特
沃斯陷波带阻滤波器乘以傅里叶变换后的结果：(d)滤波后的图像
例4.24 使用陷波滤波增强恶化的卡西尼土星图像。
图4.65(a)显示了部分环绕土星的土星环的图像。太空船第一次进入该行星的轨道时由“卡西尼”首
次拍摄了这幅图像。垂直的正弦模式是在对图像数字化之前由叠加到摄影机视频信号上的AC 信号造成
的。这是一个想不到的问题，它污染了来自某些任务的图像。幸运的是，这些类型的干扰很容易使用后
处理方法来校正。一种方法就是使用陷波滤波。
图4.65(b)显示了DFT谱。仔细分析垂直轴会发现一系列小能量脉冲，这些脉冲对应于近似正弦曲线
的干扰。一种简单的方法是使用窄陷波矩形滤波器，它从最低频脉冲开始，并扩展到垂直轴的剩余部
分。图4.65(c)显示了这样一个滤波器(白色代表1,黑色代表0)。图4.65(d)显示了使用该滤波器对污染
图像滤波后的结果。该结果与原图像相比有较大的改进。
我们用陷波带通滤波器[见图4.66(a)]隔离了垂直轴上的频率。然后，如图4.66(b)所示，使用这些
频率的IDFT得到了空间干扰模式本身。
a be d
图4.65 (a)显示了近似周期性干扰的土星环图像，图像大小为674×674像素；(b)谱：垂直轴上靠近原点
的对应干扰模式的能量脉冲；(c)一个垂直陷波带阻滤波器；(d)滤波后的结果。图(c)中的细黑边
是为清楚起见而添加的，它不是数据的一部分(原图像由NASA/JPL的Robert A.West 博士提供)
a b
图4.66(a)对图4.65(a)应用陷波带通滤波器后的结果(谱):(b)通过计算(a)的IDFT而得到的空间模式
第4章 频率域滤波 187
4.11 实现
迄今为止，我们的注意力集中在频率域滤波的理论概念和实例上。现在，需要清楚的一件事情
是图像处理领域的计算要求并不是微不足道的。因此，推导一些基本方法很重要，这些基本方法可简
化傅里叶变换的计算，并加快计算速度。这一节将处理这些问题。
4.11.1 二维DFT的可分性
如表4.2提到的那样，二维DFT可分成一维变换。我们可以把式(4.5-15)写为
Fa.)=2rasywe-2Fasve (4.11-1)
其中，
ran)-2naxswe (4.11-2)
对于x的每一个值和v=0,1,2,…,N-1,我们看到，F(x,v)就是f(x,y)的行的一维DFT。在式(4.11-2)中，
X从0到M-1变化.我们对f(x,y)的所有行计算一组一维DFT。类似地，在式(4.11-1)中的计算是F(x,v)
的列的一维变换。
这样，我们就得出结论：f(x,y)的二维DFT可通过计算f(x,y)的每一行的一维变换，然后，沿着
计算结果的每一列计算一维变换来得到。这是一个重要的简化，因为我们必须一次仅处理一个变量。
类似的扩展可用一维IDFT来计算二维IDFT。然而，如下一节所示， 我们可以一维列变换和一维行变换的
我们可以用计算 DFT所设计的算法来计算IDFT。 形式来表示式(4.11-1)和式(4.11-2)。最
终结果是相同的。
4.11.2 用DFT算法计算 IDFT
取式(4.5-16)两边的复共轭，并乘以MN得到
Mr'(xy=22F(vye (4.11-3)
但是，我们看出该结果右边的形式如F(u,v)的DFT。因此，式(4.11-3)
指出，如果我们把F'(u,v)代入计算二维傅里叶正变换所设计的算法
中，结果将是MN f(x,y)。取复共轭并将该结果乘以1/MN,将得到
f(x,y),它是F(u,v)的反变换。
由(前节介绍的)基于逐次通过一维变换(如前节那样)的二维正 DFT 算法来计算二维反变换的方
法，是引起混乱的一种常见原因，因为这涉及复共轭和乘以一个常数的计算，而在一维算法中这两种
计算都不会涉及。应记住的一个关键概念是我们只需简单地将F(u,v)输入到我们已有的正向算法中。
结果将是MN(x,y)。要得到f(x,y)这一结果，我们需要做的只是取它的复共轭并乘以一个常数1/MN。
当然，当f(x,y)是实数时，典型的情况是f(x,y)=f(x,y)。
4.11.3 快速傅里叶变换(FFT)
如果我们必须直接实现式(4.5-15)和式(4.51-16),那么在频率域工作并不实际。这些公式的大规
模执行要求约(MM2次的求和及加法。对于中等大小的图像(譬如 1024×1024像素),这意味着仅进行
在这种推导中乘以MN的假设是针
对式(4.5-15)和式(4.5-16)的形式的。
如果常数在正反变换间的分布不同，
则需要不同的常数乘数方案。
心
因;因
188 数字图像处理(第三版)
一次DFT 就需要万亿次量级的乘法和加法，还不包括指数运算，指数运算可被计算一次并存储在查找
表中。即使是对超级计算机来说，这也是一种挑战。在没有发现快速傅里叶变换(FFT)前，可以说这一
章提供的材料很少有实践价值，快速傅里叶变换可将乘法和加法的次数降低到MN log.MN。由FFT提
供的计算量的减少的确令人印象深刻。例如，计算大小为1024×1024的图像的二维FFT,只需要约
2000万次乘法和加法运算，与前面提到万亿次乘法与加法运算相比是很有意义的减少。
虽然 FFT是信号处理文献中广泛涵盖的话题，但该主题在本章中也非常重要，如果我们不提供
至少介绍一下 FFT是如何工作的说明，那么本章也将不完整。我们选择完成这一目的的算法称为逐
次加倍方法，它是导致整个产业诞生的原始算法。这种特殊算法假定取样数是2的整数次幂，但这不
是其他方法的通用要求(Brigham[1988])。我们由4.11.1节可知，二维DFT可以使用逐次通过一维变
换的方法来执行，因此我们仅需关注一个变量的FFT。
在推导FFT时，习惯上将式(4.4-6)表达为如下形式：
Fm=2raw (4.11-4)
式中，u=0.1,…,M-1.其中，
W=e-j2x/M (4.11-5)
且假设M具有如下形式：
M=2" (4.11-6)
其中N是一个正整数。因此，M可表示为
M=2K (4.11-7)
K也是一个正整数。将式(4.11-7)代入式(4.11-4)得到
Ru)=2ra-Lra+2r(ax+0m (4.11-8)
然而，使用式(4.11-5)可以证明W2x=w",因此式(4.11-8)可以表示为
Fu)=Lraxm+2rax+DwW% (4.11-9)
定义
F-ca)=2rasw (4.11-10)
式中，u=0.1,2,…,K-1,和
F()=2r(zx+Dw (4.11-11)
式中，u=0,1,2,…,K-1,将式(4.11-9)简化为
F(u)=Fn(u)+Foua(u)W?k (4.11-12)
此外，因为w+"=W和W2=-W?,式(4.11-10)到式(4.11-12)给出
F(u+K)=F(u)-F(u)Wk (4.11-13)
第4章 频率域滤波 189
分析式(4.11-10)到式(4.11-13)可以发现这些表达式的一些有趣特性。如式(4.11-12)和式(4.11-13)指
出的那样，一个M点变换可以通过把原始表达式分解为两部分来计算。计算F(u)的前一半要求计算
式(4.11-10)和式(4.11-11)中给出的两个(M/2)点变换。然后，将结果即Feven(u)和F(u)的值代入
式(4.11-12)得到F(u),u=0.1.2,…,(M/2-1)。然后，可由式(4.11-13)直接计算F(w)的另一半，而不
需要额外的变换计算。
为检验该步骤的计算量，令m(n)和a(n)分别代表实现算法所要求的复数乘法次数和加法次数。
如前所述，样本数为2",n为正整数。先假设n=1。两点变换要求计算F(O);然后F(1)由式(4.11-13)
得到。为得到F(O),要求计算F(0)和F(0)。此例中K=1且式(4.11-10)和式(4.11-11)是单点变换。
然而，由于单个样本点的DFT是该样本自身，故得到F(0)和F(0)不需要任何乘法和加法运算。
F(0)与W的一次相乘和一次加法，即可由式(4.11-12)得到F(O)。然后，由式(4.11-13)得到F(1),
又用了一次加法(减法可以认为与加法相同)。因为已计算过F(O)w,故两点变换所需要的总运算
次数为m(1)=1次乘法和a(1)=2次加法。
n的下一个允许值为2。根据前面的推导，一个4点变换可分成两部分。F(u)的前半部分要求计
算两个两点变换，如K=2时式(4.11-10)和式(4.11-11)给出的那样。正如前一段中解释的那样，一个
两点变换要求 m(1)次乘法和a(1)次加法，因此这两个等式的计算总共要求2m(1)次乘法和2a(1)次加
法。为了从式(4.11-12)得到F(O)和F(1),还需要两次乘法和加法。因为F(u)W2在u={0,1)时已
被计算过，所以要得到F(2)和F(3)又要进行两次加法计算。这时，总运算次数是m(2)=2m(1)+2次
乘法和a(2)=2a(1)+4次加法。
当n=3时，计算F(u)和F(u)时会用到两个4点变换。它们需要2m(2)次乘法和2a(2)次加法。
完成全部变换还要4次乘法和8次加法运算。总运算次数为m(3)=2m(2)+4次乘法和a(3)=2a(2)+8
次加法。
对任意正整数n计算这些参量，推导出完成FFT所需的乘法和加法次数的递归表达式为
m(n)=2m(n-1)+2"1 n≥1 (4.11-14)
和
a(n)=2a(n-1)+2" n≥1 (4.11-15)
其中，m(0)=0且a(0)=0,因为单点变换无须任何加法和乘法运算。
式(4.11-10)至式(4.11-13)的实现构成了逐次加倍的FFT 算法。这一名字来自如下计算方法：对
于任意的2的整数次幂的M,一个两点变换来自两个单点变换，一个4点变换来自两个两点变换，
依此类推，直到M为2的整数次幂的情形。作为练习(见习题4.41),请读者证明
m(n)= M log?M (4.11-16)
和
a(n)=M log?M (4.11-17)
与直接计算一维DFT相比.FFT的计算优势定义为
m)=M-2M (4.11-18)
因为假定有M=2",所以可以将式(4.11-18)写为关于n的形式： 因;望
3-3
190 数字图像处理(第三版)
cm)=2 (4.11-19) 2400
图4.67显示了该函数的曲线。作为n的函数，迅速增
加的计算优势是明显的。例如，当n=15(32,768点)
时，FFT与DFT相比有接近2200:1的优势。这样，
我们可以预料在同一台机器上，FFT的计算速度会
比DFT的计算速度快近2200倍。
1800
C(n)1200
600
涵盖FFT细节的优秀文献很多，因此此处不再深
入地讨论这一主题(例如，可参阅Brigham[1988])。
实际上，所有综合性的信号和图像处理软件包都已包
含FFT 的实现，也能够处理点数不为2的整数次幂
的情况(以牺牲计算效率为代价)。免费的 FFT程序
也可以从 Intermet 上得到。
ol
12345678 910 11 12 13 14 15 n
图4.67 FFT相对于直接实现一维DFT的计算
优势。注意，该优势以n的函数快速增长
4.11.4 关于滤波器设计的一些注释
本章中讨论的滤波方法严格基于基础知识，重点是尽可能清楚地解释频率域滤波的效果。除了
这样做之外，我们知道没有更好的方法来处理滤波问题。我们可将这种处理方式看成是“原型化”一
个滤波器的基础。换句话说，若给出一个我们需要找到一种滤波器来解决的问题，那么频率域方法是
一种试验、快速及完全控制滤波器所有参数的理想工具。
一旦找到适用于某个应用的滤波器后，通常会使用固件和/或硬件直接在空间域实现该滤波器。
该主题超出了本书的范围。Petrou and Bosdogianni[1999]给出了二维频率域滤波器和相应的数字滤波
器之间的良好联系。关于二维数字滤波器的设计，请读者参阅Lu和Antoniou[1992]的著述。
小结
本章中的内容是从取样到傅里叶变换，再到频率域滤波循序渐进的。某些概念，如取样定理，
如果没有频率域内容的解释，几乎没有意义。对混淆效应而言，同样如此。因此，前面几节中介绍的
内容对于理解数字图像处理的基本原理是一个坚实的基础。我们特别注意用基本原理来开始内容的阐
述，因此，许多具有现代数学背景的读者不仅可以尽可能地吸收这些材料，而且还可以应用它们。
本章的第二个目的是阐述离散傅里叶变换及其在频率域滤波中的应用。为了达到这一点，我们
介绍了卷积定理。这一结果是线性系统的基础，也是第5章中将要介绍的复原技术的基础。我们讨论
过的滤波器类型是在实践中发现的有代表性的滤波器。然而，现有的这些滤波器的关键是说明用公式
形式来表达并在频率域实现是多么简单。尽管一种典型的解决方案的最终实现还是以空间滤波器为基
础的，但工作于频率域所获得的知识对于选择空间滤波器来说是大有帮助的。
虽然本章中的多数滤波例子是在图像增强领域，但这些过程本身是通用的，并且广泛用于后续章节。
参考文献
4.1节所讲内容的附加读物见Hubbard[1998]的著述。Bracewell[2000,1995所著的书籍很好地介绍了
连续傅里叶变换及其二维图像处理的扩展。除Lim[1990].Castleman[1996],Petrou和Bosdogianni[1999].
Brigham[1988]和 Smith[2003]的论著外，这两本图书为4.2节到4.6节讨论的大部分内容提供了背景知识。
第4章 频率域滤波 191
关于莫尔模式这一主题的早期工作的综述请参阅 Oster和Nishijima[1963]的著述。Creath 和Wyant[1992]讨
论了30年后该领域的技术状况。4.5节讨论的取样、混淆和图像重建问题也是计算机图形学中感兴趣的主
题，正如 Shirley[2002]举例说明的那样。
4.7节到4.11节内容的附加背景材料，可参阅Castleman[1996],Prat[2001]和 Hall[1979]的论著。为了
解关于卡西尼太空飞船(见4.10.2节)中成像传感器的更多内容可见Porco, West等人[2004]的著述。滤波器
实现的有效处理问题(如振铃)一直是令人感兴趣的主题，如 Bakir 和Reeves[2000]所述的例证。对于钝化
模板和高频强调滤波可见Schowengerdf[1983]的论著。同态滤波(见4.9.5节)的内容基于Stockham[1972]的
论文；也可以参见Oppenheim和Schafer[1975]及Pitas和Venetsanopoulos[1990]的论著。Brinkman等人[1998]
将钝化模板和同态滤波相结合用于增强核磁共振图像。
正如4.1.1节注释的那样，作为信号处理基础工具的DFT的普及，快速傅里叶变换的发现(4.11.3节)
是一个主要的里程碑。4.11.3节中介绍的FFT是基于Cooley 和 Tuckey[1965]的论文及Brigham[1988]的书
籍，他们也讨论了FFT的实现，包括不是基2的情况。快速傅里叶变换的公式表达通常认为是Cooley和
Tukey[1965]创造的。但FFT的有趣历史在此值得一提。在对Cooley和Tukey论文的响应中，Rudnick[1966]
报道了使用一种类似的技术，该技术的运算量同样与Mog?N成正比，并且基于由Danielson和Lanczos[1942]
所发表的一种算法。这些作者依次参考了Runge[1903.1905]的论著作为他们的技术来源。稍后的两篇论文及
Runge和Konig[1924]的讲稿包含了现代快速傅里叶变换算法的基本计算优势。Yates[1937],Stumpff[1939],
Good[1958]和Thomas[1963]也发表过类似的技术。在1965年，Cooley-Tukey 论文发表前，Cooley, Lewis
和Welch[1967a]发表的论文对快速傅里叶变换进行了历史性的概括，并对各种结果进行了有趣的对比。
4.11.3节介绍的FFT算法来自Cooley和Tukey[1965]的原始论文。作为补充读物可见Brigham[1988]和
Smith[2003]的论著。对于本章中讨论的基于频率域的数字滤波器的设计(见4.11.4节)可见Lu和Antoniou
[1992]及 Petrou和 Bosdogianni[1999]的著述。对于4.7节到4.11节讨论的许多软件实现方法可见Gonzalez
Woods和Eddins[2004]的著作。
习题
4.1 重复例4.1,但使用函数f(1)=2A(-W/4≤t≤W/4)和f(0)=0,对于其他所有的t值。对您的结果
和例子中的结果之间的任何不同，解释原因。
★4.2 证明式(4.4-2)中的F(μ)在两个方向上是无限周期的，周期为1/AT。
★4.3 可以证明(Bracewel[2000])1-δ(μ)和δ(1)?1。使用前一个性质和表4.3中的平移性质，证明连
续函数f(1)=cos(2πnt)的傅里叶变换是F(μ)=(1/2)[8(μ+n)+8(μ-n)],其中n是一个实数。
4.4 考虑连续函数f(1)=cos(2πnt)。
★(a)f(1)的周期是什么?
★(b)f(1)的频率是什么?
f(1的傅里叶变换F(μ)是实的(见习题4.3),因为取样数据的傅里叶变换由F(μ)的周期的拷贝组
成，取样数据的傅里叶变换F(μ)也将是实的。画一个类似于图4.6的图表，并根据所绘图表(假定
取样开始于t=0)回答下面的问题。
★(c)如果f(0)以高于奈奎斯特率的取样率来取样，取样函数将是什么?问其取样后的函数及其傅里
叶变换在图中看上去是什么样子?
(d)如果f(0)以低于奈奎斯特率的取样率取样，问取样后的函数通常看上去像什么?
(e)如果f(0以奈奎斯特率取样，并且在t=0.△T,2AT,…处取样，问取样后的函数看上去像什么?
标星号习题的详细解答可
在本书的网站上找到。该网站上还包
含有基于本章内容而建议的项目
8-3
～3
192 数字图像处理(第三版)
★4.5 如式(4.2-21)和式(4.2-22)给出的那样，证明连续函数的一维卷积定理的正确性。
4.6 完成由式(4.3-11)和式(4.3-12)给出的步骤。
4.7 如下图所示，一个“帐篷形”函数(左侧)的傅里叶变换是一个平方正弦函数(右侧)。提出一个参
量来表明一个“帐篷形”函数的傅里叶变换可以由一个盒状函数的傅里叶变换得到。(提示："帐
篷形”函数本身可以由两个相等的盒状函数进行卷积生成。)
4.8(a)证明式(4.4-4)和式(4.4-5)组成傅里叶变换对。
★(b)对式(4.4-6)和式(4.4-7)重复(a)。在该习题的两部分中，需要用到如下的指数正交性质：
20m-0其他
4.9 证明式(4.4-8)和式(4.4-9)的正确性。
★4.10 证明一个变量的离散卷积定理的正确性[见式(4.2-21)、式(4.2-22)和式(4.2-10)]。证明时需要用
到平移性质f(x)el2/M?F(u-o)和反平移性质f(x-x?)?F(u)e-2/M。
★4.11 写出二维连续卷积的表达式。
4.12 考虑一幅棋盘图像，其中每一个方格的大小为0.5mm×0.5mm。假定图像在两个坐标方向上无限
扩展，为避免混淆，问最小取样率是多少(样本数/mm)?
4.13 由4.5.4节中的讨论可知，收缩一幅图像会导致混淆现象。放大一幅图像也会导致混淆现象吗?请
解释。
★4.14 证明一维连续和离散傅里叶变换都是线性操作(见2.6.2节关于线性的定义)。
4.15 假定读者有一个用于计算二维DFT对的“已封装”程序，然而，不知道1/MN项是包含在两个公
式中的一个公式中，还是分成两个常数1/√MN 放在正变换和反变换前面。如果程序文档中没有
这种信息，请问如何才能找到包含该项(或这些项)的位置。
4.16 证明连续和离散二维傅里叶变换都是平移和旋转不变的。
4.17 由习题4.3可以推出1?δ(μ,v)和δ(t,z)1。使用前一个性质和表4.3中的平移性质证明连续函
数f(t,z)=Acos(2πμt+2πv?z)的傅里叶变换是
F(u.D)- (8u+Aov+vo)+8(u-H,D-]
4.18 证明离散函数f(x,y)=1的DFT是
Su)=8u.)={6 若u=v=0
其他
4.19 证明离散函数f(x,y)=cos(2πu?x+2πvoy)的DFT是
Fu,v)=[8(u+Mu,v+Mw)+8(u-Mu,v-Ma]
4.20 下列问题与表4.1中的性质有关。
★(a)证明性质1的正确性。
★(b)证明性质3的正确性。
(c)证明性质6的正确性。
第4章 频率域滤波 193
★(d)证明性质7的正确性。
(e)证明性质9的正确性。
(f证明性质10的正确性。
★(g)证明性质11的正确性。
(h)证明性质12的正确性。
(i)证明性质13的正确性。
★4.21 4.6.6节中在讨论频率域滤波时需要对图像进行填充。在该节中给出的图像填充方法是，在图像中
行和列的末尾填充0值(见上面的左图)。如果我们把图像放在中心，四周填充0值(见上面的右图)
而不改变所用0值的总数，会有区别吗?试解释原因。
★4.22 同一幅图像的两个傅里叶频谱如右图所示。左边的频谱对应于
原图像，右边的频谱图像使用0值填充后得到的。解释右图所
示的谱沿垂直轴和水平轴方向的信号强度显著增加的原因。
4.23 由表4.2可知DFT的直流项F(O,0)与其对应的空间图像的平均
值成正比。假定图像尺寸是M×N。假如对图像进行零填充后，
图像的尺寸为P×Q,其中P和Q分别由式(4.6-31)和式(4.6-32)
给出。令F,(0,0)代表填充后的函数的DFT的直流项。
★(a)原图像平均值和填充后图像平均值的比值是多少?
(b)F,(0,0)=F(0,0)吗?假设从数学角度回答。
4.24 证明表4.2中的周期性质(性质8)。
4.25 下列问题与表4.3中的性质有关。
★(a)证明一维情况下离散卷积定理(性质8)的正确性。
(b)对于二维情况，重复(a)。
(c)证明性质9的正确性。
(d)证明性质13的正确性。
(注意：习题4.18、习题4.19和习题4.31也与表4.3有关。)
4.26 (a)证明连续变量r和z的连续函数f(,z)的拉普拉斯变换满足下列傅里叶变换对[拉普拉斯变换
的定义见式(3.6-3)]:
V2f(t,z)?-4π2(μ2+v2)F(μ,v)
[提示：研究表4.3中的性质12并参阅习题4.25(d)。]
★(b)前面闭合形式的表达式仅适用于连续变量。然而，使用M×N滤波器
H(u,v)=-4π2(u2+v2)
它可能是在离散频率域实现拉普拉斯的基础，u=0,1,2,…,M-1,v=0,1,2,…,N-1。解释
您怎样实现这个滤波器。
(c)正如您在例4.20中看到的那样，频率域的拉普拉斯结果类似于使用中心系数为-8的空间模
板的结果。请说明频率域拉普拉斯结果与使用中心系数为-4的空间模板的结果不同的原因。
见3.6.2节关于空间域的拉普拉斯。
★4.27 考虑大小为5×5的空间模板，它平均与点(x,y)最靠近的12个邻点，但平均中排除该点本身。
(a)在频率域找出与其等价的滤波器H(u,v)。
(b)证明您的结果是一个低通滤波器。 送:
:司
194 数字图像处理(第三版)
4.28 基于式(3.64),近似二维离散微分的一种方法是计算形如f(x+1,y)+f(x-1.y)-2fx,y)和f(x,y+1)+
f(x,y-1)的差。
(a)在频率域找出与其等价的滤波器H(u,v)。
(b)证明您的结果是一个高通滤波器。
4.29 找出一个等价的滤波器H(u,v),它在频率域实现使用图3.37(a)中的拉普拉斯模板执行的空间操作。
★4.30 您能想出一种使用傅里叶变换计算(或分部计算)用于图像差分的梯度幅度[见式(3.6-11)]的方法
吗?如果您的回答是可以，那么请给出一种方法去实现它。如果您的回答是不可以，请解释原因。
★4.31 在连续频率域中，一个连续高斯低通滤波器有如下传递函数：
H(μ,v)=e2
证明相应的空间域滤波器是
h(1,z)=πe~22+)
4.32 如式(4.9-1)说明的那样，从低通滤波器的传递函数得到高通滤波器的传递函数H是可能的：
HHp=1-H
使用习题4.31中给出的信息，回答空间域高斯高通滤波
器是什么形式?
4.33 考虑右侧所示的图像。右侧的图像是通过如下步骤得
到的：(a)用(-1)"乘以左侧的图像；(b)计算其DFT; D.1.P|d'I·a
(c)取该变换的复共轭；(d)计算反 DFT;(e)用(-1)
乘以结果的实部。(从数学上)解释为什么右边的图像
会出现该现象。
4.34 图4.41(b)的水平轴上近似周期性的亮点的来源是什么?
★4.35 图4.53中的每一个滤波器在其中心处都有一个很强的尖刺，解释这些尖刺的来源。
4.36 考虑下面所示的图像。右边的图像是对左边图像用高斯低通滤波器进行低通滤波，然后用高斯
高通滤波器对结果再进行高通滤波得到的。图像的大小为420×344,两个滤波器均使用了D?=25。
(a)解释右侧图像中戒指的中心部分明亮且实心的原
因，考虑滤波后图像的支配特性是物体(如手指、腕
骨)的外边界上的边缘及这些边缘之间的暗区域。换
句话说，您并不希望高通滤波器将戒指内部的恒定
区域渲染为暗色，因为高通滤波消除了直流项?
(b)如果颠倒滤波处理的顺序，您认为结果会有区别吗?
4.37 给出一幅大小为M×N的图像，要求做一个实验，实验
(原图像由密歇根大学医学院解剖 使用截止频率为D。的高斯低通滤波器重复对该图像进
学分部的Thomas R.Gest 博士提供) 行低通滤波。可以忽略计算上的舍入误差。令c.是实
验所用机器可表示的最小正数。
★(a)令K表示该滤波器使用的次数。在进行实验前，您能预测K为足够大的值时的结果(图像)将
是什么吗?如果能，结果是什么?
(b)推导出保证预测结果的最小K值的表达式。
4.38 考虑下面所示的图像序列。最左侧的图像是商用印制电路板的X射线图像的一部分。该图像右侧
的图像分别是使用一个D=30的高斯高通滤波器进行1次、10次和100次滤波后的结果。图像的
第4章 频率域滤波 195
大小为330×334像素，每个像素由8比特灰度表示。为便于显示，图像已进行了缩放，但这对本
习题没有影响。
(a)从这几幅图像可以看出，经过有限次数的滤波后，图像将不再发生变化。请说明实际是否如此。
可以忽略计算舍入误差。令c表示完成此实验的机器可表示的最小正数。
(b)如果在(a)中确定有限次迭代后变化将停止，求最小的迭代次数。
(原图像由Lixi公司的Joseph E.Pascente先生提供)
4.39 如图4.59中说明的那样，将高频强调和直方图均衡相结合是实现边缘锐化和对比度增强的有效方法
(a)说明这种结合方法是否与先用哪种处理有关。
(b)如果与应用顺序有关，请给出先采用某种方法的理由。
4.40 使用一个布特沃斯高通滤波器构建一个同态滤波器，该滤波器的形状与图4.6中的滤波器的形状
相同。
★4.41 证明式(4.11-16)和式(4.11-17)的正确性。(提示：使用归纳法证明。)
4.42 假设有一组图像，这组图像是由对恒星事件分析的实验生成的。每幅图像都包含一组明亮且松散
的点，这些点对应于广袤宇宙空间中的星星。问题是这些星星因为大气折射导致的重叠照射几
乎不可见。如果这些图像使用一组冲激建模为一个恒定照射分量的乘积，试提出一个增强过程，
它以设计为显示星星自身的图像分量的同态滤波为基础。
4.43 一种成熟的医学技术被用于检测电子显微镜生成的某类图像。为简化检测任务，技术人员决定采
用数字图像增强技术，并在处理结束后，检查了一组具有代表性的图像，发现了如下问题：(1)明
亮且孤立的点是不感兴趣的点；(2)清晰度不够；(3)一些图像的对比度不够；(4)平均灰度值已被
改变，而正确地执行某种灰度度量的这个值应是V。技术人员想要纠正这些问题，然后将I和I?
波段之间的所有灰度显示为白色，同时保持其余灰度的正常色调。请为技术人员提出达到期望目
的的处理步骤。可以使用第3章和第4章的技术。
;3
田：望
第5章 图像复原与重建
我们所看到的事物并不是事物的本身……物体本身是什么对我们而言完全
是未知的，并且远离我们的感知。除了对物体的感知，我们什么也不知道。
——伊曼努尔·康德
引言
正像图像增强那样，图像复原技术的主要目的是以预先确定的目标来改善图像。尽管两者有相
覆盖的领域，但图像增强主要是一个主观过程，而图像复原则大部分是一个客观过程。图像复原试图
利用退化现象的某种先验知识来复原被退化的图像。因而，复原技术是面向退化模型的，并且采用相
反的过程进行处理，以便恢复出原图像。
这种方法通常都会涉及设立一个最佳准则，它将产生期望结果的最佳估计。相比之下，图像增
强技术基本上是一个探索性过程，即根据人类视觉系统的生理特点来设计一种改善图像的方法。例如，
对比度拉伸被认为是一种增强技术，因为它主要基于给观看者提供其喜欢接受的图像，而通过去模糊
函数去除图像模糊则被认为是一种图像复原技术。
本章中给出的素材严格地说只是介绍性的。我们仅从给出的一幅退化数字图像的特点来考虑复
原问题；因此对传感器、数字化转换器和显示退化等话题考虑得较少。尽管这些主题在图像复原应用
的整个处理中非常重要，但它们超出了本章所要讨论的范围。
正如第3章和第4章中讨论的那样，一些空间域复原技术已很好地阐述过了，而另一些复原技
术则更适用于频率域。例如，当退化仅仅是加性噪声时，空间处理就非常适用。另一方面，如图像模
糊这样的退化在空间域使用较小的滤波模板就很困难。在这种情况下，基于不同优化准则的频率域滤
波是可选择的方法。这些滤波器同样也考虑到了噪声的存在。正如第4章中所讲的那样，频率域中用
来解决给定应用的复原滤波器通常作为生成一个数字滤波器的基础，数字滤波器的程序操作更适合于
用硬件或固件来实现。
5.1节介绍图像退化复原过程的一个线性模型。5.2节处理实践中经常遇到的各种噪声模型。5.3节
阐述降低图像噪声的几种空间滤波技术，即通常称为图像去噪的处理。5.4节致力于使用频率域降噪的技
术。5.5节介绍图像退化的线性、位置不变模型，5.6节介绍估计退化函数的方法。5.7节至5.10节阐述基
本的图像复原方法。本章最后(见5.11节)介绍由投影来重建图像。这一概念的主要应用是计算断层(CT).
即图像处理在健康领域最为重要的一种商业应用。
第5章 图像复原与重建 197
5.1 图像退化/复原过程的模型
如图5.1所示，在本章中，退化过程被建模为一个退化函数和一个加性噪声项，对一幅输入图像
f(x,y)进行处理，产生一幅退化后的图像g(x,y)。给定g(x,y)和关于退化函数H的一些知识以及关
于加性噪声项n(x,y)的一些知识后，图像复原的目的就是获得原始图像的一个估计f(x,y)。通常，
我们希望这一估计尽可能地接近原始输入图像，并且H和η的信息知道得越多，所得到的f(x,y)就
会越接近f(x,y)。在本章中使用的大部分复原方法都是以不同类型的图像复原滤波器为基础的。
正如5.5节所示，如果H是一个线性的、位置不变的过程，那么空间域中的退化图像可由下式给出：
g(x,y)=h(x,y)*f(x,y)+η(x,y) (5.1-1)
其中，h(x,y)是退化函数的空间表示；与第4章相同，符号“★”表示空间卷积。由4.6.6节的讨论可
知，空间域中的卷积等同于频率域中的乘积，因此可以把式(5.1-1)中的模型写成等价的频率域表示：
G(u,v)=H(u,v)F(u,v)+N(u,v) (5.1-2)
其中的大写字母项是式(5.1-1)中相应项的傅里叶变换。这两个公式是本章中大部分复原内容的基础。
8(x,y)
f(x,y)> 退化函数 + 复原滤波器 j(x,y) H
噪声
η(x.y)
退化 复原
图5.1 图像退化复原过程的模型
在接下来的三节中，我们假设H是一个同一性算子，并且只处理由噪声引起的退化。从5.6节开
始，我们考虑若干重要的图像退化函数，并考虑几个H和η同时存在的图像复原方法。
5.2 噪声模型
数字图像中，噪声主要来源于图像的获取和/或传输过程。成像传感器的性能受各种因素的影响，
如图像获取过程中的环境条件和传感元器件自身的质量。例如，在使用CCD 摄像机获取图像时，光
照水平和传感器温度是影响结果图像中噪声数量的主要因素。图像在传输中被污染主要是由于传输信
道中的干扰。例如，使用无线网络传输的图像可能会因为光照或其他大气因素而污染。
5.2.1 噪声的空间和频率特性
与我们的讨论相关的是定义噪声空间特性的参数，以及噪声是否与图像相关。频率特性是指傅
里叶域中噪声的频率内容(即相对于电磁波谱的频率)。例如，当噪声的傅里叶谱是常量时，噪声通常
称为白噪声。这个术语是从白光的物理特性派生出来的，它以相等的比例包含可见光谱中的几乎所有
频率。从第4章的讨论中不难看出，以相同比例包含所有频率的函数的傅里叶谱是一个常量。
除了空间周期噪声(见5.2.3节)之外，在本章中我们假设噪声独立于空间坐标，并且噪声与图像
本身不相关(即像素值与噪声分量的值之间不相关)。虽然这些假设至少在某些应用中(例如X射线和 弼
198 数字图像处理(第三版)
核医学成像的有限量子成像就是一个很好的例子)是无效的，但处理空间相关和相关性噪声的复杂性
超出了我们讨论的范围。
5.2.2 一些重要的噪声概率密度函数
基于前一节的假设，我们关心的空间噪声描述子就是图5.1中模型的噪声分量中灰度值的统计特
性。可以认为它们是由概率密度函数(PDF)表征的随机变量。下面是 一关于概率论的简要回顾，请
在图像处理应用中最常见的PDF。 查阅本书的网站
高斯噪声
在空间域和频率域中，由于高斯噪声在数学上的易处理性，故实践中常用这种噪声(也称为正态
噪声)模型。事实上，这种易处理性非常方便，以至于高斯模型常常应用于在一定程度上导致最好结
果的场合。
高斯随机变量z的PDF由下式给出：
p(2)=zmet-rz (5.2-1)
其中，z表示灰度值，z表示z的均(平均)值.σ表示z的标准差。标准差的平方o2称为z的方差。高
斯函数的曲线如图5.2(a)所示。当z服从式(5.2-1)的分布时，其值有大约70??在范围[(Z-o),(Z+0l
内，有大约95??在范围[(Z-2o),(Z+2a)]内。
8～3
ei削
p(z)
K
高斯 瑞利 伽马
V260 k=b-。
-aZZ+a a
a+ (h-1)/a
P(=)| p(z)|
a
PA
指数 均匀 脉冲
P
Z a b a b
图5.2 一些重要的概率密度函数
瑞利噪声
瑞利噪声的PDF由下式给出：
①在本节中我们使用Z而不是m来表示均值的原因是，避免我们在后面使用m和n来表示邻域大小时引起混淆。
第5章 图像复原与重建 199
--
z≥a
z<a
(5.2-2)
概率密度的均值和方差由
z=a+√πb/4 (5.2-3)
和
o2=b?- (5.2-4)
给出。图5.2(b)显示了瑞利密度的曲线。注意，距原点的位移和密度的基本形状向右变形了这一事实。
瑞利密度对于近似歪斜的直方图十分适用。
爱尔兰(伽马)噪声
爱尔兰噪声的PDF由下式给出：
z≥a
z<a
(5.2-5)
其中，参数a>0,b为正整数，并且"!"表示阶乘。其概率密度的均值和方差由 =
(5.2-6)
和
c2= (5.2-7)
给出。图5.2(c)显示了伽马分布密度的曲线，尽管式(5.2-5)经常称之为伽马密度，但严格地说，这只
有在分母为伽马函数「(b)时才是正确的。当分母如表达式所示时，该密度称为爱尔兰密度更合适。
指数噪声
指数噪声的PDF由下式给出：
n2-{ z≥0 (5.2-8) z<0
其中，a>0。该概率密度函数的均值和方差是
z= (5.2-9)
和
o2= (5.2-10)
注意，这个PDF是当b=1时爱尔兰PDF的特殊情况。图5.2(d)显示了该密度函数的曲线。
均匀噪声
均匀噪声的PDF由下式给出： :密
器;固
200 数字图像处理(第三版)
(5.2-11)
该密度函数的均值由下式给出： z=“ (5.2-12)
它的方差由下式给出：
o2=b-a2 (5.2-13)
图5.2(e)显示了均匀密度的曲线。
脉冲(椒盐)噪声
(双极)脉冲噪声的PDF由下式给出：
(5.2-14)
如果b>a,则灰度级b在图像中将显示为一个亮点；反之，灰度级a在图像中将显示为一个暗点。
若P或P,为零，则脉冲噪声称为单极脉冲。如果P和P。两者均不可能为零，尤其是它们近似相等
时，则脉冲噪声值将类似于在图像上随机分布的胡椒和盐粉微粒。由于这个原因，双极脉冲噪声也称
为椒盐噪声。这种类型的噪声也可以使用散粒噪声和尖峰噪声来称呼。在下面的讨论中，我们将交替
使用脉冲噪声和椒盐噪声这两个术语。
噪声脉冲可以为正也可以为负。标定通常是图像数字化处理的一部分。因为，与图像信号的强
度相比，脉冲污染通常较大，所以在一幅图像中脉冲噪声通常被数字化为最大值(纯黑或纯白)。这样，
通常假设a和b是饱和值，从某种意义上看，在数字化图像中，它们等于所允许的最大值和最小值。
由于这一结果，负脉冲以一个黑点(胡椒点)出现在图像中。由于相同的原因，正脉冲以白点(盐粒点)
出现在图像中。对于一幅8比特图像，典型地，这意味着a=0(黑)和b=255(白)。图5.2(f)显示了
脉冲噪声的概率密度函数(PDF)。
前述的一组PDF 为在实践中建立宽带噪声污染状态的模型提供了有用的工具。例如，在一幅图
像中，高斯噪声源于诸如电子电路噪声以及由低照明度和/或高温带来的传感器噪声。瑞利密度有助
于在深度成像中表征噪声现象。指数密度和伽马密度在激光成像中有用。正如前段所提及的那样，脉
冲噪声在快速过渡的情况下产生，如在成像期间发生的错误开关操作。均匀密度可能是实践中描述得
最少的，然而，均匀密度作为仿真中使用的许多随机数生成器的基础是非常有用的(见 Peebles[1993]
和Gonzalez,Woods and Eddins[2004])。
例5.1 噪声图像及其直方图。
图5.3显示了一幅非常适合于阐述刚刚讨论的噪声模型的测试图
案。这是一幅适合使用的图案，因为它是由简单的、恒定的区域所组
成的，且其从黑到近似于白仅仅有3个灰度级增长跨度。这方便了附
加在图像上的各种噪声分量特性的视觉分析。
图5.4显示的是叠加了本节所讨论的6种噪声的测试图案。每幅
图像下面所示的是从图像直接计算得到的直方图。在每种情况下选择
图5.3 用于说明显示在图5.2中的
噪声PDF特性的测试图案
第5章 图像复原与重建 201
了噪声的参数，以便对应于测试图案中 3种灰度级的直方图会开始合并。这使得噪声十分显著,而不会
遮蔽底层图像的基本结构。
比较图5.4中的直方图和图5.2中的概率密度函数，可以看到很接近的对应关系。对于椒盐噪声示例的直
方图在密度标度的白端有一个额外的尖峰，因为噪声分量为纯黑或纯白，并且在测试图案中最亮的分量(圆)
是亮灰度。除了少许亮度不同外，在图5.4中很难区别出前5幅图像有什么显著不同，即使它们的直方图有明
显的区别。由脉冲噪声污染的图像的椒盐噪声的外观是唯——种引起退化的、视觉上可区分的噪声类型。
aei
高斯 瑞利 伽马
ghi
jk I
指数 均匀 椒盐
图5.4 对图5.3中的图像添加高斯、瑞利、伽马、指数、均匀和椒盐噪声后的图像与直方图
5.2.3 周期噪声
一幅图像中的周期噪声是在图像获取期间由电力或机电干扰产生的。这是在本章中讨论的唯一的
一种空间相关噪声。正如5.4节所讨论的那样，周期噪声可通过频率域滤波来显著地减少。例如，
考虑图5.5(a)中的图像。这幅图像被不同频率的(空间)正弦噪声严重干扰了。一个纯正弦波的傅里叶变
换是位于正弦波共轭频率处的一对共轭脉冲(见表4.3)。因此，如果空间域中正弦波的振幅足够强，我
们在该图像的谱中将看到图像中每个正弦波的脉冲对。如图5.5(b)所示，确实如此，由于在这个特殊
例子中频率值是这样安排的，所以脉冲以一个近似的圆出现。在5.4节我们将进一步讨论此问题，以
及周期噪声的其他例子。
①注意不要混淆频率域中的术语脉冲与脉冲噪声中使用的同一术语。 毛黑
黑器
202 数字图像处理(第三版)
a b
图5.5(a)被正弦噪声污染的图像；(b)谱(每对共轭脉冲对应于一个正弦波)(原图像由NASA提供)
5.2.4 噪声参数的估计
典型地，周期噪声的参数是通过检测图像的傅里叶谱来估计的。正如前几节提及的那样，周期噪
声趋向于产生频率尖峰，甚至通过视觉分析也经常可以检测到这些尖峰。另一种方法是试图直接由图
像推断出噪声分量的周期性，但这仅在非常简单的情况下才是可能的。在噪声尖峰格外显著或可以使
用关于干扰的频率分量一般位置的某些知识时，自动分析是可能的。
噪声 PDF 的参数一般可以从传感器的技术说明中得知，但对于特殊的成像装置通常需要估计这
些参数。如果成像系统可用，那么研究系统噪声特性的一种简单方法是获取一组“平坦”环境的图像。
例如，在光学传感器的情况下，这像对一个光照均匀的纯色灰度板成像一样简单。结果图像是典型的
系统噪声的良好指示器。
当仅有通过传感器生成的图像可用时，通常可由合理的恒定灰度值的一小部分来估计 PDF的
参数。例如，图5.6所示的垂直条带(150×20像素)是从图5.4中所示的高斯、瑞利和均匀图像中截取
的。所显示的直方图是使用这些小条带的图像数据计算出来的。与图5.6中的直方图对应的图5.4中
的直方图，是图5.4(d)、图5.4(e)和图5.4(k)这三组直方图中间的一组。我们可以看出，这些对应的
直方图的形状非常接近于图5.6中的直方图的形状。由于缩放的原因，它们的高度不同，但形状明
显类似。
a bc
图5.6 使用小条带(显示为插图)从图5.4中的(a)高斯、(b)瑞利和(c)均匀噪声图像计算的直方图
来自图像条带数据的最简单的用途是计算灰度级的均值和方差。考虑由S表示的一个条带(子图
像),并令ps(z),i=0,1,2,…,L-1表示S中像素灰度的概率估计(归一化直方图值),其中L是整
个图像中可能的灰度数(例如，对于8比特图像，L为256)。如第3章那样，我们估计S的均值和方
差如下：
=2Bps(2)
c2-2(3-a2p()
(5.2-15)
(5.2-16)
第5章 图像复原与重建 203
直方图的形状确定最接近的PDF 匹配。如果其形状近似于高斯、那么均值和方差正是我们所需
要的，因为高斯PDF完全由这两个参数指定。对于5.2.2节讨论的其他形状，我们使用均值和方差来
解出参数a和b。使用不同的方法来处理脉冲噪声，因为需要的估计是黑、白像素发生的实际概率。
获得这些估计值需要黑白像素是可见的，因此为了计算直方图，图像中需要有一个相对恒定的中等灰
度区域。对应于黑、白像素的尖峰的高度是式(5.2-14)中P和P,的估计值。
5.3 只存在噪声的复原——空间滤波
当一幅图像中唯一存在的退化是噪声时，式(5.1-1)和式(5.1-2)变成
g(x,y)=f(x.y)+η(x.y) (5.3-1)
和
G(u,v)=F(u,V)+N(u,V) (5.3-2)
噪声项是未知的，故从g(x,y)或G(u,v)中减去它们不是一个现实的选择。在周期噪声的情况下，由Gu,v)
的谱来估计Nu,v)通常是可能的，正如5.2.3节所述。在这种情况下，从G(u,v)中减去N(u,v)可得到
原图像的一个估计。然而，这种类型的知识通常只是例外而不是规律。
当仅存在加性噪声的情况下，可以选择空间滤波方法。空间滤波已在第3章中详细讨论过了。
除了执行一种特定的滤波来计算特性以外，下面实现的所有滤波的机理完全与3.5节和3.6节中讨论
过的一样。
5.3.1 均值滤波器
在本节中，我们简要地讨论3.5节中介绍过的空间滤波器的降噪能力，并探讨一些其他的滤波器，
这些滤波器的性能在许多情况下要优于3.5节中所讨论的滤波器的性能。
算术均值滤波器
这是最简单的均值滤波器。令S。表示中心在点(x,y)处、大小为mxn的矩形子图像窗口(邻域)
的一组坐标。算术均值滤波器在S,定义的区域中计算被污染图像 假设m和n是奇整数 g(x,y)的平均值。在点(x,y)处复原图像子的值，就是简单地使用S。
定义的区域中的像素计算出的算术均值，即
rax,)=—∑86.0 (5.3-3)
这个操作可以使用大小为m×n的一个空间滤波器来实现，其所有的系数均为其值的1/mn。均值滤波
平滑一幅图像中的局部变化，虽然模糊了结果，但降低了噪声。
几何均值滤波器
使用几何均值滤波器复原的一幅图像由如下表达式给出：
raw-[Ⅱ ss]F (5.3-4)
其中，每个复原的像素由子图像窗口中像素的乘积的1/mn次幂给出。如例5.2 所示，几何均值滤波
器实现的平滑可与算术均值滤波器相比，但这种处理中丢失的图像细节更少。 宏黑
204 数字图像处理(第三版)
器：器
谐波均值滤波器
谐波均值滤波操作由如下表达式给出：
(5.3-5)
谐波均值滤波器对于盐粒噪声效果较好，但不适用于胡椒噪声。它善于处理像高斯噪声那样的其他
噪声。
逆谐波均值滤波器
逆谐波均值滤波器基于如下表达式产生一幅复原的图像：
(5.3-6)
其中Q称为滤波器的阶数。这种滤波器适合减少或在实际中消除椒盐噪声的影响。当Q值为正时，
该滤波器消除胡椒噪声；当Q值为负时，该滤波器消除盐粒噪声。但它不能同时消除这两种噪声。注
意，当Q=0时，逆谐波均值滤波器简化为算术均值滤波器；而当Q=-1时，则为谐波均值滤波器。
例5.2 均值滤波器的说明。
图5.7(a)显示了一块电路板的8比特X射线图像，图5.7(b)显示了相同的图像，但图像已被均值为零、
方差为400的加性高斯噪声污染了。对于这种类型的图像，这是非常严重的噪声。图5.7(c)和图5.7(d)分
别显示了使用大小为3×3的算术均值滤波器和同样大小的几何均值滤波器滤除噪声后的结果。尽管这两
种噪声滤波器对噪声的衰减都起到了作用，但几何均值滤波器并未像算术均值滤波器那样使图像变得模
糊。例如，图像顶部的连接片在图5.7(d)中比在图5.7(c)中更为清晰。图像的其他部分同样如此。
a bcd
图5.7(a)X射线图像；(b)被加性高斯噪声污染的图像；(e)使用大小为3×3的
算术均值滤波器对图像滤波后的结果；(d)使用相同大小的几何均值滤波
器对图像滤波后的结果(原图像由Lixi公司的Joseph E.Pascente先生提供)
图5.8(a)显示了同样的电路图像，但被概率为0.1的胡椒噪声污染了。类似地，图5.8(b)显示了已被
具有相同概率的盐粒噪声污染了的图像。图5.8(e)显示了使用Q=1.5的逆谐波均值滤波器对图5.8(a)滤
波的结果。图5.8(d)显示了使用Q=-1.5的逆谐波均值滤波器对图5.8(b)滤波后的结果。两种滤波器都有
很好的去除噪声的效果。这种正阶滤波器除了使得暗区稍微有些淡化和模糊之外，都使背景变得更为清
晰。负阶滤波器的作用正好相反。
第5章 图像复原与重建 205
a bcd
图5.8 (a)被概率为0.1的胡椒噪声污染的图像；(b)被相同概率的盐粒噪声污染的
图像；(c)使用大小为3×3、阶数为1.5的逆谐波均值滤波器对图(a)滤波
后的结果；(d)使用Q=-1.5的逆谐波均值滤波器对图(b)滤波后的结果
总之，算术均值滤波器和几何均值滤波器(尤其是后者)更适合于处理高斯或均匀随机噪声。逆谐波
均值滤波器更适合于处理脉冲噪声，但它还有一个缺点，即必须知道噪声是暗噪声还是亮噪声，以便于
为Q选择的正确的符号。如果Q的符号选择错了，则可能会引起灾难性的后果，如图5.9所示。下面几
节讨论的一些滤波器可消除这种缺点。
a b 4头物 声 …一4也 !
*
犹 弦
子己
图5.9 在逆谐波滤波中选择错误符号的结果：(a)使用大小为3×3且Q=-1.5的逆谐
波滤波器对图5.8(a)滤波后的结果；(b)当Q=1.5时对图5.8(b)滤波后的结果
5.3.2 统计排序滤波器
3.5.2节介绍过统计排序滤波器。我们现在扩充那一节的讨论，并介绍其他一些统计排序滤波器。
正如3.5.2节所述，统计排序滤波器是空间域滤波器，空间滤波器的响应基于由该滤波器包围的图像
区域中的像素值的顺序(排序)。排序结果决定滤波器的响应。
中值滤波器
最著名的统计排序滤波器是中值滤波器，如其名称所暗示的那样，它使用一个像素邻域中的灰
度级的中值来替代该像素的值，即
f(x,y)=medin{g(s,D} (5.3-7)
在(x,y)处的像素值是计算的中值。中值滤波器的应用非常普遍，因为对于某些类型的随机噪声，它
们可提供良好的去噪能力，且比相同尺寸的线性平滑滤波器引起的模糊更少。在存在单极或双极脉
冲噪声的情况下，中值滤波器尤其有效。事实上，正如下面的例5.3所示，中值滤波器对于这种噪
声污染的图像可得到非常好的处理效果。这种滤波器中值的计算和实现已在3.5.2节中进行了详细
的讨论。 医：生
三-美
206 数字图像处理(第三版)
最大值和最小值滤波器
尽管中值滤波器是目前为止图像处理中最常用的一种统计排序滤波器，但它绝不是唯一的一种
中值相当于顺序排列的数组中间的那个数，但是您会从基本的统计学
回想到排列本身还有很多其他的可能性。例如，可以使用序列中的最
后一个数值，称为最大值滤波器，由下式给出：
关于数的排列顺序的注释请参阅
1035节中的第二条注释。
f(x,y)=max{8(s.D} (5.3-8)
这种滤波器对于发现图像中的最亮点非常有用。同样，因为胡椒噪声的值非常低，作为子图像区域S。
中这种最大值选择过程的结果，可以用这种滤波器降低它。
选择起始值的滤波器称为最小值滤波器，它由下式给出：
fcx.y=min{8(s,D} (5.3-9)
这种滤波器对于发现图像中的最暗点非常有用。同样，作为最小值操作的结果，它可以降低盐粒噪声。
中点滤波器
中点滤波器简单地计算滤波器包围区域中最大值和最小值之间的中点，即
fux,y=[my {g(s.0)+mi{8G.0}] (5.3-10)
注意，这种滤波器结合了统计排序和求平均。它对于随机分布噪声工作得最好，如高斯噪声或均匀噪声。
修正的阿尔法均值滤波器
假设在邻域S,内去掉g(s,1)最低灰度值的d/2和最高灰度值的d/2。令g(s,0代表剩下的mn-d个
像素。由这些剩余像素的平均值形成的滤波器称为修正的阿尔法均值滤波器：
fax,=m-a∑8,G5.) (5.3-11)
其中，d的取值范围可为0到mn-1。当d=0时，修正的阿尔法均值滤波器退化为前一节讨论的算术
均值滤波器。如果选择d=mn-1,则修正的阿尔法均值滤波器将退化为中值滤波器。当d取其他值时，
修正的阿尔法均值滤波器在包括多种噪声的情况下很有用，例如高斯噪声和椒盐噪声混合的情况下。
例5.3 统计排序滤波器的说明。
图5.10(a)显示了被概率为P.=P,=0.1的椒盐噪声污染的电路板图像。图5.10(b)显示了用大小为3×3
的中值滤波器滤波的结果。对图5.10(a)的改进是显而易见的，但一些噪声点仍然可见。使用中值滤波器
[对图5.10(b)中的图像]进行第二次滤波处理后，去掉了大部分这样的噪声点，仅剩下非常少的可见噪
声点。这些噪声点在经过第三次中值滤波处理后全部消除了。这些结果是说明中值滤波器处理脉冲型加
性噪声能力的很好的例子。记住，使用中值滤波器对图像重复地进行处理会使图像变模糊，所以希望保
持尽可能低的处理次数。
图5.11(a)显示了把最大值滤波器用于图5.8(a)所示“胡椒”噪声图像的结果。这种滤波器对除去图
像中的“胡椒”噪声的确很合适，但我们注意到它同时也从黑色物体的边缘去除了一些黑色像素(即将这
些像素设置为亮灰度级)。图5.11(b)显示了把最小值滤波器用于图5.8(b)的结果。在这种情况下，在噪声
消除方面，最小值滤波器的确比最大值滤波器更好，但它同时也从明亮物体的边缘去除了一些白色像素。
这样就使亮物体变小，而同时使暗物体变大(就像图像顶部的连接片那样),因为围绕这些物体的白点被
设置成了暗灰度级。
第5章 图像复原与重建 207
a bcd
1:1年率5 :1::1
图5.10 (a)被概率为Pa=P,=0.1的椒盐噪声污染的图像；(b)使用大小为3×3的中值滤波器对图像滤波一
次后的结果；(c)使用该滤波器对图(b)滤波后的结果；(d)使用相同的滤波器处理图(c)后的结果
a b
图5.11 (a)使用大小为3×3的最大值滤波器对图5.8(a)滤波后的结果；
(b)使用相同大小的最小值滤波器对图5.8(b)滤波后的结果
下面说明修正的阿尔法均值滤波器。图5.12(a)显示了一幅被均值为零、方差为800的加性均匀噪声
污染的图像。这是一种高级别的噪声污染，它被P=P=0.1的椒盐噪声叠加而进一步劣化了，如图5.12(b)
所示。对这幅图像中的高级别噪声使用更大的滤波器是正确的。图5.12(c)到图5.12(f依次显示了使用大
小为5×5的算术均值、几何均值、中值和d=5的修正的阿尔法均值滤波器处理后的图像。正如所预料的
那样，由于脉冲噪声的存在，算术均值滤波器和几何均值滤波器(尤其是后者)并没有起到良好的作用。
中值滤波器和修正的阿尔法均值滤波器则好得多，在降噪方面修正的阿尔法均值滤波器的效果更好一些。
例如，注意图像左上角第4个连接片在修正的阿尔法均值滤波器处理后变得稍微平滑一些。这并不意外，
因为对于高的d值，修正的阿尔法均值滤波器接近于中值滤波器的性能，但仍然保留了一些平滑能力。
dei
梦辈 律甚 ;活
事 艺望4
图5.12 (a)被加性均匀噪声污染的图像；(b)再被加性椒盐噪声污染的图像；(c)使用大小
为5×5的算术均值滤波器对图(b)滤波后的结果；(d)使用大小为5×5的几何均
值滤波器对图(b)滤波后的结果；(e)使用大小为5×5的中值滤波器对图(b)滤波后的
结果；①使用大小为5×5且d=5的修正的阿尔法均值滤波器对图(b)滤波后的结果 罔密
密：因
208 数字图像处理(第三版)
5.3.3 自适应滤波器
迄今为止讨论过的用于图像处理的滤波器并没有考虑图像中的一点对于其他点的特征变化。在
这一节中，我们将考虑两个简单的自适应滤波器，滤波器的特性变化是以m×n的矩形窗口S。定义
的滤波器区域内图像的统计特性为基础的。正如下面的讨论所表明的那样，自适应滤波器的性能要优
于迄今为止讨论过的所有滤波器的性能。改善滤波能力的代价是滤波器的复杂度提高了。记住，我们
一直在处理这样的情况，即退化图像等于原始图像加噪声。还没有考虑其他类型的退化。
自适应局部降低噪声滤波器
随机变量最简单的统计度量是其均值和方差。作为自适应滤波器的基础这些是合理的参数，因
为它们是与图像表观紧密相关的量。均值给出了在其上计算均值的区域中的平均灰度的度量，而方差
则给出了该区域的对比度的度量。
滤波器作用于局部区域S。滤波器在该区域中心任意一点(x,y)上的响应基于以下4个量：(a)g(x,y),
带噪图像在点(x,y)上的值；(b)o?,污染f(x,y)以形成g(x,y)的噪声的方差；(c)m?,S。中像素的局
部均值；(d)o2,s。中像素的局部方差。我们希望滤波器的性能如下：
1.如果σ为零，则滤波器应该简单地返回 g(x,y)的值。这无关紧要，在零噪声情况下g(x,y)
等于f(x,y)。
2.如果局部方差与σ}是高度相关的，则滤波器返回g(x,y)的一个近似值。典型地，高局部方差
与边缘相关，并且应该保护这些边缘。
3.如果两个方差相等，我们则希望滤波器返回S,中像素的算术均值。这种情况发生在局部区域
与整个图像有相同特性的条件下，并且局部噪声将通过简单地求平均来降低。
基于这些假设得到的f(x,y)的自适应表达式可以写成
沪ax,y)=gx,)8(x,y)-m,] (5.3-12)
唯一需要知道或估计的量是全部噪声的方差o?。其他参数要从每个(x,y)处的S,中的像素来计
算.(x,y)是滤波器窗口的中心。式(5.3-12)中隐含的假设为σ}≤o2。模型中的噪声是加性的和位置
独立的，因此这是一个合理的假设，因为S,是g(x,y)的子集。然而，我们很少有σ?的确切知识，因
此在实际中很可能违反这个条件。由于这个原因，式(5.3-12)的实现应建立一个测试，以便当条件
o}>o2发生时，把比率设置为1。这就造成该滤波器的非线性。然而，它可以防止由于缺乏图像噪
声方差的知识而产生的无意义结果(即负灰度级，取决于m,的值)。另一种方法是允许出现负值，并
在最后重新标定灰度值。因而，结果将损失图像的动态范围。
例5.4 自适应局部降低噪声滤波的说明。
图5.13(a)显示了被均值为零、方差为1000的加性高斯噪声污染的电路板图像。这是噪声污染水平严
重的图像，但是，它却成为了一个比较相应滤波器性能的理想的测试基础。图5.13(b)是使用大小为7×7
的算术均值滤波器处理噪声图像后的结果。噪声被平滑掉了，但代价是图像被严重模糊了。类似的解释
也可用于图 5.13(c),它显示了使用大小还是7×7的几何均值滤波器处理噪声图像后的结果。这两幅滤波
后的图像间的区别与我们在例5.2中讨论过的类似，仅仅是模糊程度的不同。
图5.13(d)显示了使用式(5.3-12)且o,=1000的自适应滤波的结果。与前两个滤波器相比，该结果的
第5章 图像复原与重建 209
改进是很大的。从总体噪声减少情况来看，自适应滤波器所达到的效果与算术和几何均值滤波器相似。
然而，使用自适应滤波器滤波后的图像更清晰一些。例如，在图5.13(d)中图像顶部的连接片更为清晰。
其他特性，如孔和图像左下方暗部件的8根引脚等，在图5.13(d)中更加清楚。这些结果是使用自适应滤
波器所能达到的典型结果。正如在早些时候提到过的那样，改进性能的代价是增加了滤波器的复杂性。
上面的结果中对o2用了一个值，该值准确地与噪声方差匹配。若该值未知，且使用了太低的估计值，
则算法会因为校正量比应有的小而返回与原图像非常接近的图像。估计值太高则会造成方差的比率在1.0
处被削平，并且算法会比正常情形下更频繁地从图像中减去平均值。如果允许为负值，且图像在最后被
重新标定，则如前所述，结果将损失动态范围。
a bcd
1
图5.13(a)被均值为零、方差为1000的加性高斯噪声污染的图像；(b)算术均值滤波的结果；
(c)几何均值滤波的结果；(d)自适应降噪滤波的结果。所有滤波器的大小均为7×7
自适应中值滤波器
对于5.3.2节所讨论的中值滤波器，只要脉冲噪声的空间密度不大，性能就会很好(根据经验，P.
和P?小于0.2)。本节将证明，自适应中值滤波可以处理具有更大概率的脉冲噪声。自适应中值滤波
器的另一个优点是平滑非脉冲噪声时试图保留细节，这是传统中值滤波器所做不到的。正如在前面几
节中讨论的所有滤波器一样，自适应中值滤波器也工作于矩形窗口区域S。内。然而，与这些滤波器
不同的是自适应中值滤波器在进行滤波处理时会根据本节列举的某些条件而改变(或增大)S,的尺
寸。记住，滤波器的输出是一个单值，该值用于代替点(x,y)处的像素值，点(x,y)是给定时刻窗口 S。
的中心。
考虑如下符号：
2Zmm=S,中的最小灰度值
Zm=S,中的最大灰度值
Zma=S,中的灰度值的中值
Z=坐标(x,y)处的灰度值
Sm=S,允许的最大尺寸
自适应中值滤波算法以两个进程工作，表示为进程A和进程B,如下所示：
进程A: A?=ZmZmm
A?=zm-Zm
如果A?>0且A?<0,则转到进程B
否则增大窗口尺寸
如果窗口尺寸≤Sm,则重复进程A
否则输出z 圆～留
采
210 数字图像处理(第三版)
进程B: B?=Z-Zmn
B?=Z-Zm
如果B?>0且B?<0,则输出z
否则输出zm
理解该算法机理的关键在于，要记住它有3个主要目的：去除椒盐(脉冲)噪声，平滑其他非脉
冲噪声，并减少诸如物体边界细化或粗化等失真。值z和z在算法统计上认为是类脉冲噪声分量，
即使它们在图像中并不是最低和最高的可能像素值。
利用这些观察结果，我们看到，进程A的目的是确定中值滤波器的输出z是否是一个脉冲(黑
或白)。如果条件2<Zm<zm有效，则根据前节提到的原因，z不可能是脉冲。在这种情况下，我
们转到进程B进行测试，看窗口z的中心点本身是否是一个脉冲(回忆可知zy是正被处理的点)。若
条件B?>0“与”(AND)B?<0为真，则z<Z?<Zmm,z,就不是脉冲，原因与z不是脉冲相同。在
这种情况下，算法输出一个不变的像素值z。通过不改变这些“中间灰度级”的点，减少图像中的
失真。如果条件B?>0“与”(AND)B?<0为假，则z=zm或ZZm。在任何一种情况下，像素值
都是一个极端值，且算法输出中值zs,从进程A可知z不是噪声脉冲。最后一步是执行标准的中
值滤波。问题是，标准中值滤波器使用图像中相应邻域的中值代替该图像中的每一点，这会引起不必
要的细节损失。
继续上面的说明，假设进程A确实找到了一个脉冲(若失败则测试会将它转到进程B)。然后，算法
会增大窗口尺寸并重复进程A。该循环会一直继续，直到算法找到一个非脉冲的中值(并跳转到进程B),
或者达到了窗口的最大尺寸。如果达到了窗口的最大尺寸，则算法返回z值。注意，不能保证该值不
是一个脉冲。噪声的概率P和/或P,越小，或者S在允许的范围内越大，过早退出条件发生的可能性
就会越小。这似乎是合理的。随着脉冲密度的增大，我们会需要更大的窗口来消除尖峰噪声。
算法每输出一个值，窗口 S。就被移到图像中的下一个位置。然后，算法重新初始化并应用到新
位置的像素。如习题3.18指出的那样，仅使用新像素就可以反复更新中值，因而减少了计算开销。
例5.5 自适应中值滤波的说明。
图5.14(a)显示了被概率为P=P=0.25的“椒盐”噪声污染的电路板图像，该噪声的概率为图5.10(a)
中所用噪声概率的2.5倍。此处噪声水平非常高，以至于模糊了图像的大部分细节。作为比较的基础，图
像首先使用最小中值滤波器进行滤波，消除大部分可见的脉冲噪声痕迹。做这种处理需要一个大小为7×7
的中值滤波器，并且处理结果显示在图5.14(b)中。虽然噪声被有效地消除了，但该滤波明显导致了图像细
节的损失。例如，图像顶部的一些连接片出现了失真或断裂。其他的图像细节也同样失真了。
a bc
图5.14(a)被概率P=P=0.25的椒盐噪声污染的图像；(b)使用大小为7×7的中值滤波器
的对图像滤波的结果；(e)使用S=7的自适应中值滤波器对图像滤波的结果
图5.14(c)显示了使用S=7的自适应中值滤波器的结果。噪声消除性能与中值滤波器相似。但是，
自适应滤波器在保持清晰度和细节方面的确做得要好。连接片几乎没有失真，使用中值滤波器时被模糊
第5章 图像复原与重建 211
或失真而无法识别的一些特征，在图5.14(c)中变得更尖锐和清楚。两个明显的例子是穿透主板的小白孔，
以及图像左下四分之一处有8根引脚的黑色器件。
考虑到图5.14(a)中的高水平噪声，自适应算法的性能已经非常好了。允许选择的最大窗口尺寸取决
于应用，但合理的初始值可以首先通过使用各种尺寸的标准中值滤波器进行实验来估计。这将根据自适
应算法的期望性能建立直观的基准。
5.4 用频率域滤波消除周期噪声
用频率域技术可以有效地分析并滤除周期噪声。其基本概念是在傅里叶变换中，周期噪声在对应于
周期干扰的频率处，以集中的能量脉冲形式出现。其方法是用一个选择性滤波器分离出噪声(见4.10节)。
在5.4.1节到5.4.3节中，为消除基本的周期噪声，将使用三种类型的选择性滤波器(4.10节中介绍过的
带阻、带通和陷波滤波器)。在5.4.4节中，我们还将介绍一种最佳陷波方法。
5.4.1 带阻滤波器
在4.10.1节中介绍的理想、布特沃斯和高斯带阻滤波器的传递函数总结在表4.6中。图5.15显示
了这些滤波器的透视图，并且，下面的例子说明了使用一个带阻滤波器降低周期噪声的效果。
a bc
u u
图5.15 从左到右依次为理想滤波器、布特沃斯滤波器(阶数为1)和高斯带阻滤波器的透视图
例5.6 使用带阻滤波器消除周期性噪声。
带阻滤波器的主要应用之一是在频率域噪声分量的一般位置近似已知的应用中消除噪声。一个典型
的例子就是一幅被加性周期噪声污染的图像，该噪声可被近似为二维正弦函数。不难看出，一个正弦波
的傅里叶变换由两个脉冲组成，它们是关于变换域坐标原点互为镜像的图像。它们的位置在表4.3中给出。
两个脉冲实际上都是虚的(正弦曲线的傅里叶变换的实部为零),而且彼此为复共轭。我们在5.4.3节和5.4.4
节中还将详述该主题。目前，我们的目的是先说明带阻滤波器。
图5.16(a)与图5.5(a)相同，显示了被不同频率的正弦噪声严重污染的图像。噪声分量很容易地被看
成是图5.16(b)中显示的傅里叶频谱中对称的亮点对。本例中，噪声分量位于关于变换原点的近似圆上，
因此使用圆对称带阻滤波器是一个正确的选择。图5.16(c)显示了一个4阶布特沃斯带阻滤波器，它设置
了适当的半径和宽度，完全包围了噪声脉冲。由于通常希望从变换中尽可能小地消除细节，因此在带阻
滤波中通常要求尖锐的窄滤波器。使用该滤波器对图5.16(a)滤波的效果显示在图5.16(d)中。其改进是非
常明显的。即使细小的细节和纹理也被这一简单的滤波方式有效地修复了。还应注意到，使用小卷积模
板的直接空间域滤波方法不可能取得相同的结果。
5.4.2 带通滤波器
带通滤波器执行与带阻滤波器相反的操作。在4.10.1节显示了如何通过式(5.4-1)使用传递函数为
HR(u,v)的带阻滤波器得到带通滤波器的传递函数HBp(u,v): 匿～8
212 数字图像处理(第三版)
HBp(u,v)=1-HBR(u,V) (5.4-1)
作为练习(见习题5.12),请读者根据表4.6中的带阻滤波器来推导对应的带通滤波器的表达式。
abcd|
图5.16 (a)被正弦噪声污染的图像：(b)图(a)的谱；(c)布特沃斯带阻
滤波器(白色代表1);(d)滤波的结果(原图像由NASA提供)
例5.7 使用带通滤波提取噪声模式。
通常不会在一幅图像上直接执行带通滤波，因为这样会消除
太多的图像细节。然而，带通滤波在一幅图像中屏蔽选中频段导
致的效果时非常有用。这是图5.17中的说明。产生这幅图像的方
法是：(1)应用式(5.4-1)得到与图5.16中使用的带阻滤波器相对应
的带通滤波器；(2)取带通滤波变换的反变换。使用这种方法会丢
失图像的大部分细节，不过保留的信息是非常有用的。显然，使
用这种方法复原的噪声模式与图5.16(a)中污染图像的噪声非常接
近。换句话说，带通滤波帮助屏蔽了噪声模式。这是一个有用的
结果，因为它简化了噪声分析，而与图像内容无关。
图5.17 由带通滤波获得的图5.16(a)
所示图像的噪声图案
5.4.3 陷波滤波器
陷波滤波器阻止(或通过)事先定义的中心频率的邻域内的频率。陷波滤波的公式详见4.10.2节。
图5.18分别显示了理想、布特沃斯和高斯陷波(带阻)滤波器的三维图。由于傅里叶变换的对称性，要
获得有效的结果，陷波滤波器必须以关于原点对称的形式出现。这个原则的特例是，如果陷波滤波器
位于原点处，在这种情况下，陷波滤波器是其本身。虽然为便于说明的目的，我们只列举了一对陷波
滤波器，但可实现的陷波滤波器的对数是任意的。陷波区域的形状也可以是任意的(例如矩形)。
遇：密
a b e H(u.D) H(u,t) H(u.0)
“
图5.18 (a)理想、(b)布特沃斯(2阶)和(c)高斯陷波(带阻)滤波器的透视图
如4.10.2节中描述的那样，我们可以得到通过而不是抑制陷波区域中所包含频率的陷波滤波器。
因为这些滤波器执行与陷阻滤波器完全相反的功能，故它们的传递函数由下式给出：
(5.4-2) Hnp(u,v)=1-Hnr(u,V)
式中，H(u,v)是陷波(带通)滤波器的传递函数，这个陷波(带通)滤波器与传递函数为H(u,v)的陷波(带
阻)滤波器相对应。
第5章 图像复原与重建 213
例5.8 用陷波滤波器消除周期性噪声。
图5.19(a)显示了与图4.51(a)相同的图像。以下的陷波滤波方法会降低该图像中的噪声，而不会引入
我们在4.8.4节中看到明显的模糊。除非因为该节我们讨论过的原因，模糊是我们所希望的，否则如果找
到了一个合适的滤波器，则陷波滤波会更好一些。
观察图5.19(a)中近似水平线的噪声模式，我们希望它在频率域内的成分沿垂直轴集中。然而，图5.19(b)
所示的谱是很显然的，噪声没有明显到具有足够清楚的模式。通过沿傅里叶变换的垂直轴构建一个简单的理
想陷波带通滤波器，我们可以得到噪声成分的外表特征的概念，如图5.19(c)所示。噪声模式的空间表示(陷
波带通滤波结果的反变换)示于图5.19(d)。这种噪声模式与图5.19(a)中的模式相对应。创建一个合适的
以合理的程度屏蔽噪声的陷波带通滤波器，我们可由式(5.4-2)获得相应的陷波带阻滤波器。使用陷波带
阻滤波器处理图像后的结果如图5.19(e)所示。该图像与图5.19(a)相比，包含有几乎看不见的噪声扫描线。
e
图5.19 (a)佛罗里达和墨西哥湾的卫星图像，显示有水平扫描线；(b)图(a)的谱：(c)叠加在图(b)
上的陷波带通滤波器；(d)空间噪声模式；(e)陷波带阻滤波的结果(原图像由NOAA提供)
5.4.4 最佳陷波滤波
作为周期性图像退化的另一个例子，图5.20(a)显示了“水手6号”飞船拍摄的一幅关于火星地
形的数字图像。其干扰模式与图5.16(a)中显示的有些相似，但前者的模式更为精细，因而在频率平
面上更难检测。图5.20(b)显示了该问题图像的傅里叶谱。类似星形的分量是由干扰引起的，而且存
在几对分量，指出该模式包含不止一个正弦分量。
当存在几种干扰分量时，前面几节讨论的方法有时就不能采用了，因为它们在滤波过程中可能
会消除太多的图像信息(当图像很特别或者很难获取时，很不希望有这种现象)。另外，干扰成分通常
不是单频脉冲。相反，它们通常有携带干扰模式信息的宽边缘。从正常的变换背景中有时不容易检测
到这些边缘。在许多应用中，降低这些退化影响时选择滤波方法将非常有用。这里讨论的方法是最佳
的，因为在一定意义上，它最小化了复原的估计值f(x,y)的局部方差。 芒;8
尚
214 数字图像处理(第三版)
a b
图5.20 (a)“水手6号”飞船拍摄的火星地形图像；(b)显示有周期干扰的傅里叶谱(图像由NASA提供)
该过程由两步组成，第一步屏蔽干扰的主要成分，然后从被污染的图像中减去该模式的一个可
变的加权部分。虽然我们是在一个特定的应用中来研究这一过程，但这个基本方法仍然十分通用，而
且能应用到其他复原工作中，在这些复原工作中，多周期性干扰是主要问题。
第一步是提取干扰模式的主频率分量。像之前那样，这可通过在每个尖峰处放置一个陷波带通
滤波器H(u,v)来完成。如果滤波器构建为只可通过与干扰模式相关的分量，那么干扰噪声模式的傅
里叶变换由下式给出：
N(u,v)=HNp(u,v)G(u,v) (5.4-3)
其中，如通常那样，G(u,v)仍为被污染图像的傅里叶变换。
H(u,v)的形式需要多方面判断哪些是尖峰噪声干扰。为此，通常要通过观察显示的G(u,v)的频
谱来交互地创建陷波带通滤波器。选择一个特殊滤波器之后，空间域中的相应模式可由下式获得：
η(x,y)=s?'{Hp(u,v)G(u,v}} (5.4-4)
因为被污染图像假设是由未污染图像f(x,y)与干扰相加形成的，若η(x,y)完全已知，则从g(x,y)减去
该干扰模式得到f(x,y)将是非常简单的事情。当然，问题是这个滤波过程通常只会得到真实干扰模
式的近似值。在η(x,y)的估计中不存在的那些分量的影响可以被最小化，方法是从g(x,y)中减去η(x,y)
的一个加权部分来得到f(x,y)的估计值，如下所示：
f(x,y)=g(x,y)-w(x,y(x,y) (5.4-5)
其中，如先前那样，f(x,y)是f(x,y)的估计值，而w(x,y)需要决定。函数w(x,y)称为加权函数或调
制函数，此过程的目的就是选取该函数，以便以某种有意义的方法来优化结果。一种方法是选取w(x,y).
使估计值f(x,y)在每一点(x,y)的指定邻域上的方差最小。
考虑关于点(x,y)的大小为(2a+1)(2b+1)的邻域。在坐标(x,y)处，f(x,y)的局部方差可根据样本
估计，如下所示：
o2x,)=(za+1X2b+ L[f(x+s,y+0-Paxy} (5.4-6)
其中，于(x,y)是该邻域内子的平均值，即
F(x,)=cza+)?b+DZfa+3,y+) (5.4-7)
在图像边缘上或接近图像边缘的点，可以用局部邻域或用0填充的方法处理。
把式(5.4-5)代入式(5.4-6),得
第5章 图像复原与重建 215
o2x=2a+1N?+∑lue(+5y+)- (5.4-8)
w(x+s,y+t)η(x+s,y+1)-[g(x,y)-w(x,yn(x,yl}2
假设w(x,y)在整个邻域内基本保持不变，则当-a≤s≤a和-b≤t≤b时，可给出近似式
w(x+s,y+1)=w(x,y) (5.4-9)
这一假设在该邻域内也可得出如下表达式：
W(x,y)n(x,y)=w(x,y)(x,y) (5.4-10)
由这些近似，式(5.4-8)变为
a2(x,y)=(2a+D)(2b+)Z∑ll8(x+S,y+)- (5.4-11)
w(x,y)η(x+s,y+1)]-1g(x,y)-w(x,y)(x,y)}2
为最小化o2(x,y),解下式得到w(x,y):
amxL=0 (5.4-12)
结果为
mx,)=x-7CmC" (5.4-13)
要获得复原图像f(x,y),可根据式(5.4-13)计算w(x,y),然后使用式(5.4-5)。如果w(x,y)在某一邻域
内假设为常量，则不必对图像中的每个x和y值计算该函数，而是在每个非重叠邻域的一点(一般为
中心点)计算w(x,y),然后将它用于处理该邻域内包含的所有图像点。
例5.9 最佳陷波滤波的说明。
图5.21 到图5.23显示了对图5.20(a)应用前述技术处理后的
效果。该图像的大小为512×512像素，并且选择了a=b=15
的邻域。图5.21 显示了被污染图像的傅里叶谱。在这种特殊情
况下，原点未移到频率平面的中心，因此u=v=0在图5.21所
示变换图像的左上角。图5.22(a)显示了N(u,v)的谱，其中只存
在尖峰噪声。图5.22(b)显示了取Nu,v)的傅里叶反变换得到的
干扰模式η(x,y)。注意，这个干扰模式与图5.20(a)中存在的噪
声结构很相似。最后，图5.23显示了应用式(5.4-5)处理后得到
的图像。出于实用的目的，周期干扰已被消除。
图5.21 图5.20(a)所示图像的(未移位的)
傅里叶谱(图像由NASA提供)
a b
图5.22(a)N(u,v)的傅里叶谱：(b)相应的噪声
干扰模式η(x,y)(图像由NASA提供) 图5.23 处理后的图像(图像由NASA提供) 圈：器
216 数字图像处理(第三版)
5.5 线性、位置不变的退化
图像复原前，图5.1中的输入/输出关系可以表示为
g(x,y)=H[f(x,y)]+η(x,y)
现在，让我们假设η(x,y)=0,则g(x,y)=H[f(x,y)]。基于2.6.2节的讨论，如果
H[af?(x,y)+bf?(x,y]=aH[f(x,y]+bH[f?(x,y]
(5.5-1)
(5.5-2)
则系统H是一个线性系统，其中a和b是标量，fx,y)和f?(x,y)是两
幅输入图像。
若a=b=1,则式(5.5-2)变为
关于线性系统理论的简要回
顾，请参阅本书的网站。
受：累
H[f?(x,y)+f?(x,y)]=H[f?(x,y]+H[f?(x,y] (5.5-3)
这就是所谓的加性。这一特性简单地表明，如果H为线性算子，那么两个输入之和的响应等于两个
响应之和。
如果f?(x,y)=0,则式(5.5-2)变为
H[af(x,y)]=aH[f(x,y)] (5.5-4)
我们称之为均匀性。它表明任何与常数相乘的输入的响应等于该输入响应乘以相同的常数，即一个线
性算子具有加性和均匀性。
一个算子对于任意fx,y),a和p,如果
H[f(x-α,y-β)]=g(x-α,y-β) (5.5-5)
则输入/输出关系具有g(x,y)=Hf(x,y)]的算子称为位置(或空间)不变系统。该定义说明图像中任意一
点处的响应只取决于该点处的输入值，而与该点的位置无关。 关于连续与离散变量的讨论，请 在式(4.5-3)中，稍微(等效)改变一下离散冲激函数定义的符号，
就可将f(x,y)表示为
f(x,)=__f(a,B)8(x-a,y-β)da dβ
参阅5.11.3节的脚注。
(5.5-6)
再次假设η(x,y)=0,然后把式(5.5-6)代入式(5.5-1)可得
8(x,)=H[f(x,yJ=A[[Jf(a,Bs(x-a.y-B)da dB] (5.5-7)
如果H是线性算子，且我们把加性性质扩展到积分，则有
g(x,)=H[f(a,B)δx-a,y-B]da dβ (5.5-8)
由于f(α.β)独立于x和y.使用均匀性可得
8(x,y=_f(a,B)H[8(x-a,y-B]da dβ (5.5-9)
公式
h(x,α,y.β)=H[8(x-α,y-β)] (5.5-10)
称为系统H的冲激响应。也就是说，在式(5.5-1)中，如果η(x,y)=0,则hx,α,y.β)是系统H对坐
第5章 图像复原与重建 217
标(x,y)处的一个冲激的响应。在光学中，冲激为一个光点，所以h(x,α,y.β)通常称为点扩散函数
(PSF)。这一名称来自于这样一个事实，即所有物理光学系统在一定程度上会模糊(扩散)光点，模糊
程度由光学部件的质量决定。
将式(5.5-10)代入式(5.5-9),可得
8(x,y=?[_f(a,B)h(x,a,y,B)dadβ (5.5-11)
这称为第一类叠加(弗雷德霍姆)积分。该表达式是线性系统理论核心中的一个基础结果。它表明，如
果系统H对一个冲激的响应已知，则对于任意输入f(α,β)的响应可用式(5.5-11)来计算。换句话说，
线性系统H完全可由其冲激响应来表征。
如果H是位置不变的，由式(5.5-5)可得
H[8(x-α,y-β)]=h(x-α,y-β) (5.5-12)
在这种情况下，式(5.5-11)简化为
g(x,y)=J__f(a,β)h(x-a,y-β)dαdβ (5.5-13)
该式为式(4.2-20)对一个变量的卷积积分，并在习题4.11 中扩展到2维。该积分告诉我们，对于任意
输入f,若已知线性系统的冲激响应，就可以计算出它的响应g。结果是冲激响应和输入函数的简单
卷积。
在有加性噪声的情况下，线性退化模型[见式(5.5-11)]的表达式变为
8(x,y)=[_f(a,B)h(x,a,y.B)da dβ+n(x,y) (5.5-14)
如果H是位置不变的，则式(5.5-14)变为
8(x,y=?[?[f(a,B)h(x-a,y-B)da dB+n(x,y) (5.5-15)
噪声项η(x,y)的值是随机的，并假设这些噪声项与位置无关。使用常用的卷积符号，可将式(5.5-15)
写为
g(x,y)=h(x,y)★f(x,y)+η(x,y) (5.5-16)
或者基于卷积定理(见4.6.6节),我们可在频率域中将它表示为
G(u,v)=H(u,v)F(u,v)+N(u,v) (5.5-17)
这两个表达式与式(5.1-1)和式(5.1-2)是一致的。记住，对于离散值来说，所有的乘积是逐项相乘的。
例如.H(u,v)F(u,v)的j项是Hu,v)的j项和F(u,v)的j项的乘积。
总之，前述讨论表明，具有加性噪声的线性空间不变退化系统，可在空间域建模为退化(点扩散)
函数与一幅图像的卷积，然后再加上噪声。基于卷积定理，在频率域中，同样的过程可表示为图像和
退化函数的变换的乘积，然后再加上噪声的变换。在频率域中工作时，可以使用4.11节中讨论的一
种FFT算法。还应记住，如4.6.6节所述，在实现离散傅里叶变换时，需要对函数进行填充。
许多类型的退化可近似为线性、位置不变的过程。这种方法的优点是可以使用许多线性系统理
论的工具来解决图像复原问题。与位置有关的非线性技术虽然更普遍(通常会更精确),但它们会带来
没有已知解的困难，或者解决计算问题时非常困难。本章将集中在线性、空间不变的复原技术上。由
于退化被建模为卷积的结果，并且图像复原试图找到应用相反过程的滤波器，所以术语图像去卷积通
常用于表示线性图像复原。同样，用于复原处理的滤波器常常称为去卷积滤波器。 嚣：物
爵：匿
218 数字图像处理(第三版)
5.6 估计退化函数
在图像复原中，主要有3种用于估计退化函数的方法：(1)观察法，(2)试验法，(3)数学建模法。
以下几节将讨论这些方法。使用以某种方式估计的退化函数来复原一幅图像的过程，有时称为盲目去
卷积，因为真正的退化函数很少能完全知晓。
5.6.1 图像观察估计
假设给我们一幅退化图像，而没有关于退化函数H的任何知识。基于图像被线性、位置不变的过程
退化的假设，估计H的一种方法就是从图像本身来收集信息。例如，如果图像已被模糊，则我们可以观
察图像中包含样本结构的一个小矩形区域，如某一物体和背景的一部分。为了降低噪声的影响，我们可
以寻找一个有很强信号内容的区域(如高对比度区域)。下一步是处理子图像以便得到尽可能不模糊的结
果。例如，我们可以使用锐化滤波器对这个子图像进行锐化处理，甚至可以使用手工方法处理小区域。
令g(x,y)表示要观察的子图像，令，(x,y)表示处理过的子图像(现实中，该图像是原图像在该区域
的估计图像)。然后，假设噪声的影响由于选择了一个强信号区域而可以忽略，根据式(5.5-17)可得
B,u)=G (5.6-1)
根据这一函数特性，然后，我们可基于位置不变的假设还原完整的退化函数Hu,v)。例如，假设H(u,v)
的径向曲线具有高斯曲线的近似形状。我们可以利用这一信息在更大比例上构建一个有基本相同形状
的函数H(,v)。然后，在下面几节讨论的一种复原方法中使用H(u,v)。很清楚，这是仅在特殊环境
下使用的很麻烦的处理，例如复原一幅有历史价值的老照片。
5.6.2 试验估计
如果可以使用与获取退化图像的设备相似的装置，从理论上讲，得到一个准确的退化估计是可
能的。与退化图像类似的图像可以通过各种系统设置得到，直到这些图像退化到尽可能接近我们希望
复原的程度。之后，概念是使用相同的系统对一个冲激(小亮点)成像，得到退化的冲激响应。正如5.5
节所表明的那样，线性空间不变系统完全由其冲激响应来表征。
一个冲激可由一个亮点来模拟，该点应尽可能亮，以便将噪声的影响降低到可以忽略的程度。
回顾一下，由于冲激的傅里叶变换是一个常量，由式(5.5-17)可得下式：
H(u,)=GuA (5.6-2)
其中，与之前一样，函数G(u,v)是观察图像的傅里叶变换，A是一个描述冲激强度的常量。图5.24显
示了一个例子。
a b
图5.24 冲激特性的退化估计：(a)一个亮冲激(放大显示);(b)图像处理(退化)后的冲激
第5章 图像复原与重建 219
5.6.3 建模估计
由于退化建模能解决图像复原问题，因此多年来一直被人们使用。在某些情况下，模型甚至可
以考虑引起退化的环境条件。例如，由Hufnagel和 Stanley[1964]提出的退化模型是基于大气湍流的
物理特性的。该模型的通用形式为
H(u,v)=eu2+2 (5.6-3)
其中，k是与湍流的性质有关的常数。除了指数为5/6幂之外，该式与4.8.3节所述的高斯低通滤波有
相同的形式。事实上，高斯LPF有时用于模型淡化，均匀模糊。图5.25显示了使用式(5.6-3)并取k=
0.0025(剧烈湍流)、k=0.001(中等湍流)和k=0.000 25(轻微湍流)来模拟模糊一幅图像时得到的例
子。所有图像的大小均为480×480像素。
a b
cd
图5.25 大气湍流模型的说明：(a)可忽略的湍流；:(b)剧烈湍流，k=0.0025;(c)
中等湍流，k=0.001;(d)轻微湍流，k=0.000 25(原图像由NASA提供)
建模的另一个主要方法是从基本原理开始推导一个数学模型。我们通过详细讨论一个实例来解
释这一过程。在这个实例中，图像获取时被图像与传感器之间的均匀线性运动模糊了。假设图像
f(x,y)进行平面运动，x。(1)和y.(t)分别是在x和y方向上随时间变化的分量。那么,在记录介质(如
胶片或数字存储器)任意点的曝光总数是通过对时间间隔内瞬时曝光量的积分得到的，图像系统的快
门在该时间段是开着的。假设快门的开启和关闭所用时间非常短，那么光学成像过程不会受到图像运
动的干扰。若设T为曝光时间，则有
8(x,y=)'flx-xo(0).y-?d (5.6-4)
其中，g(x,y)为模糊后的图像。
由式(4.5-7),式(5.6-4)的傅里叶变换为 黑引
220 数字图像处理(第三版)
Gu,)=??_g(x,y)e prtdrdy
(5.6-5) =[rLx-x60.y-?drledrdy
改变积分顺序，式(5.6-5)可表示为
Gu,D)=J。[flx-x(0),y-y?Je-ptdardy d (5.6-6)
外层方括号内的积分项是位移函数flx-xo(t),y-yo[0]的傅里叶变换。利用式(4.6-4)可得到表达式
Gu,v)=?'Fu,vyeDm}F(u,?ems0+%d (5.6-7)
这里，最后一步是根据F(u,v)与t无关得出的。
令
H(u,)=?e-0+0d (5.6-8)
式(5.6-7)可表示为我们熟悉的如下形式：
G(u,v)=H(u,v)F(u,v) (5.6-9)
若运动变量x(t)和y(D已知，则可直接由式(5.6-8)得到传递函数H(u,v)。作为一个说明，假设问题中的
图像只在x方向以给定的速度x(t)=a/T做匀速直线运动。当t=T时，图像位移的总距离为a。令y,(t)=0.
由式(5.6-8)可得
H(u,)=?。ePm?d=?'ePTd=Tsin(uale (5.6-10)
上式表明，由u=nla给出的u值处，H变为零，其中n为整数。若允
许y分量也随着变化，按y?=b/T给出的运动，则退化函数变为
Hu,)=+)sinliua+vb]e (5.6-11)
例5.10 由于运动引起的图像模糊。
图5.26(b)是由计算图5.26(a)中图像的傅里叶变换模糊的一幅图像，其过程是用式(5.6-11)中的H(u,D)
乘以变换，再做反变换。图像大小为688×688 像素，在式(5.6-11)中使用的参数为a=b=0.1和T=1。
正如5.8节和5.9节所讨论的那样，从模糊图像中复原出相应的原图像会存在某些有趣的挑战，特别是当
退化图像中存在噪声时。
如表4.3结尾处解释的那样。我
们使用u和v来对式(5.6-11)取样。
以便生成一个离散滤波器。
m;3
a b Digital
Image
Processing
图5.26 (a)原图像；(b)使用式(5.6-11)中的函数，且a=b=0.1和T=1模糊图像后的结果
第5章 图像复原与重建 221
5.7 逆滤波
本节的内容是研究由退化函数H退化的图像复原的最初手段。退化函数已给出，或由前一节讨
论的那些方法获得。最简单的复原方法是直接做逆滤波，在这里，我们用退化函数除退化图像的傅里
叶变换G(u,v)来计算原始图像傅里叶变换的估计F(x,y),即
Fu,)=Gu,y (5.7-1)
该除法是阵列操作，正如2.6.1节中定义的那样，并联系式(5.5-17)。用式(5.1-2)的右侧替代式(5.7-1)
中的G(u,v),得到
Fu,D)=Fu.D)+, (5.7-2)
这是一个有趣的表达式。它告诉我们，即使知道退化函数，也不能准确地复原未退化的图像[F(u,v)的傅
里叶反变换],因为Nu,v)未知。还有更糟的情况，如果退化函数是零或是非常小的值，则Nu,vVH(u,v)
之比很容易支配估计值F(u,v)。事实上，这是经常出现的情况，下面很快会证明这一点。
解决退化函数为零或为非常小的值的问题的一种方法是限制滤波的频率，使其接近原点。从
式(4.6-21)的讨论，我们知道H(0,0)在频率域中通常是H(u,v)的最高值。因此，通过将频率限制在原
点附近分析，就减少了遇到零值的概率。下面的例子中说明了这种方法。
例5.11 逆滤波。
图5.25(b)是对产生退化图像的退化函数精确取反，并使用式(5.7-1)反向滤波的图像。也就是，使用
的退化函数是
H(u,D)=e+[u-M/2]2+(-N/2r]“
其中k=0.002 5。M/2和N2常数是偏移值；它们使函数居中，以便与居中的傅里叶变换对应，就像前一
章中多次讨论过的那样。在这个例子中，M=N=480。我们知道，高斯形函数没有零值，因此这里不用关
心它。然而，尽管如此，退化值变得非常小，以至于全逆滤波的结果[见图5.27(a)]毫无用处。产生这
个失败结果的原因正如式(5.7-2)所讨论的那样。
a bcd
图5.27 用式(5.7-1)复原图5.25(b):(a)用全滤波器的结果；(b)截止半径为
40时用H的结果；(c)半径为70时的结果；(d)半径为85时的结果
图5.27(b)到图5.27(d)显示了比率G(u,v)H(u,v)的截止值的结果，半径分别为40,70和85。截止是
通过对这个比值应用一个阶数为10的布特沃斯低通函数来实现的。这在期望的半径处提供了较尖锐(但
平滑)的过渡。半径在70左右时视觉效果最好[见图5.27(c)],半径在70以下时图像开始变得模糊，如
图5.27(b)所示，它是用半径40得到的。其值大于70时，图像开始退化，如图5.27(d)所示，它是用半径
85 得到的。在噪声“窗帘”后面的图像中，图像的内容几乎是可见的，但噪声明显地支配着该结果。进
一步增大半径值，会使得图像越来越像图5.27(a)。 比
33
222 数字图像处理(第三版)
这个例子的结果表明，一般直接逆滤波的性能是较差的。接下来的三节将探讨怎样改进直接逆
滤波的性能。
5.8 最小均方误差(维纳)滤波
前一节讨论的逆滤波方法并没有清楚地说明怎样处理噪声。在这一节，我们讨论一种综合了退
化函数和噪声统计特征进行复原处理的方法。该方法建立在图像和噪 注意整个图像都被考虑为随机变 声都是随机变量的基础上，目标是找到未污染图像f的一个估计子. 量，详见2.6.8节末尾的讨论。
使它们之间的均方误差最小。这种误差度量由下式给出：
e2=E{f-)2} (5.8-1)
其中，E(-}是参数的期望值。这里假设噪声和图像不相关，其中一个或另一个有零均值，且估计中的
灰度级是退化图像中灰度级的线性函数。基于这些条件，式(5.8-1)中误差函数的最小值在频率域中
由如下表达式给出：
as,ar+ScsyP+,as,ayc
P+Saly/Scu (5.8-2)
这里，我们用了这样一个事实：一个复数量与其共轭的乘积等于该复数量幅度的平方。这个结果就是
众所周知的维纳滤波，该概念由N.Wiener[1942]首次提出。由方括号中的项组成的滤波器通常也称为
最小均方误差滤波器或最小二乘误差滤波器。本章最后列出了一些参考资料，包括了维纳滤波器的详
细推导过程。注意式(5.8-2)的第一行，维纳滤波器没有逆滤波中退化函数为零的问题，除非对于相
同的u值和v值，整个分母都是零。
式(5.8-2)中各项的意义如下所示：
H(u,v)= 退化函数
H*(u,V)=H(u,v)的复共轭
IH(u,v)l2=H*(u,v)H(u,V)
S,(u,V)=IN(u,v)I2=噪声的功率谱[见式(4.6-18)]①
S,(u,v)=IF(u,v)l2= 未退化图像的功率谱
与前面一样，H(u,v)是退化函数的变换，而G(u,v)是退化图像的变换。空间域中复原的图像由频
率域估计F(u,v)的傅里叶反变换给出。注意，如果噪声为零，则噪声功率谱消失，并且维纳滤波简
化为逆滤波。
许多有用的度量是以噪声和未退化图像的功率谱为基础的，其中最重要的一种是信噪比，它在
频率域中用下式来近似：
(5.8-3)
①项W(n,D)P也称为噪声的自相关。该术语源自相关定理(见表43中的性质7)。当两个函数相同时，两个函数的相关就变成了自相
关，该性质的右侧变成N*(n,DN(n,),它等于IF(n,vP。类似的说明同样适用于IF(n,)P,即它是图像的自相关。第12章中
将详细探讨相关
第5章 图像复原与重建 223
该比值给出了携带信息的信号功率(即原始的或退化的原图像)水平与噪声功率水平的度量。携带低
噪声的图像有较高的 SNR,而携带较高噪声水平的同一幅图像有较低的 SNR。这一比值是一个有限
的值，但在用于表征复原算法的性能时它是一个重要的度量。
式(5.8-1)中以统计形式给出的均方误差，也可描述为涉及原图像和复原图像的和的形式：
MSE=ZZ[r(xy)-jux]2 (5.8-4)
事实上，如果把复原图像考虑为“信号”,而把复原图像和原图像的差考虑为噪声，那么我们可以将
空间域中的信噪比定义为
(5.8-5)
f和子越接近，该比值就较大。有时，用这一度量的均方根来代替，这种情况，该比值称为均方根信
噪比或均方根误差。正如以前我们多次提到的那样，必须记住该定量度量与感觉的图像质量并没有很
好的必然关系。
当我们处理白噪声时，谱INu,v)IP2是一个常数，这大大简化了处理。然而，未退化图像的功率谱很
少是已知的。当这些量未知或不能估计时，经常使用的一种方法是由下面的表达式来近似式(5.8-2):
Fuy)-P+ cu. (5.8-6)
式中，K是一个加到H(u,V)P的所有项上的特定常数。下面的几个例子说明了这一表达式的应用。
例5.12 逆滤波和维纳滤波的比较。
图5.28说明了维纳滤波与直接逆滤波相比的优点。图5.28(a)是图5.27(a)的全逆滤波的结果。类似地，
图5.28(b)是图5.27(c)的半径受限的逆滤波结果。为便于比较，这里重新列出了这些图像。图5.28(c)显示
了使用式(5.8-6)通过例5.11中使用的退化函数得到的结果。K值的交互式选择是为了找到最好的视觉效
果。在这个例子中，与直接逆滤波方法相比，维纳滤波的效果显然更好。比较图5.25(a)和图5.28(c),我
们会发现维纳滤波的结果非常接近原图像的外观。
a b c
图5.28 逆滤波和维纳滤波的比较：(a)图5.25(b)的全逆滤波
结果；(b)半径受限的逆滤波结果；(c)维纳滤波的结果
例5.13 维纳滤波的进一步比较。
图5.29的第一行从左到右分别显示了被均值为零、方差为650的加性高斯噪声严重污染的图5.26(b)
的模糊图像，直接逆滤波的结果，以及维纳滤波的结果。用式(5.8-6)的维纳滤波，通过例5.10的H(u,v) :3
3：3
224 数字图像处理(第三版)
和交互地选择K,可以得到最好的视觉效果。正如所期望的那样，逆滤波产生了一幅不太适用的图像。
注意，逆滤波后的图像中的噪声非常强，以至于它的结构就在去模糊滤波器的方向上。维纳滤波的结果
并不完美，但它的确给了我们一些关于图像内容的线索。要辨认图中的文字，还是有点难度。
图5.29的第二行显示了同样的序列，但噪声方差的水平降低了一个数量级。这种降低对逆滤波没有
多少影响，但维纳滤波的效果明显改进了，图中的文字容易辨认多了。图5.29的第三行相对于第一行噪
声方差降低了5个数量级。事实上，图5.29(g)中的图像已没有可见的噪声。在这种情况下，逆滤波的结
果相当有趣。噪声仍很明显，但是文字能通过噪声“窗帘”看见。这是关于式(5.7-2)的一个很好的例子。
换句话说，正如从图5.29(h)可明显看到的那样，逆滤波消除图像模糊的能力是很强的。然而，噪声
还是支配着结果。即使我们能看到图5.29(b)和图5.29(e)中噪声背后的内容，但字符还是显得有点模
糊。图5.29(i)中的维纳滤波结果是最好的，视觉上非常接近于图5.29(a)中的原图像。只要退化函数的合
理估计是可用的，这些类型的结果就是使用维纳滤波可能得到的结果。
gl
m
esS
Dicatal
fmage
Po0essing
Digital
0ag Image
cesSIg Processing
图5.29(a)由运动模糊和加性噪声污染的8比特图像；(b)逆滤波的结果；(c)维纳滤波的结果；
(d)-(4)同样的图像序列，但噪声方差降低了一个数量级；(g)-(i)同样的图像序列，但噪声方
差比图(a)中的噪声方差降低了5个数量级。注意图(h)去模糊图像透过噪声“窗帘”清晰可见
5.9 约束最小二乘方滤波
关于退化函数H的某些知识必须已知的问题，对于本章讨论的所有方法是很常见的。然而，维
纳滤波却存在一些其他的困难：未退化图像和噪声的功率谱必须是已知的。在前面的章节中已显示出，
使用式(5.8-6)给出的近似方法能得到很好的结果。然而，功率谱比的常数估计并不总是一个合适的解。
本节讨论的方法仅要求噪声方差和均值的知识。正如5.2.4节讨论的那样，这些参数通常可从一
幅给定的退化图像计算出来，因此这是一个很重要的优点。另一个不同是，维纳滤波建立在最小化统
计准则的基础之上，因此在平均意义上它是最优的。本节给出的算法具有显著的特点，即对于其应用
到的每一幅图像都能产生最优结果，当然，这些理论上满足的最优准则与动态的视觉感知并没有关系。
因此，算法的选择往往由结果图像的视觉感知质量决定(至少部分是这样的)。
第5章 图像复原与重建 225
通过使用式(4.6-23)给出的卷积定义，并像2.6.6节解释的那样，我们可将式(5.5-16)表达为如下
向量-矩阵形式： 关向量和矩阵的简要回
(5.9-1) 顾，请查阅本书的网站。 g=Hf+n
例如，假设g(x,y)的大小为M×N。然后，我们可以使用g(x,y)的第一行中的图像元素构成向量g的
第一组N个元素，从第二行构成下一组N个元素，依此类推。结果向量将有MN×1维。这也同样是
f和η的维数，因为这些向量是以同样的方式构成的。矩阵H有MN×MN维，其元素由式(4.6-23)中
的卷积元给出。
把图像复原问题简化为简单的矩阵操作的结论看起来很合理。遗憾的是，事实上并非如此。例
如，假设我们正在处理一幅中等大小的图像，譬如大小为M=N=512,那么式(5.9-1)中的向量为
262144×1维，矩阵H为262 144×262144维。计算这种大小的向量和矩阵并不是一件简单的任务。
由于H对噪声高度敏感，因此问题被进一步复杂化(在前面两节中我们已了解到噪声的影响，因此对
此不应感到奇怪)。然而，明确地以矩阵形式来表达复原问题确实可以简化复原技术的推导。
尽管我们不能完全推导已存在的约束最小二乘法，但这种方法在矩阵表示法中的确有它的根源。
在本章的最后会给出参考资料，涵盖详细推导的来源。该方法的核心
使代数技术来进行图像复 是H对噪声的敏感性问题。减少噪声敏感性问题的一种方法是以平滑 原的整章内容，请查阅本书网站上 度量的最佳复原为基础的，如一幅图像的二阶导数(“拉普拉斯变换” 的Tutorials部分
这位“老朋友”)。意味深长的是，必须用手边问题的参数来约束复
原。因此，我们的期望是找一个最小准则函数C,定义如下：
c-22Lvras] (5.9-2)
其约束为
|g-al2=Iml2 (5.9-3)
其中，|wl2AwIw是欧几里得向量范数①,子是未退化图像的估计。拉普拉斯算子V2在式(3.6-3)中
定义过。
这个最佳化问题在频率域中的解决由下面的表达式给出：
Fu.=.DP+ypuPcu.) (5.9-4)
其中，γ是一个参数，必须对它进行调整以满足式(5.9-3)的条件，P(u,v)是函数
(5.9-5)
的傅里叶变换。在3.6.2节中介绍拉普拉斯算子时我们曾见过这个函数。如早些时候注意到的那样，
记住，p(x,y)和所有其他相关的空间域函数很重要，在用式(5.9-4)计算其傅里叶变换之前要用零进
行适当的填充，正如4.6.6节所讨论的那样。注意，当γ为0时，式(5.9-4)简化为逆滤波。
w'w-∑· ①回忆可知，对于有着n个元素的向量w,有w ,中中w是w的第k个元素。 退;圈
226 数字图像处理(第三版)
居;
例5.14 维纳滤波和最小二乘方滤波的比较。
图5.30显示了使用约束最小二乘方滤波处理图5.29(a)、图5.29(d)和图5.29(g)的结果，为产生最好的
视觉效果，γ的值是手工选择的。使用同样的过程，产生的维纳滤波结果如图5.29(c)、图5.29(f)和图5.29(i)
所示。比较约束最小二乘方滤波和维纳滤波的结果，发现前者对于高噪声和中等噪声的情况，产生的结
果要稍好一些，而对于低噪声情况，两种滤波产生基本相等的结果。当手工选择参数以取得更好的视觉
效果时，约束最小二乘方滤波的效果有可能比维纳滤波的效果更好。式(5.9-4)中的参数γ是一个标量，
而式(5.8-6)中的K值是两个未知频率域函数的近似比，该比值很少是常数。因此，手工选择γ将得出未
退化图像的更为准确的估计。
Digital Diigital
ln3ae Image Image
Poxessing PioCessing Processing
a b c
图5.30 约束最小二乘方滤波的结果。请将图5.29(c)、图5.29(1)和
图5.29(i)所示的维纳滤波结果分别与图(a)、图(b)和图(c)比较
如前面的例子所示，交互地调整参数γ达到可接受的结果是可能的。然而，如果我们对最优化感
兴趣，那么就必须调整参数γ以满足式(5.9-3)中的约束条件。迭代计算γ的过程如下。
定义一个“残差”向量r为
r=g-Hj (5.9-6)
因为，由式(5.9-4)的解可知，F(u,v)(即隐含的子)是γ的函数，所以r也是该参数的函数。可以证
明(Hunt[1973])
φ(y)=rTr=Irl2 (5.9-7)
是γ的单调递增函数。我们要做的是调整γ使得
lrl2=1m2±a (5.9-8)
其中，a是一个精确度因子。在式(5.9-6)看来，如果|rl2=|n2,那么式(5.9-3)的约束就严格满足了。
因为φ(Y)是单调的，所以寻找满足要求的γ值并不困难。一种方法是
1.指定γ的一个初始值。
2.计算Irl2。
3.若满足式(5.9-8),则停止；否则，若Pl2<ml2-a,则增大γ,若IPl2>|ml2+a,则减小γ,
然后返回步骤2。使用γ的新值，通过式(5.9-4)重新计算最佳估计F(u,v)。
其他的方法，譬如牛顿-拉弗森算法，也可用于改进收敛的速度。
为了使用这一算法，我们需要IF2和|2的值。为了计算Irl2,由式(5.9-6)得
R(u,v)=G(u,v)-H(u,v)F(u,v) (5.9-9)
由此，我们可以通过计算R(u,v)的傅里叶反变换得到r(x,y)。然后有
P=222( (5.9-10)
第5章 图像复原与重建 227
计算|m2可以得出一个重要的结果。首先，考虑整幅图像上的噪声方差，该方差可以使用取样平均的
方法来估计，如3.3.4节讨论的那样：
?_[nC,]-m, (5.9-11)
其中，
m-Z2nx,) (5.9-12)
是样本均值。参考式(5.9-10)的形式，我们注意到式(5.9-11)中的双重求和等于n2。这就给出了如
下表达式：
ml2=MN[o}+m2] (5.9-13)
这是非常有用的结果。它告诉我们，仅仅用噪声均值和方差的知识我们就可以实现一个最佳复原算法。
这些值并不难估计(见5.2.4节),但要假设噪声和图像灰度值不相关。这是本章讨论的所有方法的一
个基本假设。
例5.15 最佳约束最小二乘方滤波的迭代估计。
图5.31(a)显示了使用刚才描述的算法来估计用于复原图5.25(b)的最佳滤波得到的结果。γ的初始值
是103,调整γ的校正因子是10?, a的值为0.25。用于生成图5.25(a)的指定噪声参数相同：噪声方差为
10?,均值为0。复原结果几乎与图5.28(c)一样好，图5.28(c)是由维纳滤波得到的结果，为得到最好的视
觉效果，手工指定了K值。图5.31(b)显示了使用噪声参数的错误估计值时发生的情况。在这种情况下，
指定的噪声方差为102,并且均值保留为0。在这种情况下，结果有相当大的模糊。
a b
图531(a)对图5.16(b)使用正确的噪声参数迭代确定的约束最小二乘方复原；(b)使用错误的噪声参数得到的结果
正如本节开始指出的那样，约束最小二乘方意义下的最佳复原在视觉效果上并不意味着最好。
根据退化和噪声的性质及大小，算法中交互确定最佳估计的其他参数，在最终结果中也起着很重要的
作用。通常，自动确定的复原滤波器比人为调整滤波器参数的复原结果要差。特别是约束最小二乘方
滤波器完全由单一的标量参数来决定时更是如此。
5.10 几何均值滤波
可对5.8节中讨论的维纳滤波器稍加推广。这种推广就是所谓的几何均值滤波器的形式：
(5.10-1)
其中，α和β是正的实常数。几何均值滤波器由两个括号内的幂次分别为α和1-α的表达式组成。 密
384
228 数字图像处理(第三版)
当α=1时，该滤波器退化为逆滤波器；当α=0时，该滤波器变为所谓的参数维纳滤波器，参
数维纳滤波器在β=1时还原为标准的维纳滤波器。如果α=1/2,则滤波器变成相同幂次的两个量的
积，这是几何均值的定义，这样就给出了这种滤波器的命名。当β=1时，随着α减小到1/2 以下，
滤波器的性能越来越接近逆滤波器。类似地，当α增大到1/2 以上时，滤波器更接近维纳滤波器。当
α=1/2且β=1时，该滤波器通常也称为谱均衡滤波器。式(5.10-1)在实现复原滤波时非常有用，因
为它表示了合并为单个表达式的滤波器族。
5.11 由投影重建图像
在本章的前几节中，我们讨论了各种复原退化图像的技术。在这一节，我们研究从一系列投影
重建一幅图像的问题，集中讨论X射线计算机断层(CT)。这是最早 如第1章注释的那样，通常也用
且应用最广泛的CT 类型，也是当前数字图像处理在医学中的主要应 术语计算机轴向断层术(CAT)来表
示CT。 用之一。
5.11.1 引言
重建问题在原理上很简单，并且可以直接用直观的定性方法加以描述。首先，考虑图5.32(a),
它由均匀背景上的单一物体组成。它的物理意义可解释如下：假设该图像是人体三维区域的一个横断
面。还假设图像中的背景表示均匀的软组织，它所环绕的物体是一个肿瘤，该肿瘤也是均匀的，但有
较高的吸收特性。
接着，如图5.32(a)所示，假设我们用一束细的、平行的X射线从左到右扫描(通过图像平面),
并且假设物体吸收的射线束能量比背景吸收的射线束能量多，这是典型的情况。利用放在该区域另一
端的X射线吸收检测器带将产生所示的信号(吸收断面图)。该信号的幅度(亮度)与吸收成正比。我
们能够观察到信号中的任意一点都是所穿过的相应空间点的该射线束中单一射线吸收值的和(这样的
和通常称为射线和)。这时，有关物体的所有信息就是这个一维的吸收信号。
由单个投影，我们无法确定沿着射线路径处理的是单个物体还是多个物体，但我们可以仅基于
这一信息来创造一幅图像的方法开始重建。如图5.32(b)所示，该方法是沿着射线来的方向把一维信
号反投影回去。穿过二维区域的一维信号的反投影过程有时可想象为把投影穿过该区域反“涂抹”回
去。在数字图像中，这意味着沿垂直于射线方向复制横穿图像的相同的一维信号。例如，图5.32(b)
就是由复制矩形图像的所有列中的一维信号创建的。显然，刚刚描述的方法就称为反投影法。
接着，假设我们把源-检测器对的位置旋转90°,如图5.32(c)所示。重复前段解释的步骤，在垂
直方向生成一幅反投影图像，如图5.32(d)所示。我们把这一结果加到前边的反投影图像上继续重建
工作，结果如图5.32(e)所示。现在，我们可以说我们感兴趣的物体已包含在所示的方形中了，其幅
度是单个投影幅度的两倍。稍加思考后，就会了解使用刚刚讨论的方法得到更多的视图，我们应能得
到关于物体形状的更多信息。事实上，如图5.33所示，所发生的情况说明这是正确的。随着投影数量
的增加，不相交反投影的强度相对于多个反投影相交区域的强度将降低。最终结果是，较亮区域将支
配结果，当为显示而调节亮度时，很少或没有相交的反投影将减弱为背景。
由32个投影形成的图5.33(f)说明了这一概念。然而，应注意，尽管这幅重建的图像是对原始物
体形状的较好近似，但该图像却被“晕环”效应所模糊，关于该信息可在图5.33中渐进的步骤中看到。
①关于X 射线源和检测器的物理知识超出了我们探讨的范围，我们的讨论主要是CT的图像处理。关于X射线图像形成的物理
原理，请参阅Prince and Links{2006]。
第5章 图像复原与重建 229
例如，图5.33(e)中“晕环”以星状形式出现，其亮度比物体低，但又比背景高。当视图数目增加时，
“晕环”的形状变成一个圆，如图5.33(f)所示。在CT重建中，模糊是一个重要问题，其解决办法将
在5.11.5节讨论。最后，从图5.32和图5.33的讨论，我们得出结论：相隔180°的投影互为镜像图像，
因此，为了产生重建所要求的所有投影，我们只要按圆周的一半角度增量来考虑就可以了。
de 吸收剖面
光束
-射线 检测器带
图5.32 (a)显示一个简单物体的平坦区域，一个输入的平行射线束，一个检测器带；(b)感
知条带数据的反投影的结果(即一维吸收剖面);(c)旋转90°后的射线束和检测器；
(d)反投影；(e)图(b)和图(d)的和。反投影相交处的亮度是各个反投影的亮度的两倍
a bc d e f
图5.33(a)与图5.32(a)相同的图像；(b)~(e)使用间隔为45°的1、2、3、4个
反投影的重建；(1)间隔5.625的32个反投影的重建(注意模糊效果)
例5.16 包含两个物体的简单平面的反投影。
图5.34说明了稍微复杂一些的区域的反投影法重建，该区域包含两个具有不同吸收特性的物体。
图5.34(b)显示了用一个反投影的结果。我们注意到该图的三个主要特性，从下到上：一个细的水平灰色带
与小物体还不能最后断定的部分相对应；在它上边较亮的条带(吸收更多)对应于由两个物体共享的区域；
以及对应于椭圆物体剩余部分的上边的条带。图5.34(c)和图5.34(d)分别显示了使用相隔 90°的两个投影 萬:
爱兽
230 数字图像处理(第三版)
和相隔45°的4个投影的重建。这些图形的解释类似于对图5.33(c)到图5.33(e)的讨论。图5.34(e)和(f显
示了分别使用32个和64个反投影的更精确的重建。这两个结果在视觉上非常接近，而且两者都显示了
之前提到的模糊问题，模糊问题的解决办法将在5.11.5节中讨论。
ae
图5.34(a)有两个物体的区域；(b)-(d)用相隔90°的1、2和相隔45°的4个反投影的重建：
(e)用相隔5.625°的32个反投影的重建；(4)用相隔2.8125°的64个反投影的重建
5.11.2 计算机断层(CT)原理
X射线计算机断层的目的是使用X射线从许多不同的方向穿过物体而得到该物体内部结构的三
维描述。传统的胸部X射线透视是把物体放在对X射线敏感的平板对面，并用圆锥形X射线束照射
该个体得到的。X射线平板产生一幅图像，该图像上一个点的亮度与X射线通过该物体后照射到该
点上的X射线能量成正比。这幅图像就是在前节中我们讨论过的投影的二维图像。我们可以对整幅
图像进行反投影，并创建一个三维物体。通过在许多角度重复该过程，并把反投影相加，就可产生胸
腔结构的三维再现。计算机断层通过身体产生的切片试图得到相同的信息(或者其局部)。一个三维描
述可以用堆积这些切片得到。CT 的实现要经济得多，因为得到高分辨率切片所需要的检测器数量要
比产生相同分辨率的一个完整二维投影所需要的检测器数量少得多。计算负担和X射线的剂量同样
要降低，使得一维投影CT成为一种更实际的方法。
如上一章中讨论傅里叶变换时那样，CT 所要求的基本数学概念在数字计算机能够实用之前已存
在很多年了。CT的理论基础可追溯至来自维也纳的数学家约翰·雷登，作为其线积分工作的一部分，
他于1917年推导了一种沿着平行射线对一个二维物体投影的方法。现在，该方法就是通常所指的雷登
变换，这是下一节中我们讨论的话题。45年后，埃兰·M·考玛克(Allan M.Cormack)—Tufts大学
的物理学者部分地重新发现了这些概念，并把它们应用到CT上。考玛克在1963年和1964年发表了
他的最初发现，并且说明了如何从不同角度方向得到的X射线图像重建人体横截面图像。他给出了重
建所需要的数学公式，并且构建了一个用于展示其概念的实际CT原型。作为独立的工作，位于伦敦
的EMI公司的电子工程师高德弗里·N·豪斯菲尔德(Godfrey N.Hounsfield)及其同事们明确地表达了
类似的解决方法，并建立了第一台医学CT机。由于他们对医学断层的贡献，考玛克和豪斯菲尔德共同
获得了1979年诺贝尔医学奖。
第一代(G1)CT 扫描仪采用“铅笔”型X射线束和一个单检测器，如图5.35(a)所示。对于一个
给定的旋转角度，源/检测器对沿着所示的线性方向增量式地平移。投影(类似于图5.32)由测量每一
个增量平移处检测器的输出产生。完成了线性平移之后，旋转源/检测器组合，并重复该过程以产生
在不同角度上的另一个投影。该过程在0°到180°内对所有期望的角度重复，以生成一组完整的投影，
第5章 图像复原与重建 231
就像前一节解释的那样，用反投影产生一幅图像。物体顶部的十字标记表明与源/检测器对构成的平
面相垂直的方向的运动。通过增量地将物体移过源/检测器平面(每完成一次扫描后),产生一组横截面
图像(切片)。堆积这些图像就可生成人体截面的三维体。医学成像的第一代扫描仪不久就不再制造了，
但由于它们可产生平行的射线束(如图5.32所示),它们的几何学原理作为介绍CT成像的基础是有优势的。
正如下一节要讨论的那样，该几何学原理是推导由投影实现图像重建所需公式的起点。
a b cd 源
⑧ 8)
物体
检测器
e
?
图5.35 四代CT扫描器。点箭头直线表示增量线性运动。点箭头弧线表示增量旋转。物体顶部的十字标记表
示垂直于纸面的线性运动。图(a)和图(b)中的双箭头表示源/检测器单元被平移后又回到了其原始位置
第二代(G2)CT 扫描器[见图5.35(b)]与第一代扫描器以相同的原理工作，但所用的射线束是
扇形的。这就允许使用多个检测器，因而源/检测器对的平移较少。第三代(G3)扫描器较早期的前两代
CT在几何原理上有较大的改进。如图5.35(c)所示，G3扫描器使用足够长的一族检测器(约有1000个
独立的检测器)来覆盖一个更宽射线束的整个视野。因此，每个角度的增量都会产生一个完整的投影，
从而消除了如G1和G2扫描器那样对源/检测器对的平移的需要。第四代(G4)扫描器更进一步。它使
用一个圆环检测器(约有5000个独立的检测器),仅仅射线源做旋转。G3和G4扫描器的重要优点是
速度快，主要缺点是造价高和较大的X射线散射，要比G1和G2扫描器更高的剂量才能达到可
比拟的信噪比特性。
新的扫描模式正在开始使用。例如，第五代(G5)CT扫描器，即所知道的电子束计算机断层(EBCT)
扫描器，该扫描器排除了所有的机械运动，而使用电磁控制电子束。通过触发环绕着病人的钨极板，
这些电子束产生X射线，然后X射线被整形为通过病人的扇形射线束，并激发如 G4扫描器那样的
检测器环。
传统方法得到的CT图像在扫描期间要求病人保持稳定，以产生一幅图像。然后，病人在垂直于
成像平面上用机动工作台递增移动位置的时候扫描停止。再后，得到下一幅图像；重复该过程多次， ;曾
232 数宇图像处理(第三版)
直到覆盖人体一个特定的截面所要求的数量为止。虽然在不足一秒钟就可以得到一幅图像，但在图像
获取期间有要求病人摒住呼吸的过程(如腹部和胸部扫描)。完成30幅图像的采集过程可能需要几分
钟时间。针对该问题所用的一种方法是螺旋CT,有时也称为第六代(G6)CT。在该方法中，G3和G4
扫描器使用一种所谓的滑动环来配置，它不需要在源/检测器和处理单元之间的电气和信号连接。然
后，源/检测器对连续旋转 360°,同时病人在垂直于扫描的方向恒速移动。结果是连续的螺旋数值，
这些数据经处理后就可得到各幅切片图像。
第七代(G7)扫描器(也称为多切片CT 扫描器)将要问世，这种扫描器使用“厚”的扇形射线束
与平行检测器族相配合同时收集体CT数据，即三维横截“厚片层”,而不是每个X射线脉冲产生单
一的横截面图像。除了有效地增加了细节之外，这种方法的优点是它使用的X射线管更经济，从而
降低了成本并降低了剂量。
在下一节开始，为系统阐述图像投影，我们将推导一些必要的数学工具和重建算法。我们的关
注点是图像处理的基本原理，它是我们刚刚讨论过的所有CT方法的支撑。与CT系统有关的机械和
源/检测器特性相关的信息，在本章末尾引用的参考文献中提供。
落-至
5.11.3 投影和雷登变换
下面，我们详细推导根据X射线计算机断层重建图像所需要的数
学问题，但是，相同的基本原理在其他CT 成像模式也可用，如
SPECT(单电子发射断层)、PET(正电子发射断层)、MRI(核磁共振成
像)和超声成像的某些模式。
在笛卡儿坐标系中一条直线可以完全由它的斜截式来描述，y=ax+b,
或可由其法线表示来描述，如图5.36所示：
x cosθ+y sinθ=p
在这一节中，我们遵从CT 约定并
将y平面的原点放在中心位置而不是
之前惯用的左上角位置(见24.2节)
但请注意，这两种坐标系均是右手
坐标系，唯一的不同是我们的图像
坐标系没有负轴。通过简单地移动
原点，我们就可发现这种不同，因
此两种表示是可互换的。
(5.11-1)
平行射线束的投影可由一组直线建模，如图5.37所示。投影信号中的任意一点由沿着直线
xcosθ?+ysinθk=p,的射线和给出。工作在连续变量情况下时，线求和变为线积分①,由下式给出：
8(pj,B)=?__f(x,yδ(x cosQ+ysine-p)drdy (5.11-2)
其中，我们使用了4.5.1节中讨论的冲激函数δ的性质。换句话说，除非δ的参量是零，否则式(5.11-2)
的右边为零，它指出积分只沿着线xcosθ?+ysinθ=p,计算。如果我们考虑p和θ的所有值，那么
前一公式推广为
8(p.θ)=?[[f(x,yδ(xcosθ+y sinθ-p)dxrdy (5.11-3)
给出沿xy 平面中任意一条线的f(x,y)的投影(线积分)的公式就是前一节提到的雷登变换。符号
R(f(x,y)}或R(f}有时用于代替式(5.11-3)中的g(p,0)来表示f的雷登变换，但式(5.11-3)中所用
的符号类型更为普遍。随后的讨论更明显，雷登变换是投影重建的基石，计算机断层是其在图像处理
领域的主要应用。
①在第4章中，我们使用0.2)来表示连续图像坐标，而用(x,y)来表示离散坐标。当时，这种区别很重要，因为我们在推导从连
续到取样后的量的基本概念。在当前的讨论中，由于我们会在连续与离散坐标之间多次往返，坚持这种约定很可能会导致不必
要的混淆。因此，为遵从已出版文献中的约定(见 Prince and Links[2006),我们会根据上下文来确定坐标(r,y)是连续的还是离
散的。当坐标是连续坐标时，我们会看到积分，而坐标为离散坐标时，会看到求和。
第5章 图像复原与重建 233
投影中的一个点
一个固定角的 g(ppA)
y 完整投影g(p.OA) x
L(p,BA) P
0 x
P
图5.36 直线的法线表示 图5.37 平行射线束的几何描述
在离散情况下，式(5.11-3)变成
s(o.e)=22ru.yo(cs0+ysine-p) (5.11-4)
其中，x,y,p,θ现在是离散变量。如果固定θ而令p变化，我们可以看到，(5.11-4)简化为沿着由这
两个参数的特定值定义的线对f(x,y)的像素求和。(固定θ值的情况下)通过增加覆盖图像(θ值固定)
所要求的p的所有值产生一个投影。改变θ并重复前述过程则产生另一个投影，依次类推。这正好
就是5.11.1节中生成投影的方法。
例5.17 使用雷登变换得到圆形区域的投影。
在论述之前，我们首先说明如何使用雷登变换得到图5.38(a)中圆形物体投影的解析表达式：
rax)-{a.其他
其中，A是常数，r是物体的半径。我们假设圆心位于xy平面的原点。因为物体是圆对称的，其投影对
所有角度都是一样的，所以我们要做的全部事情就是得到θ=0°的投影。然后，式(5.11-3)变成
8(p,θ)=_f(x,y)δ(x-p)dxdy
=[[f(p,y)dy
其中，第二行来自公式(4.2-10)。正如之前注释的那样，这是一个线积分(在这种情况下沿着线L(p,0)积分)。
还要注意的是，当p|>r时，g(p,0)=0。当p|≤r时，积分从y=-√2-p2到y=√2-p2求值。因此，
g(p.0)-f(p,yidy-Ady
执行积分得到
8o.e)-cp-{2- 职他
其中，我们利用了当|p|>r时g(p,θ)=0这样一个事实。图5.38(b)显示了这一结果，该结果与图5.32和
图5.33中所说明的投影一致。注意，g(p,θ)=g(p),即g是独立于θ的，因为物体是关于原点对称的。 33
照;堂
234 数字图像处理(第三版)
a
b
x
当雷登变换g(p.θ)以p和θ作为直线坐标显示为
一幅图像时，结果称之为正弦图(sinogram),概念上类
似于所显示的傅里叶谱[然而，不像傅里叶变换，
8(p.θ)总是一个实函数]。类似于傅里叶变换，正弦图
包含重建f(x,y)所需的数据。如同显示的傅里叶谱一
g(p)
样，正弦图对于简单区
域很容易解释，但作为
一个变得很复杂的投影
区域去“读取”会变得
很困难。例如，图5.39(b)
是左侧矩形的正弦图，
0
P
图5.38 (a)一个圆盘；(b)该圆盘解析推导的雷
登变换的曲线。这里我们可以画出该变
换，因为它仅取决于一个变量。当g取
决于p和θ时，雷登变换变成一幅图
像，其坐标轴是p和θ、而一个像素
的亮度与该像素位置处的g值成正比
其垂直轴和水平轴分别对应于p和θ。因此，底部一行
是矩形在水平方向上的投影(即θ=0),中间一行是在
垂直方向上的投影(即θ=90°)。底部一行的非零部分
比中间一行的非零部分小这一事实告诉我们，物体在水
平方向较窄。正弦图在两个方向上关于图像中心对称的
事实告诉我们，处理的物体是对称的，并且平行于x轴
和y轴。最后，正弦图是平滑的，这指出物体具有均匀
的灰度。除了这些类型的一般观察外，关于正弦图我们
说不出更多的特点。
图5.39(c)显示了一幅 Shepp-Logan 幻影图像，该图像是广泛使用的合成图像，设计用于模拟脑
部主要区域的吸收，包括几个小的肿瘤。如图5.39(d)所示，解释这幅图像的正弦图更加困难。我们
仍然可以推断某些对称的特点，但这是我们能够说明的全部内容。正弦图的视觉分析仅限于实际应用，
但有时对于开发算法是有帮助的。
180
135
e90
45
0]
180
135
50
45
0」
为生成有着相同行数的阵列，正
弦图中p轴的最小维对应于投影期
间遇到的最大维。例如。使用1°增
量得到的大小为M×M的方形的正
弦图的最小尺寸为180×Q,其中Q
大于√2M的最小整数。
d
图5.39 两幅图像和它们的正弦图(雷登变换)。正弦图的每一行是在垂直轴上沿相应角度的投影。图像(c)称
为Shepp-Logan 幻影。在其原始形式中，幻影的灰度非常低。为便于观察，这里显示的是增强后的图像
第5章 图像复原与重建 235
CT的关键目的是从投影得到物体的三维表示。正如 5.11.1节直观介绍的那样，其方法是反投
影每一个投影，然后对反投影求和以产生一幅图像(切片)。堆积所有的结果图像产生三维物体的再
现。为了得到来自雷登变换的反投影图像的形式化表达，让我们从单点开始，g(p,,θ)是全部投影
8(p,θA)的一个固定旋转值θ,的投影(见图5.37)。由该单点的反投影形成的一幅图像的部分与将线
L(p,,θA)复制到图像上相比，没有更多的信息，其中线上每一点的值是g(p,,θ)。对投影信号中的所
有p,值重复这一过程(保持θ值固定为θ),可得到如下表达式：
Je(x,y)=g(p,θA)=g(xcosθ?+ysinθ.0)
对固定角度θ投影进行反投影所得到的图像示于图5.32(b)。这一公式对于任意θ,值均成立，因此我
们一般可以把由角度θ处得到的单个反投影形成的图像写为
fa(x,y)=g(x cosθ+y sinθ,0) (5.11-5)
通过对所有的反投影图像积分，我们得到最终图像：
f(x,y)=J。fe(x,y)de (5.11-6)
在离散情况下，积分变成对所有反投影图像求和：
rux,)=2f?(x) (5.11-7)
其中，x,y和θ现在是离散值。回顾5.11.1节中的讨论，在0°和180°处的投影互为镜像图像，因此求
和执行最后的角度增量在180°之前。例如，如果使用0.5°的增量，则求和操作是从0°到179.5°以半
度为增量。用刚刚讨论的方法形成的反投影图像有时称为层图(laminogram)。可以隐含地将层图理解
为仅仅是对产生投影的图像的一个近似，下面的例子将清楚地解释这一事实。
例5.18 从正弦图得到反投影图像。
式(5.11-7)用于从式(5.11-4)得到的投影产生图5.32
到图5.34的反投影图像。类似地，这些公式用于产生
图5.40(a)和图5.40(b),它们分别显示了对应于图5.39(b)
和图5.39(d)中正弦图的反投影图像。如之前的图那
样，我们注意到很严重的模糊，因此很明显，直接运用
式(5.11-4)和式(5.11-7)将得到不可接受的结果。然而， a b
就像您在5.11.5节中看到的那样，用重新表达反投影方
法在重建中做有意义的改善是可能的。 图5.40 图5.39中的正弦图的反投影
5.11.4 傅里叶切片定理
在这一节，我们将推导与投影的一维傅里叶变换和得到投影区域的二维傅里叶变换相关的基本
结果。这一关系是能处理刚才讨论的模糊问题的重建方法的基础。
关于p投影的一维傅里叶变换为
G(w,0)=?8(p.0)e-2Pdp (5.11-8)
其中，如式(4.2-16),w是频率变量，很容易理解，该表达式是给定θ值的。用式(5.11-3)代替遥盈
236 数字图像处理(第三版)
g(p,θ),得到表达式
G(a,e)=?[_f(x,y)δ(x cosθ+y sinθ-p)e2mPdxdy dp
=[fax[?[8(xcose+ysine-peap]drdy (5.11-9)
=5?_f(x,ye-Zzouceydxdy
其中，最后一步遵循本节早些时候提到过的冲激特性。令u=wcosθ和v=osinθ,式(5.11-9)变为
c.e[二r(a,yekdy] (5.11-10)
我们可看出该表达式与指定a值和v值时f(x,y)[见式(4.5-7)]的二维傅里叶变换等价，即
G(o,0)=[Fu,DL=F(o cose,osine) (5.11-11)
其中，通常，F(u,v)表示f(x,y)的二维傅里叶变换。
式(5.11-11)就是众所周知的傅里叶切片定理(或投影切片定理)。它说明一个投影的傅里叶变换
是得到投影区域的二维傅里叶变换的一个切片。该术语的来源可用图5.41来解释。正如该图所示，
任意一个投影的一维傅里叶变换可以沿着一个角度提取一条线的F(u,v)的值来得到，该角度是产生投
影所用的角度。在原理上，我们可以简单地使用 F(u,v)的傅里叶反变换得到f(x,y)①,然而，这
是高代价的计算，因为它涉及二维变换的反变换。在下一节中讨论的方法将有效得多。
y
投影
二维
傅里叶变换
F(u.e)
(x,y)
x
一维傅里叶变换
图5.41 傅里叶切片定理的说明。投影的一维傅里叶变换是得到投
影的区域的二维傅里叶变换的一个切片。注意角度θ的对应
5.11.5 使用平行射线束滤波反投影的重建
如我们在5.11.1节和例5.18所看到的那样，直接得到反投影会生成不可接受的模糊结果。幸运的
是，有一个简单的解决该问题的办法，就是在计算反投影之前对投影做简单的滤波。从式(4.5-8)可
知，F(u,v)的二维反傅里叶变换是
①记住，即使使用了博里叶反变换，恢复的图像中仍会存在模糊，因为该结果等同于使用前一节讨论的方法得到的结果。
第5章 图像复原与重建
f(x,y=?[厂[F(u,v)el2utdu dv (5.11-12)
如式(5.11-10)和式(5.11-11)所示，如果令u=wcosθ和v=wsinθ,则
微分变为dudv=odode,我们可以把式(5.11-12)表达为极坐标形式
237
dudv=adadθ这一关系源自基
本积分学，在基本积分学中。雅可
比矩阵是各变量变化的基础。
f(x,y)=J。J。F(@ cos6,o sine)e?ey mo do de (5.11-13)
然后，利用傅里叶切片定理有
f(x,y)=J。J。G(@,0)e?oueyo do de (5.11-14)
把积分分离为两个表达式，一个θ的范围为0°到180°,另一范围为180°到360°,并利用
G(w,θ+180°)=G(-w,0)这一事实(见习题5.32),我们可以把式(5.11-14)表达为
f(x,y)=J[laIGa,e]eye dode (5.11-15)
考虑关于o的积分项，从式(5.11-1)我们可以看出，如p那样，xcosθ+ysinθ是常数。因此，
式(5.11-15)可写为
f(x,)=[s[LaG(a.e)edade (5.11-16)
方括号内部的表达式是一维傅里叶反变换形式[见式(4.2-17)],附加了一个|w|项，基于4.7节的讨
论，我们可以看出它是一个一维滤波函数。显然，|w|是一个斜坡滤波器[见图5.42(a)]①。这个函
数是不可积的，因为其幅度在两个方向上都扩展到+0,所以其傅里叶反变换没有定义。理论上，可
用某种方法来处理该问题，如使用所谓的广义δ函数。实践中，该方法是对斜坡加窗，使它在定义的
频率范围之外为零，也就是加窗限制带宽的斜坡滤波器。
a b e d e
频率域 空间域
频率域 频率域 空间域
图5.42(a)使用一个盒状滤波器限制带宽后的滤波器m的频率域剖面线；(b)空间域表示；(c)汉明窗函数；
(d)由图(a)和图(c)的乘积形成的加窗后的斜坡滤波器；(e)乘积的空间域表示(注意振铃的降低)
限制一个函数的带宽的最简方法是在频率域中使用一个盒子。然而，正如我们在图4.4中看到的
那样，一个盒子有不希望的振铃特性，因此，用一个平滑窗来代替。图5.42(a)显示了使用一个盒状
①斜坡滤波器通常称为Ram-Lak滤波器，因为该滤波器是由Ramachandran and Lakshminarayanan[1971首次提出的。 ;客
器;虐
238 数字图像处理(第三版)
窗限制带宽后的一个斜坡滤波器，图5.42(b)显示了通过计算该滤波器的傅里叶反变换得到的空间
域表示。如预期的那样，加窗滤波的结果在空间域中呈现出了明显的振铃。我们由第4章可知，频
率域的滤波等于空间域的卷积，因此，使用存在振铃的函数进行空间滤波也将产生被振铃污染的结
果。使用一个平滑函数加窗对这一情况有帮助。常常用于实现一维FFT的M点离散窗函数由下式
给出：
c- (5.11-17)
当c=0.54时，该函数称为汉明窗[根据Richard Hamming(理查德·汉明)命名];当c=0.5时，该
函数称为韩窗[根据Julius von Hann(朱利叶·冯·韩)命名]①。汉明窗和韩窗间的主要区别是后者
末尾的一些点为零。通常，两者间的差别在图像处理应用中是觉察不到的。
图5.42(c)显示了汉明窗的曲线，图5.42(d)显示了该窗和图5.42(a)中带限斜坡滤波器的积的结果。
图5.42(e)显示了该积在空间域的表示，该表示通常是通过计算其反FFT 得到的。很明显，该图与
图5.42(b)比较，加窗斜坡中的振铃现象减少了[图5.42(b)和图5.42(e)中的峰值比分别为2.5和3.4]。
另一方面，因为图5.42(e)中的中心瓣比图5.42(b)中的中心瓣稍宽，我们可以预期，由于使用汉明窗
的反投影有较小的振铃，但稍微多一点模糊。正如例5.19所示，的确是这种情况。
回顾式(5.11-8),G(w,0)是g(p,θ)的一维傅里叶变换，这是在一个固定角度θ得到的单一投影。
式(5.11-16)说明完全的反投影图像f(x,y)是由如下步骤得到的：
1.计算每一个投影的一维傅里叶变换。
2.如上面说明的那样，用滤波函数|四|乘以每一个傅里叶变换，就是乘以一个合适的窗(如汉明窗)。
3.得到每一个滤波后的变换的一维反傅里叶变换。
4.对步骤3得到的所有一维反变换积分(求和)。
因为使用了滤波函数，所以该图像重建方法称为滤波反投影。实践中，由于数据是离散的，因
此，所有频率域计算是使用一维 FFT 算法来执行的，并且，对于二维函数，滤波是使用第 4章中
说明的相同基本过程实现的。另一方面，我们也可以在空间域使用卷积来实现滤波，如本节稍后说
明的那样。
前面的讨论涉及滤波反投影的加窗问题。在使用任何取样数据系统时，我们还需要考虑取样率
问题。由第4章我们知道，取样率的选择对图像处理结果具有深远的影响。在现在的讨论中，有两个
取样考虑。第一个是所用的射线数量，它决定每个投影的取样数。第二个是旋转角度增量的数量，它
决定重建图像的数量(其和产生最终的图像)。欠取样将产生混淆现象，如我们在第4章中看到的那样，
它在图像本身出现人为缺陷，例如条纹。我们在5.11.6节将详细讨论取样问题。
例5.19 使用滤波反投影的图像重建。
这个例子的关注点是说明用滤波反投影的重建，首先使用一个斜坡滤波器，然后使用一个被汉明窗
改进的斜坡滤波器。这些滤波反投影与图5.40中的原始反投影结果相比较。为了仅关注滤波的差别，在
这个例子中，结果是使用0.5°的旋转增量产生的，它是我们在图5.40中用过的增量。在两种情况下，射线间
的间隔为一个像素。两个例子中的图像大小均为600×600像素，因此，对角线的长度是√2×600=849。
当旋转角度是45°和135°时，所用的849条射线提供了全部区域的覆盖。
①有时，为与汉明窗对比、韩窗也称为汉宁窗。但汉宁窗这一术语是不正确的，是引起混乱的根源。
第5章 图像复原与重建 239
图5.43(a)显示了使用斜坡滤波器的矩形重建。该结果的最清晰特性是没有视觉可见的模糊。然而，
如预期的那样，存在振铃现象，可见暗淡的线条，特别是在矩形的角的周围。这些线条在图5.43(c)的放
大部分中看得更清楚。在斜坡滤波器上使用汉明窗对振铃问题有相当大的帮助，如图5.43(b)和图5.43(d)所
示，但要付出稍微有点模糊的代价。对图5.43(a)的改进是明显的(与未加窗的斜坡滤波器相比)。由于幻影
图像没有像矩形一样急剧且突出的过渡，因此即使是使用未加窗的斜坡滤波器，振铃现象也是感觉不到
的，正如图544(a)您所见到的那样。使用汉明窗会得到稍微平滑一些的图像，如图544(b)所示。与图5.40(b)
相比，这两个结果都有较大的改进，再次证明了滤波反投影方法所固有的优点。
a bcd
图5.43(a)使用斜坡滤波器的矩形滤波反投影；(b)用汉明窗斜坡滤波器的矩形滤波
反投影。第二行显示了第一行中图像放大后的细节。请与图5.40(a)比较
a b
图5.44 (a)使用斜坡滤波器的头部幻影的滤波反投影；(b)使汉明窗
斜坡滤波器的头部幻影的滤波反投影。请与图5.40(b)比较
在CT的多数应用中(特别是在医学上),像振铃这样的人为缺陷有严重的厉害关系，使它们最小化是
有意义的工作。调整滤波算法，并像 5.11.2节说明的那样使用大量的检测器是在设计中有助于减少这些
效应应考虑的事项。
前边的讨论是以通过一个FFT实现得到滤波反投影为基础的。然而，由第4章中的卷积理论我
们知道，使用空间卷积也可得到相同的结果。特别地，式(5.11-16)中方括号内的项是两个频率域函数
乘积的反傅里叶变换，根据卷积定理，我们知道它等于这两个函数的空间表示(反傅里叶变换)的卷积。
换句话说，令s(p)表示|w|的反傅里叶变换①,我们将式(5.11-16)写为
ra=j [LIG(o.oede=[sp)*g(D.0)de
=js[Jg(p,0)s(xcos8+ysine-p)dp]de (5.11-18)
①如果使用了一个窗函数，如汉明窗，则反傅里叶变换对加窗的斜坡函数执行。同样，我们再次忽略了前面提及的关于连续反傅
里叶变换的存在性问题，因为所有的实现均是使用有限长的离散量执行的 虐言
402
240 数字图像处理(第三版)
其中，如第4章中那样，★表示卷积。紧接第一行的第二行的原因见前一段的解释。第三行遵循
式(4.2-20)给出的卷积的实际定义。
式(5.11-18)的后两行描述了相同的事情：角度θ处的各个反投影可以用相应的投影g(p,θ)和斜
坡滤波器s(p)的反傅里叶变换的卷积操作得到。与以前一样，全部的反投影图像可以通过对所有单
独的反投影图像的积分(求和)得到。除了计算上的舍入差别外，使用卷积的结果与使用FFT 的结果
是一样的。在实际的CT实现中，已证明卷积通常在计算上更有效，因此，多数现代CT系统使用这
种方法。傅里叶变换在理论表示和算法开发中确实扮演了重要角色(例如，MATLAB中的CT图像处
理就是基于FFT的)。另外，我们注意到，在重建的过程中并不需要存储所有的反投影图像。相反，
单一的求和运算只是被最后的反投影图像更新。在该过程的末尾，求和运算将等于所有反投影的总和。
最后，我们要指出，因为斜坡滤波器(甚至在被加窗时)在频率域的直流项归零，故每一幅反投
影图像的均值将为零(见图4.30)。这就意味着每一幅反投影图像都将有负像素和正像素。当所有的反
投影图像相加形成最终图像时，一些负位置可能变成正的，而平均值可能不是零，但是，典型地，最
终图像将还是有负像素。
有一些方法可以处理这个问题。当关于平均值的知识不知道时，最简单的方法是接受在该方法
中负值是固有的这样一个事实，并使用式(2.6-10)和式(2.6-11)中描述的过程来标定这一结果。这是
本节遵循的方法。当典型的平均值的知识是可用的时候，可将该值加到频率域的滤波器上，从而抵消
斜坡并防止直流项为零[见图4.31(c)]。当在空间域中使用卷积时，截断空间滤波器的长度(斜坡的
反傅里叶变换)的真正效果都将防止其有零均值，这样就完全避免了迫零问题。
5.11.6 使用扇形射线束滤波反投影的重建
到目前为止的讨论都集中于平行射线束。因为它简单而直观，这是传统上介绍计算机断层成像的成
像几何原理。然而，现代CT系统却使用扇形射
线束的几何原理(见图5.35),这一节其余的部
分讨论该话题。 β 源
图5.45显示了一个基本的扇形射线束成像
几何，其中，检测器被安放在一个圆弧上，并
且假设源的角度增量是相等的。令p(α.β)表
示一个扇形射线束投影，其中α是相对于中心
射线测量特定检测器的角度β是相对于y轴测
量的源的角度位移，如图所示。在图5.45中，
我们还注意到，扇形射线束中的一条射线可用
D a
户 8
X
一条线L(p.0)来表示，在标准形式中，它是
我们在前一节讨论平行射线束成像几何中用以
描述一条射线的方法。这就允许我们用平行射
线束的结果作为推导扇形射线几何公式的起
点。我们继续以卷积为基础推导扇形射线滤波
反投影的方法。
L(p.0)
中心射线
图5.45 基本的扇形射线几何原理。通过源的中心和原点
(这里假设为源的旋转中心)的线称为中心射线
①为平行射线束几何原理推导的傅里叶切片定理并不能直接用于扇形射线束。但是，式(5.11-19)和式(5.11-20)奠定了将扇形射线
束几何转换为平行射线束几何的基础，从而允许我们使用前一节中推导的滤波后的平行反投影方法，这时切片定理是适用的。
本节的末尾将详细探讨这一点。
第5章 图像复原与重建 241
我们以图5.45中的表示开始，线L(p,θ)的参数与扇形射线参数的关系是
θ=β+α (5.11-19)
和
p=Dsinα (5.11-20)
其中，D是从源的中心到xy平面的原点的距离。
平行射线成像几何的卷积反投影公式已由式(5.11-18)给出。不失一般性，假设我们集中注意这
样的物体，它们被包围在一个以平面原点为中心、以T为半径的圆形区域内。那么对于|p|>T,有
g(p,θ)=0,且式(5.11-18)变为
f(x,y)=J。”s(p,θs(xcosθ+ysin8-p)dp de (5.11-21)
其中，我们利用了5.11.1节说明的事实，即相隔180°的投影互为镜像。在这种方法中，式(5.11-21)
中的外积分限扫过整个圆，正如扇形射线束配置所要求的那样，检测器被安排为一个圆上。
我们感兴趣的是关于α和β的积分。为这样做，我们将它改为极坐标(r,φ),即令x=rcosφ和
y=rsinφ,由此，它变为下式：
xcosθ+y sinθ=r cosφ cosθ+r sinφ sinθ=r cos(θ-φ) (5.11-22)
利用这一结果，我们可以把式(5.11-21)表示为
f(x,y)=J。J,8(p,θ)sfrcos(8-φ)-pldpde
这个表达式并不比平行射线束重建写成极坐标的公式有更多的内容，然而，积分还是关于p和θ的。
为了对α和β积分，要求用式(5.!1-19)和式(5.11-20)进行坐标变换：
f(r.φ)=J-T1D8(Dsina,a+B)s[r cos(β+α-9)-Dsina]Dcosa da dβ 5.1-23)
其中，我们使用了dp dθ=Dcosα dα dβ[见式(5.11-13)的解释]。
这个公式可以进一步简化。首先，注意积分限从-α到2π-α,对β来说，扫过了全部360度。
因为β的所有函数是周期为2π的周期函数，外积分限可分别用0和2π来代替。项arcsin(T/D)对
应于|p|>T有一个最大值α,超过该值则有g=0(见图5.46),因此，我们可以把内积分的积分限分
别用-α和αm来代替。最后，考虑图5.45中的线L(p,θ)。沿着这条线的扇形射线和必须等于沿着同
一条线的平行射线和(射线和是沿着一条线的所有值的和，因此对于一条给定的射线，结果必须是相
同的，不管在什么坐标系，这是明确的)。对于(α,β)和(p,0)对应值的任何射线和这都是正确的。
这样，令p(α,β)表示一个扇形射线投影，它遵循p(α,β)=g(p,0),且由式(5.11-19)和式(5.11-20)
有p(α,β)=g(Dsinα,α+β)。合并这两个等式为式(5.11-23),我们有
f(v.φ)=J。p[a.Bsfr cos(B+α-o)-D sina]Dcosa da dβ (5.11-24)
这是基于滤波反投影的基本扇形重建公式。
式(5.11-24)可进一步变换为更熟悉的卷积形式。参考图5.47,它可被表示为(见习题5.33)
r cos(β+α-φ)-D sinα=R sin(α'-α) (5.11-25)
其中，R是在扇形射线中源到任何一点的距离，α'是该条射线与中心射线的夹角。注意，R和α'由r.
φ和β的值决定。把式(5.11-25)代人式(5.11-24)得到
臣
242 数字图像处理(第三版)
f(r,φ)=J。pla,Bs[R sin(d'-a]D osa dadβ (5.11-26)
可以证明(见习题5.34)
Rsina)-()sa (5.11-27)
Y
源 β β
源 R、
“
D
D
X β-
图5.46 包围感兴趣区域所需的最大α值
使用该表达式，我们可以把式(5.11-26)写为
图5.47 扇形射线上任意一点的极坐标表示
f(v.φ)=J。[qa.,B]h(a'-adaldβ (5.11-28)
其中，
ha)-(msa) (5.11-29)
和
q(α,β)=p(α,β)Dcosα (5.11-30)
我们可以看出式(5.11-28)中方括号内的积分是一个卷积表达式，这样，式(5.11-24)中的图像重建公式
就可以如同用函数q(α,β)和h(α)的卷积那样来实现。与平行投影重建的公式不同，基于扇形射线束
投影重建包含有1/R2项，它是与源的距离成反比的加权系数。实现式(5.11-28)的计算细节超出了当
前讨论的范围(关于该主题的详细论述，请参阅Kak and Slaney[2001])。
直接代替式(5.11-28)的实现，特别是在软件模拟中的一种常用的方法是：(1)使用式(5.11-19)
和式(5.11-20)把扇形射线几何转换为平行射线几何，(2)使用5.11.5节中开发的平行射线重建方法。
我们将用一个如何这样做的例子来结束本节的讨论。如早些时候指出的那样，以角度β获取的一个
扇形射线投影p,有一个相应的以角度θ获取的平行射线投影g,因此有
p(α,β)=g(p,θ)=g(Dsinα,α+β) (5.11-31)
其中，第二行来自式(5.11-19)和式(5.11-20)。
令△β表示连续扇形投影的角度增量，并令△α是射线之间的角度增量，它决定每一个投影中的
样本数量。利用约束
第5章 图像复原与重建 243
Aβ=△α=γ (5.11-32)
然后，利用β=my和α=ny,其中m和n是整数，我们可以把式(5.11-31)写成
p(ny,my)=8[Dsin ny,(m+n)y] (5.11-33)
该式指出第m个射线投影中的第n条射线等于第(m+n)个平行投影中的第n条射线。式(5.11-33)
右边的Dsin nγ项意味着从扇形射线投影转换为平行射线投影是不均匀取样，如果取样间隔△α和
△β太粗，则可能导致模糊、振铃和混淆的问题，正如下面的例子说明的那样。
例5.20 使用滤波扇形反投影的图像重建。
图5.48(a)显示了：(1)使用△α=△β=1°产生矩形图像的扇形投影，(2)使用式(5.11-33)将每一个扇形
射线转换为相应的平行射线，(3)把5.11.5节推出的滤波反投影方法用于平行射线。图5.48(b)到(d)分别显
示了使用0.5°、0.25°和0.125°增量的结果。在所有的情况下都使用汉明窗。这一角度增量的变化用于说
明欠取样的效应。
图5.48(a)中的结果清楚地指出，1°的增量太粗，模糊和振铃现象十分明显。图5.48(b)中的结果在感
觉上很有趣，它与图5.43(b)相比很差，而图5.43(b)也是使用0.5°的角度增量产生的。事实上，如图5.48(c)
所示，即便使用0.25°的角度增量重建也不比图5.43(b)好。如图5.48(d)所示，为使两个结果可以比较，我
们必须使用约为0.125°的角度增量。这个角度增量可产生180×(1/0.25)=720个样本，这接近于例5.19中的
平行投影所用的849条射线。这样，可以预料这些结果在外观上接近于使用△α=0.125°时的结果。
a bcd
图5.48 使用滤波扇形反投影的矩形图像的重建：(a)α和β的增量为1°的结果；(b)增量为0.5°
的结果；(c)增量为0.25°的结果；(d)增量为0.125°的结果。请比较图(d)和图5.43(b)
除了如正弦干扰那样的混淆更为可见外，类似的结果使用头部幻影也可以得到。在图5.49(c)中，我
们看到，即使使用△α=△β=0.25°,严重的失真也依然存在，特别是在椭圆的外围。当使用矩形时，使
用0.125°的增量最终产生了可与图5.44(b)中头部幻影反投影图像相比的结果。这些结果说明了在现代CT
系统的扇形射线几何原理中必须使用数以千计的检测器来减少混淆效应的原因。
a bc d
图5.49 使用滤波扇形反投影的头部幻影图像的重建：(a)α和β的增量为1°的结果；(b)增量为
0.5°的结果；(c)增量为0.25°的结果；(d)增量为0.125°的结果。主比较图(d)和图5.44(b) 度;
言～李
244 数字图像处理(第三版)
小结
本章中的复原结果基于这样一个假设，即图像退化可建模为一个线性的、位置不变的过程，以
及与图像值不相关的加性噪声。即使这些假设并不完全正确，用前几章提出的方法得到有用的结果也
常常是可能的。
这一章推导的某些复原技术基于各种最佳准则。“最佳”一词的使用涉及到严格的数学概念，而
不是指人类视觉系统的最佳响应。事实上，对于视觉感知知识的缺乏妨碍了图像复原问题的一般表达，
而图像复原问题要考虑到观察者的偏好与能力。在这些限制条件下，本章所介绍概念的优势是基本方
法的推导，它有合理的预测能力和坚实的基础知识的支持。
就像在第3章和第 4章中那样，一定的复原任务，譬如降低随机噪声，是在空间域中使用卷积
模板来执行的。我们也发现频率域对于降低周期性噪声和对于某些重要的退化建模是很理想的，如在
图像获取期间因为运动导致的模糊。我们还发现，对于表达复原滤波器来说，频率域也是很有用的工
具，如维纳滤波器和约束最小二乘方滤波器。
如第 4章中提到过的那样，频率域为实验提供了直观且可靠的基础。一旦对于给定的应用找到
了令人满意的一种方法(滤波器),其实现通常是通过数字滤波器的设计在频率域近似解决来执行的。
正如第4章末尾指出的那样，在计算机中或专用的硬件/固件系统中运行速度要快得多。
投影重建图像的论述是图像处理在这一领域的基础，虽然只是介绍性的。如5.11节说明的那样，
计算机断层(CT)是投影重建图像的主要应用领域。虽然我们只关心X射线断层，但5.11节建立的原
理也适用于其他CT成像模式，譬如 SPECT(单光子发射断层)、PET(正电子发射断层)、MRI(核磁
共振成像)和某些超声成像模式。
参考文献
关于5.1节中线性退化模型的其他读物，请参阅Castleman[1996]和Prat[1991]。Peebles[1993]的书籍提供
了噪声概率密度函数及其特性的一般水平的概括(见5.2节)。由Papoulis[1991]所写的书更深入、详细地概括
了这些概念。5.3节的参考文献有Umbaugh[2005]、Boie和Cox[1992]、Hwang和Haddad[1995]及Wibum[1998]
的论著。自适应中值滤波的的资料见Eng和Ma[2001,2006]。自适应滤波器设计的一般领域对于5.3节所讨
论的自适应滤波器是很好的背景。由Haykin[1996]所著的书籍对这一题目是一个很好的介绍。5.4节中的滤波
器是第4章内容的直接延伸。5.5节内容的其他读物见Rosenfeld和Kak[1982]及Pratt[1991]的著述。
估计退化函数这一主题(见5.6节)是当前一个重要的领域。估计退化函数的一些早期技术由 Andrews
和Hunt[1977]、Rosenfeld和Kak[1982]、Bates和McDonnell[1986]及Stark[1987]给出。因为退化函数很少能
精确知道，所以过去几年中提出了大量的技术，其中强调了特殊复原。例如，Geman 和Reynolds[1992]和
Hum和 Jennison[1996]提出处理保护灰度急剧过渡以试图强调清晰度的问题，Boyd和Meloche[1998]则专
注于复原退化图像中的细小物体。处理模糊图像的技术的例子见Yitzhaky 等人[1998]、Harikumar和
Bresler[1999]、Mesarovic[2000]及Giannakis 和 Heath[2000]的著述。序列图像的复原也是考虑的重点，
Kokaram[1998]所著的书籍为这一领域提供了很好的基础。
过去几年来，对于5.7节到5.10节讨论的滤波方法，在图像处理方面的书籍和论文中已用各种方法进行
了解释。有两种主要方法作为这些滤波器开发的基础。一种方法是以使用矩阵理论的通用表达为基础的，如
Andrews和Hunt[1977]的介绍。这种方法精致且通用，但对于新涉猎该领域的人来说比较困难，因为它缺乏直
观性。直接基于频率域滤波的方法(在这一章我们所遵循的方法)对于初次接触复原的人来说通常比较容易，
第5章 图像复原与重建 245
但是缺少矩阵法统一的数学严谨性。两种方法都可以达到相同的结果，但根据我们的授课经验，提出的各种材
料指出，初涉这一领域的学生更喜欢后一种方法。5.7节到5.10节所述滤波概念的补充读物是Castleman[1996]、
Umbaugh[2005]及Petrou和Bosdogianni [1999]的著述。最后的参考文献在二维频域滤波器和相应的数字滤
波器之间提供了很好的联系。关于二维数字滤波器的设计，请参阅Luand Antoniou[1992]的著述。
计算机断层的基本参考资料是Rosenfeld和Kak[19821、Kak和Slaney[2001]及Prince和Links[2006]的
著述。关于 Shepp-Logan 幻影的参考资料见 Shepp 和Logan[1974]的著述，关于Ram-Lak 滤波器起源的详
细内容见Ramachandran和Lakshminarayanan[1971]的文献。O'Connor和Fessler[2006]的论文是有关计算机
断层在信号与图像处理领域当前研究的代表性论文。
本章中讨论过的多数内容实现的软件技术，可参阅Gonzalez,Woods和Eddins[2004]的著述。
习题
标有星号的习题的详细解答
可在本书的网站上找到。该网站还包
含了基于本章内容所建议的项目
★5.1 测试模式中的白色条带的大小为7像素宽、210像素高。两个白色条带之间的间距为17像素。应
用下面的处理后，该图像看起来像什么?
(a)3×3算术均值滤波器。
(b)5×5算术均值滤波器。
(c)9×9算术均值滤波器。
注意：与对该图像滤波相关的这一习题及后面几个习题看起来有点
单调，然而，它们值得尝试，因为它们可帮助理解这些滤波器如何
工作。理解了一个特殊滤波器对图像的影响后，您的回答可以是关
于结果图像的简短描述。例如，“结果图像将由3个像素宽、206个
像素高的白色条带组成"。一定要描述白色条带的任何变形，例如
圆角。您可以忽略模板仅包含了部分图像像素引起的图像边界效应。
5.2 使用几何均值滤波器重做习题5.1。
★5.3 使用谐波均值滤波器重做习题5.1。
5.4 使用逆谐波均值滤波器(Q=1.5)重做习题5.1。
★5.5 使用逆谐波均值滤波(Q=-1.5)重做习题5.1。
5.6 使用中值滤波器重做习题5.1。
★5.7 使用最大值滤波器重做习题5.1。
5.8 使用最小值滤波器重做习题5.1。
★5.9 使用中点滤波器重做习题5.1。
5.10 分别从图5.7(c)和图5.7(d)右上角提取的两个子图
像如右所示。左侧的子图像是使用一个大小为3×3
的算术均值滤波器处理的结果，右侧的子图像是使
用一个相同大小的几何均值滤波器处理的结果。
★(a)解释为什么使用几何均值滤波得到的子图像模
糊较少。(提示：您的分析可通过检查灰度的一
维阶跃过渡来开始。)
(b)解释为什么右侧图像中黑色元件更粗了。
5.11 根据式(5.3-6)给出的逆谐波滤波器，回答如下问题。
(a)解释为什么当Q为正值时，该滤波器可有效去除“胡椒”噪声。 :皮
言志
246 数字图像处理(第三版)
(b)解释为什么当Q为负值时，该滤波器可有效去除“盐粒”噪声。
(c)解释为什么选择的Q值不当时，该滤波器给出较差结果(譬如图5.9所示的结果)。
(d)讨论当Q=-1.5时该滤波器的特性。
(e)讨论(对于Q为正和负的情况)恒定灰度级区域中该滤波器的特性。
★5.12 给出与表4.6中带阻滤波器对应的高斯和布特沃斯带通滤波器的公式。
5.13 以式(4.10-5)的形式给出高斯、布特沃斯和理想陷波带阻滤波器的公式。
★5.14 证明二维连续余弦函数
f(x,y)=Acos(u?x+v?y)
的傅里叶变换是共轭冲激对
foa,y)=2s(“-2-a)+8(u+2+2)
[提示：使用式(4.5-7)中的连续傅里叶变换，并以指数形式表示该余弦函数。]
5.15 使用式(5.4-11)推导式(5.4-13)。
★5.16 考虑一个线性、位置不变的图像退化系统，其冲激响应为
h(x-a,y-β)=e-(-a2+0-Br
假设系统的输人是由宽度无限小的一条线组成的图像，这条线位于x=a,y=b处并由f(x,y)=8(x a,y-b)建模，其中8是一个冲激函数。假设无噪声，输出图像g(x,y)是什么?
5.17 在图像获取期间，在时间T?内，一幅图像在垂直方向上做均匀线性运动。然后，在时间T?内，运
动方向转为水平方向。假设图像改变方向所用的时间可以忽略不计，且快门开关时间同样也可以
忽略不计，给出模糊函数H(u,v)的表达式。
★5.18 考虑在x方向均匀加速导致的图像模糊问题。如果图像在时间t=0时静止，在时间T内，以均匀
加速度x?(t)=a2加速，请找出模糊函数H(u,v)。可以假设快门开关时间忽略不计。
5.19 设计一个在接近着陆时从行星发送图像的空间探测器。在着陆的最后阶段，一个控制推进器坏了，
导致探测器沿其垂直轴急速旋转。在着陆期间的最后两秒钟发送的图像由于这种圆周运动而被模
糊了。摄像机位于探测器的底部，沿探测器的垂直轴并指向下方。幸运的是，探测器的转动也是
沿着垂直轴的，因此图像是由均匀的旋转运动模糊的。在每幅图像获取期间，探测器旋转π/12弧
度。假设在图像获取期间垂直运动可以忽略。请以公式形式给出复原图像的解决方案。
★5.20 如右所示的图像是心脏立体再现的一个模糊的二维投影。已知
图像右侧底部的每个十字线宽4像素、长20像素，且模糊之前
的灰度值为255。试给出一步一步的过程，指出您怎样应用刚
才提供的信息得到模糊函数H(u,v)。
5.21 某X射线成像几何产生了一种模糊退化，这种模糊退化可用空
间圆对称函数
M?2+22
与该遥感图像的卷积来建模。假设是连续变量，证明频率域中
的退化由如下表达式给出：
(原图像由GE医学系统提供)
H(u,D)=-√2πo(u2+v2)e222)
(提示：从4.9.4节、表4.3中的性质13和习题4.26人手。)
第5章 图像复原与重建 247
★5.22 使用习题5.21 中的传递函数，给出几何均值滤波器的表达式，假设噪声功率谱和未退化信号之比
为常数。然后，给出维纳滤波器的表达式。
5.23 使用习题5.21中的传递函数，给出约束最小二乘方滤波器的最终表达式。
5.24 假设图5.1中的模型是线性且位置不变的，并且噪声与图像是不相关的。证明输出功率谱为
G(u,2=|H(u,vl2|F(u,2+|N(u,v)2
参考式(5.5-17)和式(4.6-18)。
5.25 Cannon[1974]建议过一个满足条件
|F(u,2=|R(u,v2|G(u,D2
的复原滤波器 R(u,v),并且以强制复原图像的功率谱|F(u,v)2等于原图像的功率谱IF(u,v)2为前
提。假设该图像和噪声是不相关的。
★(a)根据|F(u,v2、|H(u,v)2和|N(u,)2给出R(u,v)。[提示：参阅图5.1、式(5.5-17)和习题5.24]。
(b)使用(a)中得到的结果来说明式(5.8-2)给出的结果。
5.26 一位天文学家使用一台高倍望远镜观察到的图像有点模糊。制造商告诉天文学家，设备是按说明
书操作的。望远镜镜头把图像聚焦到高分辨率CCD成像阵列上，然后望远镜使用电子学方法将图
像转换为数字图像。试图通过传导控制实验室的实验使用镜头和成像传感器来改进这种情况是不
可能的，因为望远镜部件的尺寸和重量大太。天文学家听说您是一位成功的图像处理专家，打电
话要求您帮助她提出将图像变得清晰一些的数字图像处理方案。假设您能得到的图像仅仅是星体
图像，请问您如何解决该问题?
★5.27一位考古学教授正在从事罗马帝国时期流通货币方面的研究工作。他最近了解到对其研究起决定
性作用的4个罗马硬币陈列在伦敦的大英博物馆中。遗憾的是，在到达博物馆后，他被告知这些
硬币最近被盗了。进一步的部分研究表明，依靠博物馆保存的这些硬币的照片是可靠的。遗憾的
是，硬币的照片模糊为一些点，以至于无法识别数据和小标记。模糊的原因在于拍摄照片时摄像
机散焦。作为一名图像处理专家和教授的朋友，要求您帮助决定是否计算机处理能用于复原图像，
并为教授指出在哪里能读这个标记。而且您被告知，与同一时期其他有代表性的硬币一样，用于
拍摄这些照片的摄像机仍然可用。提出一步一步解决这一问题的过程。
5.28 画出下列方形图像的雷登变换。在画出的图形中定量地标出所有的重要特性。图(a)由中间的一个
点组成，图(b)沿对角线有两个点。根据灰度剖面来描述您对图(c)的解决方案。假设使用平行射
线几何理论。
(a) *(b) (e)
f(ay)=Aexp20的雷登变换[见式(5113)]是g(p.θ)=AJ2noexp(-p2)。 5.29 证明高斯函数
[提示：参考例5.17,这里我们使用对称性来简化积分。1 臣;
248 数字图像处理(第三版)
5.30★(a)证明单位冲激函数δ(x,y)的雷登变换[见式(5.11-3)]是pθ平面中通过原点的一条垂直线。
(b)证明冲激δ(x-x?,y-yo)的雷登变换是在pθ平面中的一条正弦曲线。
5.31 证明雷登变换[见式(5.11-3)]的下列性质的正确性：
★(a)线性：雷登变换是一个线性算子(见2.6.2节关于线性算子的定义)。
(b)平移性质：f(x-xo,y-y?)的雷登变换是g(p-x?cosθ-yosinθ,θ)。
★(c)卷积性质：证明两个函数的卷积的雷登变换等于两个函数的雷登变换的卷积。
5.32 给出由式(5.11-14)推导出式(5.11-15)的步骤。您需要用到性质G(w,θ+180°)=G(-w,0)。
★5.33 证明式(5.11-25)的正确性。
5.34 证明式(5.11-27)的正确性。
415
第6章 彩色图像处理
只有经过几年的准备之后，年轻的艺术家才应接触颜色，不是用颜
色描述，而是作为人的情感表达的手段。
——亨利·马蒂斯
作为一种训练形式，很长时间我限制自己面对一种颜色。
——巴布罗·毕加索
引言
在图像处理中，彩色的运用受两个主要因素的推动。第一，彩色是一个强有力的描绘子，它常
常可简化从场景中提取和识别目标；第二，人可以辨别几千种彩色色调和亮度，但相比之下只能辨别
几十种灰度色调。第二个因素在人工图像分析中特别重要。
彩色图像处理可分为两个主要领域：全彩色处理和伪彩色处理。在第一类中，通常要求图像用
全彩色传感器获取，如彩色电视摄像机或彩色扫描仪。在第二类中，问题是对一种特定的单色灰度或
灰度范围赋予一种颜色。到目前为止，多数数字彩色图像处理是在伪彩色层面完成的。然而，在过去
的十年里，彩色传感器和用于处理彩色图像的硬件在合理的价格上变得更容易接受，导致现在的全彩
色图像处理技术的应用日益广泛，包括出版、可视化和互联网应用。
在后续的讨论中，我们会看到前面几章介绍的一些灰度方法可直接用于彩色图像。其他方法则
要求将灰度方法重新表达为与本章推导的彩色空间的性质保持一致。本书讨论的这些技术远未穷尽，
仅是用于彩色图像处理的一些方法。
6.1 彩色基础
虽然人的大脑感知和理解颜色所遵循的过程还是未完全了解的一种生理和心理现象，但颜色的
物理性质可由实验和理论结果支持的基本形式来表示。
在1666年，艾萨克·牛顿(Isaac Newton)发现了一种现象，当一束太阳光通过一个玻璃棱镜时，
出现的光束不是白色的，而是由一端为紫色、另一端为红色的连续色谱组成。如图6.1所示，色谱可
分为6个宽的区域：紫色、蓝色、绿色、黄色、橙色和红色。当观察全彩色时(见图6.2),色谱末尾
的颜色不是突变的，而是每种颜色混合平滑地过渡到下一种颜色的。
基本上，人类和某些其他动物感知一个物体颜色是由物体反射光的性质决定的。如图6.2所示，
可见光由电磁波谱中相对较窄的频段组成。一个物体反射的光如果在所有可见光波长范围内是平衡
的，那么对观察者来说显示为白色。然而，一个物体反射有限的可见光谱，则物体呈现某种颜色。例
如，绿色物体反射具有500~570nm范围内主要波长的光，吸收其他波长的多数能量。 叶
匿-;
250 数字图像处理(第三版)
红外线
白光
玻璃校镜 紫外线
图6.1 白光通过棱镜看到的色谱(原图像由General Electric公司的Lamp Business分公司提供)
伽马射线 X射线紫外线 红外线 微波 视频无线电波
0m 00
"
00
紫外线 可见光谱 红外线
100 0 06 600 T00 0 e
波长(nm)
图6.2 可见范围电磁波谱的波长组成(原图像由General Electric公司的Lamp Business分公司提供)
光的特性是彩色科学的核心。如果光是无色的(缺乏颜色),它的属性仅仅是亮度或者数值。无
色光就是观察者在黑白电视机上看到的光，并且它是迄今为止我们对图像处理的讨论的隐含分量。
正如第 2章中定义并多次使用的那样，术语灰度级仅提供了一个亮度的标量度量，它的范围从黑色
到灰色最终到白色。
彩色光大约覆盖电磁波谱400~700 nm的范围。用来描述彩色光源质量的3个基本量是辐射、光
强和亮度。辐射是从光源流出的能量的总量，通常用瓦特(W)来度量。光强用流明来度量，它给出了
观察者从光源感知的能量总和的度量。例如，由远红外波谱范围的光源发出的光，可能具有很大的能
量(辐射),但是观察者却很难感知到它；它的光强几乎是零。最后，亮度是一个主观描绘子，它实际
上是不可能度量的。它体现了无色的强度的概念，并且是描述色彩感觉的一个关键因素。
正如2.1.1节中解释的那样，人眼中的锥状细胞是负责彩色视觉的传感器。详细的实验结果已经
确定，人眼中的600~700万个锥状细胞可分为3个主要的感知类别，分别对应于红色、绿色和蓝色。
大约65??锥状细胞对红光敏感，33??绿光敏感，只有2??蓝光敏感(但蓝色锥状细胞对蓝光更敏
感)。图6.3显示了人眼中的红色、绿色和蓝色锥状细胞吸收光的平均实验曲线。由于人眼的这些吸收
特性，所看到的彩色是所谓的原色红(R)、绿(G)、蓝(B)的各种组合。为标准化起见，CIE(国际照明
委员会)在1931年设计了下面的特定波长值为三原色：蓝色=435.8 nm,绿色=546.1 nm,红色=700nm。
这一标准在图6.3所示的详细实验曲线于1965年被采用之前就做了规定。因此CIE 标准只是近似对
应于实验数据。由图6.2和图6.3我们注意到，没有单一的颜色可称为红色、绿色或蓝色。另外，应
记住为标准化目的而定的三个特定原色波长，并不意味着这三个固定的RGB分量单独作用就能产生
所有谱，这一点很重要。“原色”一词的使用已被广泛误解为：三个标准原色以各种强度比混合在一起
时，可以产生所有的可见彩色。正如您很快将会看到的那样，这一解释是不正确的，除非波长允许变
化，而在这种情况下将不再有三个固定的标准原色了。
原色相加可以产生二次色，如深红色(红色加蓝色)、青色(绿色加蓝色)和黄色(红色加绿色)。
以正确的亮度把三原色或把与二次色相对应的原色混合，即可产生白光。这一结果示于图6.4(a),它
还说明了三原色及其混合产生二次色。
光的原色与颜料或着色剂的原色之间的区别很重要。后者的原色被定义为减去或吸收光的一
第6章 彩色图像处理 251
种原色，并反射或传输另外两种原色。因此，颜料的原色是深红色、青色和黄色，而二次色是红
色、绿色和蓝色。这些颜色示于图6.4(b)。将三种颜料原色或与二次色对应的原色的适当混合，即
可产生黑色。
445 nm 535 nm 575 nm
蓝色 绿色 红色 吸收(任意单位)
400 450 500 550 600 650 700 nm
蓝紫色 紫蓝色 蓝色 蓝绿色 绿色 黄绿色 黄色 检色 红橙色 红色
图6.3 以波长为函数，人眼中的红色、绿色和蓝色锥状细胞对光的吸收曲线
彩色电视接收机是光的彩色相加性质的一个例子。许多彩色电视荧光屏(CRT,阴极射线管)的
内部是由电敏荧光粉按三角形点阵的模式组成
的。当激发时，三色组中的每一点产生三原色中
的一种光。发红光的荧光点的亮度由显像管内的
电子枪调制，该电子枪产生的脉冲与电视摄像机
看到的“红色能量”相对应。每个三色组中的绿
色荧光点和蓝色荧光点以相同的方式调制。在电
视接收机上观察到的效果是来自每个三色组的三
原色被“加”在一起，并被人眼中的颜色敏感的
锥状细胞以全彩色图像的方式接收。以所有这三
种颜色每秒钟连续变化30幅图像，在荧光屏上即
可完成连续图像的显示。
光的湿合
a
b
绿色 (原色相加)
黄色 青色
白色
红色 深红色 蓝色
版料的混合
(原色相减) 黄色
CRT显示器正在被平板数字技术取代，譬如液 红色 绿色
晶显示器(LCD)和等离子设备。虽然它们的基本原 黑色
理与CRT 不同。在某种意义上，这些技术及类似 青色 深红色 蓝色 的技术使用了一个相同的原理，即它们都要求三个
子像素(红色、绿色和蓝色)去产生单个彩色像素。
光和颜料的原色及二次色 LCD 使用极化光的特性来阻止光或使光通过LCD
屏幕，在有源矩阵显示技术的情况下，使用薄膜晶
图6.4 光和颜料的原色及二次色(原图像由General 体管(TFT)提供适当的信号对屏幕上的每一个像素
Electric公司的Lamp Business分公司提供) 寻址。光滤波器用于在每个像素三色组位置上产生
光的三原色。在等离子装置中，像素是用于产生三原色之一的涂有荧光粉的微小气体单元。各个小单
元以类似于LCD的方式寻址。这种三像素组的同等寻址能力是数字显示的基础。 418
通常用以区别不同颜色特性的是亮度、色调和饱和度。正如本节前面所指出的那样，亮度具体 420
志言
252 数字图像处理(第三版)
表达了无色的强度概念。色调是光波混合中与主波长有关的属性。色调表示观察者感知的主要颜色。
这样，当我们说一个物体为红色、橙色或黄色时，指的是其色调。饱和度指的是相对的纯净度，或一
种颜色混合白光的数量。纯谱色是全饱和的。如深红色(红加白)和淡紫色(紫加白)这样的彩色是欠饱
和的，饱和度与所加白光的数量成反比。
色调与饱和度一起称为色度，因此，颜色可用其亮度和色度来表征。形成任何特殊彩色的红、绿、
蓝的数量称为三色值，并分别表示为X,Y和Z。这样，一种颜色就可由其三色值系数定义为
x=x+x+z (6.1-1)
y=x+Y+Z (6.1-2)
和
2=x+Y+z (6.1-3)
从以上公式可得①
x+y+z=1 (6.1-4)
对可见光谱内光的任何波长，用于产生对应于该波长的颜色所需的三色值可直接从大量实验结果编制
的曲线或表中得到(Poynton[1996]),也可参阅Walsh[1958]和Kiver[1965]的早期文献。
确定颜色的另一种方法是使用CIE 色度图(见图6.5),该图以x(红)和y(绿)的函数表示颜色的组
成。对于x和y的任何值，相应的z值(蓝色)可由式(6.1-4)得到，注意z=1-(x+y)。例如，图6.5中
标记为绿色的点大约有62??绿色和25??红色成分。从式(6.1-4)可得到蓝色的成分约为13??
从380 nm的紫色到780 nm的红色的各种谱色的位置标在舌形色度图周围的边界上。这些都是
示于图6.2的谱图中的纯色。任何不在边界上而在色度图内部的点都表示谱色的混合色。示于图6.5
中的等能量点与三原色的百分比相对应，它表示白光的CIE 标准。位于色度图边界上的任何点都是
全饱和的。当一点离开边界并接近等能量点时，该颜色中就加入了更多的白光，它就变成欠饱和的颜
色了。等能量点的饱和度为零。
色度图对于色彩混合非常有用，因为色度图中连接任意两点的直线段定义了所有不同颜色的变
化，这些颜色可以由这两种颜色的加性组合得到。例如，考虑图6.5中所示的从红点到绿点画的一
条直线，如果红光多于绿光，则确切地表示新颜色的点将处在该线段上，但与绿点相比它更接近于
红点。类似地，从等能量点到位于色度图边界上的任意一点画一线段，将定义那个特定谱色的所有
色调。
把这一过程扩展到三种颜色是很简单的。为了决定从色度图中任何给定的三种颜色得到的颜色
范围，我们可简单地在三个色点之间画出连接线，结果是一个三角形，三角形边界上或三角形内的任
何颜色都可以由三种初始颜色的不同组合产生。以任意固定颜色为顶点的三角形无法包围图6.5中的
整个颜色区域。这种观察结果从图解上支持了早期的评论，即用3个单一的、固定的原色无法得到所
有颜色。
图6.6中的三角形显示了由RGB 监视器产生的典型的颜色范围(称为彩色全域)。三角形内的不
规则区域是今天高质量彩色打印设备的彩色域代表。彩色打印彩色域的边界是不规则的，因为彩色打
印是相加色彩和相减色彩混合的组合，与在监视器上显示颜色(基于三种高度可控的原色光的相加)相
比，这是一个更加难以控制的过程，监视器是以三个高度可控的原色光的相加为基础的。
①这段文字中使用的x.y.z遵循国际惯例。这些不应与书中其他小节用于表示空间坐标的(x,y相混淆。
第6章 彩色图像处理
XE色度图
知语能量轨迹(波长为纳米)
绿色
1
金色
暖白色
冷白色
日光 渊红色
红色 深整色 等能量点
蓝色
11
0.1 02 03
图6.5 色度图(原图像由General Electric公司的Lamp Business分公司提供)
253
0.9-
0.8-
0.7-
0.6-
0.5-
y辅
0.4-
03-
0.2-
0.1
0-
0
520
550
-510 540
590
560
500 50
980
50
600
R
610
490 60
480
470
460 B
0
640
450
780
0.1 0.2 0.3 0.4 0.5 0.6 0.7 08
x轴
图6.6 彩色监视器的典型彩色域(三角形区域)和彩色打印设备的典型彩色城(不规则区域) 圆
贞～名
254 数字图像处理(第三版)
6.2 彩色模型
彩色模型(也称为彩色空间或彩色系统)的目的是在某些标准下用通常可以接受的方式方便地对
彩色加以说明。本质上，彩色模型是坐标系统和子空间的说明，其中，位于系统中的每种颜色都由单
个点来表示。
现在所用的大多数彩色模型不是面向硬件(如彩色监视器和打印机)的，就是面向应用的，在这
里，彩色操作是一个目的(例如针对动画的彩色图形创作)。在数字图像处理中，实际中最通用的面
向硬件的模型是RGB(红、绿、蓝)模型，该模型用于彩色监视器和一大类彩色视频摄像机；CMY(青、
粉红、黄)模型和CMYK(青、粉红、黄、黑)模型是针对彩色打印机的；以及HSI(色调、饱和度、
亮度)模型，这种模型更符合人描述和解释颜色的方式。HSI模型还有另一个优点，它可以解除图
像中的颜色和灰度信息的联系，使其更适合本书中开发的许多灰度处理技术。现在使用的彩色模型
还有很多，主要是由于彩色科学是一个包括许多应用的很宽的领域。这里试图详细研究其中的几个
模型，因为这些模型更有意义且更有益。然而，根据现有的任务，本章讨论的模型是图像处理的主
要模型。掌握了本章的内容后，理解今天使用的其他彩色模型，您将不会有困难。
6.2.1 RGB彩色模型
在RGB模型中，每种颜色出现在红、绿、蓝的原色光谱分量中。该模型基于笛卡儿坐标系。所
考虑的彩色子空间是图6.7所示的立方体，图中RGB原色值位于3个角上；二次色青色、深红色和黄
色位于另外3个角上，黑色位于原点处，白色位于离原点最远的角上。在该模型中，灰度(RGB值相等
的点)沿着连接这两点的直线从黑色延伸到白色。在这一模型中的不同颜色是位于立方体上的或立方体
内部的点，且由自原点延伸的向量来定义。为方便起见，假定所有的颜色值都归一化了，则图6.7所示
的立方体是一个单位立方体，即R,G和B的所有值都假定在范围[0,1]内。
在RGB彩色模型中表示的图像由3个分量图像组成，每种原色一幅分量图像。当送入 RGB监视
器时，这3幅图像在屏幕上混合生成一幅合成的彩色图像，正如在6.1节所说明的那样。在RGB空间
中，用于表示每个像素的比特数称为像素深度。考虑一幅RGB 图像，其中每一幅红、绿、蓝图像都是
一幅8比特图像，在这种条件下，可以说每个RGB彩色像素[即(R,G,B)值的三元组]有24比特的
深度(3个图像平面乘以每个平面的比特数)。术语全彩色图像通常用来表示一幅24比特的RGB彩色图像。
在24比特RGB图像中，颜色总数是(2°)3=16777216。图6.8显示了与图6.7对应的24比特彩色立方体。
B
蓝色 [(0.0,1) 青色
深红色 白色
黑色 灰度级 0.1.0)
绿色 G
(1.0.0[
红色 黄色 R
图6.7 RGB彩色立方体示意图。沿主对角线的点有
从原点的黑色至点(1.1.D的白色的灰度值
图6.8 RGB 24比特彩色立方体
第6章 彩色图像处理 255
例6.1 生成RGB彩色立方体的隐藏面和剖面。
图6.8所示的立方体是实心的，它由前一段中提到的(2)3=16777 216种颜色组成。观察这些颜色的一
种简便方法是生成一个彩色平面(立方体的表面或剖面)。这是通过固定三种颜色中的一个并允许其他两种
颜色变化来完成的。例如，在图6.8中，通过立方体中心并与GB平面平行的剖面是平面(127,G,B),其中
G,B=0,1,2…,255。这里，我们使用了实际像素值，而不是为数学上的方便而在[0.1]范围内的归一化值，
因为前者是在计算机中实际用来产生颜色的值。图6.9(a)说明，通过简单地把三幅独立的分量图像送入
彩色监视器来观察一幅横截面图像。在分量图像中，0代表黑色，255代表白色(注意这些是灰度级图像)。
最后，图6.9(b)显示了以同样的方式生成的图6.8中立方体的3个隐藏面。
值得注意的是，获取一幅彩色图像基本上是图6.9所示的相反的过程。使用分别对红、绿、蓝敏感的
3个滤色片可获取一幅彩色图像。当我们用配备有这些滤色片之一的单色摄像机观察彩色场景时，结果是一
幅单色图像，其亮度与滤色片的响应成正比。用每个滤色片重复这一过程，可产生三幅单色图像，这些图
像就是彩色场景的 RGB分量图像(实际上，RGB彩色图像传感器通常将这一过程集成在一个装置中)。很
清楚，以图6.9(a)所示的形式显示这3幅RGB分量图像，就会产生原始彩色场景的RGB彩色复现。
a
b 红色
绿色
彩色监视器
RGB
蓝色
(R=0) (G=0) (B=0)
图6.9(a)生成彩色剖面(127,G,B)的RGB图像；(b)图6.8所示彩色立方体的3个隐藏面
虽然高端显示卡和监视器提供24比特RGB 图像的合理的彩色再现，但今天所用的许多系统仍
限于256种颜色。另外，有许多应用，使用几百种以上的颜色没有意义，而有时只用几种颜色。
6.3节讨论的伪彩色图像处理技术就提供了这种情况的一个较好的例子。当前应用给定的各种系统中，
有一种彩色子系统值得考虑，其合理且与观察者无关的硬件性能是很重要的。这种色彩子集称为稳定
RGB 色集合，或称为全系统稳定色集合。在互联网应用中，这种色彩子集称为稳定Web色或稳定浏
览器色。
假定256 种颜色是最小颜色数，这些颜色可用任何可以显示所希望的彩色的系统真实再现，那
么使用可接受的标准符号来表示这些颜色是很有用的。已知256种颜色中的40种颜色可被各种操作 凉
南名
256 数字图像处理(第三版)
系统进行不同的处理，仅留下216种颜色是多数系统通用的。这216种颜色已成为事实上的稳定色，
特别是在互联网中的应用。无论在何时应用，希望大多数人观察到的颜色都一样。
如以前一样，216种稳定色中的每一种都可以由3个RGB值形成，但每个值只能是0,51,102,153,
204或255。这样，这些RGB三元组数值就可提供(6)3=216种可能的值(注意所有值都可被3整除)。
通常这些值可用十六进制数来表示，如表6.1所示。回顾一下，十六进制数0,1,2…,9,A,B,C,D,E,F
对应十进制数0.1,2,…,9,10,11,12,13,14,15。还可以表示为(O)?=(0000)?和(F),6=(I1II)?,例如，
(FF)?=(255)?=(11II1II)?,并且我们可以看到，两个十六进制数构成了一个8比特字节。
表6.1 稳定色中每个RGB分量的有效值
数制 等效颜色
十六进制 00 33 66 99 CC FF
十进制 0 51 102 153 204 255
因为要取3个数来形成RGB彩色，每种稳定色由表6.1中的3个两位十六进制数形成。例如，
最纯净的红色是FF0000。值000000和FFFFFF分别表示黑色和白色。记住，使用更为熟悉的十进制
表示可得到相同的结果。例如，以十进制表示的最亮红色为R=255(FF)和G=B=0。
图6.10(a)显示了以RGB的降序值组织的216种稳定色。第一行左上角方块的值为FFFFFF(白),
其右侧方块的值为FFFFCC,第三个方块的值为 FFFF99,等等。同一阵列第二行的值是FFCCFF,
FFCCCC, FFCC99,等等。该阵列中最后一个方块的值为FF0000(可能是最亮的红色)。刚考察过的
阵列右侧的第二个阵列的值由CCFFFF开始，并以相同的方式进行，其他剩下的4个阵列也同样进
行。最后一个阵列的最后一个方块(右下方)的值为000000(黑)。注意，不是所有可能的8比特灰色
都包含在216种稳定色中，这一点很重要。图6.10(b)显示了256色RGB系统中所有可能灰色的十
六进制代码。这些值的一部分在稳定色集的外面，但可被多数显示系统(根据它们的相对亮度)适当地
表示。来自稳定色组的灰度(KKKKKK)?,K=0,3,6,9,C,F在图6.10(b)中以下画线形式显示。
a
b
肉 777777 关委 的 AAAAAA BBBBBB R(((( DDDDDD 333333 FEFFE
图6.10(a)216种稳定RGB色；(b)256色RGB系统中的所有灰度(部分稳定色组的灰度以下画线的形式显示)
第6章 彩色图像处理 257
图6.11显示了RGB稳定色立方体。与图6.8所示的实心全彩色立方
体不同，图6.11中的立方体仅在表面有有效的颜色。正如图6.10(a)所示，
每个平面都有36 种颜色，所以稳定色立方体的整个表面被216种不同
的颜色所覆盖，这正如所期望的那样。
6.2.2 CMY和CMYK彩色模型
正如6.1节中指出的那样，青色、深红色和黄色是光的二次色，换句 图6.11 RGB稳定色立方体
话说，是颜料的原色。例如，当青色颜料涂覆的表面用白光照射时，该表
面将不反射红光。也就是说，青色从反射的白光中减去红光，白光本身由等量的红光、绿光和蓝光组成。
大多数在纸上沉积彩色颜料的设备，如彩色打印机和复印机，要求输入CMY数据或在内部进行
RGB到CMY的转换。这一转换是使用下面这个简单的操作执行的：
(6.2-1)
这里再次假设所有的彩色值都归一化到了范围[0,1]内。式(6.2-1)表明涂有青色颜料的表面所反射的
光中不包含红色(即公式中C=1-R)。类似地，纯深红色不反射绿色，纯黄色不反射蓝色。式(6.2-1)
还揭示RGB值可以很容易地通过1减去CMY值从CMY集中得到。正如早些时候指出的那样，在
图像处理中，这种彩色模型主要用于产生硬拷贝输出，因此从CMY到RGB的反向操作通常没有实
际意义。
根据图6.4,等量的颜料原色，青色、深红色和黄色，可以生成黑色。实际上，为打印组合的这
些颜色所产生的黑色是不纯的。因此，为了生成真正的黑色(即在打印中起主要作用的颜色),加入了
第4种颜色——黑色，提出了CMYK彩色模型。这样，当出版商提到“四色打印”时，指的就是CMY
彩色模型的三种原色再加上黑色。
6.2.3 HSI彩色模型
正如我们所见到的那样，在RGB模型和CMY模型中创建颜色并从一种模型转换到另一种模型
是比较简单的过程。如上所述，这些彩色系统对于硬件实现很理想。另外，RGB 系统与人眼强烈感
知红、绿、蓝三原色的事实能很好地匹配。遗憾的是，RGB模型、CMY模型和其他类似的彩色模型不
能很好地适应实际上人解释的颜色。例如，通过用给定的组成其颜色的每一原色的百分比不能给出一
辆汽车的颜色，此外，我们不认为彩色图像是由3幅原色图像混合形成的单幅图像。
当人观察一个彩色物体时，我们用其色调、饱和度和亮度来描述它。回顾6.1节的讨论，色调是
描述一种纯色(纯黄色、纯橙色或纯红色)的颜色属性，然而，饱和度是一种纯色被白光稀释的程度的
度量。亮度是一个主观的描述子，实际上它是不可度量的。它体现了无色的强度概念，并且是描述彩
色感觉的关键因子之一。我们清楚地知道强度(灰度级)是单色图像最有用的描述子。很明确，这个量
是可度量的，并很容易解释。我们即将提出的模型称为HSI(色调、饱和度和强度)彩色模型，该模型
可在彩色图像中从携带的彩色信息(色调和饱和度)中消去强度分量的影响。因此，HSI 模型是开发
基于彩色描述的图像处理算法的理想工具，这种彩色描述对人来说是自然且直观的，毕竟人才是这些
算法的开发者和使用者。因此，我们可以概括说明如下，可以说 RGB 对于图像颜色生成来说是理想
的(如用彩色摄像机的图像获取，或在监视器屏幕上显示图像),但在用于颜色描述时则有许多的限制。
下面的素材提供了一种这样做的有效方法。 图：度
世言
258 数宇图像处理(第三版)
正如例6.1中讨论的那样，一幅RGB彩色图像可被看成3幅单色亮度图像(表示红色、绿色和蓝
色),因此，我们应能从一幅RGB图像中提取出强度并不奇怪。如果我们使用图6.7中的彩色立方体，
让白色顶点(1,1,1)在黑色顶点(0,0,0)上方直接面对它，如图6.12(a)所示，则这一点就更加清楚了。联
系图6.7可知，强度(灰度级)是沿连接这两个顶点的直线分布的。如图6.12的排列所示，连接黑色顶
点和白色顶点的直线(灰度轴)是垂直的。这样，如果我们要确定图6.12中任何彩色点的强度分量，可
以简单地通过一个垂直于强度轴并包含该彩色点的平面，该平面与强度轴的交点就给出了范围[0.1]
内的强度值。稍微思考一下，我们还注意到，一种颜色的饱和度(纯度)以强度轴的距离为函数而增
大。事实上，强度轴上点的饱和度为零，事实证明沿着这条轴线的所有点都是灰度。
a b
白色 白色
深红色 深红色
青色 黄色 青色 黄色
蓝色 红色 蓝色 红色
绿色 绿色
黑色 黑色
图6.12 RGB模型和HSI模型间的概念关系
为了解如何从给定的RGB点来确定色调，考虑图6.12(b),图中显示了由3个点(黑、白和青)定
义的一个平面。黑点和白点包含在平面内的事实告诉我们强度轴也包含在这个平面内。进一步，我们
看到，包含在由强度轴和立方体边界定义的平面段内的所有点都有相同的色调(在这种情形下为青
色)。回顾6.1节可得到相同的结论，即所有颜色都是由位于这些颜色定义的三角形中的3种颜色产
生的。如果这些点中的两点是黑点和白点，第三点是一个彩色点，那么三角形上的所有点都有相同的
色调，因为黑分量和白分量不能改变色调(当然，这个三角形中的点的强度和饱和度是不同的)。通过
关于垂直强度轴旋转阴影平面，可得到不同的色调。从这些概念可以得出这样的结论：形成HSI空
间所要求的色调、饱和度和强度值可由RGB 彩色立方体得到。也就是说，通过计算前面讨论中描述
和推导的几何公式，我们可将任何RGB点转换为相应的HSI彩色模型中的点。
关于图6.12中的立方体结构及其对应的HSI彩色空间，要记住的一个关键点是，HSI空间由一个
垂直强度轴和位于与该强度轴垂直的平面内的彩色点的轨迹表示。当平面沿强度轴上下移动时，由每
个平面与立方体表面构成的横截面定义的边界不是三角形就是六边形。这种情况如图6.13(a)所示，
沿其灰度轴向下看，这一点就会清楚得多。在这个平面中，我们可以看到原色是按120°分隔的，二
次色与原色相隔60°,这意味着二次色之间也相隔120°。图6.13(b)显示了相同的六边形和任意一个
彩色点(显示为一个点)。该点的色调由来自某参考点的一个角度决定。通常(并非总是如此),与红轴
的0°角指定为0色调，从这里开始色调逆时针增长。饱和度(距垂直轴间的距离)是从原点到该点的
向量长度。注意，原点是由该彩色平面的横截面与垂直强度轴来定义的。HSI彩色空间的重要分量是
垂直强度轴、到一个彩色点的向量长度和该向量与红轴的夹角。因此，如图6.13(c)和图6.13(d)所示，
HSI平面以刚刚讨论的六边形、三角形，甚至一个圆形的形式出现也很常见。实际上选择什么形状无
关紧要，因为这些形状中的任何一个都可以通过几何变换转换为其他两种形状。图6.14显示了基于彩
色三角形和圆形的HSI模型。
第6章 彩色图像处理
bcd 绿色黄色
青色 白色 红色
蓝色 深红色
绿色 黄色 绿色 黄色 绿色
S
青色 H
红色 青色 黄色
s.H
青色 红色
蓝色 深红色 蓝色 深红色 红色 蓝色 深红色
图6.13 HSI彩色模型中的色调和饱和度。黑点是一个任意彩色点。与红轴的夹角给出了色调，向
量的长度是饱和度。这些平面中的所有彩色的强度由垂直强度轴上的平面的位置给出
白色 a
b ./-0.75
绿色
青色 H
黄色
1=0.5 蓝色 s 红色 深红色
黑色
白色
/=0.75
绿色 黄色
05 H
青色 S 红色
蓝色 深红色
黑色
图6.14 基于(a)三角形和(b)圆形彩色平面的HSI彩色模型。三角形和圆形平面垂直于垂强度轴
259
度：百
密
260 数字图像处理(第三版)
从RGB到HSI的彩色转换
给定一幅RGB 彩色格式的图像，每个RGB 像素的H分量可用
下式得到：
B≤G H=136-0. B>G (6.2-2)
其中①,
饱和度分量由下式给出：
S=1-(R+G+B)[mic(R,G.B]
由RGB到HSI或从HSI到RGB
的计算是逐个像素执行的。为表述
清晰，我们省略了转换公式对(x,y)
依赖性。
(6.2-3)
最后，强度分量由下式给出：
1=3(R+G+B) (6.2-4)
如图6.13中指出的那样，假定RGB值已归一化到区间[0,1]内，且角度θ根据HSI空间的红轴来度量。
式(6.2-2)到式(6.2-4)中的结果可由图6.12和图6.13所示的几何关
系推得。这一推导很烦琐，而且对现在的讨论没有太大意义。对这些
公式的证明及对下面的HSI至RGB转换结果感兴趣的读者，可以参
考本书的参考文献或网站。
色调可以用式(6.2-2)得到的所有值除以360°归一化为[0,1]范围内。如果给定的RGB值在区间[0.1]
内，则其他两个HSI分量已经在区间[0.1]内了。 关于RGB和HSI之间及HSI
和RGB 之间的转换公式的详细推导
过程，请读者参阅本书网站上的
Tutoriaks部分。
从HSI到RGB的彩色转换
在[0,1]内给出HSI值，现在我们想要在相同的值域找到对应的RGB值。可用的公式取决于H
的值。在原色分隔中有3个相隔120°的扇区(见图6.13)。我们从H乘以360°开始，这时的色调值回
到原来的范围[0°,360°]内。
RG扇区(0°≤H<120°):当H的值在该扇区中时，RGB分量由以下公式给出：
B=1(1-S) (6.2-5)
R=11+s60°-] (6.2-6)
G=31-(R+B) (6.2-7)
GB扇区(120°≤H<240°):如果给定的H值在该扇区中，则首先从H中减去120°,即
H=H-120° (6.2-8)
①在该表达式中加一个较小的数可避免在R=G=B时被零除的情形(即θ为90的情形)。注意，当所有的RGB分量相等时，由
式(6.2-3)可得出S=0。此外，式(6.2-5)至式(62-7)中的由HSI至RGB的转换将给出R=G=B=1.这是我们期望的结果。因
为当R=G=B时，我们处理的图像是灰度级图像。
第6章 彩色图像处理 261
则RGB分量为
R=1(1-S) (6.2-9)
c=1+s60°-] (6.2-10)
B=31-(R+G) (6.2-11)
BR扇区(240°≤H<360°):最后，如果H的值在该扇区中，则从H中减去240°,即
H=H-240° (6.2-12)
则RGB分量为
G=1(1-S) (6.2-13)
B=1+s6o0-] (6.2-14)
R=3/-(G+B) (6.2-15)
这些公式在图像处理中的用法将在下面各节加以讨论。
例6.2 对应于RGB彩色立方体图像的HSI值。
图6.15显示了图6.8中所示RGB值的色调、饱和度和强度图像。图6.15(a)是色调图像，其最大的特点
是立方体前(红)平面沿45°线的值是不连续的。为理解不连续的原因，可参见图6.8,从立方体的红色顶
点到白色顶点画一条线，并在这条线的中间选择一点。从该点开始，向右环绕立方体一周直到回到开始
点画一条轨迹。在该路径中出现的主要颜色是黄色、绿色、青色、蓝色、深红色、黑色直至红色。根
据图6.13,沿该路径的色调值应该从0°到360°增加(即从色调的最低可能值到最高可能值)。这正好如图6.15(a)
所示的那样，因为在灰度级中最低值代表黑色，最高值代表白色。事实上，这幅色调图像原本已被归一
化到[0,1]范围内，然后被缩放到8比特，即在显示时转换到了[0,255]范围内。
图6.15(b)中，饱和度图像显示出，从暗值逐渐向RGB 立方体的白顶点过渡，颜色越来越少，饱和
度越来越低。最后，图6.15(c)所示强度图像中的每个像素值是图6.8中相应像素处 RGB值的平均。
a b c
图6.15 图6.8中图像的HSI分量：(a)色调图像；(b)饱和度图像：(c)强度图像
处理HSI分量图像
在下面的讨论中，我们考察处理 HSI分量图像的几种简单技术，以便帮助您熟悉这些分量并加
深对HSI 彩色模型的理解。图6.16(a)显示了一幅由RGB原色和二次色组成的图像。图6.16(b)到
图6.16(d)显示了这幅图像的H,S和1分量图像，这些图像是用式(6.2-2)到式(6.2-4)产生的。回顾一下
本节早些时候的讨论，图6.16(b)中的灰度值对应于角度；例如，因为红色对应于0°,所以图6.16(a) 密
435
262 数字图像处理(第三版)
中的红区域被映射到色调图像中的一个黑色区域。类似地，图6.16(c)中的灰度级对应于饱和度(为了
显示，它们被放大到[0.255]),图6.16(d)中的灰度级是平均强度。
为在RGB图像中更改任何区域的个别颜色，我们可以改变图6.16(b)所示色调图像中相应区域的
值。然后用式(6.2-5)到式(6.2-15)中说明的步骤，将新的H图像和没有变化的S图像与1图像一起变
换回RGB图像。为了改变任何区域中颜色的饱和度(纯度),除了在HSI空间改变饱和度之外，可
采用相同的步骤。类似的方法可用于更改任何区域的平均强度。当然，这些改变可同时进行。例如，
图6.17(a)中的图像是通过将对应于图6.16(b)中的蓝色、绿色区域的像素变为0得到的。在图6.17(b)
中，我们将图6.16(c)的分量图像S中的青色区域的饱和度减少一半。在图6.17(c)中，我们把图6.16(d)
所示强度图像中心的白色区域的强度降低一半。把改进后的HSI图像转换回RGB彩色空间的结果显
示在图6.17(d)中。正如预期的那样，在这些图中我们看到，所有圆形的外部区域现在是红色的，青
色区域的纯度降低了，中心区域变成了灰色而不再是白色。显然这些结果很简单，但却清楚地显示出
了HSI模型独立控制色调、饱和度和强度的能力。当描述彩色时，我们会十分熟悉这些量。
a b c d
a b
cd
图6.16(a)RGB图像及其对应的HSI图像的分
量；(b)色调；(c)饱和度；(d)强度
图6.17 (a)~(c)修改后的HSI分量图像；(d)最
终的RGB图像(原始的HSI图像见图6.16)
6.3 伪彩色图像处理
伪彩色(也称为假彩色)图像处理是指基于一种指定的规则对灰度值赋以颜色的处理。术语伪彩
色或假彩色用于区分对单色图像赋予彩色的处理和与真彩色图像相关的处理，真彩色图像是在6.4节
中开始讨论的主题。伪彩色的主要应用是人目视观察和解释单幅图像或序列图像中的灰度级事件。正
如本章开始时指出的那样，利用彩色的主要动力之一是人类可以辨别几千种色调和强度，而相比之下
只能辨别20多种灰度。
6.3.1 灰度分层
灰度分层(有时称为密度分层)和彩色编码技术是伪彩色图像处理的最简单的例子之一。如果一
幅图像被描述为三维函数[见图2.18(a)],则分层方法可以看成是放置一些平行于该图像的坐标平面
的平面，然后，每个平面在相交的区域中“切割”图像函数。图6.18显示了使用位于f(x,y)=l处的
一个平面把该图像函数切割为两部分的一个例子。
①灰度分层在有些译著中也称为灰度分割—译者注。
第6章 彩色图像处理 263
f(x,y) 灰度轴
(白色)L-1 切割平面
(黑色)0
x
图6.18 灰度分层技术的几何解释
如果对图6.18中平面的每一侧赋以不同的颜色，平面上面的任何灰度级的像素将编码成一种彩
色。该平面之下的任何像素将编码成另一种颜色。位于平面上的灰度级本身被任意赋以两种彩色之一。
结果是一幅只有两种颜色的图像，其相对应的外观可通过沿灰度轴上下移动这个切割平面来控制。
通常，该技术可总结如下：令[0,L-1]表示灰度级，令代表黑色[f(x,y)=0],并令L代表白
色[f(x,y)=L-1]。假定垂直于灰度轴的P个平面定义为灰度级l,?…,Ip。然后，假定0<P<L-1,
P个平面将灰度分为P+1个区间V,,V?…,Vp+1。灰度级到彩色赋值根据如下关系进行：
f(x,y)=c f(x,y)∈V (6.3-1)
其中c是与第k个灰度区间V有关的颜色，V由位于l=k-1
和l=k处的分割平面定义。
c2
颜色c 平面的概念对于灰度分层技术的几何解释很有用。图6.19
给出了另一种解释，它定义了如图6.18所示的相同映射。根
据图6.19中显示的映射函数，任何输入的灰度级根据其是位
于L值的上面还是下面而赋予两种颜色之一。当用更多的灰
度级时，映射函数采用一种阶梯形式。
0 L-1
灰度级
图6.19 灰度分层技术的另一种表示
例6.3 灰度分层。
一种简单而实用的灰度分层法示于图6.20。图6.20(a)是Picker 甲状腺模型(放射实验模型)的单色图
像，图6.20(b)是灰度分层结果，图像分为8个彩色区域。在单色图像中出现恒定灰度区也是完全可变的，
如切割过的图像中的各种颜色所示。例如，左瓣在单色图像中是暗灰色的，以灰度形式分辨出病变是很
困难的。相比之下，彩色图像清楚地显示出了恒定灰度区域的8个不同的区域，其中每一区域采用一种
颜色。
在前面这个简单的例子中，灰度被分为几个区间，且每个区域赋予了不同的颜色，而未考虑到
图像中灰度级的意义。在那种情况下，感兴趣的只是简单地观察构成图像的不同灰度级。当灰度级细
分基于图像的物理特性时，灰度分层有很大意义并承担着重要角色。例如，图6.21(a)所示的含有裂
纹和孔隙(水平通过图像中部的亮的白色条痕)的焊接物X光图像(水平暗区)。我们知道，当焊接物
中有裂纹和孔隙时，X射线的全部强度都通过物体，使位于物体另一边的成像传感器饱和(见2.3节)。 密
虚吉
264 数字图像处理(第三版)
这样，来自这一系统的8比特图像中的图像灰度值为255.自动地意味着焊接有问题。如果人是分析
的最终判断者，并采用人工处理来检测焊接质量(直至今天，这仍是常用的工序),将一种颜色赋给
255这个灰度级而将另一种颜色赋给所有其他灰度级的简单彩色编码就会极大地简化检测者的工作。
图6.21(b)显示了这一结果。如果以图6.21(b)的形式而不以图6.21(a)的形式来显示图像，“人的误
识率将降低”这一结论毋庸置疑。换句话说，如果所寻找的确切的灰度值或值域是已知的，则灰度
分层在可视化方面是简单而有力的辅助手段，特别是涉及大量图像时更是如此。下面是一个更为复
杂的例子。
a b
图6.20(a)Picker甲状腺模型的单色图像；(b)密度分层为8种颜色的结果(原图像
由美国Oak Ridge国家实验室仪器与控制分部的J.L.Blankenship博士提供)
a b
图6.21(a)焊缝的单色X射线图像；(b)彩色编码的结果(原图像由X-TEK系统有限公司提供)
例6.4 使用彩色突出降雨量。
测量地球上各区域(尤其是热带区域)的降雨量，在与环境有关的各种应用中是很重要的。用地面的
传感器准确测量是困难的，而且代价昂贵，并且得到总雨量图尤为困难，因为重要的降雨区都发生在海
洋上。获得降雨量图的一种方法是使用卫星。TRMM(Tropical Rainfall Measuring Mission,热带降雨量测
量任务)卫星使用为检测降雨而特殊设计的3个传感器：一个降雨雷达、一个微波成像仪和一个可见光及
红外扫描仪(关于图像传感模式，请参阅1.3节和2.3节)。
来自各个雨量传感器的结果经处理后，得出传感器监视区域在给定时间段的平均降雨量的估计。
从这些估计生成其灰度值直接对应于降雨量的灰度图像并不困难，每个像素代表自然的陆地面积，其大
小取决于传感器的分辨率。这样的一幅灰度图像示于图6.22(a),其中，由卫星监视的区域是在图像中
间的三分之一处稍亮一些的水平带(即热带区域)。在这个特殊的例子中，降雨值是三年时间内的月平
均值(单位为英寸)。
第6章 彩色图像处理 265
对于降雨模式，目测这些图像也是十分困难的，甚至是不可能的。然而，假设使用图6.22(b)所示的
彩色对0到255灰度级编码，那么趋于蓝色的值意味着低降雨量，相反则为红色。注意，标度终止于纯红
色处，表示降雨量大于20英寸。图6.22(c)显示了使用刚才讨论的用彩色映射对灰度图像进行彩色编码的结
果。如图6.22(c)和图6.22(d)的放大区域所示，这些结果更易于解释。另外，除了提供全球覆盖外，这种类
型的数据允许气象工作者使用比以往更精确的方法来标定基于地面的雨量监控系统。
a b c d
图6.22 (a)与月平均降雨相对应的灰度图像；(显示为较亮的水平条带)(b)赋给
灰度值的颜色；(c)彩色编码的图像；(d)南美区域的放大图(NASA提供)
6.3.2 灰度到彩色的变换 红色变换 fr(x,y)
与前一节讨论的简单分层技术相比，其他类
型的变换更通用，也更能拓宽伪彩色增强结果的范
围。一种特别有吸引力的方法如图6.23所示。这一
方法的基本概念是对任何输入像素的灰度执行3个
独立的变换。然后，将3个变换结果分别送入彩色
电视监视器的红、绿、蓝通道。这种方法产生一幅
合成图像，该合成图像的彩色内容由变换函数的特
性调制。注意，这些方法是对一幅图像的灰度值进
行变换，而不是位置函数。
f(x.y) 绿色变换 fa(x.y)
蓝色变换 Ja(x,y)
图6.23 伪彩色图像处理的功能框图。fnf和。被分
别送入 RGB彩色监视器的红、绿和蓝输入
前一节讨论的方法是刚描述的技术的一种特殊情况。这里，灰度级的分段线性函数(见图6.19)
用来产生颜色。另一方面，本节讨论的方法是以平滑的非线性函数为基础的，正如所希望的那样，这
就在技术上给出了相当大的灵活性。
例6.5 突出行李内包含的爆炸物的伪彩色应用。
图6.24(a)显示了由机场X射线扫描系统得到的行李的两幅单色图像。左侧的图像含有普通物品，右
侧的图像含有相同的物品及一块塑料仿真爆炸物。这个例子的目的是说明使用灰度级到彩色的变换得到
不同程度的增强。
图6.25显示了所用的变换函数。这些正弦函数包含有在波峰附近相对恒定的区域和在波谷附近迅速
变化的区域。改变每个正弦函数的相位和频率可(以彩色)强调灰度级范围。例如，如果所有3个变换都 固手
266 数字图像处理(第三版)
有相同的相位和频率，则输出图像将是单色的。3个变换函数间相位上的细小变化可产生对应于正弦波峰
的灰度像素的微小变化，特别是在正弦波有着较宽的曲线(低频)时。由于正弦波间的相位位移导致的3
个正弦波的幅度间的明显不同，位于正弦波陡峭部分的那些灰度级的像素被赋予更强的彩色内容。
e 长 a bc
图624 使用图6.25所示灰度级到彩色的变换的伪彩色增强(原图像由Westinghouse公司的Mike Hurwiz博士提供)
L-1 L-1
红色 红色
L-1 L-1
绿色 绿色
L-1 L-1
蓝色 蓝色
灰度 0 L-1
a b 爆炸物 0 L
灰度
衣袋 背景 爆炸物 衣袋 背景
图6.25 用于得到图6.24所示图像的变换函数
图6.24(b)所示图像是使用图6.25(a)中的变换函数得到的，它显示了与爆炸物、衣袋和背景分别对应
的灰度范围。注意，爆炸物和背景有着相当不同的灰度级，但是由于正弦波的周期性，它们都使用近似
相同的颜色编码。示于图6.24(c)的图像是用图6.25(b)所示的变换函数得到的。在这种情况下，爆炸物和
衣袋的灰度范围由相似的变换映射，这样，可基本上得到相同的彩色赋值。注意，这种映射允许观察者
“看透”爆炸物。背景映射与图6.24(b)所用的函数相同，产生几乎相同的彩色赋值。
李,
图6.23所示的方法以一幅单色图像为基 8i(x,y) 础。通常，如图6.26 所示，将多幅单色图像组
合为一幅彩色合成图像是很重要的。在多光谱
图像处理中常使用这一方法(如例6.6所示),这
里，不同的传感器在不同的谱段产生独立的单
fi(x,y) 变换T
其他处理
h(x.y)
82(x,y)
J?(x.y) 变换T? ha(x.y)
色图像。图6.26所示的附加处理可以是彩色平
衡(见6.5.4节)、混合图像，以及以产生图像的
传感器响应特性的知识为基础来选择三幅用于
显示的图像等技术。
sx(x,y)
fx(x,y) 变换Tx ha(x,y)
图6.26 几幅单色图像可用时，所用的伪彩色编码方法
例6.6 多光谱图像的彩色编码。
图6.27(a)到图6.27(d)显示了4幅华盛顿特区的光谱卫星图像，包括波托马克河的一部分。前3幅图
像是可见光的红、绿、蓝图像，第4幅图像是近红外图像(见表1.1和图1.10)。图6.27(e)是把前3幅图像
第6章 彩色图像处理 267
合成为一幅RGB图像后得到的全彩色图像。密集区域的全彩色图像很难判读，但该图像的一个显著特点
是波托马克河的各部分颜色不同。图6.27(f)较为有趣，这幅图像是用近红外图像代替图6.27(e)的红色分
量形成的。从表1.1 可知，这一波段对场景中的生物分量有较强的反应。图6.27(f)显示了生物(红色)和
场景中人造特征间的明显区别，由混凝土和柏油组成的的部分在图像中显示为浅蓝色。
dei
图6.27(a)-(d)图1.10中的1到4波段的图像(见表1.1);(e)将图(a)、(b)和(c)作
为RGB图像的红、绿、蓝分量得到的彩色合成图像；0用相同的方法，但在
红通道使用(d)中的近红外图像得到的图像(原始的多光谱图像由NASA提供)
刚才说明的处理类型，在复杂图像中对感兴趣事物进行可视化处理的功能很强大，特别是当这些事务超出
了我们的正常感知能力的时候。图6.28对此是很好的说明。这些图像是通过把来自“伽利略”宇宙飞船的几
幅传感器图像组合在一起并以伪彩色方式显示的木星卫星Io的图像，其中一些位于人眼不可见的光谱范围。
然而，通过了解物理和化学处理会影响传感器响应，将感知图像组合为一幅有意义的伪彩色图中是可能的。
组合感知图像数据的一种方法在于如何显示表面化学成分的差别，或者改变表面反射太阳光的方式。例如，
在图6.28(b)所示的伪彩色图像中，亮红色表示木星卫星Io 上活火山最近喷出的物质，而周围的黄色物质是
陈旧的硫沉积物。这幅图像传达这些特征要比分别分析分量图像更容易。
a b|
图6.28(a)木星卫星Io的伪彩色图像；(b)靠近摄取的图像(原图像由NASA提供)
6.4 全彩色图像处理基础
在这一节中，我们开始研究可用于全彩色图像的处理技术。虽然，该技术的研究远未穷尽，但
本节接下来阐述的技术说明了面对各种图像处理任务如何处理彩色图像。全彩色图像处理方法分为两 匿，封
禹;年
268 数字图像处理(第三版)
大类。第一类是分别处理每一幅分量图像，然后由分别处理过的分量图像来形成一幅处理过的合成彩
色图像。第二类是直接处理彩色像素。因为全彩色图像至少有3个分量，所以彩色像素实际上是向量。
例如，在RGB系统中，每个彩色点可以用RGB坐标系统中从原点延伸到该点的一个向量来解释(见
图6.7)。
令c代表RGB彩色空间中的一个任意向量：
(6.4-1)
该式指出，c的分量仅是一幅彩色图像在一点处的RGB分量。我们可以这样认为，彩色分量是坐标(x,y)
的函数，表示为
a (6.4-2)
对于大小为M×N的图像，有MN个这样的向量c(x,y),其中x=0,1,2…,M-1;y=0.1,2,…,N-1。
记住，式(6.4-2)描述的向量是很重要的，其分量是关于x和y的空间变量。这常常是产生混淆的
根源，但通过将重点放在我们感兴趣的是空间处理这一事实上，可以避免混淆。也就是说，我们对以
x和y的公式来表达图像处理技术感兴趣。根据像素现在是彩色像素的事实引入一个因子，在其最简
单的公式中允许我们用标准的灰度图像处理方法分别处理彩色图像的每一分量。然而，单个彩色分量
处理的结果并不总等同于彩色向量空间中的直接处理，在这种情况下，我们必须采取新的表达方法。
为了使每种彩色分量处理和基于向量的处理等同，必须满足两个条件：第一，处理必须对向量
和标量都可用；第二，对向量的每一分量的操作对于其他分量必须是独立的。作为一个说明，图6.29
显示了灰度图像和全彩色图像的邻域空间处理。假定该处理是邻域平均。在图6.29(a)中，平均是将
邻域内的所有像素的灰度相加，然后除以邻域内的像素总数。在图6.29(b)中，平均是把邻域内的所
有向量相加，并用邻域内的向量总数去除每个分量。但平均向量的每个分量是对应于该分量的图像中
的像素总和，这与在每个彩色分量基础上做平均，然后再形成向量所得到的结果是相同的。接下来的
几节将详细说明这一处理。还要示出一种方法，在这种方法中，两种处理结果是不同的。
a b
空间模板
灰度图像
(x.y)
空间模板
灰度图像
图6.29 灰度图像和RGB彩色图像的空间模板
6.5 彩色变换
本节讨论的技术总称为彩色变换，主要涉及在单一彩色模型内处理彩色图像的分量，而不是这
些分量在不同模型间的转换(如6.2.3节的RGB到HSI和HSI到RGB的转换)。
第6章 彩色图像处理 269
6.5.1 公式
如第3章的灰度变换技术那样，我们用下式表达的彩色变换作为模型：
g(x,y)=T[f(x,y)] (6.5-1)
其中f(x,y)是彩色输入图像，g(x,y)是变换后或处理过的彩色输出图像，T是在(x,y)的空间邻域上对f
的一个算子。该式与式(3.1-1)的主要区别在于其描述。这里，像素值是从彩色空间选择的用来表示
图像的彩色空间的3元组或4元组(即3个值或4个值的组合),如图6.29(b)所示。
类似于3.2节中用于介绍基本灰度变换的方法，本节仅关注形如
s,=T?(F,z?,…,r),i=1,2,…,n (6.5-2)
的彩色变换，其中，为标记简单起见，r和s,是fx,y)和g(x,y)在任何点处彩色分量的变量，n是彩
色分量数，(Tj.T?…,T.}是对r,操作产生s,的一组变换或彩色映射函数。注意，n个变换工合并可执
行式(6.5-1)中的单一变换函数T。所选择的用于描述f和g的像素的彩色空间决定n的值。例如，如
果选择RGB彩色空间，则n=3,且r,r?和r,分别表示输入图像的红、绿、蓝分量。如果选择CMYK
或HSI彩色空间，则n=4或n=3。
图6.30显示了一碗草莓和一杯咖啡的高分辨率彩色图像，这是对大幅面(4英寸×5英寸)彩色底
片数字化后得到的图像。图中的第二行包含原始的CMYK扫描分量图像。在这些图像的每个CMYK
彩色分量中，黑用0表示，白用1表示。这样，我们看到草莓由大量的深红色和黄色组成，因为对应
于这两种CMYK 分量的图像最亮。黑色较少，并通常仅限于咖啡和草莓碗中的阴影。当CMYK图
像被转换为RGB时，如图中第三行所示，可以看到草莓包含大量的红色和很少的绿色与蓝色。图6.30
的最后一行显示了使用式(6.2-2)到式(6.2-4)计算出的图6.30(a)的HSI分量图像。如所期望的那样，
强度分量是全彩色原始图像的单色再现。另外，草莓的颜色相对较为纯净。它们具有最高的饱和度，
或图像中色调被白光稀释得最少。最后，我们注意到解释这幅色度分量图像时的一些困难。其中包含
这样一些事实：(1)在HSI模型中，0°和360°相遇处有一个不连续点；(2)色调对于0饱和度(即对白
色、黑色和纯灰色)未定义。模型的不连续点多出现在草莓周围，它们用接近白(1)和黑(0)的灰度值
描述，其结果是用不希望的高对比灰度级来表示单一颜色——红色。
图6.30中的任何彩色空间分量都可与式(6.5-2)共同运用。理论上，任何变换都可在任何彩色模
型中执行。然而，实际上，某些操作对特定的模型比较适用。对于一个给定的变换，表示法之间转换
的代价是必须判定相关的彩色空间，然后再在该空间上执行该转换。例如，假设我们想要使用下式来
改进图6.30中的全彩色图像的强度：
g(x,y)=kf(x,y) (6.5-3)
其中0<k<1。在HSI彩色空间中，使用如下的简单变换来完成：
S?=kr? (6.5-4)
其中s?=r?和s?=r?。仅有HSI强度分量r,被改变。在RGB彩色空间中，3个分量都必须变换：
s?=kr,i=1,2,3 (6.5-5)
CMY空间要求一组类似的线性变换集：
s=kj+(1-k), i=1,2,3 (6.5-6)
虽然HSI变换包含的操作最少，但把 RGB图像或CMYK 图像转换至HSI空间所要求的计算
量大大抵消了简单变换的优点，即转换的计算量比强度变换本身的计算量大。然而，若不考虑所选 :恩
450 S
270 数字图像处理(第三版)
择的彩色空间，则其输出是相同的。图6.31(b)显示了采用式(6.5-4)到式(6.5-6)对图6.30的全彩色图
像用k=0.7进行变换后的结果。映射函数示于图6.31(c)到图6.31(e)中。
全彩色
青色 深红色 黄色 黑色
红色 绿色 蓝色
色调 饱和度 灰度
图6.30 全彩色图像及其各种彩色空间分量(原图像由MedData Interactive公司提供)
d
1
k
1 1
k
1-kr
LB M S
0 0 1 0 0
图6.31 用彩色变换调整一幅图像的亮度：(a)原图像：(b)亮度降低30?的结果(即k=0.7);
(c)-(e)所需的RGB,CMY和HSI变换函数(原图像由MedData Interactive公司提供)
注意，式(6.5-4)到式(6.5-6)所定义的每一个变换仅依赖于其彩色空间的一个分量，这一点很重
要。例如，红输出分量S,在式(6.5-5)中独立于绿(r?)输入和蓝(r?)输入.它只依赖于红(r,)输入。正如
开始讨论时所提到的那样，这类变换是最简单的和最常用的彩色处理工具，并可以在每个彩色分量上
执行。在本节余下的部分，我们研究几种这样的变换并讨论这样一种情况，在这种情况下，分量变换
第6章 彩色图像处理 271
函数依赖于输入图像的所有彩色分量，因此不能以单独彩色分量为
基础进行变换。 蓝色 深红色
6.5.2 补色 青色 补色 红色
在图6.32所示的彩色环上，与色调直接相对的另一端被称为
补色。对补色的兴趣源于这样一个事实，即补色类似于3.2.1节的灰
度负值。正如在灰度情况下那样，补色对于增强嵌在彩色图像暗区
的细节很有用——特别是区域在大小上占优势时。
绿色 黄色
图6.32 彩色环上的补色
例6.7 计算彩色图像的补色。
图6.33(a)和图6.33(c)显示了来自图6.30的全彩色图像及其补色图像。用于计算补色的RGB变换如
图6.33(b)所示。它们等同于3.2.1节中定义的灰度负变换。注意，计算的补色使人想到通常照片的彩色底
片。原图像的红色被补色中的青色替代。当原图像是黑色时，补色是白色，依此类推。补色图像中每种
色调都用图6.32的彩色环由原图像预测，且涉及补色计算的每个RGB分量变换仅是对应的输入彩色分量
的一个函数。
与图6.31的亮度变换不同，在这个例子中使用的RGB补色变换函数没有直接的HSI空间的等效量。
我们将其作为一个练习留给读者(见习题6.18),要求说明补色的饱和度分量不能单独从输入图像的饱和度
分量计算出来。图6.33(d)提供了一种使用图6.33(b)给出的色调、饱和度和亮度变换的补色的近似。注意，
输入图像的饱和度分量是不可改变的；它造成了图6.33(c)和图6.33(d)之间的视觉差别。
1 1
0
LG H
0
15
0 0
图6.33 补色变换：(a)原图像；(b)补色变换函数；(c)基于RGB映射
函数的图(a)的补色；(d)使用HSI变换的RGB补色的近似
6.5.3 彩色分层
突出图像中某个特定的彩色区域对从其周围分离出目标物是很有用的。其基本思路不是(1)显示
感兴趣的颜色以便从背景中突出它们，就是(2)像模板那样使用由彩色定义的区域，以便进一步处理。
①该彩色环源自艾萨克·牛顿(lsac Newton)先生，他于17世纪连接了彩色谱的末端从而形成了第一个彩色环 固;臣
固
272 数字图像处理(第三版)
最直接的方法是延伸3.2.4节的灰度分层技术。然而，因为一个彩色像素是一个n维参量，得到的彩
色变换函数要比图3.11中对应的灰度变换函数复杂得多。事实上，所要求的变换比到目前为止所考虑
的彩色分量变换要复杂得多。这是因为所有彩色分层方法都要求每个像素变换后的彩色分量是所有n
个原始像素的彩色分量的函数。
对一幅彩色图像分层的最简方法之一是，把某些感兴趣区域之外的彩色映射为不突出的无确定
性质的颜色。如果感兴趣的颜色由宽为W、中心在原型(即平均)颜色点并具有分量(a,a,…,a)的立
方体(或超立方体，此时n>3)所包围，则必要的一组变换为
k2 (6.5-7)
这些变换通过强迫所有其他颜色为参考彩色空间的中点(一个任意选取的中性点),来突出原型周围的
颜色。例如，对于RGB彩色空间，一个合适的中性点是灰度或彩色的中点(0.5,0.5,0.5)。
如果使用一个圆球体来指定感兴趣的颜色，则式(6.5-7)变为
i=1,2,…,n (6.5-8)
其中R?是封闭球形(或超球形，此时n>3)的半径，(a,a?,…,a)是其中心的分量(即原型颜色)。式(6.5-7)
和式(6.5-8)的其他有用变量包括实现多个彩色原型和在感兴趣区域之外减小颜色的亮度，而不是对
它们赋予中性值。
例6.8 彩色分层的说明。
式(6.5-7)和式(6.5-8)可用于图6.31(a)中，以便把可食用的草莓部分从背景杯、碗、咖啡和桌子中分
离出来。图6.34(a)和图6.34(b)显示了使用两种变换后的结果。在每种情况下，从最突出的草莓中选择具
有RGB彩色坐标(0.6863,0.1608,0.1922)的原型红色；选择W和R,,以便使重要区域不会扩展到不希望
的图像区域。实际值W=0.2549和R?=0.1765是交互确定的。注意，式(6.5-8)中基于球形的变换在包含
更多草莓的红色区域方面要稍好一些。半径为0.1765的球形不会完全包围宽度为0.2549的立方体，但它
本身也不被立方体完全包围。
a b
图6.34(a)检测宽度为W=0.2549、中心在(0.6863,0.1608,0.1922)的RGB立方体内的
红色的彩色分层变换；(b)检测半径为0.1765、中心在相同点的RGB球形中
的红色的彩色分层变换。处在立方体和球形之外的像素由颜色(0.5.0.5,0.5)代替
第6章 彩色图像处理 273
6.5.4 色调和彩色校正
彩色变换可在多数台式计算机上执行。与数字摄像机、平板扫描仪和喷墨打印机相连，个人计
算机就变成了数字暗室，从而允许我们对图像进行色调调整和彩色校正，高级彩色重现系统不需要配
备传统的湿式处理(暗室)设备即可进行这些处理。虽然色调和彩色校正在其他成像领域也很有用，但
当前讨论重点关注的是其最普通的应用——照片增强和颜色再现。
本节研究的变换效果最终是在打印中进行评价的。因为这些变换是在监视器上研究、改进和评
价的，所以在所用监视器和最终输出设备之间保持色彩的高度一致性是必要的。事实上，监视器的颜
色应准确地表示任何数字扫描的源图像和最后的打印输出。这最好用独立于设备的彩色模型来实现，
这种彩色模型与监视器、输出设备及所用的任何其他设备的色域有关(见6.1节)。这种方法的成功是
用来把每个设备映射到该模型及该模型本身的色彩分布质量的函数。许多彩色处理系统(CMS)选择
的模型是CIE L*a*b*模型，也称为CIELAB(CIE[1978],Robertson[1977)。L*a*b*彩色分量由如下公
式给出：
t=16A长)-16 (6.5-9)
2=500)- (6.5-10)
=2000长)-】 (6.5-11)
其中，
n9)-{287+16/16q>0.008 856
q≤0.008 856 (6.5-12)
且XwYw和Zw是参考白色三激励值，即CIE标准D65照度下的一种完美的漫反射白色(在图6.5所
示的CIE 色度图中，由x=0.3127和y=0.3290定义)。L*a*b*彩色空间是比色的(即与感觉色相匹配
的编码相同)、感觉一致的(即在各种色调中颜色差别感觉上是一致的，见Mac Adams[1942]的经典论
文)和独立于设备的。虽然没有可直接显示的格式(需要变换到另外的彩色空间),但其色域包括整个
可见光谱，并可以准确地表示任何显示设备、打印设备或输入设备的颜色。类似HSI系统，L*a*b*
系统是一种优秀的亮度(由亮度L*表示)和彩色(a*表示红减绿，b*表示绿减蓝)分离器，使得它在图
像操作(色调和对比度编辑)和图像压缩方面很有用。
标定成像系统的主要意义是，它允许交互和独立地校正色调和色彩的不平衡，即按两个顺序操
作。在诸如过饱和及欠饱和这样的不规则色彩问题解决之前，先要校正图像的色调范围。一幅图像的
色调范围(也称为主调类型)是指颜色强度的基本分布。高主调图像的多数信息集中在高(亮)强度处；
低主调图像的颜色主要位于低亮度处；中主调图像的颜色则位于两者之间。正如在单色情况下那样，
通常期望一幅彩色图像的强度均匀分布在高亮和阴影之间。下面的几个例子说明了用于校正色调和色
彩不平衡的各种彩色变换。
①研究表明。Lab*中照度(亮度)信息与彩色信息分离的程度要大于其他彩色模型中F如CIELUv,YIo, YUV.YCC和
xYZ(Kasson andPlouffe[1992D]的相应程度 受臣
索
274 数字图像处理(第三版)
例6.9 色调变换。
改善图像色调的变换通常交互地选择。其概念是实验性地调整图像亮度和对比度，以便在合适的灰
度范围提供最多的细节。彩色本身并不改变。在RGB和CMY(K)空间中，这意味着使用相同的变换函数
映射所有3(或4)个彩色分量；在HSI彩色空间中，则改进了亮度分量。
图6.35显示了用于校正3种常见的色调不平衡的几个典型变换——即平淡的、较亮的和较暗的图像。图
中第一行的S形曲线对提升对比度较为理想[见图3.2(a)]。其中点被固定，因此高亮区域和阴影区域可分别
变暗和加亮(该曲线反过来可用于校正过大的对比度)。图中第二行和第三行中的变换校正较亮图像和较暗图
像，并使人想起图 3.6中的幂律变换。虽然彩色分量是离散的，如现在的实际变换函数，但这些变换函数本
身以连续量显示和操作——典型地由分段线性或高阶(对平滑映射)多项式构造。注意，在图6.35中、图像
的主调是直接可观察的；它们还可以用图像彩色分量的直方图来确定。
1
R.G,B
平淡图像 校正后的图像 0
R.G,B
较亮图像 校正后的图像 0
R,G,B
较暗图像 校正后的图像 0
图6.35 对平淡的、较亮的(高主调)、较暗的(低主调)彩色图像的色调校
正。等量地调整红、绿、蓝分量并不总能显著地改变图像色调
例6.10 彩色平衡。
正确地确立一幅图像的色调特性后，就可着手进行彩色平衡工作。虽然彩色平衡可以通过客观地(使
用光谱仪)分析一幅图像中的已知颜色来决定，但当存在白色区域时，即这里RGB 或CMY(K)分量相等
时，准确的视觉评估是可能的。正如在图6.36中所看到的那样，对视觉颜色评估，皮肤色调是优秀的对
象，因为人对固有的肤色高度敏感。鲜明的彩色，如亮红色的物体，当进行视觉彩色评估时并没有什么
价值。
当存在彩色不平衡时，有很多方法来校正它。在调整一幅图像的彩色分量时，认识到每个操作都会影
响到图像的全部彩色平衡是很重要的。也就是说，对一种颜色的感知会受到周围颜色的影响。不过，图6.32
的彩色环可用于预测一个彩色分量如何影响其他彩色分量。例如，基于该彩色环，任何颜色的比例都可
通过减小图像中相对色(或补色)数量来增大。类似地，提高两种直接邻接颜色的比例或减小与该补色邻
第6章 彩色图像处理 275
接的两种颜色的百分比也可增大颜色的对比。例如，假定一幅RGB图像中有过多的深红色，则可以通过
(1)移去红色和蓝色或(2)增加绿色的方法减少它。
图6.36显示了用于校正简单的CMYK输出不平衡的变换。注意，描述的变换是校正这些图像所要求
的函数。这些函数的反函数用来产生相关的彩色不平衡。这些图像类似于暗室环境下的彩色印相，并且
作为识别彩色打印问题的参考工具很有用。例如，过多的深红色(左下图像)或太少的青色(第二行最右侧
的图像)会导致太多的红色。
原图像/校正后的图像
1
黑色较重 黑色较弱 青色较重 青色较弱
B B C
0 0 0 1 0
1 深红色较重 深红色较弱 1 黄色较重 黄色较弱
M M
0 0 0 1 0 1
图6.36 对CMYK图像的彩色平衡校正
6.5.5 直方图处理
与前一章中介绍的交互式增强方法不同，3.3节的灰度直方图处理变换可自动地应用于彩色图像。
回忆一下，直方图均衡自动地确定一种变换，该变换试图产生具有均匀灰度值的直方图的图像。在单
色图像情况下，业已证明(见图3.20)在处理低、高和中主调图像时是合理而且成功的。然而，由于彩
色图像是由多个分量组成的，所以必须考虑适应多个分量和/或直方图的灰度级技术。正如所预料的
那样，单独对彩色图像的分量进行直方图均衡通常是不明智的，这将产生不正确的彩色。一种更合乎 壹畜
固南
276 数字图像处理(第三版)
逻辑的方法是均匀地展开这种彩色灰度，而保持彩色本身(即色调)不变。下面的例子表明HSI彩色
空间是适合这类方法的理想空间。
例6.11 HSI彩色空间中的直方图均衡。
图6.37(a)显示了包含调味瓶和摇杯的调味瓶架台的一幅彩色图像，其亮度分量(归一化后)的值域
为[0,1]。正如所看到的处理前的[见图6.37(b)]亮度分量直方图那样，图像包含有大量的暗彩色，使得
中间灰度减少到0.36。不改变色调和饱和度，亮度分量直方图均衡的结果图像示于图6.37(c)中。注意，
整个图像都有效地加亮了，并且一些调味瓶和放调味瓶的木桌的纹理现在都能看见。图6.37(b)显示了新
图像的亮度直方图，以及用于均衡亮度分量的变换[见式(3.3-8)]。
虽然亮度均衡处理没有改变图像的色调和饱和度的值，但它的确影响了图像的整体颜色感观。特别
要注意在不振动时瓶中的油和醋。图6.37(d)显示了采用增加图像饱和度分量部分校正该问题的结果。然
后使用图6.37(b)中的变换进行直方图均衡。在处理HSI空间中的强度分量时，这种类型的调整很常见，
因为灰度改变通常会影响图像中颜色的相对表观。
H S
0 1 0
处理前的直方图
(中值-036)
0.5
处理后的直方图
(中值-0.5)
0 0.36
a b cd
图6.37 HSI彩色空间中的直方图均衡(接着是饱和度调整)
6.6 平滑和锐化
在不涉及相邻像素的情况下(如前节那样),对彩色图像的每个像素变换后的下一步是以周围像
素特性为基础改进其值。在这一节中，通过彩色图像的平滑和锐化处理的内容来说明这类邻域处理的
基础。
6.6.1 彩色图像平滑
参考图6.29(a)和3.4节及3.5节的讨论，灰度级图像平滑可以看成是一种空间滤波操作，在这种
操作中，滤波模板的系数具有相同的值。当模板滑过将被平滑的图像时，每一个像素被由该模板定义
第6章 彩色图像处理 277
的邻域中的像素的平均值代替了。正如在图6.29(b)中所看到的那样，这一概念可很容易地扩展到全
彩色图像处理。主要差别是我们必须处理由式(6.4-2)给出的分量向量来替代灰度标量值。
在一幅RGB彩色图像中，令S,表示中心位于(x,y)的邻域定义的一组坐标。在该邻域中RGB分
量的向量平均值为
c???∑c(s (6.6-1)
它遵循式(6.4-2)和向量相加的性质，有
(6.6-2)
我们将该向量的分量视为几幅标量图像，这些标量图像可通过传统的
灰度级邻域处理来单独地平滑原RGB图像的每个平面来得到。这样，
我们可以得出结论：邻域平均平滑可以在每个彩色平面的基础上执
行。其结果与使用RGB彩色向量执行平均是相同的。
例6.12 用邻域平均法平滑彩色图像。
考虑图6.38(a)中的彩色图像，该图像的红、绿、蓝分量图像显示在图6.38(b)到图6.38(d)中。图6.39(a)
到图6.39(c)显示了该图像的HSI分量。基于前一段的讨论，我们用大小为5×5的空间平均模板独立地平
滑图6.38中的RGB图像的每一个分量图像。然后，我们混合这些独立平滑后的图像以形成平滑后的全彩
色结果，结果示于图6.40(a)中。注意，正如在3.5节中给出的几个例子那样，这幅图像显示了我们所希望
的执行空间平滑操作的结果。
在6.2节中，我们曾说明HSI彩色模型的一个重要优点是解除了强度和彩色信息的关系，这就使得它
适合于许多灰度处理技术，并且可能仅对图6.39中HSI描述的亮度分量平滑更有效。为了说明这一方法
的优点和/或重要性，下面我们仅平滑亮度分量(保持色调和饱和度分量不变),并为便于显示把处理结果
转换为RGB图像。平滑后的彩色图像示于图6.40(b)中。注意，该图像类似于图6.40(a),但正如从图6.40(c)
所示的差值图像中看到的那样，两幅平滑过的图像是不同的。这是因为在图6.40(a)中，每一个像素的颜
色是邻域中的像素的平均颜色。另一方面，通过仅平滑图6.40(b)中的亮度分量图像，每个像素的色调和
饱和度不受影响，因此像素的颜色没有变化。由这一观察可知，两种平滑方法间的差别会随着滤波器尺
寸的增加而变得更为显著。
关于向量和矩阵的简要回
顾.请查阅本书的网站
abcd
图6.38 (a)RGB图像；(b)红分量图像；(c)绿分量图像；(d)蓝分量图像 固;吉
臣
278 数字图像处理(第三版)
a be
图6.39 图6.38(a)中的RGB彩色图像的HSI分量：(a)色调；(b)饱和度；(c)亮度
a b c
图6.40 用5×5的平均模板平滑图像：(a)处理每一个RGB分量图像的结果；(b)处
理HSI图像的亮度分量并转换为RGB图像后的结果；(c)两种结果的差别
6.6.2 彩色图像锐化
在这一节，我们考虑采用拉普拉斯方法(见3.6.2节)的图像(尖)锐化处理。从向量分析可知，一
个向量的拉普拉斯被定义为一个向量，其分量等于输入向量的各个标量分量的拉普拉斯。在RGB彩
色系统中，式(6.4-2)中的向量c的拉普拉斯变换为
ra (6.6-3)
正如前节所述，它告诉我们可以通过分别计算每一幅分量图像的拉普拉斯来计算全彩色图像的拉普
拉斯。
例6.13 使用拉普拉斯的锐化。
图6.41(a)是使用式(3.6-7)和图3.37(c)中的模板计算图6.38 中的RGB分量图像的拉普拉斯得到的。
这些结果合并在一起就产生了锐化后的全彩色图像。图6.41(b)显示了基于图6.39中HSI分量的类似的锐
化图像。这一结果是通过合并亮度分量的拉普拉斯和未变化的色调与饱和度分量生成的。RGB和HSI锐
化图像间的差别示于图6.41(c)。两幅图像之间存在这种差别的原因见例6.12。
a b c
图6.41 使用拉普拉斯进行图像锐化：(a)处理每个RGB通道的结果；(b)处
理HSI亮度分量并转换为RGB图像后的结果；(c)两种结果的差别
第6章 彩色图像处理 279
6.7 基于彩色的图像分割
分割是把一幅图像分成多个区域的处理。虽然分割是第10章讨论的主题，但是出于连续性的原
因，这里简单地介绍一下彩色分割。在下面的讨论中，读者不会有理解方面的困难。
6.7.1 HSI彩色空间的分割
如果我们希望以彩色为基础分割一幅图像，并且想在各个平面上执行这一处理，会很自然地首
先想到HSI空间，因为在色调图像中描绘彩色很方便。典型地，为了在色调图像中分离出感兴趣的
孤立区域，将饱和度用做一幅模板图像。在彩色图像分割中不常使用亮度图像，因为它不携带彩色信
息。下面是如何在HSI彩色空间中执行分割的典型例子。
例6.14 HSI空间中的分割。
假定我们的兴趣是分割图6.42(a)中左下角的图像中的微红色区。虽然它是用伪彩色方法产生的，但
是可以像全彩色图像那样处理(分割)而不失一般性。图6.42(b)到图6.42(d)是它的HSI分量图像。注意，
比较图6.42(a)和图6.42(b),我们感兴趣的区域有相对高的色调值，表明这些颜色位于红色的蓝-深红侧
(见图6.13)。图6.42(e)显示了一个用阈值处理饱和度图像产生的二值模板，该阈值等于图像的最大饱和
度的10??大于该阈值的任何像素值被置为1(白色),所有其他值被置为0(黑色)。
图6.42(0是色调图像与该模板的乘积，图6.42(g)是乘积图像的直方图(注意，灰度级在范围[0.1]内)。
在直方图中可以看到，高值(感兴趣的值)被分组到灰度的最高端，接近 1.0。用阈值0.9 对乘积图像进行
阈值处理后得到的二值图像示于图6.42(h)。在该图像中，白色点的空间位置看做原图像中点，它具有感
兴趣的微红色调。这与完美的分割相差甚远，因为在原图像中还应该有一些具有微红色调的点，但没有
被该分割方法识别出来。然而，实验表明，在识别原图像的微红色分量时，图6.42(h)所示的白色区域是
这种方法所能做到的最好结果。下一节讨论的分割方法可产生相当好的结果。
a b c d
e fgh
图6.42 HSI空间中的图像分割：(a)原图像；(b)色调图像；(c)饱和度图像；(d)亮度图像；(e)二值饱和
度模板(黑=0);(f)图(b)和图(e)相乘后的结果：(g)图(1)的直方图；(h)图(a)中红色分量的分割
6.7.2 RGB向量空间中的分割
正如这一节多次提到的那样，虽然在HSI空间的工作更直观，但分割是这样一个领域，即通常
用RGB彩色向量得到的结果更好。该方法很直接。假如我们的目的是在一幅RGB 图像中分割某个 查索
280 数宇图像处理(第三版)
指定的颜色区域的物体。给定一个感兴趣的有代表性彩色的彩色样点集，可得到我们希望分割的颜色
的“平均”估计。令这个平均彩色用RGB 向量a来表示。分割的目的是将给定图像中的每个RGB
像素分类，即在指定的区域内是否有一种颜色。为了执行这一比较，有一个相似性度量是必要的。最
简单的度量之一是欧氏距离。令z表示RGB空间中的任意一点。如果它们之间的距离小于特定的阈
值D?则称z与a是相似的。z和a间的欧氏距离由下式给出：
Da.)=lk-al=[z-a]2(z-a2=[(z-a2+(za-aP+(za-aaP} (6.7-1)
其中下标R,G,B表示向量a和z的RGB分量。满足D(z,a)≤D?的点的轨道是半径为D?的实心球体，
如图6.43(a)所示。包含在球体内部和表面上的点满足指定的彩色准则；球体之外的点则不满足指定
的颜色准则。在图像中对这两组点编码，比如说黑或白，就产生了一幅二值分割图像。
式(6.7-1)的一种有用推广是形如下式的距离度量：
D(z,a)=[(z-a)2c1(z-a)] (6.7-2)
其中C是表示我们希望分割的有代表性颜色的样本的协方差矩阵。满足D(z, a)≤D?的点的轨道描
述了一个实心的三维椭球体[见图6.43(b)],该椭球体的最大特点是主轴面向最大数据扩展方向。当
C=I时，则为3×3的单位矩阵，式(6.7-2)简化为式(6.7-1)。这时的分割与前一段中描述的分割相同。
因为距离是正的和单调的，所以可用距离的平方运算来代替，从而避免开方运算。然而，即使
不计算平方根，对于实际大小的图像来说，实现式(6.7-1)或式(6.7-2)的计算代价也很高。一种折中
方案是使用一个边界盒，如图6.43(c)所示。在该方法中，盒的中心在a处，沿每一个颜色轴选择的
维数与沿每个轴的样本的标准差成比例。标准差的计算只使用一次样本颜色数据。
B B B a b c
G G G
R R R
图6.43 为RGB向量分割圈定数据区域的3种方法
给定一个任意的彩色点，如同采用距离公式那样，通过确定它是否在盒子表面或内部来进行分
割。然而，判定一个彩色点是在盒子内部还是在盒子外部，在计算上要比求球体或椭球的界限简单得
多。注意，前面的讨论是6.5.3节中介绍的与彩色分层有关方法的推广。
例6.15 RGB空间中的彩色图像分割。
图6.44(a)所示的方形区域包含微红色样本，这是我们希望从彩色图像分割出来的样本。这与我们
在例6.14中使用色调的问题相同，但这里我们使用RGB彩色向量来处理该问题。接下来的方法是使
用图6.44(a)所示矩形内包含的彩色点来计算平均向量a,然后计算这些样本的红、绿、蓝值的标准差。
盒子的中心位于a处，其沿每个RGB轴的维数按沿相应轴的数据的标准差的1.25倍选取。例如，令
σ&表示样本点的红分量的标准差，则盒子沿R轴的维数从(aR-1.25σ)扩展到(ax+1.25og),其中a表
①一组向量样本的协方差矩阵的计算，见114节中的讨论。
第6章 彩色图像处理 281
示平均向量a的红分量。对整个彩色图像中的每一点的编码结果如下：如果该点位于盒子的表面或内
部，则编码为白色；否则编码为黑色。编码后的结果示于图6.44(b)。注意，分割后的区域是如何由
矩形封闭的彩色样本推广的。事实上，比较图6.44(b)和图6.42(h),可看到在RGB 向量空间分割会
产生准确得多的结果。在一定意义上，在原彩色图像中它们更接近于我们定义的“微红色”。
a b
图6.44 RGB空间中的分割：(a)用一个封闭的矩形表示的感兴趣的彩
色原像；(b)RGB向量空间中的分割结果。请与图6.42(h)比较
6.7.3 彩色边缘检测
正如第10章所讨论的那样，边缘检测对图像分割来说是一个重要的工具。在本节中，我们的兴
趣在于以单一图像为基础计算边缘和直接在彩色向量空间中计算边缘的问题。基于边缘的分割的详细
内容将在10.2节中给出。
梯度算子边缘检测已在3.6.4节中有关图像锐化的内容中介绍过。遗憾的是，3.6.4节中讨论的梯
度对向量没有定义。这样，我们立刻会想到，计算单幅图像的梯度然后用得到的结果形成一幅彩色图
像将会导致错误的结果。一个简单的例子可帮助我们说明其原因。
考虑图6.45(d)和图6.45(h)中的两幅M×M的彩色图像(M为奇数),它们分别由图6.45(a)到
图6.45(c)和图6.45(e)到图645(g)中的3个分量图像组成。例如，如果我们计算每个分量图像的梯度[见
式(3.6-11)],并将结果相加形成两幅相应的RGB梯度图像，则点[(M+1)/2,(M+ 1/2]处的梯度值在
两种情况下都将相同。直观地看，我们希望图6.45(d)中图像那一点的梯度更强，因为R,G,B图像的
边缘在该图像中的方向相同，而相对于图6.45(h)的图像，只有两个边缘具有相同的方向。从这个简
单的例子可以看出，处理3个单独的平面所形成的合成梯度图像可导致错误的结果。如果问题只是检
测边缘，则单独分量方法通常可产生可接受的结果。然而，如果准确度是重点，则很明显我们需要一
个适用于向量的梯度的新定义。下面讨论Di Zenzo[1986]为此提出的一种方法。
a b cd efg h
图6.45(a)~(c)R,G,B分量图像；(d)产生的RGB彩色图像；(e)-gR,G,B分量图像；(h)产生的RGB彩色图像 军乱
虎;
282 数字图像处理(第三版)
现有的问题是定义式(6.4-2)中向量c在任意点(x,y)处的梯度(幅度和方向)。正如刚提及的那
样，3.6.4节中我们研究过的梯度适用于标量函数f(x,y),但不能用于向量函数。下面是许多方法
中的一种，在这种方法中，我们可以针对向量函数扩展梯度的概念。回忆一下，对于标量函数fx,y),
梯度是在坐标(x,y)处指向f的最大变化率方向的向量。
令r.g和b是沿RGB彩色空间(见图6.7)的R,G,B轴的单位向量，并定义向量为
"=r+?+ (6.7-3)
和
v=,+0B+ (6.7-4)
令8g,和g,表示这些向量的点积，如下所示：
8a=uw=uu-P+PP+ (6.7-5)
8=w=-P+PP+ (6.7-6)
和
8,=uv=u3v=y+y+ay (6.7-7)
记住，R,G和B以及由此而来的g项是x和y的函数。使用这种表示法，可以证明(DiZenzo[1986]),
c(x,y)的最大变化率方向可以由角度
e(x)-2ca-8 (6.7-8)
给出，且在角度θ(x,y)方向上点(x,y)处的变化率的值由下式给出：
Ba)-传(C&a+B)+B-B,D20,+28amn20x} (6.7-9)
因为tan(a)=tan(a±π),如果θ。是式(6.7-8)的一个解，则θ?±π/2也是该式的一个解。此外，由于F?=Fe+
所以F仅需对0值在半开区间(0,π)内计算。式(6.7-8)提供两个相隔90°的值这一事实，意味着该式在每
个点(x,y)处涉及两个正交方向。沿着这些方向之一，F最大，沿其他方向F最小。这些结果的推导相
当冗长，并且在这里详细讨论它对我们当前讨论的基本目标益处不大。其细节可参考Di Zenzo[1986]的
论文。实现式(6.7-5)到式(6.7-7)所要求的偏导数，可用3.6.4节讨论的Sobel算子来计算。
例6.16 向量空间中的边缘检测。
图6.46(b)是图6.46(a)中图像的梯度，它是使用刚刚讨论的向量方法得到的。图6.46(c)显示了由计
算每幅RGB分量图像的梯度，并通过在每一坐标点(x,y)处叠加相应的3幅分量图像的值所形成的一幅合
成的梯度图像。向量梯度图像的边缘细节比图6.46(c)中单个平面梯度图像的细节更完全。例如，可观察
研究对象右眼周围的细节。图6.46(d)中的图像显示了在每一点(x,y)处的两幅梯度图像间的差别。注意一
下两种方法得到了可接受的结果是重要的。图6.46(b)中的额外细节增加计算负担是否值得(与 Sober算子
的执行相反，它用于产生单一平面的梯度)仅由给定问题的要求决定。图6.47显示了3幅分量梯度图像，
在相加和标定后可用来得到图6.46(c)。
第6章 彩色图像处理 283
a bcd
图6.46(a)RGB图像；(b)在RGB彩色空间中计算的梯度；(c)在每
幅图像基础上计算梯度，然后相加；(d)图(b)和图(c)的差
a b c
图6.47 图6.46中的彩色图像的分量梯度图像：(a)红分量；(b)绿分量；
(c)蓝分量。这3幅图像相加并标定后产生了图6.46(c)中的图像
6.8 彩色图像中的噪声
5.2节中讨论的噪声模型可用于彩色图像。通常，彩色图像的噪声内容在每个彩色通道中具有相
同的特性，但噪声对不同的彩色通道所造成的影响不同。一种可能是个别通道的电子学故障。然而，
不同的噪声水平像是由每个彩色通道的相对照射强度的差异造成的。例如，在CCD 摄像机中红色滤
镜的使用将减小用于红色传感器的照射强度。CCD 传感器在低照明水平下就是噪声源，因此，这种
情况下得到的RGB图像的红色分量图像与其他两幅分量图像相比往往是噪声源。
例6.17 将RGB带噪图像转换为HSI的效果说明。
在这个例子中，我们将简单地看一下彩色图像中的噪声，以及在从一个彩色模型转换为另一个模型
时，噪声是如何转移的。图6.48(a)到图6.48(e)显示了被高斯噪声污染的一幅RGB图像的3个彩色平面，
图6.48(d)是合成的RGB图像。注意，与在单色图像中相比，细颗粒噪声在彩色图像中不太引人注意。
图6.49(a)到图6.49(c)显示了把图6.48(d)中的RGB图像转换为HSI的结果。将这些结果与原图像(见
图6.39)的HSI分量进行比较，并注意如何显著地降低了噪声图像的色调与饱和度分量。这分别是由式(6.2-2)
和式(6.2-3)求余弦与取最小值操作的非线性造成的。另一方面，图6.49(c)中的强度分量比3个带噪声的
RGB 分量图像中的任一个都要稍微平滑一些。正如式(6.2-4)指出的那样，这是由于亮度图像是RGB图
像的平均这一事实(回忆2.6.3节中关于对图像进行平均操作降低随机噪声的讨论)。
在仅有一个RGB通道受噪声影响的情况下，到HSI的转换才将噪声扩散到所有HSI分量图像。图6.50(a)
给出了一个例子。图6.50(a)显示了一幅RGB图像，其绿色图像被椒盐噪声污染，其中无论是盐粒还是胡椒
噪声的概率都为0.05。图6.50(b)到图6.50(d)中的HSI分量图像清楚地显示了噪声是如何从绿色RGB通道
散布到所有HSI图像上的。当然，这是我们不希望的，因为HSI分量的计算会用到RGB的所有分量，正如
6.2.3节所示的那样。 忌
的臣
284 数宇图像处理(第三版)
a bcd
图6.48(a)~(c)由均值为0、方差为800的高斯噪声污染的红、绿
和蓝分量图像；(d)最终的RGB图像[与图6.46(a)比较]
a b c
图6.49 图6.48(d)中带噪声的彩色图像的HSI分量：(a)色调图像；(b)饱和度图像；(c)亮度图像
a bcd
图6.50(a)绿平面被椒盐噪声污染的RGB图像；(b)HSI图像的色调分量；(c)饱和度分量；(d)亮度分量
迄今为止我们讨论过的处理都是正确的，因此全彩色图像滤波可以在每一幅图像的基础上或依
靠该过程直接在彩色向量空间中执行。例如，用均值滤波器减少噪声是6.6.1节中讨论过的处理方法，
我们知道，在向量空间中当对分量图像单独进行类似的处理时，它可以给出相同的结果。然而，其他
滤波器却不能按这样方式明确地表达。这样的例子包括5.3.2节中讨论过的各类排序统计滤波。例如，
为在彩色向量空间实现中值滤波，就必须找到一种使得中值有意义的向量排序方案。当处理标量时这
是一个简单的过程，当处理向量时这一过程就相当复杂。向量排序的讨论超出了这里讨论的范围，但
是，由Plataniotis and Venetsanopoulos[2000]所著的书籍是关于向量排序和某些基于排序概念的滤波的
较好参考书。
6.9 彩色图像压缩
因为描述彩色所要求的比特数比描述灰度级所要求的比特数大 3-4倍，所以数据压缩在存储和
传输彩色图像中起着核心的作用。对于前几节中描述的RGB,CMY(K)和HSI图像，任何压缩对象的
数据是每个彩色像素的分量(即RGB图像中各像素的红、绿、蓝分量);它们是传达彩色信息的方式。
压缩是减小或消除冗余和/或不相干数据的处理。虽然压缩是第8章的主题，但我们在下面的例子中
用一幅彩色图像简单地说明这一概念。
第6章 彩色图像处理 285
例6.18 彩色图像压缩实例。
图6.51(a)显示了一幅蝴蝶花的24比特 RGB全彩色图像，图像中表示红、绿、蓝分量时都使用了
8比特。图6.51(b)是由图6.51(a)所示图像的一种压缩方案重建的图像，事实上，该图像是压缩并解压缩
后的一种近似。虽然压缩后的图像不能直接显示——在输入到彩色监视器之前必须解压缩—,但对于
原图像中每230比特的数据，压缩后的图像仅包含1个数据比特(只需要1个存储比特)。假定压缩后的
图像在 Intemet 可在1分钟内传输完成，那么原图像的传输至少需要4小时。当然，传输后的数据必须解
压缩后才能观看，但解压缩在几秒钟之内就可以完成。用于生成图6.51(b)的JPEG 2000压缩算法是近来
引入的标准，该标准将在8.2.10节中详细叙述。注意，重建的近似图像稍微有点模糊。这是许多有损压缩
技术的特点；可以通过改变压缩程度将其减小或消除。
a b
图6.51 彩色图像压缩：(a)原RGB图像；(b)图(a)压缩并解压缩后的图像
小结
本章的材料是彩色图像处理的简单介绍，所涵盖的主题就图像处理的这一分支所用的技术提供
了坚实的背景知识。彩色基本原理和彩色模型的论述是作为该领域的基础材料准备的，这些材料在技
术范围和应用领域方面是很宽泛的。我们特别关注彩色模型，它们不仅在数字图像处理中非常有用，
而且还为在图像处理这一领域进一步研究提供了必要的工具。以单幅图像为基础的伪彩色和全彩色处
理为第3章到第5章某些细节中涵盖的技术提供了一个纽带。
在探讨彩色向量空间时，从以前已研究过的方法出发，并突出了灰度和全彩色处理间的重要区
别。就技术而论，直接进行彩色向量处理的领域很多，并包括许多方法，如中值滤波和其他排序滤波、
自适应和形态学滤波、图像复原、图像压缩许多其他技术。这些处理不同于在彩色图像各幅分量图像
上执行的彩色处理。下一节中的参考文献为该领域的进一步研究成果提供了线索。
在彩色图像中噪声的处理方面还指出问题的向量性质，以及遵循彩色图像例行地从一种工作空
间变换至另一种工作空间的事实，问题的本质是如何降低这些图像中的噪声。在某些情况下，噪声的
滤除可以在每幅图像的基础上进行，但另一方面，如中值滤波，就要求特殊处理，以便反映彩色像素
是向量这一事实，就像前几段中提到的那样。
虽然分割是第10章的主题，图像数据压缩是第8章的主题，但在本章中介绍它们有利于我们保
持知识的连续性。后续的讨论将表明，这些章节中研究的许多技术对本章的讨论都适用。
参考文献
对于彩色科学的全面参考，见Malacara[2001]。关于彩色生理学，参阅Gegenfurtner和 Sharpe[1999]的
著述。这两个参考文献连同Walsh[1958]和Kiver{1965]早期的书籍一道，对6.1节中的讨论提供了丰富的 :退
44
286 数字图像处理(第三版)
补充材料。关于彩色模型(见6.2节)的进一步读物见Fortner和Meyer[1997]、Poynton[1996]和 Fairchild
[1998]的文献。6.2.3节中HSI模型的详细推导，见Smith[1978]的论文或查阅本书的网站。伪彩色这一主
题(见6.3节)紧密联系数据可视化这一通用领域。在伪彩色的应用方面，Wolff 和Yaeger[1993]是很好的
基础参考文献。Thorell和Smith[1990]的书也很重要。关于彩色信号的向量表示的讨论(6.4节),见Plataniotis
和Venetsanopoulos[2000]的文献。
6.5节的参考文献是Benson[1985]、Robertson[1977]和CIE[1978],还可参阅MacAdam[1942]的经典论
文。彩色图像滤波方面的内容(见6.6节)是以6.4节介绍的向量公式以及第3章讨论的空间滤波为基础的。
彩色图像分割(见6.7节)是过去10年间备受关注的课题。Liu和Yang[1994]和 Shafarenko 等人[1998]的论
文是在这一领域有代表性的文献。IEEE 图像处理学报的专刊[1997]也是重要的参考资料。彩色边缘检测的
讨论(见6.7.3节)来自Di Zenzo[1986]。Plataniotis和Venetsanopoulos[2000]在综述彩色图像分割的各种方法
方面做了很好的工作。6.8节的讨论以5.2节中介绍的噪声模型为基础。图像压缩(见6.9节)方面的文献列
在第8章的末尾。本章讨论的许多技术的软件实现见Gonzalez,Woods和Eddins[2004]的著述。
习题
标有星号的习题的详细解
答，可在本书的网站上找到。该网站
还包含有基于本章内容建议的项目
6.1 给出用于产生图6.5中标为“日光”的点的红光、绿光、蓝光的百分比。
★6.2 考虑任何两种有效颜色c?和c?,其在图6.5所示色度图中的坐标分别为(x,y,)和(x,y,)。推导出计
算构成一种给定颜色的c?和c?的相对百分比的通用表示式，已知给定的颜色位于连接这两种颜色
的直线上。
6.3 考虑任何四种有效彩色c,c?,c?和c,其在图65所示色度图中的坐标为(x?,y,).(x,y.)(x,y)和(x,y,)。
推导出计算构成给定彩色的c,c?,c?和c?的相对百分比的通用表达式，已知给定的颜色位于由4个
项点c,c?,c?和c?构成的方形内。
★6.4 在一条自动装配线中，为了简化检测，四类零件将编以彩色码。然而，只有一台黑白电视摄像机
可用于获取数字图像。请提出一种使用该摄像机检测4种不同颜色的技术。
6.5 在一幅简单的RGB图像中，R,C和B分量图像有下图所示的水平强度分布曲线。人们在该图像
的中间一列能看到什么颜色?
1.0
鄙色0.5
1.0 1.0
红色 颜色 颜色
0.5 绿色 0.5 蓝色
0 N/2 N-1 0
位置
N/2
位置
N-1 0 N/2 N-1
位置
★6.6 当它们出现在单色监视器上时，画出下列图像的RGB分量。所有颜色都处在最大亮度与饱和度。
在解答这一习题时，考虑作为图像一部分的中间灰度边界。
6.7 在彩色RGB系统中，每幅RGB图像均为12比特图像，共有多少种不
同的灰度?
6.8 考虑图6.8所示的RGB彩色立方体并回答下列问题：
★(a)描述在R,G和B原图像中灰度级是如何变化的。原图像由彩色立
方体的前表面组成。
(b)假设用CMY彩色代替RGB立方体中的每种颜色，这个新立方体显示在RGB监视器上。请用
彩色名标注在屏幕上看到的新立方体的8个顶点。
第6章 彩色图像处理 287
(c)请您说明与饱和度有关的RGB彩色立方体边缘上的彩色。
6.9(a)当习题6.6中的图像出现在单色监视器上时，请画出该图像的CMY分量。
(b)如果在(a)中画出的CMY分量分别送入监视器的红、绿、蓝输入端，试描述结果图像。
★6.10 从式(6.5-5)中的RGB亮度映射函数推导出式(6.5-6)的CMY亮度映射函数。
6.11 考虑如图6.10(a)所示的整个216种稳定色阵列。按(行，列)方式标出每一元素，左上角元素为(1,1).
右下角元素为(12,18)。请问在哪个元素会找到
(a)最纯的红色?
(b)最纯的黄色?
★6.12 当习题6.6中图像的HSI分量出现在单色监视器上时，画出这些分量。
6.13 提供一个方法，以生成一个与图6.2 中称为“可见光谱”的放大部分相似的彩色波段。注意该波
段左边从暗紫色开始，并朝着右边的纯红色延续。(提示：使用HSI彩色模型。)
★6.14 提出一种生成图6.13(c)中以图形方式显示的图像的彩色方案的方法。并以流程图的方式给出答
案。假定亮度值固定且已给定。(提示：使用HSI彩色模型。)
6.15 考虑右下方由纯色方形组成的图像。为讨论您的答案，选择由0-7的8个灰度组成的灰度级，其
中0表示黑，7表示白。假设该图像转换到HSI 彩色空间。如果使用的数字有意义，在回答如下
问题时，对灰度使用一个明确的数字。否则，使用“与……相同”、“比……亮”或“比……暗”
的关系就足够了。如果不能对正讨论的图像赋予一种特定的灰度级或这些关系之一，试给出原因。
(a)画出色调图像的草图。
(b)画出饱和度图像的草图。 红
(c)画出亮度图像的草图。
6.16 下列8比特图像(从左到右)是来自图6.16的H,S,1分量图像。数字
指出了灰度值。回答下列问题，解释回答的依据。如果基于给定
的信息不可能回答这一问题，则陈述为什么不能回答。
深红
黄
青
★(a)给出色调图像中所有区域的灰度值。
蓝
白
绿
黑
(b)给出饱和度图像中所有区域的灰度值。
(c)给出亮度图像中所有区域灰度值。
286
(a) (b) (c)
6.17 参考图6.27回答下列问题：
(a)为什么图6.27(1)中的图像主要呈现红色调?
(b)提出一种自动编码程序，使图6.27中的水为亮蓝色。
(c)提出一种自动编码程序，使主要的人工分量呈现亮红色。[提示：使用图6.27(f。]
★6.18 证明彩色图像的补色的饱和度分量不能单独地由输入图像的饱和度分量计算出来。
6.19 使用HSI彩色模型说明图6.33(b)中的近似补色的色调变换函数的形状。
480 48
288 数字图像处理(第三版)
★6.20 推导产生一幅彩色图像的补色的CMY变换。
6.21 画出用于校正RGB彩色空间中过度对比度的变换函数的一般形状。
★6.22 假定一个成像系统的监视器和打印机没有完美校准。在该监视器上看起来平衡的一幅图像打印时
出现了青色。描述可校正这种不平衡的通用变换。
6.23 假定
计算习题6.6中图像的L*a*b*分量。该矩阵方程定义了由(美国)国家电视标准委员会(NTSC)彩色
电视荧光粉产生的在D65标准照明下观看的彩色三色激励值(Benson[1985])。
★6.24 怎样才能实现与3.3.2节中匹配(规定)的灰度直方图等效的彩色直方图?
6.25 考虑下列500×500的RGB 彩色图像，图像中方框是完全饱和的红色、绿色和蓝色，且每种颜色
处在最大亮度[例如，对于红色方框是(1,0,0)]。由该图像生成了一幅HSI图像。
(a)描述每幅HSI分量图像的外观。
(b)用一个250×250的平均模板来平滑HSI图像的饱和度分量。描述结果的外
观(在中，您可通过滤波操作忽略图像的边界效应)。
(c)对色调图像重复(b)。
6.26 证明当C=I(单位矩阵)时，式(6.7-2)简化为式(6.7-1)。
6.27★(a)参考6.7.2节的讨论，(以流程图形式)给出一个过程，确定彩色向量(点)z是否在一个边长为
W、中心在平均彩色向量a处的立方体内部。不允许计算距离。
(b)如果该盒子(立方体)与坐标轴是对齐的，这个处理还可在逐幅图像的基础上执行。说明您应
该怎么做。。
6.28 画出满足方程
D(z,a)=[(z-a)'C(z-a)]"=D?
的那些点在RGB空间中组成的表面，其中D?是一个指定的非零常数。假定a=0且
6.29 参考6.7.3节，您也许会想到，在任何点(x,y)处定义一幅RGB图像的梯度的逻辑方法，是计算每
幅分量图像的梯度向量(见3.6.4节),然后把这3个单独的梯度向量相加，形成该彩色图像的梯度
向量。遗憾的是，有时这一方法会导致错误结果。特别是，对于明确定义了边缘的彩色图像，具
有零梯度是可能的。如果使用这一方法，请给出这样一幅图像的例子。(提示：置一个彩色平面为
恒定值，以简化您的分析。)
绿色 红色
蓝色 绿色
唐名
第7章 小波和多分辨率处理
整段时间，保卫都在寻找她，先用望远镜，然后用显微镜，再后
用观剧镜。
——刘易斯·卡罗尔，《爱丽丝镜中奇遇记》
引言
虽然自20世纪50年代末起傅里叶变换就一直是基于变换的图像处理的基石，但近年来一种新
的称为小波变换的变换使得压缩、传输和分析图像变得更为容易。与基函数为正弦函数的傅里叶变换
不同，小波变换基于一些小型波，称为小波，它具有变化的频率和有限的持续时间。这就允许它们为
图像提供一张等效的乐谱，该乐谱不但显示了要演奏的音符(或频率),而且显示了演奏这些音符的时
间。另一方面，傅里叶变换只提供音符或频率信息，时间信息在变换过程中丢失了。
1987年，首次证明小波是一种全新且有效的信号处理和分析方法，称为多分辨率理论的基础
(Mallat [1987])。多分辨率理论将多种学科的技术有效地统一在一起，包括来自信号处理的子带编码、
源于数字语音识别的正交镜像滤波及金字塔图像处理。正如其名字所表达的那样，多分辨率理论涉及
多个分辨率下的信号(或图像)表示与分析。这种方法的优势很明显，某种分辨率下无法检测的特性在
另一种分辨率下将很容易检测。尽管20世纪80年代末之前图像处理界对多分辨率分析的研究兴趣受
到限制，但现在关于该专题的论文和专著却多得数不胜数。
本章将从多分辨率的角度来审视基于小波的变换。虽然这样的变换也可以使用其他方法来介绍，
但这种方法能简化它们的数学和物理解释。我们将从影响多分辨率理论形成的图像处理技术的概述入
手，我们的目的是在图像处理环境中阐述该理论的基本概念，并同时对该方法及其应用进行简要的历
史回顾。本章的主要内容将集中在离散小波变换的开发和利用上。为阐明该变换的用途，本章提供了
图像编码、噪声去除和边缘检测等例子。在下一章中，小波将主要用于图像压缩，在图像压缩中的应
用已得到了广泛重视。
7.1 背景
当我们观察图像时，通常我们看到的是相似的纹理和灰度级连成的区域，它们相结合形成了物
体。如果物体的尺寸较小或对比度较低，那么我们通常以较高的分辨率来研究它们；如果物体的尺寸
较大或对比度较高，则只要求粗略的观察就足够了。如果较小物体和较大物体——或对比度较低和对 茎蕊
爱：事
290 数字图像处理(第三版)
比度较高的物体——同时存在，以不同的分辨率对它们进行研究将具有优势。当然，这就是多分辨率
处理的基本动机。
从数学角度看，图像是一个具有局部变化的统计特性灰度值的二维阵列，而该统计特性是由类
似边缘和对比同质区域突变特性的不同组合导致的。如图7.1中所示的 局部直方图是一个邻域中的像素 那样——在本章的剩余部分多次被研究的一幅图像——在同一图像的 的直方图(见3.33节)。
不同部分，局部直方图可能变化很明显，这就使得为整幅图像建立统
计模型非常困难，甚至是不可能的任务。
7.1.1 图像金字塔
以多个分辨率来表示图像的一种有效且概念简单的
结构是图像金字塔(Burt 和Adelson[1983])。图像金字塔
最初用于机器视觉和图像压缩，一个图像金字塔是一系
列以金字塔形状排列的、分辨率逐步降低的图像集合。
正如在图7.2(a)中看到的那样，金字塔的底部是待处理图
像的高分辨率表示，而顶部则包含一个低分辨率近似。
当向金字塔的上层移动时，尺寸和分辨率降低。基础级J 图7.1 一幅图像及其不同的局部直方图
的大小为2'×2'或N×N,其中J=log?N,顶点级0的大小为1x1(即单个像素),通常，第j级的
大小为2'×2',其中0≤j≤J。虽然图7.2(a)所示的金字塔由从21×2′到2°×2°的J+1个分辨率级
组成，但大部分图像金字塔截短到到P+1级，其中I≤P≤J且j=J-P,…,J-2.J-1J。也就是说，
我们通常会自己限制到P以降低原图像的分辨率近似；例如，一幅大小为512x512的图像的1×1(即
单像素)近似没有什么价值。P+1级金字塔(P>0)中的像素总数是
~(1+…)等~2
一个降低分辨率的近似(在金字塔的顶部，即J-P级)。所有其他级
均包含预测残差，其中第j级预测残差(对于J-P+1≤j≤J定义为
第j级近似(方框图的输入)与基于第j-1级近似(方框图中的近似输出)
的第j级近似的估计之间的差。
图7.2(b)显示了一个构建两个密切联系的图像金字塔的简单系统。第j-1级近似输出提供建立一
个近似值金字塔所需的图像(如前一段中描述的那样),第j级预测残差输出用于构建一个补充的预测
残差金字塔。与近似金字塔不同，预测残差金字塔仅包含输入图像的 一般而言，预测残差可定义为一
幅图像与该幅图像的一个预测版本
间的差。如829节将说明的那样。
与二维灰度阵列相比，预测残差可
更有效率地编码
如图7.2(b)建议的那样，近似和预测残差金字塔都以一种迭代方式进行计算。在第一次迭代前，
以金字塔形式描绘的图像放在这个近似金字塔的第J级中。然后，下面的3步过程执行P次，其中
j=J,J-1,…,J-P+1(以那样的顺序):
步骤1 计算第j级输入图像降低的分辨率近似[图7.2(b)所示方框图左侧的输入]。这可以通过
滤波并对滤波后的结果以2为因数进行下采样来完成。这两种操作将在下一段中描述。将得到
的近似放在近似金字塔的第j-1级。
步骤2 由步骤1中产生的降低的分辨率近似创建第j级输入图像的一个估计。这通过对产生的
近似与第j级图像进行上采样和滤波(见下节)来完成。得到的预测图像与第j级输入图像的维数
相同。
第7章 小波和多分辨率处理 291
第0级(顶点) a
b
2 2 第1级
4×4 第2级
N/2N/2 第/-1级
N×N 第/级(底部)
下采样器(行和列)
近似滤波器 2 第/一1级近似
21 上采样器(行和列)
插值滤波器
预测
第/级输入图像 第/级预测残差
图7.2 (a)一个图像金字塔；(b)创建近似和预测残差金字塔的一个简单系统
步骤3 计算步骤2的预测图像和步骤1的输入之间的差。把得到的结果放在预测残差金字塔的
第j级。
在P次迭代的结论(即随后的迭代中j=J-P+1)中，第J-P级近似输出放在预测残差金字塔
的第J-P级处。如果不需要预测残差金字塔，则这些操作连同步骤 2、步骤3、上采样器、内插滤
波器以及图7.2(b)中的加法器都可以省略。
多种近似和内插滤波器可以合并到图7.2(b)所示的系统中。典型地，滤波在空间域执行(见3.4节)。
很有用的近似滤波技术包括：邻域平均(见3.5.1节),它产生平均金字塔；低通高斯滤波(见4.7.4节
和4.8.3节),它产生高斯金字塔：不滤波，它产生子取样金字塔。2.4.4节中描述的任何内插方法，包
括最近邻、双线性和双三次内插，都可以合并到内插滤波器中。最后， 在本章中。我们将处理连续和离 我们注意到，图7.2(b)中的上采样和下采样方框被用于加倍和减半计 散函数以及连续和离散变量。除了
算得到的近似和预测图像的空间维数。给定一个整数变量 n和一维取 二维图像f(x,y)之外。其他以xy.
z…表示的均是连续变量，而j.kL 样序列f(n),则上采样序列f?r(n)如下式定义： m,n.…则为离散变量
a-{2)“美他 (7.1-1)
其中，如下标表示的那样，上采样以2为因数。基2的下采样的互补操作定义为
f?:(n)=f(2n) (7.1-2)
上采样可看成是在序列中的每一个样本后插入0;下采样可看成是每隔一个样本丢弃一个样本。图7.2(b)
中分别标为2+和21的上采样和下采样方框来注释，以指出二维输入的行和列，其中它们的操作就
是上采样和下采样。与4.11.1节中可分的二维DFT一样，二维上采样和下采样可依次通过式(7.1-1)
和式(7.1-2)定义的一维操作来执行。 唐事
292 数字图像处理(第三版)
圈;奇
例7.1 近似金字塔和预测残差金字塔。
图7.3显示了图7.1中花瓶的近似金字塔和预测残差金字塔。一个低通高斯平滑滤波器(见4.7.4节)
用于产生图7.3(a)中的4级近似金字塔。正如您看到的那样，得到的金字塔包含512×512分辨率的原图
像(底部)和3个低分辨率的近似(分辨率分别为256×256,128×128和64×64)。这样，P就是3,出现级别
9,8,7和6,且不可能存在log?(512)+1级或10级。注意，金字塔的分辨率越低，伴随的细节就越少。例
如，第6级(即64×64)近似图像对于窗定位很合适(即取景窗),但对于寻找植物的茎就不合适。通常，金
字塔的低分辨率级别用于分析大的结构或图像的整体内容；而高分辨率图像适合分析单个物体的特性。
这种由粗到细的分析策略在模式识别中特别有用。
图7.3(b)中的双线性内插滤波器用于产生预测残差金字塔。在没有量化误差的情况下，得到的预测残
差金字塔可用于产生图7.3(a)中的互补近似金字塔，包括没有误差的原图像。为了做到这一点，我们用第
6级的64×64近似图像开始(该预测残差金字塔中唯一的近似图像),来预测第7级的128×128分辨率近
似(通过上采样和滤波实现),并加上第7级预测残差。重复使用这个过程来计算近似图像，直到生成
512×512的原图像。注意，图7.3(b)中的预测残差直方图在零点附近有一个高峰，而图7.3(a)中的近似直方
图中则没有。不像近似图像，预测残差图像可以通过给更多的可能值分配较少的比特数来高压缩(见8.2.1节
的变长编码)。最后，我们注意到，图7.3(b)中的预测残差被缩放到了使得较小的预测误差更明显的程度，
然而，预测残差直方图是以第128级表示0误差的原始残差值为基础的。
a
b
霸霸
图7.3 两种图像金字塔及它们的直方图：(a)近似金字塔；(b)预测残差金字塔
7.1.2 子带编码
另一种与多分辨率分析相关的重要图像处理技术是子带编码。在子带编码中，一幅图像被分解
为一组频带受限的分量，称为子带。由于执行了分解，所以子带可以重组在一起无误差地重构原始图
像。因为分解和重建是借助于数字滤波器实现的，所以我们的讨论从 术语“延迟”表明了一个基于时
数字信号处理(DSP)和数字信号滤波的简介开始。 间的输入序列，并反映了数字信号
考虑图7.4(a)中的简单数字滤波器，并且注意到它是由三个基本 滤波中输入通常是一个取样后的模
部件组成的，即延迟单元、乘法器和加法器。沿该滤波器的顶部，延 拟信号这一事实。
迟单元依次连接以建立输入序列f(n)的K-1延迟(即右移)的形式。例如，延迟序列f(n-2)为
图(a)中的近似金字塔称为高斯金
意其与第3章中使用拉普拉斯算子滤
宇塔，因为构建该金字塔时使用了一
波后得到的图像的相似性。
个高斯滤波器。图(b)中的预测残差
金字塔通常称为拉普拉斯金字塔；注
第7章 小波和多分辨率处理 293
如图7.4(a)中的灰色注释指出的那样，输入序列f(n)=f(n-0)和延迟单元输出处的K-1个延迟序
列，表示为f(n-1),f(n-2),…,f(n-K+1),分别与常数h(0),h(1),…,h(K-1)相乘，然后求和，可
产生滤波后的输出序列：
rm=2hk)(a-k)=f(n*h(a) (7.1-3)
其中，★表示卷积。注意，除了变量的改变外，式(7.1-3)与第4章中
定义离散卷积的公式(4.4-10)是相同的。图7.4(a)和式(7.1-3)中的乘数
K称为滤波系数。每个系数定义一个滤波器抽头，它可被看成是计算
式(7.1-3)求和项所需要的分量，并且滤波器就称其为K阶的。
f(n)- f-0) 单位延迟
f(n-D
延迟单位 f"-2) 单位延迟
(n-K+1)
h(O) h(1) h(2) h(K-1)
100)/() h()n-1) h(2)(n-2) hK-1o-A+
+ + +
如果图7.4(a)中滤波器的系数是使
则式(7.1-3)中的求和限可简化为0到
用0到K-1之间的n个值来索引的。
K-1[像在式(44-10)中那样]
n)=f(m)*h(m)
h(O)/un)+h()fn-1)
h0/(m)*h(1)/(n-1)+h(2/(n-2)
26u=kj-/m*h)
1 1
h(1)
输入序列f(n)=8(n) oh(2)
09 冲激响应h(n) h(0) h(K-1)
0
h(3)
0
80 90
h(4)
a
-1-1012.. .K-1 -1
-101 2.
bc
K-I
n n
图7.4(a)数字滤波器；(b)单元离散冲激序列；(c)滤波器的冲激响应
如果输入到图7.4(a)的滤波器的是图7.4(b)和4.2.3节中的离散单位冲激，则式(7.1-3)变为
fm=Zhuboia-k)=k(m
也就是说，在式(7.1-3)中，对于输入f(n)用8(n)来代替，并利用式(4.2-13)
定义的离散单位冲激的取样特性，我们发现图7.4(a)中的滤波器的冲
激响应是定义该滤波器的滤波器系数的K元素序列。物理上，单位脉
(7.1-4)
h(n)”将用于指其冲激响应为hin)的
在本章的剩余内容中，“滤波器
滤波器。 -:室
294 数字图像处理(第三版)
冲越过该滤波器的顶端从左到右移动(从一个单元延迟到下一个单元延迟),产生一个输出，假设该输
出就是延迟冲激位置处的系数值。因为有K个系数，则冲激响应的长度为K,并且这种滤波器就称
为有限冲激响应滤波器(FIR)。
图7.5显示了6个功能上相关的滤波器的冲激响应。图7.5(b)中的h(n)是图7.5(a)中h(n)的符
号反转形式(即关于水平轴反转),即
h?(n)=-h?(n) (7.1-5)
t
h?(n)
6
0
-1-2-10124.5.67 -3-2-101!34.5 6.7.
b?()=-h?(m)
6
-1-3-2-10127567
aei
L
han)=hi(K-I。”
6
-3-7-191.7345 07. -3-2-101234507
h?(n)=(=1)"h?(m)
i
-3-1-1.01234567.
图7.5 6个功能上相关的滤波器的冲激响应：(a)参考响应；(b)符号反转；
(c)-(d)顺序反转(与引人的延迟不同);(e)调制；(1顺序反转和调制
图7.5(c)和(d)中的滤波器h?(n)和h?(n)是h(n)的顺序反转形式：
h?(n)=h(-n) (7.1-6)
h?(n)=h?(K-1-n)
Ay(n)h(-
h.im)=(-1)^h?(K-1-n)
当输入序列是一个取样后的模拟信
号时，顺序反转通常称为时间反转
(7.1-7)
滤波器h?(n)是h(n)关于垂直轴的映像；滤波器h?(n)是h(n)的映像和平移(即移位)形式。忽略平移，
这两个滤波器的响应是相同的。图7.5(e)中的滤波器h?(n)由下式定义：
h?(n)=(-1)"h?(n) (7.1-8)
称之为h(n)的调制形式。因为调制改变了所有奇数序号的系数的符号[即图7.5(e)中n为奇数的系
数],h?(1)=-h,(1)和h,(3)=-h(3),而h?(0)=h?(0)和h?(2)=h(2)。最后，图7.5f显示的序列是
h(n)的顺序反转形式，它也被调制了：
军到
h?(n)=(-1)"h?(K-1-n) (7.1-9)
包括这个序列说明了这样一个事实，即在规定两个滤波器之间的关系
时，符号反转、顺序反转和调制有时是合并在一起的。
通过数字信号滤波的简要介绍，考虑图7.6(a)中的一个两波段子
带编码和解码系统。如图中指出的那样，该系统由两个滤波器组构成，每个滤波器组包含图7.4(a)中
所示的两个FR滤波器。注意，4个FIR 滤波器中的每一个在图7.6(a)中被表示为一个方框，每个滤
波器的冲激响应(和卷积符号)写在方框内。包含滤波器h,(n)和h(n)的分析滤波器组用于把输入序
滤波器组是两个或两个以上滤波
器的集合。
第7章 小波和多分辨率处理 295
列分成两个半长序列f,(n)和f。(n),表示输入的子带。注意，滤波器h(n)和h(n)是半波段滤波器，
它们的理想传递特性H?和H?如图7.6(b)所示。滤波器h,(n)是一个低通滤波器，其输出，子带
fo(n)称为f(n)的近似；滤波器h(n)是一个高通滤波器，其输出，子带f(n)称为f(n)的高频部分
或细节部分。综合滤波器组g?(n)和g?(n)将fn(n)和f(n)合并产生子(n)。子带编码的目的是选择
h,(n),h(n),8。(n)和g?(n),以便子(n)=f(n),也就是，子带编码和解码系统的输入和输出是相同
的。当完成了这一任务时，就可以说最终系统采用了完美重建滤波器。
a b p(t)-
★ho(n) 21 21 ★go(n) |H?(o) |H?(w)|
f(n) 分析滤波器组 综合滤波器组 (n) 低频带 高频带
★h?(n) 21 21
hp(n)
★gi(n)
0 π/2 0
π
图7.6 (a)一个二带子带编码和解码系统；(b)其频谱分裂属性
在滤波器组的文献中，描述了许多两波段、实系数、FIR、完美 式(7.1-10)至式(7.1-14)的详细描
述见关于滤波器组的文献(例如，参 重建滤波器组。在所有这些滤波器组中，综合滤波器都被调制为分析
见Veterli and Kovacevie(1995)。 滤波器的形式——有一个(且只有一个)综合滤波器的符号被反转。为
了完美重构，综合滤波器和分析滤波器的冲激响应必须按如下两种方法之一联系起来：
8?(n)=(-D)"h,(n),g?(n)=(-1)"h?(n) (7.1-10)
或
8?(n)=(-D)"?h?(n),g?(n)=(-D)"h?(n) (7.1-11)
式(7.1-10)和式(7.1-11)中的h(n),h?(n),8。(n)和g?(n)被看成是交叉调制，因为在图7.6(a)的方框图
中，斜对着的滤波器是由调制联系起来的[当调制因子是-(-1)"或(-1)"时，符号相反]。此外，可
以看出它们满足下列双正交条件：
(h(2n-k),8,(k))=8(i-D8(n),i,j={0.1} (7.1-12)
其中，(h,(2n-k),8,(k)表示h,(2n-k)和g,(k)的内积。当i不等于j时，内积为0;当i和j相等
时，内积是单位离散冲激函数8(n)。在7.2.1节中，将会再次考虑双正交性。
在子带编码及7.4节的快速小波变换的导出中，特别重要的是滤波器，它排除了双正交性并要求
(8?(n),8,(n+2m)=8(i-j)8(m),i.j={0.1} (7.1-13)
上式定义了完美重建滤波器组的正交性。除式(7.1-13)外，可以证明正交滤波器满足如下两个条件：
g?(n)=(-1)"g。(Kevn-1-n) (7.1-14) h,(n)=8(Kevn-1-n),i={0.1}
其中，Kevm的下标用于指出滤波器系数值必须是能被2整除的数(即一个偶数)。正如式(7.1-14)指出
①序列/m)和后m的向量内积是(n:2)-Zih,,其中*表示复共轭操作。如果f(m)和f(m)是实的，则有(4.A)-(h-)。 厚图
穿;至
296 数字图像处理(第三版)
的那样，综合滤波器g,通过顺序反转和调制与g。建立联系。另外，ho和h分别是综合滤波器g
和g,顺序反转的形式。这样，正交滤波器组就可以围绕的单一滤波器的冲激响应来开发，称之为
原型；其余的滤波器可以通过指定的原型的冲激响应来计算。双正交滤波器组要求有两个原型；其
余滤波器可通过式(7.1-10)和式(7.1-11)来计算。很有用的原型滤波器的产生，无论是归一化正交的
还是双正交的，都超过了本章的范围。我们只是简单地使用在文献中已有的滤波器，并为进一步学
习提供参考。
在使用二维子带编码的例子来总结本节之前，我们注意到一维正交和双正交滤波器对于图像处
理来说，可被用于二维可分离的滤波器。就像我们在图7.7中看到的那样，可分离滤波器用2.6.7节中
介绍的方法，首先用于一维(即垂直方向),然后用于另一维(即水平方向)。此外，在两个阶段执行下
采样——一次是在第二次滤波操作之前执行，以全面地减少计算量。所得滤波后的输出，即在图7.7
中表示的a(m,n),d*(m,n),d"(m,n)和d°(m,n),分别称为输入图像的近似、垂直细节、水平细节和
对角线细节子带。这些子带可分为4个更小的子带，它们还可再分，等等。该特性将在7.4节更详细
地描述。
★Lo(n) 21 a(m,n)
★ho(m) 21 列沿m)
行(沿m) ★h?(n) 21 d(m,n)
f(m,n) 列
★h(n) 21 d(m,n)
★h;(m) 21 列
行
★h?(n) 21 d(m,n)
列
图7.7 子带图像编码的一个二维4带宽滤波器组
例72 图7.1中花瓶的一个4带宽子带编码。
图7.8显示了四个8抽头归一化正交滤波器的冲激响应。
原型综合滤波器g。(n),0≤n≤7的系数[图7.8(c)]在表7.1
中已定义(Daubechies [1992])。其余归一化正交滤波器的系
表7.1 g(n)的Daubechies 8抽头归一化
正交滤波器系数(Daubechies[1992D
n ?)
0 0.23037781
数可用式(7.1-14)计算出来。借助于图7.5,注意(视觉观察) 1 0.71484657
图7.8中的分析和综合滤波器的交叉调制。以数字说明滤波
器是双正交的[满足式(7.1-12)]和归一化正交的[满足
2 0.63088076
3 0.02798376
4 -0.18703481
式(7.1-13)]相对比较容易。结果，图7.8中的Daubechies 8
抽头滤波器支持分解输入的无误差重建。
5 0.03084138
6 0.03288301
图7.1中，512×512的花瓶图像的以图7.8的滤波器为 7 -0.01059740
基础分离的4个子带示于图7.9。该图像的每一个四分之一象限是256×256大小的一个子带。从左上角开
始并按顺时针方式行进，这4个象限分别包含近似子带 a、水平细节子带d"、对角线细节子带d和垂
直细节子带d。除了图7.9(a)中的近似子带外，所有子带均已被缩放，以便它们的基本结构更加明显。
注意，图7.9(b)和(c)的d"子带和d子带中出现了可见的混淆效应。窗户区域的波状线是对图7.1中的一
第7章 小波和多分辨率处理 297
个刚刚能辨别的窗口下采样造成的。不管是否混淆，原始图像可以从图7.9的子带无误差地重建。所需综
合滤波器g。(n)和g?(n)由表7.1 和式(7.1-14)决定，并且合并成一个滤 关于混淆效应的详细信息，请参 波器组，它们可粗糙地反映图7.7的系统。在新滤波器组中，滤波器 阅4.54节。
h,(n),i={0,1}被它们的g,(n)副本取代，并加上了取样器和求和器。
a b hn(n) cd h?(n)
1
0.5 0.5
0 0
6
-0.5 -0.5
-1 0 2
A -1 4 6 8 0 2 4
n
6 8
so(n)
1
g:(n)
1
0.5 0.5
0 0
-0.5 -0.5
-1 n -1
6
n
0 2 4 6 8 0 2 4 6 8
图7.8 4个8抽头Daubechies归一化正交滤波器的冲激响应。8o(n),0≤n≤7的值见表7.1
a bcd
图7.9 使用图 7.7所示的子带编码系统对图7.1中的花瓶进行4子带分离。得到的4个子
带分别是：(a)近似子带；(b)水平细节子带；(c)垂直细节子带；(d)对角线细节子带
7.1.3 哈尔变换
我们将要了解的第三个也是最后一个与多分辨率分析紧密联系的图像操作是哈尔变换
(Haar[1910])。在本章的内容中，其重要性体现在它的基函数(在下面定义)是已知的最古老也最简单
的正交小波。它们将在本节下面的很多实例中得到应用。
以2.6.7节的讨论作为参考，哈尔变换可以用如下矩阵形式表示：
T=HFHT (7.1-15)
其中，F是一个N×N的图像矩阵，H是一个N×N的哈尔变换矩阵，T是一个N×N的变换结果。
转置是必要的，因为H是非对称的；在2.6.7节的式(2.6-38)中，变换矩阵假定是对称的。对于哈尔 图;象
落～5
298 数字图像处理(第三版)
变换，H包含哈尔基函数h(z)。它们定义在连续闭区间z∈[0,1],k=0,1,2,…,N-1上，其中N=2"
为了生成矩阵H,定义整数k,即k=2P+q-1,其中0≤p≤n-1,当p=0时.q=0或1,而当p≠0
时，1≤q≤2°。因此，哈尔基函数为
h(2)=ho(2)=,ze[0.1] (7.1-16)
和
o(7.1-17)
N×N哈尔变换矩阵的第；行包含了元素h(z),其中z=O/N,1/N,2/N,…,(N-1)N。例如，如果N=2,
那么2×2哈尔矩阵的第一行使用h,(2),z=02,1/2来计算。由式(7.1-16),h?(z)=1/√2.它独立于z,
因此H?有两个相等的1/√2元素。第二行由计算h?(z),z=0/2,1/2得到。因为当k=1,p=0且q=1时
有k=2'+q-1,这样，由式(7.1-17),h(0)=21√2=1/√2,h1/2)=-2°7√2=-1/√2.因此，2×2
哈尔矩阵是
H-] (7.1-18)
如果N=4,且假设k,q和p的值如下：
k P
0
0
1
1
q
0
1
2
3
0
1
1
2
那么4×4变换矩阵H?为
(7.1-19)
我们对哈尔变换的主要兴趣在于，H?的行可用于定义一个2抽头完美重建滤波器组(见前一节)的分
析滤波器h(n)和h(n),以及最简单且最古老的小波变换(见7.4节中的例7.10)的缩放比例和小波向
量(分别在7.2.2节和7.2.3节中定义)。与其用计算哈尔变换来结束本节，不如用一个例子来说明分解
方法的影响，在剩余章节将要描述的方法中已经考虑到这一点。
例7.3 离散小波变换中的哈尔函数。
图7.10(a)显示了图7.1中的512×512图像的分解，它结合了金字塔编码、子带编码和哈尔变换(到
目前为止我们已探讨了这三种技术)的关键性质。称为离散小波变换(在本章稍后阐述)是因为这种表示是
由如下重要性质来表征的。
1.除了图7.10(a)左上角的子图像之外，局部直方图非常相似。许多像素接近于零。因为这些子图像
(左上角的子图像除外)已被缩放，以使得其基本结构更明显，所显示的直方图在灰度128处有峰
值(零值已被标定为中等灰度)。分解中的大量零值使得图像对于压缩来说是一个优秀的候选者(见
第8章)。
第7章 小波和多分辨率处理 299
bcd
图7.10(a)用H?哈尔基函数的离散小波变换，并显示了其局部直方图的变化：
(b)~(d)由(a)得到的几种不同的近似(64×64.128×128和256×256)
2.采用类似于使用图7.3(b)中的预测残差金字塔的各个级别来创建不同分辨率的近似图像的方法，
图7.10(a)的子图像可用来构建图7.1中原始花瓶图像的粗和细分辨率的近似。图7.10(b)到(d)
中大小分别为64×64,128×128和256×256的图像是由图7.10(a)中的子图像生成的。512×512
的原始图像完美重建也是可能的。
3.类似于图7.9中的子带编码分解，由图7.7中给出的简单的实系数FR滤波器组形式用于产生
图7.10(a)。类似于图7.9的一幅4子带图像生成后，256×256的近似子带被分解并被4个128×128
的子带代替(使用相同的滤波器组),得到的近似子带被再次分解并被4个64×64的子带代替。这
一处理产生了唯一的子图像排列，它表征了离散小波变换的特性。正如您从图像的右下角移到左
上角那样，图7.10(a)的子图像尺寸上逐渐变小。
4.图7.10(a)不是图7.1中图像的哈尔变换。尽管用于产生这种分解的滤波器组系数取自哈尔变换矩
阵H?,多种归一化正交和双正交滤波器组系数可在离散小波变换中使用。
5.正如7.4节中将说明的那样，图7.10(a)中的每一幅子图像都描绘了原始图像中空间频率的一个特
定频带。另外，许多子图像显示了方向敏感性[例如，图7.10(a)右上角的子图像获取原图像中的
水平边缘信息]。
考虑到令人印象深刻的这些特性，图7.10(a)的离散小波变换可用两抽头的、总数有4个滤波器系数
的数字滤波器来产生。 逡
落名
300 数字图像处理(第三版)
7.2 多分辨率展开
前一节介绍了三种著名的图像处理技术，它们在数学理论多分辨率分析(MRA)中扮演了重要角
色。在MRA中，尺度函数被用于建立一个函数或一幅图像的一系列近似，每个近似与其最近邻近似
在分辨率方面都用因子2来区分。然后，称为小波的附加函数被用于对相邻近似之间的差异进行编码。
7.2.1 级数展开
信号或函数f(x)通常可以被很好地分解为一系列展开函数的线性组合：
fw)=∑a(x) (7.2-1)
其中，k是有限和或无限和的整数下标，a是具有实数值的展开系数，p(x)是具有实数值的展开函数。
如果展开是唯一的，也就是说对于任何给定的c只有一组a与之对应，那么p(x)就称为基函数，并
且展开集合(p?(x)}就称为可这样表示的一类函数的基。可展开的函数形成了一个函数空间，称为展开
集合的闭合跨度，表示为
v=Span{q(x} (7.2-2)
f(x)∈V的意思是f(x)属于{φ(x)}的闭合跨度，并可写为式(7.2-1)的形式。
对于任意函数空间V及相应的展开集合{φ(x)],都有一个表示为[p(x)}的对偶函数集合，它可
用于对任意f(x)eV计算式(7.2-1)的系数a。这些系数是通过计算对偶函数p(x)和函数f(x)的内积
得到的，即
a=(便(x).f(x)=?p(x)f(x)dx (7.2-3)
其中*表示复共轭操作。依靠展开集合的正交性，该计算假定是三种可能形式中的一种。本章末尾的
习题7.10用二维欧氏空间中的向量说明了这三种情况。
情况1:如果展开函数构成了V的一个正交基，即
(p,u).e(x)=8A=1:j=k (7.2-4)
则该基与它的对偶基相等，即φ(x)=p(x),式(7.2-3)变成
α=(φ(x),f(x)〉 (7.2-5)
a?由基函数与f(x)的内积来计算。
情况2:如果展开函数本身不正交，但却是V的一个正交基，那么
(φ,(x),Pe(x)=0,j≠k (7.2-6)
且基函数及其对偶称为双正交函数。用式(7.2-3)来计算a,双正交基及其对偶有下列形式：
①两个实或复值函数f(x)和g(x)的内积是(f(x).g(x)=jrcx)g(x)dr。如果f(x)是实的，则广()=f(x)且(f(x.g(x))=
?r(x)g(xjdx
第7章 小波和多分辨率处理 301
((x),e(x)=8A-1.J=k (7.2-7)
情况 3:如果展开集合不是V的一个基，但支持式(7.2-1)中定义的展开，那么它就是一个跨度
集合，在该跨度集合中，任何f(x)∈V都有一个以上a的集合。展开函数及其对偶可以说是超完
备的或冗余的。它们形成了一个框架，其中，对于某些A>0,B<及所有f(x)∈V,有①
A|rxP<ZKe?(x),f(x)2≤Blfx)P2 (7.2-8)
用f(x)的范数的平方去除该式，我们看到A和B构成了扩展系数与该函数的归一化内积。类似
式(7.2-3)和式(7.2-5)的等式可用于得到框架的展开系数。若A=B,则展开集合称为紧框架，并
且可以证明(Daubechies[1992]1)
fu)= Z(e(,.f(x)e(x) (7.2-9)
除A1项之外，它是框架冗余的度量，这与将式(7.2-5)(对于正交基)代入式(7.2-1)得到的表达式相等。
7.2.2 尺度函数
考虑由整数平移和实数二值尺度、平方可积函数φ(x)组成的展开函数集合，即集合{(x)},
其中
甲，x(x)=2φ(2'x-k) (7.2-10)
对所有的j, keZ和φ(x)eL2(R)都成立②。这里，k决定了φ,x(x)沿x轴的位置，j决定了φ(x)的宽
度，即它沿x轴宽或窄。项22控制函数的幅度。由于φ(x)的形状随j发生变化，所以φ(x)称为尺
度函数。通过选择适当的φ(x),可使{φ(x)}跨越L(R),它是所有可度量的、平方可积函数的集合。
如果我们将式(7.2-10)中的j限制为某个指定的值，譬如j=jo,则得到的展开集合{jox(x)}是
{9,x(x)}的一个子集，它跨越L(R)的子空间。使用前一节中的符号，我们可将该子空间定义为
vo=Span{Po(x} (7.2-11)
也就是说，V?是φjox(x)在k上的一个跨度。如果f(x)∈V,,我们可写出
fw)=Zao(x) (7.2-12)
更一般地，对于任何j,我们将k上跨越的子空间表示为
v,=Span{p/(x} (7.2-13)
就像我们将要在下例中看到的那样，增加j就增加 V,的大小，允许具有较小变化的变量或较细的细节
函数包含在子空间中。这是如下事实的原因：随着j的增大，用于表示子空间函数的φ(x)会变得
较窄，并且x有较小变化即可分开。
①表示为|/(x)|的f(x)的范数定义为f(x)与自身内积的绝对值的平方根。
②符号L(R)中，R是实数集，表示可度量的、平方可积的一维函数集合，Z是整数集。 退：目
言留
302 数字图像处理(第三版)
例7.4 哈尔尺度函数
考虑单位高度、单位宽度的尺度函数(Haar[1910])
w-6°其他 (7.2-14)
图7.11(a)到图7.11(d)显示了多个展开函数中的4个函数，这些展开函数是通过将脉冲型尺度函数代
入式(7.2-10)中得到的。注意，当j=1时，图7.11(c)和(d)中的展开函数是图7.11(a)和(b)中j=0时展开
函数的宽度的一半。对于x的一个给定区间，我们可以与V?的尺度函数的两倍那样定义V?的尺度函数(例
如，对于区间0≤x<1,V?的q。和q,相对于V?的φo)。
a b (x)=中(x)
c d
ui(x)=φ(x-1)
ef 1 1
0
6 1 2 3 0 1 2 3
dx)=√2e(2x) 甲i,(x)=12φ(2x-1)
1 1
0 0
0 1 2 x3 0 1 2 3
f(x)eV fua(x)eV
1 中L1
-02541
05
1
0
0 1 2 3
置
u/
中u/N?
0 2 3
图7.11 一些哈尔尺度函数
图7.11(e)显示了子空间v?中的一个成员。该函数不属于V。,因为图7.11(a)和图7.11(b)中的V。展
开函数太粗糙而不能表示它。需要如图7.11(e)和图 7.11(d)所示的高分辨率函数。如图 7.11(e)所示，它
们可以用用三项展开来表示该函数：
f(x)=0.5φ,o(x)+4(x)-0.25p.4(x)
为总结该例子，图7.11(f)表明将pad(x)的分解作为V,展开函数的和。采用类似的方式，V?的展开函数可
以使用下式分解：
9a()=i?9z(x)+方?9.(x)
因此，如果f(x)是V?的元素，那么它也是V的元素。这是因为所有的V。展开函数都包含在V?中。数学
上，我们可以写出V。是V?的一个子空间，记为V?EV?
第7章 小波和多分辨率处理 303
在上述例子中，简单尺度函数遵循多分辨率分析的4个基本要求(Mallat[1989a]):
MRA要求1:尺度函数对其整数平移是正交的。
很容易看出，在哈尔函数的情况下，因为无论什么时候只要尺度函数的值是1,其整数平移就是
0,所以二者的乘积为0。哈尔尺度函数是紧支撑的，其意思是除称为支撑区的有限区间外，函
数值都为0。事实上，支撑的宽度是1;半开区间[0,1]外其值为0。必须注意，当尺度函数的支
撑宽度变得大于1时，正交整数平移的要求将很难满足。
MRA要求2:低尺度的尺度函数跨越的子空间嵌套在高尺度跨越的子空间内。
如图7.12所示，包含高分辨率函数的子空间必须同时包含所有的低分辨率函数。也就是说，
v_c…CV,cV?cv?EV?c…cV(7.2-15) VocVicV?
此外，这些子空间还满足直观条件，即如果f(x)eV,
那么f(2x)eV,.1。哈尔尺度函数满足该要求的事实并不意
味着任何支撑宽度为1的函数都自动满足该条件。我们将
其作为练习，留给读者证明同样简单的函数 Vo
w)-{6 0.25≤x<0.75
其他
不是用于多分辨率分析的一个有效尺度函数(见习题7.11)。
图7.12 尺度函数跨越的嵌套函数空间 MRA要求3:唯一的对所有V,通用的函数是f(x)=0。
如果考虑可能最粗糙的展开函数(即j=-∞),唯一的表达函数就是没有信息的函数，即
V_={0} (7.2-16)
MRA要求 4:任何函数都可以以任意精度表示。虽然不可能以任意粗糙的分辨率来展开一个特定
f(x),例如图7.11(e)所示函数的情况，但所有可度量的、平方可积的函数都可以由尺度函数在户
的限制下表示，即
v={22(R)} (7.2-17)
在这些条件下，子空间V,的展开函数可以表述为子空间V的展开函数的加权和。使用式(7.2-12),令
()=Z()
其中，为清楚起见，求和的下标被改写成n。将来自式(7.2-10)的p(x)代人上式，并将变量a改写
成h,(n),上式变成
(×=Z?(n)22e(2"x-n)
因为p(x)=Pao(x),j和k都可以置为0,以得到较简单的无下标表达式
qx)=∑n?(n√Zp(2x-n) (7.2-18)
该递归等式中的系数h(n)称为尺度函数系数；h。为尺度向量。式(7.2-18)是多分辨率分析的基础，称
为改进等式、MRA 等式或扩张等式。它表明任意子空间的展开函数都可以由其本身的双倍分辨率副
本来建立，即来自相邻较高分辨率空间的展开函数。参考子空间V?的选择是任意的。 室：自
受;
304 数字图像处理(第三版)
例7.5 哈尔尺度函数系数。
式(7.2-14)所示哈尔函数的尺度函数系数是h,(0)=h,(1)=1/√2,即式(7.1-18)中矩阵H?的第一行。
因此，由式(7.2-18)可得
q(x)=方[√2p(2x)]+方?[√2p(2x-D]
图7.11f)以图形方式说明了pao(x)的分解，其中，前面表达式中方括号内的项被看成是p1.(x)和
P1.(x)。加以化简后得到p(x)=φ(2x)+φ(2x-1)。
7.2.3 小波函数 V?=V?ow?=V田W?oW?
给定满足前一节中MRA要求的尺度函数，我
们可以定义小波函数v(x),它与其整数平移及二值
尺度一起，跨越了任意两个相邻尺度子空间V,和
V?=VoW
w?
Wa
V? V之间的差。图7.13 图示说明了这种情况。对
于跨越图中W,空间的所有keZ,我们定义小波集
合{ψ(x)}。
V(x)=22ψ(2'x-k) (7.2-19) 图7.13 尺度函数与小波函数空间之间的关系
使用尺度函数，我们可写为
w,=Span{yA(x} (7.2-20)
并注意到如果f(x)eW,那么有
f(x)=La(x) (7.2-21)
图7.13中的尺度函数和小波函数子空间由下式联系起来：
VH=V,田w, (7.2-22)
其中，田表示空间的并集(类似于集合的并集)。V中V,的正交补集是W,且V,中的所有成员对于
W,中的所有成员都正交。因此，
(φ;(x),y,(x))=0 (7.2-23)
对所有适当的j,k,l∈Z都成立。
现在我们可以将所有可度量的、平方可积的函数空间表示为
L2(R)=V?田W田W?田… (7.2-24)
或
L2(R)=v?田W?田W?田… (7.2-25)
甚至是
2(R)=…田W?田W,田W田W?田W?田… (7.2-26)
上式中排除了尺度函数，并且函数仅用小波项来表示[即在式(7.2-26)中仅有小波函数空间]。注意，
第7章 小波和多分辨率处理 305
如果f(x)是V?而不是V。的元素，则使用式(7.2-24)的展开包含使用V。尺度函数的f(x)的近似；来自
W?的小波将对这种近似与实际函数之间的差进行编码。由式(7.2-24)到式(7.2-26)可推广得到
L2(R)=V 田w田W田… (7.2-27)
其中；。是任意开始尺度。
因为小波空间存在于由相邻较高分辨率尺度函数跨越的空间中(见图 7.13),所以任何小波函数，
类似式(7.2-18)中其尺度函数的对应部分，可以表示成平移后的双倍分辨率尺度函数的加权和。也就
是说，我们可以写成
w(x)=∑n(n/Zp(2x-n) (7.2-28)
其中，h,(n)称为小波函数系数，h,为小波向量。利用图7.13中小波跨越正交补集空间和整数小波平
移是正交的条件，可以证明h,(n)和h,(n)以下述方式相关(例如，见Burrus,Gopinath and Guo[1998]):
h(n)=(-1)"h,(1-n) (7.2-29)
注意该结果与式(7.1-14)的相似性，该关系决定了正交子带编码和解码滤波器的冲激响应。
例7.6 哈尔小波函数系数。
在上例中，哈尔尺度向量定义为h,(0)=h,(1)=1/√2。使用式(7.2-29),相应的小波向量为h,(0)=
(-1)h,(1-0)=1/√2和h,(1)=(-1)'h,(1-1)=-1/√2。注意，这些系数与式(7.1-18)中矩阵H?的第二行对
应。将这些值代人式(7.2-28),我们得到w(x)=p(2x)-φ(2x-1),其图形如图7.14(a)所示。因此，哈尔小
波函数为
(7.2-30)
使用式(7.2-19),我们现在可产生缩放且平移后的哈尔小波通式。图7.14(b)和(c)中分别画出了两个这样
的小波yaz(x)和w1a(x)。注意，对于空间W,中的小波w?(x)要比对于空间W。中的小波paz(x)窄；它可以
用来表示更细微的细节。
图7.14(d)显示了在子空间V,而不在子空间V。中的函数。该函数在前述例子中曾考虑过[见图7.11(e)]。
虽然该函数不能在V。中精确地表示，但式(7.2-22)指出它可以使用V。和W?的展开函数来展开。展开结果
如下：
f(x)=f。(x)+fa(x)
其中，
6)=342e×)-ga?()和t?x)=2woc(x)-82wa?(x)
这里，f。(x)是使用V。尺度函数对f(x)的近似，而f(x)为f(x)-f。(x)的差，用W。小波的和来表示。这
两个展开式如图 7.14(e)和(f)所示，将f(x)用类似图7.6 讨论过的高通和低通滤波器的方法分成两
部分。f(x)的低频部分在f。(x)中得到，它假定为每一个整数区间上的平均值，而高频细节则在f(x)
中编码。 屋离
508
306 数字图像处理(第三版)
ψ(x)=中o(x) 中2(x)=中(x-2)
1 1
a b c d e f
0 0
-1 -1
0 1 2 3
x
0 1 2
x3
中1.(x)=√2ψ(2x) f(x)=V?=Vn甲W?
1
丨
1
0 0
-1 -1
0 1 2
x3 0 1 2
x
3
f(x)=V? fa(x)∈W?
1
3√2/49uo
-√2/8902
1
0 0
-1 -1
0 1 2 x3
-V2/8p0,2
-V2/4中oo
0 1 2 3
x
图7.14 W?和W,中的哈尔小波函数
7.3 一维小波变换
现在我们可以正式地定义几个紧密相关的小波变换：一般的小波级数展开、离散小波变换和连
续小波变换。它们在傅里叶域中的对应形式分别是傅里叶级数展开、离散傅里叶变换和积分傅里叶变
换。7.4节将说明一种计算效率很高的称为快速小波变换的离散小波变换。
7.3.1 小波级数展开
首先用定义关于小波y(x)和尺度函数φ(x)的函数f(x)∈L2(R)小波级数展开开始。根据式(7.2-27),
f(x)可以在子空间V?中用尺度函数展开(式(7.2-12)定义了这样一个展开)和在子空间WoWo+1…中
用某些数量的小波函数展开[就像式(7.2-21)中定义的那样]来表示。即
ra=2cak(+2Za,ukyA() (7.3-1)
其中j。是任意的开始尺度，c?(k)和 d(k)分别是式(7.2-12)和式(7.2-21)中a的改写形式。co(k)通常
称为近似和/或尺度系数，d,(k)称为细节和/或小波系数。这是因为式(7.3-1)中的第一个和式使用尺
第7章 小波和多分辨率处理 307
度函数提供了f(x)在尺度j。处的近似[除非f(x)∈V?使得尺度函数的和等于f(x)]。对于第二个和式
中的每个较高尺度j≥jo,更细分辨率的函数——即小波的和——被添加到了近似中，以供增加的
细节。如果展开函数形成了一个正交基或紧框架，通常情况下是这样，基于式(7.2-5)和式(7.2-9)的
展开系数计算如下： 因为了是实函数。故式(73-2)和
cno(k)=(f(x),Po(x)=?f(xpo(x)dx
和
d,(k)=(fx),ψ(x)=?f(xw,(x)dx
(7.3-2)式(7.3-3)的内积中不需要共轭
(7.3-3)
在式(7.2-5)和式(7.2-9)中，展开系数(即α)被定义为被展开的函数和被用于展开的函数的内积。在
式(7.3-2)和(7.3-3)中，展开函数是φjok和ψx,展开系数是c。和d,。如果展开函数是双正交基的
一部分，这些等式中的φ项和y项必须用它们的对偶函数φ和ū代替。
例7.7 y=x2的哈尔小波级数展开。
考虑图7.15(a)所示的简单函数
-{e其他
利用哈尔小波[见式(7.2-14)和式(7.2-30)]和一个开始尺度j。=0,可以用式(7.3-2)和式(7.3-3)计算下述
展开系数：
-[ncsu-[c-5-
d。O)=Jxwo(x)dx=J°rdx-Jsr2dx=-4
d,0)=Jna(x)dx=JO√zdx-Jzdx=-32
40=[va(x)ux=J”P√zd-J,2Jzdx=32
将这些值代人式(7.3-1),我们得到如下小波级数展开：
Y=yeW??eW
上述展开中的第一项用c。0)生成被展开的函数的 V。子空间的近似。该近似如图7.15(b)所示，并且它是
原始函数的平均值。第二项使用d,(0)通过从W。子空间添加一级细节来改进该近似。添加的细节和得到的
V,近似分别如图7.15(c)和图7.15(d)所示。其他级别的细节由子空间W,的系数d,(0)和d,(1)添加。该附加
细节如图7.15(e)所示，得到的V?近似如图7.15(f)所示。注意，展开函数现在开始接近原始函数。随着更
高尺度(或更大级别的细节)的叠加，近似变得更接近函数的精确表示，在极限情况下，当j○时，实现
精确表示。 官：要
目：即
308 数字图像处理(第三版)
a b c d cf y=
0.5 0513
0
-0s[ -0.5 x
V
1/3
x 0 025 0.5 0.75 0 025 0.50.75
w
0s 712 -1/4dam 14
0
1/12
-14
-05 -0.5
0 0.25 0.50.75 0
V
0.25 05 0.75
w
-3√2/32中 -√2/32中
37/48
1948 3/16 2
-316
748
1/48
0 0.25 0.5 0.75 x
-05[
00.25
V?
0.5 0.75 X
图7.15 使用哈尔小波y=x2的小波级数展开
7.3.2 离散小波变换
与傅里叶级数展开相似，前一节的小波级数展开将一个连续变量函数映射为一系列系数。如果
待展开的函数是离散的(即数字序列),得到的系数就称之为离散小波变换(DWT)。例如，对于某
些x?,△r和n=0.1,2,…,M-1,如果f(n)=f(x?+n△r),对f(x)的小波级数展开系数[由式(7.3-2)和
式(7.3-3)定义]就变成序列f(n)的正向DWT系数：
W。CG.k)=六∑r(mp(m (7.3-5)
W?G,A)=六∑r(my(m),i≥i (7.3-6)
在这些等式中，φox(n)和v,x(n)是基函数φox(x)和ψ,(x)的取样形式。例如，对于某些x,Ax,和
n=0,1,2,…,M-1,有φox(n)=9ox(x,+nAx,)。这样，我们在基函数的支撑上用M个等间隔的取
样(见下面的例7.8)。根据式(7.1-3),反向DWT是
rw=六∑WCGkeA+六ZZW(Gk(O) (7.3-7)
通常，我们令j。=0,并选择M为2的幂(即M=2),在式(7.3-5)到式(7.3-7)中，求和在n=0,1,2,…,
M-1,j=0,1,2,…,J-1和k=0,1,2,…,2/-1上执行。对于哈尔小波，变换中采用的离散尺度和小波
函数(即基函数)与7.1.3节中的M×M哈尔变换矩阵的行相对应。变换本身由M个系数组成，最小尺
度是0,最大尺度是J-1。出于对7.3.1节的注释和例7.6中说明的原因，式(7.3-5)和式(7.3-6)中定
义的系数通常分别称为近似系数和细节系数。
第7章 小波和多分辨率处理 309
式(7.3-5)到式(7.3-7)中的W。(jo,k)和W(j,k),分别对应于前一节中的小波级数展开ca(k)和d(k)
(这些变量的改变并不是必需的，但为下一节的连续小波变换中的标准表示提供了铺垫)。注意，级数
展开中的积分已用求和来代替，而曾在4.4.1节的DFT中出现的归一化因子1/√M已加到了正向和反
向展开表达式中。该因子也可以在正向展开和反向展开表达式中以1/M的形式出现。最后，应记住
式(7.3-5)到式(7.3-7)只对正交基和紧框架有效。对于双正交基，式(7.3-5)和式(7.3-6)中的φ和y项
必须分别由它们的对偶函数φ和ψ来代替。
例7.8 计算一维离散小波变换。
为说明式(7.3-5)到式(7.3-7)的使用，考虑4点离散函数：f(O)=1,f(1)=4,f(2)=-3和f(3)=0。因
为M=4,J=2,且由于j=0,和j=0时k=0,j=1时k=0,1在x=0,1.2,3,j=0,1上执行求和。我
们将使用哈尔尺度函数和小波函数，并假定f(x)的4个样本分布在基函数的支撑区上，基函数的宽度为1。
将4个样本代人式(7.3-5),我们得到
w.0.0)-22ropea(m)=21.1+4-1-3-1+0-]=1
因为对于n=0,1,2,3有pao(n)=1。注意，这里采用的是哈尔尺度函数对于j=0和k=0的均匀间隔采样。
这些值对应于7.1.3节的哈尔变换矩阵H?的第一行。继续使用式(7.3-6)和相似间隔的样本?(x),它对应
于H?的第2,3,4行，我们得到
w,(0.0)= [1-1+4-1-3-(-D+0-(-DJ]=4
wa.0)=-[1-2+4-(-2)-3-0+0-0]=-15√2
w,(.D=[1-0+4-0-3.√2+0-(-√2)]=-1.5√2
因此，这个简单的4点样本函数的离散小波变换与哈尔小波及尺度函数的关系就是{1.4,-1.5√2,
-1.5√21,这里，变换系数是按计算顺序排列的。
式(7.3-7)可使我们由其变换来重建原始函数。重复求和，我们得到
f(m)= [w0,0]9.()+W(0.0Wa. (A)+w,0.0w2a()+w,0.Dw.(m]
n=0,1,2,3。例如，如果n=0,则有
f(o)=2[1-1+4-1-1.5√2·√2]-1.5√2-0]=1
与正变换情况一样，尺度函数和小波函数的均匀间隔采样也用于反变换的计算。
上例中的4点DWT是f(n)的一个二尺度分解，即j={0,1)。基本假设是开始尺度后为0,但也可
以使用其他的开始尺度。作为练习(见习题7.16),请读者在开始尺度为1时，计算单尺度变换(2.5√2,
-1.5√2,-1.5√2,-1.5√2]的结果。这样，式(7.3-5)和式(7.3-6)就定义了“一族”开始尺度。不同
的变换。
7.3.3 连续小波变换
离散小波变换的自然延伸是连续小波变换(CWT),连续小波变换将一个连续函数变换为两个连
续变量(平移和尺度)的高冗余度函数。变换结果在时间-频率分析时很容易解释并有很大的价值。虽
然我们的兴趣在离散图像上，但出于完整性的考虑，这里也覆盖了连续变换。 园
:5
310 数字图像处理(第三版)
连续的平方可积函数f(x)的连续小波变换与实数值小波y(x)的关系定义为
W。(s,t)=?_f(xiw.?(x)dx (7.3-8)
其中，
(x)=÷=) (7.3-9)
s和r分别称为尺度参数和平移参数。给定W,(s,t),可以使用连续小波反变换求得f(x):
rw=÷J。w(s.)ards (7.3-10)
其中，
c= (7.3-11)
Ψ(μ)是w(x)的傅里叶变换。只要满足所谓的允许条件C,<0(Grossman and Morlet[1984),式(7.3-8)
到式(7.3-11)就定义了反变换。大多数情况下，这仅意味着ψ(0)=0,且当使得C,<∞,u→时以足
够快的速度使中(μ)→0。
上面这些等式使我们想起了它们的离散形式，即式(7.2-19)、式(7.3-1)、式(7.3-3)、式(7.3-6)和
式(7.3-7)。注意下列相似性：
1.连续变换参数t取代了整数平移参数k。
2.连续尺度参数s与二进制尺度参数2相反。这是由于s出现在式(7.3-9)中y((x-T)/s)的分母
上。这样，连续变换中使用的小波在0<s<1时就被压缩或宽度减小，在s>1时就被扩大
或展开。小波尺度和传统意义上的频率表示关系是相反的。
3.连续变换类似于级数展开[见式(7.3-1)]或开始尺度j。=-∞的离散变换[见式(7.3-6)]。根
据式(7.2-26),这消除了明显的尺度函数间的联系，因此，函数仅用小波项来表示。
4.与离散变换类似，连续变换可以看成是一组变换系数(Wy(s,r)),它度量f(x)与一组基函数
{p.(x)}的相似性。然而，在连续情况下，两个集合都是无穷的。由于w(x)具有实数值，且
w,(x)=w*,(x),所以式(7.3-8)中的每个系数都是f(x)和w(x)的内积〈f(x),w(x)>。
例7.9 一维连续小波变换。
墨西哥草帽小波
w-(3”)a-x)e (7.3-12)
由其独特的波形而得名[见图7.16(a)]。它与高斯概率函数的二阶导数成正比，均值为零，并且是紧支撑
的(即当ld→时迅速衰减)。虽然它满足连续可逆变换存在的容许性要求，但没有相关的尺度函数，且计算
的变换不能得到正交分析。它的最显著的特性是其对称性和式(7.3-12)的显式表达的存在性。
图7.16(a)中的连续一维函数是两个墨西哥草帽小波的和：
f(x)=1.o(x)+wag(x)
其傅里叶频谱如图7.16(b)所示，该谱揭示了尺度化小波和傅里叶频段之间的紧密联系。频谱中的两个宽
频段(或峰值)对应于该函数的两个类高斯扰动。
图7.16(c)显示了图7.16(a)中关于墨西哥草帽小波函数的CWT的一部分(1≤s≤10且r≤100)。与
第7章 小波和多分辨率处理 311
图7.16(b)中的傅里叶频谱不同，它同时给出了空间域和频率域信息。注意，例如，当s=1时，变换在r=10
时达到最大值，这对应于f(x)的分量1.(x)的位置。因为变换为f(x)及其计算出的小波之间的相似性提供
了客观评价，因此很容易理解它是如何用于特征检测的。我们仅需要与感兴趣的特征相匹配的小波。根
据图7.16(d)中的灰度图也可以得出类似的结论，其中变换的绝对值IWw(s,t)用黑白之间的灰度来显示。
注意，连续小波变换将一个一维函数变成一个二维结果。
f(x) |Fμ)
1 0.035 d
o05
0005
-04L
0 10 80 100 0
20
W,(s.7)
1
08
0604
02
S
-02
-0.4
-0.6 10
-0s
10 8
S 40 60 80 100
00 20
00 80 100
图7.16 连续小波变换[(c)和(d)]和一个连续一维函数(a)的傅里叶谱(b)
7.4 快速小波变换
快速小波变换(FWT)是一种实现离散小波变换(DWT)的高效计算，该变换使用了相邻尺度DWT
系数间的一种幸运的令人惊讶的关系。它也称为Mallat人字形算法(Mallat[1989a,1989b]),FWT类似于
7.1.2节中的2子带的子带编码方案。
再次考虑多分辨率详细的等式
p(x)=∑n.(m√Zp(2x-n)
式(741)是722节中的式(72-18)。
(7.4-1)
用2对x尺度化，用k对它平移，并令m=2k+n,给出
9(2′x-k)=Zn.(wNZe(22/x-x)-n)=Zn?(mNZg(2/x-2k-n)
=∑h?(m-2k)/Zp2 x-m) 742)园
·引
312 数字图像处理(第三版)
注意，尺度向量h,看成是用来将φ(2x-k)展开为尺度j+1的尺度函数之和的“加权”。从式(7.2-28)开
始的一系列类似操作为w(2x-k)提供了一个相似的结论，即
w(2′x-k)=Zn(m-2kN2n(2x-m) (7.4-3)
其中，式(7.4-2)中的尺度向量h,(n)对应于式(7.4-3)中的小波向量h,(n)。
现在考虑7.3.1节中的式(7.3-2)和式(7.3-3)。它们定义了连续函
数f(x)的小波级数展开系数。将小波定义式(7.2-19)代入式(7.3-3),
我们得到
d,(k)=?f(x)22(2/x-k)dx (7.4-4)
使用式(7.4-3)的右端代替y(2/x-k)后，变成
aA)=-?ra2Zcm-2k)Zo2x-m)dr
当了为离散函数时，小波级数展
开系数变成了DWT系数。这里，我
们从级数展开系数开始，以便简化
推导过程：我们可直接代入早期的
结果(如尺度和小波函数的定义)。
(7.4-5)
交换求和与积分的顺序，并重新排列各项，然后，给出
d,(k)=Zn(m-2k)[?fax]20+/p(24x-m] (7.4-6)
其中，方括号中量是式(7.3-2)在j。=j+1和k=m时的c?(k)。为了理解这一点，将式(7.2-10)代入
式(7.3-2),并分别用j+1和m代替j。和k。因此，我们可以写出
d,(k)=Zr(m-2k)en(m) (7.4-7)
注意，尺度j的细节系数是尺度j+1的近似系数的函数。以式(7.4-2)和式(7.3-2)作为涉及小波级数展
开(和DWT)近似系数类似推导的起点，我们同样发现
c(k)=∑h,(m-2k)cH(m) (7.4-8)
当f(x)为离散函数的时候(见73.2节),因为小波级数展开的系数c,(k)和d,(k)变成了 DWT的系数
W.(j,k)和W(j,k),所以我们可以写出
W(G,k)=∑h(m-2k)W。Gj+1.m) (7.4-9)
W。G.k)=∑?(m-2k)W。G+1,m) (7.4-10)
式(7.4-9)和式(7.4-10)揭示了相邻尺度的DWT 系数间的明显关系。将这些结果与式(7.1-7)进行
比较，我们看到W。(j,k)和W(j,k),尺度j的近似和细节系数可用W.(j+1,k)和尺度j+1的近似系
数，分别与顺序倒置尺度和小波向量h,(-n)与h(-n)进行卷积操作，然后对结果下取样来计算。
图7.17以方框图的形式总结了这些操作。注意，该方框图与图7.6中的2子带的子带编码和解码系统
在h,(n)=h,(-n)和h(n)=h(-n)时的分析部分相同。因此，我们可以写出
W.Gj,k)=h(-n)*W。(j+1,n)-2,k≥0 (7.4-11)
和
W.G.k)=h,(-n)*W。Gj+1,n.≥0 (7.4-12)
第7章 小波和多分辨率处理 313
其中，卷积是在n=2k,k≥0时直接求值。正如在例7.10中将要看到的那样，非负的偶数项求卷积等
价于滤波和基2下取样。
★h,(-n) 21 ●W.G.n)
W,U+1,n)
★h,(-n) 21 ●W,G.n)
图7.17 一个FWT分析滤波器组
式(7.4-11)和式(7.4-12)是计算快速小波变换的定义式。对于一个长度为M=2的序列，所涉及
的数学操作的次数约为0(M),即乘法和加法的次数与输入序列的长度呈线性关系，因为在图7.17中，
用FWT分析滤波器组执行的卷积所涉及的乘法和加法的次数与进行卷积序列的长度成正比。这样，
FWT比用FFT算法有利，它约要求O(M log?M)次操作。
为总结FWT的阐述，我们注意到图7.17中的滤波器组可“迭代”地产生多级结构，以便计算两
个或多个连续尺度的DWT系数。例如，图7.18(a)显示了用于计算变换的两个最高尺度系数的二级滤
波器组。注意，最高尺度系数假定为函数本身的取样值，即WJ,n)=f(n),其中J表示最高尺度[根
据7.2.2节，f(x)∈V,,其中V,是函数f(x)所在的尺度空间]。图7.18(a)中的第一个滤波器组将原始函
数分解为一个低通，它对应于尺度系数W.J-1,n)的近似分量，和一个高通，它对应于系数W(J-1,n)
的细节分量。这就是图7.18(b)的图示说明，其中，尺度空间V,被分成小波子空间WA和尺度子空间
V。原始函数的频谱被分成两个半带宽分量。图7.18(a)中的第二个滤波器组将频谱和子空间V,H
较低的半带宽，分解成1/4带宽子空间W?和V?,分别对应于DWT系数W.(J-2,n)和W(J-2,n)。
a
b
*h。(-n) 21 W.u-1.n)
um)
如果将式(749)中的九(m-2k)重
写为丸，(-(2k-m),我们会发现第一
个减号负责颠倒顺序[见式(7.1-6)],
2k 负责子取样[见式(7.1-2)],m是
卷积的哑变量[见式(7.1-7)]。
★h(-n) 21 ●W.(1-2,n)
★h,(-n) 21 w,U-1.n)
★h,(-n) 21 ●W,(-2.n)
H(w)
v, V-1
V W?_2 W,-1
0 π/4 π/2
图7.18(a)一个二级或二尺度FWT分析滤波器组；(b)其频率分离特性 ;:5
55
314 数字图像处理(第三版)
图7.18(a)中的二级滤波器组很容易扩展到任意尺度数。例如，第三个滤波器组将在W,(J-2,n)
系数上操作，将尺度空间V,?分成两个八分之一带宽的子空间W,和V?s。通常，我们选择f(x)的2′
个样本，并用P个滤波器组(如图7.17所示)在尺度J-1,J-2,….J-P处生成一个P尺度FWT。首
先计算最高尺度(即J-1)的系数，最后计算最低尺度(即J-P)的系数。如果f(x)以高于奈奎斯特频
率的取样率取样，通常如此，其样本是该取样分辨率下的尺度系数的良好近似，并可以作为起始的
高分辨率尺度系数的输入。换句话说，在该取样尺度，不需要小波或细节系数。最高分辨率的尺度
函数作为式(7.3-5)和式(7.3-6)中的单位离散冲激函数，允许f(n)用做第一个二带宽滤波器组的尺度
(近似)输入(Odegard,Gopinath and Burrus[1992])。
例7.10 计算一维快速小波变换。
为解释前面的概念，考虑例7.8中的离散函数f(n)={1,4,-3,0}。如例7.8那样，我们将计算基于哈
尔尺度和小波函数的变换。然而，这里不再像例7.8 中的 DWT那样直接使用基函数，而是使用例7.5
和例7.6中的相应尺度和小波向量：
w-e?,其他 (7.4-13)
和
(7.4-14)
这些是用于建立FWT 滤波器组的函数；它们提供了滤波器系数。注意，因为哈尔尺度函数和小波函数是
归一化正交的，式(7.1-14)可用于类似表7.2中的h,(n)单个原型滤波器产 表72 h(n)的正交归一 生FWT滤波器系数，它对应于式(7.1-14)中的g。(n)。 化哈尔滤波器系数
因为例7.8中计算的DWT由元素(W,(0,0),W,(0,0),W,(1,0),W,(1.1)}
组成，我们将对尺度j={0.1}计算相应的二尺度FWT,即J=2(有2=22个
样本)且P=2(按尺度J-1=2-1=1和J-P=2-2=0的顺序进行)。变换
n h(n)
0 1/√2
使用图 7.18(a)中的二级滤波器组进行计算。图7.19显示了由所要求的FWT 1 1/√2
卷积和下取样操作得到的序列。注意，函数f(n)自身是最左侧滤波器组的尺度(近似)输入。例如，为计算出
现在图7.19中上支路末端的W,(1,k)系数，我们首先要做f(n)和h,(-n)的卷积。如3.4.2节所述，这要求关于
原点翻转其中的一个函数，并滑过另一个函数，逐点计算两个函数各对应点的乘积之和。对于序列(1,4,-3,0}
和[-1/√2,1/√21,产生的结果为
{-1√2,-31√2,71√2,-31√2,o}
其中，第二项对应于序号k=2n=0(在图7.19中，带下画线的值表示负序号，即n<0)。以偶序号点下取样
时，我们得到W,(1,k)={-3/√2,-3/√2],k={0,1]。作为一种选择，我们也可以使用式(7.4-12)来计算：
W,(,k)=h(-n)*W。(2,n)?,k≥0=h,(-n)*f(n)?,k?0
-Zhu-2x)x?方*2)-方*2k+1)
这里，我们用2k代替卷积中的 n,并采用1作为卷积的虚变量(即置换相关的两个序列)。展开的和中只
第7章 小波和多分辨率处理 315
有两项，因为反转的小波向量h(-n中只有两个非零值。替代k=0,我们得出W,0L.0)=-3/√2;对于k=1,
我们得到W,(a,D)=-31√2。这样，滤波并下取样后的序列为{-3/√2,-31√2),它与先前的结果一致。
剩下的卷积和下取样操作可按类似的方法执行。
{-1/√2,-3/√2,7//2,-3/√2,0}
★{-1/√2.1/√2} 21 ●W.(1.n)-(-3N2,-3N2
w(.2-3 w.(.n)={5/2,-3/√2 ★{-1/√2.1/√2} 21 W。(0.0)={4)
★{1/√2.1/√2} 21 (-2.5,4.-1.5}
(1//2.5/N2.1/√2,-3/√2,0} ★(1/N2,1/N2} 21 w,(0.0)=(1)
{25,1,-15}
图7.19 使用哈尔尺度和小波向量计算序列(1,4,-3.0}的一个二尺度快速小波变换
正如可能期望的那样，从正变换的结果重建f(n)的快速反变换也可以表达出来。这称为快速小波
反变换(FWT'),它使用正变换中采用的尺度和小波向量，以及第j级的近似和细节系数，来生成第j+1
级的近似系数。注意图7.17中FWT分析滤波器组和图7.6(a)中的2带宽子带分析部分之间的相似性，
我们可以立即得出所需的FWT1综合滤波器组。图7.20详细描述了它的结构，该结构与图7.6(a)中
的2带宽子带编码和解码系统的综合部分相同。7.1.2节中的式(7.1-14)定义了相关的综合滤波器。
如该节所解释的那样，完美重建(对于二子带正交滤波器)要求对于i={0,1}有g(n)=h(-n)。也就
是说，综合滤波器和分析滤波器彼此之间必须是顺
序相反的形式。因为FWT分析滤波器(见图7.17)是
h?(n)=h,(-n)和h?(n)=h,(-n),所以要求的FWT综
合滤波器为go(n)=h?(-n)=h,(n)和 g,(n)=h?(-n)=
W(jin) 21 ★h?(n)
+ W.(i+1,n)
h,(n)。然而，应记住，也可以使用双正交分析滤波
器和综合滤波器，但它们彼此之间形式上顺序不相
反。双正交分析滤波器和综合滤波器是根据式(7.1-10)
W,(i.n)
和式(7.1-11)交叉调制的。 图7.20 FWT'综合滤波器组
图7.20中的FWT'滤波器组执行下述计算：
W,(j+1,k)=h(k)*w2"(j,k)+h(k)*w2f(j,k)>0
21 *h,(n)
(7.4-15)
其中，w2代表基2的上取样[即在式(7.1-1)定义的W中插人0,使其长度变为原来的两倍]上
取样的系数与h,(n)和h,(n)进行卷积完成滤波，并相加产生较高尺度的近似。本质上，创建了f(n)的
较好近似，该近似含有较多的细节和较高的分辨率。与FWT 正变 记住，像在金字塔编码中一样(见
换类似，反变换滤波器组可以如图7.21所示的那样进行迭代。其中， 7.1.1节),小波变换可以按用户指定
为了计算 FWT'重建的最后两个尺度，描绘了一个二尺度结构。这 数量的尺度计算。例如，对于一幅
大小为2×2'的图像，有1+logJ个 种系数合并过程可以扩展到任意数量的尺度，并保证序列f(n)的完 可能的尺度。 美重建。 5-5
:5
316 数字图像处理(第三版)
w,U-1,n) ★h(n) 21
W-2,n)● ★h(n) + 21 ●W,(.n) W.J-1,n)
★h。(n) + 21
★h,(n) W,U-2,n) 21
图7.21 一个两级或二尺度FWT1综合滤波器组
例7.11 计算一维快速小波反变换。
快速小波反变换的计算与其正变换的计算对称。图7.22说明了例7.10中使用的序列的处理过程。为
开始计算，首先对第0级近似系数和细节系数进行上取样，以分别产生(1,0}和(4,0}。与滤波器g。(n)=h,(n)=
[1/√2,1/√2)和g:(n)=h(n)={1/√2,-1/√2]进行卷积得到[1/√2,1/√2,0]和(4/√2,-41√2,0},相
加得到W,(1,n)=(5/√2,-3/√2}。这样，就重建了图7.22中的第1级近似，第1级近似与图7.19中的
计算近似匹配。以这个方法继续，在第二个综合滤波器组的右端形成了f(n)。
(-3/2.0.-3//2.0} HS15-IS1S0 *{1/√2,-1/21 w.(1,n)={-3/√2.-3/√2| 21
{4.0}
★{1/√2,-1/√2) W.(0.0)={4) 21 +· W,(1.n)=(5/√2,-3/√21
*{1/√2.1/√21 + 21
{5/√2,0.-3/√2.0
{4/√2,-4/√2,0}
★{1/√2.1/√2} W.(0.0)={1 21 {1/√2.1/√2,0}
{1.0}
图7.22 使用哈尔尺度函数和小波函数计算序列{1,4.-1.5√2,-1.52√2}的二尺度快速小波反变换
我们用解释傅里叶基函数保证FFT的存在性来结束快速小波变换的讨论，FWT的存在性取决于
小波变换的尺度函数的可用性以及尺度函数和对应的小波的正交性(或双正交性)。这样，式(7.3-12)
中的墨西哥草帽小波的确没有相伴的尺度函数，所以不能用于FWT的计算。换句话说，不能为墨西
哥草帽小波建立一个如图7.17所示的滤波器组，因为它不满足FWT方法的基本假设。
最后，我们注意到，在表示函数时，时间和频率通常被看成是不同的域，但它们之间存在着不
可分割的关系。如果试图同时在时域和频域内对函数进行分析，就会遇到如下问题：如果想得到关于
时域的精确信息，就必须接受频域的某些模糊，反之亦然。这是海森伯(Heisenberg)测不准原理在信
息处理中的应用。为了用图示方式说明该原理，函数表示中用到的每个基函数都可粗略地视为时间-
频率平面中的一片。该片也称为海森伯单元或海森伯盒，它显示了其所表示的基函数的频率内容，以
及该基函数在时域中所处的位置。归一化正交的基函数由不重叠的片来表征。
图7.23分别显示了时间-频率片：(a)冲激函数(即传统的时域)基；(b)正弦函数(FFT)基；
第7章 小波和多分辨率处理 317
(c)FWT基。图7.23(a)到(c)的每一片都是一个方形区域；区域的高和宽定义了可用基函数表示的函
数的频率和时间特性。注意，图7.23(a)中的标准时域基指明了事件发生的时刻，但不提供频率信
息[图7.23(a)中每个矩形的宽度应被考虑为时间上的一个瞬间]。这样，为了用冲激基函数表示
一个单一频率的正弦波，就需要每一个基函数。另一方面，图7.23(b)中的正弦基指出了发生较长
时间的事件中出现的频率，但没有提供时间分辨率[图7.23(b)中每个矩形的高度应考虑为一个单
一频率)。这样，由无限数量的冲激基函数表示的单一频率的正弦波可以表示为包含一个正弦基
函数的展开形式。图7.23(c)中FWT片的时间和频率分辨率是变化的，但每个片的面积是相同的。
在低频处，片较短(即有较好的频率分辨率或较少的频率含糊),但较宽(对于较差的时间分辨率
或较大的时间含糊)。在高频部分，片宽较小(时间分辨率提高),并且片高较大(表示频率分辨率
下降)。这样，FWT基函数就在图7.23(a)和图7.23(b)这两种限制情况间提供了折中。FFT和FWT
之间的这种基本差别在本章的介绍中说明过，它在频率随时间变化而变化的非稳态函数的分析中
很重要。
a bc
频率
时间 时间 时间
图7.23 与(a)取样数据，(b)FFT和(c)FWT相关的基函数的时间-频
率片。注意，图(c)中等高度矩形的水平条带表示FWT的尺度
7.5 二维小波变换
前述一维变换可很容易地扩展到像图像这样的二维函数。在二维情况下，需要一个二维尺度函
数φ(x,y)和三个二维小波y"(x,y),y(x,y)和yP(x,y)。每个都是两个一维函数的乘积。排除产生一维结
果的乘积，如φ(x)y(x),4个剩下的乘积产生可分离的尺度函数
φ(x,y)=φ(x)φ(y) (7.5-1)
和可分离的“方向敏感”小波
y"(x,y)=ψ(x)p(y)
y(x,y)=φ(x)v(y)
y°(x,y)=y(x)v(y)
(7.5-2)
(7.5-3)
(7.5-4)
这些小波度量函数的变化——图像的灰度变化——沿不同方向的变化：度量沿列方向的变化(例如水平
边缘),w响应沿行方向的变化(例如垂直边缘),P度量对应对角线方向的变化。方向敏感是式(7.5-2)
到式(7.5-4)中可分离性的自然结果；它并不会增加本节讨论的二维变换的计算复杂性。
给定可分离的二维尺度函数和小波函数，一维DWT可直接扩展到二维。我们首先定义一个尺度
和平移基函数： 园空
因：受
318 数字图像处理(第三版)
甲j.m.(x,y)=2φ(2'x-m,2'y-n) (7.5-5)
.m.n(x,y)=221(2'x-m,2'y-n),i={H,V,D} (7.5-6)
其中，上标i指出式(7.5-2)到式(7.5-4)中的方向小波。与指数不同，i是假定值H,V和D的上标。于
是，大小为M×N的图像f(x,y)的离散小波变换是
W(mm=22u,ye(K) (7.5-7)
WG.mn)=22ra.y/。(x,y,i={B,v.D} (7.5-8)
如同一维情况，j。是一个任意的开始尺度，WGom,n)系数定义f(x,y)
在尺度J处的近似。W'(j,m,n)系数对尺度j≥j。附加了水平、垂直和
对角方向的细节。我们通常令j。=0,并且选择N=M=2',因此有j=0,1,
2,…,J-1和m=n=0,1,2,…,2-1。给出式(7.5-7)和式(7.5-8)中的W。
和W'.f(x,y)可通过离散小波反变换得到：
f(x,》=ZZW。(i.m,npm(x,+
赢2Z2ZW(.m,nw/(%)
既然我们正在处理二维图像，故
式(7.5-8)中的尺度和小波函数是在
f(x,y)是一个离散函数或值序列。
它们的支撑上取样的(就像在732节
而x和y是离散变量。式(7.5-7)和
的一维情形中那样)。
(7.5-9)
类似一维离散小波变换，二维DWT可以使用数字滤波器和下取样器来实现。利用可分离的二维
尺度函数和小波函数，我们可以先简单地取f(x,y)的行的一维FWT,然后，取结果列的一维FWT。
图7.24(a)以方框图的形式显示了这一过程。注意，类似图7.17的一维对应部分，二维FWT“滤波”尺
度j+1的近似系数来构建尺度j的近似和细节系数。然而，在二维情况下，我们得到3组细节系数—
水平、垂直和对角线细节系数。
图7.24(a)的单尺度滤波器组可通过“迭代”(将该近似输出连接到另一个滤波器组输入),以便
在尺度j=J-1,J-2,…,J-P中产生P尺度变换。正如在一维情况那样，图像f(x,y)被用做WUm,n)
的输入。它的行与h,(-n)和h,(-n)卷积，并对它的列下取样，我们得
到两个子图像，它们的水平分辨率以2为因子下降。高通或细节分量 w.w".W和W?按图724(b)
中的方式排列。计算出的每个尺度 描述了图像垂直方向的高频信息，低通或近似分量包含了它的低频垂 将替代它们之前基于的尺度近似 直信息。然后，沿列的方向对两幅子图像进行滤波并下取样，得到
四幅1/4大小的输出子图像——w.w",w和WD。显示于图7.24(b)中间的这些子图像是f(x,y)
与式(7.5-1)到式(7.5-4)中的二维尺度函数与小波函数的内积，紧接着在每个维度进行基2下取样。
滤波处理的两次迭代在图7.24(b)的最右侧产生二尺度分解。
图7.24(c)显示了刚刚描述过的反向处理的综合滤波器组。正如所期望的那样，重建算法类似于
一维情况。在每次迭代中，四尺度j的近似和细节子图像被上取样，并与两个一维滤波器卷积—
个在子图像的列上进行操作，另一个在行上进行操作。将结果相加得到尺度j+1的近似，重复该处
理直到重建原图像。
第7章 小波和多分辨率处理 319
★h(-m) 2 ●wm,n
★h(-n) 21 行(沿m)
列沿m) ★h(-m) 21 wi.m,n)
W.I+1m.n)◆ 行
★h(-m) 21 wij.m.m)
★h,(-n) 21 行
列
★h(-m) 21 W.0.m.n)
行
W,0+1.m,n)
w.um,n) W.(j.m,n)
WL.m)W(.m.)
wm.n) 21
行(沿m)
wuimn)
★h,(m)
21 ★h(m) 列(沿m
行
20 ★h()
W+1.m.n
w。u.m.n) 21
行
★h。(m)
+ 21
21 ★h,(m)
列
W,(.m,n)●
行
*h,(m
b
c
图7.24 二维快速小波变换：(a)分析滤波器组；(b)分解结果：(c)综合滤波器组
例7.12 计算二维快速小波变换。
图7.25(a)是由计算机产生的一幅128×128的图像，它由在黑背景上的二维类似正弦脉冲组成。该
例子的主要目的是说明计算图像的二维FWT 的机理。图7.25(b)到(d) 本例中使用的尺度和小波向量稍
后描述。此处，我们的重点在于变
换计算的机理，它与采用的滤波器
系数无关。
显示了图7.25(a)中图像的三个FWT。图7.24(a)的二维滤波器组及图7.26(a)
和(b)中显示的分解滤波器用于产生所有的三个结果。
图7.25(b)显示了图7.25(a)中的图像的一尺度FWT。为了计算该变
换，原图像作为图7.42(a)的滤波器组的输入。然后，4个1/4大小的分解输出(即近似、水平、垂直和对
角线)按照图7.24(b)的排列产生图7.25(b)中的图像。类似的过程可用来产生图7.25(c)中的二尺度FWT,
但滤波器组的输人变为图7.25(b)左上角所示1/4大小的近似子图像。正如我们在图7.25(c)中看到的那样， n-5
320 数字图像处理(第三版)
1/4大小的子图像然后由4个1/4大小(现在是原图像的1/16)的分解结果代替，它们由第二次滤波产生。
最后，当图7.25(c)左上角的子图像作为滤波器组的输入时，图7.25(d)是得到的三尺度的FWT。每次通过
滤波器组，便会产生4个1/4大小的输出图像，以代替产生它的输入。注意，基于小波的子图像W",w
和WD在每个尺度处的方向特性。
a bc d
图7.25 计算二维三尺度FWT:(a)原图像；(b)一尺度FWT:(c)二尺度FWT:(d)三尺度FWT
受：团
h)-h(-m
12 h?(n)-h(-n)
0.5
=m
08 08 o
6
6 0.6
0.4 0.4
02 0.5 0.2
0
-02 0 4 6 8
-1 -02
0 2 4
8
xi()-h ()
0.5 2 14
15 12
o
1F
05 8
6
o
05 04 -0.5 02
-i
0 4 8
-15 -02 4 0234S6 7
(x)y(v)
1.5
日
05
0.5
8 6
4
8
2 2
4
图7.26 四阶对称小波：(a)~(b)分解滤波器；(c)-(d)重建滤波器；(e)一维小波；(f)一维
尺度函数；(g)三个二维小波之一，w(x,y)。h,(n),O≤n≤7的值见表7.3
前面例子中使用的分解滤波器是众所周知的称为对称小波的小波族的一部分。symlet是对称小波
的英文简称。虽然它们不完全对称，但在给定的紧支撑下(Daubechies[1992])被设计为有最小不对称
第7章 小波和多分辨率处理 321
性和最高消失矩数。图7.26(e)和图7.26(f)显示了4阶一维对称小波
(即小波和尺度函数)。图7.26(a)到图7.26(d)显示了相应的分解和重建
滤波器。低通重建滤波器go(n)= h,(n)的系数在0≤n≤7的情况下由
表7.3给出。其余归一化正交滤波器的系数可用式(7.1-14)得到。作为小波y(x,y)的低分辨率图解，
回忆可知，一个函数的紧支撑是
指一个区间。该函数在这个区间内
有非零值
图7.26(g)说明了一维尺度和小波函数是如何结合在一起 表7.3 h,(n)的正交归一化四阶对称小波 来形成一个可分离的二维小波的。 滤波器系数(Daubechies[1992]) 我们用两个演示小波在图像处理中的作用的例子来
结束本节。正如在傅里叶域那样，基本方法是： n h(m
0 0.0322
步骤1 计算一幅图像的二维小波变换。
步骤2 修改变换。
步骤3 计算反变换。
1 0.0126
2 0.0992
3 0.2979
4 0.8037
5 0.4976
因为 DWT 的尺度和小波向量被用做低通和高通滤
波器，所以大多数基于傅里叶的滤波技术与“小波域”
部分是等价的。
6 -0.0296
7 -0.0758
例7.13 基于小波的边缘检测。
图7.27提供了前面的三个步骤的简单说明。在图7.27(a)中，示于图7.25(c)的离散小波变换的最低尺
度近似分量已由将其值置零而消除了。如图7.27(b)所示，使用这些改进的系数计算小波反变换时，最终效
果是边缘增强，回忆一下在4.9节讨论的基于傅里叶的图像锐化结果。注意，尽管它们是相对软的正弦过渡，
但信号和背景间的过渡多少还是被很好地描述了。通过将水平细节置零——参见图7.27(c)和图 7.27(d),
我们可以孤立出垂直边缘。
a bc d
图7.27 针对边缘检测改进的DWT:(a)~(c)删除所选系数的二尺度分解：(b)~(d)相应的重建
例7.14 基于小波的噪声去除。
作为第二个例子，考虑示于图7.28(a)中的人的头部CT 图像。正如在背景中所看到的那样，图像已
被加性白噪声均匀地污染了。通常，基于小波来对图像去噪(即消除噪声部分)的过程如下：
步骤1 为了分解，选择一个小波(如哈尔小波、对称小波等)和级别数(尺度)P。然后，计算噪声图像
的FWT。
步骤2 对细节系数进行阈值处理，即从尺度J-1到J-P,选择和应用一个阈值处理细节系数。这
可以通过硬阈值来实现，其意思是将绝对值低于阈值的元素置零；或通过软阈值处理实现，即首先
将其绝对值比阈值低的元素置零，然后将非零系数标定到接近零。软阈值处理消除了硬阀值处理中(在
阀值处)固有的不连续性(见第10章关于阈值处理的讨论)。
①小波w(w)的第k阶矩是m(k)=jkyuxdx。0阶矩影响尺度函数和小波函数的平滑性以及我们将它们表示为多项式的能力。一个
N阶对称小波有N个消失矩 因～圆
召
322 数字图像处理(第三版)
步骤3 在J-P级处使用原始近似系数，并对级J-1到J-P的改进细节系数计算小波反变换(即执
行小波重建)。
aei
图7.28 为噪声去除修改DWT:(a)人的头部的噪声CT图像；(b),(c)和(e)对细节系数进行阈值处理后的
各种重建；(d)和(①在(c)和(e)重建过程中所删除的信息(原图像由Vanderbilt 大学医学中心提供)
图7.28(b)显示了使用第四阶对称小波、二尺度(P=2)及一个交互确定的全局阈值来执行这些操作的
结果。注意，噪声的减少和相应图像边缘的模糊。这种边缘细节的损失在图7.28(c)中大大减少了，它是
由最高分辨率细节系数(不是低分辨率细节的阈值处理)简单置零并重建图像产生的。这里，几乎所有的
背景噪声都被去掉了，而边缘只是稍微有点干扰。图7.28(d)中的差值图
像显示了处理中丢失的信息。这个结果是计算两尺度变换所有系数，但
高分辨率细节系数为零的反 FWT 产生的。正如所看到的那样，结果图
像中包含了原图像中的大多数噪声和某些边缘信息。图7.28(e)和图7.28(f)
显示了删除所有细节系数的负面影响。也就是说，图7.28(e)是在两尺度变换的两个级别的细节被置零时
的DWT重建；图7.28(①显示了丢失的信息。注意，在图7.28(0中的边缘信息明显增加了，而图7.28(e)
中的边缘细节相应减少了。
7.6 小波包
快速小波变换将一个函数分解为其宽度呈对数关系的尺度函数和小波函数的和，即(函数的)低
频内容使用较窄带宽的(尺度和小波)函数来表示，而高频内容使用较宽带宽的函数来表示。如果沿
图7.23(c)中的时间-频率平面的频率轴来看，这非常明显。每一个恒定高度片的水平条带包含单一FWT
尺度的基函数，当您向上移动频率轴时，在高度上呈对数增加。如果我们想要更大地控制时间-频率
平面的分开度(即在较高频率处频带较小),则必须对FWT加以推广，以便得到一个更为灵活的分解，
这种分解称为小波包(Coifman and Wickerhauser[1992])。这个推广的代价是计算复杂性从FWT的O(M)
增大到小波包的O(Mog.M)。
再次考虑图7.18(a)中的二尺度滤波器组，但此时把分解想象为一个二叉树。图7.29(a)详细叙述
在生成图 7.28(d)时。由于仅保留
了最高分辨率细节系数，故该反变换
是它们对图像的页献。同样，图7.28(0
是所有细节系数的贡献。
第7章 小波和多分辨率处理 323
了树的结构，并适当地将FWT尺度和小波系数[从图7.18(a)]连接到它的节点。根节点被赋予了最
高尺度的近似系数，它是函数本身的样本，叶子节点继承了该变换的近似和细节系数输出。单独的中
间节点W.(J-1,n)是滤波器组近似，该近似最终被滤波而变成两个叶子节点。注意，每个节点的系数
都是线性展开的加权，它产生根节点f(n)的一个带限的“片”。因为任何这样的“片”都是一个已
知尺度或小波子空间的元素(见7.2.2节和7.2.3节),所以，我们可以用相应的子空间来替代图7.29(a)中
的生成系数。结果是图7.29(b)中的子空间分析树。虽然变量W用于表示系数和子空间，但两个量按
它们的下标格式是可区分的。
a b w.U.n)=f)
wU-n) W.u-1.m) V W
w./-2,n)wu-2.n) V- W
图7.29 图7.18中二尺度FWT分析组的(a)系数树和(b)分析树
图7.30中进一步说明了这些概念，其中，描绘了一个三尺度FWT分析组、分析树和相应的频谱。
与图7.18(a)不同，图7.30(a)中的方框图标明了类似于图7.30(b)所示的分析树和图7.30(c)所示的频谱。
这样，尽管左上滤波器和子取样器的输出是W,J-1,n),为准确起见标为W——即由WJ-1,n)变换
系数产生的函数子空间。这个子空间对应于相关分析树中的右上边的叶子，以及相应频谱的最右(最
宽带宽)段。
★h(-n) 21 ●W ba。
f(x)EV1 ★h(-n) 21 W;
★h,(-n 21 V? ★h(-n) 21 W
★九(-n) 21 V-:
★九(-n) 21 ●V
V I(a)
V,
V W
V
:
V Wi-2 vw,4 w; W;-1
V W, 0t/8 π/4 π/2 π
图7.30 三尺度FWT滤波器组：(a)方框图：(b)分解空间树：(c)频谱分离特性
分析树提供了表示多尺度小波变换的一种紧凑和有益的方法。与基于滤波器和子取样器的相应
方框图相比，分析树画起来很简单，且占用的空间较少，使它相对容易检测有效的分解。例如，图7.30(b)
的三尺度分析树使得如下三种展开选项成为可能： :5
:圈
324 数字图像处理(第三版)
V,=V,田W,-
v,=V,_2田W?-2田W,-
V,=V,_田W,3田W,_2田W,
(7.6-1)
(7.6-2)
(7.6-3)
它们对应于7.4节的一尺度、二尺度和三尺度FWT分解，并且可以由7.2.3节的式(7.2-27)对P=(1,2,3}
令=J-P来得到。通常，P尺度FWT分析树支持唯一的P种分解。
分析树还是表示小波包的一种有效机制，小波包只不过是细节为交互滤波的传统小波变换。这
样，图7.30(b)中的三尺度FWT分析树就变成了图7.31中的三尺度小波包树。注意，引入了附加的
下标。双下标节点的第一个下标可看成是传承FWT父节点的尺度，第二个下标——A和D的变长
字符串——从父节点到该节点的路径的编码。A表示近似滤波，而D表示细节滤波。例如，子空间
Wm是通过一个附加的细节滤波器对尺度J-1的FWT系数(如图7.31中的父节点W)“滤波”(得
到WHD),而后紧跟着用一个近似滤波器进行滤波(给出 Wi.D)得到的。图7.32(a)和图7.32(b)是
图7.31中分析树的滤波器组和频谱分离特性。注意，图7.32(a)中的滤波器组的“自然顺序”输出，
已根据图7.32(b)中的频率内容被重新排序了(对于“频率排序”小波的更多内容，见习题7.25)。
V,
V-1 W,!
W, w, W,t.D
V? W,_W;-24 W-20 W,-L,AA w-1.AD Wi-1.DA W-t.bn
图7.31 一个三尺度小波包分析树
图7.31中的三尺度小波包树的分解数量(及相关的时间-频率片)几乎是三尺度FW树的三倍。回
顾一下，在标准的FWT中，我们单独对低通波段进行分离、滤波和下取样。这将在用于函数表示的
尺度和小波空间的波段宽度之间形成一个固定的对数(以2为底)关系[见图7.30(e)]。因此，在图7.30(a)
中的三尺度FWT 分析树提供三种可能的分解时——由式(7.6-1)到式(7.6-3)定义——图7.31 中的小
波包树支持26种不同的分解。例如，V,[和函数f(n)]可被展开为
V,=V?_田W,_田W,-2,A田W,-2,D田W,-.u田W,-IAD田W,-1.D田W,-.DD
回忆可知，田表示空间的并集(就
式(765)定义了两个这样的分解。
像集合的并集一样)。与图731相关的
26种分解是由[可被组合到一起来表
示树顶部的根节点(空间)的]节点(空
间)的不同组合产生的。式(764)和
(7.6-4)
它们的频谱如图7.32(b)所示；或者
v,=V,田W,-.A田W,.D田W,1.DD (7.6-5)
它们的频谱在图7.33中进行了描述。注意，这个最后的谱和图7.32(b)中的完全小波包谱或图7.30(c)
中的三尺度FWT谱之间的区别。一般来说，P尺度一维小波包变换(与P+1层分析树相关)支持
D(P+1)=[D(P)}+1 (7.6-6)
个唯一的分解，其中 D(1)=1。随着这样大量的有效展开，基于包的变换就提供了改进被分解函数的
谱的分割控制。这种控制的代价就是计算复杂性的增加[将图7.30(a)中的滤波器组与图7.32(a)进行
比较]。
第7章 小波和多分辨率处理 325
21
★h,(-n) 21 W,m a
b
★h(-m) W,
★h(-n) 21 W Hz. ★h(-n) w
*九(-n) 21
★h。(-n) 21 W,n
W?-LA
★h(-) 21 W,
/(x)=V,
★h(-n) 21 ★h(-n) 21 W
W,
★/(一n)2.
★h(-n) 21 W, V?-1
*h,(-n) 21
★h(-n) 2. W,
V?-2
★/(-n) 21 V
M(m)
V,
V W
V, W; -W,-1,DW,,A
w w. wW,v. w,w wo
0π/8 π/4 π/2 π
图7.32 三尺度完全小波包分析树的(a)滤波器组和(b)频谱分离特性
H(m)
V?1 w,LDw-L.Dn W?-1.A
0 π/2 5π/8 3π/4 π
图7.33 式(7.6-5)中分解的频谱
现在考虑图7.24(a)中的二维、四子带滤波器组。正如7.5节中解释的那样，它将近似W,(j+1,m.n)
分解成输出W(j.m,n),W"(j.m,n). W(j.m,n)和W(j.m,n)。如在一维情况那样，在W,U.m,n)=
f(m,n)的情况下，这个过程可以对尺度j=J-1,J-2,…,J-P反复迭代而生成P尺度变换。第一次迭代
[即用图7.24(a)中的j+1=J]得到的频谱示于图7.34(a)。注意，它将频率平面分成了4个相等的
区域。位于平面中心的低频1/4频带与变换系数W(J-1,m,n)及尺度空间V,一致(这种命名法与一维情
况下一致)。然而，为适应输入的二维特性，我们现在有3个(而不是1个)小波子空间。它们分别表示
为W",w?WP,并对应于系数W"J-1,m,n),W°U-1,m,n)和WDJ-1,m,n)。图7.34(b)显
示了得到的四子带、单尺度的四分叉的FWT分析树。注意上标，它们将小波子空间标志及其对应的
变换系数联系在一起。 固：函
536
537
326 数字图像处理(第三版)
a b π直
1
w," w, w,"
w" V w," π 水平
V; w" w, w"
一
Vw,",w,,w/",
图7.34 一个二维FWT的第一次分解：(a)频谱：(b)子空间分析树
图7.35显示了一个三尺度、二维小波包分析树的一部分。正如图7.31中它对应的一维部分那样，
传统FWT细节节点的下一代的每个节点的第一个下标都是其父细节节点的尺度。第二个下标(一个A.
H,V和D的变长字符串)对从父节点到当前节点的路径进行编码。例如，标记为W/"vo的节点是通
过首先用一个附加的细节/近似滤波器对尺度J-1的FWT水平细节系数(即图7.35中的父节点W")
进行“行/列滤波”(生成W"w),然后用一个细节/细节滤波器对它再次进行滤波(得到W"wo)得
到的。一个P尺度的二维小波包树支持
D(P+1)=[D(P)]+1 (7.6-7)
唯一的展开，其中D(1)=1。因此，图7.35中的三尺度树提供了83522种可能的分解。在它们中间进
行选择的问题是下一个例子的主题。。
V,
V? w," w, w"
V, w" w"
v,,w",w:、W"w"Aw/"w,"w,"2。w/"Aw/"Lww"w w,"
图735 一个三尺度、完全小波包分解树。只给出了树的一部分
例7.15 二维小波包分解。
如上述讨论中解释的那样，单一小波包树存在多种分解选择。实际上，可能的分解数目通常很大，
以至于无法将每一种分解都逐一列举出来或检验它们。因此非常需要一种有效的算法来寻找适用于特定
应用准则的最佳分解。正如将要看到的那样，经典的熵和以熵为基础的代价函数在许多场合下是适用的，
并且很适合应用于二叉树和四叉树搜索算法。 图7.35中的64个叶节点对应于
考虑图7.36(a)中减少描述400×400指纹图像的数据量的问题。图
像压缩将在第8章详细讨论。在这个例子中，我们打算选择“最好的” 尽管外观上相像，但它们不是方形。
失真是由用于产生该结果的程序引起 三尺度小波包分解作为压缩处理的起点。利用三尺度小波包树，有83522 的(在近似子图像中尤其明显)。 [见式(7.6-7)]种潜在的分解。图7.36(b)显示了其中的一种，即一种全
小波包、64个叶子的分解，类似于图7.35中的分析树。注意，树的叶子对应于图7.36(b)中被分解子图像
图736(b)中64幅子图像的8×8阵列。
第7章 小波和多分辨率处理 327
的8×8阵列的子带。然而，以压缩为目的使这种特定的64个叶子的分解达到某种程度优化的可能性相对
较低。在缺乏一种合适的最佳准则时，我们既不能确认也不能否认这种分解是否最佳。
a b
图7.36(a)一幅扫描的指纹图像；(b)该图像的三尺度、全小波包分解(原图像由美国国家标准与技术协会提供)
对图7.36(a)图像的压缩选择一种分解的较为合理的准则是附加的代价函数
Ef)=Zlf(m,n (7.6-8)
该函数为二维函数f的能量内容提供了可能的度量。在该度量下，对于所有的m和n,函数f(m,n)=0的
能量为零。另一方面，E的高值表明函数具有很多非零值。由于大多数
其他可能的能量度量包括f(x,y) 基于变换的压缩方案都是通过舍入或设置阈值将很小的系数变成零值来 的平方和、平方的对数和，等等。
工作的，因此，从压缩的观点来看，将接近零值的数目最大化的代价函 习题7.27定义了一个可能的基于熵
的代价函数。 数对于最好的分解应该是合理的准则。
刚才提到的代价函数不仅具有计算上的简单性，而且易于适应树的优化程序。最优化算法必须使用
这个函数来最小化分解树中叶结点的“代价”。最小能量叶节点应该是最受欢迎的，因为这些节点具有更
多的接近零的数值，从而导致更大的压缩。因为式(7.6-8)的代价函数只是一个局部度量，它只用在考虑
节点的有效信息上，所以很容易构造一个用于得到最小能量的有效算法。
对于分析树的每个节点，要从根节点开始逐层进行，直到到达叶子节点：
步骤 1 计算节点的能量。用E,(作为父节点的能量)表示，并且，此节点的4个子节点的能量分别
表示为EA、EH、EV和ED。对于二维小波包分解，父节点是近似系数或细节系数的一个二维阵列；
子节点分别是滤波后的近似、水平、垂直和对角线细节。
步骤2 如果子节点的联合能量小于父节点的能量，即E+En+Ev+Ep<E,则在分析树中包含这
些子节点。如果各子节点的联合能量大于或等于父节点的能量，则修剪掉这些子节点而只保留父节
点。它就是优化分析树的叶子节点。
前述算法可以用于：(1)对小波包树进行修剪，或(2)从零开始设计用于计算最优树的过程。在后一
种情况下，不必要的兄弟节点——那些在算法的第二步中将去掉的节点后代——就不用计算了。图7.37
显示了优化后的分解，该分解是使用式(7.6-8)的代价函数对图7.36(a)中的图像应用此算法得到的。图7.38
中给出了对应的分析树。注意，图7.36(b)中多个原始的全小波包分解的64个子带(和图7.35中对应分析
树的64个叶子)已被去除。另外，图7.37中没有被分离(或进一步分解)的子图像相对比较平滑，并且由
那些具有中间灰度值的像素构成。除了近似子图像，该图中的所有子图像已被标定，所以灰度级128指示
零值系数，因此这些子图像几乎不包含能量。对这些子图的分离应该不会使图像的能量在总体上减少。
328 数字图像处理(第三版)
图7.37 图7.36(a)中指纹的一种最佳小波包分解
V w"
: w w" wwWW
vW"w!,ww"w"w"zw"wWw;w)w°w"w\wwWW
苦:
w"w,"W" w"
w/"w"aW"a“ W“w"m/"w/"
图7.38 对图7.37中分解的最佳小波包分析树
前述例子是以实际问题为基础的，它可以通过使用小波得到解决。近年来，美国联邦调查局(FBI)
拥有一个巨大的指纹数据库，并为指指纹图像的数字化与压缩制定了一个基于小波的国家标准
(FBI[1993])。由于使用了双正交小波，这个标准达到了典型的15:1的压缩率。小波压缩方法相对于
传统的JPEG压缩方法的优点会在下面的章节中得到检验。
例7.15中使用的分解滤波器和FBI使用的都是周知的称为Cohen Daubechies Feauveau双正交小波
(Cohen, Daubechies and Feauveau[1992])的小波家族的组成部分。因为该小波族的尺度函数和小波函数
是对称的，并且具有相近的长度，所以它们是使用最广泛的双正交小波。图7.39(e)到(h)显示了双尺度
函数和小波函数。图7.39(a)到(d)是对应的分解滤波器和重建滤波器。当0≤n≤17时，低通和高通分
解滤波器h,(n)和h,(n)的系数如表7.4所示。相应的双正交综合滤波器的系数可使用式(7.1-11)中的go(n)=
(-1)+'h?(n)和g?(n)=(-1)"h,(n)来计算。也就是说，它们是分解滤波器的交叉调制形式。注意，为使得这
些滤波器；就FWT而论，有h,(-n)=h,(n)和h,(-n)=h(n)。
些滤波器长度相同，使用了零填充，并且表7.4和图7.39根据图7.6(a)中的子带编码和解码系统定义了这
第7章 小波和多分辨率处理 329
表7.4 双正交Cohen Daubechies Feauveau滤波器系数(Cohen,Daubechies and Feauveau[1992])
n h(n) h(n) n h,(n)
0
0.0019
-0.0019
-0.017
0.0119
0.0497
-0.0773
-0.0941
0.4208
0
0
0
0.0144
-0.0145
-0.0787
0.0404
0.4178
-0.7589
9
10
11
12
13
14
15
16
17
0.8259
0.4208
-0.0941
-0.0773
0.0497
0.0119
-0.017
-0.0019
0.0010
h?(n)
0 0.4178
1 0.0404
2 -0.0787
3 -0.0145
4 0.0144
5 0
6 0
7 0
8 0
h?(n) 1.2 h?(n) 0.6
9
O000 0
0.4 P P
e
6
a b c d e f
0.8 0.2 g h
0.6 0F
0.4 -0.2
0.2 -0.4
0 -0.6
-0.2 0 4 8 12 16 n -0.8 0 4 8 12 16 n
so(n)
0.8
R?(n)
0.5
0.6
9
6
①0eo0O
0- 0.4F
0.2 -0.5
0F
-0.2 0 4 8 12 -1 16
9
6 oo 000
0 4 8 12 n 16
(x)
1.4 (x) 1.5 1.2
1 1
0.8
0.6 0.5
0.4 0.2 0
0- -0.5 -0.2
-0.4024
x 6 8 10 12 14 16 18 -10 2 468 1012 14 1618*
小(x)
1.2 中(x) 1.5
1
1
0.8
0.6 0.5
0.4 0F
0.2
0- -0.5
-02。2468101214 1618x I6 6 810 12 14 16 18 24
图7.39 Cohen Daubechies Feauveau双正交小波族的成员：(a)和(b)分解滤波器系数；(c)和(d)重
建滤波器系数；(e)~(h)双小波和尺度函数。0≤n≤17时，h(n)和h(n)的值见表7.3 害芒
齿:
330 数字图像处理(第三版)
小结
本章的内容为理解和进一步掌握图像处理中小波和多分辨率分析所起的作用奠定了牢固的数学
基础。小波和小波变换是在大量图像处理课题中快速崛起的、相对较新的图像工具。由于它们与傅里
叶变换具有相似性，所以第4章中的许多技术同样具有对应的小波域部分。成像应用中能以小波的观
点来解决的的问题包括图像匹配、配准、分割、降噪、复原、增强、压缩、形态滤波和计算机断层等。
由于不可能在一章中覆盖所有这些应用领域，所以根据它们的价值，只选择了其中的部分主题进行介
绍或阐明基本概念，同时为读者在该领域中进一步研究做好准备。第8章将使用小波进行图像压缩。
参考文献
关于小波及其应用有很多好的课本。其中一些可以作为我们论述的补充，并且在阐述本章的核心部分
时也依靠这些课本。7.1.2节中关于子带编码和数字滤波的材料是以Vetteri和Kovacevic[1995]的书为依据
的，而7.2节和7.4节中关于多分辨率展开和快速小波变换遵循了Burrus, Gopinath 和Guo[1998]中这些主
题的论述。本章中的其他内容是以课本中引用的参考资料为基础的。本章中的所有例子均是使用MATLAB
来完成的(见Gonzalez et al.[2004])。
小波分析的历史记录在Hubbard[1998]的书中。小波的前身同时在不同领域中得到发展并在Mallat[1987]
的文章中得到了统一。这篇文章为此领域建立了一个数学框架。从Meyer[1987][1990][1992a,1992b][1993],
Malla[1987][1989a~c][1998]和 Daubechies[1988][1990][1992][1993][1996]的工作中可以追溯小波的发展史。
众多关于小波的出版物激发了人们当前对小波的研究兴趣。Daubechies[1992]所写的书是一部关于小波理论
数学细节方面的经典原始资料。
在一般的图像处理课本中都会提及小波在图像处理中的应用。如Castleman[1996]以及许多特定应用领域
的书籍，其中还有一些参考学报。例如，在后者中有Rosenfeld[1984],Prasad和Iyengar[1997],还有Topiwala[1998]
的著述。最近的一些文章可以作为在一些特定图像应用方面进一步研究的起点读物，包括 Gao 等人[2007]关
于角点检测方面的研究；Olkkonen和Olkkonen[2007]关于网格实现方面的研究；Selesnick 等人[2005]和Kokare
等人[2005]关于复杂小波方面的研究；Thévenaz和Unser[2000]关于图像配准的文章；Chang和Kuo[1993]及
Unser[1995]基于纹理分类的文章；Heijmans 和Goutsias[2000]关于形态学小波的文章；Banham 等人[1994]与
Wang.Zhang和Pan[1995]以及Banham和Kastaggelos[1996]关于图像复原的文章；Xu等人[1994]与Chang.Yu
和Vetteri[2000]关于图像增强的文章；Delaney和Bresler[1995]及Westenberg和Roerdink[2000]关于计算机断
层摄影术的文章；Lee,Sun和Chen[1995],Liang和Kuo[1999],Wang,Lee和Toraichi[1999]及You和Bhattacharya
[2000]关于图像描述和匹配的文章。小波的最重要应用之一是图像压缩，例如，可见Brechet等人[2007],Demin
Wang等人[2006],Antonini 等人[1992],Wei等人[1998]以及Topiwala[1998]的著述。最后，已经有不少关于小
波的专门刊物，包括IEEE信息论学报[1992](EEE Transactions of hformation Theory [19921)中关于小波变换和
多分辨率信号分析的特刊，IEEE信号处理学报[1993](IEEE Transactions on Signal Processing[1993])关于小波
和信号处理的特刊，以及 IEEE 模式分析和机器智能学报[1989](EEE Transactions on Pattem Analysis and
Machine Intelligence[1989])中关于多分辨率表示的特刊。
尽管本章的焦点是小波的基本原理及其在图像处理中的应用，但小波本身的构建还是很有意义的。有兴
趣的读者可以参考 Batle[1987][1988],Daubechies[1988][1992], Cohen和Daubechies{[1992],Meyerf1990],Mallat
[1989b],Unser,Aldroubi和Eden[1993]和Grochenig和Madych[1992]的著述。这并不是无遗漏的列出的全部文献，
但这些可作为读者进一步阅读的起点。读者也可以参阅一些关于子带编码和滤波器组的一般参考资料，包括
Strang和Nguyen[1996],Vetteri和Kovacevic[1995],以及本章中使用小波作为例子时给出的参考资料。
第7章 小波和多分辨率处理 331
习题
7.1 设计一个系统，对使用图7.2(b)中的编码器生成的预测残差金字塔进行解码，并画出框图。假设
编码器不会引入量化误差。
★7.2 为如下图像构建一个全填充的近似金字塔和相应的预测残差金字塔：
对图7.2(b)中的近似滤波器使用2×2的块进行邻域平均，并假设内插滤波器实现了像素复制。
★7.3 给定一幅2'×2'的图像，那么一个J+1级金字塔是减少还是扩展了表示该图像所需的数据量?压
缩率或扩展率是多少?
7.4 包含滤波器h,(n)={-1/√2,1/√2}·h(n)={-1/√2,1/√2},8。(n)={1/√2.-1/√2}和g?(n)=
{1/√2,-1/√2}的二子带子带编码滤波器组是归一化正交的、双正交的?还是两者都是?
7.5 给定一个序列f(n)=(0.1,0.25.0.5.1}.其中n=0.1,2,3,计算：
(a)符号反转后的序列。
(b)顺序反转后的序列。
(c)调制后的序列。
(d)调制后并顺序反转后的序列。
(e)顺序反转后并调制后的序列。
f)由(d)或(e)得到的结果与式(7.1-9)一致吗?
7.6 计算例7.2中的Daubechies综合滤波器g。(n)和g?(n)的系数。仅令m=0.使用式(7.1-13)证明这些
滤波器是归一化正交的。m=1时，这些滤波器也正交吗?
★7.7 画一个二维四子带滤波器组解码器来重构图7.7中的输入fm,n)。
7.8 给出N=8时的哈尔变换矩阵。
7.9 (a)计算2×2图像的哈尔变换：
r-[;3]
(b)哈尔反变换是F=H'TH,其中T是F的哈尔变换，H是H的逆矩阵。证明H?1=H,并用
它计算(a)中结果的哈尔反变换。
7.10 对如下基计算二元组[1.3,]'的展开系数，并写出对应的展开：
★(a)在R2上，实数二元组集合的基φ。=[1/√2,1/√2]和p=[1/√2,-1/√2]。
(b)在R2上，基φ=[1,0]2和q=[1.,及其对偶p。=[1.-1]和中=[0.1]。
(e)在R上，基=L.0],φ=[-1/2.√3/2]'和φ?=[-1/2,-√3/2],及它们的对偶p,=2p,/3,
i={0.1,2]。
(提示：必须使用向量内积来代替7.2.1节中的内积。) 医：国
去生
332 数字图像处理(第三版)
7.11 证明尺度函数
w-6S其他75
不满足多分辨率分析的第二个要求。
7.12 写一个尺度空间V?的表达式作为尺度函数p(x)的一个函数。用式(7.2-14)中定义的哈尔尺度函数，
在平移k={0,1,2,3}处画出哈尔V?尺度函数。
★7.13 对于哈尔小波函数画出小波y??(x)。写出一个关于哈尔尺度函数的w??(x)的表达式。
7.14 假设函数f(x)是哈尔尺度空间V?的一个成员，即f(x)∈ V?。使用式(7.2-22)将V?表示为尺度空间V。
和任何需要的小波空间的一个函数。如果f(x)在区间[0,1]外为0,请基于您的表达式，画出函数f(x)
的线性展开所要求的尺度函数和小波函数。
7.15 令起始尺度j。=2,计算例7.7中使用的函数的小波级数展开的前四项。将得到的展开写为所涉及尺
度函数和小波函数的形式。起始尺度为方=0时，得出的结果与例7.7的结果相比有何不同?
7.16 式(7.3-5)和式(7.3-6)中的DWT是起始尺度；的一个函数。
(a)令=1(而不是0),重新计算例7.8中函数f(n)={1,3,0.4)在区间0≤n≤3内的一维DWT。
(b)使用(a)的结果，根据变换值计算f(2)。
★7.17 下列以一维函数为基础的连续小波变换揭示了什么?
时间
比例尺
7.18 (a)习题7.17的连续小波变换是由计算机生成的。以它为基础的函数首先在离散区间中取样。连续
变换是什么?或者说它与函数的离散小波变换有什么区别?
★(b)在什么条件下选择DWT比选择CWT更好?当CWT比DWT好时，能比DWT好几倍吗?
★7.19 画出计算习题7.16中的变换所需的FWT滤波器组。使用适当的序列标记所有的输入和输出。
7.20 一个M点快速小波变换的计算复杂度为O(M),即操作的次数与M成比例。决定比例常数的因素
是什么?
7.21★(a)如果输入到图7.30(a)中的三尺度FWT滤波器组的是哈尔尺度函数p(n)=1,n=0.1,…,7,n
取其他值时p(n)=0。就哈尔变换而论，变换结果是什么?
(b)如果输入是对应的哈尔小波函数y(n)={1,1,1,1,-1,-1,-1,-1),n=0,1,…,7,变换是什么?
(c)什么输人序列会产生变换[0,0.,0,B,0,0.0.0].并具有非零系数W,(1.D)=B?
★7.22 二维快速小波变换类似于7.2.1节中的金字塔编码方案。它们有哪些相似性?给定图7.10(a)中的三
尺度小波变换，如何构造对应的近似金字塔?该金字塔有多少级?
7.23 计算习题7.9中2×2图像的哈尔小波的二维小波变换。画出所需的滤波器组，并使用适当的阵列标
记所有的输入和输出。
★7.24 在傅里叶域中，
f(x-xo,y-yo)F(μ,v)e-2gM+N
及平移并不影响|F(μ,|的显示。使用下面的图像序列，解释小波变换的平移特性。最左边的图
第7章 小波和多分辨率处理 333
像在大小为64×64的灰色背景的中心位置，包含两幅大小为16×16的白色方块。(从左数起的)第
二幅图像是第一幅图像关于哈尔小波的单尺度小波变换。第三幅图像是原图像中的方块向右下方
平移16个像素后的原始图像的小波变换结果。最后一幅图像(最右边的图像)是原图像向右下方移
动了1个像素后的小波变换结果。
7.25 如下图表显示了一个四尺度快速小波变换的哈尔小波函数和尺度函数。大略画出完全三尺度包分
解所需要的附加基函数。给出数学表达式或确定这些函数的表达式，然后根据频率内容排列基函
数并解释该结果。
v
wa_
WA_
V w W?n_
W:
W?A_ W2AD
W:
V w? W2n W?op
7.26 图7.1中花瓶的小波包分解显示如下：
(a)画出对应的分解分析树，使用适当的尺度和小波空
间名称标记所有节点。
(b)画出并标记分解的频谱。
7.27 使用哈尔小波，确定函数f(n)=0.5,n=0.1,2,…,15的
最小熵包分解。使用非归一化的山农熵
E[f(m]=∑f2(m)n[f2(m]
作为最小化判别准则。画出最佳树，使用计算的熵值标
记这些节点。
苦器
器:;
第8章 图像压 缩
生命短暂而信息无穷……缩写是无法避免的灾难，而缩写创造者的
任务就是要尽力做好工作。尽管缩写有害，但总比什么也不做要强。
——阿道斯·林胥黎
引言
图像压缩是一种减少描绘一幅图像所需数据量的技术和科学，它是数字图像处理领域中最有用
和商业上最成功的技术之一。每天被压缩和解压缩的图像的数量是惊人的，而压缩和解压缩本身对用
户而言却是无形的。任何一个拥有数字摄像机、在网上冲浪或在DVD 上观看好莱坞最新大片的人都
从本章讨论的算法和标准中受益。
为了更好地理解紧凑图像描绘的需要，考虑使用720×480×24比特像素阵列来描绘2小时的标准
清晰度(SD)电视电影所需的数据量。数字电影(或视频)是一个视频帧序列，其中每一帧都是一幅全
彩色静止图像。因为视频播放必须以近于30帧/秒的速率连续地显示这些帧，所以必须以
30糯×(720×480×3像=31104 000字节/秒
的速率访问SD数字视频数据。2小时的电影由
31104000秒×(60°)小时×2小时 =2.24×10"字节
或224GB(千兆字节)的数据组成。需要27张8.5GB的双层DVD(假定传统的12cm的盘)来存储它。
为了把2小时的电影放在单张 DVD上，每一帧必须以平均26.3的系数压缩。对于高清晰度电视，它
的分辨率达到1920×1080×24比特/图像，其压缩应该更高。
Web 网页图像和高分辨率数字摄像机图片也要进行例行的压缩，以节省存储空间和减少传输时间。
例如，住宅互联网连接发送数据的速率从传统电话线路的56 kbps(千比特每秒)到宽带的12 Mbps(兆比
特每秒)。以该速率范围传输一幅128×128×24比特全彩色小图像需要的时间为7秒到0.03秒。压缩可
以将传输时间减少2~10倍，甚至更多。以相同的方法，8兆像素的数字摄像机在1 GB大小的闪
存卡中可存储的未压缩全彩色图像的数量[约41幅24 MB图像]也以类似的数量增加。除了这
些应用之外，图像压缩在许多其他领域也扮演着重要的角色，包括视频会议、遥感、文本和医学
图像处理、传真传输(FAX)。应用数量的增加取决于二值图像、灰度图像和彩色图像的有效加工、
存储和传输。
第8章 图 像压 缩 335
在这一章，我们介绍数字图像压缩的理论和实践。我们将考察最常用的压缩技术，并描述使这
些技术更有用的工业标准。本质上，这些内容是介绍性的，既适用于静止图像，也适用于视频应用。
本章将以介绍数字图像水印处理来结束，即把可见和不可见数据(如版权信息)插入到图像中的处理。
8.1 基础知识
术语数据压缩是指减少表示给定信息量所需数据量的处理。在该定义中，数据和信息是不相同
的事情；数据是信息传递的手段。因为相同数量的信息可以用不同数量的数据表示，包含不相关或重
复信息的表示称之为冗余数据。如果我们令b和b'代表相同信息的两种表示中的比特数(或信息携带
单元),那么用b比特表示的相对数据冗余R是
R=1-1/C (8.1-1)
其中，C通常称为压缩率，定义为
C=b/b (8.1-2)
例如，如果C=10(有时写成10:1),较大的表示有10比特数据，那么对于较小表示中的每1比
特数据，较大表示中对应的相对数据冗余为0.9(R=0.9),表明其数据的90??冗余的。
在数字图像压缩的内容中，式(8.1-2)中的b通常是以二维灰度值阵列表示一幅图像所需的比特
数。2.4.2节中介绍的二维灰度阵列是人们观察和解释图像的首选格式，并且以它作为判定所有其他
表示的标准。然而，当它变成紧凑的图像表示时，这些格式就远不是最佳格式了。二维灰度阵列受如
下可被识别和利用的三种主要类型的数据冗余的影响：
1.编码冗余。编码是用于表示信息实体或事件集合的符号系统(字母、数字、比特和类似的符
号等)。每个信息或事件被赋予一个编码符号的序列，称之为码字。每个码字中的符号数量
就是该码字的长度。在多数二维灰度阵列中，用于表示灰度的8比特编码所包含的比特数要
比表示该灰度所需要的比特数多。
2.空间和时间冗余。因为多数二维灰度阵列的像素是空间相关的(即每一个像素类似于或取决
于相邻像素),在相关像素的表示中，信息被没有必要地重复了。在视频序列中，时间相关
的像素(即类似于或取决于相邻帧中的那些像素)也是重复的信息。
3.不相关的信息。多数二维灰度阵列中包含有一些被人类视觉系统忽略或与用途无关的信息。
从没有被利用的意义上看，它是冗余的。
图8.1(a)到(c)中由计算机生成的图像显示了每一种基本冗余。如将在接下来的三节中看到的那
样，当一个或多个冗余被减少或消除时，压缩就实现了。
a b c
图8.1 计算机产生的256×256×8比特图像：(a)编码冗余；(b)空间冗余；(c)无关
信息(设计的每幅图像都示范了一种主要的冗余，但其中也展示了其他冗余) 器器
550
(引
336 数字图像处理(第三版)
8.1.1 编码冗余
在第 3章中，我们在图像的灰度值为随机量的假设基础上，探讨了通过直方图处理进行图像增
强的技术。在本节中，我们将利用类似的表示方法介绍最佳信息编码。
假设在区间[0,L-1]内的一个离散随机变量r用来表示一幅M×N的图像的灰度，并且每个r发
生的概率为p,(r)。与3.3节一样，
p,(n)=M,k=0,1,2,…,L-1 (8.1-3)
其中，L是灰度级数，n,是第k级灰度在图像中出现的次数。如果用于表示每个r值的比特数为Ir),
则表示每个像素所需的平均比特数为
-2p,(s) (8.1-4)
也就是说，给各个灰度级分配的码字的平均长度，可通过对用于表示每个灰度的比特数与该灰度出现
的概率的乘积求和来得到。表示大小为M×N的图像所需的总比特数为MNL。如果用自然的m比
特固定长度的码来表示灰度，那么式(8.1-4)的右侧将减少为m 比特。也就是说，当使用m来代替I(r)
时，Lmg=m。常数m可以提到和式之外，只剩下p,(r)在区间0≤k≤L-1内的和，当然，该和为1。
例8.1 变长编码的简单说明。
图8.1(a)中计算机生成的图像具有表8.1第二列中显示的灰度分布。如果使用8比特自然二进制编码
(由表8.1中的编码1表示)来表示4种可能的灰度，则编码1的平均比特数L为8比特，因为对所有r
都有l?(r)=8比特。另一方面，如果使用表8.1中的编码2设计的方案，则根据式(8.1-4),编码像素的平
均长度为
L=0.25(2)+0.47(1)+0.25(3)+0.03(3)=1.81比特
表示整幅图像所需要的总比特数是MNL=256×256x1.81或118621。由式(8.1-2)和式(8.1-1),得到的压
缩和相应的相关冗余分别是
c=35618628-1.8-4.422和R=1-442=0.74
这样，原始的8比特二维灰度阵列中，数据的77.4??冗余的。
表8.1 变长编码的例子
4 P?(T) 编码1 () 编码2
0.25
0.47
0.25
0.03
0
01010111
10000000
11000100
11111111
8
8
8
8
8
01
1
000
001
L(F)
=87 2
r=128 1
=186 3
ra=255 3
4.k*87.128,186.255 0
用编码2达到的压缩结果来自较大可能的灰度值分配较少的比特，较小可能的灰度值分配较多的
比特。在得到的变长编码中，rn——图像中最大可能出现的灰度——被分配1比特码字1[其长度
①自然二进制编码是指对这种编码中将被编码的每个事件或信息(如灰度值)分配了来自一个m比特二进制计数序列的2”种编码
中的一种
第8章 图 像压 缩 337
?(F?)=1].r—图像中最小可能出现的灰度—被分配3比特码字001[其长度?(r?ss)=3]。注意，
可分配给图8.1(a)中图像的灰度的最好定长编码是自然的2比特计数序列{00,01,10,11},但得到的压缩
率仅为8/2或4:1,比变长编码的压缩率4.42:1少约10??
如前例所示，当对事件集合(例如灰度值)分配码的时候，如果不取全部事件概率的优势，就会
出现编码冗余。当用自然二进码表示一幅图像的灰度时，编码冗余几乎总是存在的。其原因是大多数
图像都是由规则的、在某种程度上具有可预测形态(形状)与反差的物体组成的，并且这些图像被取样，
所以，描述的物体远大于图像元素。对大多数图像来说，自然的结果是某些灰度与其他灰度相比更可
能出现(即多数图像的直方图是不均匀的)。自然二进制编码对最大和最小可能值分配相同的比特数，
因此，无法使式(8.1-4)最小，从而产生了编码冗余。
8.1.2 空间冗余和时间冗余
考虑图8.1(b)中由计算机生成的恒定灰度线的集合。在对应的二维灰度阵列中：
1.所有256种灰度都是等概率的。如图8.2所示，图像的直方图是均匀的。
2.因为每条线的灰度是随机选择的，在垂直方向上，每条线的像素彼此是独立的。
3.因为沿每条线的像素是相同的，因此在水平方向上它们是最大相关的(完全互相依赖)。
第一个观察告诉我们，当使用传统的8比特灰 p,(A) 度阵列来表示时，图8.1(b)中的图像不能单一地使
用变长编码来压缩。与图8.1(a)(和例8.1)中的图 256 256 像不同，这些图像的直方图是不均匀的，在这种情
况下的一个定长8比特编码可使式(8.14)最小化。
0 0 观察2和3揭示了一个可被消除的有意义的空间冗
50 0 150 200 250 100 余，例如，通过一个行程长度对序列来表示图8.1(a) k
中的图像，其中每个行程长度对指定一个新灰度的 图8.2 图8.1(b)中图像的灰度直方图
开始点和具有该灰度的连续像素的数量。基于行程
长度的表示用(256×256×8)[(256+256)×8]或128:1的比率压缩原始的8比特灰度图像。原始表示的
每条256像素的线用单一的8比特灰度值和行程表示中的长度256来替代。
在多数图像中，像素是空间(在x和y方向)和时间相关的(当该图像是视频序列的一部分时)。因
为多数像素灰度可根据相邻像素灰度进行合理的预测，所以单个像素携带的信息较少。在这种意义上，
一个像素可由其相邻像素推断出来，那么它的视觉贡献的大多数就是冗余的。为减少空间与时间相关
的像素涉及的冗余，二维灰度阵列必须变换为更有效但通常不可见的表示。例如，行程长度或相邻像
素之间的差异可供利用。这种类型的变换称为映射。如果原始二维灰度阵列的像素可以根据变换后的
数据集合无误地重建，则称这个映射是可逆映射，否则称这个映射是不可逆映射。
8.1.3 不相关的信息
压缩数据集最简的方法之一是从集合中消除多余的数据。在数字图像压缩方面，被人的视觉系统忽
略的信息或与图像预期的应用无关的信息显然都是删除的候选者。这样，图8.1(c)中由计算机生成的图像，
就可单独由其平均灰度(一个单一的8比特值)来表示，因为它是以单一灰度场的形式出现的。原始的
256×256×8 比特灰度阵列被减少到一个单一的字节；得到的压缩率为256×256×8/8或65 536:1。当然，
原始256×256×8比特图像必须被重建以供观察或对它进行分析，但重建图像的质量会有较少的或不被
察觉的下降。 的s
密：的
338 数字图像处理(第三版)
图8.3(a)显示了图8.1(c)中的图像的直方图。注意，实际存在一些灰度值(灰度125到131),人的
视觉系统平均了这些灰度，并仅感知平均值，而忽略了这种情况下灰度的较小变化。图8.3(b)是
图8.1(c)中图像经直方图均衡处理后的结果，它使得灰度变化可见了，并显示了两个先前不可检测的
恒定灰度区域，一个是垂直的，另一个是水平的。如果图8.1(c)中的图像用其平均灰度值单独表示，
这个“不可见的”结构(即两个恒定灰度区域)及其周围的随机灰度变化(真实信息)将会丢失。这些信
息是否应保留由应用决定。如果该信息是重要的，如它可能应用于医学(如数字X射线档案)中，它
就不应该遗漏；否则，这种信息就是冗余的，为确保压缩性能可将它排除在外。
我们注意到，这里考察的冗余度与8.1.1节和8.1.2节中讨论的冗余度根本的不同给出本节的结论。
消除冗余是可能的，因为这种信息本身对于正常的视觉处理和/或期望的图像用途并不是本质的。由
于去除这种信息会导致定量信息的损失，这种信息的去除通常称为量化。这一术语与该词的标准用法
一致，它通常意味着将较宽范围的输入值映射为有限数量的输出值(见2.4节)。因为信息损失了，所
以量化是一种不可逆的操作。
7000 a b
6000
5000
像素数 4000
3000
2000
1000
0
0 50 1001150200)250
图8.3(a)图8.1(c)中图像的直方图；(b)该图像经直方图均衡处理后的形式
8.1.4 图像信息的度量
在前几节中，我们介绍了减少用于表示一幅图像的数据量的几种方法。自然地，出现的问题是：
表示一幅图像中的信息实际上需要多少比特?也就是，存在一个不丢
关信息论和概率论的简要 失信息的充分地描述一幅图像的最小数据量吗?信息论提供了回答这 回顾，请参阅本书的网站 个问题和相关问题数学框架。它的基本前提是信息的产生可用一个概
率过程建模，该过程可以用一种与直觉一致的方式加以度量。根据这一推测，一个具有概率P(E的
随机事件E可被说成是包含
IE)=logPE=-logP(E) (8.1-5)
单位的信息。如果P(E)=1(即事件总会发生)时，I(E)=0,并且，认为它没有信息。因为相关的该事
件没有不确定性，所以在事件发生的通信过程中不会传递任何信息[如果P(E)=1,该事件总会发生]。
式(8.1-5)中对数的底决定了度量信息所用的单位。如果使用以m为底的对数，则这种度量称
为m元单位。如果底选择为2,则信息的单位是比特。注意，如果P(E)=1/2,那么I(E)=-log?I/2
或1比特。也就是说，当两个出现概率相等的事件之一发生时，传达的信息量是1比特。一个简单
的例子就是投掷一枚硬币及传递的结果。
从一个可能事件的离散集合{a,a?…,a,],给定一个统计独立随机事件的信源，与该集合相联系
的概率为(P(a,),P(a?),…,P(a)},则每个信源输出的平均信息称为该信源的熵，即
第8章 图 像压 缩 339
H=-2Pra,)JoePla) (8.1-6)
在这个公式中，a,称为信源符号。因为它们是统计独立的，信源本身称为零记忆信源。
如果将一幅图考虑为一个虚构的零记忆“灰度信源”的输出，我们可通过观察图像的直方图来
估计该信源的符号概率。这时，灰度信源的熵变为
式(81-6)适用于有着/个信源符号 H=-2p.(esP(A) 的零记忆信源；式(8.1-7)使用一幅图 (8.1-7) 像中的L-1个灰度值的概率估计
其中，变量Lr和p,(r)如8.1.1节和3.3节中的定义。因为用以2为底的对数，式(8.1-7)是以比特(bit)
度量的虚构灰度信源的每个灰度输出的平均信息。它不可能对虚构信源的灰度值以比H比特/像素少
的码(取样图像)来编码。
例8.2 图像的熵的估计。
图8.1(a)所示图像的熵可通过将表8.1中的灰度概率代人式(8.1-7)中来估计：
H=-[0.25 log?0.25+0.47 log?0.47+0.25 log?0.25+0.03 log?0.03]
-[0.25(-2)+0.47(-1.09)+0.25(-2)+0.03(-5.06)]
=1.6614比特/像素
以类似的方法，图81(b)和(c)中图像的熵可以分别表示为8比特像素和1.566比特/像素。注意，图8.1(a)
中的图像似乎具有更多的视觉信息，但计算出的熵却几乎是最低的——1.66 比特/像素。图8.1(b)中图像
的熵几乎是图8.1(a)中图像的熵的5倍，但似乎有相同(或更少)的视觉信息；图8.1(c)中似乎有很少的信
息或没有信息，却具有与图8.1(a)中图像几乎相同的熵。因而明显的结论是一幅图像中熵的数量和信息与
直觉相差甚远。
山农第一定理
回顾一下例8.1 中的变长编码仅使用1.81 比特/像素就可表示图8.1(a)中的图像的灰度。虽然它
比例8.2 中的估计熵 1.6614 比特/像素要高，但山农第一定理——也称为无噪声编码定理
(Shannon[1948])]——告诉我们，图8.1(a)中的图像可使用不多于1.6614比特/像素来表示。为用一
般方法来证明它，山农使用一个单一码字(而不是每个信源符号一个码字)考察了n个连续信源符号表
示的组合，并证明了
[]= (8.1-8)
其中，L是表示所有 n个符号组所需的编码符号的平均数。在证明中，他将一个零记忆信源的
第n个扩展定义为一个假设的信源，该假设信源使用原始信源符号产生n个符号块；并将式(8.1-4)
应用到用以表示 n个符号块①的码字，计算L。式(8.1-8)告诉我们，L/n可用单一符号源的
无限扩展编码任意接近H。也就是，用每信源符号H信息单位的平均来表示零记忆信源的输出是
可能的。
①第n个扩展的输出是一个n元符号组，这些符号来自底层的单一符号信源。它被视为一个块随机变量，在该变量中，每个n元
组的概率是各个符号的概率的积。因而，第n个扩展的熵，是单一符号信源的熵的n倍。 密:
近:
340 数字图像处理(第三版)
如果现在我们回到图像是产生它的灰度信源的一个“取样”这一概念，一个n个信源符号的块
对应于n个邻近像素组。为了对n个像素块构建一个变长编码，必须计算块的相关的频数。但是，具
有256个灰度值的假设的灰度信源的第n个扩展有256"个可能的n像素块。甚至在n=2的简单情况
下，也必须产生65 536个元素直方图和多达65536个变长码字。对于n=3,需要多达16 777 216个
码字。因此，即使对于较小的n值，在实践中，计算的复杂性也限制了扩展编码方法的使用价值。
最后，我们注意到，在对统计独立的像素直接编码时，尽管式(8.1-7)提供了可以达到的压缩的
下界，但当一幅图像的像素相关时，它就失败了。相关像素块可用比公式预测的每像素平均比特数低
的码率编码。与其用不相关描述符的信源扩展(类似灰度行程),不如选择通常的和无扩展的方法。这
是在8.1.2节中用于压缩图8.1(b)的方法。当信息源的输出依赖于前面有限数量的输出时，那么该信
源称为马尔可夫信源或有限记忆信源。
8.1.5 保真度准则
在8.1.3节中，我们注意到去除“与视觉不相关”信息会导致真实的或一定数量的图像信息的丢失。
因为信息的丢失，因此需要一种量化这种丢失的本质的方法。两类准则可用于这样的评估：(1)客观保
真度准则；(2)主观保真度准则。
当信息损失可以表示为压缩处理的输入和输出的数学函数时，则称其是以客观保真度准则为基础的。
一个例子是两幅图像间的均方根(mms)误差。令f(x,y)是输入图像，并令f(x,y)是f(x,y)的近似，它来
自对输入先压缩后解压缩的结果。对x和y的所有值，f(x,y)和f(x,y)之间的误差e(x,y)为
e(x,y)=f(x,y)-f(x,y) (8.1-9)
因此，两幅图像间的总误差为
22[ia.]-rxJ]
其中，图像的大小为M×N。而f(x,y)和f(x,y)之间的均方根误差em为在M×N阵列上平均
误差的平方的平方根，或写为
-六22[/s]-0a (8.1-10)
如果[简单地重排式(8.1-9)中的各项]认为f(x,y)是原始图像f(x,y)和一个误差或“噪声”信号
e(x,y)的和，则用SNR_表示的输出图像的均方信噪比可像在5.8节中那样定义为
(8.1-11)
表示为SNR的信噪比的均方根值可通过求式(8.1-11)的平方根得到。
尽管客观保真度准则提供了一种简单方便的评估信息损失的方法，但解压缩后的图像最终还是
由人来观察的。因此，使用人的主观评估来衡量图像的质量通常更为适当。主观评估是通过向观察者
显示解压缩的图像，并将他们的评估结果进行平均得到的。评估可使用一个绝对等级尺度或借助于
f(x,y)和子(x,y)的并排比较来获得。表8.2显示了一种可能的绝对等级尺度。并排比较可通过使用像
第8章 图 像压 缩 341
(-3,-2,-1,0,1,2,3}这样的一个等级分别表示主观评估|非常恶劣、恶劣、稍坏、普通、稍好、更好、
非常好。不管使用何种形式，这些评估均基于主观保真度准则。
例8.3 图像质量比较。
图8.4显示了图8.1(a)中图像的三种不同的近似。将图8.1(a)中的图像作为f(x,y),并将图8.4(a)
中的图像作为f(x,y),用式(8.1-10)计算的均方根误差分别是5.17,15.67和14.17个灰度级。根据均方根
误差——客观保真度准则——,图8.4中的三幅图像按质量递减的顺序排列为{(a),(c),(b)}。
表8.2 电视配置研究组织的等级尺度(Frendendall and Behrend)
值 等 级
优秀
好
可通过的
边缘的
差
不能用
描 述
1 一幅极高质量的图像，和您希望的一样好
2 一幅高质量的图像，提供赏心悦目的观看效果。干扰不讨厌
3 一幅质量可接受的图像。干扰不讨厌
4 一幅质量较差的图像，您希望能改进它，干扰有些讨厌
5 一幅质量非常差的图像，但还可以观看，明显存在讨厌的干扰
6 一幅坏到不能观看的图像
a b c
图8.4 图8.1(a)中图像的三个近似
图8.4(a)和(b)是已被压缩并随后被重建的典型图像。两幅图像都保留了原图像的基本信息，如目标
的空间和灰度特点。它们的均方根误差粗略地对应于感觉的质量。实际上与原图像一样好的图8.4(a)具有
最低的均方根误差，而图8.4(b)具有更多的误差，但在物体间的边界处存在显而易见的退化。这恰好如预
期的那样。
图8.4(c)是人工生成的图像，它给出了客观保真度准则的限制。注意，在右上象限中，图像失去了几
条重要线条的大部分(即可视信息),并出现了几个暗的小方块(即人为的缺陷)。图像的视觉内容被误解
了，且的确不像图(b)中的图像那样准确，但它有着更小的均方根误差——14.17灰度级对15.67灰度级。
使用表8.2 对这三幅图像进行主观评估，可能会产生对图(a)为“优秀”的等级，对图(b)为“可通过的”
或“边缘的”的等级，对图(c)是“差”或“不能用”的等级。另一方面，用均方根误差来度量时，(c)却
排在(b)的前面。
8.1.6 图像压缩模型
如图8.5所示，图像压缩系统是由两个不同的功能部分组成的：一个编码器和一个解码器。编码
器执行压缩操作，解码器执行解压缩的互补操作。两种操作可用软件执行，如在Web 浏览器和许多
商业图像编辑程序中那样，或者使用硬件和固件相结合的形式执行，如商业 DVD 播放器。codec是
一个具有编码和解码能力的装置或程序，它有编码和解码的能力。 ;～5
圈：罔
342 数宇图像处理(第三版)
图像f(x,…)被输入到编码器中，这个编码器创建该输入的压缩
表示。把这一表示存储起来以备后续应用，或为传输而存储，以便远
程应用。当压缩后的表示送人其互补的解码器中时，就会产生重建的
输出图像子(x,…)。在静止图像应用中，编码的输入和解码器的输出分别是f(x,y)和f(x,y);在视
频应用中，它们分别是f(x,y,r)和f(x,y,t),其中离散参数r规定为时间。通常，f(x,…)可能是也可
能不是f(x,y)的精确的复制品。如果是f(x,y)的精确复制品，则压缩系统被称为无误差的、无损的
或信息保持的压缩系统；如果不是f(x,y)的精确复制品，则重建的输出图像就会失真，并且压缩系
统称为有损压缩系统。
f(x,y) 或
/(r.y.1)
这里，f(x.…)用于表示f(x.y)
和f(x,y,)。
映射器 量化器 符号编码器
用于存储和
传输的压缩数据 编码器
符号解码器 逆映射器
j(x.y)
或
f(x,y.r)
解码器
图8.5 一个通用图像压缩系统的功能方框图
编码或压缩过程
图8.5的编码器被设计为通过一系列三个独立操作去除在8.1.1节至8.1.3节描述的冗余度的形式。
在编码处理的第一个阶段，映射器把f(x,…)变换为设计来降低空间和时间冗余的形式(通常不可
见)。这一操作通常是可逆的，并且可能会也可能不会直接减少表示图像所需的数据量。行程编码(见
8.1.2节和8.2.5节)就是一个映射的例子，该映射通常在编码处理的第一步中就会得到压缩。把一幅
图像映射为一组不相关的变换系数(见8.2.8节)是相关情况的一个例子(为实现压缩，必须对系数进行
进一步处理)。在视频应用中，映射器使用前面的(在某些将来的情况下)视频帧来帮助去除时间冗余。
图8.5中的量化器根据预设的保真度准则来降低映射器输出的精度。其目的是排除压缩表示的
无关信息。正如在8.1.3节中解释的那样，这一操作是不可逆的。当希望进行无误差压缩时，这一步
必须略去。在视频应用中，通常需要度量编码输出的比特率(比特/秒),并调整量化器的操作，以
保持预设的平均输出比特率。这样，输出的视觉质量就可根据图像内容逐帧变化。
在第三阶段，即信源编码处理的最后阶段，图8.5中的符号编码器生成一个定长编码或变长编码
来表示量化器的输出，并根据该编码来变换输出。在大多数情况下，使用变长编码。最短的码字赋予
出现频率最高的量化器输出值，以最小化编码冗余。这种操作是可逆的。该操作完成后，输入图像对
于8.1.1节到8.1.3节中所描述的三种冗余的每一种去除都被处理过了。
解码或解压缩过程
图8.5中的解码器仅包含两个部分：一个符号解码器和一个反映射器。它们以相反的顺序执行编
码器的符号编码器和映射器的反操作。因为量化导致了不可逆的信息损失，所以反量化器模块没有包
含在通常的解码器模型中。在视频应用中，解码后的输出帧保留在内部帧存储器中(没有显示),并用
于重新插入在编码器中去除的时间冗余。
第8章 图 像压 缩 343
8.1.7 图像格式、容器和压缩标准
在数字图像处理领域，图像文件格式是组织和存储图像数据的标准方法。它定义了所使用的数
据排列的方式和压缩的类型——如果有的话。一个图像容器类似于文件格式，但处理多种类型的图像
数据。另一方面，图像压缩标准对压缩和解压缩图像定义了过程，也就是定义减少表示一幅图像所需
数据量的过程。这些标准是图像压缩技术被普遍接受的基础。
图8.6列出了当前使用的大多数重要的图像压缩标准、文件格式和容器，并用被处理图像的类型
进行了归类。加粗的条目是由国际标准化组织(ISO)、国际电工委员会(IEC)和国际电信联盟[ITU-T,
一个联合国组织，从前称为国际电报电话咨询委员会(CCITT)]批准的国际标准。还包含两个视频压
缩标准，即由电影和电视工程师协会(SMPTE)批准的VC-1和由中国原信息产业部(MII)批准的AVS。
注意，图8.6中由灰色显示的条目不是国际标准化组织支持的标准。
表8.3和表8.4总结了图8.6中列出的标准、格式和容器。也指出了负责组织、应用目标和关键的压
缩方法。压缩方法本身是下一节的主题。在两个表中，以方括号的形式提前引用了8.2节中的相关小节。
图像压缩标准、格式和容器
静态图像 视频
DV
H.261 二值 连续音调 H.262
CCTTT Group 3 JPEG H.263
CCITT Group 4 JPEG-LS H.264
JBIG(或JBIG1) JPEG-2000 MPEG-1
JBIG2 MPEG-2 BMP MPEG-4 TIFF GIF MPEG-4AVC PDF
PNG AVS
TIFF HDV
M-JPEG
QuickTime
VC-1(或WMV9)
图8.6 一些常用的图像压缩标准、文件格式和容器。国际支持的条目显示为黑色，其他条目显示为灰色
表8.3 国际支持的压缩标准。方括号中的数字指的是本章中的小节号
名 称 组织 描 述
二值静止图像
CCTTT3组 ITU-T 为在电话线上传输二值文件的传真(FAX)设计的方法。支持一维和二维行程编码[8.2.5]及霍夫曼编
码(8.2.1)
CCTTT4组 TU-T ccITT3组标准的一个精简和革新的版本，仅支持二维行程编码
ISOIEC
TU-T
用于渐进、无损压缩二值图像的一个联合二值图像专家组标准。高达6比特/像素的连续色调图像可
JBIG或JBIGI 在一个位面的基础上编码[8.2.7]。使用了上下文敏感的算术编码[8.2.3].且初始低分辨率的图像版本
可使用附加的压缩数据逐步增强
ISOIEC TU-T
遵循 JBIGI的，针对桌面、互联网和FAX应用的二值图像的标准。使用的压缩方法是基于内容的：
JBIG2 对文本和半色调区域使用基于字典的方法[82.6].而对其他图像内容使用霍夫曼编码[82.1]或算术编
码[8.2.3]。它可以是有损的或无损的
连续色调静止图像
ISO/IEC
ITU-T
针对图片质量的图像的联合图片专家组标准。其有损基准编码系统(最通用的实现)在8×8图像块上
JPEG [8.2.8]用量化的离散余弦变换(DCT)、霍夫曼编码[8.2.1]和行程编码[8.2.5]。它是在互联网上压缩图
像的最普遍的方法之一 宫～8
器:9
344 数字图像处理(第三版)
(续表)
名 称 组织 描 述
连续色调静止图像
JPEG-LS ISOIEC
TU-T
针对连续色调图像的基于自适应预测[8.29]、上下文模型82.3]和Golomb 编码[8.2.2]的无损到接近
无损的标准
JPEG-2000 ISO/IEC
TTU-T
遵循 JPEG的用于提高图片质量图像的压缩率的标准。它使用算术编码[8.2.3]和量化离散小波变换
(DWT)[8.2.10]。压缩可以是有损的或无损的
视频
DV IEC 数字视频。适用于家庭和半专业视频制作应用，以及类似电子新闻采集和便携式摄像机等设备的视
频标准。它使用一种类似于JPEG的基于DCT的方法{82.8]对简单编辑目的单独地压缩图像帧
rTU-T
针对ISDN 线路(综合业务数字网)的一种双向视频会议标准。它分别支持非隔行扫描的352×288和
176x144分辨率图像[称为CIF(通用中间格式)和QCIF(四分之一CIF)]。采用类似于JPEG的基 H.261 于DCT 的压缩方法[82.8],使用帧间预测差分[82.9]来减少时间冗余。基于块的技术用于帧间的运
动补偿
H.262 TU-T 见下面的MPEG-2
ITU-T 针对具有附加分辨率SQCIF(Sub-Quarter CIF 128×96)、4CIF(704×576)和16CIF(1408×512)的普通 H.263 电话调制解调器(如28.8 Kb/s)设计的H.261的增强版本
H.264 ITU-T 针对视频会议，网络流和电视广播的H261至H.263的一个扩展。它支持顿间预测差分[829]、可
变块大小的整数变换(不是DCT)和上下文自适应算术编码[82.3]
ISO/IEC 针对CDROM应用的非隔行扫描视频的速率高达1.5 Mbis的运动图像专家组标准。它类似于H.261. MPEG-1 但帧预测可基于前一帧、下一帧或两者的内插。几乎所有的计算机和DVD播放器都支持该标准
MPEG-2 ISO/IEC 针对DVD所设计的传输速率高达15 Mbis的MPEG-1的一个扩展。支持隔行扫描视频和HDTV
它是目前为止最为成功的视顺标准
MPEG-4 ISO/ET
ISO/ET
MPEG-2的一个扩展，它支持可变块大小和帧间预测差分[8.2.9]
MPEG-4AVC MPEG-4的第10部分，即先进视频编码(AVC)。与上面的H.264AVC相同
表8.4 没有包含在表8.3中的常用图像压缩标准、文件格式和容器
名 称 组 织 描 述
连续色调静止图像
BMP Microsoft Windows 位图。主要用做未压缩的简单图像的一种文件格式
CompuSene 图形交换格式。对1到8比特图像使用无损LZW编码[8.2.4]的文件格式。它常用于为万维网制作小
动画和低分辨率影片
Adobe
Systems
便携文件格式。针对与设备和分辨率无关的方法表示二维文档的一种格式。它可以像 JPEG、JPEG
2000、CCTT和其他压缩图像的容器来运行。某些PDF版本已成为ISO标准
万维网联
盟(W3C)
便携网络图形。通过对每个像素值与基于过去像素的预测值间的差进行编码，是全透明(高达48比
特/像素)无损地压缩全彩色图像[8.2.9]的文件标准。
Aldus 标记图像格式。一种灵活的文件格式，支持多种图像压缩标准，包括 JPEG、JPEG-LS、JPEG-2000、
JBIG2和其他标准
MII 音视频标准。类似于H264,但使用指数Golomb编码[82.21。中国开发的标准
公司联盟 高清晰度视颖。针对高清电视的DV的一个扩展，它使用类似于MPEG-2的压缩，包括使用预测差
分方法[8.2.9]去除时间冗余
多家公司 活动JPEG,一种压缩格式，在这种格式中，每一帧都独立地用JPEG来压缩
Computer Apple 支持DV,H261、H.262,H264、MPEG-1,MPEG-2和MPEG-4他视频压缩格式的一种媒体容器
SMPTE 互联网上最为通用的视频格式
Microsoft 适用于高清和蓝光高分辨率DVD的一种格式。它类似于H.264/AVS.使用一个可变块大小的整数
DCTI8.2.8,82.9]和依赖于上下文的变长码表[8.2.1].但没有帧间预测
GIF
PDF
PNG
TIFF
视频
AVS
HDV
M-JPEG
Quick-Time
VC-1
WMV9
第8章 图 像压 缩 345
8.2 一些基本的压缩方法
本节描述今天所用的几种主要有损和无误差的压缩方法，我们的目标集中在那些主流二值图像、
连续色调静止图像和视频压缩标准中已经证实了很有用的方法。标准本身用于对现存方法的示范。
8.2.1 霍夫曼编码
消除编码冗余的一种最常用技术要归功于霍夫曼(Huffman [1952])。
当单独地对信源的符号进行编码时，霍夫曼编码对每个信源符号产生了
可能最小数量的编码符号。根据山农第一定理(见8.1.4节),对于一个
固定值n生成的编码是最佳的，但受限于每次只能对一个信源符号进
行编码。在实践中，信源符号不是图像的灰度，就是一个灰度映射操
作的输出(如像素差值、行程等)。
霍夫曼方法的第一步是通过对所考虑符号的概率进行排序，并将具有最小概率的符号合并为一个
符号来替代下次信源化简过程中的符号，从而创建一个简化信源系列。图8.7针对二进制编码说明了
这种处理(也可以构造K元霍夫曼编码)。在最左边，一组虚构的信源符号集合及它们的概率根据概
率值的减少从上到下排列。为形成第一次信源简化，底部的两个概率0.06和0.04合并，形成了一个
概率值为0.1的“复合符号”。这个复合符号及其对应的概率被置于第一个信源简化列中，以便简化
后信源的概率仍按其值从最大到最小排列。这个过程一直重复持续到信源只有两个符号的简化信源(在
最右边)为止。
信源化简 原始信源
3 4 2 1 概率 符号
0.6 0.4 0.4 0.4 0.4 a2
a% 0.3 0.3 0.3 0.3- 0.4
a? 0.1 0.1 0.2 0.3-
a4 0.1 0.1 0.1
a? 0.06- 0.1
as 0.04
图8.7 霍夫曼信源化简
霍夫曼编码过程的第二步是对每个化简后的信源进行编码，从最小的信源开始，并直到遍历原
始信源。当然，对于两个符号信源的最小长度的二值码是符号0和1。如图8.8所示，这些符号被分
配给最右边的两个符号(这种分配是任意的；颠倒0和1的顺序同样可行)。用将简化信源中的两个符
号合并到了其左侧生成了概率为0.6的简化信源符号，用0对该符号编码是现在分配给这两个符号的
方法，而0和1是任意加到每个符号上的，以便对它们进行区分。然后，对每个简化信源重复该操作，
直到到达原始信源。图8.8最左边显示了最终的编码。这个编码的平均长度为
Lg=(0.4)(1)+(0.3)(2)+(0.1)(3)+(0.1)(4)+(0.06)(5)+(0.04)(5)=2.2比特/像素
该信源的熵为2.14比特/符号。
霍夫曼编码过程对一组符号产生最佳编码，其概率服从一次只能对一个符号进行编码的限制。
在编码建立之后，编码和/或无误差解码就简单地以查找表的方式完成。编码本身是一种瞬时的、唯
一可解码的块编码。之所以称它为块编码，是因为每个信源符号都映射到了一个编码符号的固定序列
中。它是瞬时的，因为编码符号串中的每个码字无须参考后续符号就可以进行解码。它是唯一可解码
的，因为任何编码符号串只能以一种方式进行解码。因此，任何霍夫曼编码符号串可以通过从左到右
参考表83和表84.霍夫曼编码用
●CCITT
●JBIG2
●JPEG
●MPEG-1,2.4
●H.261,HL262.H.263,H264
于如下压缩标准和其他压缩标准中：
密：受
自：受
346 数字图像处理(第三版)
的方式对该串中的每个符号进行分析来解码。对于图8.8中的二进制编码，对编码串010100111100从
左到右的扫描表明，第一个有效码字为01010,它是符号a?的码；下一个有效编码是011,它对应的
符号为a?。按这种方式继续下去可得到完全解码后的消息为aya,a?a?a%
信源化简 原始信源
3 2 1 概率 符号 编码 4
-0.6 0 0.4 1 0.4 a2 0.3 1 0.4 1 0.4 1
0.3 00
a1 0.1
a4 0.1
011 0.1 011 -0.2
0.3 0.3 00 0.4 1
0.3
0100- 0.1 011
a3 0.06 01010- -0.1 0101-
as 0.04 01011
a 00
0100 0.1
00
01 010-
图8.8 霍夫曼编码分配过程
例8.4 霍夫曼编码。
图8.9中的512×512×8比特单色图像具有如图8.9(b)所示的直方图。因为灰度不是等概率的，霍夫曼
编码过程的MATLAB实现用7.428比特/像素对其编码——包括重建原始8比特图像灰度所要求的霍夫曼
编码表。由5122×(7.428-7.3838)或11587 比特可知，压缩后的表示超过了图像的估计熵[由式(8.1-7)
得出估计熵为7.3838比特/像素]约0.6??得到的压缩率和对应的相对冗余度分别是C=87.428=1.077
和R=1-(1/1.077)=0.0715。这样，原始8比特定长灰度表示的7.15??作为编码冗余而被去除了。
a b 3000
2500
像素数 2000
1500
1000
500
0
0 50 100 150 200 250
图8.9(a)一幅大小为512×512的8比特图像；(b)该图像的直方图
当对大量符号进行编码时，最佳霍夫曼编码的构造并不是简单的任务。对于有J个信源符号的
通常情况，需要J个符号概率、J-2次信源简化和J-2次编码赋值。当事先信源符号的概率可以估
计时，使用预计算的霍夫曼编码可以达到“接近最佳”编码。一些通用的图像压缩标准，包括8.2.8
节和8.2.9节中讨论的JPEG和MPEG标准都规定了默认的霍夫曼编码表，这些编码表是以实验数
据为基础预先计算出来的。
8.2.2 Golomb 编码
在本节中，我们考虑具有指数衰减概率分布输入的非负的整数编
码。使用在计算上比霍夫曼编码还要简单的一类编码，这种类型的输
入可被最佳化编码(在山农第一定理的意义上)。编码本身第一次是针
对非负行程的表示提出来的(Golomb[1966])。在接下来的讨论中，符号[x]表示小于等于x的最大整
数，[x]表示大于等于x的最小整数，xmody表示x被y除的余数。
参考表8.3和表84. Golomb编
码用于JPEG-LS压缩和AVS压缩。
第8章 图 像压 缩 347
给定一个非负整数n和一个正整数除数m>0后，表示为G_(n)的n关于m的Golomb编码是商
[n/m]的一元编码和n mod m的二进制表示的一个合并。G(n)的构建如下：
步骤1 形成商[n/m]的一元编码(整数q的一元编码定义为q个1紧跟着一个0)。
步骤2 令k=[log?m],c=2?-m,r=n mod m,并计算截短的余数r',例如，使其满足
0≤r<c r={rt截至l比特， 其他 (8.2-1)
步骤3 连接步骤1和步骤2的结果。
例如，为计算G?(9),可从求商[9/4]=[2.25]=2的一元编码开始，它的一元编码是110(步骤1
的结果)。然后，令k=[log?4]=2,c=22-4=0,r=9mod4,在二进制中，是1001 mod 0100或0001。
根据式(8.2-1),r是r(即0001)截短到2比特的结果，它是01(步骤2的结果)。最后，连接来自步
骤1的110和来自步骤2的01,得到11001,它就是G?(9)。
对于m=2*,c=0的特殊情况，对所有的n,在式(8.2-1)中，r=r=n mod m截短至k比特。
产生Golomb 编码所要求的除法变成二进制移位操作和计算上更简单的编码，这种编码称为Golomb Rice 码或Rice码(Rice[1975])。表8.5中的2、3和4列列出了前10个非负整数的G,G?和G?码。因
为在每种情况下m都是2的幂(即1=2°,2=2'和4=22),所以它们也是前三个Golomb-Rice码。此
外，G?是非负整数的一元码，因为对所有的n,有[n/1]=n和n mod 1=0。
记住，Golomb 码只能用于表示非负整数，并且有许多Golomb 码可供选择，在其有效应用中的
一个关键步骤是除数m的选择。当被表示的整数具有概率质量函数(PMF)的几何分布时
P(n)=(l-p)p" (8.2-2)
其中0<p<1,可以证明 Golomb码是最佳的，在该意义上，即当
m-[(/0] (8.2-3)
时，G_(n)为所有唯一可判读的编码提供了最短的平均码长(Gallager and Voorhis[1975])。
图8.10画出了式(8.2-2)在三个不同p值时的曲线，并以图形方式
说明了Golomb 编码处理得较好的符号概率(即编码效率)。正如图所
示的那样，小整数的可能性要比大整数大得多。
因为一幅图像中的灰度的概率[如图8.9(b)的直方图]未必与式(8.2-2)中规定的概率和图8.10(a)中
所示的概率匹配，所以 Golomb码很少用于灰度编码。然而，当灰度差被编码时，所得“差值”的概
率(见8.2.9节)——值得注意的是负差值这一例外——常常类似于式(8.2-2)和图8.10(a)。为了在仅能
表示非负整数的Golomb编码中处理负差值，通常使用一个类似于下式的映射：
Mo)-{2-1.n≤0
由式(8.2-2)中的PMF定义的离散
概率分布称为几何概率分布，其对
应的连续形式是指数分布
PMF的图形表示是直方图
(8.2-4)
例如，使用该映射，图8.10(b)中所示的双边PMF可变换为图8.10(c)中的单边PMF。其整数被
重新排序，即交换负的和正的整数，所以负整数可被映射到奇正整数位置。如果P(n)是双边的且中心
①概率质量函数(PMF)定义一个离散随机变量完全等于某个值的概率。PMF与PDF(概率密度函数)的不同之处在于，PDF的值
不是概率；相反，PDF在指定区间上的积分才是概率。 爱：图
室密
348 数字图像处理(第三版)
位于零处，则P(M(n)将是单边的。然后，被映射的整数M(n)可以使用一种合适的Golomb-Rice码来
有效地编码(Weinberger et al.[1996])。
表8.5 整数0-9的几种Golomb码
N G(n) G?(n) G?(n)
0
10
110
1110
11110
11110
1111110
11111110
111111110
111111110
00
01
100
101
1100
1101
11100
11101
111100
111101
000
001
010
011
1000
1001
1010
1011
11000
11001
(n)
0 0
1 100
2 101
3 11000
4 11001
5 11010
6 11011
7 1110000
8 1110001
9 1110010
a bc
0.8 p=0.25 0.8F 08
0.6 06 0.6
履率 只
0.4 0.5 0.4 0.4
02 =0.75 02 02
0
人 鲁
0 2 6 8
00由-4-2 0
0 2 02 4 68
n M(n)
图8.10(a)来自式(8.2-2)的三个单边的几何分布；(b)一个双边的指
数衰减分布；(c)使用式(8.2-4)重新对图(b)重排序的结果
例8.5 Golomb-Rice 编码。
再次考虑来自图8.1(c)的图像，并注意到其直方图[见图8.3(a)]类似于图8.10(b)的双侧分布。如果
我们令n是图像中的非负整数灰度，0≤n≤255,μ是平均灰度，P(n-μ)是如图8.11(a)所示的双侧分
布。这条曲线是用图像中的像素总数归一化图8.3(a)中的直方图，将归一化后的值向左移动128(效果上这相
当于从图像中减去平均灰度)产生的。根据式(8.24),P(M(n-μ))是图8.11(b)所示的单侧分布。如果使用
表8.5中第二列的G?码的MATLAB实现对重新排序后的灰度值进行 Golomb编码，则编码后的表示比原图像
小4.5倍(即C=4.5)。使用变长编码，G?码在理论上实现4.5/5.1或88??压缩是可能的(基于例8.2中计算的
熵，变长编码可实现的最大压缩率是C=8/1.566=5.1)。此外，Golomb编码可达到用霍夫曼编码方法的MATLAB
实现的压缩的96并且不需要定制霍夫曼编码表的计算。
现在考虑图8.9(a)中的图像。如果它的灰度已用上面谈到的相同G?码进行了Golomb编码，那么C=
0.0922,即存在数据扩展。这是由于图8.9(a)中图像的灰度的概率与式(8.2-2)定义的概率相比有很大的不同
的原因。以相同的方法，当使用概率与由计算得到的编码的概率不同的编码
符号时，霍夫曼编码可能产生数据扩展。在实践中，更进一步，您可以不按
照输入概率的假定来设计编码，但压缩性能变差和数据扩展的风险会更大。
在式(8.1-2)中，当C小于1时。
就存在数据扩展。
为结束对Golomb编码的讨论，我们注意到，表8.5的第5列包含的表示为G(n)的第0阶指数
Golomb码的前10个码。指数Golomb编码对于行程编码很有用，因为短行程和长行程都可以有效地
编码。k阶指数Golomb编码G,(n)计算如下：
第8章 图 像压 缩 349
步骤1 寻找一个整数i,i≥0,使其满足
L2<n<22 (8.2-5)
并形成i的一元码。如果k=0,则i=[log?(n+1)],该编码也是周知的 Eliasgamma编码。
0.75
正
0.75 a b
0.60 0.60
0.45 0.45
概率
0.30 0.30
0.15 0.15
0
-4 -3 -2 -1 0 1234 0
012 3456 8
n-μ M(n-μ)
图8.11 (a)从图8.1(c)中图像的每个像素中减去平均灰度后该图
像的概率分布：(b)对图(a)使用式(8.2-4)得到的映射
步骤2 把二进制表示
n-22 (8.2-6)
截短到k+i个最低阶比特。
步骤3 连接步骤1和步骤2的结果。
例如，为求G(8),我们在步骤1中令i=[log?9]或3,因为k=0。然后，式(8.2-5)得到满足，
因为
22≤8<2
222<8<22
2°+21+22≤8<2°+21+22+23
7≤8<15
3的一元码是1110,步骤2中的式(8.2-6)产生
8-22=8-22/=8-(2°+2'+2)=8-7=1=001
当截短至其3+0个最低阶比特时，它变为001。连接步骤1和步骤2的结果得到1110001。注意，这
是n=8时表8.5中第4列的条目。最后，我们注意到，类似于上一节的霍夫曼编码，表8.5中的Golomb
编码是变长的、瞬时唯一可解码的块编码。 园
四
350 数字图像处理(第三版)
8.2.3 算术编码
与前两节的变长编码不同，算术编码生成的是非块码。算术编码可以追溯至 Elias 的研究工作(见
Abramson[1963]),信源符号和码字之间不存在一一对应的关系。相反，算术编码给信源符号(或消
息)的整个序列分配了一个单一的算术码字。这个码字本身定义了一个介于0和1之间的实数间隔。
当消息中的符号数量增加时，用于表示消息的间隔会变小，而表示该间隔所需的信息单位(假设为
比特)的数量则会变大。消息的每个符号根据其出现的概率来减小该区间的大小。因为这种技术不
要求像霍夫曼编码方法那样将每个信源符号转换成这些编码符号的整数(即每次对一个符号进行编
码),所以它(仅在理论上)达到了8.1.4节中的山农第一定理所设定的界限。
图8.12说明了算术编码的基本过程。这里，对来自一个四符号信源的五符号序列或消息a,aayaya?
进行编码。在编码处理的开始，假设消息占据整个半开区间(0.1)。如表8.6所示，该区间开始时根据
每个信源符号出现的概率被分为4个区域。例如，符号a?与子区间(0,0.2)相联系。因为它是被编码
的消息的第一个符号，所以该消息间隔开始时被缩窄为(0,0.2)。这样，在图8.12中，区间(0,0.2)就
被扩展到该图形的全高度，且其端点用该窄区间的值来标注。然后，这个缩窄的区间根据原始信源符
号的概率进行细分，并继续对下一个消息符号进行这种处理。采用这种方式，符号 a?将该子区间变
窄为(0.04,0.08),符号a;进一步将该子区间变窄为(0.056.0.072),依次类推。必须保留最后的消息符
号，以作为特定的消息结束指示符，它将子区间变窄为[0.06752,0.068 8]。当然，在这个子区间内的
任何数字(如0.068)都可以用来表示该消息。
编码序列—→
a a a a a2
1- 0.2 0.08- 0.072 0.0688
a a4 a4 a a4
0.06752
a a a a3 a
a2 a2 a2 a2 a2
a: a1 a1 a a
0- 0 0.04 0.056 0.0624
图8.12 算术编码过程
在图8.12的算术编码的消息中，使用了3个十进制数字来
表示这个五符号消息。这就转换为每信源符号0.6个十进制数字， 表8.6 算术编码示例
而由式(8.1-6),与之相比的信源的熵为每个信源符号0.58个十进
制数字。当被编码的序列的长度增加时，得到的算术编码接近山
信源符号 概 率 初始子区间
a 0.2
0.2
0.4
0.2
(0.0,0.2)
农第一定理所设定的界限。实际上，有两个因素会使得编码性能
无法达到这一界限：(1)为了将一个消息与其他消息分开，增加
了消息结束指示符：(2)所用算法的精度是有限的。算术编码的
a 102,0.4)
a, (0.4,0.8)
a (08,1.0)
实际实现通过引人一种缩放策略和一种舍入策略解决第二个问题(Langdon and Rissanen[1981])。缩放策
略是在根据符号出现的概率细分每个子区间之前，将每个子区间重新归一化到区间[0.1]。舍人策略则
保证根据算法的有限精度进行截短，不会防碍被编码子区间的准确表示。
第8章 图 像压 缩 351
自适应上下文相关的概率估计
使用精确的输人符号概率模型，也就是，提供被编码符号的真实概率的模型，算术编码器在要
求表示被编码符号平均码字符号数最小的情形下是最佳的。然而，像霍夫曼编码和Golomb编码那样，
不精确的概率模型可导致非最佳结果。改进所采用概率精确性的一种简单方法是使用自适应的、上下
文相关的概率模型。自适应概率模型像符号已被编码或变得已知那样更新符号的概率。这样，概率就
适应被编码符号的局部统计。上下文相关的模型提供了概率，该概率基于被编码符号周围的预定义的
邻域像素——称为上下文。通常使用因果关系的上下文，即限制已被编码的符号。Q编码器(Pennebaker
et al.[1988])和MQ 编码器(ISO/IEC[2000])两个周知的算术编码技术使用了自适应和上下文相关的概
率模型，它们已引入到JBIG、JPEG-2000和其他重要图像压缩标准中。Q 编码器在区间重新归一化
期间动态地更新符号概率，这是算术编码处理的一部分。Golomb 编码中也使用了自适应上下文相关
模型，例如，在JPEG-LS压缩标准中。
bed 为当前上下文更新概率
输入
符号 上下文确定 概率估计 算术编码 编码
比特 符号和
上下文 符号概率
上下文 上下文 上下文
La d
al hg T edCbla e 6 i
正被编码的符号 正被编码的符号 正被编码的符号
图8.13(a)自适应上下文相关的算术编码方法(通常用于二值信源符号);(b)-(d)三种可能的上下文模型
图8.13(a)给出了二值信源符号的自适应上下文相关算术编码包括的步骤。当对二值符号编码时，
通常使用算术编码。当对每个符号(或比特)开始编码过程时，其上下文由图8.13(a)中的上下文决定
模块形成。图8.13(b)到(d)显示了3种可被使用的上下文：(1)前一符号；(2)前一组符号；(3)前一
些符号加上前一扫描行上的符号。对所示的三种情况，概率估计模块必须管理2'(或2)个、2?(或256)
个和2?(或32)个上下文及与它们相联系的概率。例如，如果使用了图8.13(b)中的上下文，就必须跟踪
传统的概率P(Ola=0)(被编码符号为0的概率给出了前一符号为0)、P(lla=0)、P(Ou=1)和P(lla=1)。
然后，将合适的概率作为当前上下文的函数传到算术编码模块，并根据图8.12中说明的过程，产生
算术编码输出序列。然后，更新包含在当前编码步骤中的相联系的概率，以反映该上下文中另一个符
号已被处理的事实。
最后，我们注意到许多算术编码技术受美国专利的保护(可能还受其他法律保护)。因为侵害这
些专利可能导致高额罚款，包含有霍夫曼编码和算术编码选项的JPEG 标准的多数实现，通常仅支持
霍夫曼编码。
参考表83和表84.LZW编码用
于GIF、TIFF和PDF 文件格式，但
前几节中所覆盖的技术集中在消除编码冗余上。在这一节中，我 不用于任何国际压缩标准批准的文
件格式
们考虑一种致力于图像中的空间冗余的无误差压缩方法。称为
Lempel-Ziv-Welch(LZW)编码的这种技术将定长码字分配给变长信源符号序列。回忆8.1.4节，在第一
8.2.4 LZW编码
n-5
:至
352 数字图像处理(第三版)
定理的证明中，山农使用了信源符号编码序列这一思想，而不是单个信源符号。LZW 编码的关键特
点是它不需要被编码符号出现的概率的先验知识。尽管直到现在这种压缩技术还在美国专利的保护之
下，但LZW压缩技术已被引入许多主流图像文件格式中，包括GIF、TIFF和PDF等。创建PNG格
式得到了LZW许可。
例8.6 图8.9(a)的LZW编码。
再次考虑图8.9(a)中大小为512×512的8比特图像。使用Adobe Photoshop,该图像的未压缩TIFF
版本要求286 740字节的磁盘空间——对512×512的8比特像素加上24596字节的头文件需要262144
字节。然而，用TIFF的LZW压缩选项得到的文件大小为224 420字节。压缩率是C=1.28。回忆例8.4中
图8.9(a)的霍夫曼编码表示，C=1.077。由LZW方法实现的额外压缩是由于消除了图像的某些空间冗余。
LZW编码在概念上非常简单(Welch[1984])。在编码过程的开始阶段，先构建一个包含被编码
信源符号的码书或字典。对于8比特单色图像，字典中的前256个字被分配给灰度值0.1,2,…,255。
当编码器顺序地分析图像像素时，不在字典中的灰度序列被放置在算法确定的位置(即下一个未用
的位置)。例如，如果图像的前两个像素为白色，则序列“255-255”可能被分配到256的位置，该
位置后面的地址保留给灰度级0到255。下次遇到两个连续的白色像素时，就用码字256——即包
含序列255-255的位置的地址—-来表示它们。如果在编码过程中采用一个9比特、512字的字典，
则最初用于表示这两个像素的(8+8)比特被单个9比特码字替代。很明显，字典的大小是一个很重
要的系统参数。如果字典太小，则匹配灰度级序列的检测将变得不太可能；如果字典太大，则码字
的大小反而会影响压缩性能。
例8.7 LZW编码。
考虑下列大小为4×4的8比特垂直边缘图像：
39 39 126 126
39 39 126 126
3939 126 126
3939 126126
表8.7中详细给出了对其16个像素进行编码的步骤。假设一个512字带有下列初始内容的字典：
字 典位置 条目
0 0
1 1
255 255
256
511
位置256到511开始时未使用。
图像按从左到右、从上到下处理其像素的方法来进行编码。每个连续的灰度值与表8.7中称之为“当
前可识别的序列”的第1列的一个变量链接。就像我们能看到的那样，该变量最初为空。对每一个链
接的序列搜索字典，如果找到了，如表中第一行的情况，则用新链接且可识别的序列(即位于字典中的序
列)替代它。这可在第2行的第1列中实现。这既不产生输出代码，也不更改字典。然而，如果没有找到
链接的序列，则将当前可识别序列的地址作为下一个编码值输出，并将链接但不可识别的序列添加到字
典中，当前可识别的序列则初始化为当前的像素值。这出现在表中的第2行。最后两列详细给出了扫描整
第8章 图 像压 缩 353
个4×4图像时添加到了字典中的灰度序列。定义了9个附加的码字。编码结束时，字典包含256个码字，
且LZW算法成功地识别了几个重复的灰度序列——平衡它们将128比特的原图像降到了90比特(即10个
9比特码)。从上到下读取第3列即可得到编码输出。得到的压缩率是1.42:1。
表8.7 LZW编码示例
当前可识别的序列 正被处理的像素 编码后的输出 字典位置(码字)
39
39
126
126
39
39
126
126
39
39
126
126
39
39
126
126
39
39
126
126
貌
257
126
256
257 258
259
260
261
262
263
264
259
字 典词条
39 39-39
39 39-126
126 126-126
126 126-39
39
39-39 39-39-126
126
126-126 126-126-39
39
39-39
39-39-126
126
126-39
39-39-126-126
126-39-39
39
39-126 39-126-126
126
刚刚示范的LZW 编码的一个独特的特点是，编码字典或码书是在对数据进行编码的同时创建
的。很明显，在LZW解码器对编码数据流进行解码的同时建立一个同样的解压缩字典。作为练习(见
习题8.20),请读者对上例的输出进行解码，并重建该码书。尽管在该例中不需要，但多数实际应用
都需要一种处理字典溢出的策略。一种简单的解决办法是，当字典已满时，刷新或重新初始化该字典，
并使用一个新初始化后的字典继续编码。另一种复杂的选择是，监控压缩性能，并在性能变得低下或
不可接受时刷新字典。此外，需要时，可跟踪并替换那些使用最少的字典词条。
8.2.5 行程编码
像8.1.2节中解释的那样，沿其行(或列)重复灰度的图像，通常可
用相同灰度的行程表示为行程对来压缩，其中每个行程对指定一个新
灰度的开始和具有该灰度的连续像素的数量。这种称为行程编码的技
术，是20世纪50年代发展起来的，连同其二维扩展一起，已成为传
参考表83和表84,行程编码用
于CCITT、JBIG2.JPEG、M-JPEG.
MPEG-1,2.4、BMP 和其他压缩标
准与文件格式中。
真编码标准的压缩方法。压缩是通过消除空间冗余的一种简单形式(即一组相同的灰度)来实现的。当
相同像素的行程较小(或没有)时，行程编码会导致数据扩展。
例8.8 BMP文件格式中的RLE。
BMP 文件格式使用行程编码的一种形式，其中图像数据以两种不同的模式来表示：编码和绝对值，
任何一种模式在图像的任何地方都会出现。在编码模式中，用两个字节 RLE 表示。第一个字节规定了连
续像素的数目，它有包含在第二个字节中的彩色索引。8比特彩色索引从256种可能的灰度表中选择该行
程的灰度(彩色或灰度值)。
在绝对值模式中，第一个字节是0,第二个字节通知4个可能的条件之一，如表8.8所示。当第二个字
节是0或1时，就到达了一行或一幅图像的末尾。如果第二个字节是2,则下两个字节包含相对图像中一个新
空间位置的无符号水平偏移和垂直偏移。如果第二个字节在3和255之间，则它指定了非压缩像素的数量一
一紧跟着包含有一个像素的彩色索引的每个后续的字节。总字节数必须与一个16比特字的边界来排列。 5·5
55
354 数字图像处理(第三版)
压缩率C为0.98.没有足够的使得行程压缩有效的相等灰度的行程，发
生了少量的扩展。然而，对于图8.1(c)中的图像，BMP的RLE选项得到
图8.9(a)中所示的512×512×8比特图像的未压缩 BMP文件(使用Photoshop 存储)要求263 244字节
的存储空间。使用BMP的RLE选项压缩后，文件扩展为267 706字节， 注意，由于开销的不同，在例8.7
中，未压缩的 BMP文件小于未压缩
的TIFF文件。
的压缩率是C=1.35。
压缩二值图像时，行程编码特别有效。因为仅有两种
可能的灰度(黑和白),所以邻近像素的灰度更可能是相同
的。另外，每一图像行可仅用长度序列来表示，而不是例
表8.8 BMP绝对值编码模式选项。在这种
模式中，BMP对的第一个字节为0
8.8 中所用的长度、灰度对。其基本概念是，对从左到右扫
描一行时所遇到的1或0的每一个连续组，使用这些连续
组的长度进行编码，并且建立决定行程值的约定。最通常
第二个字节值 条 件
0 行尾
1 图像尾
2 移到一个新位置 的约定是：(1)指定每一行的第一个行程的值，或(2)假设
每一行从一个白色行程开始，其行程事实上可能是零。 3-255 逐个指定像素
尽管行程编码本身是一种压缩二值图像的有效方法，但对行程本身进行变长编码可以实现额外
的压缩。黑和白行程可个别地进行编码，这些变长编码是根据它们自身的统计数据特殊制定的。例如，
令符号a,表示一个长度为j的黑色行程，我们可以估计由一个假想的黑色行程长度信源发出的符号a,
的概率，它等于整个图像中长度为j的黑色行程数除以黑色行程总数。这个黑色行程信源的熵的估计
表示为H?,然后，将这些概率代入式(8.1-6)。对于白色行程的熵有类似的结论，表示为H?。该图像
的近似行程熵为
Hm=A+A (8.2-7)
其中，变量L和L?分别表示黑色行程和白色行程的平均值。式(8.2.7)提供了对二值图像的行程使用
变长编码时所要求的每像素平均比特数的估计。
两种最古老且应用最广的二值图像压缩标准是CCITT Group 3和4标准。虽然它们已被用于各
种计算机应用中，但它们最初还是针对电话网传输文件而设计的传真编码方法。Group 3标准使用一
维行程编码技术，其中，每组K行(K=2或4)中的最后K-1行可随意地以一种二维编码方法来编码。
Group 4标准是Group 3标准的一种简化或改进版本，该标准中只允许进行二维编码。两个标准都使
用同一种二维编码方法，从用前一行的信息对当前行进行编码的意义上看，这种方法是二维的。下面
讨论一维编码和二维编码。
一维CCITT压缩
在一维CCITT Group 3压缩标准中，一幅图像的每一行被编码为一系列变长霍夫曼码字，在从
左到右对该行的扫描中，这些码字表示交替的白色行程和黑色行程。采用的压缩方法通常称为改进的
霍夫曼(MH)编码方法。码字本身有两种类型，在该标准中分别称为终结码和补偿码。如果行程r小
于63,则使用来自附录A的表A.1中的终结码来表示它。注意，对于白色行程和黑色行程，该标准
规定了不同的终结码。如果r>63,则使用两种码—对商[r/64]使 回忆822节可知，符号Lx]表示 用补偿码，而对rmod 64的余数使用终结码。表A.2中列出了补偿码， 小于等于x的最大整数。
并且，这些补偿码可能依赖，也可能不依赖于被编码的行程的灰度(黑
或白)。如果[r/64]<1792,则规定分隔黑色行程和白色行程的补偿码；否则，补偿码是独立于行程
①在该标准中，图像称为页面，图像序列则称为文档。
第8章 图 像压 缩 355
灰度的。标准要求每一行以白色行程码字开始，事实上它可能是00110101,即长度为零的白色行程
的码字。最后，用一个唯一的行的结尾(EOL)码字000000000001来终止每一行，并对每幅新图像的
第一行发出信号。图像序列的结尾由6个连续的EOL来指出。
二维CCITT压缩
CCITT Group 3标准和CCITT Group 4标准采用的二维压缩方法是逐行方法，在这种方法中，对
每个黑到白或白到黑的行程转换的位置根据位于当前编码行上的参考元素a?的位置来编码。已编码
的前一行称为参考行；每幅新图像的第一行的参考行是一个虚构的白色行。所用的二维编码技术称为
相对元素地址指派(READ)编码。在Group 3标准中，相继的MH编码行间允许1个或3个READ编
码行，并且这种技术称为改进的READ(MR)编码。在Group 4标准中，允许较大数量的READ编码
行，这种方法称为改进的改进的REDA(MMR)编码。正如前面解释的那样，从使用来自前一行的信
息对当前行进行编码的意义上看，这种编码是二维的。不涉及二维变换。
图8.14说明了对单一扫描行的基本的二维编码过程。注意，该过程的初始几步指向几个关键的变
化元素的定位点处：a?,a,a?,b?和b?。标准把变化元素定义为一个像素，该像素的值不同于同一行上
前一个像素的值。最重要的变化元素是a。(参考元素),它不是每一个新编码行的第一个像素左侧的虚
构白色变化元素所置的位置，就是由前一种编码模式决定。编码模式在下一段讨论。a。被定位后，a
就可标识为当前编码行上a。右侧的下一个变化元素的位置，a.可标识为编码行上a?右侧的下一个变
化元素的位置，b?可标识为与a。具有相反值的变化元素，并在参考行(或前一行)上a?的右侧，b?作
为下一个变化元素可标识为参考行上 b?的右侧。如果这些变化元素中的任意一个都没有被检测到，
则把它们放到一个合适的行上最后一个像素右侧的一个虚构像素的位置。图8.15提供了各个变化元素
间的通常关系的两个说明。
当前参考元素和相关的变化元素标识出来之后，执行两个简单的测试，以便选择三种可能的编
码模式中的一个：通过模式、垂直模式和水平模式。初始测试对应于图8.14流程图的第一个分支点，
比较b?和a,的位置。第二个测试，对应于图8.14中的第二个分支点，计算a,的位置和b?的位置之间
的距离(以像素计算),并与3进行比较。然后，依照这些测试的结果，将测试结果输入到图8.14中的
对应编码框图中，并执行合适的编码过程。这样，对于每个流程图，建立了一个新的参考元素，为下
一次编码反复做好准备。
表8.9对三种可能的编码模式定义了指定用途的编码。在通过模式中，特别排除了b?直接在a?之
上的情况，仅需要通过模式码字0001。如图8.15(a)所示，该模式可识别与当前白或黑编码行行程不
重叠的白或黑参考行行程。在水平编码模式中，从a?到a,的距离和从a?到a?的距离必须根据附录A
中的表A.1和表A.2的终结码和补偿码来编码，然后，添加到水平模式码字001上。这在表8.9中由
符号001+M(a?a)+M(a?a?)指出，其中a?a?和a?a?分别表示从a?到a,的距离和从a?到a?的距离。最
后，在垂直编码模式中，6个特殊变长码之一分配给了a?和b?之间的距离。图8.15(b)说明了水平
模式和垂直模式编码中包含的参数。表8.9底部的扩展模式码字用于加入一种可选的传真编码模式。
例如，0000001111码被用于启动一种传输的非压缩模式。
例8.9 CCITT垂直模式编码实例。
虽然图8.15(b)对水平和垂直模式编码的参数做了注释(有助于上面的讨论),但描述的黑像素和白像
素模式是垂直模式编码的一种情况。也就是说，因为b?在a,的右侧，图8.14中的第一个(或通过模式)测
试失败了，确定是引入垂直模式还是水平模式的第二次测试指出应使用垂直模式编码，因为从a,到b?的
距离小于3。根据表8.9,合适的码字是000010,这意味着a,是b?左侧的两个像素。在下一次编码反复的
准备中，a?被移到a,的位置。 图:
退园
数字图像处理(第三版)
开始新编码行
在第一个
像素前置a?
检测a
检测b,
检测b?
否 b?在a?的左侧
是 la?b?l≤3 是
否，
检测a?
通过模式编码 水平模式编码
将a,置于b?下方 将a置于a?上
行尾? 否
是
编码行结尾
图8.14 CCITT二维READ编码过程。符号la,b,l表示变化元素a?和b?间距离的绝对值
表8.9 CCITT二维编码表
模 式
垂直模式编码
将a,置于a,上
码 字 模 式 码 字
通过 0001
001+M(aa,)+M(a,a)
1
011
000011
a,是b,右侧的3个像素
a,是b?左侧的1个像素
a,是b,左侧的2个像素
a是b,左侧的3个像素
扩展
0000011
水平 010
垂直 000010
a,在b,下方 0000010
a,是b,右侧的1个像素 0000001xxx
a,是b,右侧的2个像素
例8.10 CCITT压缩实例。
图8.16(a)是以大约1/3大小显示的7×9.25英寸书页的300 dpi扫描图像。注意，该页约有一半包含
正文，半色调图像约占9其余为空白。图8.16(b)是被放大的书页的一部分。记住，我们处理的是二
356
第8章 图 像压 缩 357
值图像；如4.5.4节描述的那样，在打印时使用半色调处理方法创建了灰色调的幻影。如果图8.16(a)中图
像的二值像素以每字节8像素组的形式存储，则通常称为文档的 不要将此处使用的 PDF(便携文档
格式)与前几节及前几章中表示概率 1952×2697比特扫描图像需要658 068字节。该文档的非压缩PDF文件(由
Photoshop 创建)需要663 445字节。CCrTT Group 3压缩可将该文件减少 密度函数的PDF混淆。
到123497字节，得到的压缩率为C=5.37;CCITT Group4压缩将该文件减少到110456字节，压缩率约
增加到6。
b
a 参考行 b? b?
编码行 下一个a- a 通过模式
垂直模式
参考行 ab? b? b?
编码行 a: 2
aa; a1a?-
水平模式
图8.15 CCITT(a)通过模式和(b)垂直与水平编码模式编码参数
a b
r N=4.Tl
sn 三ttu
hal n
e
图8.16 书页的二值扫描图像：(a)显示整页内容的缩小图像；(b)在抖动中用于显示二值像素的放大图像
8.2.6 基于符号的编码
在基于符号或基于记号的编码中，一幅图像被表示为多幅频繁发生的子图像的一个集合，称为
符号。每一个这样的符号都存储在一个符号字典中，且该图像以一个 参考表8.3和表8.4、基于符号的
三元组(x?,y,t),(x?y?h),…}的集合来编码，其中，每个(x,y)对规 编码用于JBIG2压缩中
定了图像中一个符号的位置，而记号t,是该符号或子图像在字典中的地址。也就是说，每一个三元组 居;国
358 数字图像处理(第三版)
表示图像中一个字典符号的一个实例。通过仅存储一次重复的符号，可以有效地压缩图像通，特别是
在文档存储和检索应用中，在这种情况下，符号通常是重复多次的字符位图。
考虑图8.17(a)中简单的两级灰度图像。它包含一个字banana,该字由三个单一符号 a bn组成：
3个a、1个b和2个n。假如b是在编码过程中第一个识别的符号，其9×7位图存储在符号字典中的
位置0内。如图8.17(b)所示，识别b位图的记号是0。这样，在编码后的图像表示中，第一个三元组
是(0,2.0)[见图8.17(c)].它指出表示b符号的矩形位图的左上角在解码图像中被放在了位置(0,2)
处。对于a和n符号的位图被识别之后加到字典上，图像的其余部分可使用5个附加的三元组编码。
只要用于定位图像中的符号的6个三元组及定义它们的3个位图小于原图像就可实现压缩。在这种情况
下，起始图像有9×51×1或459比特，假定每个三元组由3个字节组成，压缩后的表示有(6×3×8)+[(9×7)+
(6×7)+(6×6)]或285比特；得到的压缩率为C=1.61。为对图8.17(c)中基于符号的表示解码，您可以
从符号字典中读取以三元组形式规定的符号位图，并将它们放置在每个三元组指定的空间坐标处。
基于符号的压缩早在20世纪70年代就已被提出来了(Ascher and Nagy[1974]),但只是近年来才
变为实用。符号匹配算法(见第12章)的提升和计算机CPU处理速度的提高，使得及时选取字典符号
并找到它们在图像中的位置成为可能。像许多其他压缩方法一样，基于符号的解码远快于编码。最后，
我们注意到，存储在字典中的符号位图和用于参考的三元组本身也可被编码，以进一步改进压缩性能。
如果像在图8.17中那样仅允许精确的符号匹配，得到的压缩是无损的；如果允许较小的差别，将出现
一定水平的重建误差。
函:
a bc
图8.17 (a)两灰度级文档；(b)符号字典；(c)在文档中用于定位符号的三元组
JBIG2压缩
JBIG2是一个针对二级图像压缩的国际标准。通过将一幅图像分割成正文、半色调和普通内容的
重叠和/或不重叠区域，针对每种类型的内容采用特定的最佳压缩技术：
●对于字符组成的正文区域，基于符号的编码方法最适合它们。典型地，每个符号将对应一个
字符位图，即表示一个正文字符的子图像。对于每种所采用字体的每个大写和小写字符，在
符号字典中通常仅有一个字符位图(或子图像)。例如，在字典中只有一个“a”位图、一个“A”
位图、一个“b”位图，等等。
在有损JBIG2压缩中，通常称为感知无损或视觉无损的JBIG2,我们忽略字典位图(即引
用字符位图或字符模板)和图像中相应字符的特例之间的差别。在无损压缩中，这一差别被存
储，并与三元组联合对每个字符进行编码(由解码器实现),以产生实际的图像位图。所有的
位图不是用算术编码，就是用MMR(见8.2.5节)来编码；用于访问字典条目的三元组不是用
算术编码，就是用霍夫曼码来编码。
●半色调区域类似于正文区域，它们由按规则网格排列的模式组成。然而，存储在字典中的符
标记 符号
0
1 a
三元组
(0.2.0)
(3.10.1)
(3,18.2)
(3.34.2)
(3.42.1)
(3.26,1)
2
第8章 图 像压 缩 359
号不是字符位图，而是表示灰度的周期模式(即一个图形),其已通过抖动来产生用于打印的
两灰度级图像。
● 普通区域包含非正文、非半色调信息，类似于工艺线条和噪声，这种区域不是用算术编码方
法来压缩，就是用MMR编码方法来压缩。
如许多图像压缩标准那样，JBIG2定义了解码器特性。它确实没有明确地定义一个标准的编码器，
但其灵活性足以允许设计各种编码器。虽然编码器的设计处在未确定状态，但它仍然是很重要的，因
为它决定了可能达到的压缩水平。毕竟，编码器必须把图像分割成多个区域，选择存储在字典中的正
文和半色调符号，并确定这些符号与图像中符号潜在的情况本质上是相同还是不同。解码器简单地使
用这些信息来重建原图像。
例8.11 JBIG2压缩实例。
再次考虑图8.16(a)中的二级灰度图像。图8.18(a)显示了(一个商用文档压缩应用)对该图像进行无
损JBIG2 编码压缩后的一个重建部分。它是原图像的精确复制。注意，在重建文本中，d有轻微变化，
尽管它们是由字典中相同的d条目产生的。d和图像中的d间的差别被用于改善字典的输出。为在编码字
典位图的解码期间实现这一改善，标准定义了一个算法。针对我们的讨论目的，您可以把它想象为将字
典位图与图像中对应字符的特定实例间的差别加到从该字典读取的位图上。
图8.18(b)是图8.18(a)中的经感知上无损JBIG2压缩后的区域的另一个重建。注意，该图中的d是
相同的。它们是直接从符号字典中复制的。称该重建为感知无损的原因是文本是可读的，甚至字体也相
同。我们认为如图8.18(c)所示的原图像中的d和字典中的d之间的小的差别并不重要，因为它们并不影
响可读性。记住，我们处理的是二级灰度图像，故图8.18(c)中只有三个灰度。灰度128 指出图8.18(a)
和图8.18(b)中图像对应像素间不存在差别的区域；灰度0(黑)和灰度255(白)指出两幅图像中相对灰度
的像素，例如，一幅图像中的一个黑像素，在另一幅图像中是白像素，反之亦然。
a bcs~ s~~
just described just described
esulting coeffic esulting coeffic
nt arrays. nt arrays.
1S8
T
retained coeffi retained coeffi
n we disrepar sn we disrepar 工Wa
图8.18 JBIG2压缩比较：(a)无损压缩与重建；(b)感知无损压缩；(c)两种压缩程度的差值
用于产生图8.18(a)的无损JBIG2压缩，将无压缩原PDF图像的字节数由663445减少到了32705;
压缩率为C=20.3。感知无损JBIG2压缩则将原图像的字节数减少到了23 913字节，压缩率提高到了约
27.7。这些压缩比CCITT Group 3和CCITT Group 4从例8.10得到的结果高4~5倍。
8.2.7 比特平面编码
前几节讨论的行程编码技术和基于符号的编码技术可通过单独处 参考表83和表84.比特平面编码 理图像的比特平面的方法用于多于两级灰度的图像。称为比特平面编 用于JBIGI.JPEG-2000压缩标准中 码的这种技术基于如下概念：把一幅多级(单色或彩色)图像分解为一
系列二值图像(见3.2.4节),并使用几种熟知的二值压缩方法之一来压缩每幅二值图像。本节描述两
种最普遍的分解方法。 5：5
360 数字图像处理(第三版)
一幅m比特单色图像的灰度可以用如下形式的基2的多项式来表示：
am-12"?1+am-22"?2+…+a,21+a?2° (8.2-8)
基于这种特性，将该图像分解为二值图像集的一种简单方法是把该多项式的m个系数分离为m个1比
特的比特平面。正如3.2.4节中解释的那样，最低阶比特平面(对应最低阶比特的平面)是通过收集每个
像素的a?比特生成的，而最高阶比特平面包含a,比特或系数。一般来讲，每个比特平面都由给其像
素置一个来自原始图像每一像素的合适的比特值或多项式系数来重建。这种分解方法的固有缺点是灰
度的较小变化会对比特平面的复杂性产生显著的影响。例如，如果一个灰度为127(01111111)的像素与
一个灰度为128(10000000)的像素相邻，每个比特平面将包含一个对应0到1(或1到0)的转换。譬如，
因为127和128的二进制码的最高阶比特不同，所以最高比特平面将包含一个与值为1的像素相邻的
零值像素，在该点产生一个0到1(或1到0)的转换。
一种可替代的分解方法(降低较小灰度变化带来的影响)是首先用一个m比特格雷码表示图像。
对应于式(8.2-8)中多项式的m比特格雷编码8m-1…82B18。可由下式计算得到：
罔:
8,=a田a+,0≤≤m-2 (8.2-9) 8m-1=am-1
式中，田表示异或运算。这种编码的唯一特性是连续码字只有1个比特位不同。因此，较小的灰度
变化不太可能影响所有m个比特平面。例如，当灰度级127和128相邻时，只有最高阶比特平面包
含有一个0到1的转换，因为对应于127和128的格雷码分别是01000000和11000000。
例8.12 比特平面编码。
图8.19和图8.20显示了图8.19(a)中小孩的8比特单色图像的8个二进制码和格雷码的比特平面。
注意，高阶比特平面与其对应的低阶比特平面相比要简单得多。也就是说，这些比特平面中包含有较大
的均匀区域，其中的图像细节、杂乱性或随机性都较少。另外，格雷码比特平面比对应的二进制比特平
面复杂性要小。表8.10中的JBIG2编码结果反映了这两种观察。注意，例如，a?和g,的压缩结果要比a?
和g。压缩的结果大得多；而gs和g的压缩结果要比a,和a?压缩的结果小。这一倾向贯穿表的始终，只
有a?例外。格雷编码提供了平均约1.06:1的压缩优势。结合在一起，格雷编码文件以678676/475864或
1.4:1的比率压缩原始的单色图像；非格雷编码的文件以678676/503916或1.35:1的比率压缩该图像。
a bc d ef g h
所有
比特
图8.19(a)一幅256比特单色图像；(b)~(h)图(a)中图像的4个最高有效二进制编码和格雷编码比特平面
第8章 图 像压 缩 361
a b c d e fgh
图8.20(a)-(h)图8.19(a)中图像的4个最低有效二进制编码(左列)和格雷编码(右列)比特平面
表8.10 图8.19(a)的二进制编码和格雷编码比特平面的JBIG2无损编码结果
系数m 二进制编码(PDF,比特) 格雷编码(PDF,比特)
6999
12791
40104
55911
78915
101535
107909
99753
6999
11.024
36914
47415
67787
92630
105286
107909
压缩率
7 1.00
6 1.16
5 1.09
4 1.18
3 1.16
2 1.10
1 1.03
0 0.92
最后，我们注意到图8.20中的两个最低阶比特很少有明显的结构。因为这是多数8比特单色图像的
典型特点，比特平面编码通常限于6比特/像素或更少比特/像素的图像。原有的JBIG1到JBIG2都强加了
这样的限制。
8.2.8 块变换编码
在这一节，我们考虑一种压缩技术，该技术把图像分成大小相等(如
8×8)且不重叠的小块，并使用二维变换单独地处理这些块。在块变换
编码中，用一种可逆线性变换(如傅里叶变换)把每个块或子图像映射为
变换系数集合，然后，对这些变换系数进行量化和编码。对于大多数图
像，大量系数都有较小的幅度值，并且可被粗糙地量化(或完全抛弃)而几乎没有多少图像失真。包括第4
章介绍的离散傅里叶变换在内的各种变换都可用于变换图像数据。
图8.21显示了一个典型的块变换编码系统。解码器执行(除了量化功能外)与编码器相反顺序的步
骤。编码器执行4种相对简单的操作：子图像分解、变换、量化和编码。一幅大小为M×N的输入图
像首先被分解为大小为n×n的子图像，然后变换这些子图以生成MN/n2个子图像变换阵列，每个阵
列的大小为n×n。变换处理的目的是对每幅子图像中的像素进行去相 在本节中，我们重点关注(最常用 关，或用最少数量的变换系数包含尽可能多的信息。然后，在量化阶 的)方形子图像。如果需要，我们假
段，以一种预定义的方式有选择性地消除或更粗略地量化那些携带最 设已对输入图像进行了零填充，以
少信息的系数(本节稍后会讨论一些方法)。这些系数对重建的子图像 便M和N均是n的倍数
参考表83和表84,块变换编码
H.261,H262,H.263.H264、DV和
用于JPEG,M-JPEG、MPEG-1,2,4、
HDV.VC-1及基本压缩标准中
密:
密：离
362 数字图像处理(第三版)
质量的影响最小。通过对量化后的系数进行编码(通常使用变长编码)结束编码过程。任何或所有的变
换编码步骤都可以根据局部图像内容进行适应性调整，这称为自适应变换编码，而如果这些步骤对所
有子图像都是固定的，则称为非自适应变换编码。
a
b 输入图像-
构建大小为
A×n
的多幅子图像
正变换 量化器 符号编码器→压缩后的图像
(M×N)
压缩后的图像- 符号解码器 反变换 合并大小为
n×n
的多幅图像
解压缩后的图像
图8.21 块变换编码系统：(a)编码器；(b)解码器
变换的选择
人们已构建和/或广泛研究了基于各种二维离散变换的块变换编码系统。在给定的应用中，特定
变换的选择取决于可容忍的重建误差的大小和可用的计算资源。压缩是在对变换系数的量化期间(而
不是变换步骤期间)实现的。 我们使用g(r.y)来区分来自输入
参照2.6.7节的讨论，考虑大小为nxn的子图像g(x,y),其离散 图像f(r,y)的子图像。这样，求和
限就变成了n而不是M和N 变换T(u,v)可表示为如下的一般关系：
ro.)=228(x,yr(x,y,u) (8.2-10)
其中，u,v=0,1,2,…,n-1。给定T(u,v),可以使用一般的离散反变换得到g(x,y):
8(x,y=2Zru, ystx,y,m) (8.2-11)
其中，x,y=0,1,2,…,n-1。在这些公式中，rx,y,u,v)和s(x,y,u,v)分别称为正变换核和反变换核。
在本节后面将会很清楚，它们也称为基函数或基图像。式(8.2-10)中的T(u,v),u,v=0.1,2,…,n-1称
为变换系数；这些系数可以看成是g(x,y)关于基函数s(x,y,u,vV)的一系列展开的展开系数(见7.2.1节)。
如2.6.7节说明的那样，如果
r(x,y,u.v)=r(x,u)?(y.v) (8.2-12)
则式(8.2-10)中的核是可分的；此外，如果r?在函数意义上等于r?,则核是对称的。在这种情况下，
式(8.2-12)可表示为
r(x,y,u,V)=r(x,u)(y,v) (8.2-13)
如果式(8.2-12)和式(8.2-13)中的r(x,y,u,v)用s(x,y,u,v)代替，则对反变换核也有相同的结论。按
4.11.1节解释的方式，证明具有可分核的二维变换可使用相应一维变换的行-列或列-行操作来计算并
不困难。
式(8.2-10)中的正变换核和式(8.2-11)中的反变换核决定了所计算的变换的类型和总体计算的复
杂性，以及所采用块变换编码系统的重建误差。最知名的一对变换核是
r(x,y,u,v)=e-J2(ux+y)/m (8.2-14)
和
s(x,y.u,)=1e (8.2-15)
第8章 图 像压 缩 363
其中j=√-1。它们是第2章中式(2.6-34)和式(2.6-35)在M=N=n
时定义的变换核。把这些变换核代入式(8.2-10)和式(8.2-11),可得到 f(x.y)而非一幅子图像的WHT.可
为计算大小为N×N的输入图像
4.5.5节中介绍的离散傅里叶变换对的一种简化形式。 在式(82-16)中将n更改为N
变换编码中很有用且计算上较简单的一种变换称为Walsh Hadamard 变换(WHT)。这种变换是根据下列功能上相同的核推导而来的：
H,y,u,)=(x.,u=-(-m2on (8.2-16)
其中n=2"。该式中的指数和是以模2算术方式执行的，而b(z)是z的二进制表示中的第k位(从右
到左)。例如，如果m=3且z=6(二进制值为110),则b?(z)=0,b?(z)=1,b?(z)=1。式(8.2-16)中的p(u)
使用下式计算：
Po(u)=bm-i(u)
p?(u)=bm-|(u)+bm-2(u)
(8.2-17) P?(u)=bm-2(u)+bm-3(4)
Pm-1(u)=b(u)+b?(u)
如前面提到的那样，式中的求和是以模2算术运算执行的。
类似的表达式可用于p(v)。
0 L 2
。
不像DFT的核，DFT的核是正弦函数和余弦函数的和
[见式(8.2-14)和式(8.2-15)],Walsh-Hadamard 核由棋盘模
式交替排列的+1和-1组成。图8.22显示了n=4时的核。
每个块由4×4=16个元素(子方块)组成。白色表示+1而黑
色表示-1。为得到左上角的块，我们令u=v=0,并画出x,y= 2
0.1.2,3时r(x,y,0.0)的值。在这种情况下，所有的值均为
3
在式(8.2-18)和式(8.2-19)中将n更
改为N
的值均为+1或-1。 为计算大小为N×N的输人图像
图像压缩中最常使用的 f(x,y)面非一幅子图像的 DCT.可
图8.22 n=4时的Walsh-Hadamard基函
数。每个块的原点均位于其左上角
变换之一是离散余弦变换(DCT)。这种变换是通过将如下(相等的)核
代入式(8.2-10)和式(8.2-11)中得到的：
Mx,y,.u,=(x,ya,)=auc(vyc(tl[2zJm] (8.2-18)
其中，
a-r.-12-- (8.2-19)
对于a(v)也类似。图8.23显示了n=4时的rx,y,u,v)。计算遵循图8.22说明的相同格式，不同之处
是r的值不是整数。在图8.23中，较亮的灰度值对应于较大的r值。
+1。顶部行中的第二个块是r(x,y,0.1)在x,y=0.1,2.3时
的值的图形，依此类推。正如我们已经说明的那样，Walsh Hadamard 变换的重要性在于它实现上的简单性——所有核
医固
364 数字图像处理(第三版)
器
0 2
例8.13 用DFT、WHT和DCT的块变换编码。
图8.24(a)到(c)显示了图8.9(a)中大小为512x512的单色图
像的三种近似。这些图像是按如下方式得到的：先将原图像分割
为大小为8×8的子图像，并用刚才描述的变换之一(即DFT、WHT
或DCT变换)来表示每一幅子图像，然后截去所得系数的50%,
再对截尾后的系数阵列进行反变换。
在每种情况下，保留下来的32个系数都是根据最大幅值选
择的。注意，在所有情况下，32个被丢弃的系数在重建图像质
量方面几乎没有视觉影响。然而，它们的消除伴随着一些均方
根误差，这一点可在图8.24(d)到(f所示的误差图像中看到。实
际的均方根误差分别是2.32,1.78和1.13个灰度级。
图8.23 n=4时的离散余弦基函数。每
个块的原点均位于其左上角
a b c d ef
图8.24(a)使用傅里叶变换得到的图8.9(a)的近似；(b)使用Walshi-Hadamard变换得到的
图8.9(a)的近似；(c)使用余弦变换得到的图8.9(a)的近似；(d)-(1对应的误差图像
前面的例子中提到的均方重建误差的较小差异是直接与能量或所用变换的信息包装的特性有关
的。根据式(8.2-11),大小为nxn的图像g(x,y)可以表示为其二维变换T(u,v)的函数：
(x,)=2Sru,pys(x,y.u) (8.2-20)
其中，x.y=0.1,…,2,n-1。由于式(8.2-20)中的反变换核s(x,y,u,v)仅取决于参数x,y,u,v,而不取
决于g(x,y)或T(u,v)的值，所以，该反变换核看成是由式(8.2-20)定义的序列所定义的一组基函数或
基图像。如果式(8.2-20)中所使用的符号进行如下修改，则这种解释会变得很清楚：
G=2STu S (8.2-21)
其中，G是一个包含g(x,y)的像素的、大小为nxn的矩阵，并且
s(0.1.u.V).s(0.n-1.u.V)
S(n-1,1,u.V)…s(n-1,n-1,u,v)
(8.2-22)
第8章 图 像压 缩 365
然后，包含输入子图像像素的矩阵G被明确定义为大小为nxn的n2个矩阵的线性组合，即式(8.2-22)
中的S,u,v=0,1,2,…,n-1。实际上，这些矩阵是式(8.2-20)中的级数展开的基图像(或函数);相
关的Tu,v)是展开系数。图8.22和图8.23图示地说明了n=4时的WHT和DCT基图像。
如果我们现在定义一个变换系数模板函数
xu.y-{: 若T(u,v)满足指定的截尾准则
其他 (8.2-23)
其中u,v=0,1,2,…,n-1,则G的一个近似可以根据截尾后的展开得到：
6=2Lxu vru.DS。 (8.2-24)
其中，x(u,v)是用消除公式(8.2-21)中的总和贡献最小的基图像构建的。子图像G及其近似G之间
的均方误差为
c=A/c-cf}=2zrm ns-22xa.ra ns.[} -L2a ns.D--2,D- (8.2-25)
式中，|G-G是矩阵(G-G)的范数，o,是变换位置(u,v)处系数的方差。最终的化简是以基图像
的归一化正交性质和G的像素是由零均值随机过程与已知协方差产生的这一假设为基础的。因此，总的
均方差近似误差是被丢弃的变换系数的方差之和，也就是，x(u,v)=0以便式(8.2-25)中的[1-x(u,v)]
为1的那些变换系数。将最多的信息重新分配或装入最少的系数中的变换提供最好的子图像近似，从而
导致最小的重建误差。最后，在导出式(8.2-25)的假设条件下，一幅大小为NxN的图像的MN/n2个子图
像的均方误差是相同的。因此，大小为M×N的图像的均方误差(平均误差的一种度量)等于单个子图像的
均方误差。
之前的例子表明，DCT的信息携带能力要比DFT和WHT的信息携带能力强。尽管大多数图像
通常都拥有这一条件，但在信息携带方面的最佳变换是Karhunen-Loéve变换(见第11章)而不是DCT。
这是由于这样的事实，即对任何输人图像和任何数量的保留系数，KLT都可以使式(8.2-25)的均方误
差最小(Kramer and Mathews[1956])①。然而，由于KLT是依赖于数据的，所以为每幅子图像得到KLT
基图像所需的计算任务一般来说是非常繁重的。由于这个原因，实际上很少使用KLT来压缩图像
相反，通常使用像 DFT、WHT或DCT 这样具有固定(与输入无关)基图像的变换。与输入无关的变
换，非正弦变换(如WHT变换)是最容易实现的。正弦变换(如DFT或DCT)的信息携带能力更接近
最佳KLT的信息携带能力。
因此，多数变换编码系统都基于DCT.DCT在信息携带能力和计算复杂性之间提供了好的折中。
事实上，DCT的性质已经提供了DCT成为变换编码系统的国际标准所具有的实际价值。与其他输入
独立的变换相比，DCT 变换具有如下优点：用单片集成电路就可以实现，可将最多信息装入最少的
系数中②(对大多数图像而言),并且在子图像间的边界变得可见时，可使出现的称为块缺陷的块效应
最小化。与其他正弦变换相比，最后一条性质尤其重要。如图8.25(a)所示，DFT隐含的n点周期性(见
①最佳的一个附加条件是式(8.2-23)的模板函数选择具有最大方差的KLT系数
② Ahmed 等人[19741首先注意到一阶马尔可夫图像源的KLT 基图像与DCT的基图像非常相似。由于相邻像素间的相关接近1.
所以输入相关的KLT基图像就变得与输入无关的DCT基图像相同(Clarke[1985D)。 茎
366 数字图像处理(第三版)
4.6.3节)造成了导致高频变换内容的边界不连续性的上升。当DFT变换系数被截尾或量化时，吉布斯
现象①会导致边界点呈现错误的值，这些错误的值在图像中以块效应形式出现。也就是说，相邻子图
像之间的边界变得可见，因为子图像的边界像素呈现在边界点处形成的不连续的均值[见图8.25(a)]。
图8.25(b)的DCT减少了这种效应，因为这种变换所隐含的2n点周期性本质上不会产生边界不连续。
落：送
不连续 b
边界点 1-
2n-
图8.25(a)一维DFT中隐含的周期性；(b)一维DCT中隐含的周期性
子图像尺寸选择
影响变换编码误差和计算复杂性的另一个重要因素是子图像的尺寸。在大多数应用中，图像被进
一步细分，以便相邻子图像之间的相关性(冗余)降低到可接受的程度，且n为2的整数次幂，和前面
一样，n是子图的维数。后一个条件简化了子图像变换的计算(见4.11.3节讨论的基2的连续加倍方法)。
通常，压缩水平和计算复杂性会随子图像尺寸的增加而增大。最常用的子图像尺寸为8×8和16×16。
例8.14 子图像尺寸对变换编码的影响。 6.5:
图8.26 以图的方式说明了子图像尺寸对变换编码重建误
差的影响。图中所画的数据是这样得到的：把图8.9(a)中的
单色图像分割为大小为nxn的子图像，其中n=2,4,8,16,…,
6
55 FFT
5
256,512,计算每幅子图像的变换，截取所得系数的75并
对截取后的阵列做反变换。注意，在子图像的尺寸大于8×8
时，Hadamard 和余弦曲线会变得平坦，而傅里叶重建误差在
该区域连续减小。当n进一步增大时，傅里叶重建误差将穿
过Walsh-Hadamard曲线而逼近余弦结果。该结果与由Netravali
和Limb[1980]及Prat[1991]报道的二维马尔可夫图像源的理论
和实验发现一致。
均方根误差 4.5
4
wHT
3.5 吸
3
DCT
2.5
22 4 8 163264128 256 512
子图像尺寸
图8.26 重建误差与子图像尺寸的关系
当使用2×2大小的子图像时，所有三条曲线相交。在这种情况下，每种变换阵列只有1/4的系
数(25???保留。所有情况下的系数都是直流分量，所以反变换简单地使用它们的均值[见式(4.6-21)]
来替代这4个子图像像素。这种条件在图8.27(b)中很明显，这幅图显示了2×2大小的DCT结果放大
的一部分。注意块效应，在图8.27(c)和图8.27(d)中，随着子图像尺寸增大为的4×4和8×8,结果中
普遍存在的块效应减少了。作为参考，图8.27(a)显示了原图像的局部放大。
①多数关于电路分析的电气工程教材中都描述了这种现象，其产生的原因是傅里叶变换在不连续处无法一致收敛。在不连续处。
傅里叶展开取不连续点的平均值
第8章 图 像压 缩 367
a b c d
图8.27(a)使用25??DCT系数对图8.27(a)的近似；(b)使用2×2大小
的子图的近似；(c)使用4×4大小的子图像的近似；(d)使用8×8
大小的子图像的近似。图(a)中的原图像是图8.9(a)放大的局部
比特分配
与式(8.2-24)截取后的级数展开相关的重建误差，是被丢弃变换系数的数量、相对重要性及用于
表示保留系数的精度的函数。在大多数变换编码系统中，保留的系数是根据最大方差进行选择的[即
建立式(8.2-23)的模板函数],这称为区域编码；或是根据最大幅度进行选择的，这称为阈值编码。
对变换后的子图像的系数进行截取、量化和编码的整个过程，通常被称为比特分配。
例8.15 比特分配。
图8.28(a)和(c)显示了图8.9(a)的两种近似，在这两种近似中，每幅8×8子图像丢弃了87.5??DCT
系数。第一幅图像是通过保留8个最大的变换系数的阈值编码得到的，第二幅图像是使用区域编码方法
生成的。在后一种情况下，每个DCT 系数都被看成是一个随机变量，该随机变量的分布可以通过对所有
变换子图像的总体进行计算得到。8个最大方差的分布(在变换后的8×8子图像中，占64个系数的12.5%)
被定位并用于确定为所有子图像保留的系数T(u,v)的坐标a和v。注意，图8.28(b)中的阈值编码差值图像
所包含的误差比图8.28(d)中区域编码的误差小。为使误差更为明显，两幅图像都已被放大。对应的均方
根误差分别是4.5和6.5个灰度级。
a b c d
图8.28 用8×8DCT系数的12.5??图8.9(a)的近似：(a)~(b)阈值
编码结果；(c)-(d)区域编码结果。放大4倍后的差值图像
区域编码的实现 区域编码是以信息论中观察信息为不确定性的概念为基础的。因此，具有最
大方差的变换系数携带大部分的图像信息，并在编码处理中应该保留。这些方差本身可以像前面的例
子中那样直接根据MN/n2个变换的子图像阵列计算出来，或以一个假设的图像模型为基础(如一个马
尔可夫自相关函数)计算出来。在任何一种情况下，根据式(8.2-24),区域取样处理可被看成是每个T(u,v)
乘以区域模板中的对应元素，区域模板是在最大方差的位置上设为1.而在所有其他位置上置0构造出
来的。最大方差的系数通常被定位在图像变换的原点的周围，所得到的典型区域模板如图8.29(a)所示。
在区域取样过程中保留的系数必须被量化和编码，以便区域模板有时被描述成用于对每个系数
进行编码的比特数[见图8.29(b)]。在大多数情况下，给这些系数分配相同的比特数，或在它们之中
的系数不均等地分配某些固定的比特数。在第一种情况下，系数通常被它们的标准差归一化并被均匀 s邕
368 数字图像处理(第三版)
量化。在第二种情况下，为每个系数设计一个量化器，如一个最佳劳埃德-马克斯量化器(见8.2.9节中
的最佳量化器)。为构造所要求的量化器，通常用瑞利密度函数对第零个或直流系数进行建模，而剩
下的系数则由拉普拉斯或高斯密度函数①来建模。分配给每个量化器的量化级数(及比特数)与
log?o(成正比。这样，式(8.2-24)中保留的系数——基于最大方差选择的系数——就被分配了与
系数方差的对数成正比的比特数。
室
a b
cd
图8.29 (a)一个典型的区域模板；(b)一个典型的区域比特分配；(c)一个典型的阈值模板
(d)一个典型的经阈值处理后的系数排序序列。用阴影强调的系数是保留的系数
阈值编码的实现 区域编码通常对所有的子图像使用单个固定的模板来实现。然而，阈值编码
在为每幅彼此不同的子图像保留变换系数的位置方面具有固有的自适应性。实际上，由于其计算的简
单性，阈值编码是实际中最常用的自适应变换编码方法。根本的概念是对于任何子图像，最大幅值的
变换系数对重建后的子图像的质量的贡献最大，正如最后一个例子中展示的那样。
因为不同子图像的最大系数的位置是变化的，所以通常(以事先定义的方式)x(u,v)T(u,v)的元
素被重新排序，以形成一个一维行程编码序列。图8.29(c)显示了一幅假设图像的一幅子图像的一
个典型阈值模板。该模板提供了一种将相应的子图像的阈值编码处理连同用公式(8.2-24)进行数学
描述过程进行可视化的方便途径。当模板[通过式(8.2-24)]用于产生该模板的子图像，并且根据
图8.29(d)中的Z形模式对得到的nxn阵列进行重排序，以形成n2个元素的系数序列时，重排序后
的一维序列包含有一些0的长行程[在图8.29(d)中，由0开始，后跟一系列数字，Z形模式变得
很明显]。这些行程通常被行程编码。对应于包含1的模板位置的非零系数或保留系数，通常使用
变长码来表示。
有三种基本的途径对一幅变换后的子图像进行阈值处理，或换种
说法，有三种基本的途径可以生成式(8.2-23)所给定形式的子图像阈值
模板函数：(1)对所有子图像使用单一的全局阈值；(2)对每幅子图像
①由于每个系数都是其子图像中像素的线性组合[见式(82-210)],中心极限定理告诉我们，当子图像的尺寸增大时。系数就趋
向于高斯形式。但是，因为非负图像总有正的直流系数，所以这个结论不适用于直流系数。
1 1 1 1 1 0 0 0 8 7 6 4 3 2 1
1
0
1 I 1 1 0 0 0 0 7 6 5 43 2 0
1 1 1 0 0 0 0 0
0
6 5 4 3 3
3 3 2
1 1 0
1 1 0 0 0 0 0 4
3
2
4 0 0
1
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0 0
0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 00
1 1 0 1 1 0 0 0 0 1 5 6 14 15 27 28
1
1
1 1 0 0 0 0 2 4 7 1316262942
1 0 0 0 0 0 0 3 812 1725 304143
1 0 0 0 0 0 0 0 9 11 18 31 40 44|53 24
0 0 0 0 0 0 0 0 10192332 39 45 52 54
0 1 0 0 0 0 0 0 20|22 33 38 46|51 55 60
343747 50|56 59|61
0
0
0
0
0
0
0
0
0
0 0
0
0
0
21
0 3536 48|49 57|58 62|63
“最大N编码”中的N.不是
一幅图像的维数，而是保留的系数
数量。
第8章 图 像压 缩 369
使用不同的阈值；(3)阈值可以随子图像内每个系数的位置的变化而变化。在第一种方法中，对不同
图像的压缩水平是不同的，这取决于超过全局阈值的系数的数量。在第二种方法中，被称为最大N编
码，对每幅子图像都丢掉相同数量的系数。结果，代码率是恒定的并且事先已知。在第三种方法中，
类似于第一种方法，得到的代码率是变化的，但优点是可以使用下式替代式(8.2-24)中的x(u,v)T(u,v)
把阈值处理和量化结合起来：
ru.v)=mmZ] (8.2-26)
式中，T(u,v)是T(u,v)经阈值处理和量化后的近似，Zu,v)是变换标准化阵列
Z(0,0)Z(0,1) … Z(0,n-1)
(8.2-27)
的元素。在对子图像变换T(u,v)标准化(阈值处理和量化)之前，可对其取反变换来得到子图像g(x,y)的
一个近似，但f(u,v)必须乘以Zu,v)。得到的去标准化阵列表示为T(u,v),它是T(u,v)的一个近似：
T(u,v)=f(u,v)Z(u.v) (8.2-28)
T(u,v)的反变换生成解压缩子图像的近似。
图8.30(a)以图的方式描述了式(8.2-26)在Zu,v)被分配了一个特定值c的情况。注意，当且仅当
下式成立时，T(u,v)假定整数值k:
kc-2<T(u,D)<kc+2 (8.2-29)
如果Zu,D)>2T(u,v),则T(u,v)=0.且变换系数被完全截去或丢弃。当T(u,v)用一种其长度随k值
的增加而增大的变长编码表示时，用于表示T(u,v)的比特数会受c值的控制。因此，Z的元素可以缩放，
以实现各种压缩水平。图8.30(b)显示了一个典型的标准化阵列。广泛用于JPEG 标准(见下节)中的这
个阵列。根据试探决定的感知或心理视觉的重要性对一幅变换后的子图像的每个系数进行加权。
a b (.)
3
2
-3c-2c- 1
T(L,)
e
1
2e 3e
-2
-3
图8.30 (a)一条阈值编码量化曲线[见式(8.2-29)];(b)一个典型的标准化矩阵
1611 10 16244051 61
12.12 14 19 26 58 60 55
14 13 16 24:40 57 69 56
14 17 22 29 51 87 80 62
18 22 37 5668.109 103 77
|24 35 35 64 81 104 113 92
4964 78|87 103.121 120101
72 92|995 9 112 100 103|99
医;图
含3
370 数字图像处理(第三版)
例8.16 阈值编码的说明。
图8.31(a)到(f)显示了6种图8.9(a)中单色图像的阈值编码近似。所有图像都是使用一个8×8的DCT
和图8.30(b)中的标准化阵列生成的。第一个结果的压缩率大约为12:1(即C=12),它是直接应用标准化阵列
得到的。其余的结果，分别以19:1,30:1,49:1,85:1和182:1的压缩率压缩原图，并用2、4、8、16和32
乘以(比例放缩)标准化阵列后生成的。相应的均方根误差分别是3.83,4.93,6.62,9.35,13.94和22.46个灰度级。
aei
图8.31 使用DCT和图8.30(b)中的标准化阵列得到的图8.9(a)
的近似：(a)Z;(b)2Z;(c)4Z;(d)8Z;(e)16Z;(1)32Z
JPEG 使用最为普遍且广泛的连续色调静止帧压缩标准是JPEG 标准。它定义了三种不同的编
码系统：(1)一种有损的基本编码系统，该系统以DCT为基础，并且对大多数压缩应用是足够的；(2)一
种扩展的编码系统，它面向更大压缩、更高精度或渐进的重建应用；(3)一种面向可逆压缩的无损独
立编码系统。为实现JPEG的兼容性，产品或系统必须包含对基本系统的支持。没有规定特殊的文件
格式、空间分辨率或彩色空间模型。
在通常称为顺序基线系统的基线系统中，输入和输出数据的精度限制为8比特，而量化后的DCT
值限制为11比特。压缩本身按三个顺序步骤执行：DCT 计算、量化和变长码分配。图像首先被细分
为8×8的像素块，对这些像素块按从左到右、从上到下的方式进行处理。当遇到每个8×8的块或子
图像时，其64个像素通过减去2*?1进行灰度级移动，其中2*是灰度级的最大数。然后计算该块的二
维离散余弦变换，根据式(8.2-26)对其进行量化，并使用图8.29(d)的Z形模式对其重新排序，形成
一个量化系数的一维序列。
由于在图8.29(d)中的Z形模式下生成的一维重排序阵列是根据递增的空间频率定性地排列的，
所以JPEG 编码程序设计可以充分利用重排序得到长零行程。特别地，非零AC①系数使用定义系数
值和前面零的个数的一种变长码来进行编码。DC系数是相对于前一幅子图像的DC系数的差值编
码。附录A中的表A.3、表A.4和表A.5对彩色图像的亮度分量或单色图像的灰度提供了默认的JPEG
霍夫曼编码。JPEG推荐的亮度量化阵列在图8.30(b)中给出，该阵列可被缩放，以提供不同的压缩
水平。该阵列的缩放允许用户选择 JPEG 压缩的“质量”。尽管默认的编码表和量化阵列是为彩色
和单色处理提供的，但用户可以自由地构建自定义表和/或阵列，这可以在事实上适应被压缩图像
的特点。
①在该标准中，术语AC表示除第零个或DC系数外的所有变换系数
第8章 图 像压 缩 371
例8.17 JPEG基本编码和解码。
考虑下列8×8子图像使用JPEG基本标准的压缩和重建：
52 55 61 66 70 61 73 64
59 63 66 90 109 85 69 72
59 144 104 62 68 113 66 73
63 58 71 122 70 154 106 69
67 61 68 104 126 88 68 70
79 65 60 70 77 68 58 75
85 71 59 64 55 61 65 83
87 79 69 68 65 76 78 94
原图像由256个或2?个可能的灰度组成，因此编码处理由对原始子图像的像素移位-2?或-128个灰度级
开始。得到的移位阵列为
-76 -73 -67 -62 -58 -67 -64 -55
-65 -69 -62 -38 -19 -43 -59 -56
-66 -69 -60 -15 -16 -24 -62 -55
-65 -70 -57 -6 -26 -22 -58 -59
-61 -67 -60 -24 -2 -40 -60 -58
-49 -63 -68 -58 -65 -51 -70 -53
-43 -57 -64 69 -73 -67 -63 -45
-59 60 63 -52 -50 -41 -49 -34
对于n=8,根据式(8.2-10)和式(8.2-18)的正向DCT,变换的阵列成为
-29 -415 -62 25 55 -20
7 -21 -62 11 9
-46 8 77 -25 -30
-50 13 35 9 -15
11 -8 -13 -2 -1
-7
10
-1-6
7
0 6
1 -4
-10 1 3 -3 -1 2 0
3
6
-5
3
1
-1
-1 2 -1 2 -4
-1 -1
-3 1 -2
-1 -2 -1 -1 0 -1
如果使用图8.30(b)中JPEG推荐的标准阵列来量化这个变换阵列，则缩放和截短[即根据式(8.2-26)进行
标准化]后的系数是
-26 -3 -6 2 2 0 0 0
-2 1 4 0 0 0 0 0
-3 1 5 -1 -1
-4 1 2 0 0 0 0 -1 1 0 0 0
0 0 0
0
0 0 0
0 0 0 0
0 0 0 0 0
0 0 0
0
0 0 0 0
0 0 0 0 0 0 0
其中，例如，DC系数计算如下：
ro.o)=omlo]-m-465]-26
注意，变换和标准化处理产生了大量的零值系数。当根据图8.29(d)中的Z形排序模式对这些系数重新排
序时，得到的一维系数序列为
[-26-31-3-2-62-41-41150200-1200000-1-1 EOB]
其中，符号EOB表示块结尾状态。专用的EOB霍夫曼码字(见表A.5中的分类0和行程0)表明重排序后
的序列中的剩余系数均为零。
对于重排序后的系数序列，默认 JPEG编码的构造是从计算当前 DC系数和前面已编码子图像的DC
系数之间的差值开始的。假定紧挨着此子图像左边的变换和量化后的子图像的DC系数为-17,则得到的DPCM
602
372 数字图像处理(第三版)
差值为[-26-(-17]或-9,此值位于表A.3的DC差值的类别4中。根据表A4的默认霍夫曼差值编码，类别
4差值的正确基础码为101(一个3比特编码),一个类别4的系数的完整编码总长为7比特。余下的4比特
必须从差值的最低阶比特(LSB)生成。对于一个一般的 DC差值类(譬如类别K),需要额外的K比特，并
且它不是计算正差值的K个最低阶比特，就是计算负差值的K个最低阶比特减1。对于差值-9,合适的
最低阶比特(LSB)为(0111)-1或0110,而且完全DPCM编码的DC码字是1010110。
重排阵列的非零AC系数根据表A.3和表A.5进行类似的编码。主要差别在于，每个默认的AC霍夫
曼码字依赖于前一个被编码的非零值系数的数量，以及非零系数大小的分类(见表A.5中标为“行程/分类”
列)。因此，重排阵列的第一个非零AC系数(-3)被编码为0100。该码的前两个比特表明，这个系数属于
大小分类2,并且没有零值系数在前面(见表A.3);最后两个比特是使用与获得DC差值编码的最低阶比
特(LSB)相同处理的生成的。继续使用这种方法，完整编码(重排序)阵列为
10101100100001 0100 0101 100001 0110 100011001
100011 001 001 100101 11100110 110110011011110100 000 1010
为阅读方便起见，这里插入了空格。尽管在这个例子中并不需要这个阵列，但默认的JPEG码包含了一个
对于15个零后跟一个0的行程的专用码字(见表A.5中的分类0和行程F)。在完全编码后的重排阵列中，
总比特数(在这个例子中，要求用于表示整幅8×8大小的8比特子图像的比特数)是92。得到的压缩率是
512/92,或大约为5.6:1。
为解压缩一幅压缩后的JPEG子图像，解码器必须首先重建产生压缩比特流的已规格化的变换系数。
因为一个经霍夫曼编码的二进制序列是瞬时和唯一可解码的，所以使用简单的查找表方式就可以很容易
地完成这一步骤。这里，重新生成的量化系数阵列是：
壹：受
-26 1
-2
-2 -64
2 2 0 0 0
0 0 0 0 0
-3 1 5
十一 0
1 2
0
-1
-1
-1 0 0 0
0 0
0 0 0
0
0
0
0
0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0
根据式(8.2-28)去规格化后，该阵列变成
416 -33 -60 32 48 0 0 0
12 -24 -56 0 0 0 0 0
-42 13 80 -24 -40 0 0 0
-56 17 44 -29 0
18 0 0 0 0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0 0 0 0
0 0 0 0
0 0 0 0 0 0 0 0
其中，例如，DC系数可根据下式计算：
T(0,0)=f(0.0)Z(0,0)=(-26)(16)=-416
完全重建的子图像是通过(8.2-11)和式(8.2-18)取去规格化阵列的反DCT得到的，由此得到
-70 -64 61 -64 -69 -66 -58 -50
-72 -73 -61 -39 -30 40 -54 -59
68 -78 -58 9 13 -12 64 48
-59 -77 -57 0 22 -13 -51 60
-75 -54 -64 -23 -13 -63 -60 44
-52 -71 -72 -54 -54 -71 -71 -54
-45 -59 -70 -68 -67 -67 -61 -50
-35 -47 -61 66 -60 -48 -44 -44
第8章 图 像压缩 373
然后对每个反变换后的像素移位+2?(或+128)个灰度级，得到
58 64 67 64 59 62 70 78
56 55 67 89 98 88 74 69
119 116 80 60 50 70 141 64
69 51 71 128 149 115 77 68
64 105 74 53 115 84 65 72
56 57 57 74 76 57 74 75
83 69 59 60 61 67 78 61
93 81 67 62 69 80 84 84
原始子图像和重建子图像之间的任何差别都是由JPEG压缩和解压缩处理的有损性质造成的。在这个例子
中，误差范围是从-14到+11,并且按如下方式分布：
-6
7
-6 2 11 -9
-1 1 4 11 -3
-6 -1
-5
-5
3
2
-6
-6
斗
厂中 2 2 5 -1
6
9 -2 -3 -12 -14
7 -6
8 4 -73
0 -5 -9 -7
9
1
6 4 3
8 4
-2 2
2 6
91 1
-2 0
-6 -4
-21
5
10
整个压缩和重建处理的均方根误差接近5.8个灰度级。
例8.18 JPEG 编码的说明。
图8.32(a)和(d)显示了图8.9(a)所示单色图像的两种JPEG近似。第一个结果提供了25:1的压缩；
第二个用52:1的比率压缩原始图像。图8.32(a)中的原图像和图8.32(d)中的重建图像之间的差分别显
示在图8.32(b)和图8.32(e)中。相应的均方根误差是5.4和10.7个灰度级。误差在图8.32(c)和图8.32(1
的放大图像中清晰可见。这些图像分别显示了图8.32(a)和图8.32(d)的局部放大。注意，JPEG 块效应
随压缩率的增大而增大。
ae
图8.32 图8.9(a)的两种JPEG近似。每一行包含压缩和重建后的结
果，该结果和原图像间放大后的差，以及重建图像的局部放大
8.2.9 预测编码
现在我们转向一种更简单的压缩方法，这种方法不需要较大计算开销就可实现较好的压缩效
果，并且可以是无误差的或有损的压缩。这种方法通常被称为预测编码，它是通过消除紧邻像素
605
606
606
374 数字图像处理(第三版)
在空间和时间上的冗余来实现的，它仅对每个像素中的新信息进行提
取和编码。一个像素的新信息定义为该像素的实际值与预测值之间
的差。
无损预测编码
图8.33显示了一个无损预测编码系统的基本组成。该系统由一个编码器和一个解码器组成，编码
器和解码器中均包含有一个相同的预测器。离散时间输入信号f(n)的连续样本被传入编码器，预测
器根据指定数量的以往样本来生成每个样本的预期值。然后，预测器的输出被四舍五入为最接近的整
数，表示为f(n),并使用这个整数来形成差值或预测误差
e(n)=f(n)-f(n)
参考表83和表84.预测编码用于
JBIG2、JPEG、JPEG-LS.MPEG-1.2,4,
H.261,H.262,H263,H264,HDV.VC-1
和其他压缩标准与文件格式中。
(8.2-30)
b
f(m) ein) 输入序列 符号编码器一 压缩后的序列
预测器 最接近
的整数 jon)
符号解码器 e(n) 压缩后的序列 f(n) 解压缩后的序列
jim)
图8.33 一个无损预测编码模型：(a)编码器；(b)解码器
使用变长码来对这个误差进行编码(用符号编码器),以生成压缩数据流的下一个元素。图8.33(b)中
的解码器根据接收到的变长码字重建e(n),并执行反操作
f(n)=e(n)+f(n)
预测器
(8.2-31)
以解压缩或重建原始输入序列。
可使用各种局部的、全局的和自适应的方法(见名为“有损预测编码”的后一小节)来生成f(n)。
在大多数情况下，预测是由前m个样值的线性组合生成的，即
m)=om Zoaf(-0 (8.2-32)
其中，m是线性预测器的阶，round 表示四舍五入或取最接近整数的操作，a,i=1,2,…,m是预测系
数。如果将图8.33(a)中的输入序列看成是一幅图像的样本，那么式(8.2-30)到式(8.2-32)中的f(n)
就是像素，用于预测每个像素值的m个样本来自当前扫描行(称为一维线性预测编码)、来自当前行
和前几个扫描行(称为二维线性预测编码),或来自图像序列的当前图像和前几幅图像(称为三维线性
预测编码)。这样，对于一维线性预测图像编码，式(8.2-32)可以写为
Pux,)=omd Laf(x,y- (8.2-33)
其中，每个样本现在被明确地表达为输入图像空间坐标x和y的函数。注意，式(8.2-33)表明一维
线性预测仅是当前行上前几个像素的函数。在二维预测编码中，预测是一幅图像从左到右、从上到
第8章 图 像压 缩 375
下扫描的前几个像素的函数。在三维情况下，预测是以这些像素和前几帧图像的前几个像素为基础
的。式(8.2-33)不能对每一行的前m个像素进行求值，因此必须使用其他方式(如霍夫曼编码)来对
这些像素进行编码，并将这种编码考虑为预测编码处理的一种额外开销。类似的说明适用于更高维
的情况。
例8.19 预测编码和空间冗余。
考虑使用来自式(8.2-33)的简单的一阶(即m=1)线性预测器对图8.34(a)中的单色图像进行编码：
f(x,y)=round[af(x,y-1] (8.2-34)
该式是式(8.2-33)在m=1且只有一个预测系数α?(此时下标已无意义)时的简化形式。这种一般形式的预
测器称为前像素预测器，对应的预测编码过程称为差分编码或前像素编码。图8.34(c)显示了由式(8.2-34)
在α=1时得到的预测误差图像，即e(x,y)=f(x,y)-f(x,y)。这幅图像是按如下方式缩放的：灰度128
表示一个零预测误差，而所有非零的正预测误差和负预测误差(低于和超过估计)分别显示为更亮的和
更暗的灰度色调。预测图像的均值为128.26。因为灰度128对应于0预测误差，所以平均预测误差仅为
0.26比特。
图8.34(b)和(d)分别显示了图8.34(a)中图像的灰度直方图和预测误差e(x,y)的直方图。注意，图8.34(d)
中预测误差的标准差要比原图像中灰度的标准差小得多。另外，用式(8.1-7)估计的预测误差的熵明显小
于原图像的估计熵(3.99比特/像素对7.25比特/像素)。这种熵的降低反映了大量空间冗余的消除，尽管对
于k 比特图像需要(k+1)比特数来准确地表示预测误差序列e(x,y)。通 注意，变长编码的预测误差是压
常，预测编码方法的最大压缩率可用表示原图像中每个像素的平均比特 缩后的图像。
数除以预测误差的熵的估计来估计。在这个例子中，任何变长编码过程
都可用于e(x,y)的编码，但得到的压缩率将限制在约8/3.99或2:1左右。
2.5 a b c d
像素数(×1000) 2.0
15 标准差-4560
熵=725
1.0
0.5
0.00 50 100 150 200 250 300
灰度
2.0
像素数(×10000)
1.8 1.6
1.4 12
1.0 0.8
0.6 0.4 0.2
0.0
-300-200-100 0 100 200 300
标准差-15.58
消-3.99
预测误差
图8.34 (a)来自轨道空间航天飞机的地球景色；(b)图(a)的灰度直方图；(c)由式(8.2-34)
得到的预测误差图像；(d)预测误差的直方图(原图像由NASA提供) ③-密
目多
376 数字图像处理(第三版)
前面的例子说明，预测编码达到的压缩与将输入图像映射到一个预测误差序列所得到的熵的减
少直接相关，通常称为预测残差。因为通过预测和差分处理消除了空间冗余，所以，预测残差的概率
密度函数通常在零处会有一个很高的峰值，并由一个相对较小的方差(与输入灰度分布相比)来表征。
实际上，它常常由零均值不相关拉普拉斯概率密度函数(PDF)建模：
n.0- (8.2-35)
其中，σ,是e的标准差。
例8.20 预测编码和时间冗余。
图8.34(a)中的图像是NASA的一帧视频的一部分，其中地球正相对于安装在空间航天飞机上的固定
摄像机从左到右移动。图8.35(b)显示的是图8.35(a)的前一帧的重复图像。使用一阶线性预测器
f(x,y,t)=round[af(x,y,t-D] (8.2-36)
令α=1,则图8.35(b)中的像素的灰度可由图(a)中的对应像素来预测。图8.34(c)是得到的预测残差图像
e(x,y,t)=f(x,y,t)-f(x,y.t)。图8.34(d)是e(x,y,t)的直方图。注意，有很小的预测误差。该误差的标
准差远小于前一个例子中的标准差——3.76比特/像素对15.58比特/像素。
再次回忆可知，变长编码后的预 另外，预测误差的熵[使用式(8.1-7)计算]已从3.99比特/像素减小到 测误差是压缩后的图像。
2.59比特/像素。通过对得到的预测残差进行变长编码，原图像的压缩率接
近82.59或3.1:1——与例8.19中使用面向空间的前像素预测器得到的2:1的压缩率相比改进了50??
a b cd
7
6
5
像素数(×10000) 4
3
2
1
oL -100-80-60-40-20 0 20 40 60 80
标准差=3.76
熵=2.59
预测误差
图8.35(a)~(b)来自轨道空间航天飞机视频的两幅地球景观图；(c)由式(8.2-36)
得到的预测误差图像；(d)预测误差的直方图(原图像由NASA提供)
第8章 图 像压 缩 377
运动补偿预测残差
正如您在例8.20 中所看到的那样，视频序列中的连续帧通常是很相似的。对它们的差值进行编
码可减少时间冗余并提供有效的压缩。然而，当帧序列包含快速运动的目标时——或者涉及摄像机缩
放与摇镜头、场景的突然变化，或者涉及淡入和淡出时——相邻帧间的相似性就会降低，从而对压缩
率造成负面影响。也就是说，像大多数压缩技术那样(见例8.5),基于时间的预测编码对某种类型的
输人，就是具有重要的时间冗余的图像序列，才工作得最好。当用于处理有很少时间冗余的图像时，
就会发生数据扩展。视频压缩系统避免数据扩展问题的方法有如下两种：
1.在预测和差分处理期间，跟踪目标运动并对其进行补偿。
2.当存在帧间相关(帧间的相似性)而不足以发挥预测编码的优点时，转换到另一种编码方法。
第一种方法(称为运动补偿)是该节剩余内容的主题。然而，在这之前，我们注意到，当帧间相
关不足以使预测编码有效时，第二个问题典型地采用一种面向块的二维变换，如JPEG的基于DCT
的编码(见8.2.8节)。在这种方法中，压缩后的帧(即没有预测残差的帧)称为内帧或独立帧(I帧)。它
们可以在不访问属于视频的其他帧的情况下来解码。I帧通常类似于JPEG 编码图像，并且是生成预
测残差的理想起点。此外，它们提供了高度的随机访问，容易编辑，并阻止传输误差的传播。因此，
所有的标准都要求周期性地将I帧插入到压缩的视频码流中。
图8.36说明了运动补偿预测编码的基本原理。每一个视频帧都被
分解成不重叠的矩形区域，这些区域的典型尺寸为4×4到16×16,称
为宏块(图8.36中仅示出了一个宏块)。每个宏块相对于它在前一视频
帧——称为参考帧——中的“最合适的”位置的“运动”,以运动向
量来编码。该向量通过定义距“最合适的”位置的水平距离和垂直距
离来描述运动。典型地，位移被规定为最近像素、1/2 像素或1/4像素精度。如果用亚像素精度，那
么必须通过参考帧中的像素组合使用内插[如使用双线性内插(见2.4.4节)]。一个基于前一帧的编码
帧(图8.36中的前向预测)称为预测帧(P帧);一个基于后一帧的编码帧(图8.36的后向预测)称为双
向帧(B帧)。B帧要求对压缩的码流重新排序，以便这些帧以合适的编码序列而不是自然显示顺序的
序列提供给解码器。
运动向量 运动向量
单
遵图
时间
图8.36 宏块运动的规定
正如您所期望的那样，运动估计是运动补偿的关键部分。在运动估计期间，物体的运动被测量
并编码为运动向量。对“最好的”运动向量的搜索要求定义一个最佳准则。例如，运动向量可在宏块
像素和所选的参考帧中的预测像素(对于亚向素运动向量内插后的象素)之间的最大相关或最小误差的
基础上选择。最常用的一种误差度量是平均绝对失真(MAD):
MADx,=m二ZIrx+i.y+)-PCx+i+dx,y+j+y
“最可能”位置是指这样的一个
位置，该位置可使得参考宏块和正
被编码宏块间的误差度量最小。这
两个块不必是同一目标，但它们必
须使误差度量最小
823)
612 3
378 数字图像处理(第三版)
其中，x和y是被编码的mxn宏块的左上角像素的坐标，dx和dy是如图8.36所示的来自参考帧的位
移，p是预测的宏块像素值的一个阵列。对于亚像素运动向量估计，p来自参考帧中像素的内插。典
型地，dx和dy必须落在围绕每个宏块的一个有限搜索区域内(见图8.36),其值通常为±8到±64像素，
水平搜索区域通常要比垂直搜索区域稍大一些。一种更有效的推算误差的测量——称为绝对失真和
(SAD)——它在式(8.2-37)中省略了因子1/mn。
给定了一个如式(8.2-37)所示选择准则，在运动向量位移允许的范围内，包括亚像素位移，用最
小MAD搜索dx和dy执行运动估计。这种处理通常称为块匹配。一种穷举搜索可保证最好可能的结
果，但其计算代价高昂，因为必须在整个位移范围内对每个可能的运动进行测试。对于大小为16×16
的宏块和±32像素的位移范围(对于影片和运动事件没有超出问题的范围),当使用整数位移精度时，
对于一个帧内的每个宏块，必须执行4225次16x16 MAD计算。如果要求使用1/2像素或1/4像素的
精度时，计算的次数还应分别乘以4或16。快速搜索算法可以减少计算负担，但可能会也可能不会
得到最佳运动向量。在文献中已经提出并研究了许多基于块的快速运动估计算法(例如，参见Furht
等人[1997]和Mitchel等人[1997]的著述)。
例8.21 运动补偿预测。
图8.37(a)和(b)取自例8.19和例8.20中使用过的相同NASA视频序列。图8.37(b)与图8.34(a)和
图8.35(b)相同；图8.37(a)是之前出现的13帧中的一帧的一部分。图8.37(c)是两帧间的差，它被放大到
全部灰度范围。注意，在航天飞机的恒定部分该差为0(相对于摄像机),但在图像的其余部分由于地球的
相对运动有较大的差别。图8.37(c)中预测残差的标准差是12.73个灰度级；它的熵[用式(8.1-7)计算]
是4.17比特/像素。当使用变长编码对预测残差进行编码时，可能达到的最大压缩为C=8/4.17=1.92。
a b cd e
图8.37 (a)~(b)自绕轨道飞行的航天飞机视频中截取的间隔13帧的两幅地球景色图；
(c)没有运动补偿的预测误差图像；(d)有运动补偿的预测残差图像；(e)与图(d)
相关的运动向量。图(d)中的白点表示描述运动向量的窄头(原图像由NASA提供)
图8.37(d)显示了使用非常低的标准差(5.62灰度级相对于12.73个灰度级来比)和稍低的熵(3.04比特
/像素与4.17比特/像素相比)的运动补偿预测残差。熵用式(8.1-7)计算。如果图8.37(d)中的预测残差用变
长编码，得到的压缩率为C=8/3.04=2.63。为产生这一预测残差，我们把图8.37(b)分成不重叠的16×16
宏块，并将每个宏块与图8.37(a)中的每个16×16区域——落入图(b)中宏块位置的±16像素范围内的参
第8章 图 像压 缩 379
考帧——相比较。我们使用式(8.2-37),通过选择具有最低MAD的位移(dx,dy)确定最好的匹配。得到的
位移是图8.37(e)中运动向量的x分量和y分量。图中的白点是运动向量的头部；它们指出编码宏块的左
上角。正如您从向量模式看到的那样，图像中主要的运动是从左到右的运动。在图像较低的部分，它对
应于原始图像航天飞机的区域，由于没有运动，因此没有显示出运动向量。这一区域中的宏块是由参考
帧中相似位置的(即相对应的)宏块来预测的。因为图8.37(e)中的运动向量是高度相关的，所以可以对它
们进行变长编码以减少它们的存储和传输需求。
图8.38说明可使用亚像素运动补偿提高预测精度。图8.38(a)是
图8.37(c)和图8.38(a)间的视觉
差别是由缩放造成的。图8.38(a)中
的图像已被缩放到与图8.38(b)-(d)
相匹配。 例8.21中用过的相同的两帧，并使用宏块位移分别为1,1/2和1/4像
素分辨率(即精度)来计算。使用大小为8×8的宏块；位移被限制到±8个像素。
图8.37(c)的重复，并包括一个参考点；它显示了没有运动补偿的预
测误差。图8.38(b),(c)和(d)是经运动补偿后的预测残差。它们基于
在图8.38中的预测残差间最重要的视觉差别是灰度的峰值和谷值——即灰度最暗和最亮的区
域——的数量和大小。图8.38(d)中的1/4像素残差是4幅图像中“最平坦的”,具有最少的黑或白
偏移。正如所期望的那样，它有最窄的直方图。图8.38(a)到(d)中的预测残差的标准差随运动向量
精度的增加而减小——分别从12.7像素减小到4.4像素，从12.7像素减小到4像素和减小到3.8像
素。由式(8.1-7)确定的残差的熵分别为4.17,3.34,3.35和3.34比特/像素。这样，运动补偿后的残
差包含相同的信息量，尽管图8.38(c)和(d)中的残差是使用附加比特来提供1/2和1/4像素的内插。
最后，我们注意到，在每个运动补偿后的残差的左侧，都有一条明显的增大预测误差的条带。这是
由于地球从左到右的运动，它把地球上的新的或以前看不到的地形的区域带进了每幅图像中的左侧
区域。因为前几帧中不存在这些区域，所以不管使用的计算运动向量的精度如何，它们都不能被准
确地预测。
1 a b cd
图8.38 亚像素运动补偿后的预测残差：(a)没有运动补偿；(b)单像素精度；(c)1/2像素精度；(d)1/4
像素精度(所有预测误差都已被放大到整个灰度范围，然后乘以2.以增加它们的可视性)
运动估计是一项要求计算量的任务。幸运的是，只有编码器必须估计宏块运动。给定这些宏块
的运动向量，解码器只须简单地访问编码器中用于形成预测残差的参考帧的区域。因为这一原因，
运动估计没有包括在大多数视频压缩标准中。压缩标准集中在解码器上——在宏块维数、运动向量
精度、水平和垂直位移范围等参数上设置约束条件。表8.11给出了一些最重要的视频压缩标准的关
键预测编码参数。注意，针对I帧编码，大多数标准使用大小为8×8的DCT,但对运动补偿规定了
一个更大的区域(如大小为16×16的宏块)。另外，由于DCT系数量化的有效性，P帧和B帧预测残差
甚至也用变换编码。最后，我们注意到，H.261和MPEG-4AVC标准支持帧内预测编码(在I帧内),以
减少空间冗余。 6～6
6～6
380 数字图像处理(第三版)
表8.11 视频压缩标准中的预测编码
参 数 H.261 MPEG-1 H.262
MPEG-2 H.263 MPEG-4 VC-1
WMV-9
1 1/2 1/2 1/2 1/4 1/4
16x16 16×16 16x16
16×8
16x16
8x8
16x16
8×8
16×16
8×8
8x8
DCT
8×8
DCT
8×8
DCT
8×8
DCT
8x8
DCT
8×8
8x4
4×8
4x4
整数
DCT
P P,B P,B P,B P,B P,B
否 否 否 否 否 否
H.264
MPEG-4
AVC
运动向量精度 1/4
宏块大小 16×16
16×8
8×16
8×8
8×4
4×8
4×4
变换 4×4
8×8
整数
帧间预测 P,B
I帧帧内预测 是
图8.39显示了一个典型的运动补偿视频编码器。它利用了帧内和相邻视频帧间的冗余度、帧间
的运动均匀性以及人类视觉系统的心理视觉特性。我们可以认为输入到编码器的是顺序的视频宏块。
对于彩色视频，每个宏块都由一个亮度块和两个彩色块组成。因为眼睛对彩色的空间敏锐度远小于对
亮度的空间敏锐度，所以，彩色块通常以亮度块的水平和垂直分辨率的一半来取样。图中加灰的部分
是JPEG 编码器的并行变换、量化和变长编码操作。主要的差别是输
入，它可能是图像数据的传统宏块(对于I帧),或者是传统宏块和根
据前几个视频帧或相继的视频帧预测间的差值(对于P帧和B帧)。编
码器包括一个反量化器和反映射器(即反 DCT),以便其预测与互补的
解码器的那些预测相匹配。此外，它被设计用于产生与预期的视频信道容量相匹配的压缩比特流。为
完成这一任务，量化参数由一个码率控制器来调整，码率控制器是输出缓冲器占用量的函数。当缓冲
器变得较满时，量化就粗一些，以便较少的比特流进入缓冲器。
差值宏块
图像宏块-
按本章之前的定义，量化器是不
可逆的。图8.39中的“反量化器”
确实不会阻止信息损失。
码率
控制器
映射器
(即DCT) 量化器 变长编码 缓冲器 编码后
的宏块
预测宏块
反量化器
反映射器
(即DCT-1)
变长编码 编码后的
运动向量
运动估计器和
补偿器w帧延迟 解码后的宏块
图8.39一个典型的运动补偿视频编码器
第8章 图 像压 缩 381
例8.22 视频压缩的例子。
我们用一个例子来结束对运动补偿预测编码的讨论，该例说明了使用现代视频压缩方法的压缩种类。
图8.40显示了1分钟的NASA的高清(1280×720)全彩色视频的15帧，
它们的一部分在本节已经用过了。虽然显示的图像是单色的，但视频是 断，请参阅本书的网站。
本节中使用的NASA 视频片
1829 幅全彩色帧序列。注意，有各种场景、大量的运动和多样的淡入淡
出效果。例如，该视频用150帧从黑色淡入地打开，它包括图8.40中的第21帧和第44帧，并用图8.40中
包含的第1595帧、第1609帧和第1652帧的淡出序列，并紧接着淡出到黑色结束。还有一些急剧变化的
场景，如图8.40中第1303帧和第1304帧所涉及的变化。
以Quicktime 文件(见表8.4)存储的NASA视频H.264压缩的版本要求44.56 MB的存储空间——加
上另外1.39MB的相关音频。视频质量很高。对于不压缩的全彩色图像视频帧的数据存储需要约为5GB。
还应该注意到，视频还包含涉及旋转和缩放变化的序列(即图8.40中包括第959帧、第1023帧和第1088帧
的序列),但本节的讨论仅限于平移。
Frame 0021 Frame 0044 Frame 0201
Frame 0266 Frame 424 Frame (801
Frame099 Frane t021 Fame 1088
Frame 1224 Frame 1303 Frame 1304
Frame tS95 Fame 1609 Ftame 1652
图8.40 来自1分钟、1829帧的NASA视频的15帧图像。
原始视频是全彩色高清视频(原视频由NASA提供)
有损预测编码
在这一节中，我们在先前介绍的无损预测编码模型中加入一个量化器，并在关于空间预测器的
上下文中，探讨重建精度和压缩性能间的折中。如图8.41所显示的那样，代替无误差编码器的取最接 受:;
382 数字图像处理(第三版)
近整数功能的量化器被插入到了符号编码器和形成预测误差的那一点之间。该量化器将预测误差映射
为有限范围内的输出，表示为è(n),它确定了压缩量和产生的失真量。
目
e(n) 输入序列- 量化器 e(n) 符号编码器
a
压缩后的序列 b
f(n)
ju) 预测器 +
iin)
符号解码器
e(n) 压缩后的序列 j(n) +
+
解压缩后的序列
j(m)
图8.41 一个无损预测编码模型：(a)编码器；(b)解码器
为了接纳量化步骤的加入，必须更改图8.33(a)中的无误差编码器，以便由编码器和解码器产生
的预测相等。如图8.41(a)所示，这是通过在反馈环中放置一个有损编码器的预测器来完成的，其中，
表示为f(n)的输入是过去的预测函数与相应的量化误差产生的，即
f(n)=e(n)+f(n)
预测器
(8.2-38)
其中，f(n)同以前所定义的一样。这个闭环结构可以防止在解码器的输出处形成误差。注意，在图8.41(b)
中，解码器的输出也由式(8.2-38)给出。
例8.23 △调制。
△调制(DM)是一种简单而知名的有损预测编码形式，其中预测器和量化器定义为
f(n)=αf(n-D) (8.2-39)
和
c-{:其他 (8.2-40)
其中，α是一个预测系数(通常小于1),ζ是一个正的常量。量化器的输出e(n)可以用单一比特表示[见
图8.42(a)],因此，图8.41(a)中的符号编码器可以使用1比特的定长码。得到的DM码率为1比特/像素。
图8.42(c)说明了△调制处理的机理，其中压缩和重建输入序列{14,15,14,15,13,15,15,14,20,26,27,
28,27,27,29,37,47,62,75,77,78,79,80,81,81,82,82],a=1,C=6.5所需的计算被编成了表格。该处理过
程从第一个样本无误差地输入到解码器中开始。用在编码器和解码器处设立的初始条件f(0)=f(0)=14,
可以通过反复用式(8.2-39)、式(8.2-30)、式(8.2-40)和式(8.2-38)计算出其余的输出。这样，例如，当n=1
时，就有(1)=(1)(14)=14,e(1)=15-14=1,e(1)=+6.5[因为e(1)>0],j(1)=6.4+14=20.5,得到的
重建误差是(15-20.5)或-5.5。
图8.42(b)以图的方式显示了图8.42(c)中的图表化的数据。显示了输入和完全解码后的输出[即
f(n)和f(n)]。注意，在从n=14到19的这一快速变换区域中，C太小而不足以表示输人的最大变化，
产生了称为斜率过载的失真。此外，当ζ太大而无法表示输入的较小变化时，如在从n=0到n=7的相对
平滑的区域中，出现了颗粒噪声。在图像中，这两种现象会导致模糊的物体边缘和颗粒表面或噪声表面(即
失真的平滑区域)。
第8章 图 像压 缩 383
a b e(n) c 编码=1 n
+6.5 f(n)
e(n) jin)
-6.5 颗粒噪声 编码=0
斜率过载
解码器 编码器 输入 误差
f() jm) f(n) e(n) e(n) f(n)-fin)
14 0
1
14 14.0
一
-6.5
一
14.0
14.0
14.0 1.0 6.5 20.5
14 29 20.5 8.5
27.0 10.0 6.5 27.0
33.5 33.5 13.5
17
19
62 40.0 22.0
6.5 40.0
46.5
46.5 28.5
53.0 24.0
6.5 53.0 59.6
0.0 14.0
一
14.0
-5.5
14.0 20.5 -55
20.5 27.0
27.0 33.5 33.5
2.0
40.0 46.5
46.5 53.0
53.0 59.6
7.0
15
2
15
20.5
1.0 6.5 20.5
15 37 6.5
18 77 6.5
6.5
20.5 14.0 0.0
40.0 3.5
15.5
3
-6.5
16 47
20.5
22.0 17.5
图8.42 △调制的一个例子
在前例中提到的失真对所有形式的有损预测编码都是很普遍的。这些失真的严重性取决于所用
的量化和预测方法之间的一个相互作用的复杂集合。先不管它们相互间的作用，预测器通常是在无量
化误差的假设之下设计的，并且量化器设计为使其自身的误差最小。也就是说，预测器和量化器是彼
此独立进行设计的。
最佳预测器
在多数预测编码应用中，选择使编码器的均方预测误差最小的预测器
E{e2(n}=E{[f(m)-f(m]} (8.2-41)
约束条件①为
f(n)=e(n)+f(n)=e(n)+f(n)=f(n) (8.2-42)
和
f(w=2af(u-D) (8.2-43)
也就是，最佳的准则是最小均方预测误差，量化误差假设是可以忽略的[ e(n)=e(n)].且预测被约
束为前m个样本的一个线性组合2。这些约束并不是本质的，但它们在相当程度上简化了分析，且同
时降低了预测器计算的复杂性。如此得到的预测编码方法称为差分脉冲编码调制(DPCM)。
在这些条件下，最佳预测器设计问题就简化成了相对简单的选择m个预测系数，这些系数使表达式
①符号EH代表统计期望算子。
②一般来说，一个非高斯序列的最佳预测器，是用于形成估计的样本的一个非线性函数。 己:8
之～心
384 数字图像处理(第三版)
Ee={[m-2arm-} (8.2-44)
最小。相对于每个系数对式(8.2-44)求导，并令导数为零，在f(n)具有零均值和方差o2的假设下，
求联立方程的解，得到
α=R?'r (8.2-45)
其中，R?1是如下mxm自相关矩阵的逆矩阵：
FIf(n-1Fn-2lFF(n-1)F一ml
(8.2-46)
r和a是m元向量：
(8.2-47)
因此，对于任何输入序列，使式(8.2-44)最小的系数可以通过一系列基本矩阵操作来确定。此外，这
些系数仅取决于原序列中样本的自相关。使用这些最佳系数得到的预测误差的方差为
o?=a?-a'r=c2-ZE{fmf(n-o}a (8.2-48)
尽管计算式(8.2-45)的机理非常简单，但形成R和r所需的自相关计算实现起来却非常困难，因
此，在实践中几乎从不使用局部预测(即在这些预测中对每个输入序列计算预测系数)。在大多数情况
下，通过假设一个简单的输入模型，并将相应的自相关代人式(8.2-46)和式(8.2-47)(见8.1.4节)来计
算一组全局系数。譬如，当假设带有可离分自相关函数的二维马尔可夫图像源(见8.1.4节)
E{f(x,y)f(x-i,y-D}=o2plph (8.2-49)
和广义四阶线性预测器
f(x,y)=a,f(x,y-D)+a?f(x-1,y-D)+a?f(x-1.y)+a?fx-1,y+D) (8.2-50)
得到的最佳系数是
α?=Pa,a?=-PPa,a?=P,a?=0 (8.2-51)
其中，p和p,分别是所研究图像的水平和垂直相关系数。
最后，通常要求式(8.2-43)中的预测系数之和小于或等于1,即
a<1 (8.2-52)
这种限制是为了确保预测器的输出落入允许的输入范围内，并减少传输噪声的影响[当输入到图8.41(a)
中的是一幅图像时，传输噪声在重建图像中通常表现为水平条纹]。降低 DPCM 解码器对输入噪声
第8章 图 像压 缩 385
的敏感性是很重要的，因为单个误差(在适当的环境下)会传播到以后的所有输出，也就是说，解码
器的输出会变得不稳定。通过进一步限制式(8.2-52)严格小于1,可将输入误差的影响限制在少量
的输出中。
例8.24 预测技术的比较。
考虑由对图8.9(a)中的单色图像进行 DPCM 编码产生的预测误差，假设量化误差为零且使用如下四
个预测器：
f(x,y)=0.97f(x,y-D) (8.2-53)
f(x,y)=0.5f(x,y-1)+0.5f(x-1,y) (8.2-54)
f(x,y)=0.75f(x,y-1)+0.75f(x-1,y)-0.5f(x-1.y-1) (8.2-55)
a-{097(x-1-y.其他 (8.2-56)
其中，△h=|f(x-1,y)-f(x-1,y-1)|和△v=|f(x,y-1-f(x-Ly-D|表示在点(x,y)处的水平和垂直梯
度。式(8.2-53)到式(8.2-56)定义了α的一个相对鲁棒的集合，该集合可对很宽范围的图像提供令人满意
的性能。设计式(8.2-56)的自适应预测器是通过计算一幅图像的方向特性的局部度量(△h和△v),并选择
适合特定的度量性能的预测器来改善边缘的重现质量。
图8.43(a)到(d)显示了使用式(8.2-53)到式(8.2-56)的预测器得到的预测误差图像。注意，随着预测
器阶数的增加明显可觉察的误差减少了。预测误差的标准差遵循类似的模式，它们分别是11.1,9.8,9.1
和9.7个灰度级。
a bc d
图8.43 4种线性预测技术的比较
最佳量化
图8.44中的阶梯量化函数t=q(s)是关于s的奇函数[即q(-s)=-q(s)],这个函数完全可以由
图8.44第一象限中所示的s,和；的L2个值来描述。这些断点定义了函数的不连续性，并称为该量化器
的判决级和重建级。为方便起见，如果s位于半开区间(sj,s.内，则可以将s看成是到：的映射。
量化器设计问题是对于一种特殊的最佳准则和输入概率密度函数p(s),选择最好的s,和t。如
果最佳准则(可以是统计度量或心理视觉度量)是均方量化误差[即E{(S,-1)21]最小，并且p(s)
是一个偶函数，则最小误差(Max[1960])的条件是
s-)p(sds=0.i=1.2…2 (8.2-57)
①使用多于3个或4个像素的预测器。会提供很少的压缩增益。但复杂性却会增加(Habibl1971D
②关于心理视觉度量的详细内容，请参阅Netravali[1977]和Limb and Rubinstein[19781 空：名
386 数字图像处理(第三版)
=L72
(8.2-58)
和
S-=-5,t=-1 (8.2-59)
式(8.2-57)指出重建级是规定的判决区间上p(s)下方面积的质心，而式(8.2-59)指出判决级是重建级
之间的一半。式(8.2-59)是由于q为一个奇函数的结果。对于任意L,满足式(8.2-57)到式(8.2-59)
固;
的s,和t,在均方误差意义下是最佳的；相应的
量化器称为L级劳埃德-马克斯(Lloyd-Max)量
化器。
输出
L/2
表8.12列出了单位方差拉普拉斯概率密度函 t=q(s)
数[见式(8.2-35)]的2级、4级和8级劳埃德-
马克斯判决和重建级。因为对大多数非平凡的
p(s)来说，得到式(8.2-57)到式(8.2-59)的显式
的或闭合形式的解是困难的，所以这些值都是数
值生成的(Paez and Glisson[1972])。所示的这三
个量化器分别提供了1.2和3比特/像素的固定
S-(aL/2)-11 5
S1S2S(L/2)-1 输入
输出速率。由于表8.12是对单位方差分布构建
的，所以σ≠1情况的重建级和判决级是将概率
密度函数的标准差与表中的值相乘得到的。表中
-L/2
图8.44 一个典型的量化函数
的最后一行列出了步长θ,步长θ同时满足式(8.2-57)到式(8.2-59)和附加的约束条件：
t--=S?-S-1=θ (8.2-60)
如果采用变长编码的符号编码器作为图8.41(a)中的普通有损预测编码器，则步长为θ的最佳均匀量
化器(对拉普拉斯 PDF)所提供的码率将低于具有相同输出保真度的定长编码劳埃德-马克斯量化器所
提供的码率(O'Neil[1971])。
表8.12 针对单位方差拉普拉斯概率密度函数的劳埃德-马克斯量化器
级别 2 4
t S, 1 S,
0.707 0
1414
0.395 1.102
1.810
1.087
8
S t
1 0.504 0.222
2 1.181 0.785
3 2.285 1.576
4 2.994
0 0.731
尽管劳埃德-马克斯和最佳均匀量化器不是自适应的，但以图像的局部特性为基础来调整量化级
别可得到更多的好处。在理论上，缓慢变化的区域可被精细地量化，而快速变化的区域可被更为粗糙
地量化。这种方法可以同时降低颗粒噪声和斜率过载，而在码率上仅要求极小的增加。代价是增加了
量化器的复杂性。
第8章 图 像压 缩 387
8.2.10 小波编码
类似于8.2.8节的变换编码技术，小波编码基于以下概念：对图像
参考表8.3和表8.4,小波编码用 的像素解除相关的变换系数进行编码比对原图像像素本身进行编码的 于JPEG-2000压缩标准中。 效率更高。如果变换的基函数——此时为小波函数——将大多数重要
的可视信息包装到少量系数中，则剩下的系数可被粗略地量化或截取为零，而图像几乎没有失真。
图8.45显示了一个典型的小波编码系统。为了对一幅大小为2'×2'的图像进行编码，选择一种分
析小波w和最小分解级别J-P,并用于计算图像的离散小波变换。如果小波具有互补的尺度函数φ,
则可以使用快速小波变换(见7.4节和7.5节)。不论哪种情况，计算出来的变换会将原图像的大部分
转换为水平的、垂直的和对角分解系数，这些系数具有零均值和类似拉普拉斯分布。回顾图7.1中的
图像和图7.10(a)中图像的小波变换的较简单的统计。由于许多计算的系数携带很少的视觉信息，这
些系数可以最小的系数和编码冗余来量化和编码。此外，量化可以自适应地越过P分解级别而利用
任何位置相关。一种或多种无损编码方法，如行程编码、霍夫曼编码、算术编码和比特平面编码等，
都可以应用到最后的符号编码步骤中。解码可以用与编码相反的操作来实现——量化过程除外，因为
量化过程不可能严格逆向执行。
a
b 输入图像— 小波变换 量化器 符号编码器 压缩后的图像
压缩后的图像 符号解码器 小波反变换 解压缩后的图像
图8.45 小波编码系统：(a)编码器；(b)解码器
图8.45中基于小波的系统与图8.21中的变换编码系统之间的主要差别是省略了变换编码器的子图像
处理阶段。因为小波变换的计算效率和固有的局部性(即小波的基函数在宽度上是有限的),对原图像进
行细分是没有必要的。正如稍后您将在这一节看到的那样，细分步骤的取消可以消除块效应，这种效
应正是以DCT为基础的近似图像在高压缩比下的特性。
小波的选择
作为图8.45中正变换和逆变换的基所选择的小波，影响着小波编
在数字滤波中，每个滤波器抽头 码系统的设计和性能的各个方面。它们直接影响到变换的计算复杂
都会将正被滤波信号的一个延迟形 性，或间接影响压缩和重建具有可接受误差的图像系统的能力。当变 式乘以一个滤波器系数。
换小波带有一个尺度函数时，变换可以通过一系列数字滤波操作来实
现。滤波器抽头的数量等于非零小波和尺度向量系数的数量。小波将信息包装到较少变换系数中的能
力取决于小波的压缩和重建性能。
基于小波的压缩广泛使用的展开函数是Daubechies 小波和双正交小波。后者允许将有用的分析
特性，如零矩的数量(见7.5节)合并到分解滤波器中，而将重要的综合特性，如重建的平滑度，都嵌
入到重建滤波器。
例8.25 小波编码中的小波基。
图8.46包含了图8.9(a)中的4个离散小波变换。Haar(哈尔)小波是
此例中考虑的最简单且唯一不连续的小波，这种小波被用做图8.46(a)中
的展开函数或基函数。图8.46(b)中应用最普遍的成像小波是Daubechies
DWT 细节系数已在7.3.2节中讨
论过。 固·高
388 数字图像处理(第三版)
小波和图8.46(c)中使用的对称小波，它们是具有增加对称性的Daubechies小波的一种扩展。在图8.46(d)中使
用的 Cohen-Daubechics-Feauveau 小波用于说明双正交小波的性能。正像以前的这类结果那样，所有的细节
系数都进行了标定，以便使基本结构更为突出——灰度128对应于系数值0。
正如在表8.13中看到的那样，当您从图8.46(a)移到图8.46(d)时，图8.46中变换的计算所涉及的操
作次数，从每个系数(对于每个分解级别)的4次乘法和加法增加到28次乘法和加法。所有4个变换都使
用一种快速小波变换(即滤波器组)公式进行计算。注意，当计算的复杂性(即滤波器抽头的数量)增加时，
信息包装性能也会更好。当采用哈尔小波且小于1.5的细节系数被截短为零时，总变换的33.8??都为零。
对于更复杂的双正交小波，被置零的系数的数量增加到42.1潜在的压缩率提升了近10??
a b cd
图8.46 图8.9(a)关于(a)哈尔小波。(b)Daubechies小波、(e)对称小波和
(d)Cohen-Daubechics-Feauveau 双正交小波的三尺度小波变换
表8.13 将图8.46中细节系数小于1.5的变换截短为零时，小波变换滤波器的抽头和置零系数
628
小波 滤波器抽头(尺度+小波)
2+2
8+8
8+8
17+11
置零系数
哈尔小波(见习题7.10) 33.8%
Daubechies小波(见图7.8) 40.9%
对称小波(见图7.26) 41.2%
双正交小波(见图7.39) 42.1%
分解级别选取
另一种影响小波编码计算复杂性和重建误差的因素是变换分解级别的数量。由于P尺度快速小
波变换涉及P个滤波器组的迭代，正变换和反变换计算中的操作次数会随分解级数的增加而增加。
此外，对更大分解级别导致的逐渐增大的低尺度系数的量化会影响重建图像中逐渐增大的区域。在许
多应用中，如搜索图像数据库或对逐渐重建地传送图像等，所存储或传送图像的分辨率和最低可用近
似的尺度通常决定了变换级别的数量。
第8章 图 像压 缩 389
例8.26 小波编码中的分解级别。
表8.14说明了使用双正交小波和一个固定全局阈值25对图8.9(a)进行编码时分解级别选择的影响。正
如在以前小波编码的例子中那样，只截短细节系数。表中列出了置零系数的百分比和由式(8.1-10)得到的均
方根重建误差。注意，初始分解决定多数数据压缩。在3个分解级别上，被截短系数的数量几乎没有变化。
表8.14 对图8.9(a)中大小为512x512的图像进行小波编码时分解级别的影响
分解级别(尺度或滤波器组迭代) 近似系数图像 截短的系数(%)
256x256
128×128
64×64
32×32
16×16
74.7%
91.7%
95.1%
95.6%
95.5%
重建误差(ms)
1 3.27
2 4.23
3 4.54
4 4.61
5 4.63
量化器设计
影响小波编码压缩和重建误差的最重要因素是系数量化。尽管最广泛使用的量化器是均匀的，但量
化的效果可以通过以下方法进一步改进：(1)引入一个以零为中心的较大量化间隔，称为死区，或(2)从
一个尺度到另一个尺度自适应调整量化间隔的大小。不论哪种情况，选择的量化间隔都必须随着编码
图像的比特流传送给解码器。间隔本身可根据被压缩的图像试探来决 数字信号的能量度量是样本平方
定或自动地计算出来。例如，一个全局系数阈值可作为第一级细节系数 之和。
的绝对值的中值，或作为被截短的零的数量和重建图像中保留的能量数量
的函数来计算。
例8.27 小波编码中死区间隔的选取
图8.47说明了在截短的细节系数的百分比下，死区间隔大小对图8.9(a)中基于三尺度双正交小波编
码的影响。当死区尺寸增大时，被截短系数的数量同样增大。在曲线拐点的上方(即横坐标5处),被截
短系数的数量几乎没有再增加。这是因为细节系数的直方图在零的周围有很高的峰值(例如，见图7.10)。
截短系数(%)
100
90
80
70
60
50
40
30
20
10
od0
-97,918%
零的百分比
RMSE
2 4 6 8 10 12 14
死区阙值
图8.47 死区间隔的选择对小波编码的影响
16
4
3.6
3.2
2.8
2.4
2
1.6
1.2
0.8
0.4
0
18
均方根误差(灰度级)
恩：圈
629 3
390 数字图像处理(第三版)
图8.47中与死区阈值对应的均方根重建误差在阈值5处从0增大到194个灰度级，而在阈值18处，增
大到3.83个灰度级，在这一点零的数量达到93.85??如果每个细节系数都被消掉，即百分比上升到
97.92上升约4?则重建误差会增加到12.3个灰度级。
JPEG-2000
JPEG-2000扩充了流行的 JPEG 标准，在连续色调静止图像的压缩和压缩数据的访问方面提供了
更大的灵活性。例如，可以提取 JPEG-2000 压缩图像中的一部分进行转发、存储、显示和/或编辑。
该标准以刚刚讨论的小波编码技术为基础。系数量化与单一尺度和子带相适应，并且在比特平面(见
8.2.7节)的基础上对量化后的系数进行算术编码。使用标准符号，一幅图像可以进行如下编码
(ISO/IEC[2000])。
编码过程的第一步是，通过减去2S-1,对被编码的Ssiz 比特的无符号图像的样本进行直流电平
平移。如果该图像具有多于一个的分量——如彩色图像的红色、绿色
和蓝色平面——,则单独平移每个分量。如果恰好有三个分量，则可
使用一个可逆的或非可逆的线性组合来对它们有选择地进行去相关处
理。例如，标准中非可逆的分量变换是
Y(x,y)=0.2991?(x,y)+0.5871?(x,y)+0.114I?(x,y)
Y(x,y)=-0.168751?(x,y)-0.33126/?(x,y)+0.5I?(x,y)
Y?(x,y)=-0.51?(x,y)-0.41869/?(x,y)-0.08131I?(x,y)
该标准中使用S来表示灰度分
辨率。
(8.2-61)
其中，。I和I?是级别平移过的输入分量，Y?Y?和Y?是相应的去相关分
量。如果输入分量是彩色图像的红色、绿色和蓝色平面，则式(8.2-61)
用Y℃?C,的彩色视频变换近似R'G'B'(Poynton[1996])①。变换的目
的是改善压缩效率；变换后的分量Y?和Y?是差值图像，该差值图像
的直方图在零点附近有很高的峰值。
在图像进行了级别平移和选择性去相关处理后，其分量可被分为多个像块。这些像块是被单独
处理的像素的矩形阵列。因为一幅图像可有多个分量(即它可预分为三个彩色分量),因此，像块处理
生成了块分量。每个像块分量可以独立地重建，这种处理为存取和/或加工编码图像的有限区域提供
了一种简单的机制。例如，具有16:9比率的一幅图像可被分为多个像块，以便其中一个像块是具有
4:3比率的子图像。然后，该像块可以不用访问压缩图像的其他像块就可重建。如果该图像没有被细
分为多个像块，它就是一个单一的像块。
然后，计算每个像块分量的行和列的一维离散小波变换。对于无误差压缩，这种变换是以双
正交、5-3系数尺度-小波向量(Le Gall and Tabatabai[1988])为基础的。对于非整数值变换系数还
定义了一个四舍五入过程。在有损应用中，采用9-7系数尺度-小波向量(Antonini,Barlaud,Mathieu
and Daubechies[1992])。无论哪种情况，都是使用7.4节的快速小波变换或通过一种基于提升的方法
进行计算的(Mallat[1999])。例如，在有损应用中，用于构造9-7 FWT分析滤波器组的系数在表8.15
中给出。互补的基于提升的实现涉及6种顺序“提升”和“尺度”操作：
① RCB是线性CIE(国际照明委员会)RGB 色度值的一种经伽马校正后的非线性版本。Y是亮度，C.和C,是色差(即B-Y
和R'-Y经标定后的值)。
不可逆分量变换是用于有损压缩的
分量变换。该分量本身是可逆的。可
逆压缩使用了一种不同的分量变换
第8章 图 像压 缩 391
Y(2n+1)=X(2n+1)+α[X(2n)+X(2n+2)].o-3≤2n+1<i+3
?-2≤2n<i?+2 Y(2n)=X(2n)+β[Y(2n-1)+Y(2n+1)].
Y(2n+1)=Y(2n+1)+r[Y(2n)+Y(2n+2)], ?-1≤2n+1<i+1
Y(2n)=Y(2n)+8[Y(2n-1)+Y(2n+D]. i。≤2n<i
(8.2-62)
6≤2n+1<i Y(2n+1)=-K·Y(2n+1),
≤2n<i Y(2n)=Y(2n)/K,
表8.15 不可逆9-7小波变换的低通和高通分析滤波器的冲激响应
滤波器抽头 高通小波系数
-1.115087052456994
0.591 271 7631142470
0.05754352622849957
-0.091 271 76311424948
0
低通尺度系数
0 0.6029490182363579
±1 0.2668641184428723
±2 -0.07822326652898785
±3 -0.016864 11844287495
±4 0.02674875741080976
其中，X是变换的像块分量，Y是变换结果，i和i,定义了分量内的像块分量的位置。也就是说，它
们是变换像块分量的行或列的第一个取样及紧接的下一个取样的索引。变量n基于。,i假定的和执
行的6个操作的值。如果n<i。或n≥i,则X(n)通过对称地扩充X 这些基于提升的系数是在标准中 来得到。例如，X(i-1)=X(i?+1),X(i?-2)=X(i?+2),X(i)=X(?-2), 指定的。
X(i+1)=X(-3)。提升和尺度操作的结果，Y的偶索引值等于FWT
低通滤波后的输出；而Y的奇索引值对应于高通FWT滤波后的结果。提升参数a.β.y和δ分别为-1.586
134342,-0.052980 118,0.882911 075和0.433506852。尺度因子K为1.230 174105。
刚才描述的变换生成4个子带，分别是像块分量的低分辨率近似和分量的水平、垂直和对角频率
特征。将后续迭代限制为前面的分解的近似系数，把该变换
,) am(.)
① am(u,)
重复N?次，可以得到一个
N?尺度小波变换。相邻尺
度以2的幂次空间相联系，
mlu. 并且最低尺度仅包含显式定义的原始像块分量的近似。正如 0 ②
mlu.c
在图8.48中推测的那样，这里总结了N?=2时的JPEG-2000
标准的符号。一个一般的N?尺度变换包含3N?+1个子带，
这些子带的系数对于b=N?L,N?HL,….1HL,1LH,1HH
表示为a。。该标准没有规定需要计算的尺度数量。
0 ②
图8.48 JPEG-2000二尺度小波变换像
块分量系数符号和分析增益
当每个块分量都经过处理之后，变换系数的总数等于
原图像中的取样数——但重要的视觉信息被集中于少数系
数中。为了减少表示变换所需的比特数，子带b的系数
a,(u,v)使用下式量化为值q?=(u,v):
回顾第7章可知，DWT将一幅图
像分解为一组称为子带的带限分量。
(8.2-63) 9.0.)=sela[D-]
其中量化步长△为 6～6
室～密
392 数宇图像处理(第三版)
A=2(1+) (8.2-64)
R,是子带b的标定动态范围，而e。和μ,是分配给子带系数的指数和
尾数的比特数。子带b的标定动态范围是用于表示原图像的比特数和
子带b的分析增益比特数之和。子带分析增益比特遵从图8.48所示的
简单模式。例如，子带b=1HH有两个分析增益比特。
对无误差压缩，有μ=0,R,=e和△。= 1。对不可逆压缩，标准中没有指定特定的量化步长。
相反，必须以子带为基础向解码器提供指数和尾数的比特数，这称为解释式量化，或仅针对N?L子
带，这称为导出式量化。在后一种情况下，对余下的子带使用外推的N?LL子带参数进行量化。令E。
和μ表示分配给N?L子带的比特数，则子带b的外推参数为
H=H?
不要混淆标准中对标称动态范围
的定义与第2章中紧密相关的定义
(8.2-65) Eb=Eo+n,-NL
其中，n,表示从原图像像块分量到子带b的子带分解级别的数量。
在编码过程的最后一步中，每个变换像块分量的子带的系数被排列为称为码块的矩形块，这些
码块被单独编码，一次一个比特平面。从带有非零元素的最高阶比特平面开始，每个比特平面都在
3个通道中处理。(比特平面中)每个比特仅在3个通道之一中被编码，这3个通道分别称为有效性传
播、幅度细化和提纯。然后，对输出进行算术编码，并从其他码块使用相似的途径进行组合以形成层。
一个层是来自每个代码块的编码通道的任意数量的组合。得到的层最终被分割成包，从而提供了从总
码流中提取感兴趣空间区域的附加方法。
JPEG2000解码器是前述过程的简单的反操作。重建来自算术编码的JPEG2000包的块分量子
带之后，用户选择的一些子带来解码。虽然对于特殊子带编码器可能已编码M。个比特平面，但
由于码流的嵌入性质，用户可能选择只解码N,个比特平面，这相当于使用2M-M△,的步长来量
化码块系数。所有未解码的比特都置为零，并且所得到的表示为g?,v)的系数使用下式进行反
量化：
(8.2-66)
其中，R。(u,v)表示一个反量化的变换系数，而N?(u,v)是可6(u,v)的
已解码比特平面数。重建参数r通过产生最好视觉或客观重建质量的
解码器来选择。通常，0≤r<1,常用值为1/2。然后，反量化系数使
用一个FWT'滤波器组按列和按行进行逆向变换，这些系数根据表8.15
和式(7.1-11)或通过下列基于提升的操作得到：
X(2n)=K·Y(2n), 6-3≤2n<i+3
X(2n+1)=(-1/K)·Y(2n+1),
X(2n)=X(2n)-8[X(2n-1)+X(2n+1)],
i。-2≤2n-1<i+2
6-3≤2n<i+3
X(2n+1)=X(2n+1-y[X(2n)+X(2n+2)],
X(2n)=X(2n)-β[X(2n-1)+X(2n+1)],
60-2≤2n+1<i+2
6o-1≤2n<i+1
本章之前将量化定义为不可逆的。
(这时μ=0,R=e..A=1)外，该
术语“反量化”并不意味着没有信息
处理是有损的。
损失。除不可逆 JPEG-2000压缩情形
(8.2-67)
X(2n+1)=X(2n+1)-α[X(2n)+X(2n+2)], 6≤2n+1<i
第8章 图 像压 缩 393
其中，参数a,R.y.8和K的定义与式(8.2-62)中的相同。反量化后的系数行或列元素Y(n)在需要时可
以进行对称扩展。解码的最后一步是分量像块的组合，反向分量变换(如果需要的话)和直流(DC)水
平平移。对于不可逆编码，分量反变换是
1。(x,y)=Y?(x,y)+1.402Y?(x,y)
I?(x,y)=Y?(x,y)-0.34413Y(x,y)-0.71414Y?(x,y)
I?(x,y)=Y?(x,y)+1.772Y(x,y)
(8.2-68)
变换后的像素被平移了+2Suk-1。
例8.28 基于小波的JPEG-2000编码与基于DCT的JPEG压缩的比较。
图8.49显示了图8.9(a)中单色图像的4幅JPEG-2000近似。图中相继各行说明压缩水平递增——包
括C=25,52,75和105。第一列图像是JPEG-2000编码解压缩后的结果。这些图像与原图像[见图8.9(a)]
的差示于第二列，第三列包含了第一列重建图像的局部放大部分。因为前两行的压缩率与例8.18 中的压
缩率相同，这些结果可以与图8.32(a)到(f中基于JPEG变换的结果进行定性和定量比较。
图8.49 图8.9(a)的4幅JPEG-2000近似。每一行均包含了压缩和重建后的结
果、该结果与原图像间经过缩放的差值图像，以及重建图像的局部
放大部分(请将第一行和第二行与图8.32中的JPEG结果进行比较)
图8.49第一行和第二行中的误差图像与图8.32(b)和(e)中对应图像的视觉比较表明，JPEG-2000结果
中的误差明显减小——JPEG结果的误差分别为5.4个灰度级和10.7个灰度级，而JPEG-2000的误差分别为
3.86 个灰度级和5.77灰度级。在这两种压缩水平上，计算的误差有利于基于小波的结果。除了降低重建
误差外，小波编码引人注目地增强了图像的质量(在主观感觉上)。注意，JPEG 结果中明显的块效应[见
图8.32(c)和(f)]在图8.49中并不存在。最后，我们注意到，在图8.49的第三行和第四行所能达到的压缩
用JPEG并不实际。JPEG-2000可提供压缩率超过100:1的可用图像——最讨厌的降质就是图像模糊的增加。
634
-
636
636
-
638
394 数字图像处理(第三版)
8.3 数字图像水印
8.2节中的方法和标准构成图像(图片或视频)在数字媒体和互联网上的实际散布。遗憾的是，这
样散布的图像可被重复且无误差地复制，这就把它们的所有者的权利置入风险之中。甚至为散布加过
密后，解密后的图像也不能被保护。阻止非法复制的方法之一是把称为水印的一条或多条信息项插入
潜在的易受攻击的图像，在这种方法中，水印不能从图像本身分离出来。如同水印图像的整体部分那
样。它们以各种方法来保护所有者的权益，包括：
1.版权识别。当所有者的权益被侵犯时，数字水印可提供作为所有权证据的信息。
2.用户识别或指纹。合法用户的身份可以在水印中编码，并用于识别非法复制源。
3.著作权认定。水印的存在可保证一幅图像不被篡改——假定水印被设计成对图像的任何修改
都将破坏水印。
4.自动监视。水印可以通过系统来监测，系统可在任何时间和地点跟踪所使用的图像(可搜索
放在Web网页上的图像)。对于征收版税和/或非法用户定位监测很有用。
5.复制保护。水印可制定使用和复制图像的规则(如对DVD播放器)。
在本节中，我们提供一个数字图像水印的简单综述——数字图像水印处理是把数据插入到一幅
图像中的过程，以这样的方法可以构成对图像的保护。描述过的这些方法与前一节已有的压缩技术并
没有相同之处，尽管它们的确都涉及信息编码。事实上，水印处理和压缩在某些方面是相对的。压缩
的目的是减少用于表示图像的数据量，但水印处理的目的是在图像上添加信息和数据(即水印)。正如
我们在本节其余内容中所看到的那样，水印本身可以是完全可见的或不可见的。
可见水印是一幅不透明的或半透明的子图像，或是放在另一幅图像(即用水印处理的图像)之上
的图像，因此，它对观察者是显而易见的。电视网络通常把可见水印(依照它的标识的风格)放在屏幕
的右上角或右下角。如下面的例子表明的那样，典型地，可见水印处理在空间域执行。
例8.29 简单的可见水印。
图8.50(b)中的图像是在图8.9(a)中图像的右下四分之一处叠放了图8.50(a)中水印的缩小版本。令
f.代表水印的图像，我们可把它表示为未加水印图像f和水印w的如下线性组合：
f.=(l-α)f+αw (8.3-1)
其中，常数α控制水印和衬底图像的相对可见性。如果α为1,则水印是不透明的，并且衬底图像完全
是暗的。随着α接近0,会逐渐看到更多的衬底图像和更少的水印。通常，0<α≤1;在图8.50(b)中，
α=0.3。图8.50(c)是图8.50(b)中已加水印图像和图8.9(a)中没有加水印图像之间的差。灰度128表示
0差值。注意，衬底图像透过半透明水印清晰可见。这在图8.50(b)中和图8.50(c)中所示的差值图像中是
很明显的。
与前面例子的可见水印不同，不可见水印裸眼是看不见的。它们不能被感知，但使用一个合适
的解码算法是可以恢复的。不可见性是通过作为可见的冗余信息插人水印来保证的，如人眼视觉系统
所忽略的或不能感知(见8.1.3节)的信息。图8.51(a)提供了一个简单的例子。因为8比特图像中的最
低阶比特对我们感知图像实质上没有效果，来自图8.50(a)的水印被插人或“隐藏”在其两个最低阶
比特中。使用上面介绍的符号，我们令
t.=44)+ (8.3-2)
第8章 图 像压 缩 395
并使用无符号整数算术来执行计算。用4除f,再乘4,置f的两个最低阶比特为0,用64除w,把
它的两个最高阶比特移到两个最低阶比特的位置，把两个结果相加，产生LSB 水印图像。注意，嵌
入的水印在图8.51(a)中是不可见的。把这一图像的最高有效6比特置0,并把其余的值放大到整个
灰度范围，水印就可被提取出来，如图8.51(b)所示。
a bc
igital Image LProcessing gitat lmge rew
图8.50 一个简单的可见水印：(a)水印；(b)加过水印的图像；
(c)加过水印的图像和原图像(未加水印图像)间的差
不可见水印的一个重要特性是它抵抗偶然的和故意删除它们的企图。对嵌入了易碎的不可见水
印的图像的任何修改，都会破坏这种水印。在某些应用中，如图像鉴定，这是所期望的一种特性。
如图8.51(e)和(d)所示，图8.51(a)中LSB嵌入过水印的图像包含易碎的不可见水印。如果图8.51(a)
中的图像用有损JPEG来压缩和解压缩，水印就被破坏了。图8.51(c)是图8.51(a)经压缩和解压缩后
的结果；均方根误差(rms)是2.1比特。如果我们试图用与图8.51(b)中相同的方法从这幅图像中提取
水印，那么结果是不可理解的[见图8.51(d)]。虽然有损压缩和解压缩保留了图像中的重要视觉信息.
但易碎的水印却被破坏了。
a bcd ieital Imaze Tiecssng
图8.51 一个简单的不可见水印：(a)加过水印的图像；(b)提取的水印；(c)
高质量JPEG压缩和解压缩后加过水印的图像；(d)从图(c)中提取的水印
鲁棒的不可见水印设计用于使图像能经受修改，而不管所谓的攻击是有意的还是无意的。常见的
无意攻击包括有损压缩、线性和非线性滤波、修剪、旋转、重取样和类似的操作。故意攻击包括从打
印和重扫描到添加附加的水印和/或噪声等。当然，使图像本身处在不可用状态的抗攻击是没有必要的。
图8.52显示了一个典型图像水印处理系统的基本组成部分。图8.52(a)中的编码器把水印w,插入
到图像f中，产生加过水印的图像f;图8.52(b)中的解码器提取和验证加过水印的输入f或没有
加过水印的输入f中w,的存在性。如果w,是可见的，则不需要解码器。如果它是不可见的，解码器
可能需要也可能不需要f,和w,的拷贝[在图8.52(b)中以灰色显示]去做提取或验证工作。如果使
用了f,和/或w,则水印处理系统是已知的私钥系统或受限密钥系统；如果不用，则称为公钥系统或
不受限密钥系统。因为解码器必须处理加过水印的图像和没有加过水印的图像，在图8.52中使用wo
来表示不存在水印。最后，我们注意到，为确定图像中是否存在w,,解码器必须对提取的水印w,与
w;做相关操作，并将相关操作的结果与一个预定义的阈值进行比较。阈值用于设置一个可接受“匹
配”的相似度。 图
396 数字图像处理(第三版)
定:
五 图像 水印插入 / 已加水印图像 b
水印
(已加水印或 /h 未加水印)图像 水印提取 水印
水印检测 D
图像
判决(是否
检测到水印)
,
术印
图8.52 一个典型的图像水印处理系统：(a)编码器；(b)解码器
例8.30 基于DCT的不可见的鲁棒水印。
水印嵌入和提取可如前几个例子那样在空间域执行，或变换域中执行。图8.53(a)和(c)显示了图8.9(a)
中图像的两个基于DCT的水印方法的已加水印版本，方案如下(Cox et al.[1997]):
步骤1 计算将被加人水印图像的二维DCT。
步骤2 按幅值定位它的K个最大系数c,C?,…,Ck。
步骤3 通过生成一个K元素伪随机数序列a),O?,…,w,创建一个水
印，这些伪随机数取自均值μ=0、方差σ2=1的一个高斯分布。
步骤4 使用下式，将步骤3得到的水印嵌入到步骤2得到的K个最大DCT系数中：
C=c·(+αa), I≤i≤K
伪随机数序列的性质近似随机数的
性质。它井不是真正随机的，因为它
取决于一个预先求出的初始值
(8.3-3)
其中，指定常数α>0(它控制w,更改c,的范围)。使用式(8.3-3)计算的
c代替原来的c?。
步骤5 计算来自步骤4的结果的反DFT。
通过采用由伪随机数形成的水印，并把它们散布到一幅图像感知上的重要频率分量上，α可取得较
小，以降低水印的可见性。同时，水印保持较高的安全性，因为(1)水印由无明显结构的伪随机数组成，
(2)水印被嵌入到影响整个二维空间图像的多个频率分量中(因此，它们的位置并不明显),(3)对它们的
攻击也使图像降质(也就是说，图像的大多数重要频率分量必须被改变，以影响水印)。
由于在图8.53(a)和(c)中图像的DCT系数上嵌入了来自伪随机数的水印图像，使图8.53(b)和(d)中
图像的灰度产生了改变。很明显，伪随机数必须有一个效果，即在加过水印的图像上它很小以至于看不
见。为了显示这一效果，从图8.9(a)所示没有加过水印的图像中减去图8.53(a)和(c)中的图像，并将灰度
范围放大到范围[0,255]。图8.53(b)和(d)是结果图像；它们显示了伪随机数的二维空间贡献。然面，因
为它们已被放大，您不能简单地把这些图像加到图8.9(a)的图像上，并得到图8.53(a)和(c)中的水印图像。
正如在图8.53(a)和(c)中看到的那样，它们的实际灰度干扰小到可以忽略不计。
为了确定一幅特定的图像是否是一幅事先加过水印图像的一个拷贝，该图像具有水印a),O?,…,o和
DCT系数cq,C?,…,Ck,我们采用下列步骤：
步骤1 计算该问题中图像的二维DCT。
步骤2 提取K个DCT系数(对应于水印处理过程中步骤2的q,C?…,cx的位置),并将这些系数
表示为c,c…,c。如果问题中的图像是事先加过水印的图像(没有被修改),则对于1≤i≤K有
C,=c。如果它是加过水印图像的一个修改过的拷贝(即它受到过某种攻击),则对于1≤i≤K有
第8章 图 像压 缩 397
C=c(e,是c的近似)。否则，问题中的图像将是一幅无水印图像，或是一幅具有完全不同水印的图
像——,将不会类似于原始的c。
a bc d
图8.53(a)和(c)图8.9(a)的两个加过水印的版本；(b)和(d)加过水印的图像和没有加过水印的图像
间的差(灰度被放大了)。这两幅图像显示了伪随机水印对原图像的灰度贡献(尽管缩放显著)
步骤3 使用下式计算水印a),@?,…,0g:
=-,i≤i≤k (8.3-4)
回顾一下，水印是一个伪随机数序列。
步骤4 用一个度量，如相关系数，度量),O?,…,①(来自步骤 2)
与a),O?,…,@(来自嵌入水印过程的步骤3)的相似度，
I≤i≤K
122.1节中将详细探讨相关系数。
(8.3-5)
其中，四和@是两个K元素水印的均值。
步骤5 将度量的相似度γ与一个预定义的阈值T进行比较，并进行二值检测判决：
D={6其他 (8.3-6)
换句话说，D=1表明水印a,O?,…,0 存在(关于特定的阈值D);D=0则表明水印不存在。
使用这一过程，图8.53(a)中的原始的加过水印的图像，针对其本身度量，得到一个相关系数0.9999,
即γ=0.9999。它是一个无错误的匹配。以相似的方法，当针对图8.53(a)中的图像度量时，图8.53(b)中
的图像会得到γ=0.0417,对于图8.53(a)中的加过水印的图像，它不可能被弄错，因为相关系数很小。
在结束本节时，我们注意到，前例中的基于DCT的水印处理方法可完全抵抗水印攻击，部分原
因是，这是一种私钥方法或受限密钥方法。受限密钥方法总是要比非受限密钥方法更灵活。使用图
8.53(a)中的加过水印的图像，图8.54说明了该方法抵抗各种常见攻击的能力。如图中所看到的那样，
水印检测在被执行的攻击范围之外要好得多——得到的相关系数(显示在图中每幅图像的下方)在
0.3113到0.9945间变化。在受到高质量但有损(导致7个灰度级的均方根误差)的JPEG压缩和解压缩
时，γ=0.9945。甚至当压缩和重建产生10个灰度级的均方根误差时，γ=0.7395——该图像的可
用性显著降低了。使用空间滤波的有效平滑和加入高斯噪声都没有使相关系数降到0.8230 以下。然
而，直方图均衡会把γ减小到0.5210;而旋转有最大的影响——把γ减小到0.3313。除了图8.53(a)641
中的有损PEG压缩和重建外，所有攻击都大大降低了原始加过水印的图像的可用性。
苦呈
398 数字图像处理(第三版)
Y=0.9945 y=0.7395 Y=0.8390
di
Y=0.8230 Y=0.5210 Y=0.311
图8.54 对图8.53(a)中加过水印的图像的攻击：(a)具有7个灰度级均方根误差的有损JPEG 压缩
和解压缩图像；(b)具有10个灰度级的均方根误差的有损JPEG 压缩和解压缩图像(注意
块效应);(c)用空间滤波方法平滑处理的结果；(d)加入高斯噪声的图像；(e)直方图均衡
后的图像；①旋转后的图像。每一幅图像都是图8.53(a)中加过水印图像的一个修改版本。
修改之后，它们不同程度地保留了各自的水印，如每幅图像下方的相关系数指出的那样
小结
本章的主要目的是介绍数字图像压缩的理论基础，描述最常用的压缩方法，并介绍数字图像水
印处理的相关领域。尽管我们的论述本质上是介绍性的，但参考资料提供了可以作为所讨论主题的著
述的广泛主体的人门。正如表8.3和表8.4中所列国际标准表明的那样，压缩方法在文献图像存储与
传送、互联网和商业视频传播(如 DVD)方面扮演着重要的角色。压缩也是少数几个在商业上广泛要
求对普遍接受的标准进行授权使用的图像处理领域之一。由于越来越多的图像以压缩的数字格式进行
传播，因此图像水印处理正变得越来越重要。
参考文献
通常限于8.1节的本章的介绍性材料是图像压缩的基础，并且第1章末尾引用的大多数一般的图像处
理书籍中都能看到不同形式的内容。关于人类视觉系统的其他信息见Netravali和Limb[1980],Huang[1966],
Schreiber 和Knapp[1958]及第2章结尾处引用的参考资料。关于信息论的更多材料见本书的网站或
Abramson[1963].Blahut[1987]和 Berger[1971]著述。山农的经典论文“通信中的数学理论”(A mathematical
Theory of Communication)[1948],奠定了该领域的基础，也是另一份优秀的参考资料。主观保真度准则在
Frendenall和Behrend[1960]中做了讨论。
贯穿全章，在许多例子中使用了各种压缩标准。大多数例子都是用Adobe Photoshop(可免费使用的压缩
插件)和或MATLAB实现的，这些在Gonzalez等人[2004]的著述中描述过。一般来说，压缩标准是冗长且
复杂的；我们不可能试图全部覆盖它们。关于某个特殊标准的详细信息可参阅相关标准组织——国际标准化
组织、国际电子技术委员会和或国际电信联盟——出版的文本。在标准方面的附加参考文献包括 Hunter 和
Robinson[1980],Ang 等人[1991],Fox[1991],Pennebaker和Mitchell[1992],Bhatt 等人[1997],Sikora [1997],
Bhaskaran和Konstantinos[1997].Ngan等人[1999],Weinberger等人[2000].Symes[2001].Mitchell等人[1997]和
Manjunath 等人[2001]的著述。
第8章 图 像压 缩 399
8.2节中描述的有损和无误差编码技术与8.3节中的水印处理技术，大部分是以本书引用的原始论文为基础
的。所覆盖的算法是这一领域中具有代表性的研究成果，但决不是全部工作。关于LZW编码的素材源自Ziv
和Lempel[1977, 1978]所做的原始工作。关于算术编码的素材延续了Witten,Neal和Cleary[1987]的发展。算术
编码的一种更为重要的实现在Pennebaker 等人[1988]的著述中做了综述。对于无损预测编码的较好论述，见
Rabbani和Jones[1991所著的指南。式(8.2-56)的自适应预测器来自Graham[1958]的著述。关于运动补偿的更多
材料见S. Solari[1997]的著述，它还包含一般的视频压缩和压缩标准的介绍，以及Michell等人[1997]的著述。
8.3节中基于DCT的水印处理技术以Cox等人[1997]的论文为基础。关于水印处理的更多内容见Cox等人[2001]
的书籍和Parhi和Nishitani[1999]的著述，还可参见S.Mohanty[1999]的论文。
许多综述性文章致力于图像压缩领域，值得注意的是Netravali和Limb[1980],A.K.Jain[1981]的著述，
IEEE Transactions on Communications[1981]关于图像通信系统的特刊，Proceedings of IEEE[1980]关于图形
编码的特刊，Proceedings of the IEEE[1985]关于视觉通信系统的特刊，IEEE Transactions onImage Processing
[1994]关于图像序列压缩的特刊，以及IEEE Transactions on Image Processing[1996]关于矢量量化的特刊。
此外，IEEE Transactions on Image Processing.IEEE Transactions on Circuits and Systems for Viedo Technology
和IEEE Transactions on Multimedia等刊物中也包含有关于视频和静止图像压缩、运动补偿和水印处理方面
的文章。例如，Robinson[2006].Chandler和Hemami[2005] Yan和Cosman [2003],Boulgouris等人[2001].Martin
和Bell [2001],Chen和Wilson[2000],Hartenstein等人[2000],Yang和Ramchandran [2000].Meyer等人[2000],S.
Mitra等人[1998].Mukherjee和Mitra[2003],Xu等人[2005], Rane和Sapiro[2001].Hu等人[2006],Pi等人[2006],
Dugelay 等人[2006]和Kamstra和Heijmans[2005],都可作为进一步阅读和参考的起点。
习题
8.1(a)变长编码过程能否用于压缩具有2”个灰度级直方图均衡过的图像?请解释其原因。
(b)这样一幅图像是否包含可以用于数据压缩的空间和时间冗余?
8.2 行程编码的一种变形涉及：(1)只对0行程或1行程(而不是两者)进行编码，(2)在每行的开始处
分配一个特殊的码，以减小传输误差的影响。一种可能的编码对是(x?,A),其中x和x分别表示
第k个行程的起始坐标和行程。编码(0,0)用于表示每个新行。
(a)当对一幅大小为2"×2"的二值图像进行行程编码时，推导为确保数据压缩而要求的每条扫描线
最大平均行程的一般表达式。
(b)计算n=8时的最大允许值。
8.3 考虑灰度数据为[255,118,127,182,18,178,82,55}的一条8像素的线。如果使用4比特精度来均
匀量化它，计算量化后的数据的均方根误差和均方根信噪比。
★8.4 虽然量化导致信息损失、但对人眼来说有时它是不可见的。例如，当8比特像素被均匀量化为更
少的比特/像素时，通常会出伪轮廓。使用改进的灰度缩放(IGS)量化方法，可以减少或消除它。
一个和值(开始时置0)是由当前的8比特灰度值和前一个生成的和的4个最低阶比特形成的。如
果灰度值的4个最高阶比特是1111?,而加0000?替换它。产生的和的4个最高阶比特被用做编码
后的像素值。
(a)对灰度数据(108,139.135,244,172,178,56,97)构造IGS 编码。
(b)对解码后的IGS数据，计算均方根误差和均方根信噪比。
8.5 对一幅大小为1024×1024、熵为4.2比特/像素[使用式(8.1-7)从其直方图计算得到]的8比特图
像进行霍夫曼编码。
(a)所期望的最大压缩率是多少?
(b)它能得到吗?
(c)如果要求较高级别的无损压缩，还应该做什么? 医:
名字
400 数字图像处理(第三版)
★8.6 以e为底的信息单位通常称为一个奈特(nat),以10为底的信息单位则称为一个哈特利(Hartley)。
计算将这些单位与以2为底的信息单位(比特)联系起来的转换因子。
★8.7 证明，对于一个有q个符号的零记忆信源，熵的最大值为log q。当且仅当所有信源符号等概率出
现时，熵才能达到最大值。[提示：考虑量logq-H(z)并注意不等式Inx≤x-1。]
8.8(a)对于一个4符号信源，有多少唯一的霍夫曼编码?
(b)构建它们。
8.9 考虑如下大小为4×8的8比特图像：
21 21 95 95 169 169 243243
21 21 95 95 169 169243 243
21 21 95 95 169 169243 243
21 21 95 95 169 169 243 243
21 21 95 95 169 169 243 243
(a)计算该图像的熵。
(b)用霍夫曼编码压缩该图像。
(c)计算霍夫曼编码能达到的压缩率和效率。
★(d)考虑对一对像素而不是单个像素进行霍夫曼编码。也就是说，考虑由产生原图像的零记忆信源
的第二次扩展产生的图像。当作为像素对看待时，图像的熵是什么?
(e)考虑对相邻像素间的差值进行编码。新的差值图像的熵是什么?关于压缩图像，它告诉我们做
什么?
(f)解释(a),(d)和(e)中熵的差别。
8.10 用图8.8中的霍夫曼码，对编码串01010010000011101011进行解码。
8.11 对于0≤n≤20,计算Golomb码G?(n)
8.12 针对Golomb码G(n),写出解码的通用过程。
8.13 为什么用式(8.2-2)的几何概率密度函数不能计算n≥0的非负整数的霍夫曼码?
8.14 对于0≤n≤15,计算指数Golomb码G,(n)。
★8.15 针对指数Golomb码Gp(n),写出解码的通用过程。
8.16 在式(8.2-3)中，对于0<p<1,画出作为p的函数的最佳Golomb编码参数m的曲线。
8.17 给定一个4符号信源{a,b,c,d]、信源概率为[0.1,0.4,0.3,0.2},对序列abcda进行算术编码。
★8.18 算术解码过程是与编码过程相反的过程。用给定的编码模型，对消息0.32256进行解码。
符 号 概 率
a
e
i
0.2
0.3
0.1
o 0.2
u
!
0.1 0.1
8.19 使用8.2.4节中的LZW编码算法，对7比特ASCII码字符串“AAAAAAAAAAA”进行编码。
★8.20 为例8.7的LZW编码输出的解码操作设计一种算法。由于编码期间使用的字典此时不能使用，所
以在对输出进行解码时必须重新生成码书。
8.21 对BMP编码序列{127,0.5,25,29,40,103,52,75,82]进行解码。
8.22 (a)构造完整的4比特格雷码。
(b)创建一个通用的过程，将格雷码的数字转换成与它等价的二进制码，并用它对0111010100111
进行解码。
第8章 图 像压 缩 401
8.23 使用CCITT Group4压缩算法对如下两行的第二行进行编码：
01100111001111111100001
11111000111000111111000
假设初始参考元素a。位于第二行的第一个元素上。
8.24 (a)列出JPEG DC系数第3类差的所有成员。
(b)使用表A.4计算它们的默认霍夫曼编码。
8.25 使用MAD最佳准则、单像素精度和最大允许的16个像素的位移，找到一个8×8宏块的最佳运动
向量需要多少计算?对于1/4像素精度，它变成多少次计算?
8.26 对于运动补偿，使用B帧的优点是什么?
8.27 画出针对图8.39中编码器的伴随运动补偿视频解码器的方框图。
8.28 用一个二阶预测器对自相关函数是式(8.2-49)在p=0时的形式的一幅图像进行DPCM编码。
(a)构造自相关矩阵R和向量r。
(b)找出最佳预测系数。
(c)计算使用最佳系数得到的预测误差的方差。
8.29 推导出L=8时的劳埃德·马克斯判决-重建级别和均匀概率密度函数。
-他
8.30 来自一所著名研究型医院的一位放射学家最近参加了一次医学会议，会上展示了一种可以通过标
准T1(1.544 Mbps)电话线路传输4096×4096大小的12比特数字化X光图像的系统。该系统使用
一种渐进技术来传输压缩形式的图像，这种技术可在观察站首先重建出X射线图像的相当好的近
似图像，然后逐步细化产生一幅无误差的显示。产生第一幅近似图像的数据传输要花 5~6 秒的时
间。在接下来的1分钟时间内，每隔5~6秒(平均)会进行一次细化，在重建的X射线图像中，第
一次和最后一次细化有最大和最小的影响。这位物理学家对这套系统的印象很好，因为她可以使
用第一幅X射线图像的近似开始进行诊断，而在生成无误差X射线重建图像时就可以完成诊断。
在回她的办公室的途中，她拟定了一份报送给医院领导的采购意向。遗憾的是，医院正值预算紧
张时期，因为最近雇用了一位年轻有为的电气工程专业毕业生。为了满足放射学家的要求，院方
向年轻的工程师布置了设计这样一个系统的任务(院方认为设计和构造一个类似的自用系统成本会
更低。医院现在拥有这样的系统的某些部件，但传输原始X射线数据的时间要超过2分钟)。院
方要求工程师在下午的工作会议上拿出一个初始框图。由于时间紧且手头只有一本《数字图像处
理》教材(当然需要这本书),工程师只能在概念上设计一个系统，以满足传输和相关的压缩要求。
请构建该系统的概念框图，并详细说明您将建议的压缩技术。
8.31 证明由式(8.2-62)定义的基于提升的小波变换与使用表8.15中系数实现的传统FWT滤波器组是等
价的。依据a,β,y.δ和K定义滤波器系数。
8.32 计算一幅JPEG-2000编码图像的子带的量化步长。该图像采用导出式量化，对2LL子带的尾数和
指数分配8比特数据。
8.33 您如何在频率域将水印加到一幅图像上?
★8.34 以离散傅里叶变换为基础，设计一个不可见水印处理系统。
8.35 以离散小波变换为基础，设计一个不可见水印处理系统。 爱;国
图器
第9章 形态学图像处理
形体与特征，面容与肢体，我与兄弟如此相像，以至于人们经常
把我当做他，总是把我们的身份搞混。
——享利·桑布鲁克·利，《科克伊尼之颂：双胞胎》
引言
形态学(morphology)一词通常表示生物学的一个分支，该分支主要研究动植物的形态和结构。这
里，我们使用同一词语表示数学形态学的内容，将数学形态学作为工具从图像中提取表达和描绘区域
形状的有用图像分量，如边界、骨架和凸壳等。我们对预处理或后处理的形态学技术也感兴趣，比如
形态学过滤、细化和修剪等。
在下面几节中，我们将建立并说明数学形态学中的几个重要概念。这里介绍的许多概念可在n
维欧氏空间E"中用公式表达，然而，我们的兴趣一开始是在二值图像上，这种图像的各个分量是Z
的元素(见2.4.2节)。在9.6节，我们的讨论将扩展到灰度图像。
本章的材料开始从纯粹的输入和输出都是图像的图像处理，转变为输入是图像而输出是从这些
图像中提取属性的处理，在这个意义上1.1节做了定义。像形态学及与其相关概念这样的工具数学基
础的基石，它用来于从图像中提取“内涵”。本书的余下章节中将探讨和应用其他方法。
9.1 预备知识
数学形态学的语言是集合论。同样，形态学为大量的图像处理问
在继续阅读之前，请读者回顾一 题提供一种一致且有力的方法。数学形态学中的集合表示图像中的对 下24.2节和2.6.4节的内容。
象。例如，在二值图像中，所有白色像素的集合是该图像的一个完整
的形态学描述。在二值图像中，问题中的集合是二维整数空间Z的元素(见2.4.2节),在该空间中，
集合的每个元素都是一个多元组(二维向量),这些多元组的坐标是图像中一个白色(或黑色，取决于
事先的约定)像素的坐标(x,y)。前一章讨论过的灰度数字图像可以表示为其分量在空间Z中的集合。
在在这种情况下，集合中每个元素的两个分量提供一个像素的坐标，第三个分量则对应于其离散灰度
值。更高维度空间中的集合可以包含其他的图像属性，譬如颜色和随时间变化的分量。
除2.6.4 节中基本的集合定义外，集合的反射和平移的概念在形
态学中用得也很广泛。一个集合B的反射表示为B,定义如下： 集合反射操作类似于空间卷积中执
行的翻转(旋转)操作(见342节。
第9章 形态学图像处理 403
B={wlw=-b,beB} (9.1-1)
如果B是描述图像中物体的像素的集合(二维点),则B是B中(x,y)坐标被(-x,-y)替代的点的集合。
图9.1(a)和(b)显示了一个简单的集合及其反射①。
a b c
B
Z2
B
z1
(B):
图9.1 (a)一个集合；(b)该集合的反射；(c)距离为z的平移
集合B按照点z=(z,z?)表示为(B)?的平移定义如下：
(B)?={clc=b+z,b∈B} (9.1-2)
如果B是描述图像中物体的像素集合，则(B)?是B中(x,y)坐标被(x+z,y+z?)替代的点的集合。
图9.1(c)使用来自图9.1(a)的集合B说明了这一概念。
在形态学中集合的反射和平移广泛用来表达基于结构元(SE)的操作：研究一幅图像中感兴趣特
性所用的小集合或子图像。图9.2的第一行显示了结构元的几个例子，其中每一个涂阴影的方块表示
SE的一个成员。如果给定结构元中的一个位置是否是该SE集合的成员没有关系时，该位置用“×”
来标记，表示一个“不关心”条件，如稍后在9.5.4节中定义的那样。除了元素是SE的成员的定
义之外，还必须指定结构元的原点。图9.2中各种SE的原点
由一个黑点指出(尽管将 SE 的中心放在其重心处是很普遍
的，但通常原点的选择是依赖于问题的)。当SE 对称且未显
示原点时，则假定原点位于对称中心处。
●
当对图像操作时，我们要求结构元是矩形阵列。这是通
过添加最小可能数量的背景元素(图9.2中所示的非阴影部分)
形成一个矩形阵列来实现的。图9.2第二行中的第一个和最后
一个SE说明了该过程。该行中的其他 SE已经是矩形形式。
为介绍在形态学中如何使用结构元，我们考虑图9.3。
图9.3(a)和(b)显示了一个简单的集合和一个结构元。如前一
段提到的那样，计算机实现要求用添加背景元素的方法把 A
也转换为一个矩形阵列。当结构元的原点位于原始集合的边
界上时，背景边界要大到足以适应整个结构元(这类似于如
图9.2 第一行：结构元的例子；第二
行：转换为矩形阵列的结构
元。点表示结构元的中心
①当对图像操作时，如图9.1中的集合，我们使用阴影来表示正考虑集合的成员的点(像素)。在处理二值图像时，感兴趣的集合
是对应于物体的像素。我们使用白色像素来显示这些集合，而其他像素则显示为黑色。术语前景和背景通常分别用于表示图像
中为物体和非物体定义的像素集合。
650 51
固;因
404 数字图像处理(第三版)
3.4.2节讨论的空间相关和卷积的填充操作)。在这种情况下，结构元
的大小为3×3,原点位于中心，所以包围整个集合的一个元素的边界
是足够的，如图9.3(c)所示。就像在图9.2中那样，必须使用最小可能
数量的背景元素填充结构元，使它成为一个矩形阵列[见图9.3(d)]。
A
B
在后面的说明中，我们会添加足够
的背景点来形成矩形阵列，但在含义
明确的情形下，为简化图形，我们假
定已进行了填充操作。
a b c d e
图9.3(a)一个集合(每个阴影方块都是集合的一个元素);(b)结构元；(c)使用背景元素填充集合形成的一
个矩形阵列，并且提供了一个背景边界；(d)矩形阵列形式的结构元；(e)由结构元处理过的集合
假定我们定义一个用结构元B在集合A上的操作如下：通过让B在A上运行，以便B的原点访
问A的每一个元素，来创建一个新集合。在B的每个原点位置，如果B完全被A包含，则将该
位置标记为新集合的一个成员(阴影所示);否则，将该位置标记为非新集合的成员(非阴影所示)。
图9.3(e)显示了这一操作的结果。我们看到，当B的原点位于A的边界元素上时，B的一部分将不再
包含在A中，从而排除了B处在中心位置的点作为新集合的成员的可能。最终结果是集合的边界被
腐蚀掉了，如图9.3(e)所示。当我们使用“结构元包含在集合中”这样的术语时，我们明确地指出A
和B的元素完全重叠。换句话说，虽然我们用包含阴影和非阴影的元素阵列来说明A和B,但在确
定B是否包含于A中时，我们只考虑两个集合中的阴影元素。这些概念是下一节内容的基础，因此
在继续学习之前全面理解图9.3中的概念是很重要的。
9.2 腐蚀和膨胀
我们通过研究腐蚀和膨胀这两个操作来开始形态学的讨论。这些操作是形态学处理的基础。事
实上，本章中讨论的许多形态学算法都是以这两种原始操作为基础的。
9.2.1 腐蚀
作为Z2中的集合A和B,表示为AOB的B对A的腐蚀义为
AOB={zl(B)?EA}(9.2-1)
表面上，该式指出B对A的腐蚀是一个用z平移的B包含在A中的所有的点z的集合。在下面的讨
论中，假定集合B是一个结构元。式(9.2-1)是上节末尾讨论的图9.3(e)中的例子的数学公式。因为B
必须包含在A中这一陈述等价于B不与背景共享任何公共元素，故我们可以将腐蚀表达为如下的等
价形式：
AOB={zI(B)?NA=0} (9.2-2)
其中，如2.6.4节所定义的那样，A°是A的补集，?是空集。
第9章 形态学图像处理 405
图9.4显示了腐蚀的一个例子。A和B的元素显示为阴影，背景显示为白色。图9.4(e)中的实线
边界是B的原点进一步移动的界限，若超出该界限，则会导致结构元不再完全包含于A中。这样，
该边界内的点的轨迹(B的原点位置)就构成了B对A的腐蚀。我们在图9.4(c)中使用阴影显示了该腐
蚀的结果。记住，腐蚀是简单地满足式(9.2-1)或式(9.2-2)的z值的一个集合。图9.4(c)和(e)中虚线
所示的集合A的边界仅供参考，它不是腐蚀操作的一部分。图9.4(d)显示了一个拉长的结构元，图9.4(e)
显示了该结构元对集合A的腐蚀。注意，原来的集合已被腐蚀为一条直线。
d
d
AOB
A
d/8 3d/4 d/8
d/4
id/2
●d
a bc d e heB d/2
B 3d/4 d/8 d/8
图9.4 (a)集合A;(b)方形结构元B;(c)B对A的腐蚀，如阴影部分所示；(d)拉长的结构元；
(e)用拉长后的结构元B对A的腐蚀。(c)和(e)中的虚线边界是集合A的边界，仅供参考而显示
式(9.2-1)和式(9.2-2)不是腐蚀的唯一定义形式(见习题9.9和习题9.10中另外两种等价的定义形
式)。然而，这些式子较之其他公式具有独特的优点，当把结构元B看成是一个空间模板时(见3.4.1
节),它们更直观。
例9.1 使用腐蚀去除图像的某些部分。
假设我们希望去掉图9.5(a)中连接中心区域到边界焊接点的线。使用一个大小为11×11且元素都是1
的方形结构元腐蚀该图像，如图9.5(b)所示，大多数为1的线条都被去除了。位于中心的两条垂直线被细
化了，但没有被完全去除，原因是它们的宽度大于11个像素。把SE的大小改为15x15,并再次腐蚀原
图像，如图9.5(c)所示，所有的连线都去除了[一种替代的方法是，也可以使用11×11的SE对图9.5(b)
的图像再进行腐蚀]。增大结构元的尺寸甚至会消除更大的部件。例如，使用大小为45×45的结构元，可
去除边界的焊接点，如图9.5(d)所示。
a bcd 丰
图9.5 使用腐蚀去除图像中的部件：(a)一幅大小为486×486的连线模板二值图像；(b)~
(d)分别使用大小为11×11,15×15和45×45的结构元腐蚀的图像。SE的元素都是1 图:③
406 数字图像处理(第三版)
我们从这个例子看到，腐蚀缩小或细化了二值图像中的物体。事实上，我们可以将腐蚀看成是形态
学滤波操作，这种操作将小于结构元的图像细节从图像中滤除(去除)了。在图9.5中，腐蚀执行了一个“线
滤波”的功能。我们在9.3节和9.6.3节将会返回到形态学滤波这一概念。
9.2.2 膨胀
A和B是Z中的集合，表示为A田B的B对A的膨胀定义为
A田B={z1B)?∩A≠0} (9.2-3)
这个公式是以B关于它的原点的映像，并且以z对映像进行平移为基础的(见图9.1)。B对A的膨胀
是所有位移z的集合，这样，B和A至少有一个元素是重叠的。根据这种解释，式(9.2-3)可以等价
地写为
AOB={z1(B)?NA]sA} (9.2-4)
与以前一样，我们假定B是一个结构元，A是被膨胀的集合(图像物体)。
式(9.2-3)和式(9.2-4)并不是当前所用的膨胀的唯一定义(见习题9.11和习题9.12中两种不同但等
价的定义)。然而，当把结构元B视为一个卷积模板时，前述定义与其他定义形式相比有显著的优
点，这种定义形式更直观。B关于其原点翻转(旋转),然后逐步移动以滑过整个集合(图像)A,这一
基本过程类似于3.4.2节中介绍的空间卷积。然而，要记住，膨胀以集合操作为基础，因此，是一
种非线性操作，而卷积是一种线性操作。
与腐蚀不同，腐蚀是一种收缩或细化操作，膨胀则会“增长”或“粗化”二值图像中的物体。
这种特殊的方式和粗化的宽度由所用的结构元来控制。图9.6(a)显示了与图9.4中所用集合相同的集
合，图9.6(b)显示了一个结构元(在这种情况下，B=B,因为SE关于其原点对称)。作为参考，图9.6(c)
中的虚线显示了原始集合，实线显示了一个界限，B的原点进一步移动z,若超出了这一界限，会导致
B和A的交集为空。因此，处在该边界上或该边界内的所有点就构成了B对A的膨胀。图9.6(d)显
示了一个设计用来实现垂直方向膨胀比水平方向膨胀更多的结构元，图9.6(e)则显示了使用这个结构
元进行膨胀的结果。
655
656
a bcd e
d
d/2 d/4
d ● d d
A
A田B
d/8 d
d/8 B=B d/2
A田B
d/8 d d/8
图9.6(a)集合A:(b)方形结构元(黑点表示原点);(c)B对A的膨胀，显示为阴影；(d)拉长的结构元；
(e)使用这个结构元对A膨胀。图(c)和图(e)中的点线的边是集合A的边界，仅作为参考而显示
例9.2 膨胀的说明。
膨胀的最简应用之一是桥接裂缝。图9.7(a)显示了与我们研究过的图4.49相同的带有断裂的字符的图
像，在图4.49中是用低通滤波进行连接的。已知断裂的最大长度为两个像素。图9.7(b)显示了能够修复这
些断裂的结构元(注意，替代阴影，我们用1表示SE的元素，而用0表示背景；这是因为现在SE被当做
第9章 形态学图像处理 407
一幅子图像来处理，而不是一幅图形)。图9.7(c)显示了使用这个结构元对原图像进行膨胀后的结果。裂
缝已被桥接。形态学方法较之我们在图4.49中用于桥接断裂的低通滤波方法的一个直接的优点，就是形
态学方法可在一幅二值图像中直接得到结果。另一方面，低通滤波方法则从一幅二值图像开始，生成一
幅灰度图像，它需要用一个阈值函数将灰度图像转换为二值图像。
a b c Historicelly, certain coimputer
programs were written using
only two digits ratherthan
four to define the appticable
vear.Accordingly. the campany's software may recoonize a date using "00 as 1900 rother than the veer
2000.
司
0
1
0
1
1
1
0
1
0
Historically,certain computer
programs were written using
only two digits rather than
four to deflne the appllcable
year.Accordingly, the
company's software may recognize a date using "00
8s 1900 rather than the year
2000. ea
图9.7 (a)具有断裂字符的低分辨率样品文本(见放大的视图);
(b)结构元；(c)图(b)对(a)的膨胀。断裂线段被连起来了
9.2.3 对偶性
膨胀和腐蚀彼此关于集合求补运算和反射运算是对偶的，即
(AOB)=A田B (9.2-5)
和
(A田B)°=AOB (9.2-6)
式(9.2-5)指出，B对A的腐蚀是B对A的膨胀的补，反之亦然。当结构元关于其原点对称时(通常
如此),因为B=B,故对偶性特别有用。这样，我们可以用相同的结构元简单地使用B膨胀图像的
背景(即膨胀A),并对该结果求补就可得到B对该幅图像的腐蚀。类似的说明适用于式(9.2-6)。
为了说明建立形态学表达式有效性的一种典型方法，我们正式证明式(9.2-5)的有效性。由腐蚀
的定义，我们有
(AOB)={zl(B)?CA}
如果集合(B),包含在集合A中，则(B)?∩A°=0,在这种情况下，上式变为
(AOB)°={zI(B)?∩A°=O}
但是，满足(B).∩A=?的z的集合的补集是满足(B)?NA≠0的z的集合，因此，
(AOB)°={2I(B)?NA≠0}=A田B
其中，最后一步来自式(9.2-3)。这就结束了该证明。采用类似的推理可以证明式(9.2-6)(见习题9.13)。
9.3 开操作与闭操作
如您所见到的那样，膨胀会扩大一幅图像的组成部分，而腐蚀则会缩小一幅图像中的组成部分。
在本节中，我们讨论另外两个重要的形态学操作：开操作与闭操作。开操作一般会平滑物体的轮廓、
断开较窄的狭颈并消除细的突出物。闭操作同样也会平滑轮廓的一部分，但与开操作相反，它通常会
弥合较窄的间断和细长的沟壑，消除小的孔洞，填补轮廓线中的断裂。 ③～8
固:
408 数字图像处理(第三版)
结构元B对集合A的开操作，表示为AoB,其定义如下：
AoB=(AOB)田B (9.3-1)
因此，B对A的开操作就是B对A的腐蚀，紧接着用B对结果进行膨胀。
类似地，用结构元B对集合A的闭操作，表示为A·B,定义如下：
A-B=(A田B)OB (9.3-2)
上式说明，B对集合A的闭操作就是简单地用B对A膨胀，紧接着用B对结果进行腐蚀。
开操作有一个简单的几何解释(见图9.8)。假设我们把结构元B视为一个(扁平的)“转球”。然
后，AoB的边界由B中的点建立：当B在A的边界内侧滚动时，B所能到达的A的边界的最远点。
开操作的这种几何拟合特性导致了一个集合论公式，该公式表明B对A的开操作是通过拟合到A的
B的所有平移的并集得到的。也就是说，开操作可以表示为一个拟合处理：
AoB=U{(B)?I(B)?CA} (9.3-3)
其中U(}表示大括号中所有集合的并集。
A°B=U|(B),(B)?CA] a bcd A
B在A中的平移
●B
图9.8 (a)结构元B沿集合A的内侧边界滚动(黑点表示B的原点);(b)结构元；(c)粗线是开操
作的外部边界；(d)完全的开操作(阴影部分)。为清楚起见，在图(a)中我们未对A加阴影
除了我们现在是在边界的外侧滚动B(见图9.9)之外，闭操作有类似的几何解释。如下面所讨论
的那样，开操作和闭操作彼此对偶，所以闭操作在边界外侧滚动球体是意料之中的事情。从几何上讲，
当且仅当对包含w的(B),进行的任何平移都有(B)?∩A≠0时，点w才是A-B的一个元素。图9.9说
明了闭操作这一基本的几何性质。
B a b c A·B
A
图9.9(a)结构元B沿集合A的外侧边界滚动；(b)粗线是闭操作的外部边界；
(c)完全的闭操作(阴影部分)。为清楚起见，在图(a)中我们未对A加阴影
例9.3 形态学开操作和闭操作的简单说明。
图9.10进一步说明了开操作和闭操作。图9.10(a)显示了一个集合A,图9.10(b)显示了腐蚀处理期
间一个圆盘形结构元的各个位置。当腐蚀完成后，得到图 9.10(c)所示的分离的图形。注意，两个主要部
第9章 形态学图像处理 409
分之间的桥接的消失。桥接部分的宽度与结构元的直径相比要细；也就是说，集合的这部分不能完全包
含结构元，因此违反了式(9.2-1)的条件。该物体最右边的两个部分也是如此。圆盘无法拟合的突出部分
已被消除。图9.10(d)显示了对腐蚀后的集合进行膨胀的处理，图9.10(e)显示了开操作的最终结果。注
意，方向向外的角变圆了，而方向向内的角则未受影响。
类似地，图9.10f)到(i)显示了使用同一结构元对A进行闭操作的结果。我们注意到方向向内的角变
圆了，而方向向外的角则保持不变。在A的边界上，最左边的突入部分的尺寸明显地减小了，因为在这
个位置上圆盘无法拟合。还要注意使用圆盘形结构元对集合A进行开操作和闭操作所得到的物体的各个
部分都平滑了。
bc
d e
A
fgh i
AOB
A·B=(AOB)④B
AB
A·B=(A+B)OB
图9.10 形态学开操作和闭操作。结构元是在图(b)中的各个位置显
示的小圆。为清楚起见，SE未加阴影。黑点是结构元的中心
如同膨胀和腐蚀的情形那样，开操作和闭操作彼此关于集合求补和反射也是对偶的，即
(A-B)=(A°。B) (9.3-4)
和
(AoB)°=(A·B) (9.3-5)
我们将该结果的证明作为练习留给读者(见习题9.14)。
开操作满足下列性质：
(a)AoB是A的一个子集(子图像)。
(b)如果C是D的一个子集，则CoB是DoB的一个子集。
(e)(AoB)。B=AoB。 图：图
410 数字图像处理(第三版)
类似地，闭操作满足下列性质：
(a)A是A·B的一个子集(子图像)。
(b)如果C是D的一个子集，则C·B是D·B的一个子集。
(c)(A-B)-B=A-B。
注意，由两种情况下的条件(c)可知，算子应用一次后，一个集合的多次开操作或闭操作没有影响。
例9.4 针对形态学滤波使用开操作和闭操作。
形态学操作可用于构造与第3章中讨论的空间滤波概念相类似的滤波器。图9.11(a)中的二值图像显
示了被噪声污染的指纹图像的一部分。这里，噪声本身表现为在黑色背景上的随机亮元素和指纹较亮部
分上的暗元素。我们的目的是消除噪声及其对印刷的影响，同时使图像的失真尽可能小。由开操作后紧
跟着闭操作组成的形态学滤波器可用来实现这一目的。
660
A
AOB 1 i
B
国 1
1 :
AOB)田B=A·B
A·B)中B |(A B)田B|eB=(A:B)·B
图9.11 (a)噪声图像；(b)结构元；(c)腐蚀后的图像；(d)A的开操作；(e)开操作
的膨胀；(f)开操作的闭操作(原图由美国国家标准和技术研究所提供)
图9.11(b)显示了所用的结构元。图9.11的余下部分显示了滤波操作一步步的顺序。图9.11(c)显示
了使用结构元对A进行腐蚀的结果。背景噪声在开操作的腐蚀阶段被完全消除，因为这种情况下的所有
噪声分量都比结构元小。包含在指纹中的噪声元素(黑点)的尺寸实际上却增大了。原因是当物体被腐蚀
时，这些元素在尺寸增大的内部边界。这种增大可通过对图9.11(c)执行膨胀来抵消。图9.11(d)显示了该
结果，指纹中包含的噪声分量的尺寸被减小了，或完全被消除了。
刚才描述的两个操作构成了B对A的开操作。我们注意到，在图9.11(d)中，开操作的实际效果实质
上是从背景和指纹本身中消除所有的噪声。然而，在指纹纹路间却产生了新的断裂。为防止这种不希望
的影响，我们在开操作上执行膨胀，如图9.11(e)所示。大部分断裂被恢复了，但纹路却变粗了，这是可
第9章 形态学图像处理 411
由腐蚀来弥补的一种情形。图9.11(f所示的结果构成了图9.11(d)的开操作的闭操作。最后的结果是噪声
斑点清除得相当干净，但这种方法有缺点，即有些指纹纹路没有被完全修复，并还有间断。对这种情况
也并非毫无指望，只是因为在保持连续性方面没插入任何的条件而已(我们将在例9.8 中再次讨论这一问
题，并在11.1.7节中论证处理这一问题的方法)。
9.4 击中或击不中变换
形态学击中或击不中变换是形状检测的一个基本工具。我们将借助于图9.12来说明这一概念。
图9.12显示了一个由三种形状(子集)组成的集合A,三种形状分别由C,D和E表示。图9.12(a)到(c)
中的阴影部分表示原始集合，而图9.12(d)和(e)中的阴影部分显示形态学操作的结果。目的是找到三
种形状之一的位置，譬如说D的位置。
令每种形状的原点位于其重心处。设D被一个小窗口W包围。关于W的D的局部背景定义为集
合差(W-D),如图9.12(b)所示。图9.12(c)显示了A的补集，后面将会用到它。图9.12(d)显示了用D
对A的腐蚀(虚线仅供参考)。回顾可知，D对A的腐蚀是D的原点位置的集合，这样，D完全包含在
A中。换一种方法解释，AOD在几何上可被看成是D的原点的所有位置的集合，在每个这样的位置，
D找到A中的一个匹配(击中)。记住，在图9.12中，A仅由三个不相交的集合C,D和E组成。
名心 A-CUDUE w (W-D)
E 原点
D
A
(AOD)
Ae(W-D)
7
AG(W-D)
图9.12(a)集合A;(b)窗口W和关于W的D的局部背景(W-D);(c)A的补集；
(d)D对A的腐蚀：(e)(W-D)对A的腐蚀；(1)(d)和(e)的交集，如所
希望的那样，该交集显示了D的原点的位置。黑点是C,D和E的原点
(AeD)n(Ae[w-Dp-
图;③
室：图
412 数字图像处理(第三版)
图9.12(e)显示了局部背景集合(W-D)对A的补集的腐蚀。图9.12(e)中的外部阴影区域是腐蚀的
部分。我们从图9.12(d)和(e)注意到，D精确地拟合A内部的位置集合是由D对A的腐蚀和(W-D)对
A的腐蚀的交集，如图9.12f所示。这个交集正好是我们要寻找的位置。换句话说，如果B表示
由D及其背景组成的集合，则B在A中的匹配(或匹配集合),表示为AOB,是
AOB=(AOD)∩[Ae(W-D)] (9.4-1)
我们可以通过令B=(B?,B?)对这种表示法稍微做些推广，其中B?是由与一个目标相联系的B
的元素构成的集合，B?是由与相应背景相联系的B的元素构成的集合。根据前面的讨论，
B?=D,B?=(W-D)。用这种表示方法，式(9.4-1)变为
AOB=(AOB?)∩(AOB?) (9.4-2)
因此，集合AOB包含了所有的原点，同时，在这些原点处，B?在A中找到了一个匹配(击中),B?
在A中也找到了一个匹配。使用式(2.6-19)中给出的集合差的定义，及式(9.2-5)中给出的腐蚀和膨
胀间的对偶关系，我们可将式(9.4-2)写为
AOB=(AOB?)N(A田B?) (9.4-3)
然而，式(9.4-2)更为直观。我们将上述三个公式称为形态学击中或击不中变换。
使用与物体有关的结构元B?和与背景有关的结构元B?的原因基于一个假设的定义——仅当两个
或多个物体形成相脱离的(断开的)集合时，这些物体才是可分的。通过要求每个物体至少被一个像素
宽的背景所围绕，才可保证这一假设的成立。在某些应用中，我们可能对检测某个集合内由1和0组
成的某些模式感兴趣，在这种情况下不需要背景。在这种场合，击中或击不中就简化为简单的腐蚀。
正如前面指出的那样，腐蚀依然是匹配的集合，但检测单个物体时不需要额外的背景匹配。这种简化
的模式检测方案将用于下节讨论的某些算法中。
9.5 一些基本的形态学算法
以前面的讨论为基础，我们现在可以考虑形态学的一些实际用途。在处理二值图像时，形态学的主
要应用之一是提取用于表示和描述形状的图像成分。特别是我们要考虑提取边界、连通分量、凸壳和区
域的骨架的形态学算法。我们还要探讨几种经常与这些算法相配合使用的预处理或后处理方法(对于区域
填充、细化、粗化和修剪)。在介绍每一种形态学处理时，为了弄清楚每种处理的机理，我们将在这一
小节中广泛地使用“迷你图像”。这些图像以图形的方式显示，用1表示阴影区域，而用0表示白色。
9.5.1 边界提取
表示为β(A)的集合A的边界可以通过先用B对A腐蚀，而后执行A和腐蚀的结果之间的集合
之差得到，即
β(A)=A-(AOB) (9.5-1)
其中B是一个适当的结构元。
图9.13说明了边界提取的机理。这幅图像显示了一个简单的二值物体、一个结构元B和使用
式(9.5-1)得到的结果。尽管图9.13(b)中的结构元是最常用的，但它
绝对不是唯一的。例如，使用由1组成的大小为5×5的结构元，将得
到2~3个像素宽的边界。
从现在开始。我们将不再显式地
给出边界填充
第9章 形态学图像处理 413
a bcd
●
A B AOB β(A)
图9.13(a)集合A;(b)结构元B;(c)B对A的腐蚀；(d)由A和其腐蚀间的集合差给出的边界
例9.5 用形态学处理提取边界。
图9.14进一步说明了式(9.5-1)和由1组成的3×3结构元的用途。如本章中的所有二值图像那样，二
进制值1显示为白色，二进制值0显示为黑色，因此该结构元的元素1也被当做白色来处理。由于所用
结构元的尺寸，图9.14(b)中的边界宽度为1个像素。
a b
图9.14 (a)一幅简单的二值图像，其中1表示白色；(b)使用式(9.5-1)和图9.13(b)中的结构元得到的结果
9.5.2 孔洞填充
一个孔洞可被定义为由前景像素相连接的边界所包围的一个背景区域。在这一节中，我们将针
对填充图像中的孔洞，开发一种基于集合膨胀、求补和交集的算法。令A表示一个集合，其元素是8
连通的边界，每个边界包围一个背景区域(即一个孔洞)。当给定每个孔洞中的一个点后，目的就是用
1填充所有的孔洞。
除了在每一个孔洞中对应于X。中的位置给定的点之外，这一点我们已经置为1了，我们从形成
一个由0组成的阵列X。开始(该阵列与包含A的阵列的大小相同)。然后，如下过程将用1填充所有
的孔洞：
X?=(X?-1田B)∩A°k=1,2,3,… (9.5-2)
其中B是图9.15(c)中的对称结构元。如果X =X-,则算法在迭代的第k步结束。然后，集合X
包含所有被填充的孔洞。X?和A的并集包含所有填充的孔洞及这些孔洞的边界。
如果左边不加限制，那么式(9.5-2)中的膨胀将填充整个区域。然而，每一步中与A°的交集
操作将把结果限制到感兴趣区域内。这是我们如何制约形态学处理以满足希望特性的第一个例
子。在当前应用中，它被适当地称为条件膨胀。图9.15的余下部分进一步说明了式(9.5-2)的机理。
尽管该例子仅有一个孔洞，但在给定每个孔洞区域内的一个点的假设下，很清楚，这一概念可用
于任何有限数量的孔洞。
例9.6 形态学孔洞填充。
图9.16(a)显示了一幅由内部带有黑色点的白色圆圈组成的图像。这样的图像可以通过将包含磨光的
球体(如滚珠)的场景用阈值处理分为两个层次而得到。球体内部的黑点可能是反射的结果。我们的目的
是通过孔洞填充来消除这些反射。图9.16(a)显示了在一个球体中选择的一个点，图9.16(b)显示了填充一 666
屋: g
414 数字图像处理(第三版)
部分的结果。最后，图9.16(c)显示了填充所有球体后的结果。因为黑点是背景点还是球体内部的点必须
是已知的，所以完全自动化这一过程要求在算法中建立附加的“智能”。在9.5.9节中，我们将给出一个
基于形态学重建的全自动方法(见习题9.23)。
a b c d e f8hi
A A° B X。 x?
X? X? X. XgUA
图9.15 孔洞填充：(a)集合A(显示为阴影);(b)A的补集；(c)结构元B;(d)边界
内的初始点；(e)-(h)式(9.5-2)的各个步骤；(i)最终结果[(a)和(h)的并集]
a bc
图9.16(a)二值图像(区域内部的白点是孔洞填充算法的起始点);
(b)填充该区域后的结果；(c)填充所有孔洞后的结果
9.5.3 连通分量的提取
连通性和连通分量的概念已在2.5.2节中介绍过。从二值图像中提取连通分量是许多自动图像分
析应用中的核心。令A是包含一个或多个连通分量的集合，并形成一个阵列X。(该阵列的大小与包
含A的阵列的大小相同),除了在对应于A中每个连通分量中的一个点的已知的每一个位置处我们已
置为1(前景值)外，该阵列的所有其他元素均为0(背景值)。如下迭代过程可完成这一目的：
X=(X-1田B)∩A k=1,2,3,… (9.5-3)
其中，B是一个适当的结构元(如图9.17所示)。当X=X,-时，迭代过程结束，X 包含输入图像中
的所有的连通分量。注意式(9.5-3)与式(9.5-2)的相似性，唯一的差别是用A代替了A。这并不奇怪，
因为此处我们正在寻找前景点，而在9.5.2节的目的是寻找背景点。
图9.17说明了式(9.5-3)的机理，k=6时即可收敛。注意，所用结
关于事先不要求知道每个连通分量 构元的形状在像素间是基于8连通的。如果我们用图9.15中的SE, 中的一个点的算法，请参阅习题924 它是基于4连通的，朝向图像底部的连通分量的最左侧元素将不会被
检测到，因为对图的其余部分它是8连通的。如孔洞填充算法那样，假定在每一个连通分量内都已知
一个点，式(9.5-3)对于任何在A中的有限数量的连通分量都是可用的。
第9章 形态学图像处理 415
B
A x X?
a b c d e f g
x? x X.
图9.17 提取连通分量：(a)结构元；(b)包含有一个连通分量的集合的阵列；(c)在连
通分量的区域中包含一个1的初始阵列；(d)-(g)式(9.5-3)的各个迭代步骤
例9.7 使用连通分量检测包装食品中的外来物。
连通分量经常用于自动检测。图9.18(a)显示了一幅含有碎骨的鸡胸X射线图像。经过处理的食品在
包装和/或运送之前能检测出这样的物体是很有意义的。在这种特殊情况下，骨骼的密度使得它们的正常
灰度值与背景不同。这就使得使用单一阈值(阈值处理在3.1节介绍过了，10.3节中将进行更详细的讨论)
将骨骼从背景中提取出来成为一件简单的事情。结果是图9.18(b)所示的二值图像。
这幅图中的最显著特征是保留下来的点聚集为物体(骨头),而不是彼此孤立的毫无关系的点。我们
可以确定，只有具有“有效”尺寸的物体才能对经阈值处理的图像进行腐蚀后而保留下来。在这个例子
中，我们将“有效”尺寸的物体定义为：使用元素为1、大小为5×5的结构元腐蚀图像后保留下来的任
何物体。图9.18(c)中显示了腐蚀的结果。下一步是分析保留下来的物体的尺寸。我们通过提取图像中的
连通分量来标记(识别)这些物体。图9.18(d)中的表格列出了提取的结果。总共有15个连通分量，其中4个
尺寸较大。这足以确定包含在原图像中的重要的不希望的物体。如果需要，使用第11章讨论的技术进一
步描述其特性(比如物体的形状)是可能的。
a b c d
连通分量 连通分量中
的像素数 连通分量
11
9
133
1
743
09
11 9
10
12 39
1314
15
连通分量中
的像素数
01
02
0304
05
06
07
08
7
11
119
9
674
85
图9.18 (a)含有碎骨的鸡肉X射线图像；(b)经阈值处理后的图像；(e)使用元素为1、
大小为5x5的结构元腐蚀后的图像；(d)图(c)的连通分量中的像素数(图像由
NTB Elektronische Geracte GmbH,Diepholz,Germany,www.ntbxray.com提供) 图多
目:8
416 数字图像处理(第三版)
9.5.4 凸壳
如果在集合A内连接任意两个点的直线段都在A的内部，则称集合A是凸形的。任意集合S的凸壳
H是包含于S的最小凸集。集合差H-S称为S的凸缺。正如11.1.6节和11.3.2节中详细讨论的那样，凸
壳和凸缺对于物体描绘是很有用的。这里，我们介绍一种获得集合A的凸壳CA)的简单形态学算法。
令B',i=1,2,3,4表示图9.19(a)中的4个结构元。这个过程可通过执行下式实现：
X{=(X-I⑧B)UA i=1,2.3,4和 k=1,2,3,… (9.5-4)
其中X!=A。当该过程收敛时(即当X!=x时),我们令D=x!。则A的凸壳为
cA)=Uo (9.5-5)
换句话说，该方法由反复使用B'对A做击中或击不中变换组成；当不再发生进一步变化时，我们执
行与A的并集运算，结果称为D'。这一过程使用B2重复(应用于A),直到不发生进一步的变化，如
此往复。得到的4个D的并集组成了A的凸壳。注意，我们使用不需要背景匹配的击中或击不中变
换的简化的实现，如9.4节末尾所讨论的那样。
图9.19说明了式(9.5-4)和式(9.5-5)给出的过程。图9.19(a)显示了用于提取凸壳的结构元。每个
结构元的原点均位于其中心处。“×”项表示“不考虑”的条件。这意味着，如果结构元模板下A的3×3
区域在该位置匹配模板的模式，则说结构元在A中找到了一个匹配。对于一个特殊的模板，当A中的
这个3×3区域的中心为0时，而在阴影模板元素下的3个像素为1时，才会出现模式匹配。不必顾及
该3×3区域内其他像素的值。此外，关于图9.19(a)中的符号B'是由B?1顺时针旋转90°得到的。
a b cd
efg h
区网 区 区冈
区
区 区 区 区 区
B' B2 B3 B?
x!=A x! x?
B1
B2
B3
B?
x} x C(A)
图9.19 (a)结构元；(b)集合A;(c)-1使用图(a)中的结构元得到
的收敛结果；(g)凸壳；(h)显示了每个结构元的贡献的凸壳
图9.19(b)显示了一个寻找凸壳的集合A。从x!=A开始，式(9.5-4)经过4次迭代后，得到图9.19(c)
中的集合。然后令x?=A,并再次使用式(9.5-4),得到图9.19(d)中的集合(在这种情况下，仅经过两
步即可收敛)。接下来的两个结果是以同样的方式得到的。最后，图9.19(c),(d),(e)和(f中集合形成的
并集得到图9.19(g)显示的凸壳。每个结构元的贡献突出显示在图9.19(h)所示的组合集合中。
上述过程的一个明显的缺点是凸壳可能超出确保凸性所需的最小尺寸。减少这种影响的一种简
第9章 形态学图像处理 417
单方法是限制生长，以便凸壳不会超过初始点集在水平和垂直方向上的尺寸。对图9.19中的例子施加
这种限制产生图9.20所示的图像。更复杂的边界可用于进一步限
制具有更多细节的图像的生长。例如，我们可以沿垂直、水平和
对角线方向使用原始点集的最大尺寸。像这样的改进所付出的代
价是额外增加了算法的复杂性和计算需求。
9.5.5 细化
结构元B对集合A的细化可表示为A?B,它可以根据击中
或击不中变换来定义： 图9.20 将凸壳生长算法限制到原
始点集沿垂直方向和水平
方向的最大尺寸的结果 如前一节那样，我们仅对与结构元的模式匹配感兴趣，所以在击中
或击不中变换中没有背景运算。针对对称地细化A的一种更有用的表达方式是以结构元序列为基础的：
A?B=A-(A@B)=A∩(A⑧B) (9.5-6)
{B]={B',B2,B3,…,B") (9.5-7)
其中B是B'?1旋转后的形式。使用这一概念，我们现在可以使用一个结构元序列将细化定义为
A?{B]=((…(A?B)?B2)…)?B") (9.5-8)
这种处理是A被B'细化一次，然后，得到的结果被B2细化一次，如此进行下去，直到A被B"细化一
次。整个过程不断重复，直到得到的结果不再发生变化。每次单独的细化均使用式(9.5-6)来执行。
图9.21(a)显示了一组通常用于细化的结构元，图9.21(b)显示了将要使用刚才讨论的过程来细化
的集合A。图9.21(c)显示了A被B'细化一次后得到的结果。图9.21(d)到(k)显示了用其他结构元细
化多次的结果。使用B?进行第二次细化后得到了收敛的结果。图9.21(1)显示了细化的结果。最后，
图9.21(m)显示了转换为m连通的细化集合(见2.5.2节),以消除多重路径。
原点 原点
区
国 S
B' B B3 B? B3 B B2 B
A
A?=A⑧B A?=A??B2 A?=A?⑧B1 A4=A?@B
A?=A?⑧B A.=A◎ Aa-AB A-AOB
Aas=A◎B3 A=A矿 已转换为m连通的A 此后不再变化
图9.21(a)用于细化的经旋转后的结构元序列；(b)集合A;(c)使用第一个结构
元细化得到的结果；(d)~i)使用接下来的7个结构元细化得到的结果(使用
第7个和第8个结构元细化得到的结果间没有变化);j再次使用前4个
结构元细化得到的结果；(①收敛后的结果；(m)转换为m连通的结果 9:6
418 数字图像处理(第三版)
9.5.6 粗化
粗化是细化的形态学对偶，定义如下：
A-B=AU(AQB) (9.5-9)
其中B是适合于粗化处理的结构元。与细化一样，粗化处理也可以定义为一个系列操作：
AO{B)=(…(AOB)OB2)…)OB") (9.5-10)
用于粗化的结构元与图9.21(a)所示的结构元具有相同的形式，但所有1和0要互换。然而，针对粗
化的分离算法在实际中很少用到，取而代之的过程是先对问题中集合的背景进行细化，而后对结果求
补集。换句话说，为粗化集合A,我们先形成C=A,而后细化C,然后再求C。图9.22说明了这
一过程。
由于依赖于A的性质，这个过程可能产生某些断点，如图9.22(d)所示。因此，通过这种方法的
粗化处理通常会跟随一个后处理以消除断点。注意，根据图9.22(e)可知，细化后的背景形成了粗化
处理的一个边界。这一有用的特性在使用式(9.5-10)粗化的直接执行中并不存在，并且，它是使用背
景细化来实现粗化的主要原因之一。
ede
图9.22 (a)集合A;(b)A的补集；(c)对A的补集进行细化得到的结果；
(d)对(c)求补得到的粗化后的集合；(e)没有断点的最终结果
9.5.7 骨架
如图9.23所示，集合A的骨架S(A)的概念直观上相当简单。由该图我们可以推出：
(a)如果z是SA)的一个点，并且(D)?是A内以z为中心的最大圆盘，则不存在包含(D)?且位
于A内的更大圆盘(不必以z为中心)。圆盘(D)?称为最大圆盘。
(b)圆盘(D),在两个或多个不同的位置与A的边界接触。
A的骨架可以用腐蚀和开操作来表达，即骨架可以表示为(Serra[1982])
s(a=Us.a (9.5-11)
其中，
S?(A)=(AOkB)-(AOkB)。B (9.5-12)
式中，B是一个结构元，而(AOkB)表示对A的连续k次腐蚀：
(AekB)=(…(AOB)eB)e…)OB) (9.5-13)
K是A被腐蚀为空集前的最后一次迭代步骤。换句话说，
K=max{kI(AOkB)≠0} (9.5-14)
第9章 形态学图像处理 419
abcd
图9.23(a)集合A;(b)中心在A的骨架上的最大圆盘的不同位置；(c)位
于A的骨架的不同线段上的另一个最大圆盘；(d)完整的骨架
式(9.5-11)和式(9.5-12)给出的公式表明，S(A)可以作为骨架子集S?(A)的并集来得到。此外，还
可证明使用下式可由这些子集来重建A:
A=US(A)OKB) (9.5-15)
其中(S(A)田kB)表示对S(A)的k次连续膨胀，即
(S?(A)田kB)=(…((S(A)田B)田B)田…)田B) (9.5-16)
例9.8 计算简单图形的骨架。
图9.24说明了刚才讨论的概念。第一列显示了原始集合(顶部)和使用结构元B的两次腐蚀。注意，
对A再进行一次腐蚀将产生空集，因此，在这种情况下K=2。第二列显示了使用B对第一列中的集合进
行的开操作。结合图9.8中讨论的开操作的拟合特性，这些结果很容易解释。第三列只包含第一列和第二
列间的集合差。
AOkB (AOkB)-B S.(4) Asua) Ssaka S(A)母kB
0
四
SCA) A
2
B
图9.24 式(9.5-11)到式(9.5-15)的执行。原始集合位于左上角，其
形态学骨架位于第四列的底部。第六列底部为重建的集合 6～
675
420 数字图像处理(第三版)
第四列包含两部分骨架和最终结果(该列的底部)。最终得到的骨架不仅比需要的更粗，而且更重要
的是它是不连通的。由于在前述的形态学骨架公式中没有任何条件保证连通性，所以该结果是意料之中
的。形态学在给定集合的腐蚀和开操作中产生一个精致的公式。然而，如同通常情况下一样，骨架要求
最大限度的细化、连通，且受到的腐蚀最小，就需要像11.1.7节中探讨的算法这一类有试探性的公式。
第五列显示了S?(A),S?(A)田B和(S?(A)田2B)=(S?(A)田B)田B。最终，最后一列显示了根据式(9.5-15)
重建的集合A,该集合是第五列所示膨胀后的骨架子集的并集。
9.5.8 裁剪
裁剪方法本质上是对细化和骨架算法的补充，因为这些过程会保留某些寄生分量，因而需要用
后处理来清除这些寄生分量。我们首先探讨裁剪问题，然后以前面小节中介绍的材料为基础探讨一种
形态学上的解决方法。因此，我们抓住这个机会说明如何通过到现在为止讨论过的几种技术的联合使
用解决这一问题。
在手写字符的自动识别中，通常使用的方法是分析每个字符的骨架形状。这些骨架经常带有许
多“毛刺”(寄生分量)的特征。毛刺是在腐蚀过程中由组成字符的笔画的不均匀性造成的。为处理这
一问题，我们将探讨一种形态学技术，先假定寄生成分的长度不超过指定的像素数。
图9.25(a)显示了一个手写字符“a”的骨架。该字符最左侧的寄生成分就是我们要消除的部分。
解决方案是以通过不断删除寄生分支的终点来抑制寄生分支为基础的。当然，这也会使得字符的其他
分支变短(或删除),但在缺乏其他结构信息的情况下，这个例子中的
我们可将端点定义为一个大小为 假设是任何具有三个或小于三个像素长度的分支都将被删除。使用一 3×3的区域的中心点，该区域满足
系列仅设计用来检测端点的结构元对输入集合A进行细化可以得到期 图9.25(b)或(c)中的任何排列
望的结果。也就是说，令
X?=A?{B] (9.5-17)
式中，{B}表示图9.25(b)和(c)中所示的结构元序列[见式(9.5-7)关于结构元序列]。这个结构元序
列由两种不同的结构组成，每种结构对全部8个元素旋转了90°。图9.25(b)中的“×”表示一个“不
必考虑”的条件，在这种意义上，该位置上的像素的值是0还是1无关紧要。在有关形态学的文献中
报告的许多结果都是以运用类似图9.25(b)中的单一结构元为基础的，只是沿着整个第一列有“不必
考虑”的条件而已。这是不完善的。例如，该元素将位于图9.25(a)中第8行、第4列的点识别为端
点，因此将该点消除，从而破坏了笔画的连续性。
连续对A应用式(9.5-17)三次，得到图9.25(d)中的集合X?。下一步是将字符“复原”成其原来
的形状，但要去掉寄生分支。为做到这一点，首先需要求形成一个包含X,中所有端点的集合X?[见
图9.25(e)]:
x?=Ux,er) (9.5-18)
其中，B*是图9.25(b)和(c)中所示的相同端点检测子。下一步是用集合A作为限定器，对端点进行
三次膨胀：
X?=(X?田H)∩A (9.5-19)
其中，H是元素值为1的3×3结构元，并且在每一步之后都要与A求
交集。如区域填充和提取连通分量的情况一样，这种有条件的膨胀可
以防止在我们关注的区域外产生值为1的元素，正如图9.25(f所示结
果证明的那样。最后，X?和X,的并集就是我们想要的结果：
式(9.5-19)是膨张形态学重建的基
础.详见下一节中的解释。
第9章 形态学图像处理 421
X?=X?UX? (9.5-20)
如图9.25(g)所示。
a b
区 B'.B.B'B2(已旋转90)
c
d e
[ g
B,B°,B2.B*(已旋转90)
图9.25 (a)原图像；(b)-(c)用于检测端点的结构元；(d)经过三轮细化后的结
果；(e)图(d)的端点；D以图(a)为条件的端点膨胀；(g)修剪后的图像
在更复杂的情况下，使用式(9.5-19)有时会捡回某些寄生分支的“尖端”。当这些分支的端点离
骨架很近时，这种情况就会发生。尽管使用式(9.5-17)可以消除它们，但在膨胀过程中会再次捡回这
些点，因为它们是A中的有效点。除非整个寄生元素再次被捡回，(这些元素比有效笔画短的情况很
少)检测并消除它们就很容易，因为它们都是不连续的区域。
此时的一种自然想法是，一定存在一种更为容易的方法来解决这个问题。例如，我们可以保留
所有被删除点的轨迹，并将其中合适的点与那些应用式(9.5-17)后留下的端点进行再连接。这样的选
择是可行的，但前面给出的公式的优点是使用简单的形态学结构即可解决整个问题。在实际情况下，
当这一组工具可利用时，其优点是不必写新的算法。我们只需将必要的形态学函数结合到操作序列中。
9.5.9 形态学重建
迄今为止讨论的形态学概念只涉及一幅图像和一个结构元。在这一节中，我们讨论一种称为形
态学重建的强有力的形态学变换，它涉及两幅图像和一个结构元。一幅图像是标记，它包含变换的起
始点，另一幅图像是模板，它约束该变换。结构元用来定义连接性。
①在关于形态学重建的许多文献中，默认情形下结构元假设是各向同性的，且一般称为初级各向同性结构元。在本章的上下文中，
这样的一个结构元的例子是其原点在中心处、元素为1且大小为3×3的阵列。 6～圈
678
-
680
422 数字图像处理(第三版)
测地膨胀和腐蚀
形态学重建的核心是测地膨胀和测地腐蚀这两个概念。令F表示标记图像，G表示模板图像。
在本讨论中，假定两幅图像都是二值图像，且FEG。令D(F)表示大小为1的标记图像关于模板
的测地膨胀定义为
D(F)=(F田B)∩G (9.5-21)
其中，∩表示集合的交[这里∩可解释为逻辑AND(与),因为对二值图像来说集合的交和逻辑AND
操作是相同的]。F关于G的大小为n的测地膨胀定义为
D(F)=D[D&?(F] (9.5-22)
其中，D(F)=F。在这个递推表达式中，式(9.5-21)中的集合求交在每一步中都执行。注意，交
集算子保证模板G将限制标记F的生长(膨胀)。图9.26显示了一个大小为1的测地膨胀的简单例子。
图中的步骤是式(9.5-21)的直接执行。
B
0-
标记，F
被B膨胀的标记 测地膨胀，D(F)
模板，G
图9.26 测地膨胀的说明
类似地，标记F关于模板G的大小为1的测地腐蚀定义为
E(F)=(FOB)UG (9.5-23)
其中，U表示集合的并(或者OR操作)。F关于G的大小为n的测地腐蚀定义为
E(F)=E2[E-1(F)] (9.5-24)
其中，E(F)=F。式(9.5-23)中的并集操作在每一个迭代步骤中执行，并保证一幅图像的测地腐蚀
仍然大于或等于其模板图像。如从式(9.5-21)和式(9.5-23)预期的那样，测地膨胀和测地腐蚀是关于
集合的补集对偶的(见习题9.29)。图9.27显示了一个大小为1的测地腐蚀的简单例子。图中的步骤
是直接执行式(9.5-23)。
有限数量图像的测地膨胀和腐蚀经过有限数量的迭代步骤后总会收敛，因为标记图像的扩散或
收缩受模板约束。
①尽管使用递归公式来开发形态学重建方法更为直观(就像此处所做的那样),但它们的实际实现通常基于计算上更有效率的算法
(例如，见Vincen(1993和Soille[2003)。本节中所有基于图像的例子均是使用这样的算法生成的。
第9章 形态学图像处理 423
·
B
U-
标记，F
被B腐蚀的标记 测地腐蚀，F)
模板，G
图9.27 测地腐蚀的说明
用膨胀和腐蚀的形态学重建
基于前面的概念，来自标记图像F对模板图像G的膨胀形态学重建表示为R(F),它被定义为
F关于G的测地膨胀，反复迭代直至达到稳定状态；即
R(F)=D(F) (9.5-25)
迭代k次，直至D(F)=D+(F)。
图9.28说明了使用膨胀的重建。图9.28(a)继续在图9.26中开始的处理；也就是说，得到D(F)
后，重建的下一步是膨胀该结果，然后，用模板G与其相“与”(AND)得到D(F),如图9.28(b)
所示。D?(F)的膨胀结果与模板G相“与”(AND)得到D(F),等等。重复这一过程，直至达到
稳定。如果我们对该例子多执行一步，会发现DS(F)=D(F),因此，采用膨胀的形态学重建的图
像由D(F)=D(F)给出，这正如式(9.5-25)指出的那样。注意，在这种情况下，重建的图像与模
板相同，因为F包含了值为1的单个像素(这类似于一幅图像与一个冲激的卷积，该卷积简单地复制
冲激位置处的图像，正如在3.4.2节解释的那样)。
a b cd ef Bh
D(F) 被B膨胀的 r) 被B膨胀的D(F) D(F)
被B膨胀的DF)D(F) 被B膨胀的D")Dn=R()
图9.28 采用膨胀的形态学重建的说明。F.G,B和D(F)来自图9.26
依照类似的方法，模板图像G对标记图像F的腐蚀的形态学重建表示为R(F),它被定义为F
关于G的测地腐蚀，反复迭代直至达到稳定状态；即
Rξ(F)=E(F) (9.5-26)
680
房：图
424 数字图像处理(第三版)
迭代k次，直至E(F)=E(F)。作为习题，请您针对腐蚀的形态学重建生成一幅类似于图9.28
的图形。膨胀和腐蚀形态学重建是关于集合补集对偶的(见习题9.30)。
应用实例
形态学重建有很宽的实际应用领域，每种应用都由标记图像和模板图像的选择、所用的结构元
及前面讨论中定义的基本操作的组合来决定。下面的几个例子说明了这些概念的应用。
重建开操作：在形态学开操作中，腐蚀会删除小的物体，而后续的膨胀试图恢复遗留物体的形
状。然而，这种恢复的准确性高度依赖于物体的形状和所用结构元的相似性。重建开操作可正确地恢
复腐蚀后所保留物体的形状。一幅图像F的大小为n的重建开操作定义为来自F的大小为n的腐蚀
的F的膨胀重建；即
O"(F)=R?[(FOnB)] (9.5-27)
其中，(FOnB)表示B对F的n次腐蚀，如9.5.7节中解释的那样。注意，在该应用中，F被用做模
板。对于重建闭操作，可写出一个类似的表达式(见表9.1)。
图9.29显示了重建开操作的一个例子。在这一说明中，我们的兴趣是从图9.29(a)中提取长的、垂
直笔画的字符。重建开操作至少要求一次腐蚀，因此我们首先执行这一步骤。图9.29(b)显示了图9.29(a)
经腐蚀后的结果，该腐蚀采用长度与长字符的(51个像素)平均高度成正比和宽度为1个像素的结构元。
为了比较，我们用相同的结构元计算了开操作。图9.29(c)显示了结果。最后，图9.29(d)是用式(9.5-27)
中给出的F[即O(F)]的重建开操作(大小为1)。该结果表明，包含长的垂直笔画的字符被准确
地恢复了，而所有的其他字符则被去除了。
ponensor hrokcncunnesllon puihs There is no pol tion pas the lewl o dtail reyurel to ilkemifty thos Symentutknontrhdimte kone of the m
poceune Segmentalh wursy dctchinines the e ofoumpuletiwdanahspisedures For thisrcaon.
betukcntoimrnc thephhiliny srrsol senent
uch insindusial iapetnaplcalunsat kast som the eminmen ispunslke atims The epertismed
hinoih punashe anlsnilonlouk
fih
a b cd
图9.29 (a)大小为918×2018 像素的文本图像。长的字符的近似平均高度是
51个像素；(b)使用大小为51×1像素的结构元对图(a)的腐蚀；(c)使
用相同的结构元对图(a)的开操作，用做参考；(d)重建开操作的结果
填充孔洞：在9.5.2节中，我们开发了一种填充孔洞的算法，该算法在图像中的每个孔洞都已知
一个起始点。这里，我们开发一个基于形态学重建的全自动化过程。令I(x,y)代表一幅二值图像，并
假定我们形成了一幅标记图像F,除了在该图像的边界位置为1-1之外，在其他位置均为0,即
(x,y)在I的边界上 F(x,y={0-x,y 其他 (9.5-28)
则
H=[R!(F)] (9.5-29)
是一幅等于I且所有孔洞都被填充的二值图像。
第9章 形态学图像处理 425
让我们考虑式(9.5-29)中的各个分量，以了解该表达式事实上是如何填充图像中的所有孔洞的。
图9.30(a)显示了包含一个孔洞的简单图像1,图9.30(b)显示了它的补集。注意，因为I的补集将所
有的前景像素(1 值)设置为背景(0值)像素，并且反之亦然，该操作效果上建立了围绕孔洞的一面
元素为0的“墙”。因为I被用做一个AND(与)模板，这里我们所做的一切都是在该过程的迭代期
间保护所有的前景像素(包括围绕孔洞的墙)。图9.30(c)是根据式(9.5-28)形成的阵列F,图9.30(d)
是使用所有元素都为1的3×3SE(结构元)膨胀后的F。注意，标记F有一个元素为1的边缘(除1为
1的位置之外),故这些标记点F的膨胀在边缘处开始，并且向内处理。图9.30(e)显示了使用I作为
模板对F进行测地膨胀后的结果。如刚才指出的那样，我们看到，在这个结果中，对应于I的前景像
素的所有位置都是0,并且对于孔洞像素也是一样。另一次迭代将得到相同的结果，如式(9.5-29)要
求的那样，求补后给出图9.30f中所示的结果。操作H∩I生成一幅图像，该图像中对应于1中孔
洞的位置像素值为1,如图9.30(g)所示。
a bc d ef g
1 F FOB F田B∩/ H HNI
图9.30 在简单图像上填充孔洞的说明
图9.31显示了一个更实际的例子。图9.31(b)显示了图9.31(a)中文本图像的补集，图9.31(c)是
由式(9.5-28)产生的标记图像F。除了对应于原图像边界上的1的位置外，该图像有一个元素为1的
边界。最后，图9.31(d)显示了所有孔洞均被填充后的图像。
ponensr hoken cunnection TIls Ther ismop the pst ths levelof dtilreqired to identity those Seuicntatamofmotmial mageskone of them
pmsdng Soimeatalion huary determinss the e wmpuleniadanalsedures hu this tehm. kLken mre thepmhhnugget sement
h nindlnstrsl impethphketins.atlkasi sns
the cninnctiunlkn tims Theswpnicnkvd dmmnh nnnsuhk alluthninsme
ponent or brokenconnection paths.There is no polt
tionpastthe level of detail required to identify those Segmentation of nontriwial images is one o the mox
processing Segmentation accuracy determinesthe ev f computeried analysis proeedure. Fur this reason,( ketazen to improve the probability of rugged segment
chasindustriat inspection applications,at least some
the cmviommen,bspisulk at times The expericncedi desipner invariahly puys ciderable atentlon to sud
a b cd
pntnokencinrctIk Theie isp linpst the lesel oleilcured1·dcnify hese Segmeneisalimthem
n emenyiemnes the e
plivedlisT ihnren.
ktatthep…nmen te mistrilinilmm
the emi*inupme Thie rperienctd
m ansirhke dllnl心
图9.31(a)大小为918×2018像素的文本图像；(b)作为模板图像使用的
(a)的补集；(c)标记图像；(d)用式(9.5-29)填充孔洞的结果
边界清除：针对后续形状分析的图像物体提取是自动图像处理的基本任务。删除接触(即连接到)
边界的物体的算法是一个很有用的工具，因为：(1)它可以用于屏蔽图像，以便对进一步处理只保留
完整的物体，或者(2)它可用做在视野中存在部分物体的一个信号。作为本节介绍的概念的最后说明，
我们现在提出一个基于形态学重建的边界清除过程。在这一应用中，我们用原图像作为模板，并使用
下面的标记图像：
F(x,)-{ (x,y)位于1的边界上
其他 (9.5-30) 密
医
426 数字图像处理(第三版)
边界清除算法首先计算形态学重建R'(F)(简单地提取接触到边界的物体),然后计算差
X=I-R?(F) (9.5-31)
以得到一幅其中没有接触边界的物体的图像X。
作为一个例子，再次考虑文本图像。图9.32(a)显示了使用所有元素均为1的3×3的结构元得到
的重建RP(F)(注意右侧接触边界的物体),图9.32(b)显示了使用式(9.5-31)计算得到的图像X。如
果手边的任务是自动字符识别，则拥有一幅其中没有接触边界的字符的图像最有用，因为这样可以避
免不得不识别部分字符的问题(充其量也只是一个困难的任务)。
poncnts or hroken connection paths There is no po tion pust the kvelotdetail requred to idenify thoe Segmentation of montrivial images h one of the mo proersine Sermentbtin acuragy determins the e
lf cmputcrired analsi prcedures For this reaksn.
he tuaken to impone the pmihuhility ofnugged egnent wch windintrslinspectaoapplicatincat lcast wms the emviinment ispnltkent limes The expericneed
desner iaraN pas amsidlerahe atlcntkn to sus
a b
图9.32 边界清除：(a)标记图像；(b)没有接触边界的物体的图像。原图像是图9.29(a)
9.5.10 二值图像形态学操作小结
表9.1小结了前几节中提出的形态学结果。图9.33小结了迄今为止讨论过的用于各种形态学处
理的结构元的基本类型。注意，表9.1第三列中的罗马数字是指图9.33中的结构元。
B B
1 I1
过
Bi=1.2,3,4
(旋转90^)
B'i=1.2,…,8
(旋转45°) IⅢ IV
B'I=1.2.3,4
过 (旋转90) E'i=5.6,7.8
(旋转90)
V
图9.33 用于二值形态学的5个基本的结构元。每个结构元的原点均位于其中心处。x项表示“不考虑”的值
表9.1 形态学操作及其性质小结
操 作 公式
(B),={wlw=b+z.beB}
B.={wlw=-b,beB}
A=(wlwe A)
A-B={wlweA.we B]
=A∩B
AOB={z1(B,)∩A≠0
AOB={zl(B)?CA}
AoB=(AOB)田B
A-B=(AθB)eB
注 释
(罗马数字指图9.33中的结构元)
平移 将B的原点平移到点z
反射 关于集合B的原点映射该集合的所有元素
求补集 不属于A的点的集合
求差集 属于A但不属于B的点的集合
膨胀 “扩展”A的边界(1
腐蚀 “收缩”A的边界(1)
开操作 平滑轮廓，切断狭窄区域，并消除小的孤岛和尖刺(1)
闭操作 平滑轮廓，融合狭窄间断和细长沟堑，并消除小的孔洞(D
操 作
击中或击不中变换
边界提取
孔洞填充
连通分量
凸壳
细化
粗化
骨架
裁剪
大小为1的测地膨胀
大小为n的测地膨胀
大小为1的测地腐蚀
大小为n的测地腐蚀
膨胀形态学重建
腐蚀形态学重建
重建开操作
重建闭操作
孔洞填充
边界清除
公 式
AOB=(AeB,)∩(A'eB?)
=(AOB)-(A田B?)
B(A)=A-(AOB)
x?=(X田B)∩A;
k=1.2.3.…
x?=(X田B)∩A;
k=1.2.3.…
x{=(X'LOB)UA;
1=1.2.3.4:
k=1,2,3.…;
x!=A:D=x
AOB=A-(AOB)
=A∩(AQB)
A⑧(B)=
(…(A?B)⑧B2)…)B")
(B)={B',B2,B3,…,B"}
AOB=AU(AOB)
AO[B]=
(-(AOB)OB2…)B")
s(w)-Usa)
S,(A)={(A?kB)
H(AOkB)。B])
A的重建：
A-Us(A)田母
x?=AO(B)
x?-Uxer)
x?=(X?田H)∩A
X?=x?Ux,
D"(F)=(F田B)∩G
D(F)=D8[D&"(F)]:
D(F)=F
E(F)=(FeB)UG
E(F)=E[(F]
E(F)=F
R(F)=D(F)
R(F)=(F)
o(F)=RPIFenB)
c(F)=R}(FOnB)
H-[Rp(F]
X=1-RP(F)
第9章 形态学图像处理 427
(续表)
说 明
(罗马数字是指图9.33中的结构元)
点(坐标)的集合。在这样的点处，同时。B,在A中可找到一
个匹配(击中),B?在A中可找到一个匹配
在集合A的边界上的点的集合(①
填充A中的孔洞：X?是每个孔洞处元素为1而其他位置元素
为0的阵列(II)
寻找A中的连通分量；X,是每个连通分量中元素为1而其他
位置元素为0的阵列(D
寻找集合A的凸壳CA).其中conv 表示Xi=xi(I)意义
上的收敛，
细化集合A。前两个公式给出细化的基本定义。后两个公式
表示使用一个结构元序列的细化。实际中通常使用这种方
法(IV)
粗化集合A(见前面关于结构元序列的说明)。使用IV,但把
0和1颠倒
寻找集合A的骨架S(A)。最后一个公式指出A可以由其骨架
子集S?(A)重建。在所有3个公式中，K是集合A被腐蚀为
空集时的迭代次数。符号(AOkB)表示B对A连续腐蚀的
第k次迭代1)
x,是裁剪集合A后的结果。必须指定使用第一个公式来得到
X?的次数。结构元V用于前两个公式。在第三个公式中，H
表示结构元I
F和G分别称为标记图像和模板图像
k满足D(F)=D(F)
k满足(F)=*(F)
(FenB)表示B对F的n次腐蚀
(FOnB)表示B对F的n次膨胀
H等于输人图像7.但具有所有被填充的孔洞。标记图像F
的定义见式(95-28)
X等于输人图像1.但带有所有被删除接触(连接到)边界的
物体。标记图像F的定义见式(9.5-30) 图-图
匿：多
428 数字图像处理(第三版)
9.6 灰度级形态学
在这一节中，我们将把膨胀、腐蚀、开操作和闭操作的基本操作扩展到灰度级图像。然后，我
们将使用这些操作来探讨几个基本的灰度级形态学算法。
通过下面的讨论，我们将处理形如f(x,y)和b(x,y)的数字函数，其中f(x,y)是一幅灰度级图像，
而b(x,y)是一个结构元。假设这些函数是2.4.2节中介绍过的离散函数。也就是说，如果Z表示实整
数集合，则坐标(x,y)是来自笛卡儿积Z的整数，且f和b是对每个(x,y)坐标对赋以灰度值(来自实数
集合R的一个实数)的函数。如果灰度级也是整数，则用Z代替R。
灰度级形态学中的结构元所执行的基本功能与二值形态学中所对应的功能相同：它们作为一个
“探测器”以明确的特性检验一幅给定的图像。灰度级形态学中的结构元属于两类：非平坦的和平
坦的结构元。图9.34显示了每一类的一个例子。图9.34(a)以图像形式显示了一个半球状的灰度级结
构元，图9.34(c)是一个通过其中心的水平灰度剖面。图9.34(b)显示了一个圆盘形的平坦结构元，
图9.34(d)是其对应的灰度剖面(该剖面的形状解释了“平坦”一词的由来)。为清楚起见，图9.34中
的元素以连续量显示；它们的计算机实现是以数字近似为基础的(见图9.2中最右侧的圆盘形SE"结
构元”)。由于本节稍后讨论的一些困难，实际中灰度级结构元并不常用。最后，我们要提及的是，
如在二值情况那样，必须清楚地确定结构元的原点。除非另外提及，本节中的所有例子都以高度为1、
对称的、平坦的结构元为基础，其原点位于中心处。灰度级形态学中结构元的反射的定义，如9.1节
中的定义一样，且在下面的讨论中我们将它表示为b(x,y)=b(-x,-y)。
d
不平坦结构元 平坦结构元 灰度剖面 灰度剖面
图9.34 非平坦和平坦结构元，以及对应的通过其中心的水平灰度剖面。本节中的所有例子均基于平坦结构元
9.6.1 腐蚀和膨胀
当b的原点位于(x,y)处时，用一个平坦的结构元b在(x,y)处对图像f的腐蚀定义为图像f中与b
重合区域的最小值。以公式的形式，结构元素b对一幅图像f在位置(x,y)处的腐蚀由下式给出：
[fob](x,y)=min{f(x+s,y+1)} (9.6-1)
其中，用与3.4.2节讨论的相关过程类似的方式，x和y是通过所有要求的值而增加的，以便b的原
点能访问f中的每一个像素。也就是说，为寻求b对f的腐蚀，我们把结构元的原点放在图像每一个
像素的位置。在任何位置的腐蚀由从包含在与b重合区域中的f的所有值中选取的最小值决定。例如，
如果b是大小为3×3的方形结构元，则获得一点处的腐蚀要求寻找包含在由b定义的3×3区域中的f
的9个值中其原点所在的那个点的最小值。
类似地，当b的原点位于位置(x,y)处时，平坦结构元b在任何位置(x,y)处对图像f的膨胀，定义
为图像f中与b重合区域的最大值，即
第9章 形态学图像处理 429
f田b](x,y)=max(f(x-s,y-1) (9.6-2)
其中，我们用到了早些时候说明过的b=b(-x,-y)的事实。对该式的解释与前一段中的解释相同，但
使用的是最大而不是最小操作，并且要记住结构元关于其原点反射，我们用(-s,-1)考虑函数的自变
量。这类似于空间卷积，就像3.4.2节中解释的那样。
例9.9 灰度级腐蚀和膨胀的说明。
因为使用一个平坦 SE(结构元)的灰度级腐蚀计算图像f中与b重合的(x,y)的每一个邻域的最小灰度
值，因此通常我们希望被腐蚀的灰度级图像比原始图像暗，亮特征的尺寸(关于SE的尺寸)将被减小，
而暗特征的尺寸将会增大。图9.35(b)显示了使用一个单位高度和半径为2个像素的圆盘形结构元素对
图9.35(a)的腐蚀。刚才讨论的效果在腐蚀过的图像中清晰可见。例如，请注意小亮点亮度的降低程度，
图9.35(b)中几乎已看不到这些小亮点，同时暗色特征则变浓了。腐蚀过的图像中的一般背景比原图像的
背景要稍暗一些。类似地，图9.35(c)显示了使用相同SE 膨胀后的结果。其效果与用腐蚀得到的效果相
反，即亮特征变浓了，而暗特征降低了。请特别注意图9.35(a)中左侧、中间、右侧和底部的较细黑色连
线在图9.35(c)中几乎已看不见了。黑点的尺寸已被减小，但与图9.35(b)中被腐蚀的小白点完全不同，在
膨胀后的图像中，小白点却清晰可见。其原因是就结构元的尺寸相比，黑点的尺寸原来就比白点大。最
后，请注意膨胀后的图像中的背景比图9.35(a)中的背景稍亮。
非平坦结构元具有随定义域而变化的灰度级。非平坦结构元bN对图像f的腐蚀定义如下：
UfObJ(x,y)=minf(x+s,y+1)-ba(s,D) (9.6-3)
这里，我们实际上是从f中减去bn的值来确定任意点处的腐蚀。与式(9.6-1)不同，这意味着使用非平
坦结构元的腐蚀通常不受f值的限制，而这在解释结果时会存在问题。因为这一原因，实际中很少使用
灰度级结构元；另外，与式(9.6-1)比较，为bN选取有意义的元素和增加的计算负担也是潜在的困难。
a bc
图9.35 (a)大小为448×425像素的灰度级X射线图像；(b)使用半径为2个像素的圆盘形结构
元对图像的腐蚀结果；(c)用相同结构元对图像的膨胀结果(原图像由Lixi公司提供)
采用类似的方式，使用非平坦结构元的膨胀定义如下：
f田bJ(x,y)=max f(x-s,y-1)+bg(s,D (9.6-4)
前一段给出的说明同样适用于使用非平坦结构元的膨胀。当bn的所有元素都是常数时(即结构元是平
坦的),式(9.6-3)和式(9.6-4)就分别简化为式(9.6-1)和式(9.6-2),其中一个标量常数等于该结构元的
幅度。
如二值情况那样，腐蚀和膨胀是关于函数的补集和反射对偶的，即
(feb)(x,y)=(f“田b)(x,y) 匿：圈
430 数字图像处理(第三版)
其中，f=-f(x,y)且b=b(-x,-y)。相同的表达式对非平坦结构元也有效。为清楚起见，在下面
的讨论中，我们将忽略所有函数的参量以简化表达式，在这种情况下，前一公式可写为
(feb)°=(f田b) (9.6-5)
类似地，
(f田b)°=(feb) (9.6-6)
自身的腐蚀和膨胀在灰度级图像处理中并不是特别有用。像在对应的二值情形那样，当组合用来
推导高级算法时，这些操作会变得强有力，正如下节所示的材料那样。
9.6.2 开操作和闭操作
灰度级图像的开操作和闭操作的表达式与二值图像的对应操作具
有相同的形式。结构元b对图像f的开操作表示为fb,即
fob=(feb)田b
尽管我们在本节剩余内容的例子中
介绍的是平坦结构元，但讨论的概念
同样适用于非平坦结构元。
(9.6-7)
像之前那样，开操作先只用b对f做腐蚀，随后用b对所得结果做膨胀。类似地，b对f的闭操作表
示为f·b,即
f·b=(f田b)Ob (9.6-8)
灰度级图像的开操作和闭操作关于函数的补集和结构元的反射是对偶的：
(f·b)°=fob (9.6-9)
和
fob)°=f·b (9.6-10)
因为f=-f(x,y),所以式(9.6-9)也可以写为-(f-b)=(-fob),对于式(9.6-10)也类似。
③:③
灰度剖面 a
b
平坦结构元
c
d
e
开操作
闭操作
图9.36 一维情形下的开操作和闭操作：(a)原始
的一维信号；(b)从信号底部向上推动的
平坦结构元素；(c)开操作；(d)沿信号顶
部向下推动的平坦结构元素；(e)闭操作
图像的开操作和闭操作具有简单的几何解
释。假设我们将一个图像函数f(x,y)看成是一个三
维表面；也就是说，它的灰度值可解释为xy平面
上的高度值，如图2.18(a)所示。然后，b对f的开
操作可从几何角度解释为，从f的下表面向上推动
结构元。在b的每个原点位置，开操作是当从f的
下表面向上推动结构元时，b的任何部分所达到的
最高值。这样，完全开操作就是由b的原点访问f
的每一个坐标(x,y)所得到的所有值的集合。
图9.36以一维的形式说明了这个概念。假定
图9.36(a)中的曲线是沿图像中的一行的灰度剖
面。图9.36(b)显示了沿曲线底部向上推到不同位
置的一个平坦结构元。图9.36(c)的实线是完全开
操作。因为结构元太大而不能完全拟合曲线上部
峰值的内侧，故峰值 有时，开操作和闭操作可由在一
的顶部被开操作剪切 条曲线的下侧和上侧滚动一个圆来
说明。在三维情形下，圆可用球体 掉了，剪切的量与结
来替代，得到的过程称为滚球算法。 构元能够到达峰值的
第9章 形态学图像处理 431
距离成比例。通常，开操作用于去除较小的明亮细节，而保持整体灰度级和较大的明亮特征相对不变。
图9.36(d)是闭操作的图形说明。很明显，结构元从曲线的顶部向下推动，同时平移到所有位置。
如图9.36(e)所示，当结构元从曲线的上侧滑动时，通过寻找结构元的任何部分所能到达的最低点，
就可构建闭操作。
灰度级开操作满足如下性质：
(a)fob.f。
(b)如果ff?,则(f·b)-(f?·b)。
(c)(fob)b=(fob)。
符号eJr用来表示e的域是r的域的一个子集，且对于e的域中的任何(x,y),有e(x,y)≤rx,y)。
类似地，闭操作满足如下性质：
(a)fJf-b。
(b)如果J?,则(j?·b)-(f?·b)。
(c)(f·b)-b=(f·b)。
这些性质的用途类似于二值图像中的对应性质。
例9.10 灰度级开操作和闭操作的说明。
图9.37将图9.36中说明的一维概念拓展到了二维。图9.37(a)与我们在例9.9使用的图像相同，
图9.37(b)是使用单位高度和半径为3个像素的圆盘形结构元得到的开操作结果。如预料的那样，所有亮
特征的灰度都降低了，降低的程度取决于这些特征相对于结构元的尺寸。该图与图9.35(b)相比，我们看
到，与腐蚀的结果不同，开操作对图像的暗特征影响可忽略不计，也不影响背景。类似地，图9.37(c)显
示了使用半径为5的圆盘形结构元得到的闭操作结果(小的圆黑点比小白点大，因此要达到可与开操作相
比的结果，需要更大的圆盘形结构元)。在这幅图像中，亮的细节和背景相对来说未受影响，但削弱了暗
特征，削弱的程度取决于这些特征相对于结构元的尺寸。
a b c
图9.37(a)一幅大小为448x425像素的灰度级X射线图像；(b)使用半径为3个像素的圆盘
形结构元得到的开操作结果；(c)使用半径为5个像素的结构元得到的闭操作结果
9.6.3 一些基本的灰度级形态学算法
许多形态学技术是以迄今为止介绍的灰度级形态学概念为基础的。下面的讨论中我们将说明这
些算法。
形态学平滑
因为开操作抑制比结构元小的亮细节，而闭操作抑制暗细节，所以它们常常以形态滤波的形式
结合起来被用于图像平滑和噪声去除。考虑图9.38(a),它显示了一幅使用X射线波段拍摄的天鹅星 离图
室;受
432 数字图像处理(第三版)
座环超新星图像(关于该图像的细节请参阅图1.7)。为当前讨论的目的，假设中心的亮区域是我们感
兴趣的目标，而较小的分量是噪声。我们的目的是去除噪声。图9.38(b)显示了用一个半径为2的平
坦圆盘(结构元)对原始图像开操作，再用相同尺寸的SE(结构元)进行闭操作的结果。图9.38(c)和(d)
分别显示了使用半径为3和5的结构元进行相同操作得到的结果。如期望的那样，该图像序列显示了
消除作为结构元尺寸的函数的小分量的改进。在最后的结果中，我们看到，感兴趣的目标已被提取出
来。图像底部的噪声分量未被完全去除，原因在于它们的密度。
图9.38的结果是以对原始图像进行开操作，然后再闭操作为基础的。有时使用的一个过程是执行
交替顺序滤波，在该过程中，对原始图像以开操作-闭操作顺序开始，但后续步骤对前一步骤的结果
再执行开操作和闭操作。这种类型的滤波在自动图像分析中很有用，滤波过程中每一步的结果都针对
一个指定的度量进行比较。通常，对于相同大小的结构元，与图9.38中说明的方法相比，这种方法会
产生更为模糊的结果。
a bcd
图9.38(a)由NASA的哈勃望远镜在X射线波段拍摄的天鹅星座环超新星
的566x566图像；(b)-(d)分别使用半径为1,3和5的圆盘形结构
元对原图像执行开操作和闭操作顺序的结果(原图像由NASA提供)
形态学梯度
膨胀和腐蚀可与图像相减结合起来得到一幅图像的形态学梯度，在这里，由g来定义：
g=(f田b)-(fOb) (9.6-11)
膨胀粗化一幅图像中的区域，而腐蚀则细化它们。膨胀和腐蚀的差强调了区域间的边界。同质区域不
受影响(只要SE 相对较小),因此相减操作趋于消除同质区域。最终结果是是边缘被增强而同质区域
的贡献被抑制掉了的图像，从而产生“类似于微分”(梯度)的效果。
图9.39显示了一个例子。图9.39(a)是一幅头部CT扫描图像，接下来的两幅图像是使用所有元素
都为1的3×3结构元对该图像进行开操作和闭操作的结果。注意，刚刚提到的粗化和收缩。图9.39(d)
是使用式(9.6-11)得到的形态学梯度，其中，区域间的边界被清楚地描绘出来了，这与二维微分图像
的预期相同。
a bcd
图9.39 (a)512x512的头部CT扫描图像；(b)膨胀的结果：(c)腐蚀的结果；(d)形态学梯度，
计算图(b)和图(c)间的差(原图像由Vanderbilt大学的David R.Pickens博士提供)
第9章 形态学图像处理 433
顶帽变换和底帽变换
图像相减与开操作和闭操作相结合，会产生所谓的Top-hat(顶帽)变换和bottom-hat(底帽)变换。
灰度级图像f的顶帽变换定义为f减去其开操作：
Th(f)=f-(fob) (9.6-12)
类似地.的底帽变换定义为f的闭操作减去f:
B(f)=(f·b)-f (9.6-13)
这些变换的主要应用之一是，用一个结构元通过开操作或闭操作从一幅图像中删除物体，而不是拟合
被删除的物体。然后，差操作得到一幅仅保留已删除分量的图像。顶帽变换用于暗背景上的亮物体，
而底帽变换则用于相反的情况。由于这一原因，当谈到这两个变换时，常常分别称为白顶帽变换和黑
底帽变换。
顶帽变换的一个重要用途是校正不均匀光照的影响。正如我们将在下一章中看到的那样，合适(均
匀)的光照在从背景中提取目标的处理中扮演核心的角色。称为分割的这一处理是自动图像分析中执
行的第一步。一种常用的分割方法是对输入图像进行阈值处理。
为了说明，考虑图9.40(a),它显示了一幅大小为600×600的米粒的图像。该图像是在非均匀光
照下得到的，如图像底部及最右侧的暗色区域就是明证。图9.40(b)显示了对该图像使用10.3.3节讨论
的Otsu最佳阈值处理方法得到的结果。非均匀光照的最终结果导致了暗区域的分割错误(一些米粒没
有从背景中提取出来),且在图像的左上角，背景部分被错误地分类了。图9.40(c)显示了对该图像使
用一个半径为40的圆盘形结构元进行开操作的结果。这个结构元足够大以致不会拟合任何物体。如
结果那样，这些物体被消除了，仅留下一个近似的背景。阴影模式在该图像中很清楚。通过从原图像
中减去该图像(即执行顶帽变换),背景应会变得更均匀。事实的确如此，如图9.40(d)所示。背景并
不是非常均匀，但亮和暗之间不再存在极端的差别，这就足以得到正确的分割结果，其中所有的米粒
均被检测出来，如图9.40(e)所示。以前，该图像是使用Otsu方法得到的。
d。
图9.40 使用顶帽变换校正阴影：(a)大小为600×600的原图像；(b)阈值处理后
的图像；(c)用半径为40的圆盘形结构元进行开操作的图像：(d)顶帽变
换的图像(图像减去其开操作);(e)顶帽变换的图像经阈值处理的结果
粒度测定
在图像处理方面，粒度测定是属于判断图像中颗粒的尺寸分布的领域。实践中，颗粒很少能完 爱：图
③ ;
434 数字图像处理(第三版)
美地被分离，这就使得用识别单个颗粒来计数成为一个困难的任务。形态学可间接用于估计颗粒的尺
寸分布，而不需要识别并测量图像中的每个颗粒。
这种方法原理上非常简单。对于比背景亮且具有规则形状的颗粒，该方法由使用逐渐增大的结
构元对图像执行开操作组成。基本概念是，某个特殊尺寸的开操作应会对包含类似尺寸的颗粒的输入
图像的区域产生最大的效果。对于每一次开操作，计算该开操作中像素值的和。该和有时称为表面区
域，它会随着结构元的增大而减小，如我们早些时候注释的那样，因为开操作会降低亮特征的灰度。
该过程会得到一个这样的数字的一维阵列，阵列中的每个元素等于对应于阵列中该位置的结构元素的
大小的开操作中的像素之和。为了强调连续开操作间的变化，我们计算一维阵列的相邻元素的差。为
了形象化该结果，我们画出了该差的图形。曲线中的峰值表明了图像中颗粒的主要大小分布。
作为一个例子，考虑图9.41(a),它是两种不同大小的木钉的图像。对木钉中的木颗粒可能需要
引入不同的开操作，因此，平滑是一种合理的预处理步骤。图9.41(b)显示了使用早期讨论过的形态
学滤波器平滑后的图像，该滤波器用半径为5的圆盘形结构元。图9.41(c)到(f)显示了使用半径为10.
20,25和30的圆盘形结构元对图像进行开操作的例子。注意，在图9.41(d)中，由于较小木钉，灰度的
贡献几乎已被消除。图9.41(e)中，大木钉的贡献已被显著地降低了，图9.41(f)更厉害。[观察图9.41(e),
靠近图像右上方的大木钉比其暗得多，因为它的尺寸较小。如果我们试图检测有缺陷的木钉，那么这
将是有用的信息]。
de:
图9.41 (a)大小为531×675的木钉图像；(b)平滑后的图像；(c)~(1分
别用半径为10,20.25和30像素的圆盘形结构元对图像进行开
操作后的结果(原图像由MathWorks公司的Steve Eddins博士提供)
图9.42显示了该差值阵列的曲线。如前边提到的
那样，我们期望半径附近的差值较大(曲线中的峰
值),在该处结构元足够大，以包围近似相同直径的
2.5×10°
2
表面区域中的差 1.5
1
0.5
%510 1520 25 30 35
图9.42 表面区域中的差，它是圆盘形结构
元半径r的函数。两个峰值表明
图像中存在两个主要的颗粒尺寸
一组颗粒。图9.42中的结果有两个明显的峰值，这清
楚地表明图像中存在两种主要的物体尺寸。
纹理分割
图9.43(a)显示了一幅在亮背景上添加了暗斑点的
噪声图像。该图像有两个纹理区域：右边大斑点组成
的区域和左边小斑点组成的区域。目的是以纹理内容
为基础找到两个区域的边界(我们将在11.3.3节讨论纹
理)。如早期解释的那样，将一幅图像分为区域的处理
称为分割，分割是第10章的话题。
第9章 形态学图像处理 435
感兴趣的物体比背景暗，并且我们知道，如果使用一个比小斑点大的结构元对图像做闭操作，
这些斑点将被删除。在图9.43(b)中，使用半径为30个像素的圆盘形结构元对输入图像做闭操作的结
果表明情况的确如此(斑点的半径近似为25像素)。因此，我们得到了一幅亮背景上带有暗的大斑点
的图像。如果我们使用尺寸大于这些斑点间的间隔的结构元对该图像做开操作，则最终结果应该是这
样一幅图像，在该图像中，斑点间的亮的间隔已被删除，留下了暗的斑点，并且这些斑点之间现在已
成为相同的暗间隔。图9.43(c)显示了使用半径为60的圆盘形结构元得到的结果。
a b e d
图9.43 纹理分割：(a)由两种斑点组成的大小为600×600的图像；(b)对图(a)执行闭操作后删
除了小斑点的图像；(c)对图(b)执行开操作后删除了大斑点间的亮间隔的图像；(d)将
图(c)中两个区域间的边界叠加到原图像上后的结果。边界是使用形态学梯度操作得到的
使用一个其元素全为1且大小为3×3的结构元对该图像执行形态学梯度操作将给出这两个区域间
的边界。图9.43(d)显示了将形态学梯度操作结果叠加到原图像后所得到的边界。该边界右侧的所有像
素表示属于由大斑点表征的纹理区域，而该边界左侧的所有像素属于由小斑点表征的纹理区域。您将
发现，若使用图9.36中对开操作和闭操作的图形模拟，那么我们可更直观地理解这一例子。
9.6.4 灰度级形态学重建
灰度级形态学重建基本上按照与9.5.9节针对二值图像所介绍的相
同的方法来定义。令f和g分别代表标记图像和模板图像。我们假设f
和g是大小相同的灰度级图像，且f≤g。f关于g的大小为1的测地
膨胀定义为
D"(f)=(f田b)^g
很容易理解这些表达式是(x,y)的
函数 为简化表示，我们省略了(x,y)。
(9.6-14)
式中，入代表点方式的最小算子。该式指出，大小为1的测地膨胀是由先计算b对f的膨胀，然后选
择在每一个(x,y)点处该结果和g间的最小者。如果b是一个平坦结构元，则膨胀由式(9.6-2)给出，
否则膨胀由式(9.6-4)给出。f关于g的大小为n的测地膨胀定义为
D(f)=D[DD(f] (9.6-15)
并有D(f)=f。
类似地，f关于g的大小为1的测地腐蚀定义为
E(f)=(feb)v8 (9.6-16)
其中，v表示点方式的最大算子。f关于g的大小为n的测地腐蚀定义为
E(F)=E[E/-(f] (9.6-17)
并有E(f)=f。 自;客
容：司
436 数字图像处理(第三版)
灰度级标记图像f对灰度级模板图像g的膨胀形态学重建定义为f
关于g的测地膨胀反复迭代直至达到稳定；即
R'(f)=D(f)
本节中表达式间的对偶关系列表
见习题9.33.
(9.6-18)
并有k应使D"(f)=D+(f)。f对g的腐蚀的形态学重建类似地定义为
R (f)=E(f) (9.6-19)
并有k应使E(f)=E!+D(f)。
如在二值情况那样，灰度级图像重建的开操作首先腐蚀输入图像，并用它作为标记图像。一幅
图像f的大小为n的重建开操作定义为先对f进行大小为n的腐蚀，再由f的膨胀重建；即
o"(f)=R'i(fenb)] (9.6-20)
其中，(fenb)表示b对f的n次腐蚀，如9.5.7节解释的那样。回忆式(9.5-27)针对二值图像的讨论，
重建开操作的目的是保护腐蚀后留下的图像分量的形状。
类似地，图像f的大小为n的重建闭操作定义为先对f进行大小为n的膨胀，再由f的腐蚀重
建；即
ck(f)=R(f田nb)] (9.6-21)
其中，(f田nb)表示b对f的n次腐蚀。因为对偶性，图像的重建闭操作可以用图像的求补得到，先
得到重建开操作，然后再求结果的补。最后，如下例所示，称为重建顶帽的一种有用技术是从一幅图
像中减去其重建开操作。
例9.11 使用形态学重建展平复杂的背景。
在这个例子中，我们用规格化图9.44(a)中不规则图像背景的一些步骤来说明灰度级重建的用途，即
仅留下恒定灰度背景上的正文。这一问题的解决是形态学概念的能力的很好的说明。我们从抑制各个键
顶部的水平反射开始。在图像中反射比任何单个字符都宽，因此，我们应该能在腐蚀操作中用一条长的
水平线通过执行重建的开操作抑制它们。该操作将产生包含键及其反射的背景。从原图像减去这个背景(即
执行一个重建顶帽操作)将从原图像中消除水平反射和变化的背景。
图9.44(b)显示了在腐蚀操作中用一条大小为1×71 像素的水平线对原图像执行重建开操作的结果。
我们已经能够仅用一个开操作就除去字符，但是，得到的背景将不会如图9.44(c)所示那样均匀(例如，
比较两幅图像中各个键之间的区域)。图9.44(d)显示了从图9.44(a)中减去图9.44(b)的结果。如期望的
那样，水平反射和背景的变化被抑制了。为便于比较，图9.44(e)显示了执行刚才的顶帽变换的结果(如
本节之前讨论的那样，即从图像中减去“标准的”开操作)。从图9.44(c)中背景的特征可以预料，图9.44(e)
中的背景不像图9.44(d)中的那样均匀。
下一步是从键的边缘删除垂直反射，这在图9.44(d)中非常明显。通过使用一个其宽度近似等于这
些反射的线状结构元来执行一个重建开操作，我们可删除垂直反射(在这种情况下，结构元的宽度约为
11个像素)。图9.44(1显示了对图9.44(d)执行该操作的结果。垂直反射被抑制了，有用字符的垂直笔
划也被细化了(如 SIN 中的D,因此，我们不得不寻找一种恢复该字符的方法。由于被抑制的字符非常
靠近其他字符，因此，如果我们水平地膨胀遗留下来的字符，则膨胀后的字符将与先前被抑制字符所
占的区域重叠。使用大小为1×21的线状结构元膨胀图9.44(f)后得到的图9.44(g)的结果显示事实的确
如此。
第9章 形态学图像处理 437
此时所有余下的问题是复原被抑制的字符。考虑图9.44(g)中膨胀后的图像和图9.44(d)中重建顶帽
图像间点方式的最小值形成的一幅图像。图9.44(h)显示了最小值图像(虽然该结果看起来接近我们的目
标，但SIN 中仍遗漏了D。在灰度级重建中，通过将这幅图像作为标记图像，并将膨胀后的图像作为
模板图像[见式(9.6-18)],我们得到如图9.44(i所示的最终结果。这幅图像表明所有字符都已完全地从
原图像的不规则背景，包括键的背景中提取出来了。图9.44(i)中的背景都是均匀的。
LoC ie
coN st? G Go%
ENTER EtTER y
8 +
5 6
sTO
ENTER
图9.44 (a)大小为1134×1360像素的原图像；(b)用腐蚀中的一条71像素长的水平
线对图(a)的重建开操作；(c)用相同的线对图(a)的开操作；(d)重建顶帽
操作；(e)顶帽操作；(0用11个像素长的水平线对图(d)的重建开操作；
(g)使用21个像素长的水平线对图子的膨胀操作；(h)图(d)和图(g)的最小操
作；(i)最后的重建结果(原图像由MathWork公司的SteveEddins博士提供)
小结
本章介绍的形态学概念和技术构成了从一幅图像中提取感兴趣特征的一组强有力的工具。形态
学图像处理最吸引人的一个方面就是来自形态学技术已有发展的广泛的集合论基础。实现方面的一个
显著优点是膨胀和腐蚀都是基本操作，它们是各类形态学算法的基础。正如下章所示，形态学可以作
为广泛应用的图像分割程序的基础。如第 11章中讨论的那样，形态学技术在图像描述中也起着重要
的作用。
参考文献
Sera[1982]的书籍是关于形态学图像处理的基础性参考资料，也可以参阅 Sera[1988],Giardina和
Dougherty[1988]及Haralick 和Shapiro[1992]的著述。与我们的讨论相关的其他早期参考文献包括 Blum[1967]. 701
良;官
438 数宇图像处理(第三版)
Lantuejoul[1980],Maragos[1987]和 Haralick 等人[1987]等的著述。关于二值形态学和灰度级形态学的综述见
Basart和gonzalez[1992]及Basart 等人[1992]的著述。这组参考文献为9.1节到9.4节涵盖的内容提供了丰富的
背景。9.5节和9.6节中材料的较好综述见Soille[2003]的论著。
实现形态学算法，如9.5节和9.6节中给出的算法的重要刊物见Jones和Svalbe[1994],Park和Chin[1995],
Sussner和Ritter[1997],Aneli等人[1998]及Shaked和Bruckstein[1998]的论文。关于实现灰度级形态学算法
的实践细节见Vincent[1993]的论文，也可以参阅Gonzalez,Woods和Eddins[2004]的书籍。
关于形态学图像处理理论和应用的其他读物见Goutsias 和Bloomberg[2000]的图书和 Pattem Recongnition
[2000]的一期特刊。也可以参阅Rosenfeld[2000]编辑的参考文献。Marchand-Maillet和 Sharaiha[2000]关于
二值图像处理的书籍及Ritter和Wilson[2001]关于图像代数学的书籍也是重要的文献。关于形态学技术在
图像处理方面的应用的当前工作请参阅Kim[2005]及Evans和Liu[2006]的 标有星号的习题的详细解 论文。 答，可在本书的网站上找到。该网
站中还包含有基于本章内容而建议
习题 的项目。
9.1 本书中的数字图像嵌入了方形排列的网格，且像素允许是4,8或m连通的。然而，其他网格排列
也是可能的。特别地，有时也会使用6连通的六边形网格排列(见下面的图形)。
(a)如何将图像从方形网格转换到六边形网格?
(b)讨论由方形网格和六边形网格表示的物体的形状旋转不变性。
(c)在六边形网格中，是否像在8连通情况下那样(见2.5.2节),可能存在有歧义的对角线配置?
9.2 ★(a)针对把4连通的二值边界转换为m连通的边界(见2.5.2节)给出一个形态学算法。可以假设
边界是全连通的，且边界的宽度为1个像素。
(b)您的算法的操作需要用每个结构元进行多于一次的迭代过程吗?试解释原因。
(c)您的算法的性能是否与应用结构元的顺序无关?如果您的回答是无关，请证明之；否则请
举出一个例子，说明您的过程与应用结构元的顺序有关。
9.3 只要B的原点包含于B中，则结构元B对集合A的腐蚀就是A的一个子集。给出腐蚀AOB位于
A之外或部分位于A之外的一个例子。
9.4 下列4种说法是正确的。请给出能证明这些说法正确的论据。(a)通常是正确的；(b)到(d)仅对数
字集合才是正确的。为了证明(b)至(d)的正确性，请画出一个离散的方形网格(如习题9.1所示),
并针对每种情况，使用由该网格上的点构成的集合给出一个例子。(提示：在仍能确定这些说法的
正确性时，尽可能保持每种情况下的点数最少。)
★(a)用一个凸结构元对一个凸集的腐蚀仍是一个凸集。
★(b)用一个凸结构元对一个凸集的膨胀并不总是凸的。
(c)一个数字凸集内的点并不总是连通的。
(d)有可能存在一个这样的点集，在该集合中，连接每个点对的线位于该集合内，但该集合不是凸的。
★9.5 参考所显示的图像，给出生成图(a)至图(d)所示结果的结构元和形态学操作。请清晰地说明每个结
构元的原点。图中的虚线表示原始集合的边界，仅供参考显示。注意图(d)中的所有角都是圆角。
第9章 形态学图像处理 439
(a) (b) (c) (d)
9.6 令A表示右图中阴影所示的集合。参考所示的结构元(黑点表示原点),画出下列形态学操作的结果：
(a)(AOB2)田B?
(b)(AOB)田B3
(c)(AOB3)田B'
(d)(A田B3)eB2
★9.7 (a)反复膨胀一幅图像的极限效果是什么?
假设不使用只有一个点的结构元。
(b)为使(a)的答案成立，您能从其开始的最
小图像是什么? A
9.8(a)反复腐蚀一幅图像的极限效果是什么?
假设不使用只有一个点的结构元。 L
L/2
(b)为使(a)的答案成立，您能从其开始的最
小图像是什么? L4 ★9.9 腐蚀的另一种可替换定义是
AOB={we Z2lw+beA,对于每个beB}
证明该定义等价于式(9.2-2)中的定义。
L4 LA
B B2
9.10(a)证明习题9.9中给出的腐蚀定义，仍等价于如下腐蚀的另一个定义：
AOB=∩4
(若用b代替-b,则该表达式称为两个集合的闵可夫斯基相减。)
(b)证明(a)中的表达式也等价于式(9.2-2)的定义。
★9.11 膨胀的一个可替换的定义是
AB={we Z2lw=a+b,对于一些aeA和be B)
证明该定义等价于式(9.2-4)中的定义。
9.12 (a)证明习题9.11中给出的膨胀定义，等价于如下关于膨胀的另一个定义：
A田B=UA
(该表达式也称为两个集合的闵可夫斯基相加。)
(b)证明(a)中的表达式也等价于式(9.2-4)中的定义。
9.13 证明式(9.2-6)和式(9.2-5)中对偶表达式的正确性。
★9.14 证明对偶表达式(A-B)=(A°。B)和(AoB)=(A°·B)的正确性。
L/2
B
L
B
辰：受
良目
440 数字图像处理(第三版)
9.15 证明下列表达式的正确性：
★(a)AoB是A的一个子集(子图像)。
(b)若C是D的一个子集，则CoB是DoB的一个子集。
(c)(AoB)·B=AoB。
9.16 证明下列表达式的正确性[假设B的原点包含在B中，且习题9.14和习题9.15为真]:
(a)A是A·B的一个子集(子图像)。
(b)若C是D的一个子集，则C·B是DB的一个子集。
(c)(A·B)·B=A·B。
9.17 参考下图所示的图像和结构元。画出经如下操作后集合C.D,E和
F是什么:C=AOB;D=C田B;E=DOB;F=E田B。初始集合
A由显示为白色的所有图像分量组成，但结构元B除外。注意，
这些操作仅是先用B对A进行简单的开操作，接着用B对开操作
的结果进行闭操作。您可以假设B刚好大到包围每个噪声分量。
★9.18 考虑下图所示的3幅二值图像。左侧的图像由边长为1,3,5,7,9和15像素的方块组成。中间的
图像是使用大小为13×13像素、元素为1的方形结构元对左侧图像进行腐蚀生成的，除了最大
的几个之外，消除了所有的方块。最后，右侧的图像是使用相同的结构元对中间图像膨胀后的结
果，其目的是恢复最大的方块。您知道，先腐蚀再膨胀实际上是对图像的开操作，并且您还知
道开操作通常不能将物体恢复为原始形式。请解释这种情形下为何能完全重建较大的方块。
9.19 画出对右侧图像应用击中或击不中变换得到的结果和结构元。请
清楚地指出您为结构元选取的原点和边界。
★9.20 用于区分图像中细化后物体的三个特征(湖泊、湖湾和线段)如下
图所示。开发一种区分这些形状的形态学/逻辑算法。算法的输
入是这三种形状之一。输出必须是输入的特征。可以假设这些特
征的宽度都为1像素，且每个特征都是完全连通的，然而，它们
出现时的方向可以是任意的。
UTK
图像 结构元
湖泊 湖湾 线段
9.21 在下列每种情况下，讨论您期望得到的结果是什么:
第9章 形态学图像处理 441
(a)9.5.2节中孔洞填充算法的起始点是物体边界上的一点。
(b)该孔洞填充算法中的起始点位于物体边界之外。
(c)使用9.54节中给出的算法，计算习题9.6中图形的凸壳外表特征是什么。请画出计算出的凸壳。假
设L为4个像素。
9.22★(a)若使用图9.15(c)中给出的结构元来替代图9.13(b)中给出的结构元，试讨论对提取边界的影响。
(b)在式(9.5-2)给出的孔洞填充算法中，若使用元素值为1、大小为2×2的结构元代替图9.15(c)
所示的结构元，请问会有什么影响?
9.23★(a)针对图9.16中的自动化例子，请提出一种方法(使用9.1节到9.5节的任何技术)。可以假设球
体互不接触，并且不接触图像的边界。
(b)重复(a),但允许球体以任意方式接触，包括接触边界。
★9.24 9.5.3节中给出的提取连通分量的算法，要求在每个连通分量中有一个点是已知的，以便提取所有
的点。假如您已有一幅包含任意数量(未知)连通分量的二值图像。请提出一种完全自动化地提取
所有连通分量的过程。假设属于连通分量的点标记为1,背景点标记为0。
9.25 给出一个基于膨胀重建的、能提取一幅二值图像中的所有孔洞的表达式。
9.26 参考9.5.9节中的孔洞填充算法：
(a)如果f的所有边界点都是1,解释会发生什么情况。
(b)如果(a)中的结果是您所希望的结果，请解释原因。如果不是，请解释如何改进该算法，以便
算法能像您所期望的那样工作。
★9.27 如果结构元是值为1的单个点，解释二值图像的腐蚀和膨胀将会发生什么情况。对于您的回答，
请给出原因。
9.28 如式(9.5-27)和9.6.4节中解释的那样，重建开操作可保持腐蚀后保留的图像分量的形状。请问重
建闭操作的作用是什么?
★9.29 证明测地腐蚀和测地膨胀(见959节)关于补集对偶。也就是说，证明E"(F)=[DID-"(Fr,
反之D(F)=[E[E-D(F)r。假定结构元关于其原点对称。
9.30 证明膨胀重建和腐蚀重建(见9.5.9节)关于补集对偶。也就是说，证明RB(F)=[R (F)厂，反之
亦然，R(F)=[R(F)r。假定结构元关于其原点对称。
★9.31 提出一个论据证明：
(a)[(FenB)Y=(F田nB),其中(FOnB)]表示B对F的n次腐蚀。
(b)[(FOnB)Y=(FenB)。
9.32 证明二值重建闭操作与重建开操作关于补集对偶，即O(F)=[C"(F)广并且，类似地，
C(F)= [O"(F)。假设结构元关于其原点对称。
9.33 证明下列灰度级形态学表达式的正确性。您可以假设b是一个平坦结构元。回忆一下，f(x,y)=
-f(x,y)且b(x,y)=b(-x,-y)。
★(a)腐蚀和膨胀的对偶性：(feb)°=f田b和(f田b)°=feb。
(b)(f·b)°=fb和(fob)°=f-b。
★(c)D(f)=LEE-(f°)F和E"F)=[D(D-f)。假设一个对称结构元。
(d) Rf)=[R(f)和R(f)=[Rf]。
(e)(fenb)°=(f田nb),其中，(fenb)表示b对f的n次腐蚀。还有，(f田nb)Y=(fenb)。707
z7o8 (f)o(f)=[C(f)和C"(f)=[0()r。假设结构元关于其原点对称。
442 数字图像处理(第三版)
9.34 在图9.43中，建立两个不同纹理区域间的边界并不困难。考虑下图，它显示了一个由大圆区域包
围的小圆区域。
(a)用于生成图9.43(d)的方法也可用于该图像吗?解释您的理由，包括为使该方法处理而需要做
出的任何假设。
(b)如果您的回答是肯定的，请画出边界的外表特征。
9.35 一幅灰度级图像f(x,y)被非重叠的噪声尖刺所污染，它们可以用半径为Rm≤r≤Rm,幅度为
Ain≤a≤A的较小的圆柱形干扰来建模。
★(a)请开发一种清理该图像的形态学滤波方法。
(b)重复(a),但现在假设最多存在4个重叠的噪声尖刺。
9.36 显微应用中一个预处理步骤是从两组或更多组重叠的类似颗粒(见右图)
中分离出单个独立的一种圆颗粒。假设所有颗粒的大小相同，提出一种
产生3幅图像的形态学算法，这3幅图像分别仅由如下物体组成：
★(a)仅与图像边界融合在一起的颗粒。
(b)仅彼此重叠的颗粒。
(c)没有重叠的颗粒。
9.37 一家高技术制造工厂获得了一份制造形如下图的高精度垫圈的政府合
同。合同要求使用一个图像系统来检测所有垫圈的形状。在合同文本中，
形状检测是指检测垫圈内边缘和外边缘的偏差。您可以假定：(1)一幅可接受的垫圈的“金”图
像是可用的(关于该习题而言的一幅完美图像);(2)该系统中最终使用的成像和定位系统的精度可
高到足以允许您忽略数字化和定位引起的误差。假设您被聘为该系统视觉检测部分的顾问。请基
于形态学/逻辑操作，提出一种检测方案。请以方框图的形式给出您的答案。
受;官
第10章图 像 分 割
整体等于其部分之和。
——欧几里得
整体大于其部分之和。
—Max Wertheimer
引言
从前一章的资料开始了一个转变，即从输入和输出都是图像的图像处理方法，转到了输入为图
像而输出为从这些图像中提取出来的属性的图像处理方法(在1.1节中的定义的意义上)。分割是这一
方向的另一个主要步骤。
分割将图像细分为构成它的子区域或物体。细分的程度取决于要解决的问题。也就是说，在应
用中，当感兴趣的物体或区域已经被检测出来时，就停止分割。例如，在电子元件的自动检测中，我
们关注的是分析产品的图像，客观地确定是否存在特定的异常现象，如丢失元件或断裂的连线。超过
识别这些元素所需细节的分割是没有意义的。
异常图像的分割是图像处理中最困难的任务之一。分割的精度决定着计算分析过程最终的成败。
因此，应该对改进准确分割的可能性给予相当的关注。在某些情形下，比如在工业检测的应用中，至
少对环境某些范围的典型控制还是可能的。有经验的图像处理系统设计师总是非常关注这种机会。在
其他应用中，比如自主目标获取，系统设计者无法控制操作环境，常用方法是将注意力集中于传感器
类型的选择上，在减少图像无关细节的影响的同时，很可能增强感兴趣物体。一个很好的例子是军方
使用红外线成像来检测有着较强热特性的物体，如运动中的装备和部队。
本章中的多数分割算法均基于灰度值的两个基本性质之一：不连续性和相似性。在第一类中，
方法是以灰度突变为基础分割一幅图像，比如图像的边缘。在第二类中，主要方法是根据一组预定义
的准则将一幅图像分割为相似的区域。阈值处理、区域生长、区域分
基于多个灰度(亮度)值的分割技术 裂和区域聚合都是这类方法的例子。在本章中，我们将讨论和说明这 的讨论，见6.7节和10.3.8节。
些方法，并说明综合运用不同种类的方法可以改善分割的性能，例如，
边缘检测就结合了阈值处理的技术。我们还将讨论基于形态学的图像分割。这种方法特别有吸引力，
因为它基于本章第一部分给出的技术，结合了分割的一些值得肯定的属性。最后，我们将以分割中运
动线索运用的简单讨论结束本章。
10.1 基础知识
711
令R表示一幅图像占据的整个空间区域。我们可以将图像分割视为把R分为n个子区域R,R?….[21
712 R.的过程，满足：
712 4
444 数字图像处理(第三版)
(a UR=R。
(b)R?是一个连通集，i=1,2,…,n。
(c)R?NR,=0,对于所有i和j,i≠j。
(d) Q(R,)=TRUE,i=1,2,…,n。
(e) Q(R?UR,)=FALSE,对于任何R?和R,的邻接区域。
其中，Q(R)是定义在集合R的点上的一个逻辑属性，并且表示空集。如2.6.4节中定义的那样，
符号U和∩分别表示集合的并和交。如2.5.2节中讨论的那样，若R?和R,的并形成一个连通集，则我
们说这两个区域是邻接的。
条件(a)指出，分割必须是完全的；也就是说，每个像素都必须在一个区域内。条件(b)要求一个
区域中的点以某些预定义的方式来连接(即这些点必须是4连接的或8连接的，就像2.5.2节中定义的
那样)。条件(c)指出，各个区域必须是不相交的。条件(d)涉及分割后的区域中的像素必须满足的属
性——例如，如果R,中的所有像素都有相同的灰度级，则Q(R)=TRUE。最后，条件(e)指出，两
个邻接区域R?和R,在属性Q的意义上必须是不同的。
这样，我们看到，分割中的基本问题就是把一幅图像分成满足前述条件的多个区域。通常，
针对单色图像的分割算法基于处理灰度值的两类特性之一：不连续性和相似性。在第一类特性
中，假设这些区域的边界彼此完全不同，且与背景不同，从而允许基于灰度的局部不连续性来
进行边界检测。基于边缘的分割是这一类中所用的主要方法。第二类中基于区域的分割方法是
根据事先定义的一组准则把一幅图像分割成相似的几个区域。图10.1说明了前述概念。图10.1(a)
显示了一幅在恒定灰度的暗背景上叠加一个恒定灰度区域的图像。这两个区域构成了整个图像区域。
图10.1(b)显示了基于灰度的不连续性来计算内部区域的边界所得到的结果。边界内侧和外侧的点
都是黑色(0),因为在这些区域中灰度不存在不连续性。为了分割该图像，我们对该边界上或该边
界内的像素分配了一个灰度级(譬如白),而对该边界外部的所有点分配了另一个灰度(譬如黑)。
图10.1(c)显示了这一处理方法的结果。我们看到，该结果满足本节开始时说明的条件(a)到(c)。条件(d)
的属性是：如果一个像素位于边界上或边界内，则将其标为白色；否则标为黑色。我们看到，在图10.1(c)
中，对于标为黑色和白色的点，该属性为“真”。类似地，两个分割后的区域(物体和背景)满足条
件(e)。
下面三幅图像说明了基于区域的分割。图10.1(d)类似于图10.1(a),但内部区域的灰度形成了一
幅纹理模式。图10.1(e)显示了计算该图像的边缘的结果。很清楚，灰度中的大量寄生变化使得识别
原图像中的唯一边界很困难，因为很多非零灰度变化连接到了边界上，故基于边缘的分割不是一种
合适的方法。然而，我们注意到，外部区域是恒定的，因此，我们需要解决的这个简单分割问题的
全部就是区分纹理区域和恒定区域的一个属性。像素值的标准差是完成该任务的一种度量，因为在
纹理区域标准差非零，而在其他区域标准差为零。图10.1(f显示了将原图像分成大小为4×4的几个
子区域后的结果。若某个子区域中的像素的标准差为正(即如果属性为“真”),则将该子区域标记为
白色；其他为零。其结果是在区域边缘周围有“块”效应出现，因为4×4的方块组被标记为相同的
灰度。最后，注意这些结果也满足本节开始处说明的5个条件。
①一般来说，Q可以是一个复合表达式，例如，如果R,中像素的平均灰度小于m,且如果它们的灰度的标准差大于c,其中m
和o,是指定的常数。则QR)=TRUE。
关于连通集的讨论，请参阅252节
第10章 图 像分 割 445
ai
图10.1 (a)包含恒定灰度区域的图像；(b)显示内部区域边界的图像，该图像是由灰度不连续性获得的；(c)将
图像分割成两个区域后的结果；(d)包含一个纹理区域的图像；(e)计算边缘后的结果。注意，由于存在大量
连接到原始边界的小边缘，仅使用边缘信息是很难找到一条唯一的边界的；(f)基于区域特性的分割结果
10.2 点、线和边缘检测
本节将集中在以灰度局部剧烈变化检测为基础的分割方法上。我们感兴趣的三种图像特征是孤
立点、线和边缘。边缘像素是图像中灰度突变的那些像素，而边缘(或边缘线段)是连接的边缘像素的
集合(关于连接性的定义，见2.5.2节)。边缘检测器是设计用来检测边缘像素的局部图像处理方法。一条
线可视为一条边缘线段，该线两侧的背景灰度要么远亮于该线像素的灰度，要么远暗于该线像素的灰
度。事实上，如下节及10.2.4节中讨论的那样，线会引起所谓的“屋顶
当我们说到线时，实际上是指那 边缘”。类似地，孤立点可视为一条线，只是其长度和宽度都为一个像素。 些较细的结构，它通常只有几个像
素粗，譬如数字化后的建筑设计图
中的线，或卫星图像中的道路。 10.2.1 背景知识
正如在2.6.3节和3.5.1节我们所看到的局部平均平滑一幅图像那样，假设平均处理类似于积分，
对于灰度的突变，局部变化可以用微分来检测应该并不奇怪。由于变化非常短促，因此一阶微分和二
阶微分特别适合于这种目的。
数字函数的导数可用差分来定义。就像 3.6.1节中解释的那样，近似这些差分的方法有多种，但
对于用于一阶导数的任何近似，我们要求：(1)在恒定灰度区域必须为零；(2)在灰度台阶或斜坡开
始处必须不为零；(3)在沿灰度斜坡点处也必须不为零。类似地，对于所用的二阶导数的近似，我
们要求：(1)在恒定灰度区域必须为零；(2)在灰度台阶或斜坡的开始
处和结束处必须不为零；(3)沿灰度斜坡必须为零。因为我们处理的
是数字量，故它们的值是有限的，最大可能的灰度变化也是有限的，
且在其上发生变化的最短距离是在两个邻接像素间的距离。
我们按如下方式来得到一维函数f(x)在点x处的导数的近似：将函数f(x+△x)展开为关于x的
泰勒级数，令△r=1,且只保留该级数的线性项(见习题10.1)。结果是数字差分
=r'x)=f(x+D)-f(x)
回忆2.42节可知，为表达清晰，
式(10.2-1)的推导中使用了Ar=1。
图像样本间的增量定义为1.因此在
(10.2-1)
当我们考虑一个两变量的图像函数f(x,y)时，为了表示的一致性，这里我们使用了偏微分，此时，
我们将处理沿两个空间轴的偏微分。很明显，当函数f只有一个变量时，有f/ax=df/dx。 77
446 数字图像处理(第三版)
对式(10.2-1)关于x微分，我们得到一个二阶导数表达式：
=rx=f(x+D)-f(x)
=f(x+2)-f(x+1-f(x+1)+f(x)
=f(x+2)-2f(x+1)+f(x)
其中，第二行来自式(10.2-1)。这一展开是关于点x+1的。我们的兴趣是关于点x的二阶导数，故将
上式中的变量减1后，得到
=f'x)=f(x+D)+f(α-D-2f(x) (10.2-2)
很容易证明式(10.2-1)和式(10.2-2)满足本节开始时说明的关于一阶和二阶导数的条件。为了说明这
一点，并强调一阶导数和二阶导数在图像处理中的基本相同点和不同点，考虑图10.2。
图10.2(a)显示了一幅图像，该图像中包含有不同的实心物体、一条线和单个噪声点。图10.2(b)
显示了近似通过该图像中心的水平灰度剖面(扫描线),其包括孤立点。实心物体和沿扫描线的背景之
间的灰度过渡显示了两种类型的边缘：斜坡边缘(左侧)和台阶边缘(右侧)。正如稍后我们要讨论的那
样，灰度过渡涉及较细物体，如常称为屋顶边缘的线。图10.2(c)显示了剖面线的简化，构成曲线的
点刚好足够我们在遇到一个噪声点、一条线和物体的边缘时在数量上分析一阶导数和二阶导数的特
性。在这幅简化图中，斜坡的过渡跨越4个像素，噪声点是单个像素，线为3个像素粗，灰度台阶的
过渡发生在邻接像素间。为简化起见，灰度级数限制为8级。
辰;引
灰度 74c43 孤立点
斜坡 线 台阶
平坦段 2
1
0
图像条带
a b 一阶导数-1-1-1-1-10(
5543210006 0000 1 3 1 001 0017777·
06-60001 2-2-1000 7 000 c I
二阶导数-10000106-1260 0
111I I 1
—
II1
141 1 007-700
图10.2 (a)图像；(b)通过该图像中心的水平灰度剖面，包括孤立噪声点；(c)简化后的剖
面线(为清楚起见，点已用虚线连接起来)。图像条带对应于灰度剖面曲线，方框中
的数字是剖面线中所示的点的灰度值。导数是使用式(10.2-1)和式(10.2-2)得到的
第10章 图 像分 割 447
现在我们考虑当从左到右横穿该剖面时一阶导数和二阶导数的性质。首先，我们注意到在灰度
斜坡的开始处并沿着整个灰度斜坡，一阶导数不为零，同时二阶导数仅在斜坡的开始处和结尾处不为
零。因为数字图像的边缘类似于这种类型的过渡，故我们断定一阶导数会产生“粗”边缘，而二阶导
数则会产生细得多的边缘。接下来，我们遇到孤立噪声点。该点处的二阶导数响应幅度远强于一阶导
数响应幅度。这并不意外，因为在增强剧烈变化方面，二阶导数要比一阶导数更为激进。这样，我们
就可以预期，在增强细节(包括噪声)方面二阶导数远强于一阶导数。在本例中线是如此之细，以至于
它也是更精细的细节，并且我们再次看到二阶导数的幅度更大。最后，我们注意到在斜坡和台阶边缘
中，进入边缘和离开边缘过渡时的二阶导数的符号相反(从负到正或从正到负)。正如我们在10.2.6 节中
显示的那样，这种“双边缘效应”是可用于定位边缘的一种重要特性。二阶导数的符号也可用于确定
一个边缘是从亮到暗(负二阶导数)过渡还是从暗到亮(正二阶导数)过渡，这里，当我们移进边缘时，
就观察到这个符号。
总之，我们得出如下结论：(1)一阶导数通常在图像中产生较粗的边缘；(2)二阶导数对精细细
节，如细线、孤立点和噪声有较强的响应；(3)二阶导数在灰度斜坡和灰度台阶过渡处会产生双边缘
响应；(4)二阶导数的符号可用于确定边缘的过渡是从亮到暗还是从暗到亮。
用于计算图像中每个像素位置处的一阶导数和二阶导数的可选择方法是使用空间滤波器。对于
图10.3中的3×3滤波器模板，该过程是计算模板系数与被该模板覆盖的区域中的灰度值的乘积之和。
也就是说，参考式(3.4-3),模板在该区域中心点处的响应是
R=叫z+2+…+3-2wz (10.2-3)
其中z是像素的灰度，该像素的空间位置对应于模板中第 k
个系数的位置。3.4节和3.6节中已详细讨论了对图像中所有
像素执行这种操作的细节。换句话说，基于空间模板的导数
的计算是用这些模板对一幅图像进行空间滤波，正如在那些
章节描述的那样。
10.2.2 孤立点的检测
基于前一节得到的结论，我们可知点的检测应以二阶导
数为基础。由3.6.2节的讨论，这意味着使用拉普拉斯： 图10.3一个普通的3×3空间滤波器掩模
v2fx,)=+
1 02 W
0 wy W%
08
(10.2-4)
其中，偏微分用式(10.2-2)得到：
=fx+1.y+fu-.,y)-2f(x,》 (10.2-5)
和
=rux,y+)+f(x,y-D-2f(x,》 (10.2-6)
①像3.4.3节中解释的那样，式(10.2-3)要么是由式(341)给出的空间相关的简化表示，要么是由式(3.42)给出的空间卷积的简
化表示。因此，当在一幅图像中的所有位置处计算R时，结果都是一个阵列。本章中的所有空间滤波操作都是使用相关完成
的。在某些情形下，我们通常会使用术语“模板与图像卷积”。但是，我们仅在滤波器是对称滤波器时才使用这一术语，因为
这一情形下相关和卷积会产生相同的结果。 风
园
448 数字图像处理(第三版)
故拉普拉斯是
v2f(x,y=f(x+1,y)+f(x-1,y)+f(x,y+D+f(x,y-)-4f(x,y) (10.2-7)
如3.6.2节中解释的那样，该表达式可以用图3.37(a)中的模板来实现。此外，如该节描述的那样，我
们可以把式(10.2-7)扩展为包括对角项，并使用图3.37(b)中的模板。使用图10.4(a)中的拉普拉斯模
板，它与图3.37(b)中的模板相同，如果在某点处该模板的响应的绝对值超过了一个指定的阈值，那
么我们说在模板中心位置(x,y)处的该点已被检测到了。在输出图像中，这样的点被标注为1,而所有
其他点则被标注为0,从而产生一幅二值图像。换句话说，输出是使用如下表达式得到的：
8(x,)={6其他 (10.2-8)
其中，g是输出图像，T是一个非负的阈值，R由式(10.2-3)给出。该式简单地度量一个像素及其8个
相邻像素间的加权差。从直观上看，这一概念是一个孤立点的灰度将完全不同于其周围像素的灰度，因
而，使用这种类型的模板可很容易地检测出这个孤立点。考虑的重点仅仅是灰度的不同对于研究孤立点
已很充分了。注意，通常对于一个导数模板，这些系数之和为零表明在恒定灰度区域模板响应将是0。
1 1 1
1 8 1
1 1
bed
图10.4 (a)点检测(拉普拉斯)模板；(b)带有一个通孔的涡轮叶片的X射线图像。该通孔含
有一个黑色像素；(c)模板与图像卷积的结果；(d)使用式(10.2-8)得到的结果，结果
中显示了一个点(为便于观看，该点已被放大)(原图像由X-TEK Systems有限公司提供)
例10.1 图像中孤立点的检测。
借助于图10.4(b),我们来说明如何从一幅图像中将孤立点分割出来。该图像是一幅喷气发动机涡
轮叶片的X射线图像。图像右上象限中的叶片有一个通孔，该通孔中已嵌入一个黑色像素。图10.4(c)
是将点检测模板应用到该幅X射线图像后的结果，图10.4(d)显示了当T取图10.4(c)中像素的最高绝对
值的90??，应用式(10.2-8)所得到的结果。在这幅图像中，这个单一像素清晰可见(为增加其可视性，
该像素已被人为放大)。这种类型的检测过程相当特殊，因为它基于单个像素位置处灰度的突变，这些
位置被检测模板区域中的同质背景所围绕。当这一条件不能满足时，则本章中讨论的其他方法会更适
合于检测灰度变化。
第10章 图 像分 割 449
10.2.3 线检测
复杂度更高的检测是线检测。基于10.2.1节中的讨论，我们知道，对于线检测，可以预期二阶导
数将导致更强的响应，并产生比一阶导数更细的线。这样，对于线检测，我们也可以使用图10.4(a)
中的拉普拉斯模板，记住，二阶导数的双线效应必须做适当的处理。下面的例子说明了这一处理过程。
例10.2 用拉普拉斯进行线检测。
图10.5(a)显示了一幅486×486电子电路的接线掩模的一部分(二值图像),图10.5(b)显示了其拉普拉
斯图像。因为拉普拉斯图像包含有负值②,为便于显示，做比例调节是必要的。如放大部分显示的那样，
中等灰度表示零，较暗的灰色调表示负值，而较亮的色调表示正值。在放大部分，双线效应清晰可见。
首先，负值看起来可通过取拉普拉斯图像的绝对值来简单地处理。然而，如图10.5(c)所示，该方法
会使线的宽度加倍。一个更合适的方法是仅使用拉普拉斯的正值(在有噪声的情形下，我们使用超过正阈
值的那些值，去掉那些由噪声导致的零附近的随机变化)。如图10.5(d)中的图像所示，这种方法产生了更
细的线，这些线更有用。注意，在图10.5(b)到图10.5(d)中，当线的宽度比拉普拉斯模板的尺寸宽时，这
些线就被一个零值“山谷”分开了。
a bcd
图10.5(a)原图像；(b)拉普拉斯图像，放大部分显示了拉普拉斯的
正/负双线效应；(c)拉普拉斯的绝对值；(d)拉普拉斯的正值
这是预料之中的。例如，当把这个3×3滤波器居中放在一条宽为5个像素的恒定灰度线上时，其响
应将为零，这样就产生了刚才提到的效应。当我们谈论线检测时，假设这些线要细于检测子的尺寸。不
满足这一假设的线最好当做区域，并使用本节稍后讨论的边缘检测方法来处理。
图10.4(a)中的拉普拉斯检测子是各向同性的，因此其响应与方向无关(相对于该3×3拉普拉斯模
板的4个方向：垂直方向、水平方向和两个对角方向)。通常，我们的兴趣在于检测特定方向的线。
最佳响应；第四个模板对于-45°方向的线有最佳响应。每个模板的首
选方向用一个比其他方向更大的系数(如 2)加权。每个模板中的系数
之和为零，这表明恒定灰度区域中的响应为零。
考虑图10.6 中的模板。假设使用第一个模板对一幅具有恒定背景并包含各种线(方向为0°,±45°和
90°)的图像进行滤波。最大响应将出现在图像中通过该模板中间行的一条水平线处。通过勾画一个
元素为1的简单阵列，并画一条水平穿越该阵列的具有不同灰度(假 回忆 24.2节可知图像轴约定如
下：原点位于左上角。正x轴指向
下方，正y轴指向右方。本节中讨
论的线的角度是指相对于正x轴度
量的角度。例如。垂直线的角度为
0°,+45°线向右下方向延伸。
设为5)的线，可很容易地验证这一点。类似的实验表明，图10.6中的
第二个模板对于45°方向的线有最佳响应；第三个模板对于垂直线有
①当其系数之和为零的掩模与一幅图像进行卷积时，结果图像中的像素之和也为零(见习题3.16),这表明结果中存在正像素和负
像素。比例调节的目的是。使所有的负值适合于显示。 园
屈;匹
450 数字图像处理(第三版)
-1 -1 -1 2 -1 -1 -1 2 -1 -1 -1 2
2 2 2 -1 2 -1 -1 2 -1 -1 2 -1
-1 -1 -1 -1 -1 2 -1 2 -1 2 -1 -1
水平 +45° 垂直 -45°
图10.6 线检测模板。角度是相对于图2.18(b)中的坐标轴系统的
令R?,R?,R?和R?表示图10.6中从左到右的各个模板的响应，其中R值由式(10.2-3)给出。假设
使用这4个模板对一幅图像滤波。在该图像中的某个给定点处，如果
对于所有j≠k有IRI>IRI,则称该点可能与模板k方向的一条线更相
似。例如，如果在图像中的某个点处，对于j=2,3,4有IR?I>IRJ,则
说该点可能与一条水平线更相似。换句话说，我们可能对检测特定方
向上的线感兴趣。在这种情况下，我们会使用与该方向相关的模板，并对其输出进行阈值处理，就像
在式(10.1-2)中那样。换句话说，如果我们对检测图像中由给定模板定义的方向上的所有线感兴趣，
则只须简单地对该图像运行这个模板，并对结果的绝对值进行阈值处理。留下的点是有最强响应的点，
对于1个像素宽度的线来说，相应的点最接近于模板定义的方向。下例说明了这一过程。
例10.3 特定方向线的检测
图10.7(a)显示了前一例子中所用的图像。假设我们的兴趣在于寻找所有的宽度为1个像素、方向为
45°的线。为了这一目的，我们使用图10.6中的第二个模板。图10.7(b)是用该模板对图像滤波后的结果。
如之前那样，图10.7(b)中比背景暗的色调对应于负值。图像中有两个取向为+45°方向的主要线段：一
个在左上方，另一个在右下方。图10.7(c)和(d)显示了图10.7(b)中对应于这两个区域的放大部分。注意，
图10.7(d)中的直线段比图10.7(c)中的该线段亮得多。原因是图10.7(a)中右下方线段的宽度为1个像素，
而左上方线段的宽度则不是。该模板被“调谐”到检测+45°方向的1个像素宽的线，我们期望，当检测
这样的线时，其响应较强。图10.7(e)显示了图10.7(b)的正值。因为我们的兴趣在于最强响应，我们令T
等于图10.7(e)中的最大值。图10.7f)使用白色显示了其值满足条件g≥T的点，其中g是图10.7(e)中
的图像。该图中的孤立点是对模板也有类似强响应的点。在原图像中，这些点与它们的邻点都按这样一
种方法来取向，即模板在这些位置会产生最大的响应。用图10.4(a)中的模板可检测这些孤立点，然后删
除这些点；或者可以使用上一章中讨论的形态学算子来删除这些孤立点。
10.2.4 边缘模型
边缘检测是基于灰度突变来分割图像的最常用的方法。我们从介绍一些边缘建模的方法开始，
然后讨论一些边缘检测方法。
边缘模型根据它们的灰度剖面来分类。台阶边缘是指在1个像素的距离上发生两个灰度级间理
想的过渡。图10.8(a)显示了一个垂直台阶边缘的一部分和通过该边缘的一个水平剖面。例如，用于
诸如固体建模和动画领域的出现在由计算机生成的图像中的台阶边缘。这些清晰、理想的边缘可出现
在1个像素的距离上，不需要提供任何使它们看上去“很真实”的附加处理(如平滑)。在算法开发中，
数字台阶边缘常用做边缘模型。例如，10.2.6节中讨论的坎尼边缘检测算法就是用一个台阶边缘模型
推导的。
注意，这里使用R来表示模板响
应，而10.1 节中则用来表示区域，
请不要混淆。
第10章 图 像分 割 451
dei
图10.7(a)接线板掩模图像；(b)使用图10.6中的+45°线检测子模板处理后的结果；(c)图(b)左上方区域
的放大观察图；(d)图(b)右下区域的放大观察图；(e)将图(b)中所有负值置为零后的图像；(1)其
值满足条件g≥T的所有点(白色),其中g是图(e)中的图像[为便于查看，图①中的点已被放大]
a b c
图10.8 从左到右分别为一个台阶模型、一个斜坡模型和一个屋顶边缘模型(理想表示)及它们的相应灰度剖面
实际中，数字图像都存在被模糊且带有噪声的边缘，模糊的程度主要取决于聚焦机理(如光学成
像中的镜头)中的限制，而噪声水平主要取决于成像系统的电子元件。在这种情况下，边缘被建模为
一个更接近灰度斜坡的剖面，如图10.8(b)中的边缘。斜坡的斜度与边缘的模糊程度成反比。在这一
模型中，不再存在一条细的(1 像素宽)轨迹。相反，一个边缘点现在是斜坡中包含的任何点，而一
条边缘线段将是一组已连接起来的这样的点。
边缘的第三种模型是所谓的“屋顶”边缘，这种边缘具有图10.8(c)所示的特性。屋顶边缘是通
过一个区域的线的模型，屋顶边缘的基底(宽度)由该线的宽度和尖锐度决定。在极限情形下，当其
基底为1个像素宽时，屋顶边缘只不过是一条穿过图像中一个区域的一条1像素宽的线。例如，在
深度成像中，当细物体(如管子)比它的等距离的背景(如墙)更接近传感器时，出现屋顶边缘。管道更
亮，因而产生了一幅类似于图10.8(c)中模型的图像。如先前提及的那样，经常出现屋顶边缘的其他
领域是在数字化的线条图和卫星图像中，此时如道路这样的较细特征可由这种类型的边缘建模。
包含所有三种类型边缘的图像并不罕见。虽然模糊和噪声会导致与理想形状的偏差，但图像中
有适当锐度和适中的噪声的边缘确实存在类似于图10.8 中边缘模型的特性，如图10.9所示的剖面①
图10.8中的模型允许我们在图像处理算法的开发中写出边缘的数学表达式。这些算法的性能将取决于
实际边缘和在算法开发中所用模型之间的差别。
图10.10(a)显示了从图10.8(b)中的一段中提取出来的一幅图像。图10.10(b)显示了一条水平灰度
剖面线。该图形还显示了灰度剖面的一阶导数和二阶导数。如10.2.1节中讨论的那样，当沿着灰度剖面
从左到右移动时，我们注意到，在斜坡的开始处和在斜坡上的各个点处，一阶导数为正。而在恒定灰度区
①有着几个像素的剧烈斜率的斜坡边缘，通常被当做台阶边缘处理，目的是由同一图像中斜率更为舒缓的斜坡来对它们进行微分 园
452 数字图像处理(第三版)
域的一阶导数为零。在斜坡的开始处，二阶导数为正；在斜坡的结束处，二阶导数为负；在斜坡上的各点
处，二阶导数为零；在恒定灰度区域的各点处，二阶导数为零。对于从亮到暗过渡的边缘，刚刚讨论的
导数的符号则正好相反。零灰度轴和二阶导数极值间的连线的交点称为该二阶导数的零交叉点。
图10.9 显示了(放大后的)实际斜坡(左下)、台阶(右上)和屋顶边缘剖面的一幅大小为1508×1970的图
像。在由小圆所示短线段指出的区域中，剖面从暗到亮。斜坡和台阶剖面分别跨越9个像素和
2个像素。屋顶边缘的基底是3个像素(原图像由Vanderbilt 大学的David R.Pickens博士提供)
由这些观察我们可以得出结论：一阶导数的幅度可用于检测图像中的某个点处是否存在一个边
缘。同样，二阶导数的符号可用于确定一个边缘像素位于该边缘的暗的一侧还是亮的一侧。我们注意
到围绕一条边缘的二阶导数的两个附加性质：(1)对图像中的每条边缘，二阶导数生成两个值(一条不
希望的特点);(2)二阶导数的零交叉点可用于定位粗边缘的中心，正如我们将在本节稍后将要说明的
那样。某些边缘模型可用来在进入和离开斜坡的地方平滑过渡(见习题10.7)。然而，使用这些模型得
到的结论与使用一个理想斜坡得到的结论相同，且用后者可简化理论公式。最后，尽管迄今为止我们
的注意力限制在一维水平剖面上，但类似的结论适用于图像中任何方向的边缘。我们简单地定义了一
个在任何期望的点与边缘方向垂直的剖面，并用刚刚讨论的对垂直边缘相同的方法对结果进行了解释。
a b
725
水平灰度剖面
一阶导数
二阶导数
零交叉
图 10.10(a)由一条理想垂直边缘分开的两个恒定灰度区域；(b)边缘附
近的细节，显示了一个水平灰度剖面及其一阶导数和二阶导数
第10章 图 像分 割 453
例10.4 一条有噪声边缘的一阶导数和二阶导数的性质。
图10.8 中的边缘是无噪声的。图10.11 中第一列图像段是4个斜坡
边缘的特写，这些边缘从左边的黑色区域到右边的白色区域过渡(记住，
从黑到白的整个过渡是一个单一的边缘)。左上方的图像段无噪声。第一
列中的其他三幅图像被均值为零、标准差分别为0.1,1.0和10.0个灰度级的加性高斯噪声污染。每幅图像
下面的图形是一个通过图像中心的水平灰度剖面线。所有图像具有8比特的灰度分辨率，并用0和255
分别表示黑色与白色。
考虑中间一列顶部的图像。就像我们对图10.10(b)的讨论那样，左侧扫描线的导数在灰度恒定区域为
零。这是在导数图像中显示的两个黑色条带。在斜坡上的各点处的导数是恒定的，并等于斜坡的斜率。
在导数图像中这些恒定值显示为灰色。当我们沿中间列向下移动时，导数会变得与无噪声情形时越来越
不相同。实际上，将中间列中最后一个剖面与斜坡边缘的一阶导数联系起来将会很困难。造成这种有意
思的结果的原因是左列图像中的噪声几乎不可见。这些例子很好地说明了导数对噪声的敏感性。
如预想的那样，二阶导数对于噪声甚至更为敏感。无噪声图像的二阶导数显示在右列的上部。白色
和黑色的细垂直线是二阶导数的正分量和负分量，就像图10.10中解释的那样。这些图像中的灰色表示零
(如先前讨论的那样，比例缩放导致零显示为灰色)。唯—一个类似于无噪声情况的有噪声二阶导数图像
对应于标准差为0.1的噪声。另两幅二阶导数图像和剖面清楚地表明了检测这些图像中的正分量和负分量
的确很困难，而这些分量在边缘检测中确实是非常有用的二阶导数特性。
微弱的可见噪声对检测边缘所用的两个关键导数的严重影响的这一事实，是我们应记住的一个重要问
题。特别地，在类似于我们刚刚讨论的水平的噪声很可能存在的应用中，使用导数之前的图像平滑处理是
应该认真考虑的问题。
图10.11 第一列：被均值为零、标准差分别为0.0,0.1,10和10.0个灰度级的随机高斯噪声所污染的斜坡边缘
的图像和灰度剖面。第二列：一阶导数图像和灰度剖面线。第三列：二阶导数图像和灰度剖面线
节中讨论。现在，我们的目的只是
整个图像段的导数计算将在下一
分析灰度剖面。
7-7
屈;高
454 数字图像处理(第三版)
我们用上面的解释给出执行边缘检测的三个基本步骤：
1.为降噪对图像进行平滑处理。需要这一步的原因已由图10.11的第二列和第三列中的结果做了
详细说明。
2.边缘点的检测。如先前提及的那样，这是一个局部操作，从一幅图像中提取所有的点，这些
点是变为边缘点的潜在候选者。
3.边缘定位。这一步的目的是从候选边缘点中选择组成边缘点集合中的真实成员。
本节剩下的内容探讨实现这些目标的一些技术。
10.2.5 基本边缘检测
正如前一节说明的那样，为了达到寻找边缘的目的，检测灰度变化可用一阶或二阶导数来完成。
在这一节中，我们讨论一阶导数，二阶导数将在10.2.6节中讨论。
图像梯度及其性质
为了在一幅图像f的(x,y)位置处寻找边缘的强度和方向，所选择
的工具就是梯度，梯度用Vf来表示，并用向量来定义：
为方便起见，这里重复给出 3.64
节中的一些公式。
(10.2-9)
该向量有一个重要的几何性质，它指出了f在位置(x,y)处的最大变化率的方向。
向量Vf的大小(长度)表示为M(x,y),即
M(x,y)=mag(Vf)=√82+8} (10.2-10)
它是梯度向量方向变化率的值。注意，8x,8,和M(x,y)都是与原图像大小相同的图像，是x和y在f
中的所有像素位置上变化时产生的。实践中，我们通常称后一图像为梯度图像，或者在含义很清楚时
简称为梯度。如2.6.1节中定义的那样，求和、平方和开方操作都是阵列操作。
梯度向量的方向由下列对于x轴度量的角度给出：
a(x,)=acm&] (10.2-11)
如在梯度图像的情况那样，α(x,y)也是与由g,除以g的阵列创建的尺寸相同的图像。任意点(x,y)
处一个边缘的方向与该点处梯度向量的方向α(x,y)正交。
例10.5 梯度的性质。
图10.12显示了包含一段直的边缘线段放大的一部分。所显示的每个方块对应于一个像素，我们的兴
趣是得到用一个方框强调的点处边缘的强度和方向。灰色像素的值为0,白色像素的值为1。下面我们说
明该例子，为计算x方向和y方向的梯度，该方法使用一个关于一点为中心的3×3邻域，简单地从底
部一行的像素中减去顶部一行邻域中的像素，得到x方向的偏导数。类似地，我们从右列的像素中减
去左列的像素得到y方向的偏导数。接下来，用这些差值作为偏导数的估计，在这一点处有afldx=-2
和afldy=2。从而有
第10章 图 像分 割 455
3
由此，我们可以得到这一点处的M(x,y)=2√2。类似地，相同点处梯度向量的方向遵循式(10.2-11):
α(x,y)= arctan(g,/8,)=-45°,它与相对于x轴的正方向度量的135°相 回忆24.2节可知，图像坐标系统
的原点位于左上角。正x轴向下延 同。图10.12(b)显示了该梯度向量及其方向角。
伸，正y轴向右延伸。 图10.12(c)说明了之前提到的一个重要事实，即某点的边缘与该点
的梯度向量正交。因此，在这个例子中，边缘的方向角是α-90°=45°。图10.12(a)中的所有边缘点都有
相同的梯度，所以，整个边缘段都处在相同的方向上。梯度向量有时也称为边缘法线。当向量通过除以
其幅值[见式(10.2-10)]而归一化为单位长度时，结果向量通常称为边缘单位法线。
梯度向量 梯度向量
/0 α-90°
! 边缘方向 x
a bc
图10.12 用梯度确定某个点处的边缘强度和方向。注意，某点处的边缘
垂直于该点处的梯度向量的方向。图中的每个方块表示一个像素
梯度算子
要得到一幅图像的梯度，则要求在图像的每个像素位置处计算偏导数0flax和Oflay。我们处
理的是数字量，因此要求关于一点的邻域上的偏导数的数字近似。由10.2.1节，我们可知
8.==f(x+1,)-f(x,) (10.2-12)
和
8,=x=f(x,y+D-f(x》 (10.2-13)
这两个公式对所有x和y的有关值可用图10.13中的一维模
板通过对f(x,y)的滤波来执行。
a b -1 -1 1
当对对角线方向的边缘感兴趣时，我们需要一个二维模板。
罗伯特交叉梯度算子(Roberts[1965])是最早尝试使用具有对角优
势的二维模板之一。考虑图10.14(a)中的3×3区域。罗伯特算
子以求对角像素之差为基础：
图10.13 用于实现式(10.2-12)和
1
式(10.2-13)的一维模板
&==(2-3) (10.2-14)
和
8,-3=(2-2) (10.2-15)
这些导数可以使用图10.14(b)和(c)中的模板对图像进行滤波来实现。
用于计算梯度偏导数的滤波器模
板，通常称为梯度算子、差分算子。
边缘算子或边缘检测子。
居;退
456 数字图像处理(第三版)
2×2大小的模板在概念上很简单，但是它们对于用关于中心点对称的模板来计算边缘方向不是很
有用，其最小模板大小为3×3。这些模板考虑了中心点对端数据的性质，并携带有关于边缘方向的
更多信息。用大小为3×3的模板来近似偏导数的最简单的数字近似由下式给出：
屈;;
8==(7+Z+2)-(z+Z?+z) (10.2-16)
和
8,-=(z+Z+2)-(z+Z+2) (10.2-17)
bcdg z 2 z -1 -1 -1
Z4 Z5 Z 0 0 0
Z7 2 Z 1 1 1
Prewitt
-1 0
0 1
Roberts
0 -1
-1 -2 -1
1 0
0 0 0
2 1
Sobel
图10.14 一幅图像的3×3区域(z项是灰度值)和用于计算标记点z,处的梯度的不同模板
在这些公式中，3×3区域的第三行和第一行之差近似为x方向的导数，第三列和第一列之差近似
为y方向的导数。直观上，我们可以预料这些近似要比用罗伯特算子得到的近似更准确。式(10.2-16)
和式(10.2-17)可用图10.14(d)和(e)中的两个模板通过滤波整个图像来实现。这两个模板称为 Prewit
算子(Prewitt[1970])。
对这两个公式的一个小小的变化是在中心系数上使用一个权值2:
8-=(z+2a+z)-(z+2?+2)
尽管这些公式包含了较大的邻
域，但我们仍处理灰度值间的差。
因此之前讨论一阶导数时得到的结
论仍然适用。
-1 0 1
-1 0 1
-1 0 1
-1 0 1
-2 0 2
-1 0 1
(10.2-18)
和
8,==(z+26+2)-(z+2z+z) (10.2-19)
可以证明，在中心位置处使用2可以平滑图像(见习题10.10)。图10.14(f)和(g)显示了用于实现
式(10.2-18)和式(10.2-19)的模板。这些模板称为Sobel算子(Sobel[1970])。
Prewitt 模板实现起来比 Sobel模板更为简单，但它们之间计算上的小差别并不是问题。正如前一
节提到的那样，Sobel 模板能较好地抑制(平滑)噪声的特性这一事实使得它们更可取，因为在处理导
数时噪声抑制是一个重要的问题。注意，图10.14中所有模板中的系数之和为零，正如导数算子所预
示的那样，恒定灰度区域的响应为零。
刚才讨论的模板用于在图像的每个像素位置处得到梯度分量g和g,。然后，用这两个偏导数估
计边缘的强度和方向。计算梯度的幅度时，要求按式(10.2-10)所示的方法联合使用g和g。然而，
第10章 图 像分 割 457
这种实现并不总是令人满意，因为平方和平方根需要大量的计算开销。经常使用的一种方法是用绝对
值来近似梯度的幅值：
M(x,y)=|8x|+|8,| (10.2-20)
该式不仅在计算上更有吸引力，而且仍保持着灰度级的相对变化。为这一优点付出的代价是导致滤波
器一般将不再是各向同性(旋转不变)的。然而，当使用Prewitt和Sobel这样的模板来计算g和g,时，
这并不是问题，因为这些模板仅对垂直和水平边缘才会给出各向同性的结果。不管使用这两个公式中
的哪一个，只有在这两个方向上的边缘其结果才是各向同性的。此外，当使用 Sobel 或Prewitt 模板
时，式(10.2-10)和式(10.2-20)对垂直和水平边缘给出相同的结果(见习题10.8)。
可以修改图10.14中的3×3模板，以便它们沿对角线方向有最大的响应。图10.15显示了另外两
个用于检测对角线方向边缘的Prewitt 和Sobel模板。
a bcd 0 1 1
-1 0 1
-1 -1 0
Prewitt
-I -1 0
-1 0 1
0 1 1
0 2 -2 -1 0
-1 0 1 -1 0 1
-2 -1 0 0 1 2
Sobel
图10.15 检测对角边缘的Prewitt和Sobel模板
例10.6 二维梯度幅值和角度的说明。
图 10.16 说明了两个梯度分量g,和gJ的绝对值响应，以及由这两个分量之和形成的梯度图像。梯度
的水平和垂直分量的方向性在图10.16(b)和(c)中很明显。注意，图10.16(b)中屋顶的瓦片、砖块的水平
接缝和窗户的水平线段比起其他边缘要强得多。相比之下，图10.16(c)中正面和窗户的垂直分量更强。
当一幅图像涉及的主要特性是边缘时，如梯度幅度图像，通常使用边缘图这一术语。在图 10.16(a)中，
图像的灰度被标定在[0,1]范围内。在本节讨论的各种边缘检测方法中，我们使用这一范围内的值来简化
参数的选择。
a b cd
图10.16 (a)灰度值已标定为范围[0,1]内的、大小为834×1114的原图像；(b) lgJ.
用图10.14(0中的Sobel模板滤波图像得到的x方向上的梯度分量；(c)IgJ.
用图10.14(g)中的模板得到的y方向上的梯度分量；(d)梯度图像gJ+lgJ
图10.17显示了使用式(10.2-11)计算得到的梯度角度图像。通常，对于边缘检测而言，角度图像不像
幅度图像那样有用，但它们可以作为用梯度幅值从图像中提取的信息的补充。例如，图10.16(a)中的恒
定灰度区域，诸如斜屋顶的前边缘和前墙顶部的水平条带，在图10.17中都是恒定的，这说明在这些区域
中的所有像素位置处的梯度向量方向是相同的。正如我们在10.2.6 节说明的那样，在坎尼边缘检测算法
的实现中，角度信息起着重要的支撑作用，坎尼边缘检测算法是在本章中我们讨论的最先进的边缘检测
方法。 阅
458 数字图像处理(第三版)
图10.16(a)中所示原图像的分辨率相当高(834×1114像
素),且在图像获取的距离上，墙砖对于图像细节的贡献仍
十分显著。这种精细的细节在边缘检测中通常是不符合需
要的，因为它往往表现为噪声，导数计算会增强这种噪声，
从而使图像中主要边缘的检测变得复杂。减少精细细节的
一种方法是对图像进行平滑处理。图10.18显示了与图10.16
中相同的图像序列，但先使用一个大小为5×5的均值滤波
器对原图像进行了平滑(关于平滑滤波器，见3.5节)。现在
每个模板的响应几乎未显示出由砖块造成的影响，得到的
结果几乎都是主要的边缘。
图10.17 使用式(10.2-11)计算的梯度角度
图像。在该图像中的恒定灰度
在图10.16和图10.18中，水平和垂直Sobel模板不区 区域指出这些区域中所有像素
分±45°方向的边缘是很明显的。如果沿对角方向强调边缘 位置处的梯度向量的方向均相同
很重要，则应使用图10.15中所示的一个模板。图10.19(a)
和(b)分别显示了45°和-45°的Sobel模板的绝对响应。在这些图中，
这些模板的较强的对角响应很明显。两个对角模板对水平边缘和垂
直边缘都有类似的响应，但正如所期望的那样，它们在这些方向上
的响应要比之前讨论的水平和垂直模板的响应弱。
a bcd
图10.18 与图10.16中的相同图像序列，但在边缘检测之前，用大小为5×5的均值滤波器对原图像进行了平滑
平滑后图像的最大边缘强度(幅度
(见习题10.13)。
会随着平滑模板尺寸的增加而减小
a b
图10.19 对角边缘检测：(a)使用图 10.15(c)中的模板得到的结果；(b)使用
图10.15(d)中的模板得到的结果。两种情况下的输入图像都是图10.18(a)
与阈值处理相结合的梯度
图10.18中的结果说明，在计算梯度前对图像进行平滑处理，边缘检测可做更多的选择。实现
相同的基本目标的另一种方法是对梯度图像进行阈值处理。例如，图10.20(a)显示了图10.16(d)经阈
值处理后的梯度图像，此时其值大于或等于梯度图像的最大值的33% 选择用于生成图10.20(a)的阀值的
目的，是消除砖块导致的多数较小边 734 的像素显示为白色，而低于该阈值的像素则显示为黑色。该图像与 ss 缘。回忆可知，这是在计算梯度前平 图10.18(d)进行比较，我们看到阈值处理后的图像中边缘更少，并且 滑图10.16中的图像的基本目标
第10章 图 像分 割 459
这幅图像中的边缘要尖锐得多(例如，见屋瓦中的边缘)。另一方面，在阈值处理后的图像中，许多边
缘，如确定屋顶远边缘的45°线，被断开了。
当目的是突出主要边缘并尽可能维护连接性时，实践中通常平滑处理和阈值处理两者都使用。
图10.20(b)显示了图10.18(d)经阈值处理后的结果，它是平滑后图像的梯度。该结果显示断开的边
缘减少了一些；例如，比较图10.20(a)和(b)中的45°边缘。当然，这些由于模糊处理其灰度值严重
降低的边缘(即屋瓦中的边缘)可能因阈值处理而完全消除。在10.2.7节我们再回来讨论边缘断线的
问题。
ab
图10.20(a)图10.16(d)中图像经阈值处理后的图像，阈值选择为图像中最高值的33%;
该阈值刚好高到足以消除梯度图像中的多数砖块边缘；(b)图10.18(d)中图
像经阈值处理后的图像，它是使用等于图像中最高值的33??阈值得到的
10.2.6 更先进的边缘检测技术
前一节中讨论的边缘检测方法是以用一个或多个模板对图像进行滤波为基础的，而未对图像特
性和噪声内容采取预防措施。在这一节，我们讨论更为先进的技术，尝试考虑诸如图像噪声和边缘本
身特性的因素改进简单的边缘检测方法。
Marr-Hildreth 边缘检测器
最早的成功地尝试将更高级的分析结合到边缘检测处理之一应归
功于Marr和Hildreth[1980]。正如前节所讨论的那样，当时，边缘检
测方法是以使用较小的算子为基础的(如Sobel模板)。Mar 和Hildreth
证明了：(1)灰度变化与图像尺寸无关，因此他们的检测要求使用不
为证明边缘检测与图像尺寸无
关，可以考虑图 10.8(c)中的屋顶边
缘。如果图像的尺寸减小，则边缘
会更细。
同尺寸的算子；(2)灰度的突然变化会在一阶导数中引起波峰或波谷，或在二阶导数中等效地引起零
交叉(就像我们在图10.10中见到的那样)。
这些概念建议，用于边缘检测的算子应有两个显著的特点。第一
个和最重要的特点是它应该是一个能计算图像中每一点处的一阶导数
或二阶导数的数字近似的微分算子。第二，它应能被“调整”以便在
任何期望的尺寸上起作用，因此，大的算子也可用于检测模糊边缘，
小的算子可用于检测锐度集中的精细细节。
Marr和Hildreth 论证过，满足这些条件的最令人满意的算子是滤波器V2G,如在3.6.2节中定义
的那样，V2是拉普拉斯算子(a2/ax2+a2/ay2),而G是标准差为σ(有时σ 也称为空间常数)的二
维高斯函数
Gax,)=e
式(102-21与二维高斯概率密度函数
到式(10.2-23)的最终结果中。
的定义的不同在于常数项I2mo2。如
果在某个给定应用中期望得到一个
精确的表达式，则乘以常数可添加
吼; (102-21)
460 数字图像处理(第三版)
为求V2G的表达式，我们执行如下微分：
vcusy,s]
]]
(10.2-22)
整理各项后给出如下最终表达式：
v'cx,)-[2+x2-22] (10.2-23)
该表达式称为高斯拉普拉斯(LoG)。
图10.21(a)到(c)显示了一个LoG的负函数的三维图、图像和剖
面(注意LoG的零交叉出现在x2+y2=o2处，它定义了一个中心位
于原点、半径为√2o的圆)。因为图10.21(a)中显示的形状，LoG函
数有时也称为墨西哥草帽算子。图10.21(d)显示了一个5×5的模板，
它近似于图10.21(a)中的形状(在实践中，我们会用该模板的负模板)。这个近似并不是唯一的，其目
的是获取LoG函数的基本形状；根据图10.21(a),这意味着一个正的中心项由紧邻的负区域包围着，
中心项的值以距原点的距离为函数而增大，而外层区域的值为零。系数之和必须为零，从而模板的响
应在恒定灰度区域为零。
注意图10.21(c)中剖面与图4.37(c)
中高通滤波器之间的相似性。这样。
我们可期望 LoG的作用类似于一个
高通滤波器。
-7
ViG d
v'G
零交义一 零交叉
2√2o
图10.21 (a)负LoG的三维图；(b)显示为一幅图像的负LoG图；(c)显示了零交叉的图
(a)的横截面；(d)对图(a)中形状5×5模板的近似，实际中将使用该模板的负值
任意尺寸的模板可以通过对式(10.2-23)取样并标定系数以使系数之和为零来生成。生成LoG滤
波器的一种更有效的方法是以希望的 nxn尺寸对式(10.2-21)取样，然后将结果阵列与一个拉普拉斯模
0 0 -1 0 0
0 -1 -2 -1 0
-1 -2 16 -2 -1
0 -1 -2 -1 0
0 0 -1 0 0
第10章 图 像分 割 461
板进行卷积①,例如图10.4(a)中的模板。因为用一个系数之和为零的模板对图像阵列卷积产生一个元
素之和也为零的结果(见习题3.16和习题10.14),故这种方法自动满足LoG滤波器系数之和为零的
要求。在本节的后面将讨论LoG滤波器尺寸的选取问题。
选择算子V2G的基础有两个基本概念。第一，算子的高斯部分会模糊图像，从而在尺寸上将结
构的灰度(包括噪声)降低到远小于σ的程度。与3.5节中讨论的和图10.18中使用的平均形式不同的
是高斯函数在空间和频率两个域平滑图像(见4.8.3节),因而在原图像中引入不存在的人为干扰(如振
铃)的可能性很小。另一个概念涉及V2,即滤波器的二阶导数部分。尽管一阶导数可用于检测灰度突
变，但它们是有方向的算子。另一方面，拉普拉斯有各向同性(旋转不变)的重要优点，这不仅符合人
的视觉系统特性(Mar[1982]),而且对任何模板方向的灰度变化有相等的响应，从而避免了使用多个
模板去计算图像中任何点处的最强响应。
Marr-Hildreth算法由LOG滤波器与一幅输入图像f(x,y)卷积组成，即
g(x,y)=[V2G(x,y)]★f(x,y) (10.2-24)
然后寻找g(x,y)的零交叉来确定f(x,y)中边缘的位置。因为这些都是线性操作，故式(10.2-24)也可
写为
g(x,y)=V2[G(x,y)★f(x,y)] (10.2-25)
它指出我们可以先使用一个高斯滤波器平滑图像，然后计算该结果的
拉普拉斯。这两个公式给出了相同的结果。
Mar-Hildreth 边缘检测算法可小结如下：
1.用一个对式(10.2-21)取样得到的nxn的高斯低通滤波器对输入图像滤波。
2.计算由第一步得到的图像的拉普拉斯，例如，使用图10.4(a)的3×3模板[第一步和第二步实现
式(10.2-25)]。
3.找到步骤2所得图像的零交叉。
为确定高斯滤波器的大小，仍采用位于二维高斯表面下其均值在±3σ 之间的99.7??这样，作
为一种经验法则，一个大小为nxn的LoG离散滤波器，其n值应是大于等于6o的最小奇整数。n小
于该值的滤波器模板会“截断”LoG 函数，截断的程度与模板的大小成反比；而使用较大的模板对
结果的影响不大。
在滤波后的图像g(x,y)的任意像素p处，寻找零交叉的一种方法是用以p为中心的一个3×3邻域。p
点处的零交叉意味着至少有两个相对的邻域像素的符号不同。有4种要测试的情况：左/右、上/下和两个
对角。如果g(x,y)的值与一个阈值比较(一种通常的方法),那么不仅相对邻域的符号不同，而且它们
的数值差的绝对值还必须超过这个阈值。这时，我们称p为一个零交 试图通过查找满足g(x,y)=0的坐 叉像素。下面的例10.7中将说明这一方法。 标(x,y)来找到零交叉是不实际的。
零交叉是Marr-Hildreth 边缘检测方法的关键特征。前段中讨论的 因为噪声和或计算不准确。
方法是很有吸引力的，因为它实现简单，并且通常能给出好的结果。
如果在某个特殊应用中使用这一方法找到的零交叉位置的准确性不够，那么可采用由Huertas and
Medioni[1986]提出的采用亚像素精度来寻找零交叉方法。
① LoG是一个对称滤波器、所以使用相关或卷积的空间滤波将产生相同的结果。为与关于这一主题的文献保持一致，这里我们使
用卷积这一术语来表示线性滤波。此外，也为读者提前了解这一术语，因为在其他内容中也会遇到它。记住，3.42节末针对
这一主题给出的注释很重要
该表达式是使用式(34-2)在空间
域中实现的。也可使用式(4.7-1)在频
率域中实现。
738
739
462 数字图像处理(第三版)
7;7
例10.7 Marr-Hildreth 边缘检测算法说明。
图10.22(a)显示了早先使用过的建筑物图像，图10.22(b)是Mar-Hildreth 算法的步骤1和步骤2得
到的结果，其中σ=4(约为图像短边长度的0.5???n=25(如早先讨论的那样，大于等于60的最小奇整
数)。如在图10.5中那样，这幅图像中的灰色调已被标定过。图10.22(c)显示了使用上面讨论过的阈值为
零的3×3邻域方法得到的零交叉。注意，所有的边缘形成了一个闭环。这种所谓的意大利通心粉效应是
使用零阈值方法的严重缺点(见习题10.15)。我们使用正阈值避免闭环边缘。
图10.22(d)显示了使用近似等于LoG 图像最大值的4??阈值的结果。注意，很容易地检测出了大
多数的主要边缘，并且滤掉了一些“无关”特征，例如砖块和屋瓦的边缘。正如我们在下一节要说明的
那样，使用前节讨论的基于梯度的边缘检测技术实际上是不可能得到这种类型的性能的。使用零交叉检
测边缘的另一个重要结果是可得到一个像素宽的边缘。这一特性简化了诸如边缘连接的后续阶段的处理。
a bc d
图10.22(a)大小为834×1114像素、灰度值已标定到范围[0.1]的原图像；(b)Marr-Hildreth 算法的
步骤1和步骤2得到的结果，其中σ=4和n=25;(c)使用零阈值的图(b)的零交叉(注意
闭环边缘);(d)使用等于图(b)中图像的最大值的4??阈值时，找到的零交叉。注意细边缘
考虑到早先提及的灰度变化取决于数值范围的事实，有时所用的过程是使用各种σ值来对一幅图像
进行滤波。然后，所得零交叉边缘图与仅为全部图形保留的公共边缘相结合。这种方法可得到很有用
的信息，但由于其复杂性，实践中它多被用做使用单一滤波器选择合适的σ值的设计工具。
Mar and Hildreth[1980]指出过，使用高斯差分(DoG)来近似式(10.2-23)中的LoG滤波器是可能的：
0oC - (10.2-26)
其中σ?>0?。实验结果表明，在人的视觉系统中，某些“通道”就方
向和频率而论是有选择性的，且可以使用式(10.2-26)以1.75:1的标
准差比率来建模。Mar和Hildreth 建议过，使用1.6:1的比率不仅可
保持这些观察的基本特性，而且还可对LoG函数提供一个更接近的“工程”近似。为在LoG和DoG
之间进行有意义的比较，对于LOG,σ值必须按照如下公式选择，以便LoG和DoG具有相同的零
交叉(见习题10.17):
2i
高斯差分是一个高通滤波器，详
见4.7.4节中的讨论
(10.2-27)
当使用这个σ值时，尽管LoG和DoG的零交叉相同，但它们的幅度大小会不同。我们可以通过标定
这两个函数使得它们兼容，以便它们在原点处有相同的值。
图10.23(a)和(b)中的剖面线是分别使用标准差比率1:1.75和1:1.6产生的(按照惯例，所显示的
曲线被反转了，就像在图10.21中那样)。LoG剖面线显示为实线，而DoG剖面线显示为虚线。所示
曲线是通过LoG和DoG阵列中心的灰度剖面线，这两个阵列分别是通过对式(10.2-23)(前面有一个
常数1/2πo2)和式(10.2-26)取样产生的。所有曲线在原点处的幅度均被归一化为1。如图10.23(b)所
示，1:1.6的比率在LoG和DoG函数之间产生了一个更接近的近似。
第10章 图 像分 割 463
LoG和DoG 滤波操作均可直接使用一维卷积代替二维卷积来实现(见习题101.9)。对于一幅大
小为M×N的图像和一个大小为nxn的滤波器，这样做可将每次卷积所需的乘法和加法次数，从二维
卷积的与n2MN 成正比，减少到一维卷积的与n MN 成正比。这种实现上的差别是很有意义的。例如，
如果n=25,则一维卷积实现的乘法与加法操作次数将比二维卷积实现少12倍。
a b
图10.23(a)用比率为1.75:1的标准差的LOG(实线)和DOG(虚
线)的负值剖面线，(b)使用1.6:1的比率得到的剖面线
坎尼边缘检测器
虽然其算法更为复杂，但本节讨论的坎尼检测器(Canny[1968])是迄今为止讨论过的边缘检测器
中最为优秀的。坎尼方法基于三个基本目标：
1.低错误率。所有边缘都应被找到，并且应该没有伪响应。也就是检测到的边缘必须尽可能是
真实的边缘。
2.边缘点应被很好地定位。已定位边缘必须尽可能接近真实边缘。也就是由检测器标记为边缘
的点和真实边缘的中心之间的距离应该最小。
3.单一的边缘点响应。对于真实的边缘点，检测器仅应返回一个点。也就是真实边缘周围的局部最
大数应该是最小的。这意味着在仅存一个单一边缘点的位置，检测器不应指出多个边缘像素。
坎尼的工作的本质是从数学上表达了前面的三个准则，并试图找到这些表达式的最佳解。通常，
寻找一个满足前述目标的、严格形式的解是很困难的(或不可能的)。然而， 回忆可知，白噪声是指具有这样一
对由加性高斯白噪声污染的一维台阶边缘使用数字最佳化会得到这样一个 个频谱的噪声，该频谱在一个指定的
频率段中是连续且均匀的。白高斯噪 结论，即对最佳台阶边缘检测器的一个较好近似①是高斯一阶导数： 声则是幅度值分布为高斯的白噪声。
高斯白噪声是许多真实世界情形的较
(10.2-28)好近似，并且可产生数学上可处理的
模型。高斯白噪声的一个有用性质是
把该结果推广到二维情况会涉及识别一维方法是否仍适用于边缘法其值是统计独立的。
线的方向(见图10.12)。因为预先法线方向未知，这就要求在所有可能的方向上应用一维边缘检测器。
这一任务可由如下方法来近似：首先使用一个环形二维高斯函数平滑图像，计算结果的梯度，然后使
用梯度幅度和方向来估计每一点处的边缘强度和方向。
令f(x,y)表示输入图像，G(x,y)表示高斯函数：
G(x,y)= (10.2-29)
我们用G和f的卷积形成一幅平滑后的图像f,(x,y):
f,(x,y)=G(x,y)★f(x,y) (10.2-30)
① Canmy[1986]证明，使用高斯近似与使用最优数值解相比，所得结果仅差约20??这种幅度差在多数应用中通常是难以察觉的 居;用
7～7
464 数字图像处理(第三版)
像10.2.5节讨论的那样，在这一操作源自计算梯度幅度和方向：
M(x,y)=√82+8} (10.2-31)
和
ax,y)=acm[&] (10.2-32)
其中，gx=of,/ax,8y=d,/dy。图10.14中的任何滤波器模板对都可用来得到g和g,。式(10.2-30)
是使用一个大小为nxn的高斯模板实现的，其大小将在下面讨论。记住，M(x,y)和α(x,y)是与计算
出它们的图像的尺寸相同的阵列。
因为它是使用梯度产生的，典型地，M(x,y)在局部最大值周围通常包含更宽的范围(回忆10.2.1
节中关于使用梯度得到边缘的讨论)。下一步是细化那些边缘。一种方法是使用非最大抑制。这可通
过几种方式来做，但该方法的本质是指定边缘法线的许多离散方向(梯度向量)。例如，在一个3×3
区域内，对于一个通过该区域中心点的边缘，我们可以定义四个方向①:水平、垂直、+45°和-45°
图10.24(a)显示了一个水平边缘的两个可能方向。因为我们必须把所有可能的边缘方向量化为四个方
向，故必须定义一个方向范围，在该范围内，我们考虑一个水平方向的边缘。我们由边缘法线的方向
来确定边缘方向，边缘法线方向可以直接使用式(10.2-32)从图像数据得到。如图10.24(b)所示，如果
边缘法线方向的范围是从-22.5°到22.5°,或者是从-157.5°到157.5°,则我们称该边缘为水平边缘。
图10.24(c)显示了对应于所考虑的四个方向的角度范围。
-157.5° +157.5° 边缘法线
a b c
Pi P2 Ps
PA Ps. P?
P? 小 P
PI 中 P
P4 s P? y
P? Ps P
边缘 边缘法线
(梯度向量)
a\
边缘法线 -22.5 +22.5°
x
-157.5° +157.5° +45°边缘
-112.5 +112.5
一垂直边缘
67.5 +67.5
X
-45°边缘 -22.5 +22.5° o 水平边缘
图10.24(a)在一个3×3邻域中，一个水平边缘(灰色)的两个可能方向；(b)一个水平边缘
的边缘法线的方向角α的值的范围(灰色);(c)在一个3×3邻域中，4种类型的
边缘方向的边缘法线的角度范围。每个边缘方向都有两个范围，以对应的灰色显示
①记住，每个边缘均有两个可能的方向。例如，其法线为0的边缘和法线为180°的边缘是同一个水平边缘。
第10章 图 像 分 割 465
令d?.d?,d?和d?表示刚才讨论的3×3区域的四个基本边缘方向：水平、-45°、垂直、+45°。对
于在α(x,y)中以每一点(x,y)为中心的3×3区域，我们可给出如下非最大抑制方案：
1.寻找最接近α(x,y)的方向d。
2.如果M(x,y)的值至少小于沿d的两个邻居之一，则令gn(x,y)=0(抑制);否则，令8n(x,y)=
M(x,y),这里gn(x,y)是非最大抑制后的图像。例如，参考图10.24(a),令(x,y)在ps处，
并假设一个水平边缘通过ps,在步骤2中我们感兴趣的像素是p?和pg。图像gx(x,y)仅包
含细化后的边缘；它等于抑制了非最大边缘点的M(x,y)。
最后的操作是对8n(x,y)进行阈值处理，以便减少伪边缘点。在10.2.5节中，我们使用单阈值进
行阈值处理，其中低于该阈值的所有值均置为零。如果我们设的阈值过低，则仍会存在一些伪边缘(称
为伪正值)。如果阈值设得过高，则会删除实际上有效的边缘点(伪负值)。坎尼算法通过使用滞后阈
值试图改进这一状况，如我们在10.3.6节中讨论的那样，使用两个阈值：一个低阈值T?和一个高阈
值T。坎尼建议，高阈值和低阈值的比率应为2:1或3:1。
我们可以将阈值操作想象为创建两幅附加的图像
和
8NH(x,y)=8n(x,y)≥T
8m(x,y)=8n(x,y)≥T
(10.2-33)
(10.2-34)
其中，开始时8NH(x,y)和8m(x,y)均被置为零。阈值处理后，8N(x,y)的非零像素通常比
8m(x,y)少，但是8N(x,y)中的所有非零像素都将包含在gm(x,y)中，因为后一图像是使用一个低
阀值形成的。通过令
8m(x,y)=8m(x,y)-8N(x,y) (10.2-35)
我们从8m(x,y)中删除所有来自8(x,y)的非零像素。8N(x,y)和gm(x,y)中的非零像素可分别
看成是“强”和“弱”边缘像素。
阈值处理后，8NH(x,y)中的所有强像素均被假设为有效的边缘像素，并被立即标记。取决于Ta
的值，8N(x,y)中的边缘通常会存在缝隙。较长的边缘用下列步骤形成：
(a)在8n(x,y)中定位下一个未被访问的边缘像素p。
(b)在8m(x,y)中将所有的弱像素标记为有效边缘像素，用8连通性的连接方法连接到p。
(c)如果8N(x,y)中的所有非零像素已被访问，则跳到步骤(d),否则返回步骤(a)。
(d)将gM(x,y)中未标记为有效边缘像素的所有像素置零。
在这一过程的末尾，将来自gm(x,y)的所有非0像素附加到8N(x,y),用坎尼算子形成最终的
输出图像。
我们使用了两幅附加的图像8NH(x,y)和8m(x,y)来简化讨论。在实际中，滞后阈值处理可在非
最大抑制期间直接执行，并且，可以通过形成一个与它们相联系的强像素和弱像素的列表在gn(x,y)
中直接实现。
总结一下，坎尼边缘检测算法是由下列基本步骤组成的：
1.用一个高斯滤波器平滑输人图像。
2.计算梯度幅值图像和角度图像。
3.对梯度幅值图像应用非最大抑制。
4.用双阈值处理和连接分析来检测并连接边缘。 居
苦究
466 数字图像处理(第三版)
尽管非最大抑制后的边缘比原来的梯度边缘细，但仍保持了比1像素粗的边缘。为得到1个像素粗的
边缘，典型地，紧跟步骤4,用一遍边缘细化算法(见9.5.5节)。
正如先前提到的那样，平滑是用指定的大小为 nxn的高斯模板与输入图像进行卷积来完成的。
我们可以使用前面章节讨论过的与Marr-Hildreth 算法有关的方法决定n值。也就是，用对式(10.2-29)
取样所产生的一个滤波器模板，从而使 n是大于或等于6o的最小奇整数，以便基本上提供高斯滤波
器的“完美”平滑能力。如果实际考虑要求一个较小的滤波器模板，则折中方案是较小n值的平滑效
果会差一些。
关于实现的最终意见：正如先前讨论Mar-Hildreth边缘检测器那样，式(10.2-29)中的二维高斯函
数被分解为两个一维高斯函数的乘积。这样，坎尼算法的步骤1就可用一维卷积公式来表达，即一次
对图像中的一行(列)进行操作，然后再对处理结果中的列(行)操作。此外，如果我们使用式(10.2-12)
和式(10.2-13)中的近似，则也可将步骤2中要求的梯度计算以一维卷积来实现(见习题10.20)。
例10.8 坎尼边缘检测方法说明。
图10.25(a)显示了我们熟悉的建筑物图像。为了比较，图10.25(b)和(c)分别显示了先前在图10.20(b)
中用阈值化后的梯度得到的结果和在图10.22(d)中使用Mar-Hildreth 检测子得到的结果。回忆一下，选取
生成这两幅图像所用的参数来检测主要边缘，同时要减少“无关”特征，如由砖块和屋瓦引起的边缘。
图10.25(d)显示了用坎尼算法得到的结果，使用的参数为：T=0.04,TH=0.10(低阈值的2.5倍),
σ=4,以及对应于大于6o的最小奇整数的、大小为25×25 的模板。这些参数可交互式地选择，以达到
前面章节中对梯度和Marr-Hildreth 图像扫描规定的目标。将坎尼图像与
这里给出的几个阀值仅应在相对 其他两幅图像比较，我们看到主要边缘在细节上的明显改进，同时，在 情形下考虑。多数算法实现会涉及
坎尼结果中抑制了更多的无关特性。例如，注意坎尼算法检测到了图像 各个标定步骤，如将图像的值域标
定为范围[0.1]。从这一例子可以看 上部镶嵌在墙砖中间的水泥条带的两个边缘，然而，阈值处理后的梯度
出，不同的标定方案明显会要求不 图像中则消除了这两个边缘，并且，Marr-Hildreth 图像中则仅包含上面 同的网值。 的一个边缘。在滤除无关细节方面，坎尼图像确实不包含由屋瓦引起的
单个边缘；在其他两幅图像中却不是这样。在坎尼图像中，关于连续性、细度和笔直度等线的质量也很
出众。这种结果使得坎尼算法成为边缘检测的一种首选工具。
a bcd
图10.25(a)大小为834×1114像素、灰度值标定为范围[0, 1]内的原图像；(b)平滑过的图
像经阈值处理后得到的梯度图像；(c)使用Marr-Hildreth 算法得到的图像；(d)使
用坎尼算法得到的图像。注意，与其他两幅图像相比，坎尼图像有明显的改进
例10.9 本节中讨论的三种主要边缘检测方法的另一说明。
作为本节中讨论的三种主要边缘检测方法的另一比较，考虑图10.26(a),它显示了一幅大小为512x512
的头部CT 图像。在这个例子中，我们的目的是提取大脑外轮廓(图像中的灰色区域)、脊髓区域轮廓(直
对着鼻子的后边、朝着大脑前)和头部外轮廓的边缘。在消除眼部和大脑区域中与灰色有关的边缘细节时，
我们希望生成尽可能最细且连续的轮廓，。
图10.26(b)显示了一幅阈值处理后的梯度图像，它已先用一个5×5均值滤波器平滑过。达到所示结
第10章 图 像分 割 467
果要求的阈值是该梯度图像的最大值的15??图10.26(c)显示了使用Mar-Hildreth 边缘检测算法得到的
结果，所用的阈值为0.002, σ=3,模板大小为19×19像素。图10.26(d)是使用坎尼算法得到的，所用
的TZ=0.05,T=0.15(低阈值的3倍),σ=2,模板大小为13×13,像Marr-Hildreth 情况那样，它对
应于大于6o的最小奇整数。
在边缘质量及消除无关细节的能力方面，图10.26中的结果相当接近前一例子中的结果和结论。还要
注意，坎尼算法是唯一能为大脑后边界产生完整无断裂的边缘的过程，它也是在消除原始图像中与灰度物
质有关的所有边缘时，有可能发现最好轮廓的过程。
a bc d
图10.26 (a)大小为512×512像素、灰度值已标定到范围[0,1]内的原始头部CT图像；(b)平
滑后的图像经阈值处理后的梯度图像；(c)用Marr-Hildreth 算法得到的图像；
(d)用坎尼算法得到的图像(原图像由Vanderbilt大学的David R.Pickens博士提供)
正像预期的那样，坎尼算法改进性能所付出的代价是比早些时候讨论的两种方法实现起来更复
杂，同时执行时间会更长。在某些应用中，如实时工业图像处理，成本和速度需求通常要求我们使用
更简单的技术，主要是阈值梯度方法。当关注的主要是边缘质量时，通常会使用Marr-Hildreth 算法
和坎尼算法，特别是坎尼算法。
10.2.7 边缘连接和边界检测
理想情况下，边缘检测应该仅产生位于边缘上的像素集合。实际上，由于噪声、不均匀照明引
起的边缘间断，以及其他引入灰度值虚假的不连续的影响，这些像素并不能完全描述边缘特性。因此.
一般是在边缘检测后紧跟着连接算法，所设计的算法将边缘像素组合成有意义的边缘或区域边界。在
这一节中，我们讨论三种基本的边缘连接方法，它们是实际中使用的有代表性的技术。第一种方法需
要有关局部区域中边缘点(如一个3×3邻域)的知识；第二种方法要求区域边界上的点已知；第三种
技术是处理整个边缘图像的全局方法。
局部处理
连接边缘点最简单的方法之一是在每个点(x,y)处的一个小邻域内分析像素的特点，该点是用前
节讨论过的技术之一声明了的边缘点。根据预定的准则，将所有的相似点连接起来，以形成根据指定
准则满足相同特性像素的一条边缘。
在这种类型的分析中，用于确定边缘像素相似性的两个主要性质是：(1)梯度向量的强度(幅度);
(2)梯度向量的方向。第一个性质基于式(10.2-10)。令S。表示一幅图像中以点(x,y为中心的一个邻
域的坐标集合。如果
|M(s,r)-M(x,y|≤E (10.2-36)
其中E是一个正阈值。
梯度向量的方向角由式(10.2-11)给出。如果 展乱
园
468 数字图像处理(第三版)
|a(s,)-α(x,y|≤A (10.2-37)
其中A是一个正角度阈值，则S。中，坐标(s,1)处的一个边缘像素有一个与(x,y)处像素类似的角度。如
10.2.5节中注释的那样，(x,y)处的边缘的方向垂直于该点处梯度向量的方向。
如果既满足幅度准则，也满足方向准则，则S,中，坐标为(s,)的像素被连接到坐标为(x,y)的像
素。在图像中的每个位置重复这一处理。当邻域的中心从一个像素移到另一个像素时，必须将已连接
的点记录下来。一个简单的记录过程是对每组被连接的像素分配不同的灰度值。
前面的公式计算代价很高，因为必须检验每个点的所有邻点。一种特别适合于实时应用的一种
简化由如下步骤组成：
1.计算输入图像f(x,y)的梯度幅度阵列M(x,y)和梯度角度阵列α(x,y)。
2.形成一幅二值图像g,任何坐标对(x,y)处的值由下式给出：
)-LMu)>7“具地他》=A±T
其中，TM是一个阈值，A是一个指定的角度方向，±TA定义了一个关于A的可接受方向“带宽”。
3.扫描g的行，并在不超过指定长度K的每一行中填充(置1)所有缝隙(0的集合)。注意，按
照定义，缝隙一定要限制在一个1或多个1的两端。分别地处理各行，它们之间没有记忆。
4.为在任何其他方向θ上检测缝隙，以该角度旋转g,并应用步骤3中的水平扫描过程。然后，
将结果以-0旋转回来。
当兴趣在于水平边缘连接和垂直边缘连接时，步骤4就变为一个简单的过程，在该过程中，g被
旋转 90°,扫描各行后，结果再被旋转回来。这是实践中最常用的方法，如下例所示，这种方法可以
产生很好的结果。通常，图像旋转是代价很高的计算处理，因此，在要求多角度方向上的连接时，把
步骤3和步骤4组合成单个放射状扫描过程更为实用。
例10.10 使用局部处理的边缘连接。
图10.27(a)显示了一辆汽车尾部的图像。该例的目的是说明用前述算法来寻找大小适合车牌的矩形的应
用。该矩形可以通过检测强的水平和垂直边缘构成。图10.27(b)显示了梯度幅度图像M(x,y),图10.27(c)和
(d)显示了该算法步骤3和步骤4的结果，其中，令T,等于最大梯度值的30?=90°,T=45°,并
填充了全部25个或更少像素的缝隙(约为图像宽度的5???为检测车牌壳的全部拐角和汽车的后窗，要
求使用一个较大范围的容许角度方向。图10.27(e)是前两幅图像逻辑“或”(OR)操作的结果，图10.27f
是使用9.5.5节讨论的细化过程细化图10.27(e)得到的。如图10.16)所示，在图像中清楚地检测到了对
应于车牌的矩形。由于美国汽车牌照的宽高比有与众不同的2:1的比例，所以利用这一事实从图像的所
有矩形中简单地分离出牌照是一件简单的事情。
区域处理
通常，图像中感兴趣区域的位置已知或可以确定。这意味着在相应的边缘图像中关于像素的区
域成员的知识是可用的。在这种情况下，我们可以使用在区域的基础上连接像素的技术，所期望的
结果是该区域边界的近似。对这类处理的一种方法是函数近似，这里，我们对已知点拟合一条二维
曲线。典型地，我们的兴趣在于快速执行的技术，它可对边界的基本特性产生一个近似，例如端点
和凹点。多边形近似尤其有吸引力，因为在保持边界表示(如多边形的顶点)相对简单的情况下，它
们可以捕捉基本形状特性。在这一节，我们将阐述和说明一种适合这一目的算法。
第10章 图 像分 割 469
dei
图10.27(a)一幅大小为534×566的汽车后部图像；(b)梯度幅度图像；(c)水平连
接的边缘像素；(d)垂直连接的边缘像素；(e)前两幅图像的逻辑“或”(OR);
(f用形态学细化得到的最终结果(原图像由Perceptics Corporation提供)
在说明该算法之前，我们用一个简单的例子来讨论该过程的机理。图10.28 显示了表示一条非
闭合曲线点的集合，其中端点标记为A和B。按照定义，这两个点是多边形的顶点。开始，我们计
算通过A点和B点的一条直线的参数。然后，计算曲线上所有其他点到这条直线的垂直距离，并
选择产生最大距离的点(目的是解决任意性)。如果该距离超过了指定的阈值T,则将标为C的相应
点宣布为一个顶点，如图10.28(c)所示。然后，建立从A到C和从C到B的直线，从而得到从A
至C间的所有点到线AC的距离。如果距离超过了T.相应于最大距离的点被宣布为一个顶点D;
否则，对于该线段就没有新的顶点要宣布。类似的过程用于C和B之间的点。图10.28(b)显示了结
果，图10.28(c)显示了下一步的结果。继续这一迭代过程，直到没有点满足阈值测试为止。图10.28(d)
显示了最终的结果，正如您看到的那样，该结果是拟合给定点的曲线形状的一种合理近似。
a b C
p
乙 C
D。
0
o
0
A
B
C C
o
D
o
PE A
F
B
图10.28 多边形拟合算法迭代说明
cd
AO
Dp
0
Ad
6
B
h
oE
E
F
园
7;7
470 数字图像处理(第三版)
刚才解释的过程中隐含了两个重要的需求。首先，必须指定两个起始点；其次，所有的点都必
须排序(即按顺时针方向或逆时针方向)。当任意一个二维点集未形成一个连通路径时(如典型的边缘
图像中的情况),它并不总是很明显，无论是点属于边界线段(开放曲线),还是属于一条边界(闭合曲
线)。给定已排序的点后，我们可以用分析点间的距离推断我们处理的是开放的还是闭合的曲线。当
我们穿过这些点的序列时，相对于其他点的距离的两个连续点间较大的距离是开放曲线的一个好的指
示。然后使用端点开始该过程。如果点间的分离趋于均匀，那么我们很可能处理的是一条闭合曲线。
在这种情况下，对于选取两个起始点我们有几种选择。一种方法是选择点集中的最右边的点和最左边
的点。另一种方法是寻找曲线的极端点(11.2.1节中讨论了一种这样的方法)。寻找一个多边形拟合开
放和闭合曲线的算法描述如下：
关于创建已排序点序列的算法， 1.令P是一个已排序序列，显然，这些点是一幅二值图像中的1
见11.1.1节。 值点。指定两个起始点A和B。它们是多边形的两个起始顶点。
2.指定一个阈值T,以及两个空堆栈“开”(OPEN)和“闭”(CLOSED)。
3.如果P中的点对应于一条闭合曲线，则把A放到“开”中，并把B放到“开”和“闭”中。
如果点对应于一条开放曲线，则把A放到“开”中，而把B
为堆栈名称使用的OPEN 和 放到“闭”。 CLOSED与非闭合曲线和闭合曲线
4.计算从“闭”中最后一个顶点到“开”中最后一个顶点的线 无关。堆栈名称仅指出一个存储最
终(CLOSED)顶点或过渡期间(OPEN) 的参数。 的顶点的堆栈。 5.计算步骤4所得的直线至P中所有点的距离，序列把它们放
到步骤4所得的两个顶点之间。选择具有最大距离Dm的点Vm(解决任意性问题)。
6.如果Dmx>T,则把Vm作为一个新顶点放在“开”堆栈的末尾。转到步骤4。
7.否则，从“开”中移除最后一个顶点，并把它作为“闭”的最后一个顶点插入。
8.如果“开”非空，转到步骤4。
9.否则，退出。“闭”中的顶点就是拟合P中的点的多边形的顶点。
下面的两个例子说明了该算法的机理。
例10.11 用多边形近似连接边缘。
考虑图10.29(a)中的点集P。假设这些点属于一条闭合曲线，且它们已按顺时针方向排序(注意有些
点并不相邻),A和B分别被选为P中的最左侧点和最右侧点。这些是起始顶点，如表10.1所示。选取序
列中的第一个点作为最左侧的点A。图10.29(b)仅显示了A和B间线段上方的点(标为C),该点满足算
法的步骤6,因此将它指定为一个新顶点，并将它添加到“开”堆栈内的顶点中。表10.1的第二行显示
了被检测的C,第三行表明它作为最后一个顶点被添加到“开”中。图10.29(b)中的阈值T约等于在网
格图中的一格半。
注意，在图10.29(b)中，直线AB下方有一个点，该点也满足步骤6。然而，因为这些点已被排序，
故一次只能检测这两个顶点间的点的一个子集。该线段下方的其他点将在后面检测，如图10.29(e)所示。
关键是总要按给出的顺序来追踪这些点。
表10.1说明了导致图10.29(h)中的解的各个步骤。图中检测到了4个顶点，并且该图用直线段连接
这4个顶点形成了一个近似给定边界点的多边形。注意，尽管是按顺时针方向追踪这些点而生成的顶点，
但表中检测到顶点B,C.A,D,B是按逆时针方向的。若输入是一条开放曲线，那么顶点将是顺时针顺序的。
导致这种差异的原因是初始化“开”和“闭”堆栈的方法。对开放和闭合曲线形成的堆栈“闭”的差别
也会导致闭合曲线中第一个顶点与最后一个顶点的重复。这与只给出顶点如何来区分开放和闭合多边形
是一致的。
第10章 图 像分 割 471
T
C Ca C。
o o o o
o 6-
A B A。 B A。 B Ac
o o o
o
C。 C。 C。 C
O
o
A。 B A。 B Ao o
0 6
BA B
o o
a bcd efgh 6
D D D D
图10.29(a)一条顺时针路径中的点集(标为A和B的点被选为起始顶点);(b)点
C到过A和B的直线的距离是A和B间所有点中最大的，并且通过了阈
值测试，因此C是一个新顶点；(d)-(g)算法的各个进程；(h)用直线
连接形成一个多边形所显示的最后的顶点。表10.1说明了一步步的细节
表10.1 例10.11机理的详细步骤
闭 合 非 闭 合 已处理的曲线段
B.A
B,A
B,A.C
B.A
B
B.D
B
空
-
(BA)
(BC)
(CA)
(AB)
(AD)
(DB)
生成的顶点
B A.B
B C
B
B.C
B.C.A D
B.C,A
B,C.A,D
B.C,A,D,B
例10.12 一幅图像的边界的多边形拟合。
图10.30显示了多边形拟合的一个更为实际的例子。图10.30(a)中的输入图像是一幅大小为550×566
人的牙齿X射线图像，其灰度已标定到区间[0,1]。该例的目的是提取牙齿的边界，该方法对于法院运用
对照数据库匹配这一领域非常有用。图10.30(b)是使用Soble模板和阈值T=0.1(最大灰度的10???到
的梯度图像。如预期的那样，X射线图像中的噪声成分很高，因此，第一步是降噪。因为该图像是二值
图像，故形态学技术可很好地适用于这一目的。图10.30(c)显示了滤除大多数噪声后的结果，如果在3×3
邻域内有5个或更多个像素为1,则置像素为1,否则置像素为0。虽然噪声已减少了，但某些噪声点仍清
晰可见。图10.30(d)显示了形态学收缩后的结果，它进一步将噪声降低为孤立的点。这些噪声是用例9.4
中描述的方式使用形态学滤波消除的[见图10.30(e)]。在这一点上，图像由粗边界组成，这些边界可通
过流行的形态学骨架的方法来加以细化，如图10.30f)所示。最后，图10.30(g)显示了预处理中最后一步
去除毛刺后的结果，如9.5.8节讨论的那样。
接着，我们用一个多边形来拟合图10.30(g)中的点。图10.30(h)~(j)显示了用多边形拟合算法的结果，
其中阈值分别等于图像宽度的0.5??2即T=3,6和12)。前两个结果较好地近似了边界，但第三
个处在临界状态。所有这三种情况中，过度的锯齿清楚地表明需要进行边界平滑。图10.30(k)和(1)显示
了一个一维均值模板分别与图(j)和图(h)中的边界卷积后的结果。所用的模板是元素为1的1×31阵列，约 恩:
圆
472 数字图像处理(第三版)
为对应图像宽度的5??正如所期望的那样，图10.30(k)中的结果在保护重要形状特征方面仍是临界的(即
右侧严重失真)。另一方面，图10.30(①)中的结果显示了有效地边界平滑和形状特征的合理保留。例如，
图像以合理的保真度保留了左上方尖点的圆度和右上方尖点的细节。
图10.30(a)一幅大小为550×566 像素的人的牙齿图像；(b)梯度图像；(c)滤除大多数
噪声的结果；(d)形态学收缩的结果；(e)形态学清除的结果；(f)骨架；(g)去
除毛刺；(h)-(j)使用阈值约为图像宽度的0.5??2即T=3,6和12)
的多边形拟合；(k)使用一个大小为1×31(约为图像宽度的5???一维均值滤
波器平滑图j)中边界后的结果；(1)使用相同滤波器平滑图(h)中边界后的结果
上例中的结果是使用本节讨论的多边形拟合算法所能得到的典型结果。该算法的优点是实现简
单，且产生的结果通常是可以接受的。在11.1.3节中，我们将讨论一种更完善的过程，通过计算最小
周长多边形可产生更接近的拟合。
使用霍夫变换的全局处理
前两节中讨论的方法可用于这样的场合，即属于各个目标的像素的知识至少部分可用。例如，
在区域处理中，只有当我们知道它们是一个有意义区域边界的一部分时，连接给定的像素集才有意义。
通常，我们不得不工作在无结构的环境中，在这种环境中，我们所拥有的一切只是一幅边缘图像，没
有关于感兴趣目标可能在哪里的知识。在这种情况下，所有像素都是连接的候选点，这样，必须基于
预先定义的全局性质接受或删除某些点。在这一节中，我们介绍一种基于像素集是否位于指定形状的
曲线上的方法。一旦检测到，这些曲线就会形成边缘或感兴趣的区域边界。
若给定一幅图像中的n个点，假设我们希望找到这些点中一个位于直线上的子集。一种可行的
解决方法是先找到所有由每对点确定的直线，然后寻找靠近特定直线的点的所有子集。这种方法涉及
寻找 n(n-1)/2~n2条直线，然后，对于每个点，要与所有直线执行(n)(n(n-D)/2~n3次比较。这种方
法因为计算量太大而基本上没有应用价值。
霍夫[Hough 1962]提出一种替代方法，通常称为霍夫变换。考虑xy平面上的一个点(x,y,)和斜
截式形式为y,=ax,+b的一条直线。通过点(x,,y,)的直线有无数条，且对a和b的不同值，它们都
第10章 图 像分 割 473
满足方程y,=ax,+b。然而，将该等式写为b=-xa+y,并考虑ab平面(也称为参数空间),将得到
固定点(x,y;)的单一直线的方程。此外，第二个点(x,,y,)在参数空间中也有一条与之相关联的直线，
除非它们是平行的，否则这条直线会与和(x,y,)相关联的直线相交于点(a',b),其中a'为斜率，b是
包含xy平面中点(x,y,)和点(x,,y,)的直线的截距。事实上，这条直线上的所有点在参数空间中都有
相交于点(a',b)的直线。图10.31说明了这些概念。
b a b
y b
b=-xa+y;
(x,y)
a'-
(py) b=-x;a+y,
a
图10.31(a)xy平面；(b)参数空间
原理上，可以画出对应于xy平面中所有点(x,y)的参数空间直线，并且空间中的主要直线可以
在参数空间中通过确定的点来找到，大量的参数空间的线在此点处相交。然而，这种方法的一个实际
困难是，当该直线逼近垂直方向时，a(直线的斜率)会趋于无限大。解决该困难的方法之一是使用一
条直线的法线表示：
xcosθ+ysinθ=p (10.2-38)
图10.32(a)示例了参数p和θ的几何解释。水平直线有θ=0°,p等于正的x截距。类似地，垂直直
线有θ=90°,p等于正的y截距；或者有θ=-90°,p等于负的y截距。图10.32(b)中的每条正弦
曲线表示通过xy平面中一个特殊点(x,y)的一族直线。图10.32(b)中的交点(p',0)对应于图10.32(a)
中通过点(x,y?)和点(x,y,)的直线。
y
8° n 0
0
xycos?+ y,sint=p Pmin
P
0
G,y)
(x,y) p Pma xjcosθ+y,sint=p
a b c X P P
图10.32 (a)xy平面中直线的(p,θ)参数化；(b)pθ平面中的正弦曲线，交点(p',8)对应
于通过xy平面中点(x,y,)和点(x,y,)的直线；(c) pθ平面划分为累加单元
霍夫变换计算上的魅力在于可将pθ参数空间划分为所谓的累加单元，如图10.32(c)所说明的那
样，其中(PminPmx)和(0,0m)是所期望的参数值范围：-90°≤θ≤90°和-D≤p≤D,其中D是
图像中对角之间的最大距离。位于坐标(i.j处的单元具有累加值AG).它对应于与参数空间坐标(p?,θ,)
相关联的正方形。最初，将这些单元置为零。然后，对于xy平面中的每个非背景点(x?,y),令θ等于θ 受:
密
474 数字图像处理(第三版)
轴上每个允许的细分值，同时使用方程p=x cosθ+y, sinθ解出对应的p。对得到的p值进行四舍五
入，得到沿p轴的最接近的允许单元值。如果选择的一个θ,值得到解p?,则令A(p.q)=A(p.4)+1。在
这一过程结束后，AGi.)中的值P将意味着xy平面中有P个点位于直线xcosθ,+ysinθ,=p上。pθ
平面中的细分数量决定了这些点的共线性的精确度。可以证明(见习题10.24),刚刚讨论的这种方法
的计算次数与xy平面中非背景点的数量n成线性关系。
例10.13 基本霍夫变换性质的说明。
图10.33显示了基于式(10.2-38)的霍夫变换。图10.33(a)显示了一幅大小为101×101 像素具有五个
标记点的图像，图10.33(b)显示了使用p轴和θ轴的单位细分将每个点映射到pθ平面上的结果。θ的取
值范围为±90°,p轴的范围为±√2D.其中D是图像中对角点间的距离。如图10.33(c)所示，每条曲线
都有不同的正弦曲线形状。点1的映射得到的水平直线是具有零幅值的正弦曲线的一种特殊情形。
图10.33(b)中标为A(不要与累加值混淆)和B的点显示了霍夫变换的共线性检测性质。点A表示对
应于xy图像平面内点1,3和5的曲线的交点。点A的位置指出这三个点位于一条过原点(p=0)且方向为
45°的直线上[见图10.32(a)]。类似地，在参数空间中相交于点B的曲线指出点2,3和4位于方向为-45°
且与原点的距离为p=71(即从图像原点到对角的对角线距离的一半，已四舍五人为最接近的整数值)的直
线上。最后，图10.33(b)中标为Q.R和S的点说明了这样一个事实，即霍夫变换展示了在参数空间左边
缘和右边缘处的一种反射邻接关系。这一性质是θ和p在±90°边界改变符号的结果。
—100—
—50—
a b
0-
50-
100- O
-80 -60 -40 -20 0 20 40 60 80
图10.33(a)包含5个点的、大小为101×101像素的图像；(b)对
应的参数空间[为便于观看，图(a)中的点已被放大]
尽管到目前为止我们关注的重点始终在直线上，但霍夫变换也适用于形如g(v.c)=0的任何函
数，其中v是坐标向量，c是系数向量。例如，位于圆
(x-c)2+(y-c?)2=c (10.2-39)
上的点可以使用刚才讨论的方法来检测。不同之处是存在3个参数(cq?,c?和c?),在一个三维参数
空间中，这三个参数导致了类似立体的单元和形如 AGi,j.k)的累加器。该过程是增加c?和c?,求出
满足式(10.2-39)的c?,并更新与三元组(G,c?,c?)相关联的累加单元。很清楚，霍夫变换的复杂性取
第10章 图 像分 割 475
决于给定函数表达式中的坐标和系数数量。霍夫变换有可能进一步推广到检测无简单解析表达式的曲
线，如变换为灰度级图像那样的应用。本章末尾包含了处理这些扩展功能的一些参考文献。
我们现在回到边缘连接问题上来。基于霍夫变换的一种连接方法如下：
1.使用本节中先前讨论的任何技术得到一幅二值图像。
2.指定pθ平面中的细分。
3.对像素高度集中的地方检验其累加单元的数量。
4.检验选中单元中像素间的关系(主要针对连续性)。
在这种情况下，连续性通常以对应于给定的累加单元计算不连续像素间的距离为基础。如果缝
隙的长度比指定的阈值小，与给定单元相关联的一条直线中的缝隙则被桥接起来。注意，可能仅以方
向为基础聚合直线这样的事实是一个可用于整个图像的全局概念.它仅要求我们考察与指定的累加单
元相关联的像素。与前两节中讨论的方法相比，这是一个明显的优点。下例说明了这些概念。
例10.14 使用霍夫变换连接边缘。
图10.34(a)显示了一幅航拍的机场图像。该例的目的是使用霍夫变换提取主要跑道的两条边。解决
这样的问题可能很重要，例如，涉及飞行器自动导航的应用。
a b c de
图10.34(a)一幅大小为502x564的机场航拍图像；(b)使用坎尼算法得到的边
缘图像；(c)霍夫参数空间(方框强调了与长垂直线相关联的点):(d)图
像平面中对应于方框所强调的点的直线；(e)已叠加到原图像上的直线
第一步是得到一幅边缘图像。图10.34(b)显示了使用坎尼算法得到的边缘图像，算法中使用的参数和
过程与例10.9中使用的相同。为计算霍夫变换，使用10.2.5节或10.2.6 节中讨论的任何边缘检测技术可
得到类似的结果。图10.34(c)显示了θ以1°递增和p以1个像素递增得到的霍夫参数空间。
感兴趣的跑道偏离正北方向约1°,所以，我们选取对应于±90°并包含最高数量的单元，因为跑道在
这些方向面向最长的线。图10.34(c)的边缘上的小白框强调了这些单元。结合图 10.33(b),如先前提及
的那样，霍夫变换展示了边缘处的邻接性。解释这一性质的另一种方法是，面向+90°的一条线和面向-90°
的一条线是等价的(即它们是两条垂直线)。图10.34(d)显示了对应于刚才讨论的两个累加单元的直线，
图10.34(e)显示了已叠加到原图像上的这些直线。这些直线是通过连接不超过图像高度的20约100个像
素)的所有间隙得到的。这些直线清楚地对应于感兴趣跑道的边缘。 貌：宫
759
476 数字图像处理(第三版)
注意，解决这一问题的唯一关键知识是跑道的方向和观察者相对于跑道的位置。换句话说，自动导
航飞行器应该知道，如果跑道朝北，且飞行器的飞行方向也是北，跑道会垂直地出现在图像中。其他相
关的方向可采用类似的方式处理。全世界的跑道的方向在飞行图上都是可用的，且使用GPS(全球定位系
统)可很容易得到飞行方向的信息。该信息还可用于计算飞行器和跑道之间的距离，这样，允许我们估计
这些参数，例如相对于图像尺寸的直线的预期长度，就像我们在该例中所做的那样。
10.3 阈值处理
由于阈值处理直观、实现简单且计算速度块，因此图像阈值处理在图像分割应用中处于核心地
位。在3.1.1节已介绍了阈值处理，自那时起在各种讨论中我们就使用过阈值处理。在本节，我们将
以更为正式的方式讨论阈值处理，并用比迄今为止已有的更为一般化的方式阐述该技术。
10.3.1 基础知识
在前面的章节中，我们采用首先寻找边缘线段，然后试图将这些线段连接为边界的方法来识别
区域。在这一节中，我们将讨论基于灰度值和/或灰度值的特性来将图像直接划分为区域的技术。
灰度阈值处理基础
假设图10.35(a)中的灰度直方图对应于图像f(x,y),该图像由暗色背景上的较亮物体组成，以这
样的组成方式，物体像素和背景像素所具有的灰度值组合成了两种支配模式。从背景中提取物体的一
种明显方法是选择一个将这些模式分开的阈值T。然后，f(x,y)>T的任何点(x,y)称为一个对象点；否
则将该点称为背景点。换句话说，分割后的图像g(x,y)由下式给出：
8(x,)={6r,ST (10.3-1)
当T是一个适用于整个图像的常数时，该公式给出的处理称为全局阈
值处理。当T值在一幅图像上改变时，我们使用可变阈值处理这个术
语。术语局部阈值处理或区域阈值处理有时用于表示可变阈值处理，
此时，图像中任何点(x,y)处的T值取决于(x,y)的邻域的特性(例如邻
域中的像素的平均灰度)。如果T取决于空间坐标(x,y)本身，则可变阈值处理通常称为动态阈值处理
或自适应阈值处理。这些术语的应用并不普遍，在关于图像处理的文献中，读者可能会看到它们交替
地使用。
图10.35(b)显示了一个更为困难的阈值处理问题，它包含有三个支配模式的直方图，例如，这三
个支配模式对应于暗色背景上的两个明亮物体。这里，如果f(x,y)≤T,则多阀值处理把点(x,y)分类
为属于背景；如果T?<f(x,y)≤T?,则分为一个物体；如果f(x,y)>T?,则为分另一个物体。即分割
的图像由下式给出：
c
尽管我们遵从使用灰度0来表示
背景像素而使用灰度1来表示物体
像素的约定，但在式(103-D中也可
使用任何两个明显不同的值。
(10.3-2)
其中，a,b和c是任意三个不同的灰度值。在10.3.6节中，我们将讨论双阈值处理。要求两个以上阈
值的分割问题很难解决(通常是不可能的),而较好的结果通常可用其他方法得到，如10.3.7节中讨论
的可变阈值处理方法或10.4节中讨论的区域生长方法。
第10章 图 像分 割 477
a b
T T? T?
图10.35 可被(a)单阈值和(b)双阈值分隔的灰度直方图
基于前面的讨论，我们可以凭直觉推断灰度阈值的成功与否直接关系到可区分的直方图模式的
谷的宽度和深度。而影响波谷特性的关键因素是：(1)波峰间的间隔(波峰离得越远，分离这些模式的
机会越好);(2)图像中的噪声内容(模式随噪声的增加而展宽);(3)物体和背景的相对尺寸；(4)光源
的均匀性；(5)图像反射特性的均匀性。
图像阈值处理中噪声的作用
作为噪声如何影响一幅图像的直方图的说明，考虑图10.36(a)。这幅简单的合成图像中没有噪声，
因此，其直方图由两个波峰模式组成，如图10.36(d)所示。将该图像分割为两个区域是很容易的任务，
只需将一个阈值放到两个模式之间的任何位置。图10.36(b)显示了被均值为零、标准差为10个灰度
级的高斯噪声污染了的原始图像。尽管相应的直方图模式现在较宽[见图10.36(e)].但它们的间隔
足够大，故它们之间波谷的深度足以使得两个模式更易于分开。放在两个波峰之间的中间位置的一个
阈值就可以很好地分割该图像。图10.36(c)显示了受到均值为零、标准差为50个灰度级的高斯噪声
污染该图像的结果。如图10.36(f)中所示的直方图那样，现在情况是如此严重，以至于无法区分两个
模式。若没有附加的处理(如10.3.4节和10.3.5节中讨论的方法),我们对于分割这样的图像寻找合适
的阈值就没有什么希望。
aei
图10.36 (a)无噪声的8比特图像；(b)带有均值为零、标准差为10个灰度级的加性高斯噪声的图像；
(c)带有均值为零、标准差为50个灰度级的加性高斯噪声的图像；(d)-(f相应的直方图
光照和反射的作用
图10.37说明了光照对一幅图像的直方图的影响。图10.37(a)是来自图10.36(b)的噪声图像，
图10.37(d)显示了它的直方图。像先前那样，使用一个单阈值很容易分割该图像。我们可以通过一个 66
高室
478 数字图像处理(第三版)
可变的灰度函数乘以图10.37(a)中的图像来说明非均匀光照的影响，例如，图10.37(b)的斜坡灰度，其
直方图显示在图10.37(e)中。图10.37(c)显示了这幅图像与该阴影模式的乘积。如图10.37(f所示，波
峰之间的较深的波谷在模式的分离点处被污染了，如果没有附加的处理(见10.3.4节和10.3.5节),分
离是不可能的。如果光照非常均匀，但图像的反射不均匀也会得到类似的结果。例如，物体的表面或
背景自然反射变化的情况就是如此。
aei D
图10.37(a)带有噪声的图像；(b)在[0.2,0.6]范围内的灰度斜坡
图像；(e)图(a)和图(b)的乘积；(d)~(f)相应的直方图
前面章节中的关键是在使用阈值或其他分割技术的图像成功分割
中，照明和反射起到了核心作用。因此，在可能的情况下，在解决分
割的问题中控制这些参数应是首先考虑的问题。当不可能控制这些参
数时，有三种针对该问题的基本解决方法。第一种方法是直接校正这
种阴影模式。例如，非均匀(但固定的)光照可以用相反的模式与图像
相乘来校正，相反的模式可以用一个恒定灰度的平坦表面成像来得
到。第二种方法可通过用诸如9.6.3节中介绍的顶帽变换处理来尝试校正全局阴影模式。第三种方法
是使用可变阈值近似处理非均匀性，如10.3.7节讨论的那样。
10.3.2 基本的全局阈值处理
正像前节说明的那样，当物体和背景像素的灰度分布十分明显时，可以用适用于整个图像的单
个(全局)阈值。在大多数应用中，通常图像之间有较大变化，即使全局阈值是一种合适的方法，对每
一幅图像有能力自动估计阈值的算法也是需要的。下面的迭代算法可用于这一目的：
1.为全局阈值T选择一个初始估计值。
2.在式(10.3-1)中用T分割该图像。这将产生两组像素：G?由灰度值大于T的所有像素组成，
G?由所有小于等于T的像素组成。
3.对G?和G?的像素分别计算平均灰度值(均值)m?和m?
4.计算一个新的阈值：
r= (m+m)
5.重复步骤2到步骤4,直到连续迭代中的T值间的差小于一个预定义的参数△T为止。
理论上，斜坡图像的直方图是均匀
的。实际上，实现完美的均匀性取决
一幅大小为256×256的256级斜坡图
于图像的尺寸和灰度比特数。例如，
像有一个均匀的直方图，但大小为
256×257的具有相同灰度级数的斜坡
图像则没有均匀的直方图。
第10章 图 像 分 割 479
当与物体和背景相关的直方图模式间存在一个相当清晰的波谷时，这个简单的算法工作得很好。
在速度是一个重要因素的情形下，参数△T用于控制迭代的次数。通常，△T越大，则算法执行的迭
代次数越少。所选的初始阈值必须大于图像中的最小灰度级而小于最大灰度级(见习题10.28)。图像
的平均灰度对于T来说是较好的初始选择。
例10.15 全局阚值处理
图10.38显示了用前述算法以阈值估计为基础分割的例子。图10.38(a)是原图像，图10.38(b)是该图
像的直方图，该直方图显示有一个明显的波谷。用T=m(平均图像灰度)开始，并令△T=0,应用前述迭
代算法经过3次迭代后，得到阈值T=125.4。图10.38(c)显示了使用阈值T=125来分割原图像得到的结
果。如期望的那样，从直方图清晰的模式分离中，物体和背景间的分割相当有效。
a b c 0 137 191
图10.38 (a)带噪声的指纹；(b)直方图；(c)使用全局阀值对图像分割的结果(为清
晰起见，边界是加上去的)(原图像由美国国家标准和技术研究所提供)
通过对输入图像成功地进行阈值处理并在每一步计算均值说明了前述算法，因为以这种方式来
介绍该算法更为直观。然而，有可能根据图像的直方图表达的全部计算开发一种更有效的过程，它仅
仅计算一次(见习题10.26)。
10.3.3 用Otsu方法的最佳全局阈值处理
阈值处理可视为一种统计决策理论问题，其目的是在把像素分配给两个或多个组(也称为分类)
的过程中引入的平均误差最小。这一问题已知有一个精致的闭合形式的解，称为贝叶斯决策规则(见
12.2.2节)。该解仅以两个参数为基础：即每一类的灰度级的概率密度函数(PDF)和在给定应用中每
一类出现的概率。遗憾的是估计 PDF并不容易，通常采取假定一个PDF形式的可行方法来简化该问
题，例如，假设它们是高斯函数。即便采用了简化，用这些假设求解的过程也可能是复杂的，并且对
实际应用也不总是合适的。
本节中讨论的称为Otsu方法(Otsu[19791)是另一种有吸引力的方案。该方法在类间方差最大的情
况下是最佳的，即众所周知的统计鉴别分析中所用的度量。基本概念是好阈值分类就它的像素灰度值
而论应该是截然不同的，反过来说，就它的灰度值而言给出最好的类间分离的阈值就是最好的(最佳
的)阈值。除了其最佳性之外，Otsu方法有一个重要的特性，即它完全以在一幅图像的直方图上执行
计算为基础，直方图是很容易得到的一维阵列。
令[0,1,2,…,L-1}表示一幅大小为MxN像素的数字图像中的L个不同的灰度级，n,表示灰度级为
i的像素数。图像中的像素总数MN为MN=no+n?+n?+…+nL。归一化的直方图(见3.3节)具有分 ②
m-图
480 数字图像处理(第三版)
量p?=n,/MN,由此有
2n=1 p?≥0 (10.3-3)
现在，假设我们选择一个阈值T(k)=k,0<k<L-1,并使用它把输入图像阈值化处理为两类C?和C?,
其中，C?由图像中灰度值在范围[0,k]内的所有像素组成、C?由灰度值在范围[k+1,L-1]内的所有像
素组成。用该阈值，像素被分到类C?中的概率P?(k)由如下的累积和给出：
Rw)=二D (10.3-4)
换一个角度看，这是类C?发生的概率。例如，如果我们置k=0,则任何像素分到类C?中的概率为零。
类似地，类C?发生的概率为
Bw)=2n=1-Ru) (10.3-5)
由式(3.3-18),分配到类C?的像素的平均灰度值为
(u)=LiPai/C)
-2iRc/oPo/Pc)
-二
(10.3-6)
其中，P?(k)由式(10.3-4)给出。式(10.3-6)第一行中的PG/C?)项是值i的概率，已知i来自类C?。该
式中的第二行来自贝叶斯公式：
P(A/B)=P(B/A)P(A)/P(B)
第三行遵循这样一个事实，即给定i的C?的概率P(C?/i)为1,因为我们只处理来自类C?的i值。此
外，P()是第i个值的概率，很简单，它是直方图p(i)的第i个分量。最后，P(C?)是类C?的概率，
由式(10.3-4)我们知道它等于P(k)。
类似地，分配到类C?中的像素的平均灰度值为
m)=SiPaic)
2m (10.3-7)
直至级k的累加均值由下式给出：
)=2m (10.3-8)
而整个图像的平均灰度(即全局均值)由下式给出：
m=2m (10.3-9)
第10章 图 像分 割 481
下面两个公式的正确性可通过直接代入前面的结果来验证：
Pm+P?m?=mc (10.3-10)
和
P+P?=1 (10.3-11)
其中，为有利于清楚地说明，我们暂时忽略了k项。
为了评价级别k处的阈值的“质量”,我们使用归一化的无量纲矩阵：
n= (10.3-12)
其中，}是全局方差[即图像中所有像素的灰度方差，如式(3.3-19)给出的那样],
=20-mG2p (10.3-13)
}为类间方差，它定义为
σ2=P(m-m?)2+P?(m?-m?)2 (10.3-14)
该表达式还可写为
o2=PP?(m,-m?)2
=RC-R) (10.3-15)
其中，m?和m如先前说明的那样。该式的第一行来自式(10.3-14)、
式(10.3-10)和式(10.3-11)。第二行来自式(10.3-5)到式(10.3-9)。这种
形式在计算上稍微有效一些，因为全局均值ma仅计算一次，故对 k
的任何值仅需要计算两个参数m和P。
从式(10.3-15)的第一行我们可以看出，两个均值m,和m,彼此隔得越远，σ}越大，这表明类间
方差是类之间的可分性度量。因为?是一个常数，由此得出η也是一个可分性度量，且最大化这一
度量等价于最大化σ2。然后，目标是确定阈值k,它最大化类间方差，就像本节开始时说明的那样。
注意，式(10.3-12)隐含假设了o2>0。仅当图像中的所有灰度级相同时，这一方差才为零，这意味
着仅存在一类像素。同样，这也意味着对于常数图像有η=0,因为来自其自身单个类的可分性为零。
再次引入k,我们有最终结果：
)-
式103-15)的第二步仅在P大于0且
这表明P必须满足相同的条件。
小于1时才有意义，鉴于式103-11).
(10.3-16)
和
0?)=mP))-Rk (10.3-17)
从而最佳阈值是k",其最大化o}(k):
o咯(k*)=。maxo2(k) (10.3-18)
换句话说，为寻找k',我们对k的所有整数值[保持上述0<P(k)<1的条件]简单地计算式(10.3-18),
并选取使得o2(k)最大的k值。如果o?(k)的最大值对应于多个k值，习惯上是对于使o2(k)最大的
屋;退
482 数字图像处理(第三版)
k的各个值做平均。可以证明(见习题10.33),在0<P(k)<1的条件下，总存在一个最大值。对于所
有的k值，计算式(10.3-17)和式(10.3-18)的代价相对较小，因为k所具有的整数值的最大数量是L。
一旦得到k",输人图像就可像之前那样进行分割：
8(x.)={6ra》 (10.3-19)
其中，x=0.1,2,…,M-1和y=0.1,2,…,N-1。注意，仅仅用f(x,y)的直方图就可以得到计算
式(10.3-17)所需的所有参量。除了最佳阈值外，与分割图像有关的其他信息可从直方图中提取。例
如，在最佳阈值处计算出的类的概率P(k)和P?(k),指出了经阈值处理后的图像中由该类(像素组)
所占据的面积部分。类似地，均值m?(k)和m?(k)是原图像中类的平均灰度的估计。
在最佳阈值处计算的归一化度量η,即η(k),可用于得到类别
可分性的定量估计，同时给出了很容易对一幅给定图像进行阈值处理
的概念。这一度量的值域为
0≤η(k)≤1
尽管我们的兴趣是最佳阀值k*处的
η值，但该不等式对于范围0.L-11
内的任何k值均成立。
(10.3-20)
如先前提到的那样，仅由单一且恒定灰度级的图像就能得到下界，且仅由灰度等于0和L-1的二值
图像就能得到上界(见习题10.34)。
Otsu 算法小结如下：
1.计算输入图像的归一化直方图。使用p?,i=0.1,2,…,L-1表示该直方图的各个分量。
2.用式(10.3-4),对于k=0,1,2,…,L-1,计算累积和P(k)。
3.用式(10.3-8),对于k=0,1,2,…,L-1,计算累积均值m(k)。
4.用式(10.3-9)计算全局灰度均值m。
5.用式(10.3-17),对于k=0,1,2,…,L-1,计算类间方差o}(k)。
6.得到Otsu阈值k°,即使得o2(k)最大的k值。如果最大值不唯一，用相应检测到的各个最大
值k的平均得到k。
7.在k=k处计算式(10.3-16),得到可分性度量η°。
下面的例子说明了前述概念。
例10.16 使用Otsu方法的最佳全局阈值处理。
图10.39(a)显示了聚合细胞的光学显微镜图像，图10.39(b)显示了其直方图。该例子的目的是从背
景中分割出分子。图10.39(c)是使用前节给出的基本全局阈值处理算法 聚合细胞是使用聚合物人工生成
得到的结果。因为直方图没有明显的波谷，且背景和物体间的灰度差别 的细胞。人眼看不到聚合细胞，这
种细胞可用于向人体内的目标区域 很小，所以算法未完成期望的分割。图10.39(d)显示了使用Otsu方法得
输送药物。 到的结果。该结果明显好于图10.39(c)中的结果。使用基本算法计算出
的阈值是169,而使用Otsu方法计算出的阈值是181,后者更接近图像中定义为细胞的较亮区域。可分
性度量η是0.467。
有趣的是，将OLsu方法应用于例10.15中的指纹图像，得到的阈值和可分性度量将分别为125和0.944。
该阈值与使用基本算法得到的阈值(已四舍五入为最接近的整数)大小相同。对给定该直方图的特性，这
一结果并不意外。事实上，由于原来的模式间的分离度相对较大，并且它们之间的波谷较深，所以可分
性度量较高。
第10章 图 像 分 割 483
a b
cd
单
图10.39(a)原图像；(b)直方图(为突出低值中的细节，高峰已被裁剪);(c)用10.3.2节的基本全局算法得到
的分割结果；(d)用Otsu方法得到的结果(原图像由宾夕法尼亚大学的Daniel A.Hammer教授提供)
10.3.4 用图像平滑改善全局阈值处理
正如在图10.36中解释的那样，噪声可将一个简单的阀值处理问题变为一个不可解决问题。当噪
声不能在源头减少，并且阈值处理又是所选择的分割方法时，那么通常可增强性能的一种技术是在阈
值处理之前平滑图像。我们用一个例子来说明这一方法。
图10.40(a)是来自图10.36(c)的图像，图10.40(b)显示了其直方图，图10.40(c)是使用Otsu方
法对图像进行阈值处理后的结果。白色区域中的每个黑点和黑色区域中的每个白点是阈值处理的误
差，所以分割很不成功。图10.40(d)显示了使用一个大小为5×5(图像大小为651×814像素)的均值模
板平滑噪声图像后的结果，图10.40(e)是其直方图。由于平滑处理，直方图形状的改进很明显，因此
我们预料对平滑后的图像进行阈值处理所得到的结果将近于完美。如图10.40f所示，事实的确如此。
经平滑和分割后的图像中，物体和背景间的边界稍微有点失真是由于对边界的模糊造成的。事实上，
我们应该预料到，我们平滑一幅图像侵蚀得越多，分割后的结果中的边界误差就越大。
a b c d e f
图10.40(a)来自图10.36的噪声图像；(b)该图像的直方图；(c)用Otsu方
法得到的结果；(d)用一个大小为5×5的均值模板平滑噪声图像的
结果；(e)结果图像的直方图；0用Otsu方法阈值处理后的结果 7;7
484 数字图像处理(第三版)
下面我们考虑降低图10.40(a)中相对于背景的区域大小所带来的影响。图10.41(a)显示了该结
果。这幅图像中的噪声是均值为零、标准差为10个灰度级(相对于前一例子中的50)的加性高斯噪
声。如图10.41(b)所示，直方图没有清晰的波谷，因此我们应该预料到分割会失败，图10.41(c)中
的结果确认了这一事实。图10.41(d)显示了使用大小5×5的均值模板对图像进行平滑后的结果，
图10.41(e)是其直方图。如预料的那样，最终结果减小了直方图的扩散，但分布仍是单峰形式。如
图10.41(f)所示，分割再一次失败了。失败的原因可归于这样一个事实，即区域太小，以至于该区
域对直方图的贡献与由噪声引起的灰度扩散相比无足轻重。在这种情形下，下一节讨论的方法可能
更成功。
时
a b c
d e f
图10.41(a)噪声图像；(b)其直方图；(c)用Otsu方法得到的结果；(d)用大小为
5×5的均值模板平滑噪声图像后的结果；(e)结果图像的直方图；(1)用
Otsu方法对图像进行阀值处理后的结果。两种情形下，阈值处理均失败
10.3.5 利用边缘改进全局阈值处理
基于前四节中的讨论，我们得出如下结论：如果直方图的波峰是高、窄、对称的，且被深的波
谷分开，则选取一个“较好”阈值的机会是相当大的。改进直方图形状的一种方法是仅考虑那些位于
或靠近物体和背景间的边缘的像素。一种直接且明显的改进是直方图很少依赖物体和背景的相对大
小。例如，大背景区域上一个小物体(或相反)组成的图像的直方图将会有一个较大的波峰，因为一种
类型的像素高度集中。在前一节中我们已了解到，这可能会导致阈值处理失败。
如果仅用位于或接近物体和背景间的边缘的像素，则得到的直方图将有几个高度近似相同的波
峰。此外，像素位于物体上的概率将近似等于其位于背景中的概率，从而改进了直方图模式的对称性。
最后，如下段中指出的那样，用满足某些基于梯度和拉普拉斯算子的简单度量的像素有加深直方图波
峰间的波谷的倾向。
刚才讨论的方法假设物体和背景间的边缘是已知的。很明显，该信息在分割期间是不可用的，
因为寻找物体和背景间的分界线正好也是分割所要做的工作。然而，根据10.2 节中的讨论，一个
像素是否位于边缘上的迹象可通过计算其梯度或拉普拉斯来确定。例如，在一个边缘的过渡处，拉
普拉斯的平均值为零(见图10.10),因此，根据拉普拉斯准则选取的像素所形成的直方图的波谷应
该很少。这一特性往往会产生上面讨论的较深波谷。实际上，无论是使用梯度图像还是使用拉普拉
之; 斯图像得到的典型结果相比较，后者比较有利，因为它在计算上更有吸引力，同时也是一个各向同性
边缘检测器。
第10章 图 像分 割 485
前述讨论可小结为如下算法，其中f(x,y)是输入图像：
1.用10.2节讨论的任何一种方法来计算一幅边缘图像，无论是 梯度图像的幅度和拉普拉期图像的
f(x,y)梯度的幅度还是拉普拉斯的绝对值都可以。 绝对值。在这种情况下，我们会为
每幅图像指定一个阈值，并求两个 2.指定一个阈值T。 结果的逻辑“或”(OR),以得到标 3.用步骤2中的阈值对步骤1中的图像进行阈值处理，产生一幅
二值图像g(x,y)。在从f(x,y)中选取对应于“强”边缘像素 加更多的控制时，这种方法很有用。
的下一步中，该图像用做一幅模板图像。
4.仅用f(x,y)中对应于gr(x,y)中像素值为1的位置的像素计算直方图。
5.用步骤4中的直方图全局地分割f(x,y),例如使用Otsu方法。
如果将T设置为小于边缘图像的最小值的任何值，根据式(10.3-1),8(x,y)将由全1组成，这
意味着f(x,y)的所有像素将用于计算图像的直方图。在这种情况下， 第n个百分比是大于给定集合内
前述算法变成使用原始图像的直方图的全局阈值处理。习惯上以百分 所有数字的n??最小数字。例如，
如果读者在一次测验中得到了95 比的形式来指定T值，百分比通常设置得较高(如90?以便在计算 分，且该分数大于参加此次测验的 中用梯度/拉普拉斯图像中的较少像素。下面的例子说明了刚才讨论的 所有学生中的85??学生得到的分
数，则读者在测试分数中位于第 85
个百分比处。
概念。第一个例子使用梯度，第二个例子使用拉普拉斯。在两个例子
中，无论使用哪一种方法都可得到类似的结果。重要的问题是生成一
幅合适的导数图像。
例10.17 用以梯度为基础的边缘信息改进全局阈值处理。
图10.42(a)和(b)显示了来自图10.41的图像和直方图。您可以看到，这幅图像不能用平滑后紧跟着
阈值处理来分割。这个例子的目是解决利用边缘信息的问题。图10.42(c)是在99.7??经阈值处理后的梯
度幅度图像。图10.42(d)是用输入图像与这个(模板)图像相乘形成的图像。图10.42(e)是图10.42(d)中
非零元素的直方图。注意，该直方图具有先前讨论的重要特性，即它有被一个较深的波谷分开的对称模
式。这样，尽管原始带噪声图像的直方图未提供成功进行阈值处理的希望，但图10.42(e)中的直方图表
明，从背景中提取出小物体的阈值处理的确是可能的。图10.42f中的结果表明事实的确如此。这幅图像
是这样得到的：以图10.42(e)的直方图为基础，用Otsu方法得到一个阈值，然后将该阈值全局地应用到
图10.42(a)中的带噪声图像。其结果近于完美。
例10.18 用拉普拉斯为基础的边缘信息改进全局阈值处理。
在这个例子中，我们考虑一个更为复杂的阈值处理问题。图10.43(a)显示了一幅酵母细胞的8比特
图像，其中，我们希望用全局阈值处理得到相对于亮点的区域。首先，图10.43(b)显示了该图像的直方
图，图10.43(c)是把Otsu方法直接用于所示的直方图的图像上得到的结果。我们看到，Otsu方法未能实
现检测亮点这一原始目标，并且，尽管该方法能隔离出某些细胞区域本身，但右侧的几个分割后的区域
却没有分开。Otsu方法计算出的阈值是42,可分性度量是0.636。
图10.43(d)显示了图像g?(x,y),该图像是按如下方式得到的：先计算拉普拉斯图像的绝对值，然后
用范围[0,255]内的灰度级115作为T值进行阈值处理。这个T值近似对应拉普拉斯图像绝对值中的99.5%,
所以在这个水平上阈值处理应该得到一个稀疏的像素集合，如图10.43(d)所示。注意，在该图像中，很
多点聚集在亮点的边缘附近，这正如从前面的讨论所预料的那样。图10.43(e)是图(a)和图(d)之积的非
零像素的直方图。最后，图10.43(f)显示了以图10.43(e)中的直方图为基础，采用Otsu方法全局地分割
原图像后的结果。该结果与图像中亮点的位置一致。用Otsu方法计算出的阈值是115,可分性度量是0.762,
这两个值都要高于使用原始直方图得到的值。
有可能修改该算法以便同时使用
记图像。当需要对有效的边缘点施
阅
主：因
486 数字图像处理(第三版)
a be d e f
图10.42(a)来自图10.41(a)的带噪声图像；(b)该图像的直方图：(c)在99.7??经阈
值处理后的梯度幅度图像；(d)图(a)和图(c)之积形成的图像；(e)图(d)所
示图像中非零像素的直方图；f以直方图(e)为基础.用Otsu 阀值处理分
割图像的结果。阈值为134,在该直方图中处在两个波峰间的近似中间的位置
dei
图10.43(a)酵母细胞图像；(b)图(a)的直方图；(c)使用图(b)中的直方图，用Osu 方法
对图(a)进行分割；(d)经阀值处理后的绝对拉普拉斯图像；(e)图(a)和图(d)乘
积中的非零像素的直方图；(1以(e)中的直方图为基础，使用Otsu的方法对原图像
进行阈值处理后的结果(原图像由南加利福尼亚大学的Susan L. Forsburg教授提供)
通过在可变的百分比处设置阈值，我们甚至还可以改善细胞区域的分割。例如，图10.44显示了使用
前段中的相同步骤得到的结果，但阈值设置在55处，它近似拉普拉斯图像最大绝对值的5??该值位于
图像中的所有值的53.9??很明显，这个结果好于图10.43(c)所示对原始图像的直方图用Otsu的方法得
到的结果。
第10章 图 像分 割 487
10.3.6 多阈值处理
迄今为止，我们关注的是用单一全局阈值对图像进行分
割。我们可将10.3.3节中介绍的阈值处理方法扩展到任意数量
的阈值，因为以这种方法为基础的可分性度量也可以扩展到任
意数量的分类(Fukunaga[1972])。在K个类C?,C?,…,Cx的情
况下，类间方差可归纳为下面的表达式：
?R(m-m2 (10.3-21)
其中，
R=∑n (10.3-22)
m=青Sm (10.3-23)
图10.44 使用图10.43(d)~(1)中解释的
相同过程，对图1043(a)中的图
像进行分割后的结果，但对绝
对拉普拉斯图像进行阈值处
理时，使用了一个较低的阈值
并且，m?是由式(10.3-9)给出的全局均值。K类由 K-1个阈值来分离，这些值k,k?…,k是
式(10.3-21)的最大值：
咯(j,A?,…,k)=mxik,k,…,k-) (10.3-24)
虽然这个结果通常很完美，但当分类数量增加时它会开始失去意义，因为我们仅处理一个变量(灰度)。
事实上，通常类间方差是依据以向量描述的多个变量来计算的(Fukunaga[19721)。实际中，当我们有
理由相信使用两个阈值可以有效地解决问题时，那么使用多个全局阈值处理就被视为一种可行的方
法。要求两个以上阈值的应用，通常使用更多的灰度值来解决。而该方法使用的是附加的描述子(譬
如彩色),并且这种应用是以如10.3.8节描述的模式识别问题来筹划的。
对于由三个灰度间隔组成的三个类(这三个类由两个阈值分隔)。
类间方差由下式给出：
o2=P(m-mc)2+P?(m?-m?)2+P?(m,-m?)2 (10.3-25)
其中，
R-2nB-2mB-艺
带有两个阈值的阈值处理有时也
称为滞后闯值处理。
(10.3-26)
和
m=青2m,m-2m.m-六艺m (10.3-27)
如在式(10.3-10)和式(10.3-11)中那样，如下关系成立：
Pm+P?m?+Pm?=m? (10.3-28)
和
P+P?+P=1 (10.3-29)
因此，我们看到，P项、m项，以及σ2都是k?和k?的函数。两个最佳阈值k,和k?是使得o2(k,,k?)最
四
488 数字图像处理(第三版)
大的值。换句话说，如在10.3.3节讨论的单阈值情况那样，我们用下式寻找最佳阈值：
 (j,k?)=mxi(k,k?) (10.3-30)
该过程由选择第一个k,值开始(该值是1,因为在0灰度处寻找阈值没有意义；还要记住，增
量值为整数，因为我们处理的是灰度)。接着，k?的所有值在大于k?和小于L-1的范围内增加(即
k?=k?+1,…,L-2)。然后，将k?增大到其下一个值，k?的所有值再次在大于k,的所有值范围内增
加。重复该过程，直到k?=L-3为止。该处理的结果是一个二维阵列σ2(k,,k?),最后一步是在该阵
列中寻找最大值。对应于最大值的k,值和k?值就是最佳阈值k*和k?。如果存在几个最大值，则对
应于k?和k?的值被平均以得到最终的阈值。然后，阈值处理后的图像由下式给出：
(10.3-31)
其中，a,b和c是任意三个有效的灰度值。
最后，我们注意到，在10.3.3节中为单一阈值定义的可分性度量可直接扩展到多个阈值：
nk;,k)= (10.3-32)
其中，2是来自式(10.3-13)的总图像方差。
例10.19 多个全局阈值处理。
图10.45(a)显示了一幅冰山的图像。这个例子的目的是把图像分割成三个区域：暗背景、冰山的明
亮区域和阴影区域。由图10.45(b)中的图像直方图可以看出，解决这一问题需要两个阈值是很明显的。
按上面讨论的过程得到阈值k?=80和k?"=177,由图10.45(b)注意到，它们靠近两个直方图波谷的中
心。图10.45(c)是在式(10.3-31)中使用这两个阈值得到的分割。可分性度量是0.954。这个例子能做到这
样好的主要原因在于能寻找到三个具有明显可分模式的直方图，该图有适度宽度和深度的波谷。
a be 中7 19
图10.45 (a)冰山图像；(b)直方图；(c)用双Otsu阀值将
图像分割为三个区域(原图像由NOAA提供)
10.3.7 可变阈值处理
正如 10.3.1节中讨论的那样，例如噪声和非均匀光照这样的因素对阈值处理算法的性能起着重
要作用。我们在10.3.4节和10.3.5节说明过，图像平滑和使用边缘信息可以得到有益的帮助。然而，
第10章 图 像分 割 489
常常会出现这种情况，即用迄今为止所讨论的任何方法解决问题时，要么这种类型的预处理不切实际，
要么对这一情形的改进简单而无效。在这种情况下，更为高级的且复杂的阈值处理涉及可变阈值问题。
在这一节中，我们讨论选择可变阀值的各种技术。
图像分块
可变阈值处理最简单的方法之一是把一幅图像分成不重叠的矩形。这种方法用于补偿光照和/或
反射的不均匀性。选择的矩形要足够小，以便每个矩形的光照都近似是均匀的。我们用一个例子来说
明这一方法。
例10.20 通过图像分块的可变阈值处理。
图10.46(a)显示了来自图10.37(c)的图像，图10.46(b)显示了其直方图。当讨论图10.37(c)时，我们
可得出这样的结论：使用一个全局阈值不能分割该图像，图10.46(c)和(d)已确认了这一事实，图10.46(c)
和(d)分别显示了使用10.3.2节中讨论的迭代方案和 Otsu方法分割图像后的结果。两种方法产生了可比
较的结果，结果中大量的分割错误显而易见。
图10.46(e)显示了已细分为6个矩形区域的原图像，图10.46(f)是对每幅子图像应用Otsu 全局方法
得到的结果。尽管分割结果中的一些错误仍然是可见的，但在一幅分割起来十分困难的图像上，图像细
分产生了合理的结果。分析每幅子图像的直方图，很容易就可解释这种改进的原因。如图10.47所示，每
幅子图像都由一个双模式直方图来表征，两个模式之间有一个较深的波谷，这是我们所知的将导致有效
全局阈值处理的一个事实。
11 25s
a b c d ef
图10.46(a)带噪声阴影的图像；(b)该图像的直方图；(c)用来自10.3.2节的
全局迭代算法对图(a)的分割；(d)使用Osu方法得到的结果；(e)分为
6幅子图像后的图像；(1)分别对每幅子图像应用Osu方法的结果
当感兴趣物体和背景占据合理的可比大小的区域时，通常图像细分工作得较好，如图10.46所示。当
不是这种情况时，典型地，该方法会失败，因为细分可能只包含物体或背景像素。虽然使用附加的技术
来确定何时一个细分包含两种像素可以解决这一情况，但解决不同情况所要求的逻辑会变得很复杂。在
这种情况下，使用这一节其余部分讨论的方法可能更好。 ;唇
490 数字图像处理(第三版)
似:
基于局部图像特性的可变阈值处理
与前一节中讨论的图像细分方法相比，更为一
般的方法是在一幅图像中的每一点(x,y)计算阈值，
该阈值是以一个或多个在(x,y)邻域计算的特性为基
础的。虽然这可能是似乎有点费力的处理，但现代
算法和硬件允许进行快速的邻域处理，特别是对于
像逻辑操作和算术操作这样的普通函数。
我们用一幅图像中每个点的一个邻域内的像素
的标准差和均值来说明局部阈值处理的基本方法。
这两个量对于确定局部阈值非常有用，因为它们是
局部对比度和平均灰度的描述子。令σ。和m,表
示一幅图像中以坐标(x,y)为中心的邻域S,所包含 图10.47 图10.46(e)中6幅子图像的直方图
的像素集合的标准差和均值(关于局部均值和标准差的计算，见3.3.4节)。下面是可变局部阈值的通
用形式：
Ty=ao+bm (10.3-33)
其中，a和b是非负常数，且
Ty=ao,+bm (10.3-34)
其中，mc是全局图像均值。分割后的图像计算如下：
g(x,)={0.fax,ysT (10.3-35)
其中，f(x,y)是输入图像。该式对图像中的所有像素位置进行求值，并在每个点(x,y)处使用邻域S
中的像素计算不同的阈值。
使用以(x,y)的邻域计算出的参数为基础的属性，有效的权值可显著增强局部阈值处理(计算
量会适度增加):
Q(局部参数)为真 8(x,)=6 Q(局部参数)为假 (10.3-36)
其中，Q是以邻域s。中像素计算的参数为基础的一个属性。例如，考虑如下基于局部均值和标准差
的属性Q(o。,m):
om)-。ADu> (10.3-37)
注意，式(10.3-35)是式(10.3-36)的一种特殊情况，它是在f(x,y)>T时令Q为真，而在其他情况下
令Q为假得到的。在这种情况下，该属性仅简单地基于一个点处的灰度。
例10.21 基于局部图像特性的可变阈值处理。
图10.48(a)显示了来自例10.18的酵母图像。该图像有三个主要的灰度级，因此也许双阈值处理是一
种较好的分割方法的假设是合理的。图10.48(b)是使用10.3.6节中说明的双阈值处理方法得到的结果。
如图所示，从背景中分离出明亮区域是可能的，但是，在图像右侧的中等灰度区域没有完全分割[回忆
第10章 图 像分 割 491
我们在例10.18中，遇到的与图10.43(c)类似的问题]。为说明局部阈值处理的用法，我们用大小为3×3
的邻域对输入图像中的所有(x,y)计算局部标准差o。图10.48(c)显示了结果。注意，微弱的外部线是
如何正确地刻画细胞的边界的。接着，我们使用全局均值替代m,来形成式(10.3-37)所示形式的一个属
性。通常，当背景近似恒定，并且所有物体的灰度高于背景灰度或低于背景灰度时，选择全局均值会给
出较好的结果。在完成的属性规范中，使用了值a=30和b=1.5(在类似这样的应用中，这些值通常是通
过试验确定的)。然后，用式(10.3-36)来分割图像。如图10.48(d)所示，结果与输入图像中的两类灰度的
大部分区域十分接近。尤其要注意所有的外部区域完全被正确分割了，且大多数较亮的内部区域也已被
正确地分开了。
a bc d
图10.48(a)来自图10.43的图像；(b)用10.3.6节中讨论的双阈值处理方法
分割的图像；(c)局部标准差图像；(d)用局部阈值处理得到的结果
使用移动平均
刚才讨论的局部阈值处理方法的一种特殊情形是以一幅图像的扫描行计算移动平均为基础的。
在速度是一种基本要求的文档处理中，这种实现相当有用。典型地，为减少光照偏差，扫描是以Z
字形模式逐行执行的。令z+表示步骤k+1中扫描序列中遇到的点的灰度。这个新点处的移动平均(平
均灰度)由下式给出：
mK+D= 23=mk+1(-2) (10.3-38)
其中，n表示用于计算平均的点数，且m(I)=z/n。这个初始值严格来说并不正确，因为单点的平均
是该点自身的值。然而，我们使用m(1)=z?/n,因此，第一次开始计算式(10.3-38)时，并不要求特
殊的计算。从另一个角度看，如果图像的边界填充了n-1个0,它就
是我们将得到的那个值。该算法仅初始化一次，不是在每行都初始化。
因为对图像中的每个点都计算移动平均，因此，用式(10.3-35)实现分
割，其中T=bm,b是常数，m是在输入图像中的点(x,y)处使用
式(10.3-38)得到的移动平均。
例10.22 用移动平均的文档阈值处理。
图10.49(a)显示了一幅以斑点灰度模式遮蔽的手写文本图像。这种灰度遮蔽形式是使用摄影闪光灯得
到的典型图像。图10.49(b)是使用Otsu 全局阈值处理方法分割的结果。全局阈值处理不能克服灰度变化并
不意外。图10.49(c)显示了采用移动平均的局部阈值处理的成功分割。一个经验是令n等于平均笔画宽度
的5倍。在这种情况下，平均宽度是4个像素，因此我们在式(10.3-38)中令n=20并使用b=0.5。
作为这种分割方法有效性的另一个说明，我们使用了与前一段中相同的参数来分割图10.50(a)中的
图像，该图像被正弦型灰度变化污染了，当文本扫描仪的电源未适当接地时，会出现这种典型的变化。
如图10.50(b)和(c)所示，分割结果类似于图10.49中的那些结果。
第一个表达式在k≥n-1时有
效。当k<n-1时，平均是使用可
用点形成的。类似地，第二个表达
式在k≥n+1时有效。
跳
屋退
492 数字图像处理(第三版)
a b c iee
n
在n tiong
Zhuy Anser aighiyMuu
aWcf dun ew-wa'
adawDa Wfaual
he/lny, birtwLngu
.Z
图10.49 (a)被斑点遮蔽污染的文本图像；(b)使用 Otsu 方法的全局
阀值处理的结果；(c)使用移动平均的局部阈值处理的结果
tan
 o/ 1atnlata
hy onulaa
在w tAan huiyt
atlchuyaeprta( /al2lkaugn
a bc
kwAuww'QP audaiwthaL Wfanal aranw2
图10.50(a)被正弦亮度遮蔽污染的文本图像；(b)使用Otsu方法的全
局阈值处理的结果；(c)使用移动平均的局部阀值处理的结果
有趣的是，使用相同的 n值和b值，两种情形下均得到了成功的分割结果，这说明了这种方法的相
对稳定性。通常，当感兴趣的物体与图像尺寸相比较小(或较细)时，基于移动平均的阈值处理会工作得
很好。打印图像和手写文本图像满足这一条件。
10.3.8 多变量阈值处理
迄今为止，我们已涉及了基于单个变量(灰度)的阈值处理。在某些情况下，传感器可产生多个
可利用的变量来表征图像中的每个像素，这样，就允许进行多变量阈值处理。一个显著的例子就是彩
色成像，其中红(R)、绿(G)和蓝(B)分量用于形成一幅合成彩色图像(见第6章)。在这种情况下，
每个“像素”由三个值来表征，并且可以表示为一个三维向量z=(z,Z?,z)',其分量是一个点的RGB
彩色。这些三维点通常称为体素，以便与图像元素相对应表示体积元素。
如6.7节中讨论的某些细节那样，多变量阈值处理可视为一种距离计算。假设我们想要从一幅彩
色图像中提取具有指定颜色的所有区域，比如说，微红色。令a表示我们感兴趣的平均微红色。基于
这一参数来分割彩色图像的一种方法是计算任意彩色点z和平均彩色a间的距离测度D(z,a)。然后，
我们按如下方式分割输入图像：
8={6其他T (10.3-39)
其中，T是一个阈值。当然，要在输入图像中的所有坐标上执行距离计算，以便产生相应的分割值g。
注意，该公式中的不等式与我们在式(10.3-1)中对于一个单变量阈值处理所用的不等式是相反的，原
因是等式D(z,a)=T定义了一个容积(见图6.43),并且它更直观地把分割后的像素值想象为包含在一
个容积中，而使背景像素值位于该容积的表面或外部。令D(z,a)=-f(x,y),式(10.3-39)便可简化为
式(10.3-1)。
第10章 图 像分 割 493
很明显，条件f(x,y)>T基本上表示f的值和实线的原点间的欧氏距离超过了T值。这样，阈值
处理就是基于距离测度的计算，并且，式(10.3-39)的形式依赖于所用的测度。通常，如果z是一个n
维向量，我们从2.6.6节可知n维欧几里得距离定义为
D(,a)=1z-a|=[(2-a3(z-a)F (10.3-40)
等式D(z,a)=T描述了欧几里得空间中(图6.4.3中显示了一个三维例子)的一个球(称为超球)。一种
更有用的距离测度是所谓的马氏(Mahalanobis)距离，定义为
D(z,a)=[(z-a)'c?'(z-a) (10.3-41)
其中，如12.2.2节讨论的那样，C是z的协方差矩阵。D(z,a)=T描述了一个n维超球(图6.43显示
了一个三维例子)。当C=I时，即为么阵时，该表达式就简化为式(10.3-40)。
我们在6.7节中已给出了一个关于使用这些表达式的详细例子。我们在12.2 节中还要讨论使用
基于决策函数的模式识别技术来分割图像的问题，这种问题可看成是多类、多变量阈值处理问题。
10.4 基于区域的分割
如10.1节中讨论的那样，分割的目的是将一幅图像划分为多个区
在继续阅读下文前，建议读者回 域。在10.2节中，我们其于灰度级的不连续性尝试寻找区域间的边界 顾一下10.1节中介绍的术语。
来解决这一问题；而在10.3节中，分割是通过以像素特性分布为基础
的阈值处理来完成的，如灰度值或彩色。在本节中，我们讨论以直接寻找区域为基础的分割技术。
10.4.1 区域生长
正如它的名字所暗示的那样，区域生长是根据预先定义的生长准则将像素或子区域组合为更大
区域的过程。基本方法是从一组“种子”点开始，将与种子预先定义的性质相似的那些邻域像素添加
到每个种子上来形成这些生长区域(如特定范围的灰度或颜色)。
如稍后在例10.23中显示的那样，通常我们可基于问题的性质来选择一组或多组开始点。当先验
知识不可用时，这一过程是在每个像素处计算相同特性的集合，最终，在生长过程期间，根据这些特
性集合把像素分配给各个区域。如果这些计算的结果显示了一族值，则那些特性靠近这些族的中心的
像素可以作为种子使用。
相似性准则的选择不仅取决于所面对的问题，还取决于现有的图像数据类型。例如，土地利用
卫星成像分析非常倚重彩色的使用。如果彩色图像中没有可用的固有信息，那么解决这个问题将非常
困难，甚至无法解决。如果图像是单色的，就必须使用一组基于灰度级和空间特性的描绘子(如矩或
纹理)对区域进行分析。在第11章中，我们将讨论那些对区域特征有用的描绘子。
如果在区域生长过程中没有使用连通属性，那么单独的描绘子会产生错误的结果。例如，设想
仅有三个不同灰度值的像素的随机排列。将具有相同灰度级的像素组合形成一个“区域”,而不考虑
连通性，会产生对当前讨论的内容毫无意义的分割结果。
区域生长的另一个问题是终止规则的表示法。当不再有像素满足加入某个区域的准则时，区域
生长就会停止。像灰度值、纹理和彩色准则本质上都是局部的，都没有考虑区域生长的“历史”。增
强区域生长算法能力的其他准则利用了候选像素和已加入生长区域的像素间的大小、相似性等概念(如 受畏
采;密
494 数字图像处理(第三版)
候选像素灰度和生长区域的平均灰度的比较),以及正在生长的区域的形状。这类描绘子的使用是以
期望结果的模型至少部分可用这一假设为基础的。
令f(x,y)表示一个输入图像阵列；S(x,y)表示一个种子阵列，阵列中种子点位置处为1,其他位
置处为0;Q表示在每个位置(x,y)处所用的属性。假设阵列f和S的尺寸相同。基于8连接的一个基
本区域生长算法可说明如下。 关于连通分量，请参阅2.5.2节和
953节；关于腐蚀.请参阅92.1节。 1.在S(x,y)中寻找所有连通分量，并把每个连通分量腐蚀为一个
像素；把找到的所有这种像素标记为1,把S中的所有其他像素标记为0。
2.在坐标对(x,y)处形成图像f。:如果输入图像在该坐标处满足给定的属性Q,则令
fo(x,y)=1,否则令f。(x,y)=0。
3.令g是这样形成的图像：即把f。中为8连通种子点的所有1值点，添加到S中的每个种子点。
4.用不同的区域标记(如1,2,3,…)标出g中的每个连通分量。这就是由区域生长得到的分割
图像。
我们通过一个例子来说明这种算法的机理。
例10.23 使用区域生长的分割。
图10.51(a)显示了一条焊缝(水平深色区域)的8比特X射线图像，该图像中含有几条裂缝和孔隙(水
平横穿图像中心的明亮区域)。我们用分割有缺陷的焊缝区域来说明区域生长的应用。这些区域可用于焊
缝检测，包括有关历史学习的数据库或控制自动焊接系统。
工作的第一步是确定种子点。从问题的物理性质看，我们知道裂缝和孔隙与实的焊缝相比，对X射
线的衰减要小，因此，我们预料包含这种类型缺陷的区域要比X射线图像中的其他部分明显亮一些。我
们可用在高百分比处设置阈值对原始图像进行阈值处理来提取种子点。图10.51(b)显示了图像的直方图，
图10.51(c)显示了用等于图像中灰度值的99.5??阈值对图像进行阈值处理后的结果，在这种情况下，阈
值为254(见10.3.5节关于百分比的说明)。图10.51(d)显示了将图10.51(c)中的每个连通分量用形态学腐
蚀为一个单点后的结果。
接下来，我们必须确定一个属性。在这个例子中，我们的兴趣是把满足如下要求的所有像素添加到
每个种子中：(a)对于种子是8连接的，并且(b)与种子相似。若使用灰度差作为一种相似性度量，则应
用于每一个位置(x,y)处的属性是
e-{FALSE. 种子和点(x,y)处的像素间灰度差的绝对值≤T
其他
其中，T是一个指定的阈值。虽然这个属性是基于灰度差的，并且使用单个阈值，但我们可指定更复杂的
方案，即对每个像素应用一个不同的阈值，并使用不同于差值的其他属性。在这种情况下，前述的属性
足以解决该问题，如这个例子的其余部分说明的那样。
从前面的章节我们知道，最小的种子值是255,因此，使用254的阈值对图像进行阈值处理。图10.51(e)
显示了图10.51(a)和(c)所示图像的差的绝对值。图10.51(e)中的图像包含了用于计算每个位置(x,y)处的
属性的所需要的差值。图10.51(f显示了相应的直方图。我们需要一个阈值，以便用于建立相似性属性。
该直方图有三个主要模式，因此我们首先把 10.3.6节中讨论的双阈值处理技术用于差值图像。在这种情
况下，导致的两个阈值是T?=68和T?=126,我们看到，它们相当靠近直方图的波谷[短暂地离开一下
话题，我们用这两个阈值分割了图像。图10.51(g)显示了使用双阈值不能解决缺陷的分割问题，尽管阈
值处在主要波谷的中]。
第10章 图 像分 割 495
更 网
a b e de f gh i
图10.51(a)有缺陷焊缝的X射线图像；(b)直方图；(c)初始种子图像；(d)最终种子图像
(为清楚起见，点已被放大);(e)图(a)和图(c)之差的绝对值；(①图(e)的直方图；
(g)使用双阈值进行阈值处理后的差值图像；(h)使用最小双阀值进行阈值处理后
的差值图像。(i)用区域生长得到的分割(原图像由X-TEK Systems有限公司提供)
图10.51(h)显示了仅使用T对差值图像进行阈值处理的结果。黑点是其属性为“真”(TRUE)的像素，
其他点是属性为“假”(FALSE)的像素。这里，重要结果是焊缝的良好区域中断定为失败的点，因此，
这些点将不包含在最终结果中。在外部区域的点将由区域生长算法作为候选点来考虑。然而，步骤3将
拒绝外部点，因为它们与种子不是8连接的。事实上，如图10.51(i)所示，这一步导致了正确的分割，这
表明连接性的使用是这种情况下的一个基本需求。最后，注意，在步骤4中，我们对由该算法找到的所
有区域使用了相同的值。在这种情况下，它确实做得很好。
10.4.2 区域分裂与聚合
上一节中讨论的过程是从一组种子点来生长区域。另一种可供选择的方法是首先将一幅图像细
分为一组任意的不相交区域，然后聚合和/或分裂这些区域，并力图满足10.1 节中阐述的分割条件。
下面讨论分裂和聚合的基础知识。
令R表示整幅图像区域，并选择一个属性Q。对R进行分割的一种方法是依次将它细分为越来越
小的四象限区域，以便对于任何区域R,有Q(R,)=TRUE。我们从整个区域开始。如果Q(R)=FALSE,
那么将该图像分割为4个象限区域。如果对于每个象限区域Q为FALSE,则将该象限区域再次细分为
四个子象限区域，依此类推。这种特殊的分裂技术有一个方便的表示方法，即用所谓的四叉树形式表
示，即每个节点都正好有4个后代，如图10.52所示(对应一个四叉树的节点的图像有时称为四分区域
或四分图像)。注意，树根对应于整幅图像，而每个节点对应于该节点的4个细分子节点。在这种情况
下，仅R?被进一步再细分。
如果只使用分裂，那么最后的分区通常包含具有相同性质的邻
接区域。这种缺陷可以通过允许聚合和分裂得到补救。要满足10.1节
关于区域相邻的讨论，请参阅
2.5.2节。 居:
仙;逸
496 数字图像处理(第三版)
中提出的分割约束条件仅要求聚合满足属性Q的组合像素的邻接区域。也就是说，只有在
Q(R,UR,)=TRUE时，两个邻接区域R,和R才能聚合。
a b R
R R
Re
R Ra
Ra R
R? R? R R
Ra) R RA R
图10.52(a)被分割的图像；(b)对应的四叉树。R表示整个图像区域
前述讨论可以小结为如下过程，在该过程的任何一步中，我们
1.对满足Q(R)=FALSE的任何区域R,分裂为4个不相交的象限区域。
2.当不可能进一步分裂时，对满足条件Q(R,UR)=TRUE的任意两个邻接区域R,和R,进行聚合。
3.当无法进一步聚合时，停止操作。
习惯上要规定一个不能再进一步执行分裂的最小四象限区的尺寸。
前述的基本原理可能有多种变化。例如，在步骤2中，如果两个邻接的区域R,和R,各自都满足
属性，则我们允许聚合这两个区域会得到有意义的简化。这将导致简单得多(且快得多)的算法，因为
属性的测试被限制在各个四分区域。正如下例所示，这种简化仍能产生较好的分割结果。
例10.24 用区域分裂和聚合进行分割。
图10.53(a)显示了天鹅星座环的一幅大小为566x566的X射线波段的图像。这个例子的目的是把围
绕致密中心的不太密集的环状物质的图像分割出来。感兴趣区域有一些有助于分割的明显特征。首先，
我们注意到该区域中的数据具有随机性质，这表明其标准差应大于背景和较大的相当平滑的中心区的标
准差(背景的标准差近于0)。类似地，来自外环的包含数据的一个区域的均值(平均灰度)应大于暗背景的
均值而小于较大且亮中心区域的均值。从而，我们应该能够用下面的属性分割感兴趣的区域：
e={PASE,oa其他m<
其中，m和σ是一个四象限区域中的像素的均值和标准差，a和b为常数。
对感兴趣外部区域中的几个区域的分析表明，这些区域中的像素的平均灰度未超过125,而标准差总
是大于10。图10.53(b)到(d)显示了对a和b使用这些值和允许的四象限区域的最小尺寸从32变到8得
到的结果。一个四象限区域中满足属性的像素置为白色，而该区域中的其他像素则置为黑色。根据截获
的外部区域的形状，最好的结果是使用大小为16x16的四象限区域得到的。图10.53(d)中的黑色方块是
大小为8×8的四象限区域，该区域中的像素不满足属性。使用较小的四象限区域将导致此类黑色区域数
量的增加。使用比此处说明的大的区域会导致更多“类似块”的分割。注意，在所有情况下，分割后的
区域(白色像素)从背景中完全分隔了平滑的内部区域。这样，分割就有效地把图像分成了三个明显的区
域，这些区域对应于图像中的三个主要特征：背景、密集区域和稀疏区域。若使用图10.53中的任何一
个白色区域作为模板，将使从原图像中提取这些区域成为一项相对简单的任务(见习题10.40)。正如例10.23
那样，使用基于边缘或阈值的分割不可能得到这些结果。
第10章 图 像分 割 497
abcd
图10.53(a)由NASA的哈勃望远镜在X射线波段拍摄的天鹅星座环超新星的图像；(b)~(d)分别将允
许的最小四象限区域尺寸限制为32×32,16×16和8x8像素时得到的结果(原图像由NASA提供)
如前面的例子所使用的那样，基于一个区域内像素灰度的均值和标准差的特性试图定量化该区域
的纹理(关于纹理的讨论，见11.3.3节)。纹理分割的概念是以在属性上使用纹理测度为基础的。换句话
说，我们可以使用本节讨论的任何一种方法，用指定基于纹理内容的属性简单地执行纹理分割。
10.5 用形态学分水岭的分割
迄今为止，我们已经讨论了基于三种主要概念的分割：(a)边缘检测，(b)阈值处理和(c)区域生长。
每种方法都有其优点(例如全局阈值处理具有速度优势)和缺点(例如，在基于边缘的分割中，需要进行
后处理，如边缘连接)。在本节中，我们将讨论基于所谓的形态学分水岭概念的方法。在下面的讨论中
将更为明显，形态学分水岭分割将其他三种方法中的许多概念进行了具体化，因此通常会产生更稳定
的分割结果，包括连接的分割边界。这种方法为在分割中结合基于知识的约束提供了一个简单的框架。
10.5.1 背景知识
分水岭的概念是以三维形象化一幅图像为基础的：两个空间坐标作为灰度的函数，如图2.18(a)
所示。在这种“地形学”解释中，我们考虑三种类型的点：(a)属于一个区域最小值的点；(b)把一点
看成是一个水滴，如果把这些点放在任意位置上，水滴一定会下落到一个单一的最小值点；(c)处在
该点的水会等可能性地流向不止一个这样的最小值点。对于一个特定的区域最小值，满足条件(b)的
点的集合称为该最小值的汇水盆地或分水岭。满足条件(c)的点形成地表面的峰线，这种峰线称为分
割线或分水线。
基于这些概念的分割算法的主要目标是找出分水线，其基本思想非常简单，如下面类似的说明
那样。假设在每个区域的最小值上打一个洞，并且让水通过洞以均匀的速率上升，从低到高淹没整个
地形。当不同的汇水盆地中上升的水聚集时，修建一个水坝来阻止这种聚合。水将达到在水线上只能
见到各个水坝的顶部这样一个程度。这些大坝的边界对应于分水岭的分割线。因此，它们是由分水岭
算法提取出来的(连接的)边界。
借助于图10.54,我们可以进一步解释这些概念。图10.54(a)显示了一幅灰度图像，图10.54(b)是
一幅地形俯视图，其中“山峰”的高度与输入图像中的灰度值成正比。为了便于解释，这些结构的背
面已被遮蔽，以便不会与灰度值混淆，因为我们只对三维表示的普通地形感兴趣。为了阻止上升的水
从图像的边缘溢出，我们可以想象整个地形(图像)的四周已被比最高山峰更高的水坝包围起来，最高
的山峰的值是由输入图像灰度级可能具有的最大值决定的。
假设在每个区域的最小值处打一个洞[如图10.54(b)中的深色区域所示],并且让水以均匀的速率上
升，从低到高淹没整个地形。图10.54(c)说明了被水淹没的第一个阶段，其中显示为浅灰色的“水”仅覆
盖了图像中相对较暗的背景区域。在图10.54(d)和(e)中，我们看到水现在已分别上升至第一个和第二个
汇水盆地。当水继续上升时，最终会从一个汇水盆地溢出到另一个汇水盆地。第一个征兆如图10.54(f所 辰;图
貌;因
498 数字图像处理(第三版)
示。这里，水实际上从左侧盆地溢出到了右侧的盆地，因此构筑了一个较短的“水坝”(由几个单一的像
素组成)来阻止水在这一水位汇合(构筑水坝的细节将在下一节讨论)。随着水位的不断抬升，更加明显的
效果如图10.54(g)所示。这幅图在两个汇水盆地之间显示了一条更长的坝，另一条水坝在右侧盆地的顶
部。构筑后一水坝的目的是阻止来自盆地中的水与来自对应的背景中水的汇聚。该过程一直持续，直
到达到水的最高水位(对应于图像中的最高灰度值)。最终的水坝对应于分水线，这些分水线就是我们
希望的分割结果。在图10.54(h)中，该例的结果显示为叠加到原图像之上的一条1像素宽的深色路径。
注意，一条重要的性质就是分水线组成一条连通的路径，这样，在两个区域间就给出了连续的边界。
abe d efgh
图10.54 (a)原图像；(b)地形俯视图；(c)-(d)被水淹没的两个阶段；(e)进一步淹没的结果；(f)来
自两个汇水盆地的水开始汇聚(两个汇水盆地之间构筑了一个较短的水坝);(g)较长的水
坝：(h)最终的分水(分割)线(原图像由CMMEcole des Minesde Paris公司的S.Beuchar博士提供)
分水岭分割的主要应用之一是从背景中提取近乎一致(类似于水滴)的物体。由变化较小的灰度表
征的区域有较小的梯度值。因此，我们经常见到分水岭分割方法用于一幅图像的梯度，而不是图像本
身。有了这一表示法，汇水盆地的区域最小值就可很好地与对应于感兴趣物体的较小梯度值联系起来。
10.5.2 水坝构建
在讨论之前，让我们考虑一下如何构建分水岭分割算法所需的水坝或分水线。水坝的构造是以
二值图像为基础的，这种图像是二维整数空间Z的成员(见2.4.2节)。构建分离二元点集的水坝的最
简方法是使用形态学膨胀(见9.2.2节)。
图10.55 说明了如何使用形态学膨胀来构建水坝的基础。图10.55(a)显示了第n-1步淹没的两
个汇水盆地。图10.55(b)显示了第n步淹没的结果。水已从一个盆地溢出到了另一个盆地，所以，必
须构建水坝来阻止这种情况的发生。为了与很快将要引入的符号一致，令M?和M?表示两个区域中
的最小值点坐标的集合。然后，将汇水盆地中点的坐标集合与这两个在溢出的第 n-1步处的最小
值点的坐标集合联系起来，在第n-1步溢出处，两个最小值分别表示为C.(M,)和Ca;(M?)。它们是
图10.55(a)中的两个灰色区域。
令Cn-1]表示这两个集合的并集。图10.55(a)中有两个连通分量(关于连通分量的讨论，见2.52节),
而图10.55(b)中只有一个连通分量，该连通分量包含了如虚线所示的前两个分量。两个连通分量变成
一个连通分量的事实表明两个汇水盆地在第n步淹没中已被聚合了。令q表示这个连通分量。注意，
来自n-1步的两个连通分量可以通过使用简单的“与”操作(qNCIn-1))从q中提取出来。我们还
注意到，属于单个汇水盆地的所有点形成了一个单一的连通分量。
第10章 图 像 分 割 499
假设图10.55(a)中的每个连通分量被图10.55(c)中所示的结构元膨胀服从两个条件：(1)膨胀必须
受到q约束(这意味着在膨胀的过程中，结构元的中心只能位于q中的点处),(2)不能对会引起正被
膨胀集合聚合(变成一个单一的连通分量)的那些点执行膨胀。图10.55(d)表明，第一轮膨胀(显示为
浅灰色)展开了每个原始连通分量的边界。注意，膨胀过程中，每个点都满足条件(1),而在膨胀处理
中，条件(2)没有应用于任何点；这样，每个区域的边界就被均匀地扩展了。
bd
原点 第一次膨胀
■第二次膨胀
区水坝点
图10.55(a)第n-1步淹没处，两个部分淹没的汇水盆地；(b)在淹没的第n步处，显
示水已在两个盆地间溢出；(c)用于膨胀的结构元；(d)膨胀结果和水坝构建
在第二轮膨胀中(显示为黑色),几个不符合条件(1)的点却符合条件(2),这导致了图中所示的断
开的周界。很明显，q中只有满足上述两个条件的点，才能描绘出图10.55(d)中由打叉线所示的1像素
宽的连通路径。在淹没的第n步，这条路径构成了所期望的分隔水坝。在这个淹没水平上的水坝构建，
是在刚刚确定的这条路径上的所有点设置一个大于图像最大灰度值的值来完成的。所有水坝的高度通
常设置为1加上图像中允许的最大灰度值。当水位升高时，这样设置可以阻止洪水漫过所完成的水坝。
注意，通过这一过程构建的水坝是连通分量是很重要的，它就是我们希望得到的分割边界。换句话说，
这种方法消除了分割线断裂的问题。
尽管刚刚描述的过程只是基于一个简单的例子，但该方法同样适用于更为复杂的情形，包括使
用图10.55(c)中所示的3×3对称结构元。
10.5.3 分水岭分割算法
令M,M?…,Mg是表示图像g(x,y)的区域最小值点的坐标的集合。如同在10.5.1节末尾说明的
那样，这是一幅典型的梯度图像。令CM)是表示与区域最小值M,相联系的汇水盆地中的点的坐标集
合(回忆任何汇水盆地中的点都形成一个连通分量)。符号min和max 将用于表示g(x,y)的最小值和最
大值。最后，令Tn]表示满足g(s,D)<n的坐标(s,r)的集合，即
T[n]={(s,1)Ig(s,t)<n} (10.5-1)
几何上，Tn]是g(x,y)中位于平面g(x,y)=n下方的点的坐标的集合。
随着水位以整数从n=min+1到n=max+1不断上升，地形将被水淹没。在淹没过程的任意步
n,算法都需要知道处在淹没深度之下的点的数量。从概念上来说，假设处在g(x,y)=n平面之下的TTn] 圜
;;器
500 数字图像处理(第三版)
中的坐标被“标记”为黑色，所有其他坐标被标记为白色。然后，当我们以任何淹没增量n处向下观
察xy平面时，我们将会看到一幅二值图像，图像中的黑点对应于函数中平面g(x,y)=n之下的点。这
种解释对于理解下面的讨论很有帮助。
令C,(M,)表示汇水盆地中与淹没阶段n的最小值M相关联的点的坐标集。参照前一段的讨论可
知，C.(M,)可看成是由下式给出的一幅二值图像：
Cn(M)=C(M)NTIn] (10.5-2)
换句话说，如果(x,y)∈C(M)和(x,y)∈T[n]相“与”,则在位置(x,y)处有C,(M)=1。,否则C,(M)=0。
这一结果的几何解释很简单，我们在淹没阶段 n只需使用“与”(AND)算子将TIn]中的二值图像分
离出来即可。
接下来，我们令Cn]表示在阶段n中已被水淹没的汇水盆地的“并”:
cm-Ucu) (10.5-3)
然后，令C[max+1]表示所有汇水盆地的“并”:
Cmx+1=-Ucw) (10.5-4)
可以证明(见习题10.41),在算法的执行过程中，C.(M)和T[n]中的元素是不会被替换的，而且当n增大
时，这两个集合中的元素的数量不是增加，就是保持相同。这样，可理解为C[n-1]就是C[m的一个子集。
根据式(10.5-2)和式(10.5-3)可知，C[n]是T[n]的一个子集，所以，C[n-1]可以理解为T[n]的一个子集。
由此，我们得出一个重要的结果：C[n-1]中的每个连通分量都恰好包含在Tn]的一个连通分量中。
寻找分水线的算法使用C[min+1]=T[min+1]来初始化。然后，该算法进行递归处理，由C[n-1]
计算C[n]。由C[n-1求得C[n]的过程如下：令Q表示T[n]中的连通分量的集合。然后，对于每个
连通分量q∈ Q[n],有如下三种可能性：
1.qnC[n-1]为空集。
2.qNC[n-1]包含C[n-1]的一个连通分量。
3.qnC[n-1]包含C[n-1]的一个以上的连通分量。
由C[n-1]构建C[n]取决于这三个条件中的哪一个成立。当遇到一个新的最小值时，条件1发生，
这种情况下，连通分量q并入C[n-1]中形成C[n]。当q位于某些局部最小值的汇水盆地内时，条件
2发生，这种情况下，q并入C[n-1]中形成C[n]。当遇到全部或部分分隔两个或多个汇水盆地的山
脊线时，条件3发生。进一步淹没会导致这些汇水盆地中的水位聚合。因此，必须在q内构筑一个水
坝(如果涉及两个以上的汇水盆地，就要构筑多个水坝)以阻止汇水盆地间的水溢出。正如前节中解释
的那样，当我们使用元素为1、大小为3×3的一个结构元来膨胀qNC[n-1]且膨胀被限制到q时，可
以构建一座1个像素宽的水坝。
仅用g(x,y)中对应于现有灰度值的n值就可改善算法的效率；根据g(x,y)的直方图，我们可以确
定这些值，以及最小值和最大值。
例10.25 分水岭分割算法的说明。
分别考虑图10.56(a)和(b)中的图像和它的梯度。应用刚才讨论的分水岭算法得到了图10.56(c)中的
梯度图像的分水线(白色路径)。这些叠加到原图像上的分割边界示于图10.56(d)中。正如在本节开始时所
注意到的那样，分割边界具有连通路径的重要特性。
第10章 图 像分 割 501
a b c d
图10.56(a)水滴的图像；(b)图像的梯度；(e)分水线；(d)叠加在原图像上的分水
线(原图像由CMMEcole des Mines de Paris公司的S.Beucher 博士提供)
10.5.4 标记的使用
直接应用前一节讨论的形式的分水岭分割算法通常会由于噪声和梯度的其他局部不规则性造成
过度分割，如图10.57所示，过度分割的严重性足以令算法得到的结果变得毫无用处。在这种情况下，
这意味着存在大量的分割区域。一个实际解决该问题的方案是通过融入预处理步骤来限制允许存在的
区域的数目，设计的预处理步骤是将附加知识应用于分割过程。
用于控制过度分割的一种方法是基于标记这一概念的。一个标记是属于一幅图像的一个连通分量。
与感兴趣物体相联系的标记称为内部标记，与背景相关联的标记称为外部标记。选择标记的典型过程
由两个主要步骤组成：(1)预处理；(2)定义标记必须满足的一个准则集合。为了对此进行说明，再次
考虑图10.57(a)。导致图10.57(b)中过度分割结果的部分原因是存在大量潜在的最小值。由于它们的尺寸，
许多最小值是不相关的细节。就像先前的讨论中多次指出的那样，将很小的空间细节的影响降至最低的
有效方法是用一个平滑滤波器对图像进行过滤。在这种特殊情况下，这是一种合适的预处理方案。
a b
图10.57(a)电泳现象图像；(b)对梯度图像应用分水岭分割算法得到的结果。过度分割现
象很明显(原图像由CMM/Ecole des Mines de Paris公司的S.Beucher博士提供)
假设我们将内部标记定义为：(1)被更高“海拔”点包围的区域；(2)区域中形成一个连通分量
的那些点；(3)连通分量中所有的点有相同灰度值。在图像经过平滑处理之后，由该定义导致的内部
标记在图10.58(a)中以浅灰色、斑点状区域显示。接着，在这些内部标记只能是在允许的区域最小值
的限制下对平滑后的图像应用分水岭算法。图10.58(a)显示了得到的分水线。将这些分水线定义为外
部标记。请注意，沿分水线的点经过相邻标记间的最高点。
图10.58(a)中的外部标记有效地将图像分割成了不同的区域，每个区域都包含一个单一的内部标
记和部分背景。这样，问题就简化为将这些区域的每一个划分为两部分：单个物体及其背景。我们可
以根据这一简化过的问题应用多种在本章先前讨论过的分割技术。另一种方法是对各个区域简单地应
用分水岭分割算法。换句话说，我们简单地求得平滑后图像的梯度[见如图10.56(b)],然后，将算 受;匿
室
502 数字图像处理(第三版)
法限制在只对在该特殊区域中包含这一标记的单一分水岭进行操作。使用这种方法得到的结果如
图10.58(b)所示。相对于图10.57(b)的改善是明显的。
a b
图10.58 (a)显示有内部标记(浅灰色区域)和外部标记(分水线)的图像；(b)分割的结果。注意，注意其相
对于图10.47(b)的改进。(原图像由CMM/Ecole des Mines de Paris公司的S.Beucher博士提供)
标记的选择可以用基于灰度值和连通性的简单过程归类，如刚才所说明的那样，更复杂的描述
涉及尺寸、形状、位置、相对距离、纹理内容等(见第11章中关于描绘子的内容)。关键是使用标记
带来的与分割问题有关的先验知识。应该提醒读者注意的是：人类经常以先验知识用日常的视觉辅助
进行各种分割和更高级的工作，最熟悉的例子之一就是上下文的使用。因此，分水岭分割方法提供了
一种能有效使用这类知识的框架，这是这种方法的一个突出的优点。
10.6 分割中运动的应用
运动是人类和其他任何动物从无关细节背景中提取感兴趣物体或区域的强有力的提示。在成像
应用中，运动来自感觉系统和正被观看的场景间的相对位移，比如机器人应用、自主导航和动态场景
分析中。在下面的几节中，我们将考虑运动在空间域和频率域分割中的运用。
10.6.1 空间域技术
基本方法
分别检测在时刻t和r,获取的两帧图像帧f(x,y,t)和f(x,y,r)之间的变化的最简方法之一是逐像
素地比较这两幅图像。这样做的一个过程是形成一幅差值图像。假设我们有一幅仅包含固定分量的参
考图像。将这幅图像和一幅后续的相同场景但包含一个运动物体的图像进行比较，去掉两幅图像中的
固定元素，仅保留对应于非固定图像分量的非零项，就可得到两幅图像的差。
在时刻t和，获取的两幅图像间的差值图像可以定义为
(C)-10. 其他)-(ux,yiT (10.6-1)
其中，T是一个指定的阈值。注意，就像由该指定阈值确定的那样，仅当两幅图像间的灰度差在空间
坐标(x,y)处明显不同时，d,(x,y)在该坐标处的值才为1。假设所有图像的大小相同。最后，我们注意
到，式(10.6-1)中坐标(x,y)的值跨越了这些图像的维度，所以差值图像d,(x,y)与序列中的其他图像的
大小相同。
在动态图像处理中，d,(x,y)中值为1的所有像素被认为是物体运动的结果。这种方法只有在两幅图
像都做了空间配准且在T值设定的范围内光照相对恒定的情况下才是可用的。实际上，d,(x,y)中的1值
第10章 图 像分 割 503
项可能是由噪声造成的。通常，在差值图像中这些项是孤立的点，去除它们的一种简单方法是在d,(x,y)
中构成由1组成的4连通或8连通区域，然后忽略1值项少于预定元素数量的任何区域。尽管这种方
法会忽略掉小的和/或慢速运动的物体，但它改善了差值图像中剩余项实际是运动结果的机会。
累积差值
考虑一个图像帧序列f(x,y,t).f(x,y,t?),…,f(x,y,t),令f(x,y,t)为参考图像。一幅累积差值图
像(ADI)是通过将参考图像与序列中每幅后续图像进行比较形成的。当参考图像和序列中一幅图像之
间在某个像素位置上出现一次差异时，累积图像中每个像素位置的计数器计数一次。因此，当第k帧
图像与参考图像进行比较时，累积图像中一个给定像素的输入项会给出在此位置上灰度与参考图像相
应的像素值不同的次数[正如由式(10.6-1)中的T确定的那样]。
考虑如下累积差值图像的三种类型：绝对ADI、正ADI和负ADI。假设运动物体的灰度值大于背
景的灰度值，这三种ADI定义如下。令R(x,y)表示参考图像，为简化符号，令k表示t,则有f(x,y,k)=
f(x,y.t)。我们假设R(x,y)=f(x,y.1)。然后，对于任何b>1,且记住ADI的值是计数，我们对(x,y)的
所有相关值定义于下：
(C)={A-(+1其他-cxy,k)lsT (10.6-2)
Aa)-{a地》-usx*>T (10.6-3)
和
Na)-NCy+ 其他》-/uxxAk<-T (10.6-4)
其中，A?(x,1),P(x,y)和N(x,y)分别为遇到序列中的第k幅图像后的绝对ADI、正ADI和负ADI。
不难理解，这些ADI均从零值开始(计数)。还要注意这些ADI与序列中的图像大小相同。最后，
我们注意到，如果背景像素的灰度值大于运动物体的灰度值，则式(10.6-3)和式(10.6-4)中的不等式
的顺序和阈值的符号是相反的。
例10.26 绝对、正和负的累积差异图像的计算。
图10.59显示了以灰度图像形式显示的三种ADI,图中矩形物体的大小为75×50像素，该物体以每
帧5√2个像素的速度向东南方向运动。图像的大小为256×256像素。我们注意到下列几点：(1)正ADI的
非零区域等于运动物体的大小。(2)正ADI的位置对应于参考帧中运动物体的位置。(3)当运动物体与参
考帧中的同一物体完全被移动时，正ADI中的计数停止增加。(4)绝对ADI包含正ADI和负ADI的区域。
(5)运动物体的方向和速度可以由绝对ADI和负ADI中的输入决定。
a bc
图10.59 一个向东南方移动的矩形物体的ADI:(a)绝对ADI;(b)正ADI;(c)负ADI 受;…
屋：急
504 数字图像处理(第三版)
建立参考图像
前两节讨论的技术的成功关键在于找到一幅可以与后续图像进行比较的参考图像。在动态成像
问题中，两幅图像的差值倾向于消除图像中的所有固定分量，而只留下对应于噪声和运动物体的图像
元素。
实际上，仅用固定元素得到一幅参考图像并不总是可行的，所以有必要根据一组包含一个或多
个运动物体的图像来构建一幅参考图像。这尤其适用于描述变化频繁的场景或需要频繁更新的场景的
情况。生成参考图像的过程如下所述。考虑将图像序列中的第一幅图像作为参考图像。当一个非固定
分量完全移出其参考帧的位置时，在当前帧中对应的背景可复制到最初被参考帧中的物体所占据的位
置。当所有的移动物体均已完全移出其原来的位置时，就创建了一幅仅包含固定分量的参考图像。像
前节中说明的那样，通过监视正ADI中的变化，可确定物体的位移。
例10.27 构造一幅参考图像。
图10.60(a)和(b)显示了一个交通十字路口的两幅图像帧。第一幅图像作为参考图像，第二幅图像描
述了一段时间后的同一场景。为生成一幅静止图像，我们的目的是去掉参考图像中的主要运动物体。尽
管存在其他较小的运动物体，但主要的运动特征是在十字路口从左到右运动的汽车。为了说明这一目的，
我们将注意力放在这个物体上。通过监视正 ADI的变化，可以确定一个移动物体的初始位置，如先前解
释的那样。一旦确定了被这个物体占据的区域后，使用减法可从图像中移除该物体。通过观察图像序列
中正ADI停止变化的那一帧图像，我们可以从该幅图像中复制先前被初始帧中的移动物体所占据的区域。
然后，将该区域粘贴到被挖去物体的图像中，从而恢复该区域的背景。如果对所有运动的物体都进行这
种操作，结果将是一幅只包含静止分量的参考图像，针对该参考图像，我们可在运动检测中与后续帧进
行比较。在这种情况下，图10.60(c)显示了去掉向东运动的汽车后得到的结果。
a bc
图10.60 构造一幅静止参考图像：(a)和(b)序列中的两帧图像；(c)从图(a)中减去向东运
动的汽车并使用图(b)中的对应区域恢复背景后的结果(原图像由 Jain和Jain提供)
10.6.2 频率域技术
在这一节中，我们考虑通过傅里叶变换公式来确定运动的问题。考虑一个序列f(x,y,7),t=1,2,….
K-1,该序列是由一台固定的照相机所拍摄的大小为M×N的K帧数字图像。我们从假设所有帧都有
零灰度的均匀背景开始讨论。例外的是一个单一的具有单位灰度的一个1像素大小的物体，该物体以
恒定速度运动。假设对于第一帧(t=0),物体在位置(x',y')处，并且将图像平面投影到x轴上；也就是
说，对图像中的一列像素的灰度相加。这一操作产生一个带有M个零值项的一维阵列，除了x处，
它是单点物体的x坐标。现在，如果我们用exp[j2πa,xAr]乘以一维阵列中的每个分量，其中x=1,2,….
M-1,并把结果相加，我们会得到单项exp[j2πa,xAr]。在这种表示中，a?是一个正整数，A是不
同帧之间的时间间隔。
假设在第二帧中(t=1),物体已运动到坐标(x+1,y)处；也就是说，物体在平行于x轴的方向移
动了1个像素的位置。然后，重复上一段中提到的投影过程，得到和exp[j2πa,(x'+1)Ar]。如果物体
第10章 图 像分 割 505
每帧继续移动一个像素，则在任何整数瞬间t,结果为exp[j2πa?(x'+1)A],使用欧拉公式，可将它
表示为
ei2g(+0=cos[2πa,(x'+1)Ar]+jsin[2πa,(x'+1)Ar] (10.6-5)
其中，t=0,1,…,K-1。换句话说，这一过程得到一个频率为a,的复正弦曲线。如果物体在帧间移动
v?个像素(在x方向),那么正弦曲线的频率为V?a?。因为t在0和K-1之间以整数增量变化，限制
a?只取整数值会使复正弦曲线的离散傅里叶变换具有两个波峰——一个位于频率Va,处，另一个位
于K-V?a,处。如4.6.4节中讨论的那样，后一个波峰是由离散傅里叶变换的对称性产生的，故可以
忽略掉。因此，在傅里叶频谱中找到一个波峰，就得到V?a?。用a,除该量得到V?,它就是x方向的
速度分量，这里假设帧速率是已知的。采用类似的方法可以得到y方向的速度分量V?。
没有运动发生的帧序列会产生相同的指数项，其傅里叶变换在频率0(一个单一的直流项)处有一
个单一的波峰。所以，由于迄今为止我们讨论的都是线性操作，故在任意静止背景中涉及一个或多个
运动物体的一般情况下，对应于静止图像分量的直流处傅里叶变换有一个波峰，且这些位置的波峰与
物体的速度成正比。
上述概念可以总结如下：对于一个由K幅大小为MxN的数字图像序列，在任何整数的瞬时点上，
图像投影到x轴上的加权和为
.0.a)=22ruay.e=0.1.…,K-1 (10.6-6)
类似地，y轴上的投影和为
,0.a)=2Zruay.ei=0.1.….K-1 (10.6-7)
其中，如已经解释过的那样，a?和a?都是正整数。
式(10.6-6)和式(10.6-7)的一维傅里叶变换分别为
c,o,a)=28.1.a,peu =0.1.…,K-1 (10.6-8)
和
G,u?,a)=L8,0.a?e/ku?=0.1.…,K-1 (10.6-9)
实际上，如4.11节中讨论的那样，这些变换的计算是使用FFT算法执行的。
频率和速度的关系是
“1=aY (10.6-10)
和
u?=a?V (10.6-11)
在该式中，速度的单位是像素数/总帧时间。例如，V?=10可以解释为在K帧中物体运动了10个像
素。对于匀速摄取的图像帧，实际的物理速度取决于帧速率和像素之间的距离。因此，如果v?=10.
K=30,帧率是两幅图像每秒，像素之间的距离是0.5m,则x方向的实际物理速度是
V?=(10个像素)(0.5m/像素)(2帧/s)(30帧)=1/3m/s
速度的x分量的符号可通过计算下式得到： 匿
受;
506 数宇图像处理(第三版)
su-d RduLa (10.6-12)
和
su-2u (10.6-13)
因为g,是正弦函数，故可以证明(见习题10.47),如果速度分量V?为正，则在时间n,S?和S?在任
意点将有相同的符号。反之，S和S?的符号相反则表明速度分量V?为负。如果S或S?为零，那么
我们考虑下一个最近的时间点t=n±△r。类似的说明可用于计算V?的符号。
例10.28 通过频率域检测较小的运动物体。
图10.61到图10.64说明了刚才推导方法的有效性。图10.61显示了一组32帧LANDSAT图像序列中
的一幅，该图像是通过将白噪声添加到一幅参考图像中产生的。图像序列中包含一个叠加的运动物体，
物体在x方向以每帧0.5个像素的速度运动，在y方向以每帧1个像素的速度运动。在图10.62中用圆圈
标出的物体在展开的较小(9像素)的区域内具有高斯灰度分布，该分布用肉眼不易辨别。图10.63和图10.64
显示了分别令a?=6和a?=4计算式(10.6-8)和式(10.6-9)时得到的结果。根据图10.63中u=3处的波峰，
由式(10.6-10)得到V?=0.5。同样，根据图10.64中u?=4处的波峰，式(10.6-11)得到V?=1.0。
图10.61 LANDSAT的图像帧(原图像由
Cowart,Snyder和Ruedger 提供)
图10.62 图10.61中图像的灰度图，目标已用圆圈标
出(原图像由Rajala,Riddle和Snyder 提供)
640
560
480
400 100-
幅度(×10) 320 80-
240
160
80 觚度(×102 60-
40-
20-
0- 0-
0 4 8112162024128 32 36 40 04 8 12 16 20 24 28 32 36 40
频率 频率
图10.63 式(10.6-8)的谱，在u=3处显示了一个波
峰(原图像由Rajala,Riddle和Snyder 提供)
图10.64 式(10.6-9)的谱，在u?=4处显示了一个波
峰(原图像由Rajala,Riddle和Snyder提供)
第10章 图 像分 割 507
借助于图10.63和图10.64,我们可以解释选择a?和a?的原则。例如，假设我们用a?=15取代a?=4。
在这种情况下，图10.64中的波峰将位于u?=15和17处，因为V?=1.0,这将是一种严重的混淆的结
果。正如在2.5.4节中讨论过的那样，混淆是由欠采样造成的(当u的范围由K决定时，当前讨论中，
图像帧数太少)。因为u=aV,故一种可能是将a选择为最接近a=um/Vm的整数，其中a是由K
建立的混淆频率限制，而V是期望的物体的最大速度。
小结
在大多数自动图像模式识别和场景分析应用中，图像分割是一个基本的预备步骤。正如在前面
各节中介绍的各种例子所说明的那样，选择何种分割技术主要取决于所考虑问题的特殊性。本章中讨
论的各种方法尽管并不十分详尽，但却是在实际应用中普遍使用的具有代表性的技术。下面的参考文
献可作为读者进一步研究该主题的基础。
参考文献
由于分割在自动图像处理领域中所起的核心作用，大多数关于图像处理、图像分析和计算机视觉的著述中
都涵盖了这一主题。以下图书为这一主题提供了补充和或辅助阅读材料：Umbaugh[2005];Davies[2005];Gonzalez.
Woods 和Eddins[2004];Shapiro和Stockman[2001];Sonka等人[1999]:Petrou和Bosdogianni[1999]。
使用模板检测灰度的不连续性(见10.2 节)已有较长的历史。这些年来，人们提出了无数的模板：
Roberts[1965],Prewit[1970],Kirsh[1971],Robinson[1976].Frei和Chen[1977],以及Canny[1986]。Fram和
Deutsch[1975]发表的回顾性文章中包含了大量的模板，以及对它们的性能的评价。模板性能存在的问题，
特别是对边缘检测来说，仍是相当重要的研究领域，如由Qian和Huang[1996],Wang等人[1996],Heath 等
人[1997,1998]和Ando[2000]给出的例子。彩色图像边缘检测在许多感知的应用中正逐渐普及，例如，可见
Salians,Abidi和Gonzalez[1996]的著述；Zugaj和Lattuati[1998];: Mimehdi和Petrou[2000];以及Plataniotis和
Venetsanopoulos[2000]的著述。图像特征和模板性能之间的相互影响也是当前人们感兴趣的主题，如
Ziou[2001]给出的例子。我们关于拉普拉斯算子的零交叉性质的介绍基于Marr 和Hildredth[1980]的论文和
Mar[1982]的专著。也可以见Clark[1989]关于使用零交叉算法进行边缘鉴别的论文(Clark 的论文的部分修
正由 Piech[1990]给出)。如10.2节中提到的那样，通过高斯拉普拉斯的零交叉方法是一种重要的方法，其
相对性能仍是一个活跃的研究主题(Gunn[1998,19991)。如其名字暗示的那样，在10.2.6.节讨论的坎尼检测
器基于坎尼的论文[1986]。这一主题20年后的例子见Zhang和Rockett[2006]。
霍夫变换(Hough[1962)是进行全局像素连接和曲线检测的一种实用方法。本章讨论的这种基本变换
的大量推广已经提出很多年了。例如，Lo和Tsai[1995]讨论了检测细线的一种方法，Guil等人[1995,19971
解决了霍夫变换的快速实现和简单曲线的检测问题，Daul 等人[1998]将霍夫变换进一步推广到了检测椭圆
形弧线，Shapiro[1996]则解决了对灰度图像实现霍夫变换的问题。
如10.3节开始时提到的那样，阈值处理技术享有重要的普及地位，因为这种技术实现简单。关于该主
题的许多文献中报告了大量的工作并不奇怪。在Sahoo等人[1988]和Lee等人[1990]的综述性的文章中，可
以看到对这类文献的较好评价。除了本章中讨论的技术外，处理光照和反射影响(10.3.1节)所使用的其他
方法，由Perez和Gonzalez[1987],Parker[1991],Murase和Nayarf[1994],Bischsel[1998],Drew等人[1999]和Toro
和Funt[2007]的工作做了说明。关于10.3.2节中的其他读物，见Jain 等人[1995]的著述。
最优全局阈值处理(10.3.3节)的早期工作已在Chow和Kaneko[1972]的经典著述中举例说明(我们将在
12.2.2节在目标识别的更一般的行文来讨论这个方法)。虽然在理论上它是最佳的，但这种方法在灰度阈值
处理中的应用却受到了限制，因为需要估计概率密度函数。10.3.3节中给出的出自Otsu[1979]的最佳方法
806
808
808
809
508 数字图像处理(第三版)
得到了人们的广泛接受，因为它使优秀的性能和实现简单结合起来，且仅要求估计图像的直方图。使用预
处理(10.3.4节和10.3.5节)的基本概念可回溯至White和Rohrer[1983]的早期论文，该论文在解决困难的分
割问题中，综合使用了阈值处理、梯度和拉普拉斯算子。前面三篇文章中讨论的方法，与由Cheriet 等人[1998].
Sauvola和Pietikainen[2000].Liang 等人[2000]和Chan等人[2000]在閾值处理方面所做的工作几乎相差了近20
年，因此在图像分割能力方面比较这些方法的基本相似性是很有趣的。关于多閥值处理(见10.3.6节)的其他
读物，见Yin和Chen[1997],Liao等人[2001]和Zahara等人[2005]的著述。关于可变阈值处理(见10.3.7节)
的其他读物，见Parker[1997]和Delon 等人[2007]的著述。
面向区域分割这一主题的早期的著述见Fu和Mui[1981]的著述。为分割目的而综合区域和边界信息的
早期努力见Haddon和Boyce[1990]和 Pavlids和Liow[1990]的工作。由Hojatoleslami和Kittler[1998]提出的
一种较新区域生长方法也很重要。对于最近一段时间基本涵盖面向区域分割概念的文献，见Shapiro和Stockman
[2001]以及Sonka等人[1999]的著述。
10.5节所示的分水岭分割是一个强大的概念。涉及分水岭分割的早期文献见Sera[1988],Beucher[1990]
和Beucher和Meyer[1992]的著述。Baccar 等人[1996]的论文讨论了基于数据融合和形态学分水岭的分割方
法。完全致力于分水岭分割的专刊Pattem Recognition[2000]表明，10年来该领域的研究进展相当明显。如
我们在10.5节中讨论的那样，使用分水岭方法的关键问题之一是过度分割问题。Najmanand和Schmit[1996].
Haris 等人[1998]和 Bleau和Leon[2000]的论文是处理这种问题的例证。Bieniek和Moga[2000]讨论了一种基
于连通分量的分水岭分割算法。
10.6.1节中的材料来自Jain,R.[1981]的著述，也可参阅Jain, Kasturi和Schunck[1995]的著述。10.6.2节
中的材料来自Rajala,Riddle和Snyder[1983]的著述，也可参阅 Shariat和Price[1990]及Cumani等人[1991]的
论文。关于运动估计的其他读物，见Sonka等人[1999],Shapiro和Stockman[2001],Snyder和Qi[2004]及Davies
[2005]的书籍，也可参阅Alexiadis和Sergiadis[2007]的著述。
习题
★10.1 证明式(10.2-2)的正确性。(提示：用泰勒级数展开，并仅保留线性项。)
★10.2 设有一幅包含有水平直线、垂直直线、45°方向直线和-45°方向直线的二值图像。给出一组大小
为5×5的模板，要求这些模板可用于检测这些直线中的1像素的间断。假设直线和背景的灰度分
别是1和0。
10.3 提出一种用于检测二值图像的线段中长度从1到K个像素的裂缝的技术。假设线的宽度为1个像
素。您的技术要以8邻域连通性分析为基础，而不能试图构造检测裂缝的模板。
10.4 参考图10.7,回答下列问题。
★(a)图10.7(e)中某些连接焊点和中心元素的线是单线，而其他线是双线。解释一下为什么。
(b)提出一种消除图10.7(f)中那些-45°方向线的部分分量的方法。
10.5 参考图10.8中的边缘模型。
★(a)假设我们使用图10.14中的Prewitt 算子来计算每个模型的梯度幅度。请画出通过梯度图像中
心的水平剖面线。
(b)画出每个对应角度图像的水平剖面。
(注意：在回答该问题时不要生成梯度图像和角度图像。简单地提供剖面线的图，该图显示像您
预期的幅度和角度的剖面线即可。)
10.6 考虑穿过一幅二值图像中部的一个水平灰度剖面线，二值图像中包含一个垂直通过图像中心的台
阶边缘。画出已被一个大小为nxn且系数等于1/(n2)的平均模板模糊后图像的剖面线。为简单起
第10章 图 像分 割 509
见，假设图像已被标定，即其灰度级在边缘的左侧为0,在右侧为1。此外，假设模板的尺寸远
小于图像的尺寸，以便在靠近水平灰度剖面的中心处不必关注图像的边界效应。
★10.7 假设我们已使用示于右图中的边缘模型代替了图10.10中的斜坡模型。请写出每个剖面的梯度和
拉普拉斯算子。
10.8 参照图10.14,回答下列问题。
(a)假设使用 Sobel模板得到了g和g,。证明在这种
情况下，使用式(10.2-10)和式(10.2-20)计算得到
的梯度幅度可得出相同的结果。
图像
(b)证明对于Prewitt 模板也是正确的。
★10.9 证明图10.14和图10.15中的Sobel模板和 Prewitt 模
板仅对水平边缘、垂直边缘和±45°方向边缘给出各 一条水平线的剖面
向同性的结果。
10.10 某些使用二维模板处理图像一遍得到的结果，也可使用一维模板处理图像两遍来得到。例如，使
用系数为1/9、大小3×3的平滑模板得到的结果，可以通过对图像使用一次模板[1.1.1],然后对
结果应用模板 111
然后，最终结果乘以1/9。证明 Prewitt模板(见图10.14)的响应可通过使用一次形如[-1,0.1]的
差分模板(或其对应的正交阵),然后使用一次形如[1,2,1]的平滑处理模板(或其对应的正交阵)
得到。
10.11 所谓的大小为3×3的罗盘梯度算子设计用来度量8个方向上的梯度：E,NE,N,NW,W,sW,S和SE。
★(a)使用系数值0.1,-1,-2或2,给出这8个算子的形式。
(b)指定每个模板的梯度向量方向，记住梯度方向与边缘方向是正交的。
10.12 右图所示二值图像中，矩形的大小为mxn像素。
(a)以式(10.2-20)给出的近似为基础，这幅图像的梯度幅度像什么?
假设g,和g,是使用Prewitt 算子得到的。说明梯度图像中的所有
相应的不同像素值。
(b)画出用式(10.2-11)计算得到的边缘方向的直方图。精确标出直方
图中每个分量的高度。
(c)以式(10.2-7)给出的近似为基础，该图像的拉普拉斯图像是什么?说明拉普拉斯图像中所有相
应的不同像素值。
10.13 假设图像f(x,y)与大小为nxn的模板(系数为1/n2)卷积后，产生了一幅平滑后的图像了(x,y)。
★(a)以模板尺寸的函数的形式推导平滑后图像的边缘强度(边缘幅度)的一个表达式。为简单起见，
假设n是奇数，且边缘是使用如下偏导数得到的：
可/ax=f(x+1,y)-f(x,y)和 可īlay=F(x,y+D-F(x,y)
(b)证明平滑后的图像的最大边缘强度与原图像的最大边缘强度之比为I/n。换句话说，边缘强度
与平滑模板的尺寸成反比。
10.14 参考式(10.2-23):
★(a)证明一个高斯算子的拉普拉斯V2Gx,y)为零。 ,
510 数宇图像处理(第三版)
(b)证明用这个算子卷积的任何图像的平均值也为零。(提示：考虑在频率域中解决该问题，使用
卷积定理，以及一个函数的平均值与其在原点处计算的傅里叶变换成正比这一事实)。
(c)在一般情况下，如果我们(1)使用图10.4(a)中的模板来计算使用大小为3×3的拉普拉斯模板
的高斯低通滤波器的拉普拉斯，并(2)将得到的结果与任何图像卷积，那么请问(b)还正确吗?
请解释。(提示：参见习题3.16。)
10.15 参考图10.22(c)。
(a)解释为什么边缘构成闭合的轮廓线。
★(b)寻找边缘位置的零交叉方法总会导致闭合轮廓吗?请解释。
10.16 我们时常发现文献中推导高斯拉普拉斯(LoG)时，都用如下表达式开始：
G(r)=e202
式中r2=x2+y2。然后，用二阶偏导数得到LoG:V2G(r)=a2G/ar2。最后，使用x2+y2替代
2得到了(不正确的)结果：
V2G(x,y)=[x2+y2-σ2]/o?]expl-(x2+y2)/2o2]
请推导该结果并解释该表达式与式(10.2-23)不同的原因。
10.17 (a)推导式(10.2-27)。
(b)令k=σ?/o?表示DoG函数的标准差比率。请使用k和o?来表示式(10.2-27)。
10.18 在下文中，假设G和f分别是大小为nxn和M×N的离散阵列。
★(a)证明式(10.2-21)中的高斯函数与图像f(x,y)的二维卷积可以表示为先沿f(x,y)的行(列)进行一
维卷积，然后沿所得结果的列(行)进行一维卷积(关于离散卷积的讨论，见3.4.2节)。
(b)推导出使用(a)中的一维卷积方法相对于直接执行二维卷积的优势的表达式。假设G(x,y)被取
样产生一个大小为nxn的阵列，而f(x,y)是一个大小为MxN的阵列。计算优势是二维卷积要
求的乘法次数与一维卷积要求的乘法次数之比。
10.19 (a)证明Marr-Hildreth 算法的步骤1和步骤2可以通过使用4次一维卷积来实现。(提示：参考
习题10.18(a),将拉普拉斯算子表示为由式(10.2-5)和式(10.2-6)给出的两个偏导数之和，如
习题10.10那样，并使用一个一维模板实现每个导数。)
(b)推导出使用(a)中的一维卷积方法相对于直接执行二维卷积的优势的表达式。假设G(x,y)被取
样产生一个大小为nxn的阵列，而f(x,y)是一个大小为MxN的阵列。计算优势是二维卷积要
求的乘法次数与一维卷积要求的乘法次数之比(见习题10.18)。
10.20 (a)用一维卷积代替二维卷积，用公式表示坎尼算法的步骤1和第二步中梯度幅度图像的计算。
(b)相对于使用二维卷积实现，使用一维卷积方法的计算优势是什么?假设步骤1中的二维高斯
滤波器被取样为一个大小为nxn的阵列，且输入图像的大小为M×N。将计算优势表示为每种
方法所要求的乘法次数之比。
10.21 参考图10.8中的三个垂直边缘模型和对应的剖面。
★(a)假设我们使用Sobel模板来计算三个边缘模型的梯度幅度。画出三幅梯度图像的水平灰度剖
面线。
★(b)画出三幅拉普拉斯图像的水平灰度剖面线，假设拉普拉斯是使用图10.4(a)中的3×3模板计
算的。
★(c)仅使用Marr-Hildreth 边缘检测器的前两步产生的图像，重复上一问题。
(d)对于坎尼边缘检测器的前两步重复上述问题。您可以忽略角度图像。
第10章 图 像分 割 511
(e)针对坎尼边缘检测器，画出角度图像的水平剖面线。(注意：回答这一问题时不必生成图像，
只须简单地画出剖面线。并说明您所期望的图像剖面线像什么。)
10.22 参考10.2.7节中讨论的霍夫变换。
(a)从y=ax+b的斜截式形式，导出一条线的法线表示的一般过程。
★(b)求直线y=-3x+2的法线表示。
★10.23 参考10.2.7节中讨论的霍夫变换。
(a)解释为什么图10.33(a)中的点1的霍夫映射在图10.33(b)中为一条直线。
(b)这是仅能产生这样结果的点吗?请解释。
(c)以图10.33(b)中标为Q的曲线为例，解释反射的邻接关系。
10.24 证明实现10.2.7节所述累加单元方法所需的操作次数与图像平面(即xy平面)中的背景点数量n
成线性关系。
10.25 图像分割技术的重要应用领域是处理由所谓的泡沫室活动导致的图像。这些图像是在高能物理实
验中得到的，在这种实验中，一束已知性质的粒子直接打到一个已知核子的目标上。一个典型的
活动由任何一次碰撞活动中的输入轨迹以及粒子由撞击点分散发出的二次轨迹组成。请提出一种
分割方法来检测所有的轨迹，这些轨迹至少包含100个像素并与水平方向有如下6个方向的夹角：
±20°,±40°和±60°。在这6个方向上的每一个，允许的估计误差为±5°。一条有效的轨迹必须至
少要有100个像素长，间隙不多于3个，并且每个间隙不超过10个像素的长度。您可以假设图像
已进行了预处理以便形成二值图，并且除了发出轨迹的撞击点以外，所有轨迹均为1个像素宽。您
的过程应能分辨原点不同但方向相同的轨迹。(提示：以霍夫变换作为您的解决方案的基础。)
★10.26 重新说明10.3.2节中的全局阈值处理算法，以便它使用一幅图像的直方图来代替该图像本身。
★10.27 证明10.3.2节中的基本全局阈值处理算法在有限几步内收敛。(提示：使用来自习题10.26的直方
图表达式。)
10.28 给出一种解释，为什么10.3.2节的基本全局阈值处理算法的初始阈值必须在图像的最小值和最大
值之间。(提示：构建一个例子来说明阈值选在该范围之外算法会失败。)
★10.29 使用10.3.2节的基本全局阀值处理算法得到的阈值与起始点无关吗?如果您的回答是“是”,证
明它，如果回答是“不”,给出一个例子。
10.30 您可以假设下列两种情况，在迭代中阈值限制在开区间(0,L-1)内。
★(a)如果图像的直方图在所有可能的灰度级上都是均匀的，请证明10.3.2节的基本全局阈值处理
算法将收敛到图像的平均灰度(L-1)/2处。
(b)如果一幅图像的直方图是双模式的，且具有关于其均值对称的相同模式，请证明基本全局阈
值处理算法将收敛到这两个模式的均值之间的中点。
10.31 参考10.3.2节中的阈值处理算法。假设在给定的问题中，直方图是双模式的，且这两个模式是形
如A,expl-(z-m)2/2o}1和A?expl-(z-m?)2/2o}]的高斯曲线。假设m,>m?,且初始的T在图
像的最大灰度值和最小灰度值之间。当算法收敛时，给出以下陈述为真的条件(用这些曲线的参
数表示):
(a)阈值等于(m,+m?)2。
(b)阈值在m?的左边。
(c)阈值位于区间(m,+m)/2<T<m,内。
如果这些条件的任意一条不存在，请说明原因。
★10.32 (a)证明式(10.3-15)的第一行来自式(10.3-14)、式(10.3-10)和式(10.3-11)。
(b)证明式(10.3-15)的第二行来自第一行。 8;8
512 数字图像处理(第三版)
10.33 证明对于范围0≤k≤L-1内的k值，式(10.3-18)总存在一个最大值。
10.34 参考式(10.3-20),预设一个参量，可确定0≤η(k)≤1,k在0≤k≤L-1范围内，仅在图像具有
恒定灰度时可达到最小值，并且仅在图像有两个值0和L-1时最大值才发生。
★10.35 (a)假设一幅图像f(x,y)的灰度在范围[0,1]内，并且阈值T成功地将该图像分割为物体和背景。
证明阈值T=1-T将成功地把f(x,y)的负图像分割为相同的区域。这里，“负”这一术语被
用于3.2.1节定义的场景。
(b)在(a)中，把一幅图像映射为它的负图像的灰度变换函数是一个具有负斜向的线性函数。说
明一个任意的灰度变换函数必须满足关于将被保留的阈值T对原始图像可分割性的条件。灰
度变换后的阈值将是什么值?
10.36 右图所示图像中的物体和背景，在标度范围[0,255]内具有的平
均灰度分别为180和70。该图像被均值为0、标准差为10个
灰度级的高斯噪声污染了。请提出一种正确分割率为90??
更高百分比的阈值处理方法。(回忆一下，高斯曲线下99.7%
的面积位于均值的±3σ区间内，其中σ是标准差。)
10.37 参考图10.37(b)中的灰度斜坡图像和 10.3.7节中讨论的移动平
均算法。假设图像的尺寸为400×700像素，其最小值和最大值
分别为0和1,这里的0项仅包含在第一列中。
★(a)若b=0而n为任意值，那么使用移动平均算法分割该图像后的结果是什么?解释该图像像什么。
(b)现在，斜坡的方向反转，因此，最左侧的值为1而最右侧的值为0。重复问题(a)。
(c)重复问题(a),但n=4,b=1。
(d)重复问题(a),但n=100,b=1。
10.38 提出一个区域生长算法来分割习题10.36中的图像。 -N-
★10.39 使用10.4.2节中讨论过的分裂和聚合过程来分割右图所示的图像。
如果R,中的所有像素都有相同的灰度，则令Q(R,)=TRUE。给
出对应于您的分割的四叉树。 N
10.40 考虑例10.24中对天鹅星座环图像的稀疏区域进行分割得到的由1
构成的区域。提出一种将该区域作为模板来隔离图像中的三个主
要分量的技术：(1)背景，(2)致密内部区域.(3)稀疏外部区域。
10.41 参考10.5.3节中的讨论。
★(a)说明在分水岭算法执行的过程中，C.(M,)和T[n]的元素从不被替换。
(b)说明当 n增加时，集合C.(M,)和集合T[n]中的元素数量随着 n的增加，不是增加，就是保
持不变。
10.42 在10.5节说明过的使用分水岭分割算法得到的边界形成了一个闭合环(例如，见图10.56和图10.58)。
请预设一个参量，使得应用这个算法无论如何总能得到闭合形式的边界。
★10.43 对于下图所示的一维灰度横截面，给出逐步构建水坝的实现过程。在每一步骤画出显示水位和已
构建大坝的横截面。
7
6-
受
5
4
和" 1 1213 234's1617891011 14 15 x
第10章 图 像 分 割 513
10.44 如果我们在式(10.6-4)中是针对T(而不是针对-T)进行测试，那么图10.59(c)中的负ADI图像会
是什么样子?
10.45 判断下列说法是否正确。对您的答案进行解释。
★(a)只要物体正在运动，那么绝对ADI中的非零项的维数就会持续增加。
(b)不管物体是否运动，正ADI中的非零项总是占据相同的面积。
(c)只要物体正在运动，负ADI的非零项的维数就会持续增加。
10.46 假设在例10.28中将x轴方向的运动设为零。现在物体仅沿y轴以每帧1个像素的速度运动28帧，
然后瞬间转向，向相反方向运动28帧。在这些条件下，图10.63和图10.64会是什么样子?
★10.47 预置一个参量，以证明当式(10.6-12)和式(10.6-13)中的S,和S?的符号相同时，速度分量V?为正。
10.48 一家自动制药厂为质量控制的目的用图像处理方法来测量药片的形状。该系统的分割步骤是以
Otsu方法为基础的。由于检测线的速度很高，因此需要速率非常高的闪光来“停止”运动。当照
明灯为新的时，照明灯投影一个均匀的光模式。但当灯泡老化时，照明模式的退化根据下面的公
式是时间和空间坐标的函数：
i(x,y)=A(1)-r2e-(-MP+(y-N)2
其中，(M,N)是观察区域的中心，t是以月为单位增加的测试时间。灯泡是试验性的，且制造商并
不了解灯光的At)特性。所知道的全部是在灯泡的寿命期，A(I)总是大于上式中的负值，因为光
照不能为负。观察表明，当灯泡是新的时，Otsu 算法工作得很好，其光照模式在整个图像上近似
于常数。然而，分割性能却随时间恶化。由于试验性灯泡格外昂贵，因此请您作为顾问在计算上
帮助解决该问题，从而延长灯光的可用寿命。给您很大的灵活性，可以在成像摄像机的取景区域
的边缘附近安装任何特殊标记或其他可视提示。请提出一个能让工程计划经理理解的详细解决方
案。(提示：回顾2.3.4节中讨论的图像模型并考虑使用一个其反射率已知的小目标。)
10.49 飞行中的子弹的速度可以用成像技术来估计。选择一种包括使用一台TV摄像机和可以曝光场景
k秒的闪光灯的方法。子弹长2.5cm,宽1cm,速度范围为700±200m/s。光学摄像机拍摄了一
幅水平分辨率为256×256的数字图像，其中子弹占据了10??
★(a)为保证运动对图像造成的模糊不超过1像素，确定最大的K值。
(b)确定每秒必须得到的帧数的最小值，以便保证在子弹穿过摄像机的视场时至少得到两幅子弹
的完整图像。
(c)提出一种能自动地从帧序列中提取子弹的分割过程。
(d)提出一种能自动地确定子弹速度的方法。
…:8
受;;
第11章 表示和描述
好吧，让我们反思一下；我们是否多次否认正确的命名是相似的，
或是他人命名的翻版?
——苏格拉底
引言
使用第10章中讨论的那些方法将一幅图像分割成多个区域后，分割后的像素集经常以一种适合
于计算机进一步处理的形式来表示和描述。基本上，表示一个区域涉及两种选择：(1)我们可以根据
其外部特征(其边界)来表示区域，或(2)根据其内部特征(如组成该区域的像素)表示它。然而，选择
表示方案仅是使得数据适用于计算机的一部分。下一个任务是基于所选择的表示来描述区域。例如，
区域可由其边界表示，边界可用特征对其进行描述，如长度、连接端点的直线的方向，以及边界上凹
陷的数量。
当我们关注的重点是形状特征时，可选择一种外部表示；而当关注的重点是内部属性如颜色和
纹理时，可以选择一种内部表示。有时，需要同时使用这两种表示。无论哪种情形，选择用来作为
描绘子的特征都应尽可能地对大小、平移和旋转不敏感。本章中讨论的多数描绘子满足一种或多种
这样的特性。
11.1 表示
第10章中讨论的分割技术以沿着边界或包含在区域中的像素的形式产生原始数据。标准做法是
使用某种方案将分割后的数据精简为便于描绘子计算的表示。在本节中，我们将讨论各种表示方法。
11.1.1 边界追踪
本章中讨论的几个算法要求一个区域的边界上的点以顺时针(或逆时针)方向排序。因此，我们
通过介绍边界跟踪算法开始我们的讨论，该算法的输出是排过序的点 在继续阅读前。请读者复习一下 的序列。我们假设：(1)处理的是二值图像，其目标和背景点分别标为 2.52节和9.53节中的内容。
1和0;(2)图像已使用值为0的边界填充，因而消除了目标与图像边
界合并的可能性。为方便起见，我们仅限于讨论单个区域。通过单独地处理各个区域，该方法可扩展
到多个不相交的区域。
给定一个二值区域R或其边界，追踪R的边界或给定边界的算法由如下步骤组成：
第11章 表示和描述 515
1.令起始点b?为图像中左上角标记为1的点①。使用c。表示b?西侧的邻点[见图11.1(b)]。很
明显，c。总是背景点。从c。开始按顺时针方向考察b?的8个邻点。令b,表示所遇到的值为1
的第一个邻点，并直接令c?(背景)是序列中b?之前的点。存储b和b?的位置，以便在步骤5
中使用。
2.令b=b?和c=c?[见图11.1(c)]。
3.从c开始按顺时针方向行进，令b的8个邻点为n,n?,…·ng。找到标为1的第一个n
4.令b=n和c=n-1。
5.重复步骤3和步骤4,直到b=b?且找到的下一个边界点为b。
当算法停止时，所找到的b点的序列就构成了排列后的边界点的集合。
c
1 1 1 1 b[i 1 bi bi
1 1 1
1
1 1
1 1 1 1
a bcd e
图11.1 边界追踪算法前几步的说明。下一个被处理的点标为黑色。
而已被处理的点标为灰色，算法找到的点标为灰色方块
注意，步骤4中的c总是背景点，因为n是顺时针扫描时找到的第一个1值点。在Moore[1968]
之后，有时该算法称为Moore 边界追踪算法。该算法的步骤5中规定的停止规则并不正确，因为第
一次停止时，会再次遇到b?。正像您马上将了解的那样，这会导致错误的结果。
图11.1显示了刚才讨论的边界追踪算法的前几步。很容易检验，继续该过程将得到如图11.1(e)
所示的正确边界，该边界中的点是一个顺时针方向排列的序列。
为了解该算法步骤5中规定的停止规则的必要性，考虑图11.2中的边界。例如，不完全的毛刺去
除(见9.5.8节有关毛刺的说明)会导致边界上侧的线段。从左上角的点开始，得到所示的步骤。在
图11.2(c)中，我们看到该算法已经回到起始点。如果步骤因为再次到达起始点而停止，那么显然不
会找到剩余的边界。使用步骤5中的停止规则可允许算法继续，并且显示图11.2中找到的整个边界是
很简单的事情。
1 b c
1 1 1 b
1
1 1 1 国
111 国
a b c
图11.2 当再次遇到起始点b时，边界追踪算法满足停止规则导致的错误结果的说明
如果给定一个区域而非其边界(就像在前述说明中那样),那么边界追踪算法会工作得很好。也
就是说，该过程提取一个二值区域的外边界。如果目的是找到一个区域中的孔洞的边界(这种边界称
为该区域的内边界),一种简单的方法是提取这些孔洞(见9.5.9节),并将它们当做0值背景上的1值
区域来处理。对这些区域应用边界追踪算法将得到原始区域的内边界。
①在本章后面我们会看到，边界中的左上角点有一个重要性质，即该边界的一个多边形近似在该位置有一个凸顶点。此外，该点
的左上邻点可保证为背景点。这些属性使得该点成为开始边界追踪算法的一个较好的“标准”点。 :8
眼;图
516 数字图像处理(第三版)
我们已经简单地说明了基于顺时针方向跟踪一个边界的算法。事实上，您会遇到按如下假设来
进行表述的算法：边界点已在某个方向上排序。在以下几节中，我们将交替使用两个方向来帮助您熟
悉这两种算法。
11.1.2 链码
链码用于表示由顺次连接的具有指定长度和方向的直线段组成的边界。典型地，这种表示基于
这些线段的4连接或8连接。每个线段的方向使用一种数字编号方案编码，如图11.3所示。以这种方
向性数字序列表示的编码称为佛雷曼链码。
数字图像通常以一种网格形式来获取并处理，在这种网格形式中，x和y方向的间距相等，所以，
链码可以通过追踪一个边界产生，也就是说，以顺时针方向，并且对连接每对像素的线段赋予一个方
向的方法产生。这种方法通常是不可接受的，原因有二：(1)得到的链码往往太长，(2)噪声或不完美
分割沿边界引起的任何较小干扰都会导致编码的变化，而这种变化与边界的主要形状特征可能是不相
关的。
经常用于解决这些问题的一种方法是选取一个较大的网格间距来对边界重取样，如图11.4(a)所
示。然后，当边界穿过网格时，将一个边界点赋给大网格的一个节点，具体取决于原始边界与该节点
的接近程度，如图11.4(b)所示。然后，按这种方法得到的重取样边界可由一个4链码或8链码表示。
图11.4(c)显示了由8方向链码表示的粗略边界点。从8链码转换为4链码或者从4链码转换为8链
码是一件简单的事情(见习题2.12和习题2.13)。图11.4(c)中的起始点位于边界的左上角处，它给出
了链码0766…12。如所期望的那样，结果编码表示的精度取决于取样网格的间距。
a b 1 2
3、 1
2 0 4 0
5 7
3 6
图11.3(a)4方向链码和(b)8方向链码的方向编号
0 a b c
2
7
1
6
……
21 6
1
6
21 6
:
:
3
6
3 54
图11.4 (a)叠加有重取样网格的数字边界；(b)重取样的结果；(c)8方向链码边界
边界的链码取决于起始点。然而，链码可以通过一个简单的过程关于起始点归一化，过程如下：
我们简单地将链码视为方向号码的一个循环序列，并重新定义起始点，以便得到号码序列的最小整数
值。我们也可以针对旋转归一化(使用图11.3中方向的整数倍的角度),方法是使用链码的一次差分来
替代链码本身。这个差分是通过计算链码中分隔两个相邻像素的方向变化的数(在图11.3中按逆时针
第11章 表示和描述 517
方向)得到的。例如，4方向链码10103322的一次差分为3133030。如果我们把链码作为循环序列来
关于起始点归一化，则差分的第一个元素是通过使用链码的最后一个元素和第一个元素间的转变来计
算得到的。这里，结果是33133030。改变重取样网格的大小，可实现尺寸归一化。
只有对于旋转和尺度变化而边界本身不变(再强调一下，按图11.3中方向的整数倍角度)时，这些
归一化才是准确的，实际中很少出现这种情形。例如，同一物体按两个不同方向数字化后，通常会有
不同的边界形状，不相似程度与图像的分辨率成正比。按其长度与数字化图像中像素间距离成比例来
选择链码，和/或沿将被编码物体的主轴(见11.2.2节中的讨论)或沿其本征轴(见11.4节中的讨论)来选
定重取样网格的方向，可降低这种影响。
例11.1 佛雷曼链码及它的某些变化。
图11.5(a)显示了小镜片中嵌入环形笔画后的图像，该图像是大小为570×570的8比特灰度图像。本
例的目的是得到图11.5(a)的最小值整数的佛雷曼链码和最大物体外部边界的一次差分。因为感兴趣物体
镶嵌在小镜片中，提取其边界的结果将是一条不能描述该物体的普通形状的带噪声曲线。图11.5(b)显示
了使用一个大小为9×9的均值模板平滑原图像后的结果，图11.5(c)是采用Otsu算法得到的全局阈值对该
图像进行阈值处理后的结果。注意，区域数量已减少到两个(其中一个区域是一个点),从而大大地简化
了该问题。
aei
图11.5(a)带噪声图像；(b)使用一个大小为9×9的均值模板平滑图像后的结果；(c)使
用Osu算法对平滑图像进行阈值处理后的结果；(d)图(c)的最长外部边界；(e)子
采样边界(为清楚起见，点已被放大);(1使用直线连接图(e)中的点后的结果
图11.5(d)是图11.5(c)中最大区域的外边界。直接获得该边界的链码会生成一个变化较小的较长序列，
且不能表示该边界的形状。如本节之前提到的那样，为降低可变性，在得到其边界的链码前，通常需要
对该边界重取样。图11.5(e)是以节点间距为50个像素(约为图像宽度的10???网格对边界重取样后的结
果，图11.5(①是使用直线连接所得顶点后的结果。这一简单近似保留了原始边界的主要特征。
简化后的边界的8方向佛雷曼链码是
00006066666666444444242222202202
该边界的起始点位于子取样网格中的坐标(2,5)处。这是图11.5①中的左上角点。这种情形下，该链
码的最小值整数刚好与如下链码的最小值整数相同： 皮;
822 824
518 数字图像处理(第三版)
00006066666666444444242222202202
两个链码的一次差分均为
00062600000006000006260000620626
使用这两种链码之一表示边界时，可有效地减少用于存储该边界的数据量。此外，如我们在11.2节
中讨论的那样，使用码数可提供一种统一的方法来分析边界的形状。最后，记住子采样边界可以由上述
链码之一来恢复。
11.1.3 使用最小周长多边形的多边形近似
数字边界可以用多边形以任意精度来近似。对于一条闭合边界，当多边形的边数等于边界上的
点数时，这种近似会变得很精确，此时，每对相邻的点定义了多边形的一条边。多边形近似的目的是
使用尽可能少的线段数来获取给定边界的基本形状。通常，该问题并不容易求解，且求解过程会转化
为耗时的迭代搜索。然而，适度复杂的多边形近似技术还是很适合于图像处理任务。在这些近似技术
中，最有力的一种技术是使用最小周长多边形(MPP)来表示边界，详见如下讨论中的定义。
基础
产生计算MPP的算法的一种直观方法是，用图11.6(b)那样的一组连接单元的集合封入图11.6(a)
中的一条边界。我们可以将该边界想象为一个橡皮条。当允许橡皮条收缩时，橡皮条会受到由这些单
元定义的边界区域的内、外墙的约束。最终，该收缩会产生一个(关于这种几何排列的)最小周长的多
边形，它被限制在用单元条封闭的区域内，如图11.6(c)所示。注意，在该图中，所有MPP的顶点与
内墙或外墙的角点一致。
a b c
图11.6(a)一个物体的边界(黑色曲线);(b)由(灰色)单元围成的边界；(c)允许边界
收缩得到的最小周长多边形。多边形的顶点是灰色区域的内墙角点和外墙角点
单元的大小决定着多边形近似的精度。在极限情况下，如果每个(方形)单元的大小对应于边界
上的一个像素，则边界和MPP近似值之间的每个单元中的误差至多为√2d,其中d是像素间的最小可
能距离(即由原始取样边界的分辨率决定的像素间的距离)。通过强迫多边形近似中的每个单元的中心
为原始边界上的对应像素，可以将该误差减半。在一个给定应用中，我们的目的是使用合适的最大可
能单元大小，以最少的顶点数来产生MPP。在这一节中，我们的目的是阐明寻找这些MPP顶点的过程。
刚才讨论的单元方法将由原始边界包围的物体的形状简化为图 11.6(b)中由灰墙围成的区域。
图11.7(a)将这一形状显示为暗灰色。我们看到，其边界由4连接的直线段组成。假设我们按顺时针
方向追踪这条边界，追踪时遇到的每个转向要么是一个凸顶点，要么是一个凹顶点，其中顶点的角是4
连接边界的内角。凸顶点和凹顶点在图11.7(b)中分别显示为白点和黑点。注意，这些顶点是图11.7(b)
第11章 表示和描述 519
中浅灰色边界区域的内墙的顶点，暗灰色区域中的每个凹顶点(黑点)
在浅灰色墙中有一个对应的“镜像”顶点，镜像顶点位于这个凹顶点
的对角处。图11.7(c)显示了所有凹顶点的镜像顶点，为方便参考，图
中叠加了图11.6(c)中的MPP。我们看到，MPP的顶点要么与内墙中
的凸顶点(白点)一致，要么与外墙中的凹顶点的镜像顶点(黑点)一
致。稍加思考就会发现，只有内墙的凸顶点和外墙的凹顶点才能成为
MPP的顶点。因此，我们的算法就只需要关注这些顶点。
a b c
图11.7(a)由单元围成的原始边界(见图11.6)得到的区域(暗灰色);(b)按逆时针方向追踪暗灰色
区域的边界得到的凸顶点(白点)和凹顶点(黑点);(c)移到边界区域的外墙中对角镜像位
置的凸顶点(黑点),凹顶点保持不变。为便于参考，图像中叠加了MPP(黑色边界)
MPP算法
前一段描述的围成一条数字边界的单元集合称为单元组合体。我们假设所考虑的边界本身不相
交，这将产生简单连接的单元组合体。基于这些假设，并令W(白)和B(黑)分别表示凸顶点和镜像凹
顶点，我们将观察结果说明如下：
1.由简单连接的单元组合体为界的MPP是非自相交的。
2.MPP的每个凸顶点都是一个W顶点，但并非边界的每个W顶点都是MPP的一个顶点。
3.MPP的每个镜像凹顶点都是一个B顶点，但并非边界的每个B顶点都是MPP的一个顶点。
4.所有的B顶点要么在MPP上，要么在MPP外；所有的W顶点要么在MPP上，要么在
MPP内。
5.单元组合体中包含的顶点序列的最左上角顶点，总是MPP的一个W顶点。
这些断言可被正式证明(Sklansky et al.[1972],Sloboda et al.[1998]和Klette and Rosenfeld[2004)。
然而，它们的正确性对于我们的目的来说非常明显(见图11.7),所以，此处对它们的证明不再赘述。
与图11.7中暗灰色区域的顶点的角度不同的是MPP顶点维持不变的角度不必是90°的倍数。
在下面的讨论中，我们需要计算点的三元组的方向。考虑点的三元组(a,b,c),并令这些点的坐
标为a=(x?,y?),b=(x?,y?)和c=(x?,y?)。如果我们以矩阵的行来安排这些点，
凸顶点是一组三个点的中心点。
它定义了范围0°<θ<180°内的一
个角。类似地，凹顶点定义了范围
180°<θ<360°内的一个角。180°
角定义了一个退化顶点(一条直线)
退化顶点不可能是一个MMP顶点。
0°或360°角涉及折回一条路径。
在本讨论中这是一个无效的条件。
(11.1-1)
则由基本矩阵分析有 825
心器
520 数字图像处理(第三版)
如果(a,b,c)是一个逆时针序列 u- 如果点是共线的
如果(a,b,c)是一个顺时针序列
(11.1-2)
其中det(A)是A的行列式。根据这个公式，逆时针或顺时针方向运动
与右手坐标系有关(见2.4.2 节的脚注)。例如，使用该图像坐标系(见
图2.18),原点位于左上角，x轴的正方向垂直向下延伸，y轴的正方
向水平向右延伸，序列a=(3,4),b=(2,3)和c=(3,2)是逆时针方向，
并且在代人式(11.1-2)中时有det(A)>0。故定义
sgn(a,b,c)=det(A)
假设使用图 2.18(b)中定义的坐标
系，当按逆时针方向追踪一个多边
形的边界时，追踪方向右侧的所有
点位于多边形的外部，追踪方向左
侧的所有点位于多边形的内部。
(11.1-3)
来描述该算法在符号表示上是很方便的，其中，对于逆时针序列有sgn(a,b,c)>0,对于顺时针序列有sgn(a,
b,c)<0,当点共线时有sgn(a,b,c)=0。在几何上，sgn(a,b,c)>0表明点c位于线对(a,b)的正侧(即c
位于通过点a和b的直线的正侧)。如果sgn(a,b,c)<0,则点c位于该直线的负侧。如果使用序列(c,a,b)
或(b,c,a),那么式(11.1-2)和式(11.1-3)可给出相同的结果，因为在序列中追踪的方向与(a,b,c)的方向
相同。然而，几何上的解释是不同的。例如，sgn(c,a,b)>0表明点b位于通过点c和a的直线的正侧。
为了给MPP算法准备数据，我们形成一个列表，该列表中的行是每一个顶点的坐标和一个表示
顶点是W顶点还是B顶点的附加元素。如图11.7(c)所示，凹顶点被镜像为按顺序排列的顶点很重要，
第一个顶点是左上角的顶点，由性质5可知它是MPP的W顶点。令V。表示这个顶点。我们假设顶
点按逆时针方向排列。寻找MPP的算法使用两个“爬行”点：一个白色的爬行点(Wc)和一个黑色的
爬行点(Bc)。Wc沿凸顶点(W爬行，Bc沿镜像凹顶点(B)爬行。这两个爬行点、找到的最后一个MPP
顶点和正被考察的顶点都是实现该过程所必要的顶点。
算法首先令Wc=Bc=V。(回忆一下，V?是一个MPP顶点)。然后，在算法的任何步骤中，令
V?表示找到的最后一个MPP顶点，令V表示正在考察的当前顶点。在V?.V.和两个爬行点之间存在
如下三个条件之一：
(a)V位于通过(V,Wc)的直线的正的一侧，即sgn(V?.Wc,V)>0。
(b)V位于通过(V?,Wc)的直线的负的一侧，或者V与(V?.Wc)共线，即sgn(V?.Wc.V)≤0。
同时，v位于通过(V?,Bc)的直线的正的一侧，或者V与(V?.Bc)共线，即
sgn(V?,Bc,V)≥0。
(c)V.位于通过(V?.B.)的直线的负的一侧，即sgn(V?,Bc,V)<0。
如果条件(a)成立，则下一个MPP 顶点是Wc,并且我们令Vz=Wc;然后，我们令Wc=Bc=V?
来重新初始化该算法，并在V?之后的下一个顶点继续执行算法。
如果条件(b)成立，则V变成一个候选的MPP 顶点。在这种情形下，如果V是凸顶点(即一个
W顶点),则令Wc=V;否则，我们置Bc=V。然后，我们使用列表中的下一个顶点继续执行算法。
如果条件(c)成立，则下一个MPP 顶点是Bc,并且令V=Bc;然后，我们令Wc=Bc=V?来
重新初始化该算法，并用V?之后的下一个顶点继续执行算法。
当算法再次到达第一个顶点时，算法结束，此时算法已处理了多边形中的所有顶点。算法找到
的V?顶点是MPP的顶点。业已证明，该算法可找到一个被简单连接的单元组合体围成的多边形的所
有MPP顶点(Sloboda et al.[1998], Klette and Rosenfeld[2004])。
①一个边界的顶点可按算法追踪边界的方向排序，例如，使用11.1.1节中描述的算法来追踪边界。
第11章 表示和描述 521
例11.2 MPP算法示例。
一个手算例子有助于阐明前面的概念。考虑图11.7(c)中的顶点。在我们的图像坐标系中，网格左上
角的点的坐标是(0,0)。假设网格间距为1,则(逆时针)顶点列表中的前几行为
W V? (1,4)
V?(2,3) B
V?(3,3)W
V? (3,2) B
V? (4,1) W
V? (7,1)W
V? (8,2) B
V?(9,2)B
列表的第一个元素总是我们的第一个MPP,因此首先令Wc=Bc=V?=V?=(1,4)。下一个顶点是
V=(2,3)。由符号函数计算得sgn(V?,Wc,V)=0和sgn(V?,Bc.V?)=0,因此，条件(b)成立。因为V,是
一个B(凹)顶点，我们令Bc=V?=(2,3)。Wc保持不变。在这一阶段，爬行点Wc位于(1,4)处，爬行点
Bc位于(2,3)处，而V?仍位于(1,4)处，因为未找到新的MPP顶点。
下面，我们来考虑V?=(3,3)。符号函数的值是sgn(V?Wc,V?)=0和sgn(V?,Bc,V?)=1,所以算法的
条件(b)再次成立。因为V?是一个W(凸)顶点，我们令Wc=V?=(3,3)。在这一阶段，爬行点位于
Wc=(3,3)和Bc=(2,3)处；V?保持不变。
下一个顶点是V?=(3,2)。符号函数的值是sgn(V?,Wc,V?)=-2和sgn(V?,Bc,V?)=0,因此条件(b)
再次成立。因为V?是一个B顶点，我们将黑色爬行点更新为Bc=(3,2)。爬行点Wc保持不变，V?保持
不变。
下一个顶点是V?=(4,1),且有sgn(V?,Wc,V?)=-3和sgn(V,Bc,V?)=0,因此条件(b)再次成立。因
为V?是一个白色顶点，我们将白色爬行点更新为Wc=(4,1)。黑色爬行点Bc保持在(3,2)处，V?仍位于
(1,4)处。
下一个顶点是V?=(7,1),且sgn(V?,Wc,Vs)=9,因此条件(a)成立，我们令V?=Wc=(4,1)。因为找
到了一个新的MPP顶点，因此我们令Wc=Bc=V?来重新初始化算法，并使用新近找到的V?后的下一个
顶点开始算法。下一个顶点是V?,所以我们再次访问它。
使用V?=(7,1)和V?,Wc,Bc的新值，我们得到sgn(V?,Wc,Vs)=0和sgn(V?,Bc,V?)=0,故条件(b)
成立。因此，我们令Wc=V?=(7,1),因为V?是一个W顶点。
下一个顶点是V?=(8,2),且sgn(V?,Wc,V?)=3,所以条件(a)成立。这样，我们令V?=Wc=(7,1),
并通过令Wc=Bc=V,来重新初始化算法。
因为在(7,1)处重新初始化，故下一个要考虑的顶点再次为V?=(8,2)。按上面的方法继续处理该顶点
及剩下的顶点，可得到图11.7(c)中的MPP顶点。如早些时候提到的那样，位于(2,3)处和(3,2)处及位于(13.
10)处右下方的镜像B顶点是共线的，尽管它们位于MPP的边界上，但不能视为MPP的顶点。这是合适
的，算法的确没有这样检测它们。
例11.3 MPP算法的应用。
图11.8(a)是一幅大小为566×566的枫叶的二值图像，图11.8(b)是其8连接边界。图11.8(c)到(e)中
的序列图像显示了该边界使用大小分别为2,3,4,6,8,16和32的方形单元组合体的MPP表示(每幅图中
的顶点都用直线连接起来形成一个闭合的边界)。枫叶有两个主要特征：茎和三个主要的圆裂片。如图11.8f)
所示，当单元尺寸大于4×4时，茎开始消失。而即使是对于大小为16x16 的单元尺寸，仍完好地保留了
827
828
曾：貌
522 数字图像处理(第三版)
三个主要的圆裂片，如图11.8(h)所示。然而，在图11.8(i)中，我们看到当单元尺寸增大到32×32时，这
一明显的特征也几乎消失了。
原始边界[见图11.8(b)]中的点数是1900。图11.8(c)到(i)中的顶点数分别是206,160,127,92,66,32
和13。尽管将数据量降低了90??上，但有127个顶点的图11.8(e)仍保留了原始边界的所有主要特征，。
由此我们可以看出使用MPP来表示边界的明显优势。MPP的另一个优点是可以进行边界平滑。如前节中
解释的那样，当我们使用链码来表示一条边界时，这是一种通常的需求。
图11.8(a)大小为566×566的二值图像；(b)8连接边界；(c)-(i)使用大小分别为2,3,4,6,8,16
和32的方形单元得到的MPP(为显示方便，用直线将这些顶点连接起来)。图(b)中边
界的顶点数量为1900。图(c)到图(i)中的顶点数量分别为206,160,127,92,66,32和13
11.1.4 其他多边形近似方法
有时，可以用概念上比前节中讨论的MPP算法更简单的方法来进行多边形近似。在这一节中，
我们讨论两种这样的方法。
聚合技术
基于平均误差或其他准则的聚合技术已应用于多边形近似问题。一种方法是沿一条边界来聚合
一些点，直到拟合这些聚合点的直线的最小均方误差超过一个预设的阈值。当这种条件出现时，存储
该直线的参数，将误差设为零，并且重复该过程，沿边界聚合新的点，直到该误差再次超过预设的阈
值。这一过程结束后，相邻线段的交点就构成多边形的顶点。这种方法的主要难点之一是得到的近
似顶点并不总是对应于原始边界中的形变(如拐角),因为在误差超过阈值前，不会开始画一条新的
直线。例如，如果沿着一条长的直线追踪，且遇到了一个拐角，那么通过该拐角的许多点(取决于
阈值)在误差超过阈值前将被丢弃。然而，(下面讨论的)随同聚合技术一起的分裂技术可用于缓解
这一困难。
第11章 表示和描述 523
分裂技术
分裂边界线段的一种方法是将线段不断地细分为两部分，直到满足规定的准则为止。例如，一
个要求可能是：一条边界线段到连接其两个端点的直线间的最大垂直距离不超过一个预设的阈值。如
果准则满足，则与直线有着最大距离的点就成为一个顶点，这样就将初始线段分成了两条子线段。这
种方法在寻找变化显著的点时具有优势。对一条闭合边界，最好的起始点通常是边界上的两个最远点。
例如，图11.9(a)显示了一个物体的边界，图11.9(b)显示了该边界关于其最远点的细分。标记为c的
点是顶部边界线段到直线ab的(垂直距离)最远的点。类似地，点d是底部线段上的最远点。图11.9(c)显
示了使用分裂过程后的结果，所用阈值为直线ab的长度的0.25倍。由于新边界线段上没有(到其对
应的直线段的)垂直距离超过该阈值的点，故该过程终止于图11.9(d)中的多边形。
a b cd a
d >b
“
a
c
d b d b
图11.9(a)原始边界；(b)边界被分割为基于端点的线段；(c)顶点连接；(d)得到的多边形
11.1.5 标记图
标记图是边界的一维函数表示，它可以使用各种方式来生成。一种最简单的方法是以角度的函
数的形式画出质心到边界的距离，如图11.10所示。然而，不管如何生成标记图，基本概念都是将边
界表示简化为描述起来可能比原始二维边界更简单的一维函数。
a b
-A- A r(0) r(0)
V2A
A A
0
4 2 π 2m 0 4 π2 π 4 2π
0
图11.10 距离与角度标记图。在图(a)中，θ)为常量。在图(b)中，标记图由重复
出现的模式rθ)=Asec 0.0≤θ≤w/4和rθ)=Acsc θ,π/4<θ≤π/2构成 固;
尚
524 数字图像处理(第三版)
由刚才描述的方法所生成的标记图是平移不变的，但它们的确取决于旋转和缩放。通过寻找一
种选取相同起始点来生成标记图的方法，可实现关于旋转的归一化，而不用考虑形状的方向。这样做
的一种方法是将距质心最远的点选为起始点，假设该点对于我们感兴趣的每个形状而言都是唯一的。
另一种方法是在本征轴上选取(见11.4节)距质心最远的点。这种方法的计算量更大，但更为稳定，
因为本征轴的方向是使用所有轮廓点确定的。当然，还有一种方法是获得该边界的链码，然后使用
11.1.2节中讨论的方法，假定得到的编码足够粗糙，以至于旋转不会影响到它的曲率。
基于关于两个轴缩放一致且以等间隔θ取样的假设，形态大小的变化会导致相应标记图的幅值变
化。对此进行归一化的一种方法是对所有函数进行缩放，以便它们具有相同的值域，譬如[0,1]。这
种方法的主要优点是简单，但也有潜在的严重缺陷，即对整个函数的缩放只依赖于两个值：最小值和
最大值。如果形状带有噪声，那么这种依赖性会成为各个物体的误差来源。一种更为稳定(但计算量
更大)的方法是，将每个样本除以标记图的方差，假设该方差不为零[就像图11.10(a)中的情形那样]
或该方差不会小到造成计算困难。使用方差会产生一个可变缩放因子，该因子与尺寸变化成反比，工
作起来与自动增益控制非常相像。记住，无论使用什么方法，基本思想都是消除对尺寸的依赖性，同
时保持波形的基本形状。
a b c d ef
图11.11 两个二值区域，它们的外部边界及相应的r(θ)标记。图(e)和
图(f中的水平轴对应于从0°到360°之间的角度，角度增量为1°
距离与角度并不是生成标记图的唯一方法。例如，另一种方法是，沿边界行进，并对应于边界
上的每个点，画出边界线在这一点的切线和参考线之间的角度。得到的标记图尽管不同于图11.10中
的r(θ)曲线，但却携带有关于基本形状特征的信息。例如，曲线中的水平线段将对应于沿该边界的直
线，因为此处正切角为常数。这种方法的一种变形是用所谓的斜率密度函数作为标记图。该函数是正
切角值的直方图。由于直方图是值的密集程度的度量，故斜率密度函数强烈地反应了具有恒定正切角
的边界部分(直线段或近似直线段),且在角度快速变化的部分(拐角或其他急剧弯曲位置)存在较深的
波谷。
例11.4 两个简单物体的标记图。
图11.11(a)和(b)显示了两个二值物体，图11.11(c)和(d)是它们的边界。图11.11(e)和(f中相应的r(θ)
标记图以1°增量在0°到360°的范围内变化。标记图中突出峰值的数量足以区分两个物体的形状。
第11章 表示和描述 525
11.1.6 边界线段
将边界分解为线段通常是有很用的。分解降低了边界的复杂性，从而简化了描述过程。当边界
线包含一个或多个携带形状信息的明显凹度时，这种方法尤其有吸引力。此时，使用由边界所围成区
域的凸壳就成为边界鲁棒分解的有力工具。
如9.5.4节中定义的那样，一个任意集合S的凸壳H是包含S的最小凸集。集合之差H-S称为
集合S的凸缺D。为了解如何使用这些概念来把边界分成有意义的线段，考虑图11.12(a),图中显示了
一个物体(集合S)和它的凸缺(阴影区)。区域边界可以按如下方式来分割：追踪S的轮廓，并标记进
入或离开一个凸缺的转变点。图11.12(b)显示了这种情况下的结果。注意，在原理上，这种方案与区
域大小和方向无关。
a b
S
图11.12(a)区域S及其凸缺(阴影区域);(b)被分割的边界
实际上，由于数字化、噪声和分割的变形的影响，数字边界往往是不规则的。这些影响通常会
导致在整个边界上有着随机散布的无意义小的凸缺。与其试图通过后处理分出这些不规则边界，不如
在对边界分割前用通常的方法平滑边界。有很多方法可以做到这一点。一种方法是追踪边界，并使用
一个像素沿该边界的k个相邻像素的平均坐标代替这个像素的坐标。这种方法适用于较小的不规则边
界，但它耗费时间并且难于控制。较大的k值会导致过度平滑，而较小的k值在某些边界线段可能会
使平滑不够充分。一种更为稳定的技术是在找到一个区域的凸缺前，先使用多边形近似。我们感兴趣
的多数数字边界都是简单的多边形(回忆 11.1.3节可知，这些多边形都不是自交叉的)。Graham and
Yao[1983]给出了一个查找此类多边形的凸壳的算法。
凸壳及其凸缺的概念对于描述整个区域及其边界同样是有用的。例如，描述一个区域可以基于
该区域的面积及其凸缺的面积、凸缺中的分量数、这些分量的相对位置等。请回顾9.5.4节中给出的
一种寻找凸壳的形态学算法。本章末尾给出的参考文献包含有其他表述。
11.1.7 骨架
表示一个平面区域的结构形状的一种重要方法是将它简化为图形。这种简化可以通过一种细化
(也称为骨架化)算法得到该区域的骨架来实现。在大范围的图像处理问题中，细化过程起着核心作用，
从印制电路板的自动检测到空气过滤器中的石棉纤维的计数。我们在9.5.7节中已经讨论过使用形态
学来骨架化的基础知识。然而，如那一节中解释的那样，所讨论的过程对保持骨架连接未做规定。这
里给出的算法可纠正这一问题。
一个区域的骨架可以用Blum[1967]提出的中轴变换(MAT)来定义。边界为B的区域R的MAT
如下所示。对R中的每个点p,我们在B中找到与其最接近的邻点。如果p有多个这样的邻点，则认
为p属于R的中轴(骨架)。“最接近”(及得到的MAT)这一概念取决于距离的定义(见2.5.3节)。
图11.13显示了使用欧氏距离的一些例子。使用9.5.7节中的最大圆盘可得到相同的结果。 :至
526 数字图像处理(第三版)
a bc
图11.13 三个简单区域的中轴(虚线)
区域的MAT有一个直观的定义，该定义基于所谓的“草原之火概念”。我们将一个图像区域想
象为由干草组成的平坦大草原，且假设沿草原边界点火。火的前线以相同的速度向区域中心推进。该
区域的MAT是同一时间多个火线到达点的集合。
尽管一个区域的MAT会生成直觉上令人满意的骨架，但直接实现这一定义需要大量的计算。实现潜
在地涉及计算每个内部点到一个区域边界上的每个点的距离。为改善计算效率，同时试图产生一个区域
的中轴的表示，提出了许多算法。典型地，这些算法是迭代删除一个区域的边界点的细化算法，删除这
些点时要服从如下约束条件：(1)不能删除端点，(2)不能破坏连接性，.(3)不能导致区域的过度腐蚀。
在这一节中，我们给出细化二值区域的一种算法。假设区域点的值为1,背景点的值为0。这种
方法是对给定区域的边界点连续应用两个基本步骤，这里，基于2.5.2节中给出的定义，边界点是值
为1且至少有一个相邻像素的值为0的像素。参考图11.14中的8邻域表示，如果满足如下条件，则
步骤1将一个轮廓点p,标为要删除的点：
(a)2≤N(p?)≤6
(b)Tp?)=1
(C)P?·PA·P?=0
(d)pa·P?·P?=0 (11.1-4)
其中，N(p)是p的非零相邻像素数量，即
N(p?)=P?+P?+…+P?+p? (11.1-5)
其中，p,要么为0,要么为1,而T(p?)是排序序列P,P…,Ps,P,p?中从0到1转换的次数。例如。
在图11.15中，有N(p?)=4和T(p?)=3。
图：夏
P P? Ps
Ps P? Pa
P7 P6 Ps
0 0 1
1 P? 0
01 1
图11.14 细化算法所用的邻域像素排列
图 11.15 式(11.1-4)中条件(a)和(b)的说
明。此时，Np)=4且T(p)=3
在步骤2中，条件(a)和(b)保持不变，但条件(c)和(d)变为
(c')p?·Pa·P=0
(d')p?·P?·Ps=0 (11.1-6)
第11章 表示和描述 527
把步骤1用于所考虑二值区域的每个边界像素。如果违反了条件(a)到(d)中的一个或多个，则所
讨论点的值不变。如果满足所有的条件，则将该点标记为删除点，但该点要等到处理完所有边界点后
才能删除。这种延迟防止在算法执行期间对数据结构的更改。在对所有的边界点应用步骤1后，删除
已做过标记的点(改为0值)。然后，按与步骤1完全相同的方式，对所得结果应用步骤2。
这样，细化算法的一次迭代由如下步骤组成：(1)应用步骤1,标记将被删除的边界点；(2)删除
做了标记的点；(3)应用步骤2来标记将被删除的剩余的边界点；(4)删除标记过的点。反复应用这个
基本过程，直到再也没有被删除的点为止，此时算法终止，生成了该区域的骨架。
当轮廓点p,仅有1个或7个值为1的邻域点时，就违反了条件(a)。仅有一个这样的邻点意味着
p?是一个骨架笔画的端点，显然不能删除这个点。如果p?有7个这样的邻点，则删除p,会对该区域产
生腐蚀。当对宽度为1个像素的笔画上的点应用这种方法时，就违反了条件(b)。因此，该条件在细化
操作期间就防止了骨架线段的断裂。值的最小集合(p?=0或p=0)或(p?=0和pg=0)同时满足条件(c)
和(d)。这样，参考图 11.14中的邻域排列，满足这些条件及条件(a)和(b)的点，就是边界中的一个东
边界点或南边界点，或边界中西北角的点。无论哪种情况，p,都不是骨架的一部分，应被删除。类似地，
下列值的最小集合(p?=0或p=0)或(p?=0和p?=0)同时满足条件(c)和(d),它们对应于北边界点或
西边界点，或一个东南角点。注意，东北角点有p?=0和p?=0,既满足条件(c)和(d),也满足条件(c)
和(d)。对于西南角点有p?=0和p=0,故也满足前述条件。
例11.5 一个区域的骨架。
图11.16显示了人腿骨的一幅分割图像，并叠加了该区域的骨架。在很
大程度上，该骨架直观上看起来是正确的。在骨头的右“肩”处有两个分
支，乍看之下，与左侧相对应，我们认为此处应只有一个分支。但要注意
的是，(在长方向上)右肩要比左肩稍宽，这就是算法产生两个分支的原因。
在骨架处理算法中，这种不可预测的行为很常见。
11.2 边界描绘子 图 11.16 人腿骨和叠加在所
示区域上的骨架
本节我们考虑几种描绘区域边界的方法，在11.3节，我们重点关注区域描绘子。11.4节和 11.5
节中的部分内容既适用于边界也适用于区域。
11.2.1 一些简单的描绘子
边界的长度是其最简单的描绘子之一。一条边界上的像素数量可以给出其长度的粗略近似。对
于在两个方向上以单位间距定义的链码曲线，垂直分量和水平分量的数量加上对角分量的√2倍，可
给出曲线的准确长度。
边界B的直径定义为
Diam(B)=max[D(p,p,) (11.2-1)
式中，D是一种距离度量(见2.5.3节),p,和p,是边界上的点。直径的值和连接组成该直径的两个端
点的直线段(该直线称为边界的长轴)的方向是边界的有用描绘子。边界的短轴定义为与长轴垂直的直
线。由边界与两个轴相交的4个外部点所组成的方框这样的长度①,可以完全包围该边界。刚刚描述
的这个方框称为基本矩形，长轴与短轴之比称为边界的偏心率。偏心率也是一个有用的描绘子。
曲率定义为斜率的变化率。一般来说，获得数字边界上某个点处曲率的可靠度量较为困难，因
①不要将长轴和短轴与114节中定义的本征轴混淆。 图圈
837
528 数字图像处理(第三版)
为这些边界往往都是局部“粗糙的”。然而，有时使用相邻边界线段的斜率差作为这两条线段交点处
曲率的描绘子，被证明是有用的。例如，图11.6(c)所示边界的顶点本身也可以借用来很好地描述曲
率。当在边界上顺时针方向移动时，如果在点p处的斜率变化非负时，则称顶点p是凸线段的一部分；
否则，称p属于凹线段。通过使用斜率变化范围，可以进一步精确一个点处的曲率。例如，如果斜率
变化小于10°,则认为p是一条近似直线线段的一部分；如果斜率变化超过90°,则认为p是一个角
点。必须小心使用这些描绘子，因为它们的解释取决于单条线段相对于整个边界的长度。
11.2.2 形状数
如 11.1.2 节中解释的那样，链码边界的一次差分取决于起始点。一条基于图11.3(a)所示四方向
编码的边界的形状数，定义为最小量级的一次差分。形状数的阶n定义为其表示的数字个数。此外，
对于闭合边界，n为偶数，其值限制了不同形状的数量。图11.17显示了阶为4,6,8的所有形状，以
及它们的链码表示、一次差分和相应的形状数。注意，一次差分是通过将链码作为循环序列来计算得
到的，就像11.1.2节中讨论的那样。尽管链码的一次差分与旋转无关，但总体而言，已编码的边界取
决于网格的方向。归一化网格方向的一种方法是用前一节中定义的基本矩形的边对准链码网格。
阶4 阶6
链码：0321 003221
差分：3333 303303
形状编号：3333 033033
阶8
链码：0033221103032211 00032221
差分：30303030 33133030 30033003
形状编号：03030303 03033133 00330033
图11.17 阶为4,6和8的所有形状。方向来自于图11.3(a),黑点表示起始点
实际上，对于一个期望的形状的阶，我们要找到阶为n的矩形，该矩形的偏心率(见前节的定义)
最接近基本矩形，并使用这个新矩形来建立网格尺寸。例如，如果n=12,则阶为12的所有矩形(即
周长为12的矩形)是2×4,3×3和1×5。如果2×4矩形的偏心率最匹配一个给定边界的基本矩形的偏心
率，那么我们以这个基本矩形为中心建立一个2×4网格，并使用11.1.2节中给出的过程来得到链码。
形状数是根据该编码的一次差分得出的。尽管选取网格间距的方式通常会使得形状数的阶等于 n.但
低于该间距的边界有时会产生阶大于n的形状数。此时，我们指定阶数小于n的一个矩形，并且重复
该过程，直到所得形状数的阶为n。
例11.6 计算形状数。
假设图11.18(a)中的边界指定的阶为n=18。为得到该阶数的形状数，我们需要按照刚才讨论的下列
步骤来操作。第一步是找到基本矩形，如图11.18(b)所示。阶为18的最接近矩形为3×6矩形，这时要求
按图11.18(c)那样细分该基本矩形，其中链码方向与所得到的网格对齐。最后一步是得到链码，并使用该
链码的一次差分来计算形状数，如图11.18(d)所示。
第11章 表示和描述 529
a bc d
链码：000030032232221211
差分：300031033.01300313.0
形状编号：000310330130031303
图11.18 生成形状数的步骤
11.2.3 傅里叶描绘子
图11.19显示了xy平面内的一个K点数字边界。从任意点(x?,yo)开始，以逆时针方向在该边界上
行进时，会遇到坐标对(x,y),(x?,y,),(x?,y?),…,(xe- yx-)。这些坐标可以表示为x(k)=x,y(k)=y
的形式。使用这种表示法，边界本身可以表示为坐标序列s(k)=[x(k),y(k)],k=0,1,2,…,K-1。此外，
每个坐标对可当做一个复数来处理，即 jy
s(k)=x(k)+jy(k) (11.2-2)
其中k=0,1,2,…,K-1。也就是说，x轴为复数序列的实
轴，y轴为复数序列的虚轴。尽管对该序列的解释是全新的，
但边界本身的性质并未改变。当然，这种表示方法的一大
优点是它将二维问题简化成了一维问题。
虚轴
由式(4.4-6)可知，s(k)的离散傅里叶变换(DFT)为
u)=2ue Pa/k (11.2-3) Xnx? x
实轴
式中u=0.1,2,…,K-1。复系数a(u)称为边界的傅里叶描 图11.19 一条数字边界及其复序列表示。
所示点(?,y。)和点(x,y,)是序 绘子。这些系数的傅里叶反变换可恢复s(k)。也就是说，由
列中(任意选择)的前两个点 式(4.4-7)有
)=卡aue (11.2-4)
式中，k=0,1,2,…,K-1。然而，假设仅使用前P个傅里叶系数而不使用所有的系数。这等同于在
式(11.2-4)中令au)=0,u>P-1。结果为s(k)的如下近似：
)=卡LaueP (11.2-5)
式中，k=0,1,2,…,K-1。尽管求S(k)的每个分量时仅使用了P项，但k的范围仍是从0到K-1。
也就是说，在近似边界中存在同样数量的点，但项数不像在每个点的重建中那样多。回顾第4章中关
于傅里叶变换的讨论可知，高频分量说明精细细节，而低频分量决定全局形状。因此，P越小，边界
丢失的细节就越多，如下例所示。 圈;黑
841
530 数字图像处理(第三版)
例11.7 使用傅里叶描绘子。
图 11.20(a)显示了一个人的染色体的边界，该边界由2868 个点组成。对该边界使用式(11.2-3)得到了相
应的2868个傅里叶描绘子。本例的目的是检验以减少傅里叶描绘子的数量为基础重建边界的效果。图11.20(b)
显示了使用2868个描绘子的一半来重建的边界。有趣的是，我们注意到，该边界与原始边界之间并无明显的
不同。图11.20(c)到(h)显示了分别使用2868个傅里叶描绘子的10??.5?.25?.63?0.28??建的
边界。这些百分比分别近似等于286,144,72,36,18和8个描绘子，注意这些数字已近似为最接近的偶整数。
这里的重点是18个描绘子，约为原来2868个描绘子的百分之一的6/10,就有效地保持了原始边界的主要形
状特征：4个较长的突出部分和2个较深的弯曲部分。图11.20(h)是使用8个描绘子得到的不可接受的结果，
因为丧失了主要特征。描绘子进一步减少到4个和2个，将分别导致一个椭圆和一个圆(见习题11.13)。
如前例所示的那样，少数的傅里叶描绘子就可用于捕获边界的大体特征。这一性质很有用，因为
这些系数携带有形状信息。因此，这些描绘子可用做区分不同边界形状的基础，正如我们在第12章中
讨论的那样。
我们已多次声明，描绘子应尽可能对平移、旋转和尺度变化不敏感。此时，结果将取决于点被
处理的顺序，故另一个约束条件是，描绘子对起始点应不敏感。傅里叶描绘子并非直接对这些几何变
化不敏感，但这些参数的变化可能与描绘子的简单变换是相关的。例如，考虑旋转变换，且回忆可知，
基本数学分析中关于复平面的原点将一个点旋转θ角是通过乘以因子e1来实现的。对S(k)的每个点
这样做，就关于原点旋转了整个序列。旋转后的序列为s(k)e3,其傅里叶描绘子为
,u)=2s)e”cD/=adue° (11.2-6)
式中，u=0.1,2,…,K-1。因此，旋转变换仅通过乘以一个常数项e,就等同地影响了所有的系数。
a bc d efg h
图11.20 (a)人的染色体的边界(2868个点);(b)-(h)分别使用1434,286,144,72,36,18和8个傅里叶描
绘子重建的边界。这些数字分别近似为2868个点的50?0??.5?.25?.63?0.28%
表11.1总结了经历旋转、平移、尺度和起始点变化的边界序列S(k)的傅里叶描绘子。符号△。定
义为△=Ax+jAy,所以符号s,(k)=s(k)+△,将该序列重定义(平移)为
S,(k)=[x(k)+△x]+j[y(k)+△y] (11.2-7)
换句话说，平移是对边界上的所有坐标添加一个常数位移。注意，除了u=0时变为冲激函数δu)?
①回忆第4章可知，常数的傅里叶变换是一个位于原点的冲激，且该冲激处处为零
第11章 表示和描述 531
外，平移变换对描绘子无影响。最后，表达式s,(k)=s(k-k?)意味着将序列重新定义为
sp=x(k-k?)+jy(k-k?) (11.2-8)
它仅将序列的起始点从k=0更改为k=k?。表11.1中的最后一项表明，起始点的变化会以不同(但已
知)的方式影响到所有的描绘子，在该意义上说，乘项a(u)取决于u。
表11.1 傅里叶描绘子的一些基本性质
变 换 边 界
s(k)
srk)=ske"
stk)=s(k)+A。
ss(k)=as(k)
sp(k)=s(k-k)
傅里叶描绘子
恒等 a(u)
旋转 ar(u)=a(u)e
平移 aru)=au)+A,8(m)
缩放 as(u)=au(u)
起始点 ap()=atu)e/
11.2.4 统计矩
边界线段(和标记图波形)的形状可使用统计矩来定量描述，如均值、方差和高阶矩。为了解如
何实现这种定量描述，考虑图11.21(a),它显示了一段边界，而图11.21(b)显示了以任意变量r的一
维函数g(r)描述的线段。该函数是这样获得的：先将该线段的两个端
点连接起来，然后旋转该直线线段，直至其为水平线段。此时，所有
点的坐标也旋转相同的角度。
g(n)
关于概率论的简要回顾。请
查阅本书的网站。
a b
图11.21(a)边界线段；(b)一维函数表示
让我们将幅度g视为一个离散随机变量v,并形成一个幅度直方图p(v),i=0,1,2,…,A-1,其中A
是我们分割幅度尺度的离散幅度增量数。然后，记住p(v)是值v,出现的概率估计，故由式(3.3-17)可知
关于其均值的v的第n阶矩为
H?(O)=20-m°p(w) (11.2-9)
式中，
m=2wpw) (11.2-10)
量m为v的均值或平均值，μ?为v的方差。通常，仅使用前几个矩很少可以区分明显不同形状的信号。
一种替代方法是将g(r)归一化为单位面积，并把它当做直方图来处理。换句话说，g(r)现在作为
值r,出现的概率来处理。此时，r为一个随机变量，故矩为
u.O)=20-m°s() (11.2-11)
式中，
m=2rs() (11.2-12) 星;器
器：围
532 数字图像处理(第三版)
上式中，K是边界上的点数，μ,(r)直接与g(r)的形状相关。例如，二阶矩μ?(r)度量曲线关于r的均值
的扩展程度，而三阶矩μ?(r)度量曲线关于均值的对称性。
基本上，我们完成的工作是将任务的描述简化为一维函数的描述。尽管到目前为止矩是最流行
的方法，但它们不是用于此目的的唯一描绘子。例如，另一种方法是计算一维离散傅里叶变换，得到
其频谱，并使用频谱的前q个分量来描述g(r)。与其他技术相比，矩方法的优点是矩的实现非常简单，
且矩携带了边界形状的“物理”解释。图11.21清楚地表明了这种方法对旋转的不敏感性。需要时，
通过缩放g值和r值的范围，可实现尺寸的归一化。
11.3 区域描绘子
在本节，我们考虑几种描述图像区域的方法。记住，使用边界和区域相结合的描绘子在实践中
是很普遍的。
11.3.1 一些简单的描绘子
一个区域的面积定义为该区域中像素的数量。区域的周长是其边界的长度。尽管面积和周长有
时也被用做描绘子，但它们主要应用于感兴趣区域尺寸不变的情形。这两个描绘子频繁用于度量一个
区域的致密性，定义为(周长)22/面积。另一个稍微不同的(标量乘子内)致密性描绘子是圆度率，即一
个区域的面积与具有相同周长的一个圆(最致密的形状)的面积之比。周长为P的一个圆的面积为
P2/4π。因此，圆度率R,由下式给出：
R=4 (11.3-1)
其中，A是所讨论区域的面积，P是其周长。对于圆形区域，该度量值为1,对于方形区域，该度量
值为π/4。致密性是一个无量纲的度量，当然，在忽略调整数字区域大小和旋转数字区域时可能引入
的计算误差的情形下，它对均匀尺度变化和方向不敏感。
用做区域描绘子的其他简单度量包括灰度级的均值和中值、最小灰度值和最大灰度值，以及其
值高于和低于均值的像素数。
例11.8 使用面积计算从图像中提取信息。
即使是像归一化面积这样的简单区域描绘子，对于从图像中提取信息也是相当有用的。例如，图11.22
显示了美洲的卫星红外图像。如1.3.4节中讨论的那样，这些图像提供了人类定居地的整体数量。用于收
集这些图像的传感器能够探测可见光和近红外发射光，如灯光、火光和闪光。图像旁边的表格(按从上到
下的区域)给出了所有4个区域中被白色(灯光)占据的面积与所有发光面积之比。例如，这样的一种简单
度量可用区域消耗的电能给出一个相对估计。通过关于每个区域的陆地面积、人口数等将其归一化，可
进一步细化数据。
11.3.2 拓扑描绘子
拓扑特性对于图像平面区域的整体描述是很有用的。简单来说，拓扑学是研究未受任何变形影
响的图形的性质，前提是该图形未被撕裂或粘连(有时称为橡皮膜变形)。例如，图11.23显示了一个
带有两个孔洞的区域。如果一个拓扑描绘子由该区域内的孔洞数量来定义，那么这种性质明显不受拉
伸或旋转变换的影响。然而，一般来说，如果该区域被撕裂或折叠，那么孔洞数会发生变化。注意，
由于拉伸会影响距离，故拓扑特性与距离或基于距离度量概念的任何特性无关。
第11章 表示和描述 533
另一个对区域描述有用的拓扑特性是连通分量的数量。一个区域的连通分量已在2.5.2节中定
义。图11.24显示了一个具有3个连通分量的区域(关于计算连通分量的算法，请参阅9.5.3节)。
每个区域的灯光 区域编号
(从上至下) 与总灯光之比
1 0.204
2 0.640
0.049 4 0.107
3
图11.22 夜间美洲的红外图像(图像由NOAA提供)
图11.23 带有两个孔洞的一个区域 图11.24 带有3个连通分量的一个区域
图形中孔洞的数量H和连通分量的数量C,可用于定义欧拉数E:
E=C-H (11.3-2)
欧拉数也是一种拓扑特性。例如，图11.25中所示的区域有分别等于0和-1的欧拉数，因为“A”
有一个连通分量和一个孔洞，而“B”有一个连通分量和两个孔洞。
使用欧拉数，可非常简单地解释由直线线段表示的区域(称为多边形网络)。图11.26 显示了一个
多边形网络。将这样一个网络的内部区域分类为面和孔通常是很重要的。用V表示顶点数，用Q表
示边数，用F表示面数，那么可得出称为欧拉公式的如下关系：
v-Q+F=C-H 黑;图
匿;
534 数字图像处理(第三版)
由式(11.3-2)可以看出上式等于欧拉数：
V-Q+F=C-H=E (11.3-3)
图11.26中的网络有7个顶点、11条边、2个面、1个连通区域和3个孔，因此欧拉数为-2:
7-11+2=1-3=-2
拓扑描绘子提供了一个附加特征，该特征在表征某个场景中的区域时通常很有用。
顶点
a b 面
孔 一边
图11.25 欧拉数分别等于0和-1的区域 图11.26 包含一个多边形网络的区域
例11.9 使用连通分量在已分割图像中提取最大特征。
图11.27(a)显示了美国华盛顿特区的一幅大小为512×512的8比特图像，该图像是由NASA的地球资
源(LANDSAT)卫星拍摄的。这幅特殊的图像是近红外波段图像(详见图1.10)。假设我们只使用这幅图像来
分割河流(与使用多光谱图像相反，它可简化任务)。由于河流在图像中是相当暗的均匀区域，因此阈值处
理方法显然值得一试。在使河流变为一个不连通区域之前，用可能的最高阈值为图像设置门限所得的结果
如图11.27(b)所示。阈值是人为选择的，这一点说明，在这种情况下，没有图像的其他区域出现在阈值化
后的结果中，仅依靠河流本身是不可能分割河流的。本例的目的是说明如何使用连通分量来“完成”分割。
a bcd
图11.27(a)华盛顿特区的红外图像；(b)经阀值处理后的图像；(c)图(b)的最大连通分量：(d)图(c)的骨架
图11.27(b)中的图像有1591个连通分量(使用8连通得到),其欧拉数为1552,由此推出孔洞数为39。
图11.27(c)显示了具有最大元素数量(8479)的连通分量。这是我们期望的结果，因为我们已知使用一个
阈值不能从图像中由河流本身来分割河流。注意，所得结果非常清晰。如果我们想要度量河流的每个支
流的长度，那么可以使用该连通分量的骨架[见图11.27(d)]。换句话说，骨架中每个分支的长度是它所
表示的河流分支长度的合理近似。
11.3.3 纹理
描绘区域的一种重要方法是量化该区域的纹理内容。尽管不存在纹理的正式定义，但在直觉上，
这种描绘子提供了诸如平滑度、粗糙度和规律性等特性的度量(图11.28中给出了一些例子)。图像处
第11章 表示和描述 535
理中用于描述区域纹理的三种主要方法是统计方法、结构方法和频谱方法。统计方法生成诸如平滑、粗
糙、粒状的等纹理特征。结构技术处理图像像元的排列，如基于规则间距平行线的纹理描述。频谱技术
基于傅里叶频谱的特性，主要用于检测图像中的全局周期性，方法是识别频谱中的高能量的窄波峰。
a bc
图11.28 白色方块从左到右表示平滑纹理、粗糙纹理和规则纹理。图像从左
到右分别是一块超导体、人类胆固醇和一个微处理器的光学显微镜
图像(图像由佛罗里达州立大学的Michacl W.Davidson博士提供)
统计方法
描述纹理的最简方法之一是使用一幅图像或一个区域的灰度级直方图的统计矩。令z是表示灰度的
一个随机变量，并令p(z),i=0,1,2,…,L-1为相应的直方图，其中L是不同灰度级的数量。由式(3.3-17)
可知，关于其均值的z的第n阶矩为
A.(2)=2(z-m°P(z) (11.3-4)
式中，m是z的均值(平均灰度):
m=23z) (11.3-5)
注意，由式(11.3-4)可知μ。=1和μ,=0。二阶矩[方差o2(z)=μ?(z)]在纹理描述中特别重要。它
是灰度对比度的度量，可用于建立相对平滑度的描绘子。例如，度量
R(z)=1-+a2(2) (11.3-6)
对于恒定灰度区域为0(该区域的方差为零),而对于较大的?2(z)值，其接近于1。因为对于灰度级图
像方差值是随灰度值增大而增大的，例如，对于值在范围[0,255]内的灰度级图像，最好将方差归一
化到区间[0, 1]内，以便于在式(11.3-6)中使用。在式(11.3-6)中将o2(z)除以(L-12,可实现这种归一
化。标准差σ(z)也经常用做纹理的一种度量，因为标准差的值对于很多人来说更为直观。
三阶矩
(2)=2(z-m2n(z) (11.3-7)
是直方图偏斜度的度量，而四阶矩是直方图相对平坦度的度量。五阶矩和更高阶矩不容易与直方图形
状联系起来，但它们的确提供了纹理内容的进一步量化辨别。另外一些有用的、基于直方图的纹理度
量，包括由下式给出的“一致性”度量： 密等
536 数字图像处理(第三版)
uca=2n(z) (11.3-8)
和平均熵度量，您可以回顾基本信息论，其定义为
2)=-2pzJOBg?P(z) (11.3-9)
因为p在区间[0,1]内取值，且这些值的和为1,故度量U对所有灰度级都相等的图像有最大值(极大
一致性),并从最大值开始降低。熵是可变性的度量，对恒定图像其为零。
例11.10 基于直方图的纹理度量。
表11.2总结了前述的图 11.28 中强调的三种纹理的度量值。均值仅告诉我们每个区域的平均灰度，
它仅用做灰度的大致概念，不是真正的纹理。标准差提供的信息更为丰富；数字清楚地表明第一个纹理
的灰度级变化明显小于其他两个纹理(即第一个纹理更平滑)。用这种度量粗糙纹理显示得很清楚。如期
望的那样，该结论对于R同样有效，因为它度量的内容基本上与标准差度量的内容相同。三阶矩通常用
于确定直方图的对称程度及它们是向左偏斜(负值)还是向右偏斜(正值)。这给出了灰度级是偏向均值的
暗端还是偏向亮端的粗略概念。就纹理而论，仅当度量间的变化较大时，由三阶矩导出的信息才是有用
的。研究一致性度量后，我们再次得出结论：第一幅子图像更为平滑(比其他子图像更均匀),且最大随
机(最低一致性)对应于粗糙纹理。这并不让人感到意外。最后，熵值变化与一致性度量相反，它与一致
性度量的结论相同。第一幅子图像的灰度级变化最小，而粗糙图像的灰度级变化最大。规则纹理的灰度
级变化介于前述两种度量之间。
表11.2 图11.28中所示子图像的纹理量度
纹 理 均 值 标准差 (归一化后的)R 三阶矩 一致性
82.64
143.56
99.72
11.79
74.63
33.73
0.002
0.079
0.017
-0.105
-0.151
0.750
0.026
0.005
0.013
熵
平滑 5.434
粗糙 7.783
规则 6.674
仅使用直方图计算得到的纹理度量不携带像素彼此之间的相对位置的信息。在描述纹理时，这
很重要，并且将这种类型的信息合并到纹理分析过程中的一种方法是不仅要考虑灰度的分布，还要考
虑图像中像素的相对位置。
圈·g
令Q是定义两个像素彼此相对位置的一个算子，并考虑一幅具有
L个可能灰度级的图像f。令G为一个矩阵，其元素g。是灰度为乙和
7,的像素对出现在f中由Q所指定的位置处的次数，其中1≤i.j≤L。
按这种方法形成的矩阵称为灰度级(或灰度)共生矩阵。当含义明确
时，G简单地称为一个共生矩阵。
图11.29显示了一个如何用L=8和由“直接面对右边的一个像素”(也就是，一个像素的相邻像素
被定义为紧靠右边的像素)定义的位置算子Q构造共生矩阵的例子。左侧的阵列是所考虑的小图像，右
侧的阵列是矩阵G。我们看到，G的元素(1,1)是1,因为在f中，值为1的像素的右侧值也为1的像
素仅出现了1次。类似地，G的元素(6,2)是3,因为在f中，值为6的像素的右侧为值为2像素出现
了3次。按这种方式，可计算出G的其他元素。例如，如果我们已将Q定义为“右边一个像素和上面
一个像素”,则G中的位置(1,1)会是0.因为在f内由Q指定的位置处不存在右边一个1和上面一个1
的情形。另一方面，G中的位置(1,3).(1.5)和(1,7)都会是1,因为在f内由Q定义的位置处，右侧像素
分别为3,5和7的1值像素都出现了1次。作为练习，请您使用Q的这个定义计算G的所有元素。
注意，我们正使用灰度范围1.L1
的第一个行列索引。
替代我们常用范围[0.L-11. 这样
做的目的是让灰度值对应于“传统
的”矩阵索引即灰度值1对应于G
第11章 表示和描述 537
12 3 45 6 78
① 1 7 5 3 2
5 1 6 1 2 5
8 8 6 8 1 2
4 3 4 5 5 1
8 7 8 7 6 ②
7 8 6 ② 6 ②
图像f
-1 2 0 0 0 1 1 0
2 0 0 0 0 1 1 0 0
3 0 1 0 1 0 0 0 0
4 0 0 1 0 1 0 0 0
5 2 0 1 0 1 0 0 0
-3 0 0 0 0 0 1
7 0 0 0 0 1 1 0 2
8 1 0 0 0 0 2 2 1
共生矩阵G
图11.29 生成共生矩阵的方式
图像中可能的灰度级数决定了矩阵G的大小。对于一幅8比特图像(256个可能的灰度级),G的
大小将为256×256。当使用一个矩阵时，这不成问题，但是，如例11.11 中所示，有时会使用共生矩
阵序列。为了减少计算负担，经常使用的一种方法是，将灰度量化为几段，以便于管理矩阵G的大
小。例如，在256级灰度的情形下，通过令前32个灰度级等于1,令接下来的32个灰度级等于2,
依次类推，可完成这种量化工作。这将得到一个大小为8×8的矩阵。
满足Q的像素对的总数n,等于G的元素之和(在上例中n=30)。因此，
P=8;/n
是满足Q的一个值为(z,z;)的点对的概率估计。这些概率的值域为[0,1],且它们的和为1:
22D=1
其中，K是方阵G的行(或列)数。
因为G取决于Q,所以选择一个合适的位置算子并分析G的元素，可以检测灰度纹理模式的存在。
表11.3中列出了一组表征G的内容的很有用描绘子。(表中第二行的)相关描绘子中使用的量定义如下：
m=2D, m-2iD
和
?=20-m,PZp ?=2G-mPZp
如果我们令
Po=2D 和Po=2D
则前述公式可以写为
m=2iPo, m-iPO), ○?-20-m,Po, ?=2o-m,PO
参考式(11.3-4)、式(11.3-5)和它们的解释，我们看到m,是沿归一化后的G的行计算的均值，
m.是沿着G的列计算的均值。类似地，σ,和σ。是分别沿行和列计算的标准差(方差的平方根)。这
些项都是标量，与G的大小无关。
853 55
538 数字图像处理(第三版)
记住，当我们研究表11.3时，“邻居”与定义Q的方式有关(即邻居不必一定是邻近的),且Pa
只不过是在f内像素发生次数的归一化计数，该像素具有灰度乙和z,并与Q指定的位置有关。
表11.3 用于刻画大小为KxK的共生矩阵特性的描绘子，p?是G的第j项除以G的元素总和的数
受
描 给子 解 释
度量G的最强响应、值域为[0.1]
一个像素在整个图像上与其邻居相关程度的度量。值域是[1,-1].对应于
完美的正相关和完美的负相关。如果任意一个标准差为零，则该度量无
定义
一个像素在整个图像上与其邻居间的灰度对比的度量。值域为0(当G恒定
时)到(K-1)2
值域为[0.1]的一致性度量。对于恒定图像，一致性为1
G中元素对角线分布的空间紧密度的度量。值城为[0.1].当G是对角矩阵
时，其值最大
G中元素随机性的度量。当所有p,项为零时填为0.当所有p,项相等时
熵最大。最大值是2log?K[见关于嫡的公式(11.3-9)]
公式
最大概率 max(Pg)
相关 “-D
o,≠00,≠0
对比度 2-n
一致性(也称为能量)
同质性
熵 2二nR
例11.11 使用描绘子表征共生矩阵。
图 11.30(a)到(c)显示了分别由随机模式、水平周期(正弦)模式和混合像素模式组成的图像。本例有
两个目的：(1)对(从上到下)对应于这些图像的3个共生矩阵G,,G?和G?,说明表11.3中描绘子的值，
(2)阐明如何使用共生矩阵序列来检测图像中的纹理模式。
图11.31以图像形式显示了共生矩阵G,G?和G?。这些矩阵是用L=256和位置算子“右侧紧邻一个
像素”得到的。在这些图像中，坐标(.)处的值是在f内具有灰度乙和z,的像素对由Q指定的位置处出
现的次数，因此图11.31(a)是一幅随机图像并不奇怪。
a b
c
图11.30 其像素具有(a)随机模式、(b)周期模式和(c)混合纹
理模式的图像。每幅图像的大小都为263×800像素
a b c
图11.31 大小为256×256的共生矩阵G,G?G,,从左到右对应于图11.30中的图像
第11章 表示和描述 539
图11.31(b)更有趣。第一个明显的特征是关于主对角线对称。由于正弦波的对称性，像素对(z,z,)
的计数与像素对(z,,z)的计数相同，从而产生了一个对称的共生矩阵。G?的非零元素是稀疏的，因为水
平正弦波中水平相邻像素间的差值相对较小。数字化后的正弦波是阶梯状的，每个阶梯的高度和宽度取
决于表示函数中使用的频率和幅度级数，这些有助于解释这些概念。
图11.31(c)中共生矩阵G?的结构更复杂。沿主对角线也聚集了高计数值，但它们的分布与G?相比更
密集，这一特征表明图像的灰度值有着丰富的变化，但相邻像素之间的灰度很少有较大的跳变。观
察图11.31(c),我们看到图像中存在几个由较小灰度变化表征的较大区域。灰度的高跳变出现在物体的
边界处，但与整个较大区域上的中等灰度跳变相比，这些计数较小，因此，如我们在第3章讨论的那样，
由于图像显示器同时显示高值和低值的能力，使它们不太明显了。
前边的观察是定性的。为定量化共生矩阵的内容，我们需要表11.3中的那些描绘子。表11.4 给出
了为图11.31中的3个共生矩阵计算的这些描绘子的值。注意，如之前讨论的那样，为使用这些描绘子，共
生矩阵必须用它们的元素之和除它们来归一化。通过查看图11.30中的图像和图11.31中它们所对应的共生
矩阵，表11.4中的各项与我们所期望的结果一致。例如，考虑表11.4中的“最大概率”这一列。最高概率
对应于第三个共生矩阵，这告诉我们与其他两个矩阵相比，这个矩阵有最大数量的计数(像素对在图像内由Q
指定的位置处出现的最大次数)。这与前面我们对G?的分析一致。第二列指出最高相关对应于G?,从而告诉
我们第二幅图像中的灰度是高度相关的。图11.30(b)中反复出现的正弦模式揭示了为什么会这样的原因。注意，
G?的相关基本为零，实际上这表明相邻像素不相关，这是随机图像的一个特性，如图11.30(a)中的图像。
对比度描绘子对于G?最高，对于G?最低。从而我们看到，图像的随机性越低，其对比度往往也越低。
通过研究图11.31所示的矩阵，我们就会明白其原因。(i-)2项是1≤i.j≤L的整数差，故它们对于任
何G都是相同的。因此，归一化共生矩阵中元素的概率就成为决定对比度值的因子。虽然G?有最小的最
大概率，但其他两个矩阵有许多零和接近零的概率(图11.31中的暗色区域)。记住，值G/n之和为1,故
很容易了解对比度描绘子随着随机性的增加而增大的原因。
使用类似的方式，可以解释剩下的三个描绘子。一致性会随概率平方值的增大而增加。这样，图像
中的随机性越低，一致性描绘子就越高，如表11.4中的第五列所示。同质性度量G值关于主对角线的集
中度。分母项(1l+li-jD对所有三个共生矩阵是相同的，且分母项的值在1和j的值接近(即接近主对角线)
时会减小。这样，靠近主对角线具有高概率值(分子项)的矩阵将有最高的同质性值。如前面讨论的那样，
这样一个矩阵将对应于具有“丰富的”灰度级内容的图像和灰度值较慢变化的区域。表11.4 中第六列的
各项与这种解释是一致的。
表中最后一列中的各项是共生矩阵中的随机性度量，这些度量依次为对应图像中的随机性度量。如
期望的那样，G?有最高的值，因为其源图像完全是随机的。其他两项的解释不言自明。注意，对G?的熵
的度量接近理论最大值16(2log?256=16)。图11.30(a)中的图像由均匀噪声组成，所以每个灰度级都有
一个近似相等的出现概率，这是表11.3中为最大熵声明的一个条件。
至此，我们已处理了每幅图像及它们的共生矩阵。(在不查看图像的情形下)假设我们想要“发现”这
些图像中是否存在任何包含重复分量(即周期纹理)的部分。完成该任务的一种方法是，增大邻点间的距离，
由这些图像导出共生矩阵，并检查共生矩阵序列的相关描绘子。如前面提及的那样，在处理共生矩阵序列
时，为减小矩阵的大小并减轻相应的计算负担，通常要量化灰度数。下边的结果是使用L=8得到的。
图11.32 显示了作为水平“偏移”(即相邻像素间的水平距离)从1(对相邻像素)到50时的函数，相
关描绘子的曲线。图11.32(a)表明所有的相关值接近0,这说明在随机图像中未找到这样的模式。图11.32(b)
中所示相关的形状清楚地表明，输入图像在水平方向是正弦的。注意，相关函数以一个高值开始，然后
随着相邻像素间的距离的增大而降低，再后重复自身。 爱:8
圈：蜀
540 数字图像处理(第三版)
1
0.5
相关 0
-0.5
a bc -1 1020 30 4050110 20 30 4050110 20 30 4050
水平偏移 水平偏移 水平偏移
图11.32 相关描绘子的值与偏移(“相邻”像素间的距离)间的关系曲线，图(a)、
图(b)和图(c)分别对应于图11.30中的噪声图像、正弦图像和电路板图像
图11.32(c)表明，与电路板图像相关联的相关描绘子开始时下降，但在偏移距离为16像素时有一个
较强的峰值。分析图11.30(c)所示图像表明，顶部的焊接点形成了间距约为16像素的重复模式(见图
11.33),下一个主要的峰值出现在偏移距离32处，它是由同一模式引起
的，但该波峰的幅度较低，因为在该偏移距离处的重复次数小于偏移距
离16像素处的重复次数。类似的观察可以解释偏移距离48像素处的更
小峰值。
图像中还存在其他重复的模式，
但从256 灰度级到8灰度级的粗糙
量化已使它们变得模糊。
16像素
结构方法
如本节开始时提到的那样，第二类纹理描述是
基于结构概念的。假设我们有一个形如S→aS的规
则，该规则表明字符S可被重写为 aS(例如，应用
该规则三次会产生字符串 aaaS)。如果a表示一个 图11.33 显示有周期分量的电路板局部放大图像
圆[见图11.34(a)],并且“向右侧添加圆”的含义是分配形如aaa…的一个字符串，那么规则S→aS
将生成如图11.34(b)所示的纹理模式。 a
5
c
假设我们接着向该方案中添加一些新的规则：S→bA,
A→cA,A→c,A→bS,S→a,其中b表示“下方添加一个圆”,
c 表示“向左侧添加一个圆”。我们现在生成一个形如
aaabccbaa的字符串，它对应于一个圆的3×3矩阵。使用相
同的方法可以生成更大的纹理模式，如图11.34(c)所示(注
意，这些规则也可生成非矩形结构)。
前述讨论的基本思想是一个简单的“纹理基元”可借
助一些规则用于形成更复杂的纹理模式，这些规则限制基元
(或这些基元)的可能排列的数量。这些概念是关系描绘的核
心，11.5节中将详细讨论这一主题。
频谱方法
图11.34 (a)纹理基元；(b)由规则→As
生成的模式；(c)由该规则和
其他规则生成的二维纹理模式
如在5.4节中讨论的那样，傅里叶频谱非常适合描述图
像中的二维周期或近似二维周期模式的方向性。这些全局纹
理模式在频谱中作为高能脉冲集中区域很容易区分。这里，
我们考虑对纹理描述很有用的傅里叶频谱的三个特征：(1)频谱中突出的尖峰给出纹理模式的主要方
向；(2)频率平面中尖峰的位置给出模式的基本空间周期；(3)采用滤波方法消除任何周期分量而留下
第11章 表示和描述 541
非周期性图像元素，然后采用统计技术来描述。回忆可知，频谱是关于原点对称的，所以只需要考虑
半个频率平面。因此，对于分析的目的，每个周期模式只涉及频谱中的一个尖峰，而不是两个尖峰。
刚才提到的频谱特征的检测和描述通常可以使用极坐标表达来简化：得到一个函数S(r,θ),其
中S是频谱函数，r和0是该坐标系中的变量。对于每个方向0,S(r,θ)可以视为一个一维函数S?(r)。
类似地，对于每个频率 r,S,(θ)也是一个一维函数。对固定值θ分析S?(r),可得到沿着自原点的半
径方向上的频谱特性(譬如出现尖峰);而对定值r分析S,(θ),可得到以原点为圆心的一个圆上的频
谱特性。
对这些函数进行积分(对离散变量求和),可得到一个更为整体的描述：
so)=2S?) (11.3-10)
和
se)-2s.e) (11.3-11)
式中，R?是以原点为圆心的圆的半径。
式(11.3-10)和式(1.3-11)的结果为每对坐标(r,θ)构成了一对值(S(r), SO)]。通过改变这些坐标，
我们可以生成两个一维函数S(r)和S(θ),从而为整幅图像或所考虑区域的纹理构成一种频谱-能量描述。
此外，为了定量地表征它们的特性，可以计算出这些函数本身的描绘子，。用于这一目的的典型描绘子
是最高值的位置、幅度和轴向变化的均值与方差，以及该函数的均值和最高值之间的距离。
例11.12 频谱纹理。
图11.35(a)显示了随机分布的火柴图像，图11.35(b)显示了按周期排列后的火柴图像。图11.35(c)和
(d)显示了相应的傅里叶频谱。两个傅里叶频谱中在二维方向上延伸的四边形周期能量脉冲归因于火柴的
其余部分的粗糙背景的周期纹理。图11.35(c)中频谱的其他占支配地位的分量是由图11.35(a)中物体边缘
的随机方向引起的。另一方面，图11.35(d)中与背景无关的主要能量是沿水平轴分布的，它对应于图11.35(b)
中的较强垂直边缘。
a bc d
图 11.35(a)随机分布的火柴图像；(b)有序排列的火柴图像；(c)图(a)的傅里
叶频谱；(d)图(b)的傅里叶频谱。所有图像的大小均为600×600像素
图11.36(a)和(b)是随机排列火柴的S(r)曲线和S(0)曲线，类似地，图11.36(c)和(d)是有序排列火柴
的S(o)曲线和S(0)曲线。随机排列火柴的Sr)曲线表明没有较强的周期分量[即与原点处的尖峰(直流分
量)相比，频谱中没有其他占支配地位的尖峰]。相反，有序排列火柴的S(r)曲线在r=15附近显示了一个
较强的尖峰，而在r=25附近显示了一个较小的尖峰，它们分别对应于图11.35(b)中亮区域(火柴)和暗区
域(背景)的水平重复周期。类似地，图11.35(c)中的能量脉冲的随机特性，在图11.36(b)所示的S(θ)曲线
中十分明显。相比之下，图11.36(d)所示图形在靠近原点、90°和180°的区域显示了很强的能量分量。这
与图11.35(d)中频谱的能量分布是一致的。 器：烟
861
542 数字图像处理(第三版)
a b90 2.7
c d80
70 25
60 24
50 23
40 2221
20 20
10 1.9
0
a 50 100 150 200 2503001.80 20 40 6080 100 120 140 160 180
60 3.6
34 5 32
40 0
28
0 6
20 22
10 2018
L
70 50 100 150 300 250000204060 80 100 120 140 160 180 1.6
图11.36(a)图11.35(a)的S(n)曲线；(b)图11.35(a)的S(0)曲线；(c)图11.35(b)
的S(r)曲线；(d)图11.35(b)的S(θ)曲线。所有垂直轴都要x103
11.3.4 不变矩
大小为MxN的数字图像fx,y)的二维(p+q)阶矩定义为
m=22x0f(u》) (11.2-12)
其中p=0,1,2,…和q=0,1,2,…是整数。相应的(p+q)阶中心矩定义为
=2Zα-x°(v-9f(x,》 (11.3-13)
式中p=0.1.2,…和q=0.1.2,…,其中
x=和y= (11.3-14)
由n表示的归一化中心矩定义为 ”～=
(11.3-15)
式中，
r=P±9+1 (11.3-16)
其中p+q=2,3,…。
由二阶矩和三阶矩可推出如下7个不变矩组①:
9=720+7o?
?=(72-no)2+4n2
(11.3-17)
(11.3-18)
①推导这些结果时，所用到的概念超出了本书的讨论范围。在由 Bel[1965]撰写的图书和由 Hu[1962]发表的论文中，包含了这些
概念的详细讨论，关于生成高于7阶不变矩的方法，见Fusserf2000]。不变矩可推广到n维情形(Mamistvalov[1998D)
第11章 表示和描述 543
93=(730-37??)2+(3n??-no)2
φ4=(n,?+7??)2+(7??+7o?)2
(11.3-19)
(11.3-20)
s=(n?0-3n??)(730+7n?)[(n?0+n?)2-3(n??+7os)2]+
(3nz?-7o?)(7??+7o?)[3(n?+71?)2-(n2?+7o)2I
?70-7m)I(na+n?2-(n?+7m2l+4n,(7o+n?2KOn?+7m)
=(3n??-7os)(730+72)[(7?0+n?)2-3(n??+7os)2]+
(3n??-o?)(7??+No?)[3(no+7??)2-(n??+no)21
(11.3-21)
(11.3-22)
(11.3-23)
这些矩组对于平移、尺度变化、镜像(内部为负号)和旋转是不变的。
例11.13 不变矩。
本例的目的是，利用图11.37(a)中的图像计算并比较前述的几个不变矩。黑(0)的边界是加上去的，
以使本例的所有图像都有相同的尺寸；0不影响不变矩的计算。图11.37(b)到(f分别显示了原图像经平移、
在空间两个维度上缩小一半、镜像、旋转45°和旋转90°操作后的结果。表11.5总结了这6幅图像的7个
不变矩的值。为减小动态范围进而简化解释，所显示的值是sgn(φ,)log?o(φD。需要绝对值的原因是，许
多值是小数和/或负数；符号函数保留符号(这里我们感兴趣的是矩的不变性和相对符号，而不是它们的真
实值)。表11.5中的两个关键点是：(1)矩的值的接近程度，与平移、尺度缩放、镜像和旋转无关；(2)d
的符号对于镜像图像是不同的(这是实践中用于检测一幅图像是否已被镜像的一种性质)。
aei
图11.37(a)原图像；(b)~(f分别经平移、缩小一半、镜像、旋转45°和旋转90°操作后的图像
表11.5 图11.37中各幅图像的不变矩
不 变 矩 原 图 像 平移 缩小一半 镜 像 旋转45
2.8662
7.1265
10.4109
10.3742
21.3674
13.9417
-20.7809
2.8662
7.1265
10.4109
10.3742
21.3674
13.9417
-20.7809
2.8664
7,1257
10.4047
10.3719
21.3924
13.9383
-20.7724
2.8662
7.1265
10.4109
10.3742
21.3674
13.9417
20.7809
2.8661
7.1266
10.4115
10.3742
21.3663
13.9417
-20.7813
旋转90
A 2.8662
A 7.1265
10.4109
10.3742
21.3674
13.9417
-20.7809 罩·器
爱
544 数字图像处理(第三版)
11.4 使用主分量进行描绘
本节中讨论的内容适用于边界和区域。另外，这些内容也是描绘一组空间上已配准图像的基础，
但这些已配准图像的对应像素值是不同的(即RGB 图像的三个分量图像)。假设我们已有这样一幅彩
色图像的三个分量图像。通过将每组三个对应像素表示为一个向量，
可将这三幅图像作为一个单元来处理。例如，令x?.x?和x?分别是这三
幅RGB 分量图像中的一个像素的值。这三个元素可以表示为一个三
维列向量x,即
这个向量表示所有三幅图像中的一个共同像素。如果图像大小为MxN,则按这种方式表示所有像素
后，总共将有K=MN个三维向量。如果我们有n幅已配准的图像，那么向量将是n维的：
:
关于向量和矩阵的简要回
顾，请查阅本书的网站。
(11.4-1)
在本节中，假设所有向量都是列向量(即n×1 阶矩阵)。我们可将它们写成一行，表示为x=(x,
x?,…,x.)的形式，其中T表示转置。
我们可以将向量当做随机量来处理，就像我们构建灰度级直方图时所做的那样。唯一的差别是，
我们现在谈论的是随机向量的均值向量和方差矩阵，而不是随机变量的均值和方差。总体均值向量定
义为
m.=E[x} (11.4-2)
其中E·]是变量的期望值，下标表示m与向量x的总体相关联。回忆可知，向量或矩阵的期望值
可通过取每个元素的期望值来得到。
向量总体协方差矩阵定义为
Cx=E{x-m)(x-m)F} (11.4-3)
因为x是n维的，故C,和(x-m,)(x-m)是nxn 阶矩阵。C,的元素c,是x,的方差，即总体中x向
量的第i个分量，C?的元素c,是这些向量元素x,和x,之间的协方差。矩阵C?是实对称的。如果元素
x,和x,是不相关的，则它们的协方差为零，从而有c=c=0。当n=1时，所有这些定义都简化为它
们所熟悉的一维形式。
对于来自随机总体的K个向量取样，均值向量可以通过使用常见的求平均值的表达式由样
本来近似：
m-卡艺m。 (11.4-4)
①回忆可知，均值为m的随机变量x的方差定义为E[(x-m)"]。两个随机变量x和x的协方差定义为E|x-m)(x-m)1
第11章 表示和描述 545
类似地，通过展开乘积(x-m,)(x-m)并使用式(11.4-2)和式(11.4-4),我们发现协方差矩阵可由如
下样本来近似：
c.=卡≥xx{-m,m (11.4-5)
例11.14 均值向量和协方差矩阵的计算。
为说明式(11.4-4)和式(11.4-5)的机理，考虑4个向量x?=(0,0,0)",x?=(1.,0,0)2,x?=(1,1,0)和
x?=(,0,D2。应用式(11.4-4)得到如下均值向量：
同样，使用式(11.4-5)得到下列协方差矩阵：
沿主对角线的所有元素都相等，这表明总体中向量的三个分量有相同的方差。此外，元素x?和x?及x?和
x,是必定相关的，元素x?和x,是必定不相关的。
因为C,是实对称的，所以总可以找到一组n个正交的特征向量(见Noble and Daniel[1988])。令
e,和2,i=1,2,…,n为C的特征向量和对应的特征值，为方便起见以降序排列，以使≥2+1,j=1,
2,…,n-1。令A为一个矩阵，其行由C?的特征向量组成，特征向量的排序方式为A的第一行对应
于最大特征值的特征向量，最后一行对应于最小特征值的特征向量。
假设我们将A用做将向量x映射为向量y的一个变换矩阵，如下所示：
y=A(x-m) (11.4-6)
该表达式称为霍特林变换，就像马上要说明的那样，该变换具有一些
有趣且有用的性质。
不难证明，由该变换得到的y向量的均值为零，即
m,=E(y}=0
霍特林变换与离散Karhunen
Loeve变换(见Kartunen[1947D是相
同的，因此文献中交替使用这两个
名称。
(11.4-7)
由基本矩阵理论可知，y的协方差矩阵由A和C,按如下表达式给出：
C,=AC?A' (11.4-8)
此外，因为构成A的方式的原因，C,是一个对角矩阵，其主对角线上的元素是C?的特征值，即
(11.4-9)
该协方差矩阵中非对角线上的元素为零，所以向量y的元素是不相关的。记住，2是C,的特征值，并
①根据定义，大小为nxn的矩阵C的特征向量和特征值满足关系Ce=ie,i=1.2…,n 图累
嚣名
546 数字图像处理(第三版)
且对角矩阵中主对角线上的元素是C,的特征值(见Noble and Daniel[1988])。因此，C和C,具有相同
的特征值。
霍特林变换的另一个重要性质是可处理由y重建x的问题。因为A的各行是正交向量，由此得
出A1=A',且任何向量x都能通过使用下式由其对应的y来恢复：
x=A'y+m (11.4-10)
然而，假设我们不使用C,的所有特征向量，而由对应于k个最大特征值的k个特征向量来形成矩阵
A,那么将得到一个kxn阶的变换矩阵。然后，向量y成为k维矩阵，并且式(11.4-10)给出的重建不
再是精确的了(这与我们在11.2.3节中使用少量的傅里叶系数描述一个边界的过程有些相似)。
使用A,重建的向量为
x=Ay+m (11.4-11)
可以证明.x和x之间的均方误差由下式给出：
-2a,-2a, (11.4-12) -Za
式(11.4-12)的第一行表明，如果k=n(即如果变换中使用了所有的特征向量),则误差为零。因为，
单调递减，式(11.4-12)还表明，通过选取与最大特征值相对应的k个特征向量，可使得误差最小。从
而，从可以将向量x和它的近似值余之间的均方误差降至最小这方面来说，霍特林变换是最佳的。由
于使用对应于最大特征值的特征向量这一思想，霍特林变换也称为主分量变换。
例11.15 使用主分量描述图像。
图11.38显示了6幅多光谱卫星图像，这些图像对应于6个谱带：可见蓝光(450-520 nm)、可见绿光
(520~600 nm)、可见红光(630-690nm)、近红外(760~900nm)、中红外(1550~1750nm)和热红外(10400~
12500 nm)。本例的目的是说明如何运用主分量进行图像描述。
a b c def
图11.38 多光谱图像：(a)可见蓝光：(b)可见绿光；(c)可见红光：
(d)近红外：(e)中红外；(①热红外(图像由NASA提供)
第11章 表示和描述 547
如本节开始时讨论的那样，若按图11.39中所示的方式来组织图像，那么这些图像中的每组对应像素
可形成一个6元素的向量x=(x,x?…,x)'。本例中所有图像的大小都是564×564像素，所以一共构成了
(564)2=318 096个向量，由此来计算均值向量、协方差矩阵及相应的特征值和特征向量。然后，特征向
量用做矩阵A的行，且使用式(11.4-6)得到一组y向量。类似地，我们使用式(11.4-8)得到了C,。表11.6
显示了该矩阵的特征值。注意前两个特征值的支配性。
谱带6
…
谱带5
谱带4
谱带3
谱带2
谱带1
图11.39 由6幅图像中的对应像素形成一个向量
前一段中提到使用y向量生成了一组主分量图像(反过来，应用图11.39可由这些向量构建图像)。
图11.40显示了结果。图11.40(a)是由318 096个y向量的第一个分量形成的，图11.40(b)是由这些向量
的第二个分量形成的，依此类推。因此，这些图像的大小与图11.38中的原图像的大小相同。主分量图像
中最明显的特征是，对比度细节的重要部分包含在前两幅图像中，并自此快速降低。通过研究特征值，
即可说明其原因。如表11.6所示，前两个特征值远大于其他特征值。因为特征值是y向量的元素的方差，
而方差是灰度对比度的度量，不难预料，由对应于最大特征值的向量分量形成的图像会显示最高的对比
度。事实上，图11.40中的前两幅图像占总方差的89??其他4幅图像有着较低的对比度细节，因为它们
仅占总方差的11??
dei
图11.40 使用式(11.4-6)计算的向量得到的6幅主分量图像。反过来，应用图11.39可由向量得到图像 图
～8
548 数字图像处理(第三版)
表11.6 由图11.38中的各幅图像得到的协方差矩阵的特征值
λ A? 2 入 λ
2966 1401 203 94
λ
10344 31
a b c
d ef
图 11.41 仅使用两幅主分量图像重建的多光谱图像，这些图像对应于有着最大特征
值(方差)的两幅主分量图像。请将这些图像与图11.38中的原图像进行比较
根据式(11.4-11)和式(11.4-12),如果使用矩阵A 中的所有特征向量，那么我们能够在原始图像和重
建图像间以0误差从主分量图像(向量)重建原始图像(向量)。也就是说，
当我们称呼图像时，会交替使用 原图像和重建图像是相同的。如果我们的目的是存储和/或传输主分量图 术语“向量”,因为在此处的上下文
像及用于随后重建原图像的变换矩阵，则存储和/或传输所有的主分量图 中，两者间存在——对应的关系。
像就没有意义，因为这不会带来任何益处。然而，假设我们仅保留和/或
传输两幅主分量图像(它们拥有多数对比度细节),则在存储和传输上将是一个有效的节省(矩阵A的大小
是2×6,故其影响可忽略不计)。
图11.41显示了由对应于最大特征值的两幅主分量图像来重建6幅多光谱图像的结果。前五幅图像的
外观十分接近于图11.38中的原图像，但第六幅图像却不是这样。原因是原始的第六幅图像实际上是模糊
的，而在重建中使用的主分量图像是清晰的，因此丢失了模糊的“细节”。图11.42 显示了原图像和重建
图像间的差。图11.42中的图像已被增强，目的是突出它们之间的差别。如果不对它们做增强处理，那么
前五幅图像看起来几乎会是全黑的。如期望的那样，第六幅差值图像显示了最大的不同。
例11.16 用主分量对尺度、平移和旋转变化归一化
如本章前面提及的那样，表示和描述应尽可能与尺寸、平移和旋转无关。主分量针对这三个参量的变
化提供了一种方便的方法来归一化边界和或区域。考虑图11.43中的物体。假设其尺寸、位置和方向(旋转)
是任意的。区域内的(或区域边界上的)点可视为二维向量x=(x,x?),其中x和x?分别是沿x,轴和x?轴
的任意一点的坐标值。区域或边界中的所有点组成一个二维向量总体，如先前那样，这个二维向量总体用于
计算协方差矩阵C,和均值m。C,的第一个特征向量指向总体的最大方差(数据扩散)方向，而第二个特征向量
与第一个特征向量垂直，如图11.43(b)所示。根据当前的讨论，式(1146)中的主分量变换完成两件事情：(1)
在总体的质心(均值)处建立变换后的坐标系的中心，因为从每个x中减去了m,;(2)产生的y坐标是x旋转后
的形式，因此数据就与特征向量联系起来了。如果我们定义一个(y,.y?)轴系统，使y,沿第一个特征向量，而
第11章 表示和描述 549
y?沿第二个特征向量，那么导致的几何形状如图11.43(c)所示。也就是说，占支配地位的数据的方向与轴系
统一致。不管物体的尺度缩放、平移或旋转，只要区域或边界中的所有点都经历相同的变化，就会得到相同
的结果。如果我们希望在尺度上归一化变换后的数据，那么可使用对应的特征值来除该坐标。
a b c d ef
图11.42 原图像与重建图像之间的差。为便于视觉分析，所有差
值图像都已被增强，即已将它们标定到整个范围[0,255]内
K2 d
与最大方差
方向垂直的方向
e? e
最大方差方向
x? ?
质心
y
图11.43(a)一个物体；(b)显示其协方差矩阵的特征向量的物体；(c)使用式(11.4-6)
得到的变换后的物体；(d)平移后的物体，其所有的坐标值都大于零 8;8
873
550 数字图像处理(第三版)
观察图11.43(e)可知，y轴系统中的点可能既有正值又有负值。为将
所有的坐标转换为正值，我们简单地从所有y向量中减去(yimimn,y?m)。 所示方向相反的180°,具体取决
y轴系统的方向可以是与图11.43(c)
为置换结果点以便使它们都大于零，就像在图11.43(d)中那样，我们对所 于原始物体的方向。例如，如果
图1143(a)中的机鼻指向相反的方向， 有的点都加上一个向量(a,b),其中a和b都大于0。
则导致的特征向量会指向左下方。 尽管前面的讨论原理上很简单，但其机理常常会引起混淆。故我们
使用一个简单的手工示例来结束该例子。图11.44(a)显示了坐标分别为(1,1),(2,4),(4,2)和(5,5)的4个
点。均值向量、协方差矩阵和该总体的归一化(单位长度)特征向量是
m.-3 c.-2.003.-20707 -[0.70]
d
X2
7 7
6 6
5 5
4 4
e 3 3
2 2
1 1
0% % A x
2 4 5 23 7 1 4 5 7 3 6 6 01
7 3
2 6
1 5
4
-3-2-1 1 23
-
3
-2 2
-3 1
? Y 234567
图11.44 一个手工例子：(a)原始点：(b)图(a)中各点的协方差矩阵的特征向量；(c)使用式(11.4-6)
得到的变换后的点；(d)来自图(c)的点，这些点已经过舍人和平移，从而所有的坐
标值是大于零的整数。包含虚线的目的是为了方便观看，它们不是数据的一部分
对应的特征值是λ=5.333和2=1.333。图11.44(b)显示了已叠加到数据上的特征向量。由式(11.4-6)
可知，变换后的点(y项)是(-2.828,0),(0,1.414),(0,-1.414)和(2.828,0)。这些点画在图11.44(c)中。
注意，它们沿y轴排列，并具有小数值。当对这些图像处理时，值通常是整数，因此必须把所有的分数
四舍五入为最接近的整数。图11.44(d)显示了已舍人为最接近整数值的点，这些点的位置已移动，因此所
有的坐标值是大于零的整数，就像在原图中那样。
11.5 关系描绘子
在11.3.3节中，为描述纹理，我们介绍了重写规则的概念。在本节中，我们将在关系描绘子的角
度上扩展这一概念。这些内容对边界或区域同样适用，并且它们的主要目的是以重写规则的形式来获
取边界或区域中的基本重复模式。
第11章 表示和描述 551
考虑图11.45(a)中所示的简单的阶梯结构。假设该结构已从一幅图像中分割出来，并且我们希望
以某种形式化方法来描述它。通过定义如图所示的两个基元a和b,我们可以按图11.45(b)所示的形
式对图11.45(a)进行编码。编码后的结构的最明显性质是元素a和b的重复。所以，一种简单的描述
方法是用公式表示涉及这些基元的递归关系。一种可能性是使用重写规则：
(1)S→aA
(2)A→bS
(3)A→b
其中S和A是变量，元素a和b是对应于刚才定义的基元的常量。规则(1)表明，称为起始符号的S
可以被基元a和变量A代替。依次地，变量A可以被b和S代替或只被b代替。若使用bS来代替A,
便会回到规则(1),从而重复这一过程。用b代替A将结束这一过程，因为表达式中不再存在变量。
图11.46给出了由这些规则导出的一些例子，其中结构下面的数字表示规则1,2和3被应用的顺序。
a和b之间的关系得以保留，因为这些规则迫使一个a后总是跟着一个b。值得注意的是，这三个简
单的重写规则可用于生成(或描述)无限多的“相似”结构。
因为字符串是一维结构，所以将字符串应用于图像描述时，需要建立一种适当的方法来将二维
位置关系简化为一维形式。大多数使用字符串来描述图像的应用均基于从感兴趣物体中提取连接线
段的思想。一种方法是追踪一个物体的轮廓，并使用指定方向和/或长度的线段来对结果进行编码。
图11.47说明了这一过程。
a a a b
b
b
a
b
a
a
b
a
图11.45(a)一个简单的阶梯结构；(b)编码后的结构
区域
a a a 起始点-
b
(1.3)
b
a
b
a
边界
b
1,2.1,3)
b
a
b
(1.2.1.2.1.3)
图11.46 由规则S→aA,A→bS和A→b导出的例子 图11.47 使用有向线段对一个区域边界进行编码
另一种更为通用的方法是使用有向线段来描述图像的各个部分(如较小的单色区域),除了采用
首尾相连的方式外，这种有向线段也可采用其他的方式来连接。图11.48(a)说明了这一方法，图11.48(b)874
显示了一些可根据抽象的基元来定义的典型操作。图11.48(c)显示了一组由四个方向定义的线段组成 877
877
552 数字图像处理(第三版)
的特定基元。图11.48(d)显示了一个特定形状的生成步骤，其中(-d)表示与基元d方向相反的基元。
注意，每个合成的结构只有一个头和一个尾。有意义的结果是最后一个字符串，它描述了完整的结构。
?
抽象的基元 头头
a+b· a
b
a-b
抽象的基元 a a
a×b
b
a+b
尾 b
尾
a b d+
h h
1· h c+(-d) d+lc+(-d)
a+b (a+b)cd+|c+(-d)l|-[(a+b)·c
图11.48 (a)抽象的基元；(b)基元间的操作：(c)一组特定的基元；(d)构建一个结构的步骤
字符串描述最适合于这样的应用，即应用中的基元连接性可以一种从头到尾的方式或其他连续
方式来表示。有时，有着类似纹理或其他描绘子的区域可能是不连续的，这就要求具有描述这种情形
的技术。处理这种情况的最有用的方法之一是使用树描绘子。
一棵树T是有着一个或多个节点的有限集合： $、
(a)仅有唯一一个表示根的节点$。
(b)余下的节点被分成不相交的集合T?,…,T,每个集合依次都
是一棵树，称为T的子树。 x
树的末梢是树底端(树叶)的节点集合，采用从左到右的顺序排列。例
图 11.49 带有根S和末梢节
点xy的简单树
如，图11.49所示的树有根$和末梢xy。
一般来说，树中有两种类型的重要信息：(1)关于节点的信息，这种信息是以描述节点的一
组字来存储的，(2)一个节点与其相邻节点相联系的信息，这种信息是以指向那些相邻节点的一
组指针来存储的。
当用于图像描述时，第一类信息识别一幅图像子结构(如区域或边界线段),而第二类信息定义
这个子结构与其他子结构间的物理关系。例如，图11.50(a)可以表示为一棵树，方法是使用“在……
之内”的关系。因此，如果树的根用S代表，那么图11.50(a)表明，第一级复杂性涉及S内的a和b,
这将产生从根发出的两个分支，如图11.50(b)所示。下一级涉及a内的b以及c内的d和e。最后，e
内的f完成整棵树。
第11章 表示和描述 553
S
s a b
@ a c
e
b d
d
图11.50(a)一个简单的合成区域；(b)使用关系“在……之内”得到的树表示
小结
从图像中分割出来的物体或区域的表示和描绘是大多数涉及图像自动处理的操作中的前期步
骤。例如，这些描述构成了下一章讨论的目标识别方法的输入。正如本章涵盖的描绘技术指出的那样，
具体选择其中的哪一种方法，将取决于所考虑的问题。目的是选择能够“捕获”物体或物体类之间的
本质差异的描绘子，同时尽可能保留位置、大小和方向的独立性。
参考文献
11.1.1节讨论的边界追踪算法由Moore[1968]首次提出。11.1.2节讨论的链码表示由Freeman[1961,19741
首次提出。关于使用链码的当前研究见 Bribiesca[1999]的著述，他还将链码推广到了三维情形
(Bribiesca[2000)。计算最小周长多边形的详细讨论和算法(见11.1.3节)见Klette和Rsenfeld[2004],还可参
见Sloboda等人[1998]及Coeurjolly及Klette[2004]的著述。11.1.4节内容的其他重要的附加主题包括不变多边
形拟合(Voss和Suesse[1997)、多边形近似算法性能的评估方法(Rosin[19971)、一般实现(Huang和Sun[19991)
和计算速度(Davis[1999])。
关于标记图(见11.1.5节)的参考文献是Ballard和 Brown[1982]及Gupta和Srinath[1988]的著述。寻找
凸壳和凸缺(见11.1.6节)的基本公式见Preparata和Shamos[1985],也可参阅由 Liu-Yu和Antipolis[1993]的
论文。Katzir 等人[1994]讨论了部分闭合曲线的检测。Zimmer 等人[1997]讨论了计算凸壳的一种改进算法，
Latecki和Lak?mper[1999]讨论了形状分解的凸性规则。
11.1.7节中讨论的骨架化算法基于Zhang和 Suen[1984]的著述。关于该算法的性质和实现的另外一些
有用的评述，包含在由Lu和Wang[1986]的论文中。Jang和Chin[1990]的论文在11.1.7节的讨论和9.5.5节中介
绍的细化形态学概念之间提供了重要的联系。对于存在噪声的细化方法，见Shi和Wong[1994]及Chen和
Yu[1996]的著述。Shaked 和Bruckstein[1998]讨论了一种可用于从骨架中消除毛刺的修剪算法。中轴变换的
快速计算由 Sahni和 Jenq[1992]及Ferreira和Ubéda[1999]进行了讨论。Loncaric[1998]撰写的综述性论文是11.1
节中讨论的多种方法的重要参考文献。
Freeman和 Shapira[1975]给出了寻找一条闭合链码曲线的基本矩形的算法(见11.2.1节)。11.2.2节中关
于形状数的讨论基于Bribiesca和Guzman[1980]及 Bribiesca[1981]的工作。关于傅里叶描绘子(见11.2.3节)的
其他读物，见Zahn和Roskies[1972]及Persoon和fu[1977]的早期论文，也可参阅Aguado等人[1998]和 Sonka
等人[1999]的著述。Reddy 和Chatterji[1996]讨论了使用FFT算法实现平移不变、旋转不变和缩放不变的一种
重要方法。11.2.4节中的内容是以基本概率理论为基础的(例如，见Peebles[1993]和Popoulis[1991])。
关于11.3.2节的其他读物，见Rosenfeld和Kak[1982]及Balard和Brown[1982]的著述。关于纹理(见11.3.3
节)优秀介绍，见Haralick和Shapiro[1992]的著述。早期关于纹理的综述，见Wechsler[1980]的著述。Murino
等人[1998]和Garcia[1999]的论文，以及 Shapiro和Stockman[2001]的讨论，是该领域当前有代表性的工作。
878
置：的
554 数字图像处理(第三版)
11.3.4节中讨论的矩不变方法源自Hu[1962]的著述，也可参阅 Bell[1965]的著述。要了解矩不变的应
用范围，可参阅Hal[1979]的关于图像匹配的论述及Cheung和Teoh[1999]的关于使用矩来描述对称性的的
论述。Mamistvalov[1998]将矩不变方法推广到了n维情形。对于任意阶矩的生成，见Flusser[2000]。
Hotelling[1933]是第一个推导并发表了将离散变量转换成不相关系数的方法的人。他把这种技术称为
主分量方法。他的论文对这种方法有相当的见地，值得一读。霍特林变换由Kramer和Mathews[1956]及Huang
和Schultheiss[1963]再次发现。主分量仍是多数应用中用于描述图像的基本工具，详见Swets和Weng[1996]
及Duda,Heart 和Stork[2001]。11.5节的参考文献来自Gonzalez, Thomason[1978]和 Fu[1982]的著述，也可
参阅Sonda等人[1999]的著述。这一章所关注的有关实现的话题的附加读物可见Nixon和Aguado[2002],以
及Gonzlez,Woods和Eddins的著述。
习题
11.1 ★(a)重新定义链码的一个起始点，以便所得的数字序列形成一个最小值整数。请证明该编码与
边界上的初始起点无关。
(b)求编码10176722335422的归一化起始点。
11.2 (a)如11.1.2节中解释的那样，证明链码的一次差分会将该链码关于旋转归一化。
(b)计算编码0110233210332322111的一次差分。
11.3 ★(a)证明11.1.3节中讨论的橡皮模多边形近似方法会生成一个具有最小周长的多边形。
(b)证明：如果每个单元对应边界的一个像素，那么该单元中的最大可能误差为d1√2.其中
d是相邻像素之间的最小可能的水平或垂直距离(即用于生成数字图像的取样网格中线间
的距离)。
11.4 在如下条件下，解释11.1.3节中的MPP算法是如何工作的：
★(a)1个像素宽、1个像素深的锯齿。
★(b)1个像素宽、2个或多个像素深的锯齿。
(e)1个像素宽、1个像素长的凸起。
(d)1个像素宽、n个像素长的凸起。
11.5 ★(a)如果在11.1.4节讨论的聚合方法中将误差阈值设为0,请讨论对所得多边形的影响。
(b)如果在分裂方法中这样做，有何影响?
11.6 ★(a)使用11.1.5节讨论的正切角方法，画出一个方形边界的标记图。
(b)使用斜率密度函数，重复上一问题。
假设该方形分别与x轴和y轴对准，且x轴为参考线。从最靠近原点的角开始。
11.7 求下列每一个边界的标记图的表达式，并画出标记图。
★(a)一个等边三角形。
(b)一个正方形。
(c)一个椭圆。
11.8 画出下列图形的中轴：
★(a)一个圆。
★(b)一个等边五边形。
(c)一个矩形。
(d)一个等边三角形。
第11章 表示和描述 555
11.9 对于如下所示的每个图形：
★(a)讨论在点p执行11.1.7节中介绍的骨架化算法的步骤1时，所产生的作用。
(b)重复该算法的步骤2。假设所有情形下p=0。
11.10 参考11.1.7节中介绍的骨架化算法。请问在执行如下操作后所示图形是什么样子?
★(a)执行完一遍该算法的步骤1。
(b)执行完一遍该算法的步骤2(在步骤1的结果上而不是原
图像上执行)。
11.11 ★(a)下图中的形状数的顺序是什么?
(b)求形状数。
11.12 11.23节中讨论的使用傅里叶描绘子的过程如下：将一个轮廓的坐标表示为复数，求这些复数的DFT,
并只保留DFT的一些分量来作为该边界形状的描绘子。求取反 DFT 即可得到原始轮廓的近似。请
问哪类轮廓形状具有由实数构成的DFT?必须怎样设置图11.19中的轴系统，才能得到这些实数?
11.13 证明：如果在式(11.2-5)中仅使用两个傅里叶描绘子(u=0和u=1)来重建一条边界，那么结果总
是一个圆。(提示：在复平面中使用圆的参数表示，并在极坐标中表示圆的方程。)
★11.14 给出区分图11.10中所示图形符号所需要的统计矩描绘子的最小数量。
11.15 给出具有相同均值和三阶统计矩描绘子但具有不同二阶矩的两个边界形状。
★11.16 提出一组能区分字符0,1,8,6和Z的形状的描绘子。(提示：联合使用拓扑描绘子和凸壳)。
11.17 考虑一幅大小为100×100像素的二值图像，图像中有一条从第1列延伸到第99列的垂直黑色条
带，及从第50列延伸到第100列的垂直白色条带。
(a)使用位置算子“右侧一个像素”求该图像的共生矩阵。
★(b)如在11.3.1节中解释的那样，归一化该矩阵，以使其元素成为概率估计。
(c)使用来自(b)的矩阵计算表11.3中的6个描绘子。
11.18 考虑一幅其中交替出现黑色和白色方块的棋盘图像，每个方块的大小为mxm。给出可以生成一个
对角共生矩阵的位置算子。
11.19 在如下条件下，求一幅其中交替出现1和0且大小为8×8的棋盘图像的灰度级共生矩阵：
★(a)位置算子Q定义为“右侧一个像素”。
(b)位置算子Q定义为“右侧两个像素”。
假设左上角像素的值为0。
11.20 证明式(11.4-7)、式(11.4-8)和式(11.4-9)的正确性。
★11.21 例11.13中曾提到，仅用与最大特征值相联系的两个主分量图像，就可重建6幅原图像的近似是
较为可靠的做法。这样做对均方误差有何影响?请将您的答案表示为最大可能误差的百分比。
1 1 0 0 0 0 0 1 0
1 p 0 1 P 0 1 P 1
1 0 0 0 0 0 1 0
1 1 0
0 P 1
0 0 0
器～善
556 数字图像处理(第三版)
11.22 对于一组大小为32×32的图像，假设式(11.4-9)给出的协方差矩阵证明是单位矩阵。原图像和仅
使用一半的原始特征向量由式(11.4-11)重建的图像间的均方误差将是什么?
★11.23 请问在什么条件下，您会期望11.2.1节中定义的边界主轴等于该边界的本征轴?
11.24 给出黑白方块棋盘图案的空间关系和对应的树形表达。假设左上角元素为黑色，并且树根对应于
该元素。要求从所构造树的每个节点引出的分支不超过两个。
★11.25 假设一家公司与您签订了设计一个图像处理系统的合同。图像处理系统用于检测某些实心塑料圆
片内部的缺陷。圆片使用一台X射线成像系统检测，所生成的8比特图像的大小为1024×1024。
不存在缺陷时，图像呈现的是平均灰度为100、方差为200的均匀图像。存在缺陷时，缺陷在图
像中表现为斑点状区域，这些区域中约有70??像素的灰度偏离40这一灰度级，或者均值小于
100。如果这样一个区域的面积超过了20×20像素，则认为此圆片有缺陷。请提出一个基于纹理
分析的系统。
11.26 一家使用瓶子盛装各种工业化学品的公司在听说您成功地解决了图像处理问题后，雇用您来设计
一种检测瓶子未装满的方法。瓶子在传送带上移动并通过自动装填和封盖机时的情形如下图所
示。当液位低于瓶颈底部和瓶子肩部的中间点时，则认为瓶子未装满。瓶子横断面的侧面与倾斜
面的区域定义为瓶子的肩部。瓶子在不断移动，但该公司有一个成像系统，该系统装备了一个前
端照明闪光灯，可有效地停止瓶子的移动，所以您可以得到非常接近于这里显示的样例图像。基
于上述资料，请您提出一个检测未完全装满的瓶子的解决方案。清楚地陈述您所做的那些可能会
影响到解决方案的所有假设。
11.27 当听说您成功地解决了装瓶问题后，一家流体公司与您进行了联系，希望能以某些处理解决气泡
自动计数工作，以便进行质量控制。该公司已解决了成像问题，并可以得到分辨率为800×800像
素的8比特图像，如下图所示。每幅图像表示一个大小为8 cm2的面积。公司希望使用每幅图像
来做两件事情：(1)确定图像中气泡所占面积与图像总面积的比率，(2)计算不同气泡的数量。基
于上述资料，请您提出该问题的一个解决方案。在您的解决方案中，必须指出可检测到的最小气
泡的物理尺寸。清楚地陈述您所做的那些可能会影响到解决方案的所有假设。
爱密
第12章 目标 识 别
这个世界最有趣的一面是可以把它看成是由各种模式组成的。模式
在本质上是一种排列，它是由元素顺序而不是这些元素的固有性质
来表征的。
—诺伯特·维纳
引言
我们通过介绍几种目标识别技术，来结束对数字图像处理的全部讨论。正如1.1节中所解释的那
样，在界定数字图像处理的覆盖范围时，包含了图像中各个区域的识别，在本章中，我们称这些区域
为目标或模式。
本章中介绍的模式识别方法主要分为两大领域：决策理论方法和结构方法。第一类方法处理的
是使用定量描绘子来描述的各种模式，如长度、面积和纹理等。第二类方法处理的是由定性描绘子来
描述的各种模式，如11.5节中讨论的关系描绘子。
识别的核心问题是通过样本模式进行“学习”这一概念。下面我们将对决策理论方法和结构方
法的学习技术进行深入讨论。
12.1 模式和模式类
模式是描绘子的组合，如第11章中讨论的那些描绘子。在有关模式识别文献中经常使用特征来
表示描绘子。模式类是指具有某些共同属性的一族模式。模式类用a),a,…,a表示，其中W是模
式类数。由机器完成的模式识别是对不同的模式赋予不同类别的技术，这种技术是自动的，并且尽可
能地减少人的干预。
实践中常用的三种模式组合是向量(用于定量描述)、串和树(用于结构描述)。模式向量由粗体
小写字母表示，如x,y和z,并采取下列形式：
(12.1-1)
其中，每个分量x,表示第i个描绘子，n是与该模式有关的描绘子的
总数。模式向量以列向量(即nx1 阶矩阵)的形式表示。因此，模式向
关于向量和矩阵的简要回
顾，请查阅本书的网站。 盈：密
558 数字图像处理(第三版)
量可以表示为式(12.1-1)所示的形式或用等价形式x=(x,x?…,x)来表示，其中T表示转置。在11.4
节中，读者应已认识这种表示法。
模式向量x中的各个分量的性质，取决于用于描述该物理模式本身的方法。下面我们使用一个
简单的例子来加以说明。这个例子不仅简单，而且给出了分类度量的历史意义。在一篇经典的论文中，
Fisher[1936]使用一种后来被称为判别分析(将在12.2节中讨论)的技术，识别了三种鸢尾花(Iris setosa,
Iris virginica和Iris versicolor),方法是测量花瓣的宽度和长度(见图12.1)。
?
爱
2.5 △Iris virginica
O Iris versicolor
△ △A
oIris setosa 0△△△
2.0
△△ A△ AAA
花瓣长度(cm) △
A△△
1.5
A口口
口 D Di
△
△
口 1.0
口mm
08o m _中
四00 口
o
0.5 o
ofoo
o
g
o
0l0 1 2 3 4 5 6 7
x
花瓣宽度(cm)
图12.1 由两个度量描述的三种鸢尾花
在当前术语中，每种花由两个度量来描述，从而生成了形如
x] (12.1-2)
的一个二维模式，其中x?和x?分别代表花瓣的长度和宽度。在这种情形下，表示为a),a?和a?的3个
模式类分别对应于setosa,virginica和versicolor三种花。
由于花瓣在宽度和长度上的不同，描述这些花的模式向量也会不同，这种不同不仅体现在不同
的类之间，也体现在一个类的内部。图12.1显示了每种鸢尾属花的几个样本的长度和宽度度量。在选
定了一组度量后(本例子中为两个度量),模式向量的分量便成为每个物理样本的完整描述。因此，这
种情形下的每朵花就成为二维欧氏空间中的一个点。我们还注意到，本例中花瓣的长度和宽度较好地
分离了Iris setosa与其他两种花，但Iris virginica和Iris versicolor的分离并不成功。这一结果说明了
经典的特征选择问题，即类的可分程度在很大程度上取决于所用的描绘子的选择。我们将在12.2节
和12.3节详细阐述这一问题。
图12.2显示了模式向量生成的另一个例子。在该例中，我们关注的是不同类型的噪声波形，其中
一个样本示于图12.2(a)。如果我们选择用其信号(见11.1.5节)来表示每个目标，则会得到图12.2(b)
所示形式的一维信号。假设我们用其取样后的幅度值来描述每个信号；也就是说，我们以指定的间隔
值θ对信号进行取样(表示为0,,θ?,…,θ)。然后，我们通过令x?=Rθ),x?=r(B?),…,x=rθ,),可构
成模式向量。这些向量成为n维欧氏空间中的点，并且模式类可以想象为n维空间中的“云团”。
第12章 目 标 识 别 559
替代直接使用信号的幅度，我们可以计算一个给定信号的前n个统计矩(见11.2.4节),并使用这
些描绘子作为每个模式向量的分量。事实上，生成模式向量的其他方法还有许多种。本章中我们将介
绍现有的一些方法。目前，应记住的关键概念是模式向量中每个分量的描绘子的选择，描述子对基于
模式向量方法的目标识别的最终性能会有深刻的影响。
a b
(8)
久
e
0 42 π 4 2π
图12.2 一个带有噪声的目标及其相应的信号
刚才描述的用于生成模式向量的技术，可得到由定量信息表征的模式类。在某些应用中，模式
特性可由结构关系来很好地描述。例如，指纹识别基于痕迹特性的相互关系，这种相互关系称为细节。
与它们的相对尺寸和位置一起，这些特性是描述指纹脊线特性的主要分量，如指纹的断点、分支、合
并和不连续线段。这类识别问题通常用结构的方法会得到很好解决，因为这种问题不仅定量度量每种
特性，而且这些特性间的空间关系决定了类别的成员。11.5节中已介绍过这一主题。这里，我们从模
式描绘子的意义上，再次对其进行简单介绍。
图12.3(a)显示了一个简单的阶梯模式。采用类似于图12.2中使用的方法，该模式可以被取样并
表示为一个模式向量。然而，如果采用这种描述方法，那么由两个简单的主要元素重复而组成的基本
结构将会丢失。一种更有意义的描述方法是定义元素a和b,并将该模式定义为如图12.3(b)所示的
串w=…abababab…。在这种描述中，该特殊模式类的结构是按如下方式得到的：以首尾相连的方
式定义连接性，且只允许符号交替。这种结构组成适用于任何长度的阶梯，但排除了由基元a和b的
其他组合生成其他类型的结果。
a b a a
|b |b
a
b
“
|b
a
|b
a
图12.3 (a)阶梯结构；(b)使用基元a和b对结
构编码，生成串描述…ababab…
串描述适于生成其结构是基于基元的较简单的连接，并且通
图12.4 建筑物密集的城市中心区(华
盛顿特区)和周围居民区的卫
星图像(原图像由NASA提供)
常是和边界形状有关系的目标模式和其他实体模式。对许多应用来说，一种更有效的方法是使用树形
描述，如11.5节中定义的那样。基本上，多数层次排序方案都会导致树结构。例如，图12.4显示了建
筑物密集的市区和周围居民区的一幅卫星图像。我们使用符号$来定义整个图像区域。图12.5中(从上
到下)显示的树形表示是通过使用结构关系“由……组成”得到的。因此，树的根表示整幅图像。下一层
表示该图像由市区和居民区构成。居民区依次由住宅、高速公路和购物中心构成。再下一层描述住宅和
高速公路。我们可以继续按这样的方式细分，直到达到我们在图像上解析不同区域的能力的极限为止。 受：要
爱：密
560 数宇图像处理(第三版)
图像
s
市区 居民区
建筑物 高速公路 房屋 购物中心 高速公路
高密度 大结构 多条 许多十字路口 环路 低密度 小结构 森林区 单条 很少十字路口
图12.5 图12.4中图像的树形描述
在接下来的几节中，我们将探讨用在前几段中讨论过的技术描述的目标识别方法。
12.2 基于决策理论方法的识别
决策理论方法识别是以使用决策(或判别)函数为基础的。如12.1节中讨论的那样，令x=(x,x?,….
x)'表示一个n维模式向量。对于W个模式类0),?,…,aw,决策理论模式识别的基本问题是依据如
下属性来找到W个决策函数d,(x),d?(x),…,dw(x):如果模式x属于类o,则
d,(x)>d,(x)j=1,2,…,W;j≠i (12.2-1)
换句话说，将x代入所有决策函数后，如果d(x)得到最大值，则称未知模式x属于第i个模式类。该
关系可以任意求解。
从类a,中分离出类a的决策边界，由满足d(x)=d(x)的x值给出，或等价地由
d,(x)-d,(x)=0 (12.2-2)
的x值给出。
通常的做法是，使用单一函数d,(x)=d(x)-d(x)=0来识别两类之间的决策边界。因此，对于模
式类a有d,(x)>0,而对于模式类a有d,(x)<0。本节的主要目的是探讨寻找满足式(12.2-1)的决策函
数的各种方法。
12.2.1 匹配
基于匹配的识别技术通过一个原型模式向量来表示每个类。根据一种预先定义的度量，将一个
未知模式赋予最接近的类。最简单的方法是最小距离分类器，如其名称所示，最小距离分类器计算该
未知模式与每个原型向量间的(欧氏)距离。它选择最小距离来决策。我们还将探讨一种基于相关的方
法，该方法可根据图像用公式来直接表达，因此相当直观。
最小距离分类器
假设我们把每个模式类的原型定义为该类模式的平均向量：
m,-六Zx,j=1,2.…,w (12.2-3)
其中，N,是来自a,类模式向量的数量，求和操作是对所有这些向量执行的。如以前那样，W是模式
类的数量。如前所述，求未知模式向量x的类成员的一种方法是，将它赋给其最接近的原型类。使用
欧氏距离求接近程度可将该问题简化为计算如下距离度量：
D,(x)=|x-m,|j=1,2,…,W (12.2-4)
第12章 目 标 识 别 561
其中，|a|=(a'a)12是欧几里得范数。然后，若D(x)是最小距离，则把x赋给类a)。也就是说，最小
距离意味着该式表示最好的匹配。不难证明(见习题12.2),选择最小距离等同于计算函数
d,(x)=x'm,-2m'm, j=1,2,…,W (12.2-5)
并在d(x)获得最大数值时，将x划归类a。该式与式(12.2-1)中定义的决策函数的概念是一致的。
由式(12.2-2)和式(12.2-5),对于一个最小距离分类器，类w和类a)之间的决策边界为
d,(x)=d;(x)-d(x)
=x'(m,-m,)-2(m,-m,)'(m,+m,)=0 (12.2-6)
由式(12.2-6)给出的决策面是连接m,和m,的线段的垂直等分线(见习题12.3)。n=2时，垂直等分线是一
条直线；n=3时，它是一个平面；n>3时，称其为一个超平面。
例12.1 最小距离分类器的说明。
图12.6显示了从图12.1的鸢尾属植物例子中提取的两个模式类。两个模式类Iris versicolor和Iris setosa
分别表示为o和a?,其样本均值向量为m=(4.3,1.3)和m?=(1.5,0.3)2。由式(12.2-5)可知，决策函数为
d(x)=x'm;-m'm,=4.3x+1.3x?-10.1
和
d?(x)=x'm2-im'm?=1.5x+0.3x?-1.17
由式(12.2-6)可知，边界方程为
d?(x)=d?(x)-d?(x)=2.8x?+1.0x?-8.9=0
图12.6显示了该边界的图形(注意，轴的比例不同)。代入来自类a)的任何模式向量，都会得到d?(x)>0。
相反，代人来自类a,的任何模式向量，都会得到d?(x)<0。换句话说，给定一个属于这两个类之一的未
知模式，d?(x)的符号将足以确定该模式的归属。
2
□ Iris versicolor
o Iris setosa
2.0 2.8x,+1.0x? -8.9=0
花瓣宽度(cm) 1.5 品口
D
口 1.0
Lm
ao a
B0口 田
中
0.5
°
o fr +
o
o780 0l0 1 2 3 4 5 6 7
x
花瓣长度(cm)
图12.6 类Iris versicolor和类Iris setosa的最小距离分类器的决策边界。黑点和方块是均值 多：圈
562 数字图像处理(第三版)
实际上，就每个类的均值而言，当均值间的距离与每个类的分散度或随机性相比较大时，最小
距离分类器工作得很好。在12.2.2节中，我们将证明：当每个类关于其均值的分布在n维模式空间中
表现为一种球形的“超云团”形式时，最小距离分类器(在最小化错误分类的平均损失方面)会产生最
佳性能。
受塞
实际中，很少同时出现较大的均值分离和
相对较小的散布，除非系统设计人员能控制输
入的性质。一个很好的例子就是设计用于读取
固定格式字符的系统，如我们熟知的美国银行
家协会的E-13B字型的字符集。如图12.7所
示，这个特殊字体的字符集由14个字符组成，
为便于读取，这些字符被特意设计在大小为9×7
的网格中。这些字符通常使用含有很细的磁性
材料的油墨来印刷。在读取这些字符之前，对
油墨施加一个磁场来加重每个字符，以便简化
检测。换句话说，通过人为地突出每个字符的
关键特征，解决了分割问题。
M
M v
^
v^v
^^
一
W 通常使用单缝读取头来水平扫描字符，读
取头与字符相比要窄一些、长一些。当读取头横 ●■ ^W 向移过一个字符时，会产生一个一维电信号(一 心 个信号),该电信号与读取头下方字符面积的增
大率或减小率成正比。例如，考虑与图12.7中数 D……01 MVv 字0相关联的波形。当读取头从左向右移动时，
读取头看到的字符面积开始增大，从而产生一个
图12.7 美国银行家协会E-138字符集和对应的波形 正导数(一个正变化率)。当读取头开始远离0的
左半部时，读取头下方的字符面积开始减少，从而产生一个负导数。当读取头位于该字符的中间区域时，
字符面积几乎保持不变，从而产生一个零导数。当读取头进入该字符的右半部分时，这种模式自身重复
一次。这种字体设计确保了各个字符的波形是完全不同的，同时也确保了每个波形的峰值和零值大致出
现在背景网格的垂直线上，如图12.7所示。E-13B字符具有这样一个性质，即仅在这些点处对波形取样
就可产生进行正确分类的足够信息。磁性油墨的使用有助于提供干净的波形，从而使分散性最小化。
针对这一应用设计一个最小距离分类器相当简单。我们只需要存储每个波形的样本值，然后将
每组样本表示为一个原型向量m,j=1,2,…,14。当对一个未知字符进行分类时，方法是使用刚才描
述的方式扫描它，将波形的网格样本表示为一个向量x,然后依据式(12.2-5)得到的最高值选择原型向
量的类。该类即为该原型向量所属的类。使用由一组电阻器组成的模
当函数不同时，我们应将相关正 拟电路可实现高速分类(见习题12.4)。 式地称为互相关，面当函数相同时。
则应将相关称为自相关。但是，当 相关匹配 一个给定应用中两个函数相同或不
在3.4.2节中，我们介绍了空间相关的基本概念，并且在该节将它 同很明确时，通常使用相关这一通
广泛地用于空间滤波。在4.6.7节和表4.3中，我们也简要地提到了相 用术语
关定理。由式(3.4-1)可知，大小为mxn的模版w(x,y与图像f(x,y)的相关可表示为
cx,=ZZmsofa+3.y+) (12.2-7a)
第12章 目 标 识 别 563
其中，求和的上下限取w和f的共同范围。对变量x和y的所有偏移值计算该式，以便w的所有元素
访问f的每个像素，这里假设f大于w。就像空间卷积通过卷积定理与函数的傅里叶变换相联系那样，
空间相关通过相关定理与函数的变换相联系：
f(x,y)☆w((x,y)?F*(u,v)W(u,v) (12.2-7b)
其中，☆表示空间相关，F*是F的复共轭。表4.3中说明的相关定理的另一半对当前讨论而言并不
重要。式(12.2-7b)是傅里叶变换对，除了我们使用函数的一个复共轭之外，其解释与式(4.6-24)是一
样的。式(12.2-7b)的傅里叶反变换得到一个类似于式(4.6-23)的二维循环相关，并且 4.6.6节中讨论
的卷积填充问题同样适用于相关。
我们并不打算详述前述公式，因为它们对f和w的尺度变化很敏感。作为替代，我们使用如下的
归一化相关系数：2
(12.2-8)
其中，求和的上下限取w和f的共同范围，w是模板的平均值(只计算一次),了，是f中与w重合区
域的平均值。通常，我们将w称为模板，而将相关称为模板匹配。可
以证明(见习题12.7),y(x,y)的值域为[-1.1],因而f和w的幅度变 相关的机理。 化是归一化的。当归一化的w和f中对应的归一化区域相同时，y(x,y)
出现最大值。这说明了最大相关(即最好可能的匹配)。当两个归一化函数在式(12.2-8)的意义下表现
出最小相似性时，会出现最小值。相关系数不能用傅里叶变换来计算，因为该式中存在非线性项(除
法和平方)。
图12.8说明了刚才讨论的步骤的机理。如3.4.2节中
解释的那样，当w的中心位于f的边界上时，围绕f的边
界需要进行填充(在模板匹配中，当模板的中心越过图像
的边界时，相关的值通常并不重要，因此填充被限制为模
板宽度的一半)。为表示方便，我们通常只关心奇数大小
的模板。
回顾34.2节有助于我们了解空间
(m-1/2
图12.8显示了一个大小为mxn的模板，其中心位于
任意位置(x,y)。在这一点的相关可以用式(12.2-8)得到。
然后，该模板的中心移到一个相邻位置，重复该过程。通
过移动该模板的中心(即增大x和y),以便w的中心访问
f中的每个像素，可得到所有的相关系数y(x.y)。在该过程
的最后，我们寻找y(x,y)中的最大值，从而找到出现最好
原点
1+n→| (n-1)/2→
中m
中心在任意位置
(x,y)的模板
图像!
ui
填充
图12.8 模板匹配的机理
匹配的位置。在y(x,y)中可能会有多个位置出现最大值，此时表明w和f之间有多个匹配。
例12.2 用相关进行匹配。
图12.9(a)显示了一幅大小为913x913的Harricane Andrew 飓风卫星图像，其中暴风眼清晰可见。作
为相关的一个例子，我们希望找到图12.9(b)中的模板在图(a)中最好匹配的位置，模板是暴风眼的一幅较
小的(31×31)子图像。图12.9(c)显示了由式(12.2-8)计算的相关系数。由于填充(见图12.8),该图像的原始
大小为943×943 像素，但为了显示的目的，我们把它裁剪到原始图像大小。在该图像中，灰度与相关值 88
器邕
564 数字图像处理(第三版)
成正比，并且所有的负相关都截为0(黑),以简化该图像的视觉分析。相关图像的最亮点在接近飓风眼的
位置清晰可见。图12.9(d)将最大相关显示为一个白点(此时，存在一个最大值为1的唯一匹配),我们看
到它与图12.9(a)中的飓风眼位置紧密对应。
a be d
图12.9 (a)飓风Haricane Andrew的卫星图像，摄于1992年8月24日；(b)飓风眼的模板；(c)显示为图像的相关系
数(注意最亮点);(d)匹配最好的位置。该点是单个像素，但其已被放大，以便于查看(原图像由NOAA提供)
前述讨论表明，对被处理的函数的灰度值变化进行归一化相关是可能的。对尺寸和旋转归一化
是一个更复杂的问题。尺寸归一化涉及空间缩放，正如2.6.5节和4.5.4节中解释的那样，即图像重采
样。为了使重采样有意义，必须知道被重新缩放的图像的大小。在某些情况下，这可能变成一个很困
难的问题，除非是在有空间线索可用的情况下。例如，在遥感应用中，如果已知成像传感器的观察几
何(典型的就是这种情况),假设视角固定，那么知道传感器相对于成像区域的高度将足以归一化图像
尺寸。类似地，旋转归一化要求已知图像被旋转的角度。这再一次要求空间线索。在刚才给出的遥感
例子中，飞行方向可能足以把遥感图像旋转到一个标准方向。在没有约束条件的情形下，尺寸和旋转
归一化会成为相当具有挑战性的任务，因为它要求自动检测可作为空间线索的图像特性(如11章讨论
的那样)。
12.2.2 最佳统计分类器
在这一节中，我们将讨论一种识别的概率方法。就像在大多数处理度量和判读物理事件的领域中那
样，在模式识别中对概率的考虑变得十分重要，因为此时模式类通常会随机生成。如下面的讨论所示，
在平均意义上有可能推导出一种最佳分类方法，用该方法会产生最低的错误分类的概率(见习题12.10)。
基础知识
来自类别w的特定模式x的概率表示为p(w,/x)。如果模式分类器判断x来自类a),而实际上它
来自类a,那么分类器就会导致一次损失，表示为L。由于模式x可能属于所考虑的W个类中的任
何一个类，故将模式x赋予类)的平均损失为
a)=Lrlo/x) (12.2-9)
该式在决策理论术语中通常称为条件平均风险或损失。
由基础概率论可知，p(A/B)=[p(A)p(B/A)/p(B)。使用该式，我们 关于概率论的简要回顾。请
读者查阅本书的网站
可将式(12.2-9)写为
r(x)=∑px/o)Pea) (12.2-10)
其中，p(x/w)是来自类a的模式的概率密度函数，P(w)是类a出现的概率(有时这些概率称为先验概
率)。由于1/p(x)为正，并且对所有的r(x),j=1,2,…,W都是如此，故可将它从式(12.2-10)中忽略而
第12章 目 标 识 别 565
不影响这些函数从最小值到最大值的相对顺序。然后，平均损失的表达式就简化为
a)=∑plx/o)P) (12.2-11)
分类器有W个可能的类，任何给定的未知模式可从这些类中选择。如果分类器为每个模式x计
算r,(x),r?(x),…,rn(x),并将该模式以最低损失赋给相应的类，则关于所有决策的总体平均损失将是
最低的。这种将总体平均损失降至最低的分类器称为贝叶斯分类器。因此，如果r(x)<r(x),j=1,2,…,
W且j≠i,那么贝叶斯分类器将未知模式x赋给类a)。换句话说，如果对所有的j且j≠i有
()=2Lpa/o)pPea)<LLpx/a,)Pa) (12.2-12)
那么x将赋给类w。通常，正确决策的损失通常被赋予零值，而不正确决策的损失通常被赋予相同的
非零值(譬如值1)。在这些条件下，损失函数变为
L=1-8, (12.2-13)
式中，i=j时δ=1,i≠j时δ,=0。式(12.2-13)表明，不正确决策的损失是1,正确决策的损失是0。
将式(12.2-13)代入式(12.2-11)得到
(x)=2a-8,)p(x/o)Pa)=P(x)-pCx/a,)pPao) (12.2-14)
如果对所有的j≠i有
p(x)-p(x/a)P(w)<P(x)-p(x/w,)P(w,) (12.2-15)
或者等价地有
p(x/o,)P(o,)>p(x/o,)P(w,) j=1,2,…,W;j≠i (12.2.16)
那么贝叶斯分类器将模式x赋给类a。参考推导出式(12.2-1)的讨论，我们知道0-1损失函数的贝叶
斯分类器不过是如下形式的决策函数的计算：
d,(x)=p(x/w,)P(@,) j=1,2,…,W (12.2-17)
其中，模式向量x赋给其决策函数取得最大值的类。
式(12.2-7)给出的决策函数在最小化错误分类中的平均损失方面是最佳的。然而，要保持这一最
佳性，就必须知道每个类中的模式的概率密度函数及每个类出现的概率。后一要求通常不成问题。例
如，如果所有的类等概率出现，那么p(a)=1/W。即使该条件不正确，由该问题的知识我们通常也可
以推出这些概率。概率密度函数p(x/a)的估计就是另一回事了。如果模式向量x是n维的，那么p(x/a)
是一个n元函数，如果该函数的形式未知，就需要使用多元概率论方法来对它进行估计。这些方法在
实际应用中很困难，尤其是代表每一类的模式数目不大或概率密度函数潜在的形式不能很好地表示时
更是如此。由于这些原因，使用贝叶斯分类器时，通常假设对各种密度函数有一个解析表达式，且来
自每个类的样本模式有一个必需的参数估计。目前，p(x/a)的最为通用的假设形式是高斯概率密度函
数。这种假设与真实情况越接近，贝叶斯分类器方法在分类中就越能接近最小平均损失。
高斯模式类的贝叶斯分类器
我们先考虑一个一维问题，该问题包含有由高斯密度决定的两个模式类(W=2),这两个模式类的
均值分别为m?和m?,标准差分别为o?和o?。由式(12.2-17)可知，贝叶斯决策函数的形式为 爱器
密：圈
566 数字图像处理(第三版)
a0=w/o)ra)=ra),j=l2 (12.2-18)
其中，这些模式现在是标量，由x表示。图12.10显示了这两类的概
率密度函数曲线。两类之间的边界是一个单点，它由满足d?(x?)=d?(x?)
的x?表示。如果两个类出现的概率相同，则P(@)=P(@)=1/2,且决
策边界是满足p(x,/w)=p(x,/a?)的x?值。如图12.10所示，该点是两
个概率密度函数的交点。任何处于x?点右侧的模式(点)都被划归类a。同样，任何处于x?点左侧的
任何模式(点)都被划归类a?。当两个类出现的概率不相等时，如果类a,出现的概率大，则点x?左移；
反之，如果类o?出现的概率大，则点x?右移。这是我们期望的结果，因为分类器总是试图将错误分
类的损失降至最低。例如，在极端情形下，如果类a,从不出现，那么分类器总是将所有模式划归类a,(即
点x?移向负无穷大),故从不会出现错误。
在n维情形下，第j个模式类中的向量的高斯密度为
a/)-u
像 10.3.3节中提及的那样。一元
贝叶斯分类器是最优阀值处理函数
的事实，请参阅本节末尾的注释。
(12.2-19)
p(x/w?)
概率密度 p(x/m?)
m2 Xo m: X
图12.10 两个一维模式类的概率密度函数。如果两个类出现的概率相等，那么所示的点x?就是决策边界
其中，每个密度完全由其均值向量m,和协方差矩阵C,确定，均值向量和协方差矩阵定义如下：
(12.2-20) m,=E,{x}
和
C,=E,{(x-m,)(x-m,)2} (12.2-21)
其中，E,{}表示类w)的模式的自变量的期望值。在式(12.2-19)中，n是模式向量的维度，ICJ是矩阵
C,的行列式。使用所讨论量的平均值来近似期望值E,可得到均值向量和协方差矩阵的估计，即
m,-六Z (12.2-22)
和
c-÷∑m2-mm) (12.2-23)
式中，N,是来自类a,的模式向量的数量，求和操作是对所有这些向量执行的。在本节后面，我们将给
出一个如何使用这两个表达式的例子。
第12章 目 标 识 别 567
协方差矩阵是对称的和半正定的。如11.4节中解释的那样，对角 关于向量和矩阵的简要回 线元素c是模式向量的第k个元素的方差，非对角线元素c是x和x 顾，请查阅本书的网站 的协方差。当协方差矩阵的非对角线元素均为零时，多元高斯密度函数
就简化为x的每个元素的单变量的高斯密度的乘积。当向量元素x,和x?不相关时，会出现这种情况。
根据式(12.2-17),类a)的贝叶斯决策函数为d(x)= p(x/a)P(a)。然而，由于高斯密度函数的指
数形式，用这个决策函数的自然对数形式更为方便。换句话说，我们可以使用如下形式：
d,(x)=In[p(x/o,)P(w,)]=In[p(x/@,)+In P(a;)] (12.2-24)
从分类性能方面看，该表达式等同于式(12.2-17),因为对数函数是单调递增函数。换句话说，式(12.2-17)
中的决策函数的数值顺序与式(12.2-24)中的数值顺序是相同的。将式(12.2-19)代入式(12.2-24)中可得
d,(x)=nP(a)-2m2m-mcl-[(x-m,'c;'(x-m,] (12.2-25)
项(n/2)ln 2π对所有的类都是相同的，因此可以从式(12.2-25)中消去，消去该项后的式(12.2-25)变为
d,(x)=m P@)-mlcl-[(x-m,)'c(x-m,)] (12.2-26)
其中j=1,2,…,W。式(12.2-26)表示高斯模式类在0-1损失函数条件下的贝叶斯决策函数。
式(12.2-26)中的决策函数是超二次曲面(n维空间中的二次函数),因为出现在该式中的x的分量
的各项没有高于二次的。毫无疑问，高斯模式的贝叶斯分类器的作用至多是将一个通用二阶决策面放
到两个模式类之间。然而，如果模式总体确实是高斯的，则在分类中不会有其他曲面所产生的损失小
于平均损失。
如果所有的协方差矩阵都相等，则C,=C,j=1,2,…,W。展开式(12.2-26)并消去所有独立于j的
项，可得
d(x)=hnP(o,)+x'c'm,-mJc'm, (12.2-27)
这是一个线性决策函数(超平面),其中j=1,2,…,W。
另外，如果C=1,这里I是单位矩阵，且P(a)=1/W,j=1,2,…,W,则有
d,(x)=x'm,--m'm,j=1,2,…,W (12.2-28)
这些是最小距离分类器的决策函数，就像式(12.2-5)中给出的一样。如果：(1)这些模式类都是高斯的，
(2)所有协方差矩阵都等于单位矩阵，并且(3)所有类出现的概率相等，则在贝叶斯意义上最小距离分
类器是最佳的。满足这些条件的高斯模式类是n维空间中外形相同的球状云团(称为超球面)。最小距
离分类器在每对类之间建立一个超平面，超平面有如下特性，它是连接这对超球面的中心的垂直平分
线。在两个维度上，这些类组成多个圆形区域，并且边界变为连接每对圆的中心的直线的垂直平分线。
例12.3 三维模式的贝叶斯分类器。
图12.11 显示了两个模式类在三维空间中的一个简单排列。我们用这些模式来说明实现贝叶斯分类器
的机理，假设每个类的模式都是来自一个高斯分布的样本。
对图12.11中的模式应用式(12.2-22),得到
和
-
圈：器
568 数字图像处理(第三版)
类似地，对两个模式类依次应用式(12.2-23)会得到两个协方差矩阵，此时这两个矩阵是相等的：
-c
因为协方差矩阵相等，故贝叶斯决策函数由式(12.2-27)给出。若假设P(a)=P(a)=12,则应用式(12.2-28)
可得
d,(x)=x'c'm,-mJC-m,
其中，
对d(x)执行向量矩阵展开，给出决策函数如下：
d,(x)=4x-1.5 和 d?(x)=-4x?+8x?+8x?-5.5
分隔两个类的决策面为
d(x)-d?(x)=8x-8x?-8x,+4=0
图12.11 显示了该决策面的剖面，我们注意到两个类已被有效地分隔开了。
x
899
(0.0.1) (0.1.1)
(.6.1) (1.1,1)
(0.0.0) (0.1.0) A2
(1,0.0) (1.1,0)
·的
e 2
图12.11 两个简单的模式类及其贝叶斯决策边界(阴影所示)
贝叶斯分类器方法最成功的应用之一是对由飞行器、卫星或空间站上携带的多光谱扫描器生成的
遥感图像进行分类。对这些平台上产生的大量图像数据使得图像自动分类和分析成为遥感的重要任务。
遥感应用相当广泛，包括土地利用调查，农作物产量调查，农作物灾害检测，森林、空气质量和水质
的监测，地质研究，天气预报，以及其他许多对环境有重要意义的领域。下例显示了一个典型应用。
例12.4 使用贝叶斯分类器对多光谱数据进行分类。
如13.4节和11.4节中讨论的那样，多光谱扫描器响应于所选电磁能谱的波段，例如0.45-0.52,0.52-0.60,
0.63-0.69和0.76-0.90微米波段。这些范围分别处于可见蓝光、可见绿光、可见红光和近红外波段。按这
第12章 目 标 识 别 569
种方式扫描一个区域，会生成该区域的4幅数字
图像，每个波段一幅。如果这些图像已在空间上
配准(实践中满足的一个条件),那么可将这些图
像想象为堆叠在一起，如图12.12所示。这样，就
像我们在11.4节中所做的那样，地面上的每个点都
可以由形如x=(x,x,x,x)的一个四元素模式向量
表示，其中x,为蓝光图像，x?为绿光图像，等等。
如果这些图像的大小都是512×512像素，那么这
4幅多光谱图像的每种堆叠可由266 144个四维模式
向量表示。像前面说明的那样，高斯模式的贝叶斯
分类器要求估计每个类的均值向量和协方差矩阵。
在遥感应用中，这些估计是通过从每个感兴趣区域
中收集其类别已知的多光谱数据得到的。然后，
波段4
波段3
波段2
波段1
图12.12 由多光谱扫描器生成的4幅数字图像
经像素配准后，所形成的模式向量
就像在例12.3中那样，结果向量用于估计所需的均值向量和协方差矩阵。
图12.13(a)到(d)显示了华盛顿特区的4幅大小为512×512的多光谱图像，这些图像是在前段中提及的
波段范围拍摄的。我们的兴趣是把由这些图像包含的区域中的像素分类到3个模式类之一：水体、市区和
植被。图12.13(e)中的模板已叠加到这些图像上，以提取这3个类的典型样本。样本的一半用于训练(即估
计均值向量和协方差矩阵),另一半用于独立测试，以评估初始分类器的性能。在无约束条件的多光谱数据
分类中，由于通常并不知道先验概率P(a),所在我们在这里假设它们是相等的，即P(a)=1/3,i=1,2,3。
图12.13 多光谱数据的贝叶斯分类：(a)~(d)可见蓝光、可见绿光、可见红光和近红外波长图
像；(e)显示(1)水体、(2)市区和(3)植被的样本区域的模板；(1分类结果。黑点表
示未正确分类的点，其他(白)点是正确分类的点；(g)分类为水体的所有图像像素(白
色);(h)分类为市区的所有图像像素(白色);i)分类为植被的所有图像像素(白色) 圈:g
貌～索
570 数字图像处理(第三版)
表12.1 多光谱图像数据的贝叶斯分类
训练模式 无 关模式
已划分的类 % 已划分的类 %
类 样本数 1 2 3 正确率 类 样本数 1 2 3 正确率
1 484 482 2 0 99.6 1 483 478 3 2 98.9
2 933 0 885 48 94.9 2 932 0 880 52 94.4
3 483 0 19 464 96.1 3 482 0 16 466 96.7
表12.1 总结了使用训练数据集和独立数据集得到的识别结果。正确识别的训练模式向量的百分比和
独立模式向量的百分比，对两个数据集而言近似相等，这表明了参数估计的稳定性。两种情形下的最大
误差是来自市区的模式。这并未出人意料，因为植被也出现在那里(注意，在植被区域或市区没有模式被
错误地分类为水体)。图12.13f中将错误分类的模式显示为黑点，而将正确分类的模式显示为白点。在
区域1中看不到黑点，因为7个错误分类的点非常靠近白色区域的边界。
图12.13(g)到(i)更为有趣。这里，我们使用从训练数据中获取的均值向量和协方差矩阵，将所有图
像像素分为了三个类别之一。图12.13(g)以白色显示了分类为水体的所有像素。未被分类为水体的像素
使用黑色显示。我们看到，贝叶斯分类器对确定哪一部分是水体的工作做得很出色。图12.13(h)以白色
显示了市区发展的所有像素；系统出色地识别了市区特性，如桥梁和高速公路。图12.13(i)显示了被分类
为植被的像素。图12.13(h)表明中心城区的白色像素高度集中，其密度与到图像中心的距离为函数递减。
图12.13(i)显示了相反的效果，表明图像的中心植被很少，而在城市开发区植被最多。
我们在10.3.3节开始时曾提到过，阈值处理可视为一个贝叶斯问题，它最佳地将模式赋给两个
类或多个类。事实上，如前一问题所示，逐像素地分类实际上是一个分割问题，即把一幅图像分成两
个或多个可能的区域。如果仅使用了一个单变量，则式(12.2-17)变成一个最佳函数，它基于一幅图
像的像素的灰度来分割该图像，就像我们在10.3节中所做的那样。记住，最佳性要求已知每个类的
概率密度函数和先验概率。如前面提及的那样，估计这些密度并不容易。如果必须作出假设(譬如假
设为高斯密度),则在分割中所能实现的最佳程度，与这些假设接近真实情况的程度成正比。
12.2.3 神经网络
前两节讨论的方法基于使用样本模式来估计每个模式类的统计参数。最小距离分类器完全由每
个类的均值向量来确定。类似地，对于总体为高斯分布的贝叶斯分类器完全由每个类的均值向量和协
方差矩阵确定。用于估计这些参数的(已知其所属的类)模式通常称为训练模式，来自每个类的这样一
组模式称为训练集。使用训练集得到决策函数的过程称为学习或训练。
在刚才讨论的两种方法中，训练是一件简单的事情。每个类的训练模式被用于计算对应于该类
的决策函数的参数。估计出问题中的参数后，分类器的结构就被固定，且其最终的性能将取决于实际
模式总体是否满足所用的分类方法推导中所做的统计假设。
一个问题中的模式类的统计特性通常是未知的，或者是无法估计的(回想前一节中关于多元统计
的难点的简单讨论)。实际上，此类决策理论问题最好由直接通过训练生成所需决策函数的方法来处
理。然后，就没有必要再做关于基本的概率密度函数或关于所考虑模式类的其他概率信息的假设。在
这一节中，我们将讨论满足这一准则的各种方法。
背景知识
以下内容的本质是使用大量的基本非线性计算单元(称为神经元),这些单元以网络的形式进行
组织，就像大脑中神经元的互连那样。得到的模型有各种各样的名称，包括神经网络、神经计算机、
第12章 目 标 识 别 571
并行分布式处理(PDP)模型、神经形态学系统、分层自适应网络和连接模型。这里，我们使用神经网
络这一名称，或简称为神经网。我们使用这些网络作为工具，通过对模式的训练集的逐次描述，自适
应地导出判别函数的系数。
神经网络受到关注可以追溯至20世纪 40年代早期，详见McCulloch和Pits 的工作[1943]。他们
提出了神经元模型，该模型用二进制门限器件和包括0-1和1-0的神经状态突变的随机算法作为神经
系统建模的基础。Hebb[1949]的后续工作是以数学模型为基础的，该模型试图通过增强或联合来掌握学
习这一概念。
20世纪50年代中期至60年代早期，Rosenblat[1959,1962]发明的被称为学习机的一类机器引起
了模式识别理论领域的研究人员和从业者的巨大兴趣。人们对这些称为感知机的机器如此关注的原因
是由数学证明的进展显示：当使用线性可分的训练集(即由一个超平面分隔的训练集)进行训练时，这
些感知机会在有限数量的迭代步骤后收敛到一个解。采用超平面系数形式的这个解，能正确地分离由
该训练集的模式表示的类。
遗憾的是，人们很快就对看起来有良好理论基础的学习模型大失所望。当时，基本的感知机及
其推广还很简单，不足以解决多数有实际意义的模式识别任务。后来，通过研究多层这样的器件，人
们试图扩展类感知机的能力，尽管它们在概念上很吸引人，但是都缺乏原型感知机那样有效的训练算
法。Nilsson[1965]总结了20世纪60年代中期学习机领域的状况。几年之后，Minsky和Papert[1969]
提出了类感知机机器的局限性这一令人气绥的分析。这一看法一直持续到20世纪80年代中期，佐证
文献见Simon[1986]。在这篇最初于1984年以法文发表的文章中，Simon以“一个神话的诞生和死亡”
为题驳斥了感知机。
Rumelhart, Hinton和Williams[1986]对多层感知机的新训练算法的研究，使得事情出现了转机。
他们的基本方法(通常称为反向传播方式学习的通用 delta 法则),为多层机器提供了一种有效的训练
方法。尽管不能像证明单层感知机那样证明这种训练算法也收敛到一个解，但通用delta 法则已成功地
解决了大量的实际问题。这一成功使得多层类感知机机器已成为当前所用神经网络的主要模型之一。
两个模式类的感知机
在这种最基本的形式中，感知机学习一个线性决策函数，该决策函数对分两个线性可分的训练集。
图12.14(a)图示地显示了两个模式类的感知机模型。这个基本装置的响应基于其输入的加权和，即
x)=Zwx+wm (12.2-29)
这是一个与模式向量的分量有关的线性决策函数。称为权重的系数w,i=1,2,…,n,n+1在对输入求
和前，对这些输入进行修正，并馈送到阈值单元中。在这一意义上，权重类似于人类神经系统中的神
经突触。将求和连接的输出映射为该装置的最终输出的函数，有时称为激活函数。
当dx)>0时，阈值单元使感知机的输出为+1,这表明模式x被识别为属于类a)。当dx)<0时，情
形正好相反。这种操作模式与之前的注释为两个类使用单个决策函数的式(12.2-2)是一致的。当dx)=0
时，x位于分隔两个模式类的决策面上，这给出了一个不能确定的条件。由感知机实现的决策边界是
通过令式(12.2-29)等于零得到的：
d(x)=2wx+wm=0 (12.2-30)
或
wix+W?X?+…+waX+Wa=0 (12.2-31) 象受
07
572 数字图像处理(第三版)
这是在n维模式空间中的一个超平面方程。在几何上，前n个系数确定超平面的方向，而最后一个系
数w与从原点到超平面的垂直距离成正比。因此，如果w+=0,则超平面通过模式空间的原点。
类似地，如果w=0,则超平面平行于x;轴。
图12.14(a)中阈值单元的输出取决于d(x)的符号。替代测试整个函数来确定它是正还是负，我们
可以对w+项检验公式(12.2-29)的求和部分，此时系统的输出是
(12.2-32)
该实现等同于图12.14(a)并显示在图12.14(b)中，唯一的不同是，阈值函数被量-wa+取代，且常量
单位输入不再出现。在本节后面讨论多层神经网络的实现时，我们会回顾这两个公式的等价性。
[x? w
x2
模式向量 *·。 dx)-2mx+m
x
x
w, 2
。:: 激活元素
x
W
1
W+1
权重
[x? 0
02 A2
模式向量 重垂垂 1以x
x
x? w
2 0= 于+ 重重曲
a
b
激活元素 w%
图12.14 两个模式类的感知机模型的两种等效表示
另一个常用的公式是扩充这些模式向量，方法是附加一个额外的第(n+1)个元素，该元素总等于1,
n并附加一个额外的元素y=1。然后，式(12.2-29)变为
而不管类成员是什么。也就是说，扩充后的模式向量y是从模式向量x创建的，方法是令y=x,i=1,2,…,
第12章 目 标 识 别 573
d)=2wy=w2y (12.2-33)
其中y=(v,y?…,y,D现在是一个扩充的模式向量，而w=(w,W?,…,Wmwn+)称为权向量。该表
达式在表示时通常更为方便。然而，不管使用的公式是什么,关键问题都是使用来自两个类的一个给
定模式向量训练集来找到w。
训练算法
下面的讨论中给出的算法都是过去几年来为训练感知机提出的大量方法中具有代表性的方法。
线性可分的类：用于求两个线性可分训练集的权重向量解的一种简单迭代算法如下。对于两个
分别属于类w,和类o?的扩充模式向量的训练集，令w(1)表示初始权重向量，它可能是任意选择的。
然后，在第k步迭代中，如果y(k)∈a且w1(k)y(k)≤0,则使用下式代替w(k):
w(k+1)=w(k)+cy(k) (12.2-34)
其中，c是一个正的修正增量。相反，如果y(k)∈a?且w'(k)y(k)≥0,则使用下式代替w(k):
w(k+1)=w(k)-cy(k) (12.2-35)
否则，保持w(k)不变：
w(k+1)=w(k) (12.2-36)
该算法仅当正被考虑的模式在训练序列第k步被错误分类时，才改变w。假设修正增量c为正，现在
它是一个常量。该算法有时称为固定增量校正准则。
当两个类的整个训练集循环通过机器而不出现任何错误时，该算法收敛。如果模式的两个训练
集是线性可分的，那么固定增量校正准则会在有限步内收敛。称为感知机训练定理的该结果的证明，
请参阅Duda,Hart和Stork[2001],Tou和Gonzalez[1974]及Nilsson[1965]撰写的书籍。
例12.5 感知机算法示例。
考虑图 12.15(a)中所示的两个训练集，每个训练集由两个模式组成。因为两个训练集都是线性可分
的，所以该训练算法将会成功。在应用算法之前，模式先被扩充，对类a,生成训练集{(0,0,12,(0,1,D').
对类a?生成训练集((1,0,D2,0,1,1)'}。令c=1,w(1)=0,并按如下步骤顺序提交这些模式：
om-a- w0-
visa-alj )--
voro-a
-
vrro-a
其中，如式(12.2-34)和式(12.2-35)指出的那样，由于错误分类，在第一步和第三步中进行了权重向量修 受
言象
574 数字图像处理(第三版)
正。由于仅当算法对所有训练模式完全无误迭代时，才能得到一个解，故必须再次提交训练集。机器学
习过程按如下方式继续：令y(5)=y(1),y(6)=y(2),y(7)=y(3),y(8)=y(4),并以同样的方式进行。k=14时
收敛，得到的权重向量解为w(14)=(-2,0.1)'。相应的决策函数是dy)=-2y,+1。通过令x?=y,返回原
始模式空间，得到d(x)=-2x?+1.当集合等于0时，它变成图12.15(b)所示的决策边界的方程。
不可分的类：实际上，线性可分的模式类是个例外，通常情况并非如此。因此，20世纪60年代
和70年代，大量的研究工作转向处理不可分模式类的技术开发。随着神经网络训练方面取得进展，
解决不可分行为的许多方法已成为仅具有历史意义的课题。然而，一种早期的方法与该讨论直接相关，
这就是原始的delta规则。称为感知机训练的Widrow-Hoff 或最小均方(LMS)delta规则，该规则在任
何训练步骤都使得在实际响应与期望响应间的误差最小。
d(x)=-2x?+I=0 a b x? 2
1C 1(
x x? 0 0 1
O的
图12.15(a)属于两个类的模式；(b)由训练确定的决策边界
考虑准则函数
I(w)={(r-w?y2 (12.2-37)
其中，r是期望的响应(即当扩充后的训练模式向量y属于类a,时有r=+1,而当y属于类a?时有
r=-1)。为在r=w'y时求该函数的最小值，其任务是在J(w)的相反的梯度方向逐步调整w,即该最
小值对应于正确的分类。如果w(k)表示第k步迭代的权重向量，则通用梯度下降算法可写为
K+D=w(k)-ac (12.2-38)
其中w(k+1)是w的新值，而α>0给出修正量。由式(12.2-37)得到
W=-(r-w2y)y (12.2-39)
把这一结果代入式(12.2-38)得到
w(k+1)=w(k)+α[r(k)-w?(k)y(k)]y(k) (12.2-40)
其中初始权重向量w(1)是任意的。
通过将权重向量中的增量(delta)定义为
△w=w(k+D-w(k) (12.2-41)
第12章 目 标识 别 575
我们可以按delta修正算法的形式将式(12.2-40)写为
△w=αe(k)y(k) (12.2-42)
其中，
e(k)=r(k)-wT(k)y(k) (12.2-43)
当模式y(k)存在时，它是权重向量w(k)提交的误差。
式(12.2-43)给出了权重向量w(k)的误差。如果我们把它更改为w(k+1),但保持模式不变，则误
差变为
e(k)=r(k)-w1(k+D)y(k) (12.2-44)
故误差的变化是
Ae(k)=[r(k)-w'(k+1)y(k)]-[r(k)-w?(k)y(k)]
=-[w?(k+1)-w?(k)]y(k) (12.2-45)
=-△w'y(k)
但由于△w=αe(k)y(k),所以
△e=-αe(k)yT(k)y(k) (12.2-46) =-αe(k)|y(k)2
因此，权重的变化将误差减小了α|y(k)2倍。下一个输入模式开始新的自适应循环，将下一个误差
减小α|y(k+1)|2倍，依此类推。
α的选择控制着稳定性和收敛速度(Widrow and Stearns[1985])。稳定性要求0<α<2。α的实
际范围是0.1<α<1.0。尽管这里未给出证明，但式(12.2-40)或式(12.2-42)和式(12.2-43)的算法确实
收敛于一个解，这个解会使得在该训练集的模式上的均方误差最小。当模式类可分时，使用刚才讨论
的算法得出的解，可能会也可能不会产生一个分离超平面。也就是说，在感知机训练理论的意义上，
均方误差解并不意味着真有一个解。这种不确定性是使用这个特殊的公式在可分情形下和不可分情形
下收敛算法的代价。
到目前为止，我们讨论的两个感知机训练算法可以推广到多个类及非线性决策函数。基于前面
给出的历史评价，这里探讨多类训练算法并无多大价值。相反，我们将在神经网络的内容中讨论多类
训练问题。
多层前馈神经网络
在这一节中，我们主要探讨多类模式识别问题的决策函数，并涉及由感知机计算单元的各个层
组成的结构，与类是否可分无关。
基本结构：图12.16显示了所考虑神经网络模型的结构。它由多层结构上相同的计算节点(神经元)
排列而成，从而一层中的每个神经元的输出送到下一层的每个神经元的输人。称为层A的第一层中
的神经元的个数为N。通常，N=n,它是输入模式向量的维度。称为Q层的输出层中的神经元的
数量表示为NoN。等于W,即神经网络经训练后用于识别模式类的数量。如下面的讨论所示，如果
该网络的第i个输出为“高”,而其他输出为“低”,则网络将模式向量x识别为属于类a。
如图12.16中的放大部分所示，每个神经元的形式都与前面讨论的感知机模式相同(见图12.14),
只是硬性受限激活函数已被替代为软性受限“S形”函数。在开发训练规则时，需要有沿神经网络所
有路径的可微分性。下面的“S形”激活函数具有必要的可微分性： 司
576 数字图像处理(第三版)
h,(1)=1+eee (12.2-47)
其中J,j=1,2,…,N,是该网络第J层中的每个节点的激活元素的输入，0,是偏移量，0。控制“S形”
函数的形状。
5
W
;;9
类叫 类呻 类的
权重 ;…
7
权重w总
人权重
)
;之权重
;常
图12.16 多层前馈神经网络模型。放大部分显示了整个网络中每
个神经元的基本结构。偏移量0,仅当做另一个权重来处理
层( (输出层)
丁
之以一W个节点
层pN)个作点
层rN个节点
Nk个节点 层K
Na个节点 层B
NA个节点 人层
第12章 目 标 识 别 577
图12.17中画出了式(12.2-47)的曲线，并给出了每个节点的“高”响应限和“低”响应限。因此，
在使用这个特殊的函数时，对所有大于C,的Z值，系统会输出一个“高”读数。同样，对所有小于θ,的
l,值，系统会输出一个“低”读数。如图12.17所示，“S形”激活函数总为正，并且仅当激活元素的输
入分别为负无穷或正无穷时，它才到达其极限值0和1。因此，在图12.16中，接近0和1的值(譬如0.05
和0.95)定义了神经元输出的“低”值和“高”值。原理上，不同类型的激活函数可用于不同的层，甚
至用于神经网络的同一层中的不同节点。实际上，常用的方法是对整个网络使用相同形式的激活函数。
0=(/)
…1.0-
高-
B的最小值 0.的最大值
0.5
低一
1
0,
图12.17 式(12.2-47)给出的"S"激活函数
参考图12.14(a),图12.17中显示的偏移量θ,类似于前面讨论感知机时的权重系数w。这个偏
移阈值函数可采用图12.14(a)的形式来实现，方法是将偏移θ,作为一个额外的系数，然后使用该系数
来修正统一输入到网络中所有节点的一个常量。为遵循文献中普遍使用的符号表示，我们没有把单独
的常量输入+1显示在图12.16中的所有节点上。取而代之，这个输入及其修正权重θ,是网络节点的求
和部分。如图12.16中放大部分显示的那样，在层J中，N,个节点中的每个节点都有一个这样的系数。
在图12.16中，任何层中的一个节点的输入，都是来自前一层的输出的加权和。令层K表示层J
的前一层(图12.16中未按字母顺序来划分层),层K为层J中的每个节点的激活元素提供输入I:
-2wO (12.2-48)
其中j=1,2,…,N,这里N,是层J中的节点数，Nk是层K中的节点数，wA是层K中的节点的输出O
在送入层J中的节点之前，修正这些输出的权重。层K的输出为
0=h() (12.2-49)
其中k=1,2,…,Nx。
清楚地理解式(12.2-48)中所用的下标符号很重要，因为我们在本节的剩余内容中都会使用到它。
首先，注意L,j=1,2,…,N,表示层J中第j个节点的激活元素的输入。因此，I?表示层J中第1个(顶端)
节点的激活元素的输入，I?表示层J中第2个节点的激活元素的输入，依次类推。层J中的每个节点都
有Nx个输入，但对各个输入的加权是不同的。因此，层J中第1个节点的Nx个输入由系数wu,k=1,2,…,
N加权；层J中第2个节点的输入由系数wz.k=1,2,…,Nk加权；依次类推。因此，层K的输出在送
人层J时，需要指定总共N,×Nx个加权系数。完全指定层J中的节点，需要另外N,个偏移系数θ,。
将式(12.2-48)代入式(12.2-47)得到
u)=k (12.2-50)
这是本节剩余部分中要用到的激活函数的形式。 99
退
578 数字图像处理(第三版)
在训练过程中，修改输出层中的神经元很简单，因为每个节点的期望输出是已知的。训练一个
多层网络的主要问题在于调整隐藏层中的权重，即那些非输出层的层中的权重。
反向传播训练：我们先来关注输出层。(输出)层Q中各节点的期望响应r,和相应的真实响应0?
之间的总误差的平方为
Eo-÷20-Q2 (12.2-51)
其中N。是输出层Q中的节点数，使用系数1/2是为后面取导数更为方便。
我们的目的是，推导一个类似于delta 规则的训练规则，以便按寻求式(12.2-51)所示误差函数的
最小值的方法，来调整每层的权重。像前面那样，与误差关于权重的偏导数成比例地调整权重，可实
现这一目的。换句话说，
=a (12.2-52)
其中，层P先于层Q.△w如式(12.2-42)定义的那样，α是一个正的修正增量。
误差E。是输出0,的函数，而0,是输入I的函数。使用链式法则，我们计算出E。的偏导数如下：
(12.2-53)
由式(12.2-48)可得
O,=0 (12.2-54)
将式(12.2-53)和式(12.2-54)代人式(12.2-52),得到
Awm=ao=a?,0 (12.2-55)
其中，
8- (17.2-56)
为计算偏导数aE。/01,根据E。相对于0,的变化率和O,相对于I的变化率，我们使用链式法
则表示偏导数，即
8,-f (12.2-57)
由式(12.2-51)得到
6--0.) (12.2-58)
而由式(12.2-49)得到
可Q)=k(O) (12.2-59)
将式(12.2-58)和式(12.2-59)代人式(12.2-57)得到
8=(-0?)h((?) (12.2-60)
第12章 目 标识 别 579
它与误差值(r,-O?)成正比。将式(12.2-56)到式(12.2-58)代入式(12.2-55),最终得到
△w=α(r-O?)h'()?,=αδ,O。 (12.2-61)
指定了函数h,(I)后，式(12.2-61)中的所有项都是已知的，或者可以在网络中观察到。换句话说，
根据对网络输入的任何训练模式的表示，我们就知道每个输出节点的期望响应r,应是什么。就像层Q
的激活元素的输入I和层P中节点的输出O,那样，每个输出节点的值0,是可观察到的。这样，我们
就知道如何调整权重，从而改进网络中最后一层和上一层之间的链接。
将输出层放到一边，我们现在分析层P中发生的情况。采用与上面相同的方式，我们可得
△wn=α(r,-0,)h,(p)?,=αδ,0 (12.2-62)
其中误差项是
δ,=(r,-O,)h,(p) (12.2-63)
除了r,外，式(12.2-62)和式(12.2-63)中的所有项要么是已知的，要么可在网络中观察到。在内部
层中 r,项没有意义，因为根据模式成员我们确实不知道一个内部节点的响应是什么。仅在模式分类最
终发生的网络的输出处，我们才能指定想要的响应 r。如果我们知道内部节点的信息，那么就不需要更
多的层。因此，我们必须根据已知的或可在网络中观察到的量来找到重新定义6,的一种方法。
回到式(12.2-57),我们将层P的误差项写为
8, (12.2-64)
项a0/aL,不难表示，如先前那样，它是
)=,(O) (12.2-65)
一旦确定了h?,上式就是已知的，因为I,可通过观察得到。产生的r,项是偏导数aE/ao。,所以该
项必须以不包含r,的方式来表示。使用链式法则，我们将偏导数写为
,2-22-2)-26,。 (12.2-66)
其中最后一步来自式(12.2-56)。将式(12.2-65)和式(12.2-66)代入式(12.2-64),得到期望的δ,表达式
如下：
6,=80026 (12.2-67)
现在可以计算出参量δ。,因为其所有项都是已知的。这样，式(12.2-62)和式(12.2-67)就完全为层P
建立了训练规则。式(12.2-67)的重要性是由量δ。和w来计算8。,而这两个量是在紧邻层P的层中
计算出来的项。计算出层P的误差项和权重后，这些量可类似地用于计算紧邻层P之前的层的误差
项和权重。换句话说，我们找到了一种从输出层的误差开始，将误差反向传播回网络的方法。
我们可将训练过程总结并归纳如下。对于任何层K和J,其中层K是紧邻层J的前一层，计算
权重w,该权重使用下式修改这两层之间的连接：
△wA=αδ,O (12.2-68)
如果层J是输出层，则6,为
8,=(r-O,)h;(l,) 12269
言
580 数字图像处理(第三版)
如果层J是一个内部层，且层P是它的下一层(右侧),则δ,为
8,=Ha)26,?? (12.2-70)
其中j=1,2,…,N。使用式(12.2-50)中的激活函数并令θ?=1,可得
h;(I,)=0,(1-O) (12.2-71)
在这种情况下，式(12.2-69)和式(12.2-70)采用特别有吸引力的形式，即对于输出层有
δ,=(r,-0,)O,(1-O,) (12.2-72)
而对于内部层有
6=0,0-01)26,m。 (12.2-73)
在式(12.2-72)和式(12.2-73)中，都有j=1,2,…,N。
式(12.2-68)到式(12.2-70)组成了图12.16的多层前馈神经网络的一般的delta训练法则。该处理
由整个网络的任意一组(都不相等的)权重开始。然后，在任意迭代步骤中应用这个一般的delta法则
包括两个基本阶段。在第一个阶段，为网络提供一个训练向量，通过允许该向量在各个层中传播来计
算出每个节点的输出Q,。然后，将输出层中各个节点的输出0,与它们的期望响应r,进行比较，生成
误差项δ,。第二阶段包括一条通过网络的反向路径，在此期间，合适的误差信号被传递给每个节点，
并做相应的权重变化。这一过程同样适用于偏置权重θ。如前面详细讨论的那样，这些权重被简单地
当做额外的权重来处理，它们把一个单元输入修改为网络中每个节点的求和连接。
通常的做法是追踪该网络误差以及与各个模式相关联的误差。在成功的训练会话中，网络误差
会随迭代次数的增加而减小，并且该过程会收敛到一个稳定的权重集合，对于附加的训练，这些权重
仅表现为很小的波动。紧随着在训练期间完成的一个模式是否被正确分类的方法是，从得到的模式确
定输出层的响应，如以前定义的那样，与模式类有关的输出层节点的响应为高，所有其他节点的输出
为低。
系统被训练之后，就会使用训练阶段中建立的参数来对模式进行分类。在正常操作中，所有的
反馈路径是被分开的。然后，允许任何输入模式传过不同的层，且该模式被分类为属于具有高值输出
节点的类，此时，其他所有节点输出为低。如果被标记为高的节点不止一个，或没有节点输出被标记
为高，则将其声明为一个错误分类，或简单地将该模式赋给具有最高数值的输出节点的类。
例12.6 使用神经网络的形状分类。
我们现在说明如何训练一个如图12.16所示的神经网络，以便识别图12.18(a)中所示的4种形状，
以及图12.18(b)中所示的这4种形状的带有噪声形式的样本。
通过计算这些形状的归一化信号(见11.1.3节)产生模式向量，然后得到每个信号的48个均匀间隔
的样本。将得到的48 维向量作为图12.19所示的三层前馈神经网络的输入。第一层中神经元节点数选择
为48,它对应于输入模式向量的维数。第三层(输出层)中的4个神经元对应于模式类的数量，而中间层
的神经元的数量指定为26(输入层和输出层中的神经元的平均数)。由于不知道确定神经网络内部层的
节点数的规则，因此该数量通常要么基于先验知识，要么简单地任意选择，然后通过测试来完善。在
输出层中，从上到下的4个节点此时分别代表类a,j=1,2,3,4。在设定网络结构后，必须为每个单元和
层选定激活函数。根据前面的讨论，所有选定的激活函数都要满足式(12.2-50),其中θ。=1,以便可以应
用式(12.2-72)和式(12.2-73)。
第12章 目标 识 别 581
b
形状1 形状2 形状3 形状4
形状1 形状2 形状3 形状4
图12.18 训练图12.19中的神经网络时使用的(a)参考图形和(b)典型带噪
声图形(图像由南伊利诺依大学ECE系的Lalit Gupta博士提供)
x19 权重%
x2 权重
x1 形状!
x 形状2 输入
模式向量
xs 形状3
: ··* 形状4
层Q(输出层)
No=4
层B Na=26
xN
NA=48 层A
图12.19 用于识别图12.18中所示形状的三层神经网络(图像由南伊利诺伊大学ECE系的Lalit Gupta博士提供) ～9
582 数字图像处理(第三版)
训练过程分为两部分。在第一部分中，权重被初始化为均值为零的小随机值，然后，使用与类似于
图12.18(a)所示的相应的无噪声样本的模式向量对网络进行训练。输出节点在训练期间是受到监控的。对
于来自类a的任何训练模式，若输出层的元素在q=1,2,…,N。且q≠i时，产生输出值O≥0.95和0,≤
0.05,那么我们说网络已从所有的4个类学到了这些形状。换句话说，对类a)的任何模式，对应于该类的
输出单元必须为高值(≥0.95),同时所有其他节点的输出必须为低值(≤0.05)。
训练的第二部分是对噪声样本进行训练，产生如下结果。在无噪声的图形中每个处在轮廓线上的像
素被赋予一个保留在图像平面上的原始坐标的概率V,而其8个邻域像素之一的坐标被随机赋予概率R=
1-V。减小V(即增大R),则噪声的程度会增加。这样就生成了两个噪声数据集。第一个噪声集由每个类
的100个噪声模式组成，这些模式是R在0.1到0.6之间变化时产生的，因此共产生了400个模式。该集
合称为测试集，用于确定训练后的系统性能。
使用噪声数据训练系统后生成了几个噪声集。第一个集合由每个类的10个样本组成，这些样本是通
过令R,=0生成的，其中R,表示用于生成训练数据的R的值。从训练的第一部分(无噪声)得到的权重向
量开始，系统被允许使用这个新数据集来遍历一个学习序列。因为R,=0意味着无噪声，因此这种再训练
是之前的无噪声训练的延伸。使用按这种方式学习得到的权重，满足该测试数据集的网络会产生图12.20
中所示的标有R,=0的曲线。被错误分类的模式数量除以测试过的模式总数，可得到错误分类的概率，该
概率通常是用于建立神经网络性能的一个度量。
接下来，从使用R,=0生成的数据学习到的权重向量开始，使用由R,=0.1生成的噪声数据集合对系
统重新进行训练。再次使用新权重向量对整个系统运行这些测试样本，建立识别性能。注意，系统在性
能上的显著改进。图12.20显示了R,=0.2,0.3和0.4时，继续这种再训练和再测试过程得到的结果。如期
望的那样，如果系统学习正确，则由该测试数据集错误分类的概率会随R,的增大而降低，因为系统使用
了具有较高R,值的噪声数据进行训练。图12.20中的一个例外是R,=0.4时的结果。原因是用于训练该系
统的样本数较少。也就是说，网络无法在使用这样少的样本的情况下，使自身充分适应具有更高噪声水
平的形状的较大变化。这一假设在图12.21中得到了证实，该图表明随着训练样本数的增加，错误分类的
概率会随着降低。图12.21还显示了来自图12.20中的R,=0.3时的曲线，它仅作为参考。
9：9
0.25 R?=0.0
0.20 R?=0.1
错误分类的概率 0.15 R?=0.2
0.10 R,=0.4
R,=0.3
0.05
0.00
0.00 0.20 0.40 0.60 0.80
测试噪声水平(R)
图12.20 神经网络的性能是噪声水平的函数(原图由南伊利诺伊大学ECE系的Lalit Gupta博士提供)
第12章 目标 识 别 583
0.100-
R?=0.4,N=10
0.080
R?=0.4.N=20
错误分类的概率 0.060 -R?=0.3.N=10
R?=0.4.N=40
0.040
0.020-
0.000
0.00 0.20 0.40 0.60 0.80
测试噪声水平(R)
图12.21 增加训练模式的数量时，R,=0.4时的性能改进(R,=0.3时的曲线仅
作为参考)(原图由南伊利诺伊大学ECE系的Lalit Gupta博士提供)
前述结果表明，一个三层神经网络经过适当水平的训练后学习识别被噪声污染的形状能力。甚至当
使用无噪声数据(图12.20中R,=0)训练时，使用被噪声高度污染的数据(图12.20中R=0.6)进行测试，
系统也能实现接近77??正确识别水平。当系统使用噪声水平更高的数据(R,=0.3和R=0.4)训练后，
对相同数据的识别率增加到99??注意，系统地、小量地增大附加噪声来训练系统，可增大系统的分类能
力，这一点很重要。当噪声的性质已知时，这种方法对改进神经网络在学习过程中的收敛性和稳定性
是很理想的。
决策面的复杂性：我们已经证明一个单层感知机可实现一个超平面的决策面。此时，一个很自
然的问题是：由如图12.16中的模型的一个多层网络实现的决策面的性质是什么?下面讨论一个三
层网络能实现由相交的超平面组成的任意复杂的决策面，由此说明前述的问题。
首先，考虑图12.22(a)中所示的一个双输入的双层网络。由于有两个输入，故这些模式是二维的，
从而网络的第一层中的每个节点在二维空间中实现一条直线。我们分别用1和0来表示这两个节点的
高输出和低输出。假设输出1指出对应于第一层中的一个节点的输入向量位于该直线的正侧。那么馈
送到第二层中的单个节点的可能输出组合是(1.1).(1.0),(0.1)和(0,0)。如果我们定义两个区域，一个
区域对应于类a),位于两条直线的正侧；另一个区域对应于类a?,位于两条直线的另一侧，通过简单
地执行一个逻辑“与”操作，输出节点就可以把任何输入模式分类为属于这两个区域之一。换句话说，
仅当来自第一层的两个输出都为1时，输出节点的响应才为表示类a的1。如果6,的值位于半开区间
[1,2],那么“与”操作可以由先前讨论的神经节点的形式来执行。这样，如果我们假设第一层的响
应为0和1,那么只有当在来自第一层的该神经节点上执行的求和大于1时，输出节点的响应才是表
示类a的高值。图12.22(b)和(c)显示了图12.22(a)所示的网络是如何成功地等分这两个模式类的，
而使用单个的线性面则做不到这一点。 心～心
584 数字图像处理(第三版)
如果第一层中的节点数增加到三个，那么图12.22(a)中的网络将可实现由三条直线相交组成的
一个决策边界。类o,位于所有三条直线的正侧这一要求，将生成由这三条直线围成的一个凸形区
域。事实上，任何开放的或闭合的凸区域都可以简单地通过增加两层神经网络的第一层的节点数
来构造。
子～
a be +
x1
1 w
+
图12.22(a)一个双输入双层前馈神经网络；(b)和(c)可使用该网络实现的决策边界示例
下一个逻辑步骤是将层数增加到三层。像之前那样，此时第一层中的节点实现一条直线。为形
成由各条直线围成的区域，第二层的节点执行“与”操作。第三层的节点将不同的类划归不同区域。
例如，假设a,由两个不同的区域组成，每个区域由不同的一组直线围成边界，那么第二层中的两个
节点用于对应于同一模式类的区域。当第二层中的两个节点之一变为高值时，输出节点之一应该能够
提示该类的存在。假设第二层中的高和低状态分别表示为1和0,那么让网络的输出节点执行逻辑“或”
操作，可得到这种能力。根据前面讨论的神经节点的形式，我们可通过将θ,的值设置在半开区间[0,1]
内来这样做。然后，只要第二层中至少有一个节点与变为高值(输出为1)的输出节点相关联，输出层
中的相应节点也将变为高值，从而将该模式分配给与该节点相关联的类。
图12.23总结了前面的讨论。注意，在第三行中，由三层网络实现的决策区域的复杂性在原理上
是任意的。实际上，在构造可正确响应与特殊类相关联的各种组合的第二层时，通常会很困难。原因
是直线不会刚好截止于与其他直线的交点处，从而同一类的模式可能会出现在该模式空间中的直线的
两侧。实际上，对于一个给定的模式类，第二层可能很难断定哪些直线应该包含在“与”操作中，或
许这根本上就是不可能的。参考图12.23的第三列中的“异或”问题表明，如果输入模式是二元形式
的，那么在两个维度的情形下只能构建4个不同的模式。如果模式按如下方式排列：类a,由模式(0,1).
(1.0)组成，类a?由模式((0,0),(1,1))组成，那么这两个类中模式类的归属由“异或”(XOR)逻辑函
数给出，仅当两个变量中的一个或另一个为1时，该函数值才为1,而其他情形下它为0。因此，XOR
函数值为1指出模式属于类w,,而XOR函数值为0指出模式属于a?。
前面的讨论可以直接推广到n维情形，此时我们使用超平面来替代直线。单层网络实现单个超
平面。两层网络实现由超平面的交集组成的任意凸形区域。三层网络实现任意复杂度的决策面。每层
中使用的节点数决定了后两种情形下的复杂度。在第一种情形下，类的数量限制为两个。在其他两种
情形下，类的数量是任意的，因为可以根据手边的问题来选择输出节点的数量。
考虑前述说明，一个合乎逻辑的问题是为什么人们对研究三层以上的神经网络感兴趣。毕竞三
层网络就可以实现任意复杂度的决策面。答案在于仅使用三层来训练网络的方法。用于图12.16中网
络的训练规则可使误差度量最小，但未说明如何将一组超平面与之前讨论的三层网络的第二层中的节
点关联起来。事实上，如何在层次数和每层中的节点数之间进行折中分析这一问题仍有待解决。在实
际中，通常通过试错法或给定的问题域的已有经验来解决分析中的问题。
第12章 目 标 识 别 585
网络结构 决策区域的类型 XOR问题的解 带有网状区域的类 常用决策面形状
一层
单个超平面
二层
开放的或闭合
的凸形区域
三层
任意(由节点数
限制的复杂性)
图12.23 可以由单层和多层前馈网络带有一层或两层隐藏单元与
两个输入形成的决策区域的类型(原图由Lippman 提供)
12.3 结构方法
12.2 节中讨论的技术可定量地处理模式，并且大部分忽略了模式形状中固有的结构关系。然而，
本节中讨论的结构方法可通过精确地运用这些类型的关系来实现模式识别的目的。在这一节，我们介
绍两种基本的基于串表示的边界形状的识别方法，串是结构模式识别中最实用的方法。
12.3.1 匹配形状数
为了比较根据形状数描述的区域边界，我们可以明确表达一个过程，该过程类似于12.2.1节中为模
式向量引人的最小距离概念。参考11.2.2节中的讨论可知，两个区域边界(形状)之间的相似度k定义为它
们的形状数仍保持一致的最大阶。例如，令a和b代表由4方向链码表示的闭合边界的形状数。如果
s,(a)=s,(b),j=4,6,8,…,k
s,(a)≠s,(b).j=k+2,k+4,… (12.3-1)
那么这两个形状有一个相似度k,其中s代表形状数，下标代表阶。两个形状a和b之间的距离定义
为它们的相似度的倒数：
Dab)= (12.3-2)
该距离满足如下性质：
D(a,b)≥0
(12.3-3) D(a,b)=0,iff a=b
D(a,c)≤max[(D(a,b),D(b,c]
k或D都可以用于比较这两个形状。如果使用相似度，则k越大，形状就越相似(注意，对于相同的
形状，k为无穷大)。当使用距离度量时，情形正好相反。 医
引：象
586 数字图像处理(第三版)
例12.7 使用形状数比较形状。
假设我们有一个形状f,并且希望在图12.24(a)所示的由5个其他形状(a,b,c,d和e)组成的集合中找
到与它最为接近的匹配。这个问题类似于拥有5个原型形状并试图找到一个给定未知形状的最好匹配。该搜
索可借助于图12.24(b)中所示的相似性树来可视化。树根对应于最低的可能相似度，在该例中，其为4。
假设这些形状有高达8的相似度，但形状a除外，它相对于所有其他形状的相似度为6。沿树向下行进，
我们发现形状d相对于其他形状的相似度为8,等等。如果形状f和c有比其他任何两个形状更高的相似
度，那么形状f和c是唯一匹配的。在其他极端情形下，如果a是一个未知形状，那么使用该方法，我们
可以说a类似于其他5个形状的相似度为6。同样的信息可以用相似性矩阵来总结，如图12.24(c)所示。
a
be b
a
相似度
4 O abcdef b
6 oabclef 6 6
b
8 qa bode/ 8108 8
8812
10 0a d cf Rbe d 88
12- oa d cf Ob 8
f
14 --O 6 6 δ
a c 厂
O
b
O
图12.24(a)各种形状；(b)假想的相似树；(c)相似性矩阵(原图由 Bribiesca and Guzman提供)
12.3.2 串匹配
假设两个区域边界a和b已被编码成串(见11.5节),两个串分别表示为a,a?…,a,和b,,b?…,b
令α表示两个串之间的匹配数，如果a=b,则匹配出现在第k个位置。不匹配的符号数为
β=max(|a|,b|)-α (12.3-4)
其中，largl是该宗量的串表示的长度(符号数)。可以证明，当且仅当a和b相同时β=0(见习题12.21)。
a和b间的一种简单的相似性度量是比率
R=p=mx(lb)-a (12.3-5)
对于完美匹配，R为无限大，而当a和b中没有任何符号匹配时，R为0(此时α=0)。因为匹配是逐个字
符进行的，对于降低计算量来说，每条边界上的起始点是很重要的。任何归一化到或近似归一化到相同
起点的方法是有帮助的，只要它与强力匹配相比可提供计算上的优势，强力搜索从每个串上的任意点开
始，然后移位一个字符(采用卷绕的方式)并为每个移位计算式(12.3-5)。R的最大值给出最好的匹配。
第12章 目 标识 别 587
例12.8 串匹配示例。
图12.25(a)和(b)显示了来自两个目标类的样本边界，它们由一个多边形拟合来近似(见11.1.3节)。
图12.25(c)和(d)分别显示了对应于图12.25(a)和(b)所示边界的多边形近似。当顺时针追踪每个多边形时，
通过计算各线段间的内角θ,就形成了来自这些多边形的串。这些角度被编码成8个可能的符号，角度增
量为45°,即α?:0°<0≤45°,a:45°<θ≤90°,…,α:315°<θ≤360°。
R 1a1L.bLe- 1d le 1f
1a
1,b
Le
1.d
1e
1.1
16.0
9.6 26.3
5.1 8.1 10.3
4,7 7.2 10.3 14.2
4.7 7.2 10.3 8.4 23.7
图 12.25 (a)和(b)两个不同目标类的样本边界；(c)和(d)对应的
多边形近似；(e)~(g)R值表(原图由Sze和Yang 提供)
图12.25(e)显示了针对目标1本身的6个样本来计算度量R的结果。例如，对应于各个R值，符号
1.c指的是目标类1的第三个串。图12.25(1显示了第二个目标类的串和它们自身进行比较的结果。最后，
图12.25(g)显示了通过比较一个类的串与其他类的串得到的R值表。注意，这里所有的R值比前两个表
中的任何项都小，这表明R度量在两个目标类间的辨识达到了很高的程度。例如，如果串1.a的类别成员
未知，那么通过将该串和类1的样本(原型)串相比较产生的最小R值将是4.7[见图12.25(e)]。相比之
下，将该串和类别2的串相比较产生的最大值将会是1.24[见图12.25(g)]。由此可得出如下结论：串1.a
是目标类1的成员。这种分类方法类似于12.2.1节中介绍的最小距离分类器。
小结
从第9章开始，我们对数字图像处理的论述发生了改变，即从其输出为图像的处理变为1.1节中
详细说明的其输出为图像属性的处理。尽管本章中的内容本质上是介绍性的，但所覆盖的主题对于理
解目标识别技术是相当基础的。如本章开头提及的那样，本章以个别目标的识别来结束是合乎逻辑的
R 2.a 2.b 2.c2.d 2.e2.1
2a
2.b 33.5
4.8 5.8
3.6 4.2119.3
2.8 3.3
2.6 3.0
183 9.21
13.5 27.0 7.7 1
2e
2.d
2.e
21
R La 1.b 1.e 1.d 1.e 1.f
2.a
2.b
2e
2.d
2e
2.f
1.24 1501.321.47
118 1.321.47 1.55 1.48
1.02 1.32 1.39 1.48
1.02 118 L19 132 1.29 1.40
0.93 1.07 1.08 1.19 1.24 1.25
0.8911.02 1.02 1.24 1.22 1.18
1.55 1.48
1.43
1.18 1.19
度：以
588 数字图像处理(第三版)
安排。要超越这一点，就需要1.4节中提出的范围以外的概念。准确地说，下一个逻辑步骤是开发图
像分析方法，这些方法的正确开发要求有来自于机器智能的概念。
如1.1节和1.4节中提到的那样，机器智能和与其相关的某些领域，譬如场景分析和计算机视觉，
仍处于实际发展的早期阶段。今天，图像分析问题的解仍具有启发式描述的特征。尽管这些方法确实
发生了变化，但它们分享的重要基础恰好是本书中所覆盖的方法。
在学习了前12章的内容后，无论是从理论角度还是从实践角度，读者现在都应能理解数字图像
处理所跨越的主要领域。请读者对所有的讨论细加琢磨，以便为以后进一步研究该领域或以此为基础
的相关领域打下坚实的基础。给定许多特定成像问题的性质后，清楚地理解基本原理可大大增加成功
解决这些问题的机会。
参考文献
12.1节到12.2.2节的背景材料源自Theodoridis和Koutroumbas[2006],Duda, Hart和Stork[2001]及Tou
和Gonzalez[1974]的书籍。由Jain 等人[2000]撰写的综述性文章也很重要。由Principe 等人[1999]撰写的书
籍很好地概述了神经网络。IEEE Trans. Image Processing[1998]的一期专刊可以与10年前的类似专刊相媲美
(IEEE Computer[1988])。12.2.3节中给出的材料是介绍性的。实际上，该讨论中使用的神经网络模型是多
年来提出的大量模型中的一个。然而，我们论述的模型是有代表性的，而且是在图像处理过程中使用得相
当广泛的模型。处理失真形状识别的例子改编自Gupta等人[1990,1994]的著述。Gori和Scarseli[1998]发表
的论文中讨论了多层神经网络的分类能力。由Udea[2000]报告的一个基于线性连接的神经网络的方法使分
类错误降至最低，这是文中另外一个很好的阅读材料。
关于12.3.1节中内容的其他读物，见Brbiesca和Guzman[1980]的著述。在串匹配方面，见Sze和Yang[1981],
Oommen和Loke[1997]及Gdalyahu 和Weinshal[1999]的著述。关于结构模式识别的参考材料，见Gonzalez
和Thomason[1978],Fu[1982].Bunke和Sanfeliu[1990],Tanaka[1995],Vailaya等人[1998],Aizaka和Nakamura
[1999]及Jonk 等人[1999]的论著,也可参见Huang[2002]的书籍。
习题
12.1 (a)对图12.1 中所示的模式，计算最小距离分类器的决策函数。
通过仔细观察，您可能会得到所需的均值向量。
(b)画出由(a)中决策函数实现的决策面。
★12.2 根据模式分类，说明式(12.2-4)和式(12.2-5)的功能相同。
12.3 证明由式(12.2-6)给出的面是连接n维点m和m,的直线的垂直平分线。
★12.4 联系对图12.7的讨论，说明最小距离分类器是如何使用W组
电阻(W为类别的数量),在每组处做求和连接(对电流求和)
和一个可选取W个输入中最大输入的最大选择器来实现的，
这里输入为电流。
12.5 证明式(12.2-8)的相关系数的值域为[-1.1]。[提示：以向量
形式表示y(x,y)。]
★12.6 某实验产生了斑点的二值图像，这些斑点的形态近似为椭圆
(见右图)。斑点有三种尺寸，这些椭圆的主轴的平均值为(1.3,
0.7),(1.0,0.5).(0.75,0.25)。这些轴的尺寸相对于它们的平均值
标有星号的习题的详细答
案，可在本书的网站上找到。该网
站还基于本章的内容给出了建议的
项目。
第12章 目 标 识 别 589
有±10??变化。请开发一个图像处理系统，要求该系统能够拒绝不完整的或相互重叠的椭圆，
然后将剩下的单个椭圆分类到给定的三种尺寸类之一中去。请以方框图的形式说明您的解决方
案，对于每个框图的操作给出详尽的细节。使用最小距离分类器解决分类问题.,清楚地指出如何
获得训练样本，以及如何使用这些样本来训练分类器。
12.7 下列模式类具有高斯概率密度函数：a:(0,0),(4,0),(4,4),(0,4)]和a:((5,5),(7,5),(7,7),(5,7'}。
(a)假设P(a)=P(a)=1/4,请给出这两个类间的贝叶斯决策边界的方程。
(b)画出该边界。
★12.8 重复习题12.7,但使用下列模式类：a:{(-1,0)2,(0,-D.(1,0)2,(0.D')和a:{(-4,0),(0,-4),(4,0)2,
(0.4)}。显然，这些类不是线性可分的。
12.9 重复习题12.6,但使用一个贝叶斯分类器(假设其是高斯密度分布的)。请清楚地指出您是如何得
到训练样本的，以及您是如何使用这些样本来训练分类器的。
★12.10 贝叶斯决策函数d(x)=p(x/a)P(a).j=1,2,…,W是使用一个0-1损失函数推导的。证明这些决
策函数可最小化错误分类的概率。[提示：错误分类概率p(e)是1-p(c),其中p(c)是正确分类的
概率。对于一个属于类a的模式向量x,有p(ckx)=p(o/x)。求p(c),并证明当p(x/a)P(a)是最大
值时p(c)也是最大值(而p(e)为最小值)]。
12.11 (a)对下列模式类应用感知机算法：a:((0,0.0),(1,0,0),(1,0,D),(1,1,0)2)和o:((0,0,D,(0.1.D,
(0,1.0)',(1,1,1)'}。令c=1且w(1)=(-1,-1,-2,0)'。
(b)画出(a)中得到的决策面。给出这些模式类并指出该决策面的正的一侧。
★12.12 通过将类a?的模式乘以-1,我们可以按一种更为简洁的形式来表达式(12.2-34)到式(12.2-36)中
给出的感知机算法；此时，算法中的修正步骤变为：若w1(k)y(k)>0.则w(k+1)=w(k),否则
w(k+1)=w(k)+cy(k)。这是从下面的通用梯度下降公式开始，推导出来的几个感知机算法公式之一：
+D=w()-c
其中c>0,J(w,y)是一个准则函数，偏导数在w=w(k)处计算。证明使用准则函数J(w,y)=
1/2(w'yl-w'y),可由通用梯度下降过程得到该感知机算法公式，其中largl是宗量的绝对值。(注
意：w'y关于w的偏导数等于y。)
12.13 证明：如果训练模式集合是线性可分的，那么式(12.2-34)到式(12.2-36)中给出的感知机训练算法
会在有限步数内收敛。[提示：将类a?的模式乘以-1,并考虑一个非负阈值T,以便感知机训练
算法(c=1)可表示为：若w'(k)y(k)>T,则w(k+D)=w(k);否则w(k+1)=w(k)+y(k)。您可能
需要用到柯西-施瓦茨不等式|al2b2≥(a'b)2。]
★12.14 指定一个神经网络的结构和权重，该神经网络的功能完全与n维空间中两个模式类的最小距离分
类器的功能相同。
12.15 指定一个神经网络的结构和权重，该神经网络的功能完全与n维空间中两个模式类的贝叶斯分类
器的功能相同。这些类是高斯型的，具有不同的均值，但协方差矩阵相等。
★12.16 (a)在什么条件下，习题12.14和习题12.15中的神经网络相同?
(b)如果使用足够数量的样本进行训练，那么用于12.2.3节中讨论的多层前馈神经网络的通用△
准则会生成(a)中的特殊神经网络吗?
12.17 在两个维度上的两个模式类按如下方式分布：类a)的模式沿半径为r的一个圆随机分布。类似地，
类a,的模式沿半径为r?的一个圆随机地分布，其中r?=4r?。为正确地分类这两类模式，请指定一
个具有最少数量的层和节点的神经网络。 :
590 数字图像处理(第三版)
★12.18 重复习题12.6,但使用一个神经网络。请清楚地指出如何得到训练样本，并说明如何使用这些样
本来训练分类器。请按您的主张选择可解决该问题的最简神经网络。
12.19 证明式(12.2-71)中给出的表达式h,(1)=0(1-0)是由式(12.2-50)在θ。=1时推导出来的，其中
h;(1)=a h(I)oL。
★12.20 证明式(12.3-2)中的距离度量D(A,B)满足式(12.3-3)给出的性质。
12.21 说明当且仅当a和b是相同的串时，式(12.3-4)中的β=max(lal,lbl)-α为0.。
12.22 某工厂为运动会生产小的美国国旗。质量保证小组发现，在生产高峰期间，某些印刷机器有(随
机地)少印1~3颗星或1~2条整条条纹的倾向。除了这些错误之外，在其他方面国旗都很完美。
尽管对于全部产品来说，含有错误的国旗的数量很少，但工厂经理仍决定解决该问题。仔细研究
后，他认为使用图像处理技术来进行自动检测是解决该问题的最经济方法。基本规格如下：国
旗大小约为7.5cm×12.5cm。他们将生产线纵向移动(独立的，但方向上有±10°变化)的速度减
小到大约40 cms,国旗之间的间隔大约为5 cm。所有情形下，“大约”都意味着±5??假设工
厂经理雇用您为生产线设计一个图像处理系统。在论证方法的可行性时，您被告知成本和简单性
是很重要的考虑因素。请基于图1.23设计一个完整的系统。将您的解决方案(包括各种假设和规
格)简单(但清楚)地写成文档并上报给工厂经理。
932
附录A 图像压缩编码表
引言
本附录包含了CCITT和JPEG压缩中使用的码表。表A.1和表A.2是CCITT Group 3和CCITT
Group 4压缩的改进霍夫曼编码。表A.3至表A.5是JPEG DCT系数的编码。关于使用这些表的更多
信息，请参阅第8章中的8.2.5节和8.2.8节。
表A.1 CCITT终结码
行程 白色码字 黑色码字 行程 白色码字 黑色码字
0 00110101
1 000111
32
33
0XW011011 000001101010
00010010 000001101011
2
3
0111
1000
34
35
000100;1 000011010010
00010100 000011010011
4
5
1011
1100
6 1110
7 1111
3637
38
39
00010101 000011010100
00010110 000011010101
00010111 000011010110
00101000 000011010111
8 10011 40 00101001 00000110H100
9 10100 41 00101010 000001101101
10 00111 42 00101011 000011011010
11 01000 43 00101100 000011011011
12 001000
13 000011
4445
00101101 0K00001010100
00000100 000001010101
1415
110100 46 00X00101 000001010110
110101
16 101010
47
48
00001010 000001010111
00001011 000001100100
17 101011 49 01010010 000001100101
18 0100111
19 0001100
20 0001000
505152
01010011 000001010010
01010100 000001010011
01010101 000000100100
21 0010111
222324
25
0000011
0X0100
5354
55
00100100 000000110111
00100101 000000111000
01011000 000000100111
0101000
0101011
2627 0010011
5657
58
01011001 000000101000
01011010 1000K101100X0
01011011 000001011001
0100100 59 01001010 (0000101011
0000110111
010
11
10
011
0011
0010
00011
000101
000100
0000100
0000101
0000111
00000100
00000111
00001 1000
0000010111
0000011000
000000100X0
00001100111
00001101000
0X001101100
00000110111
(X000101000
00000010111
00000011000
000X011001010
000011001011 :9
592
行程
28
29
30
31
行程
64
128
192
256
320
384
448
512
576
640
704
768 832
896
1792
1856
1920
1984
2048
2112
2176
数字图像处理(第三版)
(续表)
黑色码字 行程 白色码字 黑色码字
000011001100 60 01001011 000000101100
000011001101 61 00110010 000001011010
000001101000 62 00110011 000001100110
000001101001 63 00110100 000001100111
表A.2 CCITT补充码
黑色码字 行程 白色码字 黑色码字
0000001111 960 011010100 0000001110011
000011001000 1024 011010101 0000001110100
000011001001 1088 011010110 0000001110101
000001011011 1152 011010111 0000001110110
000000110011 1216 011011000 0000001110111
000000110100 1280 011011001 0X00001010010
000X000110101 1344 011011010 0000001010011
0000001101100 1408 011011011 0000001010100
0000001101101 1472 010011000 0000001010101
0000001001010 1536 010011001 0000001011010
0000001001011 1600 010011010 0000001011011
0000001001100 1664 011000 000001100100
0000001001101 1728 010011011 0000001100101
0000001110010
码字 码字
00000001000 2240 000000010110
00000001100 2304 000000010111
00000001101 2368 000000011100
000000010010 2432 000000011101
000000010011 2496 000000011110
000000010100 2560 000000011111
000000010101
表A.3 JPEG系数编码分类
值域 DC差值分类 AC分类
0 0 NA
-1.1 -3,-2.2,3
-7,…,-4.4.….7
2
3
1
2
-15,…,-8.8.….15 4
3
4
-31..-16,16,…,31
-63.….-32.32,….63
5
6
-127.….-64.64.…,127
-255.….-128.128. .255
7
8
5
6
7
8
-511,-256.256.….511 9 9
-1023,….-512.512..1023 -2047.….-1024,1024,….2047
-4095.….-2048,2048,….4095
A
B
c
A
B
-8191..-4096,4096,-.8191 D
-16383..-8192.8192.…,16383 E
c
D
E
-32767.….-16384.16384,…,32767 F NA
表A.4 JPEG默认的DC编码(照度)
白色码字
0011000
00000010
00000011
00011010
白色码字
11011
10010
0t0111
0110111
00110110
00110111
01100100
01100101
01101000
01100111
011001100
e11001101
0i1010010
011010011
品
类别
0
2
3
4
5
基码
010
011
100
00
101 110
长度
3
4
5
5
7
8
类别
6
7
8
9
A
B
基码
1110
11110
111110
1111110
11111110
111111110
长度
1012
14
16
18
20
附录A 图像压缩编码表
表A.5 JPEG默认的AC编码(照度)
593
行程/类别
0/0
0/1
02
03
04
05
0/6
07
08
09
0A
1/1
1/2
1/3
1/4
1/5
1/6
1/7
1/8
1/9
I/A
2/1 22
2/3
2/4
2/5
2/6
27
2/8
29
2/A
3/1
32
3/3
3/4
3/5
3/6
37
3/8
379
3/A
4/1
4/2
4/3
4/4
4/5
4/6
4/7
4/8
4/9
4/A
5/1
52
5/3
5/4
5/5
5/6
5/7
5/8
59
S/A
6/1
基码
1010(=EOB)
00
0T
100
1011
11010
111000
1111000
1111110110
1111111110008010
111111110000011
1100
111001
1111001
1H110110
11111110110
11111111100X00100
1111111110000101
1111111110000110
1111111110000111
1111111110001000
11011
111110W
1111110111
1111111110001001
1111111110001010
1111111110001011
1111111110001100
1111111110001101
1111111110001110
1111111110001111
111010
111110111
11111110111
1111111110010000
1111111110010X01
1111111110010010
1111111110010011
1111111110010100
1111111110010101
1111111110010110
111011
1111111000
1111111110010111
1111111110011000
1111111110011001
1111111110011010
1111111110011011
1111111110011100
1111111110011101
1111111110011110
1111010
1111111001
1111111110011111
1111111110100WX0
1111111110100001
1111111110100010
1111111110100011
1111111110100100
1111111110100101
1111111110100110
1111011
长度
4
3
4
6
8
1012
14
18
25265
8
10
13
1622
23
2425
26
6
1013
202122
2324
25
26
7
11
14
20
2122
23
24
25
267
12
19
202122
2324
2526
8
12
19
2021
2223
2425
26
K
行程/类别
81
82
83
84
NS
86
87
88
89
NA
91
92
9/3
94
95
9%6
97
9/8
99
9A
A/I
A/2
A3
A/4
A/5
A/6
A/7
A8
A9
AA
B/1
B/2
B/3
B/4
B/5
B/6
B/7
B/8
B/9
B/A
CI
C2
C3
C4
C/5
C6
C7
C8
C9
C/A
D/1
D/2
D/3
D/4
D/S
D/6
D/7
D/8
D/9
D/A
E/1
基码
11111010
111111111000000
1111111110110111
1111111110111000
1111111110111001
111111110111010
1111111110111011
1111110111100
1111111110111101
1111111110111110
111111000
1111111110111111
111111111000000
111111111t000001
111111111100010
1111111111000011
11111111110W0100
1111111111000101
111111111000110
1111111111000111
11111001
1111111111001000
111111111001001
1111111111001010
1111111111001011
1111111111001100
1111111111001101
1111111111001110
1111111111001111
1111111111010000
111111010
111111111010001
1111111111010010
1111111111010011
1111111111010100
1111111111010101
1111111111010110
1111111111010111
1111111111011000
1111111111011001
1111111010
111111111011010
1111111111011011
1111111111011100
1111111111011101
1111111111011110
111111111101111
111111111110000
1111111111100001
111111111110010
11111111010
111111111100011
111111111110010)
1111111111100101
1111111111100110
1111111111100111
1111111111101000
1111111110001
1111111111101010
1111111111101011
111111110110
长度
9
17
19
20
2122
23
2425
26
1018
19
20
21222324
25
26
10
18
19
2021
2223
24
25
26
10
18
19
20
2122
23
24
25
2611
18
19
20
21
222324
252612
18
19
2021
2223
2425
26
13 圜:8
594 数字图像处理(第三版)
行程/类别 基码 长度 行程/类别 基码
6/2 11111111000 E/2 1111111111101100
6/3 1111111110100111 E/3 1111111111101101
6/4 1111111110101000 E/4 1111111111101110
6/5 1111111110101001 E/5 1111111111101111
6/6 1111111110101010 E/6 1111111111110000
6/7 1111111110101011 E/7 1111111111110001
6/8 1111111110101100
6/9 1111111110101101
E/8 1111111111110010
E/9 1111111111110011
6/A 1111111110101110 E/A 1111111111110100
7/1 11111001
7/2 11111111001
F/0 111111110111
F/I 1111111111110101
7/3 1111111110101111 F/2 1111111111110110
7/4 1111111110110000 F/3 1111111111110111
7/5 1111111110110001 F/4 1111111111111000
7/6 1111111110110010 F/5 1111111111111001
7/7 1111111110110011 F/6 1111111111111010
7/8 1111111110110100 F/7 1111111111111011
7/9 1111111110110101 F/8 1111111111111100
7/A 1111111110110110 F/9 1111111111111101
F/A 1111111111111110
13
19
20
21
22
23
2425
26
9
13
19
2021
22
23
24
25
26
(续表)
长度
18
19
20
21
22
23
24
25
26
12
17
18
19
20
21
22
23
24
25
26
936
附录B 参考书目
Abidi,M.A.andGonzalez,R.C.(eds.)[1992].Data Fusion in Robotics and Machine
Intelligence,Academic Press,New York.
Abidi,M.A.,Eason,R.O.,and Gonzalez,R.C.[1991].“Autonomous Robotics Inspec tion and Manipulation Using Multisensor Feedback,"IEEE Computer,vol.24,no.4,
pp.17-31.
Abramson,N.[1963].Information Theory andCoding,McGraw-Hill,New York.
Adiv,G.[1985]."Determining Three-Dimensional Motion and Structure from Optical
Flow Generatedby Several Moving Objects,"IEEETrans Pattem AnaL Mach.IntelL
vol.PAMI-7,no.4,pp.384-401.
Aggarwal,J.K.and Badler,N.I.(eds.)[1980]."Motion and Time-Varying Imagery,"
IEEE Trans. Pattern Anal.Mach.IntelL,Special Issue,vol.PAMI-2,no.6,pp.493-588.
Aguado,A.S,Nixon, M.S, and Montiel, M.M.[1998],“Parameterizing Arbitrary Shapes via Fourier Descriptors for Evidence-Gathering Extraction,"Computer Vision and Image Understanding,vol.69,no.2,pp.202-221.
Ahmed,N,Natarajan,T,and Rao,K.R.[1974]."Discrete Cosine Transforms"IEEE
Trans. Comp,vol.C-23,pp.90-93.
Ahmed,N.and Rao,K.R.[1975].Orthogonal Transfornsfor Digital Signal Processing.
Springer-Verlag,New York.
Aizaka,K.and Nakamura,A.[1999].“Parsing of Two-Dimensional Images Represented
by Quadtree Adjoining Grammars," Pattern Recog.,vol.32,no.2,pp.277-294.
Alexiadis,D.S.and Sergiadis,G.D.[2007].“Estimation ofMultiple Accelerated Motions
Using Chirp-Fourier Transforms and Clustering,"IEEE Trans Image Proc,vol.16,
no.1,pp.142-152.
Alliney,S.[1993]."Digital Analysis of Rotated Images,"IEEE Trans. Pattern AnaL
Machine Intell,vol.15,no.5,pp.499-504.
Ando,S.[2000]."Consistent Gradient Operators,"IEEETrans.Pattern Anal.Machine
Intell,vol.22,no.3.pp.252-265.
Andrews,H.C.[1970]. Computer Techniques in Image Processing,Academic Press,
New York.
Andrews,H.C.and Hunt,B.R.[1977].DigitalImage Restoration,Prentice Hall, Engle wood Cliffs,NJ.
Anelli, G,Broggi,A.,and Destri, G.[1998].“Decomposition of Arbitrarily-Shaped
Morphological Structuring Elements UsingGenetic Algorithms,"IEEETrans Pattern
Anal. Machine Intell.,vol.20,no.2,pp.217-224.
Ang,PH,Ruetz,PA.,and Auld,D.[1991]."Video Compression Makes Big Gains,"
IEEE Spectrum,vol.28,no.10,pp.16-19.
Antonini,M.,Barlaud,M,Mathieu,P,and Daubechies,L.[1992]."Image Coding Using Wavelet Transform,"IEEE Trans ImageProcessing,vol.1,no.2,pp.205-220.
Ascher,R.N.and Nagy.G.[1974]."A Means for Achievinga High Degree of Compaction
on Scan-Digitized Printed Text,"IEEE Transactions on Comp,C-23:1174-1179.
Atchison,D.A.and Smith,G.[2000].Optics ofthe HumanEye,Butterworth-Heinemann,
Boston,Mass.
Baccar,M.,Gee,L.A.,Abidi,M.A,and Gonzalez, R.C.[1996].“Segmentation of Range Images Via Data Fusion and Morphological Watersheds," Pattern Recog,vol.
29,no.10,pp.1671-1685.
Bajcsy, R.and Licberman,L[1976]."Texture Gradient as a DepthCue,"Comput. Graph
Image Proc,vol.5,no.1.pp.52-67.
Bakir,T.and Reeves,J.S.[2000].“A Filter Design Method for Minimizing Ringing in a
596 数字图像处理(第三版)
Regionof Interest in MR Spectroscopic Images,"IEEETrans.Medical Imaging,vol.19,
no.6,pp.585-600.
Ballard,D.H.[1981]."Generalizing the Hough Transform to Detect Arbitrary Shapes,"
Pattern Recognition,vol.13,no.2,pp.111-122.
Ballard,D.H.and Brown,C.M.[1982]. Computer Vision,Prentice Hall,Englewood
Cliffs,N.J.
Banham,M.R.,Galatsanos,H.L.,Gonzalez,H.L.,and Katsaggelos,A.K.[1994].“Mul tichannel Restoration of Single Channel Images Using a Wavelet-Based Subband
Decomposition,"IEEE Trans.Image Processing,vol.3,no.6,pp.821-833.
Banham,M.R.and Katsaggelos,A.K.[1996].“Spatially Adaptive Wavelet-Based Mul- tiscale Image Restoration,"IEEE Trans Image Processing,vol.5,no.5,pp.619-634.
Basart,J.P.and Gonzalez, R.C.[1992]."Binary Morphology,"in Advances in Image
Analysis,Y.Mahdavieh and R.C. Gonzalez(eds.),SPIE Press,Bellingham,Wash.,
pp.277-305.
Basart,J.P,Chacklackal,M.S.,and Gonzalez,R.C.[1992]."Introduction to Gray-Scale
Morphology,"in Advances in Image Analysis, Y.Mahdavieh and R.C. Gonzalez
(eds.),SPIE Press,Bellingham,Wash.,pp.306-354.
Bates,R.H.T.and McDonnell,M.J.[1986].Image Restoration and Reconstruction,Oxford
University Press,New York.
Battle,G.[1987]."A Block Spin Construction of Ondelettes.Part I:Lemarié Functions,"
Commun.Math.Phys.,vol.110,pp.601-615.
Battle,G.[1988].“A Block Spin Construction of Ondelettes.Part II:the QFTConnec- tion,"Commun.Math.Phys.,vol.114,pp.93-102.
Baumert,L.D.,Golomb,S.W.,and Hall,M.,Jr.[1962].“Discovery of a Hadamard Matrix of Order 92,"Bull. Am.Math.Soc.,vol.68,pp.237-238.
Baxes, G.A.[1994].Digital Image Processing:Principles and Applications,John Wiley
& Sons,New York.
Baylon,D.M.and Lim,J.S.[1990].“Transform/Subband Analysis and Synthesis of Signals,"Tech.Report,MIT Research Laboratory of Electronics, Cambridge, Mass.
Bell,E.T.[1965].Men of Mathematics,Simon & Schuster,New York.
Bengtsson,A.and Eklundh,J.O.[1991].“Shape Representation by Multiscale Contour Approximation,"IEEE Trans. Patern Anal.Machine Intell.,vol.13,no.1,pp.85-93.
Benson,K.B.[1985].Television Engineering Handbook,McGraw-Hill, New York.
Berger,T.[1971]. Rate Distortion Theory,Prentice Hall, Englewood Cliffs,NJ.
Beucher,S.[1990]. Doctoral Thesis,Centre de Morphologie Mathématique, Ecole des
Mines de Paris,France.(The core of this material is contained in the following paper.)
Beucher,S.and Meyer,E.[1992]."The Morphologica!Approach of Segmentation:The Watershed Transformation,"in Mathematical Morphology in Image Processing,
E.Dougherty(ed.),Marcel Dekker,New York.
Bezdek,J.C.,et al.[2005]. Fuzzy Models and Algorithms for Pattern Recognition and
Image Processing,Springer,New York.
Bhaskaran, V.and Konstantinos,K.[1997].Image and Video Compression Standards:
Algorithms and Architectures,Kluwer,Boston,Mass.
Bhatt,B.,Birks,D.,Hermreck,D.[1997]."Digital Television:Making It Work,"IEEE
Spectrum,vol.34,no.10,pp.19-28.
Biberman,L.M.[1973].“Image Quality,” In Perception of Displayed Information,
Biberman,L.M.(ed.),Plenum Press,New York.
Bichsel,M.[1998].“Analyzing a Scene's Picture Set under Varying Lighting,”Computer
Vision and Image Understanding,vol.71,no.3,pp.271-280.
Bieniek,A.and Moga,A.[2000].“An Efficient Watershed Algorithm Based on Con nected Components,"Pattern Recog.,vol.33,no.6,pp.907-916.
Bisignani,W.T,Richards, G.P,and Whelan,J.W.[1966].“The Improved Grey Scale
and Coarse-Fine PCM Systems:Two New Digital TV Bandwidth Reduction Tech- niques,"Proc.IEEE,vol.54,no.3,pp.376-390.
Blahut,R.E.[1987].Principles and Practice of Information Theory,Addison-Wesley,
Reading,Mass.
附录B 参考 书目
Bleau,A.and Leon,L.J.[2000].“Watershed-Based Segmentation and Region Merg ing,"Computer Visionand Image Understanding,vol.77,no.3,pp.317-370.
Blouke,M.M.,Sampat,N.,and Canosa,J.[2001]. Sensors and Camera Systemsfor
Scientific, Industrial, and Digital Photography Applications-II,SPIE Press
Bellingham,Wash.
Blum,H.[1967].“A Transformation for Extracting New Descriptors of Shape,” In
Models for the Perception of Speech and Visual Form,Wathen-Dunn,W.(ed.),MIT Press,Cambridge,Mass.
Blume,H.and Fand,A.[1989].“Reversible and Irreversible Image Data Compression Using the S-Transform and Lempel-Ziv Coding," Proc.SPIE Medical Imaging II:
Image Capture and Display,vol.1091,pp.2-18.
Boie,R.A.and Cox,I.J.[1992]."An Analysis of Camera Noise,"IEEE Trans Pattern
Anal.Machine Intell.,vol.14,no.6,pp.671-674.
Born,M.and Wolf,E.[1999].Principles of Optics: Electromagnetic Theory of Propa gation,Interference and Diffraction of Light,7th ed.,Cambridge University Press,
Cambridge,UK.
Boulgouris,N.V.,Tzovaras,D.,and Strintzis,M.G.[2001].“Lossless Image Compres sion Based on Optimal Prediction,Adaptive Lifting, and Conditional Arithmetic Coding,"IEEE Trans.Image Processing,vol.10,no.1,pp.1-14.
Bouman,C.and Liu,B.[1991]."Multiple Resolution Segmentation of Textured Images,"
IEEE Trans. Pattern.Anal.Machine Intell.,vol.13,no.2,pp.99-113.
Boyd,J.E.and Meloche,J.[1998].“Binary Restoration of Thin Objects in Multidimen sional Imagery,"IEEETrans. Pattern Anal.Machine Intell.,vol.20,no.6,pp.647-651.
Bracewell,R.N.[1995].Two-Dimensional Imaging,Prentice Hall,Upper Saddle River,NJ.
Bracewell,R.N.[2000].The Fourier Transform and its Applications,3rd ed.McGraw Hill,New York.
Brechet,L.,Lucas,M.,Doncarli,C.,and Farnia,D.[2007].“Compression of Biomedical
Signals with Mother Wavelet Optimization and Best-Basis Wavelet Packet Selec- tion,"IEEE Trans.on Biomedical Engineering,in press.
Bribiesca,E.[1981].“Arithmetic Operations Among Shapes Using Shape Numbers,”
Pattern Recog.,vol.13,no.2,pp.123-138.
Bribiesca,E.[1999]."A New Chain Code,"Pattern Recog.,vol.32,no.2,pp.235-251.
Bribiesca,E.[2000]."A Chain Code for Representing 3-D Curves,"Pattern Recog.,vol.
33,no.5,pp.755-765.
Bribiesca,E.and Guzman,A.[1980]."How to Describe Pure Form and How to Measure Differences in Shape Using Shape Numbers,"Pattern Recog.,vol.12,no.2,pp.101-112.
Brigham,E.O.[1988].The Fast Fourier Transform and its Applications,Prentice Hall,
Upper Saddle River,N.J
Brinkman,B.H.,Manduca,A.,and Robb,R.A.[1998].“Optimized HomomorphicUn sharp Masking for MR Grayscale Inhomogeneity Correction,"IEEE Trans.Medical
Imaging,vol.17,no.2,pp.161-171.
Brummer,M. E.[1991].“Hough Transform Detection of the Longitudinal Fissure in Tomographic Head Images,"IEEE Trans. Biomed.Images,vol.10,no.1,pp.74-83.
Brzakovic,D.,Patton,R.,and Wang,R.[1991].“Rule-Based Multi-Template Edge Detec- tion,"Comput.Vision,Graphics,Image Proc:Graphical Models and Image Proc., vol.53,no.3,pp.258-268.
Bunke,H.and Sanfeliu,A.(eds.)[1990].Syntactic and Structural Pattern Recognition:
Theory and Applications,World Scientific,Teaneck,N.J.
Burrus,C.S,Gopinath, R.A.,and Guo,H.[1998].Introduction to Wavelets and Wavelet
Transforms,Prentice Hall,Upper Saddle River,NJ.,pp.250-251.
Burt,P. J.and Adelson,E.H.[1983].“The Laplacian Pyramid as a Compact Image Code,"IEEE Trans. Commun.,vol.COM-31,no.4,pp.532-540.
Cameron,J.P [2005].Sets,Logic,and Categories,Springer,New York.
Campbell,J.D.[1969]."Edge Structure and the Representation of Pictures,"Ph.D.
dissertation,Dept.of Elec. Eng.,University of Missouri,Columbia.
Candy,J. C.,Franke,M.A.,Haskell,B.G,and Mounts,F.W.[1971]."Transmitting
597
598 数字图像处理(第三版)
Television as Clusters of Frame-to-Frame Differences," Bell Sys. Tech.J.,vol.50,
pp.1889-1919.
Cannon,T.M.[1974].“Digital Image Deblurring by Non-Linear Homomorphic Filter ing,"Ph.D.thesis,Universityof Utah.
Canny,J.[1986]."A Computational Approach for Edge Detection,"IEEE Trans. Pat tern Anal.MachineIntell,vol.8,no.6,pp.679-698.
Carey,W.K.,Chuang,D.B.,and Hamami,S.S.[1999].“Regularity-Preserving Image Interpolation,"IEEE Trans.Image Processing,vol.8,no.9,pp.1293-1299.
Caselles,V.,Lisani,J.-L.,Morel,J.-M.,and Sapiro,G.[1999].“Shape Preserving Local Histogram Modification,"IEEE Trans. Image Processing,vol.8,no.2,pp.220-230.
Castleman,K.R.[1996].Digital Image Processing,2nd ed.Prentice Hall,Upper Saddle
River,N.J.
Centeno,J.A.S.and Haertel,V.[1997]."An Adaptive Image Enhancement Algorithm,"
Pattern Recog.,vol.30,no.7 pp.1183-1189.
Chan, R.C.,Karl,W.C.,and Lees,R.S.[2000].“A New Model-Based Technique for En- hanced Small-Vessell Measurements in X-Ray Cine-Angiograms,"IEEETrans. Medical
Imaging,vol.19,no.3,pp.243-255.
Chandler,D.and Hemami,S.[2005].“DynamicContrast-Based Quantization for Lossy Wavelet Image Compression,"IEEETrans Image Proc,vol.14,no.4,pp.397-410.
Chang,S.G.,Yu,B.,and Vetterli,M.[2000].“Spatially Adaptive Wavelet Thresholding with Context Modeling for Image Denoising,"IEEE Trans.Image Processing,vol.9,
no.9,pp.1522-1531.
Chang,S.K.[1989].Principles of Pictorial Information Systems Design,Prentice Hall,
Englewood Cliffs,NJ.
Chang.T.and Kuo,C-C.J.[1993].“Texture Analysis and Classificationwith Tree-Structures
Wavelet Transforms,"IEEE Trans.Image Processing,vol.2,no.4,pp.429-441.
Champeney,D.C. [1987].A Handbook of Fourier Theorems, Cambridge University
Press,New York.
Chaudhuri,B.B.[1983].“A Note on Fast Algorithms for Spatial Domain Techni ques in Image Processing,"IEEE Trans. Syst. Man Cyb., vol. SMC-13,no. 6,
pp.1166-1169.
Chen,M.C.and Wilson,A.N.[2000].“Motion-Vector Optimization of Control Grid In terpolation and Overlapped Block Motion Compensation Using Iterated Dynamic Programming,"IEEE Trans Image Processing.,vol.9,no.7,pp.1145-1157.
Chen,Y.-S.and Yu,Y.-T.[1996]."Thinning Approach for Noisy Digital Patterns,"
Pattern Recog.,vol.29,no.11,pp.1847-1862.
Cheng,H.D.and Huijuan Xu,H.[2000].“A Novel Fuzzy Logic Approach to Contrast Enhancement,"Pattern Recog.,vol.33,no.5,pp.809-819.
Cheriet,M.,Said,J.N,and Suen,C.Y.[1998].“A Recursive Thresholding Technique for
Image Segmentation,"IEEETrans. Image Processing,vol.7,no.6,pp.918-921.
Cheung,J., Ferris,D.,and Kurz,L.[1997].“On Classification of Multispectral Infrared Image Data,"IEEETrans. Image Processing,vol.6,no.10,pp.1456-1464.
Cheung.K.K.T.and Teoh,E.K.[1999].“Symmetry Detection by Generalized Complex
(GC)Moments:A Closed-Form Solution,"IEEETrans. Pattern Anal.Machine Intell.,
vol.21,no.5,pp.466-476.
Chow,C.K.and Kaneko,T.[1972].“Automatic Boundary Detection of the Left Ventri- cle from Cineangiograms,"Comp.,and Biomed.Res.,vol.5,pp.388-410.
Chu,C-C.and Aggarwal,J.K.[1993].“The Integration of Image Segmentation Maps
Using Regions and Edge Information,"IEEE Trans. Pattern Anal. Machine Intell.
vol.15,no.12,pp.1241-1252.
CIE [1978].Uniform Color Spaces-Color Difference Equations-Psychometric Color
Terms, Commission Internationale de LEclairage,Publication No.15,Supplement
No.2,Paris.
Clark, JJ.[1989].“Authenticating Edges Produced by Zero-Crossing Algorithms,” IEEE Trans. Pattern Anal.Machine Intell,vol.12,no.8,pp.830-831.
Clarke,R.J.[1985].Transform Coding of Images,Academic Press,New York.
附录B 参考 书目
Cochran,W.T.,Cooley,J.W.,et al.[1967].“What Is the Fast Fourier Transform?”IEEE
Trans.Audio and Electroacoustics,vol.AU-15,no.2,pp.45-55.
Coeurjolly,D.and Klette,R.[2004].“A Comparative Evaluation of Length Estima- tors of Digital Curves,"IEEE Trans. Pattern.Analysis Machine Int.,vol.26,no.XX,
pp.252-258.
Cohen,A.and Daubechies,I.[1992].A Stability Criterion for Biorthogonal Wavelet
Bases and Their Related Subband Coding Schemes, Technical Report,AT&T Bell
Laboratories.
Cohen,A.,Daubechies,I., and Feauveau,J.-C.[1992].“Biorthogonal Bases of Com pactly Supported Wavelets"Commun.Pure and Appl. Math.,vol.45,pp.485-560.
Coifman, R.R.and Wickerhauser, M.V.[1992].“Entropy-Based Algorithms for Best Basis Selection,"IEEETran.Information Theory,vol.38,no.2,pp.713-718.
Coltuc,D.,Bolon,P,and Chassery,J.M.[2006]."Exact Histogram Specification,"IEEE
Trans. Image Processing,vol.15,no.5,pp.1143-1152.
Cooley,J.W.,Lewis,P.A.W.,and Welch,P.D.[1967a].“Historical Notes on the Fast
Fourier Transform,"IEEE Trans. Audio and Electroacoustics,vol.AU-15,no.2,
pp.76-79.
Cooley,J.W.,Lewis,P.A.W.,and Welch,P.D.[1967b].“Application of the Fast Fourier Transform to Computation of Fourier Integrals,"IEEE Trans. Audio and Electroa coustics,vol.AU-15,no.2,pp.79-84.
Cooley,J.W.,Lewis,P.A.W.,and Welch,P.D.[1969].“The Fast Fourier Transform and Its Applications,"IEEE Trans. Educ.,vol.E-12,no.1.pp.27-34.
Cooley,J.W.and Tukey,J.W.[1965].“An Algorithm for the Machine Calculation of
Complex Fourier Series,"Math.of Comput.,vol.19,pp.297-301.
Cornsweet,T.N.[1970].Visual Perception,Academic Press,New York.
Cortelazzo,G.M.,Lucchese,L.,and Monti,C.M.[1999].“Frequency Domain Analysis
ofGeneral Planar Rigid Motion with Finite Duration,"IOpt. Soc.Amer.-A.Optics,
Image Science,and Vision,vol.16,no.6,pp.1238-1253.
Cowart,A.E.,Snyder,W.E.,and Ruedger,W.H.[1983].“The Detection of Unresolved
Targets Using the Hough Transform,"Comput.Vision Graph Image Proc.,vol.21,
pp.222-238.
Cox,I.,Kilian,J., Leighton,F,and Shamoon,T.[1997].“Secure Spread Spectrum Wa- termarking for Multimedia,"IEEE Trans. Image Proc,vol.6,no.12,pp.1673-1687.
Cox,I.,Miller,M.,and Bloom,J.[2001]. Digital Watermarking,Morgan Kaufmann
(Elsevier),New York.
Creath,K.and Wyant,IC.[1992]."Moire and Fringe Patterns,"in Optical Shop Testing,
2nd ed.,(D.Malacara,ed.),John Wiley & Sons,New York,pp.653-685.
Croisier,A.,Esteban,D.,and Galand,C.[1976].“Perfect Channel Splitting by Use of
Interpolation/Decimation/Tree Decomposition Techniques,"Int.Conf On Inform.
Sciences and Systems,Patras, Greece,pp.443-446.
Cumani,A.,Guiducci,A., and Grattoni, P.[1991].“Image Description of Dynamic Scenes,"Pattern Recog.,vol.24,no.7,pp.661-674.
Cutrona,L.J.and Hall,W.D.[1968]."Some Considerations in Post-Facto Blur Removal,"
In Evaluation of Motion-Degraded Images,NASA Publ.SP-193,pp.139-148.
Danielson, G.C. and Lanczos,C. [1942].“Some Improvements in Practical Fourier
Analysis andTheir Application to X-Ray Scattering from Liquids,"J. Franklin Insti tute,vol.233,pp.365-380,435-452.
Daubechies, I.[1988].“Orthonormal Bases of Compactly Supported Wavelets,” Commun.On Pure and Appl. Math.,vol.41,pp.909-996.
Daubechies,I.[1990].“The Wavelet Transform,Time-Frequency Localization and Sig- nal Analysis,"IEEE Transactions on Information Theory,vol.36,no.5,pp.961-1005.
Daubechies,I.[1992].Ten Lectures on Wavelets,Society for Industrial and Applied
Mathematics,Philadelphia,Pa.
Daubechies,L.[1993].“Orthonormal Bases of Compactly Supported Wavelets II,Varia tions on a Theme,"SIAMJ.Mathematical Analysis,vol.24,no.2,pp.499-519.
Daubechies, I.[1996]."Where Do We Go from Here?-A Personal Point of View,"
599
600 数字图像处理(第三版)
Proc.IEEE,vol.84,no.4,pp.510-513.
Daul,C.,Graebling,P,and Hirsch,E.[1998].“From the Hough Transform toa New Ap- proach for the Detection of and Approximation of Elliptical Arcs,"ComputerVision
and Image Understanding,vol.72,no.3,pp.215-236.
Davies,E.R.[2005].Machine Vision:Theory,Algorithms, Practicalities,Morgan Kauf mann,San Francisco.
Davis, L.S.[1982]."Hierarchical Generalized Hough Transforms and Line-Segment Based Generalized Hough Transforms,"Pattern Recog.,vol.15,no.4,pp.277-285.
Davis,T.J.[1999].“Fast Decompositionof Digital Curvesinto Polygons Using the Haar Transform,"IEEETrans. PatternAnal.Machine Intell,vol.21,no.8,pp.786-790.
Davisson,L.D.[1972].“Rate-Distortion Theory and Application,”Proc.IEEE,vol.60,
pp.800-808.
Delaney,A.H.and Bresler,Y.[1995].“Multiresolution Tomographic Reconstruction
Using Wavelets,"IEEE Trans.Image Processing,vol.4,no.6,pp.799-813.
Delon,J.,Desolneux,A.,Lisani,J.L.,and Petro,A.B.[2007].“A Nonparametric Approach for Histogram Segmentation,"IEEE Trans. Image Proc,vol.16,no.1,pp.253-261.
Delp,E.J.and Mitchell,O.R.[1979].“Image Truncation using Block Truncation Cod ing,"IEEETrans.Comm.,vol.COM-27,pp.1335-1342.
Di Zenzo,S.[1986]."A Note on the Gradient of a Multi-Image," Computer Vision,
Graphics, and Image Processing,vol.33,pp.116-125.
Dijkstra, E.[1959]."Note on Two Problems in Connection with Graphs,"Numerische
Mathematik,vol.1,pp.269-271.
Djeziri,S.,Nouboud, F, and Plamondon, R.[1998].“Extraction of Signatures from
Check Background Based on a Filiformity Criterion,"IEEE Trans. Image Process ing,vol.7,no.102,pp.1425-1438.
Dougherty, E.R.[1992].An Introduction to Morphological Image Processing,SPIE
Press,Bellingham,Wash.
Dougherty, E.R.(ed.)[2000]. Random Processes for Image and Signal Processing
IEEE Press,New York.
Dougherty.E.R.and Lotufo,R.A.[2003].Hands-on Morphological Image Processing,
SPIE Press,Bellingham,WA.
Drew,M.S.,Wei,J.,and Li,Z.-N.[1999].“IIlumination Invariant Image Retrieval and
Video Segmentation," Pattern Recog.,vol.32,no.8,pp.1369-1388.
Duda,R.O.and Hart,P.E.[1972].“Use of the HoughTransformation to Detect Lines
and Curves in Pictures,"Comm.ACM,vol.15,no.1,pp.11-15.
Duda,R.O, Hart,P. E.,and Stork,D.G.[2001]. Pattern Classification,JohnWiley &
Sons,New York.
Dugelay,J.,Roche,S,Rey,C.,and Doerr,G.[2006].“Still-image Watermarking Robust to Local Geometric Distortions,"IEEE Trans. Image Proc,vol.15,no.9,pp.2831-2842.
Edelman,S.[1999]. Representation and Recognition in Vision,The MIT Press,Cam bridge,Mass.
Elias,P.[1952]."Fourier Treatment of Optical Processes,"J.Opt.Soc.Am.,vol.42,no.2,
pp.127-134.
Elliott,D.F.and Rao,K.R.[1983]. Fast Transforms:Algorithms and Applications,Aca demic Press,New York.
Eng,H.-L.and Ma,K.-K.[2001]."Noise Adaptive Soft-Switching Median Filter,"IEEE
Trans. Image Processing,vol.10,no.2,pp.242-251.
Eng,H.-L.and Ma,K.-K.[2006].“A Switching Median Filter With Boundary Discrim- initative Noise Detection for Extremely Corrupted Images,"IEEE Trans. Image
Proc,vol.15,no.6,pp.1506-1516.
Equitz,W.H.[1989]."A New Vector Quantization Clustering Algorithm,"IEEE Trans
Acous Speech Signal Processing,vol.ASSP-37,no.10,pp.1568-1575.
Etienne,E.K.and Nachtegael,M.(eds.)[2000].Fuzzy Techniques in Image Processing, Springer-Verlag,New York.
Evans,A.N.and Liu,X.U.[2006].“A Morphological Gradient Approach to Color Edge Detection,"IEEE Trans. Image Proc,vol.15,no.6,pp.1454-1463.
附录B 参考 书目
Falconer,D.G.[1970]."Image Enhancement and Film Grain Noise."Opt.Acta,vol.17,
pp.693-705.
Fairchild,M.D.[1998].Color Appearance Models,Addison-Wesley.Reading.Mass.
Federal Bureau of Investigation[1993].WSQ Gray-Scale Fingerprint Image Compres sion Specification,IAFIS-IC-0110v2,Washington,D.C.
Felsen, L.B.and Marcuvitz,N.[1994].Radiation and Scattering of Waves.IEEE Press,
NewYork.
Ferreira,A.and Ubéda.S.[1999].“Computing the Medial Axis Transform in Parallel
with Eight ScanOperators,"IEEE Trans Pattern Anal.Machine Intell,vol.21,no.3,
pp.277-282.
Fischler,M.A.[1980]."Fast Algorithms for TwoMaximal Distance Problems with
Applicationsto Image Analysis,"Pattern Recog.,vol.12,pp.35-40.
Fisher,R.A.[1936]."The Use of Multiple Measurements in Taxonomic Problems,"
Ann.Eugenics,vol.7,Part 2,pp.179-188.(Also in Contributions to Mathematical Sta tistics,John Wiley& Sons,New York,1950.)
Flusser,J.[2000]."On the Independence of Rotation Moment Invariants," Pattern
Recog.vol.33.pp.1405-1410.
Forsyth,D.E.and Ponce,J.[2002].Computer Vision-A Modem Approach,Prentice
Hall,UpperSaddle River,NJ.
Fortner,B.and Meyer,T.E.[1997].Number by Colors,Springer-Verlag.New York.
Fox,E.A.[1991]."Advances in Interactive Digital Multimedia Systems,"Computer,vol.
24,no.10,pp.9-21.
Fram,J.R.and Deutsch,E.S.[1975].“Oa the Quantitative Evaluation of Edge Detec- tion Schemes andTheir Comparison with Human Performance,"IEEE Trans Com puters,vol.C-24,no.6.pp.616-628.
Freeman,A.(translator)[1878].J.Fourier.The Analytical Theory of Heat,Cambridge:
University Press,London.
Freeman,C.[1987].Imaging Sensors and Displays,ISBN 0-89252-800-1,SPIE Press,
Bellingham,Wash.
Freeman,H.[1961]."On the Encoding of Arbitrary Geometric Configurations,"IEEE
Trans Elec. Computers,vol.EC-10,pp.260-268.
Freeman,H.[1974]."Computer Processing of Line Drawings,"Comput. Surveys,vol.6, pp.57-97.
Freeman,H.and Shapira,R.[1975]."Determining the Minimum-Area Encasing Rec tangle for an Arbitrary Closed Curve."Comm.ACM,vol.18,no.7,pp.409-413.
Freeman,IA.and Skapura,D.M.[1991].Neural Nerworks:Algorithms, Applications,
and Programming Techniques,Addison-Wesley, Reading.Mass.
Frei,W.and Chen,C.C.[1977]."Fast Boundary Detection:A Generalization and a New Algorithm,"IEEE Trans Computers,vol.C-26,no.10,pp.988-998.
Frendendall,G.Land Behrend,W.L[1960]."Picture Quality-Procedures for Evalu ating Subjective Effects of Interference,"Proc.IRE,vol.48,pp.1030-1034.
Fu,K.S.[1982].Syntactic Pattern Recognition and Applications.Prentice Hall, Engle wood Cliffs,NJ.
Fu,K.S and Bhargava,B.K.[1973]."Tree Systems forSyntactic Pattern Recognition,"
IEEE Trans. Comput.,vol.C-22,no.12.pp.1087-1099.
Fu,K.S.,Gonzalez, R.C.,and Lee,C.S.G.[1987].Robotics:Control,Sensing.Vision,
and Intelligence,McGraw-Hill,New York.
Fu,K.S.and Mui,I.K.[1981]."A Survey of Image Segmentation,"Pattern Recog.,vol.
13,no.1,pp.3-16.
Fukunaga.K.[1972].Introduction to Statistical Pattern Recognition,Academic Press,
New York.
Furht, B.,Greenberg.J,and Westwater,R.[1997].Morion Estimation Algorithms for
Video Compression,Kluwer Academic Publishers,Boston.
Gallager,R.and Voorhis,D.V.[1975].“Optimal Source Codes for Geometrically Dis- tributed Integer Alphabets,"IEEE Trans. Inform.Theory,vol.TT-21.pp.228-230.
Gao,X.,Sattar,F,and Vekateswarlu,R.[2007]."Multiscale Corner Detection of Gray
601
602 数字图像处理(第三版)
LevelImages Based on Log-Gabor Wavelet Transform,"IEEE Trans. Circuits and
Systems for Video Technology,in press.
Garcia,P.[1999]."The Use of Boolean Model for Texture Analysisof Grey Images," Computer Vision and Image Understanding,vol.74,no.3,pp.227-235.
Gdalyahu,Y.and Weinshall,D.[1999].“Flexible Syntactic Matchingof Curves and Its
Application to Automated Hierarchical Classification of Silhouettes,"IEEE Trans.
Pattern Anal.MachineIntell,vol.21,no.12,pp.1312-1328.
Gegenfurtner,K.R.and Sharpe,L.T.(eds.) [1999].Color Vision: From Genes to Per ception,Cambridge University Press,New York.
Geladi,P. and Grahn,H.[1996]. Multivariate Image Analysis,John Wiley & Sons
New York.
Geman,D.and Reynolds,G.[1992].“Constrained Restoration and the Recovery of Discontinuities,"IEEE Trans. Pattern Anal.Machine Intell.,vol.14,no.3,pp.367-383.
Gentleman,W.M.[1968].“Matrix Multiplication and Fast Fourier Transformations,”
Bell System Tech.J., vol.47,pp.1099-1103.
Gentleman,W.M.and Sande,G.[1966]."Fast Fourier Transform for Fun and Profit,"
Fall Joint Computer Conf,vol.29,pp.563-578,Spartan,Washington,D.C.
Gharavi,H.and Tabatabai,A.[1988].“Sub-Band Coding of Monochrome and Color
Images,"IEEE Trans. Circuits Sys.,vol.35,no.2,pp.207-214.
Giannakis,G.B.and Heath,R.W.,Jr.[2000].“Blind Identification of Multichannel FIR Blurs and Perfect Image Restoration,"IEEE Trans. Image Processing,vol.9,no.11,
pp.1877-1896.
Giardina,C.R.and Dougherty,E.R.[1988].Morphological Methods in Image and Sig nal Processing,Prentice Hall,Upper Saddle River,N.J.
Golomb,S.W.[1966].“Run-Length Encodings,”IEEE Trans Inform.Theory,vol.IT-12, pp.399-401.
Gonzalez, R.C.[1985]."Computer Vision,"in Yearbook of Science and Technology,
McGraw-Hill,NewYork,pp.128-132.
Gonzalez,R.C.[1985].“Industrial Computer Vision,”in Advances in Information Sys tems Science,Tou,J.T.(ed.),Plenum.New York,pp.345-385.
Gonzalez,R.C.[1986].“Image Enhancement and Restoration,”in Handbook of Pat tern Recognition and ImageProcessing, Young,T.Y.,and Fu, K.S.(eds.),Academic
Press,New York,pp.191-213.
Gonzalez,R.C.,Edwards,J.J.,andThomason,M.G.[1976].“An Algorithm for the In ference of Tree Grammars,"Int.J. Comput.Info. Sci.,vol.5,no.2,pp.145-163.
Gonzalez,R.C.and Fittes, B.A.[1977].“Gray-Level Transformations for Interactive
Image Enhancement,"Mechanism and Machine Theory,vol.12,pp.111-122.
Gonzalez,R.C.and Safabakhsh,R.[1982].“Computer Vision Techniques for Industrial
Applications,"Computer,vol.15,no.12,pp.17-32.
Gonzalez,R.C.and Thomason,M.G.[1978].Syntactic Pattern Recognition:An Intro duction,Addison-Wesley, Reading,Mass.
Gonzalez,R.C.and Woods, R. E.[1992].Digital Image Processing,Addison-Wesley,
Reading,Mass.
Gonzalez,R.C.and Woods,R.E.[2002].Digital Image Processing,2nd ed.,Prentice
Hall,Upper Saddle River,NJ.
Gonzalez,R.C.,Woods,R.E.,and Eddins,S.L.[2004].Digital Image Processing Using
MATLAB,Prentice Hall,Upper Saddle River,NJ.
Good,I.J.[1958].“The Interaction Algorithm and Practical Fourier Analysis,”IR.Stat.
Soc.(Lond.),vol.B20,pp.361-367;Addendum,vol.22,1960,pp.372-375.
Goodson, K.J.and Lewis,P.H.[1990].“A Knowledge-Based Line Recognition Sys- tem,"Pattern Recog. Letters,vol.11,no.4,pp.295-304.
Gordon,I.E.[1997]. Theories of Visual Perception,2nd ed,John Wiley & Sons,New
York.
Gori, M.and Scarselli,F.[1998].“Are Multilayer Perceptrons Adequate for Pattern
Recognition and Verification?”IEEETrans. Pattern Anal.Machine Intell,vol.20,no.
11,pp.1121-1132.
附录B 参考 书目
Goutsias,J.,Vincent,L., and Bloomberg.D.S.(eds) [2000].Mathematical Morphology
and Its Applications to Image and Signal Processing,Kluwer Academic Publishers,
Boston,Mass.
Graham,R.E.[1958].“Predictive Quantizing of Television Signals,”IREWescon Conv.
Rec,vol.2,pt.2,pp.147-157.
Graham,R.L.and Yao,E.F[1983]."Finding the Convex Hull of a Simple Polygon,"
J.Algorithms,vol.4,pp.324-331.
Gray,R.M.[1984].“Vector Quantization,”IEEE Trans.Acous. Speech Signal Process ing,vol.ASSP-1,no.2,pp.4-29.
Grochenig, K.and Madych,W.R.[1992].“Multiresolution Analysis, Haar Bases and
Self-Similar Tilings of R","IEEE Trans. Information Theory, vol. 38,no.2,
pp.556-568.
Grossman,A.and Morlet,J.[1984].“Decomposition of Hardy Functions into Square
Integrable Wavelets ofConstant Shape,"SIAMJ.Appl.Math.vol.15,pp.723-736.
Guil,N.,Villalba,J.and Zapata,E.L.[1995].“A Fast Hough Transform for Segment Detection,"IEEE Trans.Image Processing,vol.4,no.11,pp.1541-1548.
Guil,N.and Zapata,E.L.[1997]."Lower OrderCircle and Ellipse Hough Transform,"
Pattern Recog.,vol.30,no.10,pp.1729-1744.
Gunn,S.R.[1998].“Edge Detection Error in the Discrete Laplacian of a Gaussian,” Proc.1998 Int'l Conference on Image Processing,vol.II,pp.515-519.
Gunn,S.R.[1999].“On the Discrete Representation of the Laplacian of a Gaussian,”
Pattern Recog.,vol.32,no.8,pp.1463-1472.
Gupta,L.,Mohammad,R.S.,and Tammana,R.[1990].“A Neural Network Approach
to Robust Shape Classification,"Pattern Recog.,vol.23,no.6,pp.563-568.
Gupta,L.and Srinath,M.D.[1988].“Invariant Planar Shape Recognition Using Dy- namic Alignment,"Pattern Recog.,vol.21,pp.235-239.
Gupta,L.,Wang.,J.,Charles,A., and Kisatsky, P. [1994].“Three-Layer Perceptron Based Classifiers for the Partial Shape Classification Problem,"Pattern Recog.,vol.
27,no.1,pp.91-97.
Haar,A.[1910].“Zur Theorie der Orthogonalen Funktionensysteme,”Math.Annal.,
vol.69,pp.331-371.
Habibi,A.[1971].“Comparison of Nth Order DPCM Encoder with Linear Transfor mations and Block Quantization Techniques,"IEEE Trans. Comm.Tech.,vol.COM-
19,no.6,pp.948-956.
Habibi,A.[1974].“Hybrid Codingof Pictorial Data,”IEEE Trans. Comm.,vol.COM-
22,no.5,pp.614-624.
Haddon,J.F. and Boyce,I.E.[1990].“Image Segmentation by Unifying Region and
Boundary Information,"IEEE Trans. Pattern Anal. Machine Intell,vol.12,no.10,
pp.929-948.
Hall,E.L.[1979].Computer Image Processing andRecognition,Academic Press,New York.
Hamming,R.W.[1950]."Error Detecting and Error Correcting Codes,"BellSys.Tech.J,
vol.29,pp.147-160.
Hannah,L,Patel,D.,and Davies, R.[1995].“The Use of Variance and Entropy Thresh olding Methods for Image Segmentation,"Pattern Recog.,vol.28,no.8,pp.1135-1143.
Haralick,R.M.and Lee,J.S.J.[1990].“Context Dependent Edge Detection and Evalu- ation,"Pattern Recog.,vol.23,no.1-2,pp.1-20.
Haralick, R.M.and Shapiro,L.G.[1985]."Survey:Image Segmentation,"Comput.Vi sion,Graphics,Image Proc,vol.29,pp.100-132.
Haralick, R.M.and Shapiro,L.G.[1992].Computer and Robot Vision,vols.1&2,
Addison-Wesley, Reading,Mass.
Haralick,R.M.,Sternberg,S.R.,and Zhuang.X.[1987].“Image Analysis Using Mathe matical Morphology,"IEEE Trans. Pattern Anal. Machine Intell,vol.PAMI-9,no.4,
pp.532-550.
Haralick,R.M.,Shanmugan,R., and Dinstein,I.[1973].“Textural Features forImage Classification,"IEEE Trans Syst.Man Cyb,vol.SMC-3,no.6,pp.610-621. Harikumar,G.and Bresler,Y.[1999].“Perfect Blind Restoration of Images Blurred by
603
604 数字图像处理(第三版)
Multiple Filters:Theory and Efficient Algorithms,"IEEE Trans. Image Processing,
vol.8,no.2,pp.202-219.
Harmuth,H.E.[1970].Transmission of Information by Orthogonal Signals, Springer Verlag,New York.
Haris,K., Efstratiadis,S.N, Maglaveras,N., and Katsaggelos,A.K. [1998].“Hybrid Image Segmentation Using Watersheds and Fast Region Merging,"IEEE Trans.
Image Processing,vol.7,no.12,pp.1684-1699.
Hart,P.E.,Nilsson,N.J.,and Raphael,B.[1968].“A Formal Basis for the Heuristic
Determination of Minimum-Cost Paths,"IEEE Trans. Syst. Man Cyb,vol.SMC-4,
pp.100-107.
Hartenstein, H.,Ruhl,M.,and Saupe,D.[2000].“Region-Based Fractal Image Com- pression,"IEEE Trans.Image Processing,vol.9,no.7,pp.1171-1184.
Haskell,B.G.and Netravali,A.N. [1997].Digital Pictures: Representation,Compres sion,and Standards,Perseus Publishing,New York.
Haykin,S.[1996].Adaptive Filter Theory,PrenticeHall,Upper Saddle River,NJ.
Healy,D.J.and Mitchell, O.R.[1981].“Digital Video Bandwidth Compression Using Block Truncation Coding,"IEEE Trans. Comm.,vol.COM-29,no.12,pp.1809-1817.
Heath,M.D.,Sarkar,S., Sanocki, T., and Bowyer, K.W. [1997].“A Robust Visual Method for Assessing the Relative Performance of Edge-Detection Algorithms,"
IEEE Trans. Pattern Anal.Machine Intell,vol.19,no.12,pp.1338-1359.
Heath,M.,Sarkar,S.,Sanoki,T.,and Bowyer,K.[1998].“Comparison of Edge Detec tors:A Methodology and Initial Study,"Computer Vision and Image Understanding vol.69,no.1,pp.38-54.
Hebb,D.O.[1949].The Organization of Behavior:A Neuropsychological Theory,John Wiley & Sons,New York.
Heijmans,H.J.A.M.and Goutsias,J.[2000].“Nonlinear Multiresolution Signal De- composition Schemes-Part II: Morphological Wavelets,"IEEE Trans. Image Pro cessing,vol.9,no.11,pp.1897-1913.
Highnam,R.and Brady,M.[1997].“Model-Based Image Enhancement of Far Infrared Images,"IEEE Trans. Pattern Anal.Machine Intell,vol.19,no.4,pp.410-415.
Hojjatoleslami,S.A.and Kittler,J.[1998].“Region Growing:A New Approach,”IEEE
Trans.Image Processing,vcl.7,no.7,pp.1079-1084.
Hong,Pi,Hung,Li,and Hua,Li[2006]."A Novel Fractal Image Watermarking,"IEEE
Trans.Multimedia,vol.8,no.3,pp.488-499.
Hoover,R.B.and Doty,F.[1996].Hard X-Ray/Gamma-Ray and Neutron Optics,Sen sors, and Applications,SPIEPress,Bellingham,Wash.
Horn,B.K.P.[1986].Robot Vision,McGraw-Hill,New York.
Hotelling,H.[1933].“Analysis of a Complex of Statistical Variables into Principal Com ponents,"J. Educ.Psychol,vol.24,pp.417-441,498-520.
Hough,PV.C.[1962].“Methods and Means for Recognizing Complex Patterns,”U.S.
Patent 3,069,654.
Hsu, C.C.and Huang, JS.[1990].“Partitioned Hough Transform for Ellipsoid Detec- tion,"Pattern Recog.,vol.23,no.3-4,pp.275-282.
Hu.J.and Yan,H.[1997].“Polygonal Approximation of Digital Curves Based on the Principles of Perceptual Organization,"Pattern Recog.,vol.30,no.5,pp.701-718.
Hu,M.K.[1962].“Visual Pattern Recognition by Moment Invariants,”IRETrans.Info
Theory,vol.IT-8,pp.179-187.
Hu,Y.,Kwong,S,and Huang,J.[2006].“An Algorithm for Removable Visible Watermark- ing,"IEEE Trans Circuits and Systems for Video Technology,vol.16,no.1,pp.129-133.
Huang, K.-Y.[2002].Syntactic Pattern Recognition for Seismic Oil Exploration,World
Scientific,Hackensack,NJ.
Huang,S-C.and Sun,Y.-N.[1999].“Polygonal Approximation Using Generic Algo- rithms,"Pattern Recog.,vol.32,no.8,pp.1409-1420.
Huang,TS.[1965].“PCM Picture Transmission,”IEEESpecrum,vol.2,no.12,pp.57-63.
Huang,T.S.[1966]."Digital Picture Coding,"Proc.Natl. Electron.Conf,pp.793-797.
Huang,T.S., ed.[1975]. Picture Processing and Digital Filtering, Springer-Verlag,
附录B 参考 书 目
New York.
Huang,T.S.[1981].Image Sequence Analysis,Springer-Verlag,New York.
Huang,T.S.and Hussian,A.B.S.[1972]."Facsimile Coding by Skipping White,"IEEE
Trans. Comm.,vol.COM-23,no.12,pp.1452-1466.
Huang,T.S.and Tretiak,OJ.(eds.).[1972].Picture Bandwidth Compression,Gordon
and Breech,New York.
Huang,T.S.,Yang,G.T,and Tang,G.Y.[1979].“A Fast Two-Dimensional Median Fil tering Algorithm,"IEEE Trans. Acoust,Speech, Sig. Proc.,vol.ASSP-27,pp.13-18.
Huang,Y.and Schultheiss,P.M.[1963].“Block Quantization of Correlated Gaussian
Random Variables,"IEEE Trans. Commun.Syst.,vol.CS-11,pp.289-296.
Hubbard,B.B.[1998].The World According toWavelets-The Story ofa Mathematical
Technique in the Making,2nd ed,A.K.Peters,Ltd.,Wellesley,Mass.
Hubel,D.H.[1988]. Eye, Brain,and Vision,Scientific Amer.Library,W.H. Freeman,
New York.
Huertas,A.and Medione,G.[1986].“Detection of IntensityChanges with Subpixel Ac curacy using Laplacian-Gaussian Masks,"IEEE Trans. Pattern.Anal.Machine Intell.
vol.PAMI-8,no.5,pp.651-664.
Huffman, D.A.[1952].“A Method for the Construction of Minimum Redundancy
Codes,"Proc.IRE,vol.40,no.10,pp.1098-1101.
Hufnagel,R.E.and Stanley,N.R.[1964].“Modulation Transfer Function Associated
with Image Transmission Through Turbulent Media,"J.Opt. Soc.Amer.,vol.54,
pp.52-61.
Hummel,R.A.[1974]."Histogram Modification Techniques,"Technical Report TR-
329.F-44620-72C-0062,Computer Science Center,University of Maryland,College
Park,Md.
Hunt,B.R.[1971].“A Matrix Theory Proof of the Discrete Convolution Theorem,”
IEEE Trans.Audioand Electroacoust,vol.AU-19,no.4,pp.285-288.
Hunt,B.R.[1973].“The Application of Constrained Least Squares Estimation to Image Restoration by Digital Computer,"IEEE Trans. Comput.,vol.C-22, no.9,
pp.805-812.
Hunter,R.and Robinson,A.H.[1980].“International Digital Facsimile Coding Stan- dards,"Proc.IEEE,vol.68,no.7,pp.854-867.
Hurn,M.and Jennison,C.[1996].“An Extension of Geman and Reynolds'Approach to Constrained Restoration and the Recovery of Discontinuities,"IEEE Trans. Pattern
Anal.Machine Intell, vol.18,no.6,pp.657-662.
Hwang,H.and Haddad,R.A.[1995].“Adaptive Median Filters:New Algorithms and Results,"IEEE Trans. Image Processing,vol.4,no.4,pp.499-502.
IEEE Computer[1974].Special issue on digital image processing.vol.7,no.5.
IEEE Computer[1988].Special issue on artificial neural systems.vol.21,no.3.
IEEE Trans. Circuits and Syst.[1975].Special issue on digital filtering and image pro cessing,vol.CAS-2,pp.161-304.
IEEETrans. Computers[1972].Special issue on two-dimensional signal processing,vol.
C-21,no.7.
IEEE Trans. Comm.[1981].Special issue on picture communication systems,vol.
COM-29,no.12.
IEEE Trans. on Image Processing[1994].Special issue on image sequence compression,
vol.3,no.5.
IEEE Trans on Image Processing[1996].Special issue on vector quantization,vol.5,no.2.
IEEE Trans. Image Processing[1996].Special issue on nonlinear image processing,vol.5,
no.6.
IEEE Trans. Image Processing [1997].Special issue on automatic target detection, vol.6,
no.1.
IEEE Trans.Image Processing [1997].Special issue on color imaging,vol.6,no.7.
IEEE Trans. Image Processing[1998].Special issue on applications of neural networks
to image processing,vol.7,no.8.
IEEE Trans. Information Theory [1992].Special issue on wavelet transforms and
605
606 数字图像处理(第三版)
mulitresolution signal analysis,vol.11,no.2,Part II.
IEEE Trans. Pattern Analysis and Machine Intelligence [1989].Special issue on multi resolution processing,vol.11,no.7.
IEEE Trans. Signal Processing[1993].Special issue on wavelets and signal processing.
vol.41,no.12.
IESLighting Handbook,9th ed.[2000].IluminatingEngineering Society Press,NewYork.
ISO/IEC [1999].ISOIIEC14495-1:1999:Information technology-Lossless and near lossless compression of continuous-tone stillimages: Baseline.
ISO/IECJTC1/SC29/WG1[2000].ISOIIEC FCD15444-1:Information technology JPEG2000 image coding system:Core coding system.
J?hne,B.[1997].Digital Image Processing:Concepts,Algorithms,andScientificApplica tions,Springer-Verlag,New York.
J?hne,B.[2002].Digital Image Processing,5th ed.,Springer,New York.
Jain,A.K.[1981]."Image Data Compression:A Review,"Proc.IEEE,vol.69,pp.349-389.
Jain,A.K.[1989]. Fundamentals of Digital Image Processing,Prentice Hall,Englewood
Cliffs,N.J.
Jain,A.K.,Duin,R.P.W.,and Mao,J.[2000].“Statistical Pattern Recognition:A Re- view,"IEEE Trans. PatternAnal.Machine Intell.,vol.22,no.1,pp.4-37.
Jain,J.R.and Jain,A.K.[1981].“Displacement Measurement and ItsApplication in In- terframe Image Coding,"IEEE Trans. Comm.,vol.COM-29,pp.1799-1808.
Jain,R.[1981]."Dynamic Scene Analysis Using Pixel·Based Processes,"Computer,vol.
14,no.8,pp.12-18.
Jain,R.,Kasturi,R.,and Schunk,B.[1995].Computer Vision,McGraw-Hill,NewYork.
Jang,B.K.and Chin,R.T.[1990].“Analysis of Thinning Algorithms Using Mathematical Morphology,"IEEE Trans. Pattern Anal. Machine Intell,vol.12,no.6,pp.541-551.
Jayant,N.S.(ed.)[1976].Waveform Quantization and Coding,IEEE Press,New York.
Jones,R.and Svalbe,I.[1994].“Algorithms for the Decomposition of Gray-Scale Morphological Operations,"IEEETrans. Pattern Anal. Machine Intell.,vol.16,no.6,
pp.581-588.
Jonk,A.,van den Boomgaard,S.,and Smeulders,A.[1999].“Grammatical Inference of Dashed Lines,"Computer Vision and Image Understanding,vol.74,no.3,pp.212-226.
Kahaner,D.K.[1970]."Matrix Description of the Fast Fourier Transform,"IEEE Trans
Audio Electroacoustics,vol.AU-18,no.4,pp.442-450.
Kak,A.C.and Slaney,M. [2001]. Principles of Computerized Tomographic Imaging,
Society for Industrial and Applied Mathematics, Philadelphia,Pa.
Kamstra,L.andHeijmans,H.J.A.M.[2005}.“Reversible Data Embedding Into Images
Using Wavelet Techniques and Sorting,"IEEETrans. Image Processing,vol.14,no.12,
pp.2082-2090.
Karhunen,K.[1947].“Ober Lineare Methoden in der Wahrscheinlichkeitsrechnung,”
Ann.Acad.Sci. Fennicae,Ser.A137.(Translated by I.Selin in“On Linear Methods in
Probability Theory."T-131,1960,The RAND Corp.,Santa Monica,Calif.)
Kasson,J. and Plouffe,W. [1992].“An Analysis of Selected Computer Interchange
Color Spaces,"ACM Trans. on Graphics,vol.11,no.4,pp.373-405.
Katzir,N.,Lindenbaum,M.,and Porat,M.[1994].“Curve Segmentation Under Partial
Occlusion,"IEEE Trans. Pattern Anal.Machine Intell.,vol.16,no.5,pp.513-519.
Kerre,E.E.and Nachtegael, M.,eds.[2000]. Fuzzy Techniques in Image Processing,
Springer-Verlag,New York.
Khanna,T. [1990]. Foundations of Neural Networks,Addison-Wesley, Reading, Mass.
Kim,C.[2005].“Segmenting a Low-Depth-of-Filed Image Using Morphological Filters and Region Merging,"IEEE Trans.Image Proc.,vol.14,no.10,pp.1503-1511.
Kim,J.K.,Park,J.M.,Song, K.S.,and Park,H.W.[1997].“Adaptive Mammographic
Image Enhancement Using First Derivative and Local Statistics,"IEEETrans.Med ical Imaging,vol.16,no.5,pp.495-502.
Kimme,C.,Ballard,D.H.,and Sklansky,J.[1975]."Finding Circles by an Array of Accu- mulators,"Comm.ACM,vol.18,no.2,pp.120-122.
Kirsch,R.[1971].“Computer Determination of the Constituent Structure of Biological
附录B 参考 书 目
Images,"CompuL. Biomed. Res,vol.4,pp.315-328.
Kiver,M.S.[1965].Color Television Fundamentals,McGraw-Hill,New York.
Klette,R.and Rosenfeld,A.[2004].Digital Geometry-Geometric Methods for Digital
Picture Analysis,Morgan Kaufmann,San Francisco.
Klinger,A.[1976].“Experiments in Picture Representation Using Regular Decomposi- tion,"Comput. Graphics Image Proc,vol.5,pp.68-105.
Knowlton,K.[1980].“Progressive Transmission of Gray-Scale and Binary Pictures by Simple, Efficient,and Lossless Encoding Schemes,"Proc.IEEE,vol.68,no.7,
pp.885-896.
Kohler,R.J.and Howell,H.K.[1963].“Photographic Image Enhancement by Super position of Multiple Images," Photogr.Sci. Eng.,vol.7,no.4,pp.241-245.
Kokaram,A.[1998].Motion Picture Restoration,Springer-Verlag,New York.
Kokare,M.,Biswas,P,and Chatterji,B.[2005].“Texture Image Retrieval Using New
Rotated Complex Wavelet Filters,"IEEE Trans. Systems, Man, Cybernetics, Part B,
vol.35,no.6,pp.1168-1178.
Kramer,H.P.and Mathews,M.V.[1956].“A Linear Coding for Transmitting a Set of Correlated Signals,"IRE Trans.Info.Theory,vol.IT-2,pp.41-46.
Langdon,G.C.and Rissanen,JJ.[1981].“Compression of Black-White Images with
Arithmetic Coding,"IEEE Trans. Comm.,vol.COM-29,no.6,pp.858-867.
Lantuéjoul, C.[1980]."Skeletonization in Quantitative Metallography,"in Issues of
Digital Image Processing,Haralick,R.M.,and Simon,J.C.(eds.),Sijthoff and Noord hoff, Groningen,The Netherlands.
Latecki,L.J. and Lak?mper, R.[1999].“Convexity Rule for Shape Decomposition Based on Discrete Contour Evolution,"Computer Vision and Image Understanding,
vol.73,no.3,pp.441-454.
Le Gall,D.and Tabatabai,A.[1988].“Sub-Band Codingof Digital Images Using Sym- metric Short Kernel Filters and Arithmetic Coding Techniques,"IEEE International
Conference on Acoustics,Speech,and Signal Processing,New York,pp.761-765.
Ledley,R.S.[1964]."High-Speed Automatic Analysis of Biomedical Pictures,"Science,
vol.146,no.3461,pp.216-223.
Lee,J-S, Sun,Y.-N.,and Chen,C.-H.[1995].“Multiscale Corner Detection by Using Wavelet Transforms,"IEEE Trans.Image Processing,vol.4,no.1,pp.100-104.
Lee,S.U.,Chung,S.Y.,andPark,R.H.[1990].“A Comparative Performance Study of
Several Global Thresholding Techn:ques for Segmentation,"Comput.Vision,Graph ics,ImageProc.,vol.52,no.2,pp.171-190.
Lehmann,T.M.,G?nner,C.,and Spitzer,K.[1999].“Survey:Interpolation Methods
in Medical Image Processing,"IEEE Trans Medical Imaging,vol. 18, no. 11,
pp.1049-1076.
Lema,M.D.and Mitchell,O.R.[1984].“Absolute Moment Block Truncation Coding and Its Application to Color Images,"IEEE Trans. Comm.,vol.COM-32, no.10.
pp.1148-1157.
Levine,M.D.[1985].Vision in Man and Machine,McGraw-Hill,New York.
Liang,K.-C.and Kuo,C.-C.J.[1991].“Waveguide:A Joint Wavelet-Based Image Rep- resentation and Description System,"IEEE Trans. Image Processing, vol.8,no.11,
pp.1619-1629.
Liang, Q.,Wendelhag,J.W., and Gustavsson,T. [2000].“A Multiscale Dynamic Pro gramming Procedure for Boundary Detection in UltrasonicArtery Images,"IEEE
Trans.Medical Imaging,vol.19,no.2,pp.127-142.
Liao,P,Chen,T,and Chung,P.[2001]."A Fast Algorithm for Multilevel Thresholding,"
I.Inform.Sc.and Eng.,vol.17,pp.713-727.
Lillesand,T.M.and Kiefer,R.W.[1999].Remote Sensing and Image Interpretation,John
Wiley & Sons,New York.
Lim,JS.[1990].Two-Dimensional Signal and Image Processing,Prentice Hall,Upper
Saddle River,N.J.
Limb, J.O.and Rubinstein,C. B.[1978].“On the Design of Quantizers for DPCM Coders:A Functional Relationship Between Visibility, Probability, and Masking,"
607
608 数字图像处理(第三版)
IEEE Trans. Comm.,vol.COM-26,pp.573-578.
Lindblad,T.and Kinser,J.M.[1998].Image Processing Using Pulse-Coupled Neural
Networks,Springer-Verlag,New York.
Linde,Y.,Buzo,A.,and Gray,R.M.[1980].“An Algorithm for Vector Quantizer De- sign,"IEEE Trans. Comm.,vol.COM-28,no.1,pp.84-95.
Lippmann,R.P.[1987].“An Introduction to Computing with Neural Nets,”IEEEASSP
Magazine,vol.4,pp.4-22.
Liu, J. and Yang, Y.-H.[1994].“Multiresolution Color Image Segmentation,”IEEE
Trans PatternAnal.MachineIntell.,vol.16,no.7,pp.689-700.
Liu-Yu,S.and Antipolis,M.[1993]."Description of Object Shapes by Apparent Bound- ary and Convex Hull,"Pattern Recog.,vol.26,no.1,pp.95-107.
Lo,R.-C.and Tsai,W.-H.[1995].“Gray-Scale Hough Transform for Thick Line Detec tion in Gray-Scale Images,"Pattern Recog.,vol.28,no.5,pp.647-661.
Loncaric,S.[1998]."A Survey of Shape Analysis Techniques,"Pattern Recog.,vol.31,
no.8,pp.983-1010.
Lu,H.E.and Wang,P.SP.[1986].“A Comment on A Fast Parallel Algorithm for Thin ning Digital Patterns,'"Comm.ACM,vol.29,no.3,pp.239-242.
Lu,N.[1997].Fractal Imaging,Academic Press,New York.
Lu,W.-S.and Antoniou,A.[1992]."Two-Dimensional Digital Filters,"Marcel Dekker,
New York.
MacAdam,D.L.[1942].“Visual Sensitivities to Color Differences in Daylight,”I.Opt.
Soc.Am.,vol.32,pp.247-274.
MacAdam,D.P.[1970]."Digital Image Restoration by Constrained Deconvolution,"
J.Opt.Soc.Am.,vol.60,pp.1617-1627.
Maki,A.,Nordlund,P,and Eklundh,J.-O.[2000].“Attentional SceneSegmentation:In tegrating Depth and Motion,"Computer Visionand Image Understanding,vol.78,no.3,
pp.351-373.
Malacara,D.[2001].Color Vision and Colorimetry:Theory and Applications,SPIEPress,
Bellingham,Wash.
Mallat,S.[1987].“A Compact Multiresolution Representation:The Wavelet Model,” Proc.IEEE Computer Sociery Workshop on Computer Vision,IEEE Computer Society
Press,Washington,D.C.,pp.2-7.
Mallat,S. [1989a].“A Theory for Multiresolution Signal Decomposition: The Wavelet Representation,"IEEE Trans. Pattern Anal.Mach.Intell., vol.PAMI-11,
pp.674-693.
Mallat,S.[1989b].“Multiresolution Approximation and Wavelet Orthonormal Bases of
L2,”Trans.American Mathematical Society,vol.315,pp.69-87.
Mallat,S. [1989c]."Multifrequency Channel Decomposition of Images and Wavelet Models,"IEEE Trans.Acoustics,Speech,and Signal Processing,vol.37,pp.2091-2110.
Mallat,S.[1998].A Wavelet Tour of Signal Processing,Academic Press,Boston,
Mass.
Mallat,S.[1999].A Wavelet Tour of Signal Processing,2nd ed.,Academic Press,San
Diego,Calif.
Mallot,A.H.[2000].Computational Vision,The MIT Press,Cambridge,Mass.
Mamistvalov,A.[1998].“n-Dimensional Moment Invariants and Conceptual Mathe matical Theory of Recognition [of] n-Dimensional Solids,"IEEE Trans. Pattern Anal.
Machine Intell., vol.20,no.8,pp.819-831.
Manjunath,B.,Salembier,P,and Sikora,T.[2001].Introduction to MPEG-7,John Wiley
& Sons,West Sussex,UK
Maragos, P.[1987].“Tutorial on Advances in Morphological Image Processing and Analysis,"Optical Engineering.vol.26,no.7,pp.623-632.
Marchand-Maillet,S.and Sharaiha,Y.M.[2000j. Binary Digital Image Processing:A
Discrete Approach,Academic Press,New York
Maren,A.J,Harston,C.T,and Pap,R.M.[1990].Handbook ofNeural Computing Ap- plications,Academic Press,New York.
Marr,D.[1982].Vision,Freeman,San Francisco.
附录B 参考书目
Marr,D.and Hildreth, E.[1980]."Theory of Edge Detection,"Proc.R.Soc.Lond.,vol.
B207,pp.187-217.
Martelli,A.[1972]."Edge Detection Using Heuristic Search Methods,"Comput.
Graphics Image Proc,vol.1,pp.169-182.
Martelli,A.[1976].“An Application of Heuristic Search Methods to Edge and Contour Detection,"Comm.ACM,vol.19,no.2,pp.73-83.
Martin,M. B.and Bell,A.E.[2001]."New Image Compression Techniques Using Multiwavelets and Multiwavelet Packets,"IEEE Trans on Image Proc.,vol.10,no.
4,pp.500-510.
Mather,P.M.[1999].Computer Processingof Remotely Sensed Images:An Introduc tion,John Wiley & Sons,New York.
Max,J.[1960]."Quantizing for Minimum Distortion,"IRETrans.Info.Theory,vol.IT-6, pp.7-12.
McClelland,J.L.and Rumelhart,D.E.(eds.)[1986].Parallel Distributed Processing:
Explorations in the Microstructures of Cognition,vol.2:Psychologicaland Biological
Models,The MIT Press,Cambridge,Mass.
McCulloch,W.S.and Pitts,W.H.[1943].“A Logical Calculus of the Ideas Imminent in
Nervous Activity," Bulletin of Mathematical Biophysics,vol.5,pp.115-133.
McFarlane,M.D.[1972].“Digital Pictures Fifty Years Ago,”Proc.IEEE,vol.60,no.7, pp.768-770.
McGlamery,B.L.[1967].“Restoration of Turbulence-Degraded Images,”I.Opt. Soc.
Am.,vol.57,no.3,pp.293-297.
Meijering,H.W.,Zuiderveld,K.J.,and Viergever,M.A.[1999].“Image Registration for
Digital Subtraction Angiography,"Int.J. Comput.Vision,vol.31,pp.227-246.
Meijering,E.H.W.,Niessen,W.J.,and Viergever,M.A.[1999].“Retrospective Motion Correction in Digital Subtraction Angiography:A Review,"IEEE Trans. Medical
Imaging,vol.18,no.1,pp.2-21.
Meijering,E.H.W.,et al.[2001].“Reduction of Patient MotionArtifacts in Digital Sub- traction Angiography:Evaluation ofa Fast and FullyAutomatic Technique,"Radiology,
vol.219,pp.288-293.
Memon,N.,Neuhoff,D.L,and Shende,S.[2000].“An Analysis of Some CommonScan- ningTechniques for Lossless Image Coding,"IEEE Trans.Image Processing,vol.9,
no.11,pp.1837-1848.
Mesarovic,V.Z.[2000].“Iterative Linear Minimum Mean-Square-Error Image
Restoration from Partially Known Blur,"J.Opt. Soc.Amer-A.Optics,Image Science,
and Vision,vol.17,no.4,pp.711-723.
Meyer,Y.[1987]."L'analyses par Ondelettes,"Pour la Science.
Meyer,Y.[1990].Ondelettes et ope'rateurs, Hermann,Paris
Meyer,Y.(ed.) [1992a]. Wavelets and Applications: Proceedings of the International
Conference,Marseille,France,Mason,Paris,and Springer-Verlag,Berlin
Meyer,Y.(translated by D.H.Salinger) [1992b].Wavelets and Operators,Cambridge
University Press,Cambridge,UK.
Meyer,Y.(translated by R.D.Ryan) [1993].Wavelets:Algorithms and Applications,Soci ety for Industrial and Applied Mathematics, Philadelphia.
Meyer, F.G,Averbuch,A.Z., and Str?mberg,J.-O.[2000].“Fast Adaptive Wavelet Packet Image Compression,"IEEETrans.Image Processing,vol.9,no.7,pp.792-800. Meyer,F.and Beucher,S.[1990]."Morphological Segmentation,"I.Visual Comm,and
Image Representation,vol.1,no.1,pp.21-46.
Meyer,H.,Rosdolsky,H. G.,and Huang,T.S.[1973].“Optimum Run Length Codes,” IEEE Trans. Comm.,vol.COM-22,no.6,pp.826-835.
Minsky,M.and Papert,S.[1969]. Perceptrons:An Introduction to Computational Geom etry,MIT Press,Cambridge,Mass.
Mirmehdi,M.and Petrou,M.[2000].“Segmentation of Color Textures,”IEEE Trans
Pattern Anal.Machine Intell.,vol.22,no.2,pp.142-159.
Misiti,M.Misiti,Y.,Oppenheim,G,and Poggi,J-M.[1996].Wavelet Toolbox User's
Guide,The MathWorks,Inc.,Natick,Mass.
609
610 数字图像处理(第三版)
Mitchell,D.P.and Netravali,A.N.[1988]."Reconstruction Filters inComputer Graphics,"
Comp.Graphics,vol.22,no.4,pp.221-228.
Mitchell,J.,Pennebaker,W.,Fogg,C.,and LeGall,D.[1997].MPEG Video Compression Standard,Chapman & Hall,New York.
Mitiche,A.[1994].Computational Analysis of Visual Motion,Perseus Publishing.New
York.
Mitra,S.,Murthy,C.,and Kundu,M.[1998].“Technique for Fractal Image Compression
Using Genetic Algorithm,"IEEE Transactions on Image Processing,vol.7,no.4,
pp.586-593.
Mitra,S.K.and Sicuranza,G.L.(eds.)[2000].Nonlinear Image Processing,Academic
Press,New York.
Mohanty,S.,et al.[1999].“A Dual Watermarking Technique for Images,”Proc.7th ACM International Multimedia Conference,ACM-MM'99,Part 2,pp.49-51.
Moore,G.A.[1968].“Automatic Scanning and Computer Proceses for the Quantita tiveAnalysis of Micrographs and Equivalent Subjects,"in Pictorial Pattern Recogni tion,(G.C.Cheng et al.,eds),pp.275-326,Thomson,Washington,D.C.
Mukherjee,D.and Mitra,S.[2003].“Vector SPIHT for Embedded Wavelet Video and Image Coding,"IEEETrans.Circuits and Systems for Video Technology,vol.13,no.3,
pp.231-246.
Murase,H.and Nayar, S.K.[1994]."IHlumination Planning for Object Recognition Using Parametric Eigen Spaces,"IEEE Trans. Pattern Anal. Machine Intell,vol.16,
no.12,pp.1219-1227.
Murino,V.,Ottonello,C.,and Pagnan,S.[1998].“Noisy TextureClassfication:A Higher- Order Statistical Approach,"Pattern Recog.,vol.31,no.4,pp.383-393.
Nagao,M.and Matsuyama,T.{1980].A Structural Analysis of Complex Aerial Pho tographs,Plenum Press,New York.
Najman,L.and Schmitt,M.[1996].“Geodesic Saliency of Watershed Contours and Hi- erarchical Segmentation," IEEE Trans. Pattern Anal.Machine Intell., vol.18,no.12,
pp.1163-1173.
Narendra,P.M.and Fitch,R.C.[1981]."Real-Time Adaptive Contrast Enhancement,"
IEEETrans. Pattern Anal.Mach.IntellL,vol.PAMI-3,no.6,pp.655-661.
Netravali,A.N.[1977].“On Quantizers for DPCM Coding of Picture Signals,”IEEE
Trans.Info. Theory,vol.IT-23,no.3,pp.360-370.
Netravali,A.N.and Limb,JO.[1980]."Picture Coding:A Review,"Proc.IEEE,vol.68,
no.3,pp.366-406.
Nevatia,R.[1982].Machine Perception,Prentice Hall,Upper Saddle River,N.J.
Ngan,K.N.,Meier,T., and Chai,D.[1999].Advanced Video Coding: Principles and
Techniques, Elsevier,Boston.
Nie,Y.and Barner,K.E.[2006].“The Fuzzy Transformation and Its Applications in
Image Processing,"IEEE Trans. Image Proc.,vol.15,no.4,pp.910-927.
Nilsson,N.J.[1965].Learning Machines: Foundations of Trainable Pattern-Classifying
Systems,McGraw-Hill,New York.
Nilsson,N.J.[1971]. Problem Solving Methods in Arificial Intelligence,McGraw-Hill,
New York.
Nilsson,N.J.[1980].Principles of Arificial Intelligence,Tioga,Palo Alto,Calif.
Nixon,M.and Aguado,A.[2002]. Feature Extraction and Image Processing,Newnes,
Boston,MA.
Noble,B.and Daniel,J.W.[1988].Applied Linear Algebra,3rd ed.Prentice Hall,Upper
Saddle River,NJ.
O'Connor,Y.Z.and Fessler,J.A.[2006].“Fourier-Based Forward and Back-Projections in Iterative Fan-Beam Tomographic Image Reconstruction,"IEEE Trans. Med.
Imag.,vol.25,no.5,pp.582-589.
Odegard,J. E.,Gopinath,R.A.,and Burrus,C.S.[1992].“Optimal Wavelets for Signal
Decomposition and the Existence of Scale-Limited Signals,"Proceedings of IEEE
Int.Conf. OnSignal Proc.,ICASSP-92,San Francisco,CA,vol.IV,597-600.
Olkkonen, J. and Olkkonen,H. [2007]. Discrete Lattice Wavelet Transform,IEEE
附录B 参考 书 目
Trans.Circuits andSystems II:Express Briefs,vol.54,no.1,pp.71-75.
Olson,C.E.[1999].“Constrained Hough Transforms for Curve Detection,”Computer Vision and Image Understanding,vol.73,no.3,pp.329-345.
O'Neil,J.B.[1971].“Entropy Coding in Speech and Television Differential PCM Sys tems,"IEEE Trans. Info.Theory,vol.IT-17,pp.758-761.
Oommen,R.J.and Loke,R.K.S.[1997].“Pattern Recognition of Strings with Substitu- tions,Insertions,Deletions,and Generalized Transpositions,"Pattern Recog.,vol.30,
no.5,pp.789-800.
Oppenheim,A.V.and Schafer,R.W.[1975].DigitalSignal Processing, Prentice Hall,
Englewood Cliffs,NJ.
Oppenheim,A.V.,Schafer,R.W.,and Stockham,T.G,Jr.[1968]."Nonlinear Filtering
of Multiplied and Convolved Signals,"Proc.IEEE,vol.56,no.8,pp.1264-1291.
Oster,G.and Nishijima,Y.[1963]."Moiré Patterns,"Scientific American,vol.208,no.5,
pp.54-63.
Otsu,N.[1979].“A Threshold Selection Method from Gray-Level Histograms,”IEEE
Trans.Systems,Man,and Cybernetics,vol.9,no.1,pp.62-66.
Oyster,C.W.[1999].The Human Eye:Structure and Function,Sinauer Associates,Sun derland,Mass.
Paez,M.D.and Glisson,T.H.[1972].“Minimum Mean-Square-Error Quantization in
Speech PCM and DPCM Systems,"IEEE Trans. Comm.,vol.COM-20,pp.225-230.
Pao,Y.H.[1989].Adaptive Pattern Recognition and Neural Networks,Addison-Wesley,
Reading,Mass.
Papamarkos,N.and Atsalakis,A.[2000].“Gray-Level Reduction Using Local Spatial Features,"Computer Vision and Image Understanding,vol.78,no.3,pp.336-350.
Papoulis,A.[1991].Probability,Random Variables, and Stochastic Processes,3rd ed.,
McGraw-Hill,New York.
Parhi,K.and Nishitani,T.[1999]."Digital Signal Processing in Multimedia Systems,"
Chapter 18:A Review of Watermarking Principles and Practices,M. Miller,et al.,
pp.461-485,Marcel Dekker Inc.,New York.
Park, H.and Chin,R.T.[1995].“Decomposition ofArbitrarily-Shaped Morphological Structuring,"IEEETrans. Pattern Anal.Machine Intell,vol.17,no.1,pp.2-15.
Parker,J.R.[1991].“Gray Level Thresholding in Badly Iluminated Images,”IEEE
Trans. Pattern Anal.Machine Intell,vol.13,no.8,pp.813-819.
Parker,J.R.[1997].Algorithms for Image Processing and Computer Vision,John Wiley
&Sons,New York.
Patrascu,V.[2004].“Fuzzy Enhancement Method Using Logarithmic Model,”IEEE- Fuzz'04,vol.3,pp.1431-1436.
Pattern Recognition [2000].Special issue on mathematical morphology and nonlinear
image processing,vol.33,no.6,pp.875-1117.
Pavlidis,T.[1977].Structural Pattern Recognition,Springer-Verlag,New York.
Pavlidis,T.[1982].Algorithms for Graphics and Image Processing,Computer Science
Press,Rockville,Md.
Pavlidis,T.and Liow,Y.T.[1990]."Integrating Region Growing and Edge Detection,"
IEEE Trans. Pattern Anal. Mach.Intell,vol.12,no.3,pp.225-233.
Peebles,P.Z.[1993].Probability, Random Variables,and Random Signal Principles,3rd
ed.,McGraw-Hill,New York.
Pennebaker,W.B.and Mitchell,J.L.[1992].JPEG:Still Image Data Compression Stan- dard,Van Nostrand Reinhold,New York.
Pennebaker,W. B.,Mitchell, J.L.,Langdon, G.G.,Jr.,and Arps,R.B.[1988].“An
Overview of the Basic Principles of the Q-coder Adaptive Binary Arithmetic Coder,"IBMJ.Res.Dev,vol.32,no.6,pp.717-726.
Perez,A.and Gonzalez,R.C.[1987]."An lterative ThresholdingAlgorithm forImage Seg- mentation,"IEEE Trans Pattern Anal.Machine Intell,vol.PAMI-9,no.6,pp.742-751.
Perona,P.and Malik,J.[1990].“Scale-Space and Edge Detection Using Anisotropic Diffusion,"IEEETrans. Pattern Anal.Machine Intell,vol.12,no.7,pp.629-639.
Persoon, E.and Fu,K.S.[1977]."Shape Discrimination Using Fourier Descriptors,"
611
612 数字图像处理(第三版)
IEEE Trans.Systems Man Cyb,,vol.SMC-7,no.2,pp.170-179.
Petrou,M.and Bosdogianni,P.[1999].Image Processing:The Fundamentals,John Wiley
& Sons,UK.
Petrou,M.and Kittler,J. [1991].“Optimal Edge Detector for Ramp Edges,”IEEE
Trans. Pattern Anal.Machine IntellL,vol.13,no.5,pp.483-491.
Piech,M.A.[1990]."Decomposing the Laplacian,"IEEE Trans. Pattern Anal.Machine
Intell,vol.12,no.8,pp.830-831.
Pitas,L and Vanetsanopoulos,A.N.[1990].Nonlinear Digital Filters:Principles and Appli- cations,Kluwer Academic Publishers,Boston,Mass.
Plataniotis,K.N.and Venetsanopoulos,A.N.[2000].Color Image Processing and Appli cations,Springer-Verlag,New York.
Pokorny,C.K.and Gerald,C.F.[1989].Computer Graphics:The Principles Behind the
Art and Science,Franklin,Beedle &Associates,Irvine,Calif.
Porco,C.C.,West R.A.,et al.[2004].“Cassini Imaging Science:Instrument Characteris- tics and AnticipatedScientific Investigations at Saturn,"Space Science Reviews,vol.115,
pp.363-497.
Poynton,C.A.[1996].A Technical Introduction to Digital Video,John Wiley & Sons,
New York.
Prasad,L.and Iyengar,S.S.[1997].Wavelet Analysis with Applications to Image Pro cessing,CRC Press,Boca Raton,Fla.
Pratt,W.K.[2001].Digital Image Processing,3rd ed.,John Wiley & Sons,New York.
Preparata, F.P. and Shamos,M.I.[1985].Computational Geometry:An Introduction,
Springer-Verlag,New York.
Preston,K.[1983].“Cellular Logic Computers for Pattern Recognition,”Computer,vol.
16,no.1,pp.36-47.
Prewitt,J.M.S.[1970]."Object Enhancement and Extraction,"in Picture Processingand
Psychopictorics,Lipkin,B.S.,and Rosenfeld,A.(eds.),Academic Press,New York.
Prince,J.L.and Links,J.M.[2006].Medical Imaging Signals and Systems,Prentice Hall,
Upper Saddle River,NJ.
Principe,J.C.,Euliano,N.R.,and Lefebre,W.C.[1999].Neural and Adaptive Systems:
Fundamentals through Simulations,JohnWiley & Sons,New York.
Pritchard,D.H.[1977]."U.S.Color Television Fundamentals-A Review,"IEEE Trans.
Consumer Electronics,vol.CE-23,no.4,pp.467-478.
Proc.IEEE[1967].Special issue on redundancy reduction,vol.55,no.3.
Proc.IEEE[1972].Special issue on digital picture processing,vol.60,no.7.
Proc.IEEE[1980].Special issue on the encoding of graphics,vol.68,no.7.
Proc.IEEE[1985].Special issue on visual communicationsystems,vol.73,no.2.
Qian,R.J.and Huang,T.S.[1996].“Optimal Edge Detection in Two-Dimensional Images,”
IEEE Trans.Image Processing,vol.5,no.7,pp.1215-1220.
Rabbani,M.and Jones,P.W.[1991].Digital Image Compression Techniques,SPIE Press
Bellingham,Wash.
Rajala,S.A.,Riddle,A.N.,and Snyder,W.E.[1983].“Applicationof One-Dimensional
Fourier Transform for Tracking Moving Objects in Noisy Environments,"Comp,Vi sion,Image Proc.,vol.21,pp.280-293.
Ramachandran,G.N.and Lakshminarayanan,A.V.[1971].“Three Dimensional Recon structionsfrom Radiographs and Electron Micrographs:Application of Convolution Instead of Fourier Transforms,"Proc.Nat.Acad.Sci.,vol.68,pp.2236-2240.
Rane,S.and Sapiro,G.[2001].“Evaluationof JPEG-LS,the New Lossless and Controlled Lossy Still Image Compression Standard,for Compression of High-Resolution Eleva- tion Data,"IEEE Trans Geoscience and Remote Sensing,vol.39,no.10,pp.2298-2306.
Rangayyan,R.M.[2005].Biomedical Image Analysis,CRC Press,Boca Raton,FL.
Reddy,B.S.and Chatterji,B.N.[1996].“An FFT-Based Technique for Translation,Rota- tion,and Scale Invariant Image Registration,"IEEE Trans. Image Processing,vol.5,
no.8,pp.1266-1271.
Regan,D.D.[2000].Human Perception of Objects: Early Visual Processing of Spatial Form Defined by Luminance,Color,Texture, Motion,and Binocular Disparity,Sin-
附录B 参考书 目
auer Associates,Sunderland.Mass.
Rice.R.E[1979]."Some Practical Universal Noiseless Coding Techniques,"Tech.Rep.
JPL-79-22,Jet Propulsion Lab.,Pasadena,CA.
Ritter,G.X.and Wilson,J.N.[2001]. Handbook of Computer Vision Algorithms in
Image A/gebra,CRC Press,Boca Raton,Fla.
Roberts,L.G.[1965]."Machine Perception of Three-Dimensional Solids,"in Optical
and Electro-Optical Information Processing.Tippet, IT.(ed.),MIT Press, Cam bridge,Mass.
Robertson,A.R.[1977]."The CIE 1976 Color Difference Formulac,"ColorRes.Appl,
vol.2.pp.7-11.
Robinson,G.S. [1976]."Detection and Coding of Edges Using Directional Masks,"
University of Southern California,Image Processing Institute,Report no.660.
Robinson,J.A.[1965]."A Machine-Oricnted Logic Based on the Resolution Principle,"
1.ACM,vol.12,no.1,pp.23-41.
Robinson,J.[2006]."Adaptive Prediction Trees for Image Compression,"IEEE Trans
Image Proc,vol.15,no.8,pp.2131-2145.
Rock,L.[1984].Perception,W.H.Freeman,New York.
Roese,J.A.,Pratt,W. K,and Robinson,G.S.[1977].“Interframe Cosine Transform
Image Coding."IEEETrans.Comm.,vol.COM-25,pp.1329-1339.
Rosenblatt,F.[1959]."Two Theorems of Statistical Separability in the Perceptron,"In
Mechanisation of Thought Processes: Proc. of Symposium Na.10,held at the Na tional Physical Laboratory,November 1958,H.M.Stationery Office,London,vol.1,
pp.421-456.
Rosenblatt,F. [1962].Principles of Neurodynamics: Perceptrons and the Theory of
Brain Mechanisms,Spartan,Washington,D.C.
Rosenfeld,A.(ed.) [1984].Multiresolution Image Processing and Analysis.Springer- Verlag,New York.
Rosenfeld,A.[1999]."Image Analysis and Computer Vision:1998,"Computer Vision
and Image Understanding.vol.74,no.1,pp.36-95.
Rosenfeld,A.[2000]."Image Analysis and Computer Vision:1999,"Computer Vision
and Image Understanding,vol.78,no.2.pp.222-302.
Rosenfeld,A.and Kak,A.C.[1982].Digital Picure Processing,vols.1 and 2,2nd ed.,
Academic Press,New York.
Rosin,PL [1997]."Techniques for Assessing Polygonal Approximations of Curves,"
IEEE Trans. Pattern Anal Machine Intell,vol.19,no.6,pp.659-666.
Rudnick,P.[1966]."Note on the Calculation of Fourier Series,"Math. Comput,vol.20,
pp.429-430.
Rumelhart,D.E.,Hinton,G.E.,and Williams,R.I[1986]."Learning Internal Repre- sentations by ErrorPropagation,"In Parallel DistributedProcessing: Explorationsin
the Microstructures of Cognition,Vol I:Foundations,Rumelhart,D.E.,ct al.(eds.),
MIT Press,Cambridge,Mass.pp.318-362.
Rumelhart,D.E.and McClelland,J.L.(eds.)[1986].Parallel Distributed Processing: Explorations in the Microstructures of Cognition,Vol. I:Foundations,MIT Press,
Cambridge,Mass.
Runge,C.[1903].Zeit.fur Math,and Physik,vol.48,p.433.
Runge,C.[1905].Zeit.fir Math, and Physik,vol.53,p.117.
Runge,C.and Konig.H.[1924]."Die Grundlehren der Mathematischen Wissenschaften,"
Vorlesungen iiber Numerisches Rechnen,vol.11,JuliusSpringer,Berlin
Russ,J.C.[1999].The Image Processing Handbook,3rd ed.,CRCPress,Boca Raton,Fla.
Russo F.and Ramponi,G.[1994]."Edge Extraction by FIREOperators,"Fuzz-IEEE 94,
vol.1,pp.249-243.IEEE Press,New York.
Sahni,S. and Jenq,J-E. [1992]."Serial and Parallel Algorithms for the Medial Axis Transform,"IEEE Trans. Patten Anal.Machine Intell,vol.14,no.12,pp.1218-1224.
Sahoo,S.S.PK.Wong.A.K.C.,and Chen,Y.C.[1988]."Survey of Thresholding Tech- niques,"Computer Vision,Graphics and Image Processing.vol.41,pp.233-260.
Saito.N.and Cunningham,M.A.[1990].“Generalized E-Filter and its Application to
613
614 数字图像处理(第三版)
Edge Detection,"IEEETrans Pattern Anal.Machine Intell.,vol.12,no.8,pp.814-817.
Sakrison,D.J.and Algazi,V.R.[1971].“Comparison of Line-by-Line and Two-Dimensional
Encodingof Random Images,"IEEE Trans Infa.Theory,vol.IT-17,no.4,pp.386-398.
Salari,E.and Siy,P.[1984].“The Ridge-Seeking Method for Obtaining the Skeleton of Digital Images,"IEEE Trans.Syst.Man Cyb.,vol.SMC-14,no.3,pp.524-528.
Salinas,R.A.,Abidi,M.A.,and Gonzalez,R.C.[1996].“Data Fusion:Color Edge Detec tion and Surface Reconstruction Through Regularization,"IEEE Trans. Industrial
Electronics,vol.43,no.3,pp.355-363,1996.
Sato,Y.[1992].“Piecewise Linear Approximation of Plane Curves by Perimeter Opti- mization," Pattern Recog.,vol.25,no.12,pp.1535-1543.
Sauvola,J. and Pietikainen,M.[2000].“Adaptive Document Image Binarization”
Pattern Recog.,vol.33,no.2,pp.225-236.
Schalkoff, R.J.[1989].Digital Image Processing and Computer Vision,John Wiley &
Sons,New York
Schonfeld,D.and Goutsias,J.[1991].“Optimal Morphological Pattern Restoration from Noisy Binary Images,"IEEETrans.PatternAnal.Machine Intell,vol.13,no.1,pp.14-29.
Schowengerdt,R.A.[1983].Techniques for Image Processing and Classification in Re mote Sensing,AcademicPress,New York.
Schreiber,W.E.[1956].“The Measurement of Third Order Probability Distributions of
Television Signals,"IRE Trans.Info.Theory,vol.IT-2,pp.94-105.
Schreiber,W.F.[1967]."Picture Coding,"Proc.IEEE(Special issue on redundancy re duction),vol.55,pp.320-330.
Schreiber,W.F.and Knapp,C.E.[1958].“TV Bandwidth Reduction by Digital Coding,”
Proc.IRE National Convention,pt.4,pp.88-99.
Schwartz,J.W.and Barker, R.C.[1966].“Bit-Plane Encoding:A Technique for Source Encoding,"IEEE Trans.Aerosp. Elec.Systems,vol.AES-2,no.4,pp.385-392.
Selesnick,L.,Baraniuk,R.,and Kingsbury,N.[2005].“The Dual-TreeComplex Wavelet
Transform,"IEEE Signal Processing Magazine,vol.22,no.6,pp.123-151.
Serra,J.[1982].Image Analysis and MathematicalMorphology,Academic Press,New York.
Serra,J.(ed.)[1988].Image Analysis and Mathematical Morphology,vol.2,Academic
Press,New York.
Sezan,M.L,Rabbani,M.,and Jones,P.W.[1989].“Progressive Transmission of Images
Using a Prediction/Residual EncodingApproach,"Opt. Eng.,vol.28,no.5,pp.556-564.
Shack,R.V.[1964].“The Influence of Image Motion and Shutter Operation on the Photographic Transfer Function,"Appl. Opt.,vol.3,pp.1171-1181.
Shafarenko,L.,Petrou,M.,and Kittler,J.[1998].“Histogram-Based Segmentation in
a Perceptually Uniform Color Space,"IEEE Trans.Image Processing,vol.7,no.9,
pp.1354-1358.
Shaked,D.and Bruckstein,A.M.[1998].“Pruning Medial Axes,”Computer Vision and
Image Understanding,vol.69,no.2,pp.156-169.
Shannon,C.E.[1948]."A Mathematical Theory of Communication,"The BellSys Tech.J,
vol.XXVII,no.3,pp.379-423.
Shapiro,L.G.and Stockman,G.C.[2001].Computer Vision,Prentice Hall,Upper Sad dle River,N.J.
Shapiro, V.A.[1996].“On the Hough Transform of Multi-Level Pictures,”Pattern Recog.,vol.29,no.4,pp.589-602.
Shariat,H.and Price,K.E.[1990]."Motion Estimation with More Than Two Frames," IEEE Trans. Pattern Anal.Machine IntellL,vol.12,no.5,pp.417-434.
Shepp,L.A.and Logan,B.F.[1974].“The Fourier Reconstruction of a Head Section”
IEEE Trans. Nucl.Sci,vol.NS-21,pp.21-43.
Sheppard,J.J,Jr.,Stratton,R.H.,and Gazley,C,Jr.[1969]."Pseudocolor as a Means
of Image Enhancement,"Am.J.Optom.Arch.Am.Acad.Optom,vol.46,pp.
735-754.
Shi,E.Y.and Wong,W.-T.[1994]."Fully Parallel Thinning with Toleranceto Boundary Noise,"Pattern Recog..vol.27,no.12,pp.1677-1695.
Shih,F.Y.C.and Mitchell,O.R.[1989]."Threshold Decomposition of Gray-Scale Mor-
附录B 参考书目
phology into Binary Morphology,"IEEE Trans Pattern Anal.Machine Intell,vol.11,
no.1,pp.31-42.
Shirley,P.[2002].Fundamentals of Computer Graphics,A.K.Peters,Natick,MA.
Sid-Ahmed,M.A.[1995]. Image Processing:Theory,Algorithms, and Architectures,
McGraw-Hill,New York.
Sikora,T.[1997]."MPEG Digital Video-Coding Standards,"IEEE Signal Processing,
vol.14,no.5,pp.82-99.
Simon,J.C.[1986].Patterns and Operators:The Foundations of Data Representations,
McGraw-Hill,New York.
Sklansky,J.,Chazin, R.L.,and Hansen, B.J.[1972].“Minimum-Perimeter Polygons of
Digitized Silhouettes,"IEEETrans. Comput.,vol.C-21,no.3,pp.260-268.
Sloboda,F,Zatko,B.,and Stoer,J.[1998]."OnApproximation of Planar One-Dimensional
Continua,"in Advances in Digital andComputational Geometry,R.Klette,A. Rosen feld,and F.Sloboda(eds.),Springer, Singapore,pp.113-160.
Smirnov,A.[1999].Processing of Multidimensional Signals,Springer-Verlag,New York.
Smith,A.R.[1978].“Color Gamut Transform Pairs," Proc.SIGGRAPH'78,published
as Computer Graphics,vol.12,no.3,pp.12-19.
Smith,J.O.,II [2003].Mathematics ofthe Discrete Fourier Transform,W3K Publishing,
CCRMA, Stanford,CA.(Also available online at http://ccrma.stanford.edu/~jos/
mdft).
Smith,M.J.T.and Barnwell,T.PIII [1984].“A Procedure for Building Exact Recon struction Filter Banks for Subband Coders,"Proc.IEEE Int.Conf. Acoust,Speech,
andSignal Proc.,San Diego,Calif.
Smith,M.J.T.and Barnwell,T.P.II[1986].“Exact ReconstructionTechniques for Tree- Structured Subband Coders,"IEEETrans OnAcoust,Speech,and Signa!Proc.,vol.34,
no.3,pp.434-441.
Snyder,W. E.and Qi,Hairong [2004]. Machine Vision,Cambridge University Press,
New York.
Sobel,I.E.[1970]."Camera Models and Machine Perception,"Ph.D.dissertation,Stan ford University,Palo Alto,Calif.
Sonka,M., Hlavac,V.,and Boyle,R.[1999].Image Processing, Analysis, and Machine Vision,2nd ed.,PWS Publishing,New York.
Snyder,W. E.and Qi,Hairong [2004].Machine Vision,Cambridge University Press,
New York.
Soille,P.[2003].Morphological Image Analysis: Principles and Applications,2nd ed.,
Springer-Verlag,New York.
Solari,S.[1997].Digital Videoand Audio Compression,McGraw-Hill,NewYork.
Stark,H.(ed.) [1987].Image Recovery:Theory and Application,Academic Press,New York.
Stark,J.A.[2000].“Adaptive Image Contrast Enhancement Using Generalizations of
Histogram Equalization,"IEEE Trans. Image Processing, vol.9,no.5,pp.889-896.
Stockham,T.G.,Jr.[1972].“Image Processing in the Context of a Visual Model,”Proc.
IEEE,vol.60,no.7,pp.828-842.
Storer,J.A.and Reif,J.H.,eds.[1991].Proceedings of DDC·91,IEEE Computer Soci ety Press,Los Alamitos,Calif.
Strang, G.and Nguyen,T [1996].Wavelets and Filter Banks,Wellesley-Cambridge
Press,Wellesley,Mass.
Stumpff, K.[1939].Tafeln und Aufgaben zur Harmonischen Analyse und Peri odogrammrechnung,Julius Springer,Berlin.
Sussner,P.and Ritter,G.X.[1997]."Decomposition of Gray-Scale MorphologicalTem plates Using the Rank Method,"IEEE Trans. Pattern Anal. Machine Intell.,vol.19,
no.6,pp.649-658.
Swets,D.L.and Weng.J.[1996].“Using Discriminant Eigenfeatures for Image Re- trieval,"IEEE Trans.Pattern Anal.Machine Intell,vol.18,no.8,pp.1831-1836.
Symes,P.D.[2001].Video Compression Demystified,McGraw-Hill, New York.
Sze,T.W.and Yang,Y.H.[1981]."A Simple Contour Matching Algorithm,"IEEE Trans.
615
616 数字图像处理(第三版)
Pattern Anal.Mach.Intell,vol.PAMI-3,no.6,pp.676-678.
Tanaka,E.[1995]."Theoretical Aspects of Syntactic Pattern Recognition,"Pattern
Recog.,vol.28,no.7pp.1053-1061.
Tanimoto,S.L.[1979]."Image Transmission with Gross Information First,"Comput.
Graphics Image Proc,vol.9,pp.72-76.
Tasto,M.and Wintz,P.A.[1971]."Image Coding by Adaptive Block Quantization,"
IEEE Trans. Comm.Tech.,vol.COM-19,pp.957-972.
Tasto,M.and Wintz,P.A.[1972].“A Bound on the Rate-Distortion Function and Ap- plication to Images,"IEEE Trans.Info. Theory,vol.IT-18,pp.150-159.
Teh,C.H.and Chin,R.T.[1989].“On the Detection of Dominant Points on Digital Curves,"IEEE Trans. PatternAnal.Machine Intell,vol.11,no.8,pp.859-872.
Theoridis,S.and Konstantinos,K.[2006].Pattern Recognition,3rd ed.,Academic Press
NewYork
Thévenaz,P.and Unser,M[2000].“Optimization of Mutual Information for Multiresolu- tion Image Registration,"IEEE Trans. Image Processing,vol.9,no.12,pp.2083-2099.
Thomas,L.H.[1963].“Using a Computer to Solve Problems in Physics,”Application of
DigitalComputers,Ginn,Boston.
Thomason,M. G.and Gonzalez, R.C.[1975].“Syntactic Recognition of Imperfectly Specified Patterns,"IEEE Trans. Comput.,vol.C-24,no.1,pp.93-96.
Thompson,W.B.(ed.) [1989].Special issue on visual motion,IEEE Trans. Pattern Anal.
Machine Intell,vol.11,no.5,pp.449-541.
Thompson,W.B.and Barnard,S.T.[1981].“Lower-Level Estimation and Interpretation
of Visual Motion,"Computer,vol.14,no.8,pp.20-28.
Thorell,L.G.and Smith,W.J.[1990].Using Computer Color Effectively,Prentice Hall,
Upper Saddle River,N.J.
Tian,J. and Wells, R.O.,Jr.[1995].Vanishing Moments and Wavelet Approximation,
Technical Report CMLTR-950i,Computational Mathematics Lab.,Rice University,
Houston,Texas.
Tizhoosh, H.R.[2000]."Fuzzy Image Enhancement:An Overview,"in Fuzzy Tech niques in Image Processing,E. Kerre and M. Nachtegael, eds.,Springer-Verlag,
New York.
Tomita,F,Shirai,Y.,and Tsuji,S.[1982].“Description of Texture by a Structural Analy- sis,"IEEE Trans. Pattern Anal.Mach.Intell,vol.PAMI-4,no.2,pp.183-191.
Topiwala,PN.(ed.)[1998].Wavelet Image and Video Compression, Kluwer Academic
Publishers,Boston,Mass.
Toro,J.and Funt,B.[2007].“A Multilinear Constraint on Dichromatic Planes for Illu- mination Estimation,"IEEE Trans.Image Proc,vol.16,no.1,pp.92-97.
Tou,J.T. and Gonzalez,R.C.[1974].Patten Recognition Principles,Addison-Wesley,
Reading,Mass
Tourlakis,G.J.[2003].Lectures in Logic and Set Theory,Cambridge University Press,
Cambridge,UK.
Toussaint,G.T.[1982].“Computational Geometric Problems in Pattern Recognition,”
In Pattern Recognition Theory and Applications,Kittler,J.,Fu,K.S,and Pau,L.F.
(eds.), Reidel,NewYork,pp.73-91.
Tsai,J.-C., Hsieh,C.-H,and Hsu,T-C. [2000].“A New Dynamic Finite-State Vector
Quantization Algorithm for Image Compression,"IEEE Trans.Image Processing,
vol.9,no.11,pp.1825-1836.
Tsujii, O.,Freedman, M.T,and Mun,K.S.[1998].“Anatomic Region-Based Dynamic
Range Compression for Chest Radiographs Using WarpingTransformation of Cor- related Distribution,"IEEETrans.Medical Imaging,vol.17,no.3,pp.407-418.
Udpikar,V.R.and Raina,J.P.[1987]."BTCImage Coding Using Vector Quantization," IEEE Trans. Comm.,vol.COM-35,no.3,pp.352-356.
Ueda,N. [2000].“Optimal Linear Combination of Neural Networks for Improving Classification Performance,"IEEE Trans. Pattern Anal.Machine Intell,vol.22,no.2,
pp.207-215.
Ullman,S.[1981].“Analysis of Visual Motion by Biological and Computer Systems,”
附录B 参考书目
IEEE Computer.vol.14,no.8,pp.57-69.
Umbaugh,S.E.[2005].Computer Imaging:Digital Image Analysis and Processing,CRC
Press,Boca Raton,FL.
Umeyama.S.[1988].“An Eigendecomposition Approach to Weighted Graph Matching Problems,"IEEE Trans PatternAnal.Machine Intell,vol.10,no.5.pp.695-703.
Unser,M.[1995]."Texture Classification and Segmentation Using Wavelet Frames,"
IEEE Trans on Image Processing.vol.4,no.11.pp.1549-1560.
Unser,M.,Aldroubi,A,and Eden,M.[1993]."A Family of Polynomial Spline Wavelet
Transforms,"Signal Proc.,vol.30,no.2,pp.141-162.
Unser,M.,Aldroubi,A,and Eden,M.[1993].“B-Spline Signal Processing.Parts I and II,"IEEE TransSignal Proc.,vol.41,no.2,pp.821-848.
Unser,M.,Aldroubi,A.,and Eden,M.[1995].“Enlargement or Reduction of Digital
Images with Minimum Lossof Information,"IEEE Trans Image Processing.vol.4.
no.5.pp.247-257.
Vaidyanathan.PPand Hoang.P-O.[1988]."Lattice Structures for Optimal Design and Robust Implementaion of Two-Channel Perfect Reconstruction Filter Banks,"IEEE
Trans Acoust,Speech,and Signal Proc.,vol.36,no.1,pp.81-94.
Vailaya,A,Jain,A.andZhang,H.J[1998].“On Image Classification:City Images vs. Landscapes,"Pattern Recog.,vol.31,no.12,pp.1921-1935.
Vetterli,M.[1986]."Filter Banks Allowing Perfect Reconstruction,"Signal Proc.,vol.
10,no.3,pp.219-244.
Vetterli,M.and Kovacevc,J.[1995].Wavelets and Suband Coding, Prentice Hall,
Englewood Cliffs,NJ
Vincent,L.[1993].“MorphologicalGrayscale Reconstruction in Image Analysis:Appli- cations and Efficient Algorithms,"IEEETrans. ImageProc,vcL.2.no.2,pp.176-201.
Voss,K.and Suesse,H.[1997]."Invariant Fitting of Planar Objects by Primitives," IEEE Trans. Pattern Anal.Machine Intell,vol.19.no.1.pp.80-84.
Vuylsteke,P and Kittler,J[1990]."Edge-Labeling Using Dictionary-Based Relax ation,"IEEE Trans. Pattern Anal. Machine Intell,vol.12,no.2.pp.165-181.
Walsh,J.W.T.[1958].Photomery,Dover,New York.
Wang.D,Zhang.L.Vincent,A.,and Speranza,E.[2006].“Curved Wavelet Transform
for Image Coding,"IEEE Trans. Image Proc,vol.15,no.8,pp.2413-2421.
Wang.G,Zhang,J.,and Pan,G-W.[1995].“Solution of Inverse Problems in Image Processing by Wavelet Expansion,"IEEE Trans Image Processing, vol.4,no.5.
pp.579-593.
Wang.Y.-P,Lee,S.L,and Toraichi,K.[1999]."Multiscale Curvature-Based Shape Rep resentation Using β-Spline Wavelets,"IEEE Trans Image Processing.vol.8,no.11,
pp.1586-1592.
Wang.Z.,Rao,K.R.,and Ben-Arie,J.[1996].“Optimal Ramp Edge Detection Using Expansion Matching."IEEE Trans. Pattern Anal.Machine Intell.,vol.18,no.11,
pp.1092-1097.
Watt,A.[1993].3D Computer Graphics,2nd ed.,Addison-Wesley,Reading.Mass.
Wechsler[1980]."Texture Analysis-A Survey,"Signal Proc.,vol.2.pp.271-280.
Wei,D.,Tian,J,Wells,R.O,Jr,and Burrus,C.S.[1998].“A New Class of Biorthogonal Wavelet Systems forImageTransform Coding,"IEEETrans Image Processing,vol.7,
no.7,pp.1000-1013.
Weinberger, M.J,Seroussi,G,and Sapiro,G.[2000].“The LOCO-I Lossless Image
Compression Algorithm:Principles and Standardization into JPEG-LS,"IEEE
Trans. Image Processing,vol.9,no.8,pp.1309-1324.
Westenberg.M.A.and Roerdink,J.B.T.M.[2000]."Frequency Domain Volume Ren- dering by the Wavelet X-Ray Transform,"IEEE Trans Image Processing,vol.9,no.7,
pp.1249-1261.
Weszka,IS[1978]."A Survey of Threshold Selection Techniques,"Compu. Graphics Image Proc,vol.7,pp.259-265.
White,J. M.and Rohrer.G.D.[1983]."Image Thresholding for Optical Character Recognition and Other Applications Requiring Character Image Extraction,"IBM
617
618 数字图像处理(第三版)
I. Res.Devel,vol.27,no.4,pp.400-411.
Widrow,B.[1962].“Generalization and Information Storage in Networks of 'Adaline'
Neurons,"In Self-Organizing Systems 1962,Yovitz,M.C., et al.(eds.),Spartan,
Washington,D.C.,pp.435-461. Widrow,B.and Hoff,M.E.[1960]."Adaptive Switching Circuits.,"1960 IRE WESCON
Convention Record,Part 4,pp.96-104.
Widrow,B.and Stearns,S.D.[1985].Adaptive Signal Processing,Prentice Hall, Engle wood Cliffs,N.J.
Wiener,N.[1942].Extrapolation,Interpolation,and Smoothing of Stationary Time Series,
the MIT Press,Cambridge,Mass.
Wilburn,J.B.[1998]."Developments in Generalized Ranked-Order Filters,"J.Opt.Soc.
Amer.-A.Optics,Image Science,and Vision,vol.15,no.5,pp.1084-1099.
Windyga,P.S.[2001]."Fast Impulsive Noise Removal,"IEEE Trans.Image Processing,
vol.10,no.1,pp.173-179.
Wintz,PA.[1972].“Transform Picture Coding,” Proc.IEEE,vol.60,no.7,pp.809-820.
Witten,I.H.,Neal,R.M.,and Cleary,J.G.[1987].“Arithmetic Coding for Data Com- pression,"Comm.ACM,vol.30,no.6,pp.520-540.
Wolberg,G.[1990].Digital Image Warping,IEEE Computer Society Press,Los Alamitos, CA.
Wolff, R.S.and Yaeger,L.[1993].Visualization of Natural Phenomena,Springer-Verlag,
New York
Won, C.S.and Gray, R.M.[2004]. Stochastic Image Processing, Kluwer Academic/
Plenum Publishers,New York.
Woods,J.W.and O'Neil,S.D.[1986].“Subband Coding of Images,"IEEE Trans.Acous.
Speech Signal Proc,vol.ASSP-35,no.5,pp.1278-1288.
Woods, R. E.and Gonzalez, R.C.[1981].“Real-Time Digital Image Enhancement,”
Proc.IEEE,vol.69,no.5,pp.643-654.
Xu,Y.,Weaver,J.B.,Healy,D.M.,Jr.,andLu,J.[1994].“Wavelet Transform Domain Fil- ters:A Spatially Selective Noise Filtration Technique,"IEEE Trans. Image Process ing,vol.3,no.6,pp.747-758.
Xu,R.,Pattanaik,S,and Hughes,C.[2005]."High-Dynamic-Range Still-Image Encoding
in JPEG 2000,"IEEE Computer Graphics and Applications,vol 25,no.6,pp.57-64.
Yachida,M. [1983].“Determining Velocity Maps by Spatio-Temporal Neighbor- hoods from Image Sequences,"Comput.Vis. Graph. Image Proc.,vol.21,no.2,
pp.262-279.
Yamazaki, Y.,Wakahara,Y.,and Teramura,H.[1976].“Digital Facsimile Equipment
Quick-FAX'Using a New Redundancy Reduction Technique,"NTC76,pp.
6.2-1-6.2-5.
Yan,Y.and Cosman,P. [2003].“Fast and Memory Efficient Text Image Compression with JBIG2,"IEER Trans. Image Proc,vol.12,no.8,pp.944-956.
Yang,X.and Ramchandran,K.[2000].“Scalable Wavelet Video Coding Using Aliasing- Reduced Hierarchical Motion Compensation,"IEEETrans.Image Processing,vol.9,
no.5,pp.778-791.
Yates,F.[1937].“The Design and Analysis of Factorial Experiments,”Commonwealth
Agricultural Bureaux,Farnam Royal,Burks,England.
Yin,P.Y.,Yin,L.H.,and Chen, L.H.[1997].“A Fast Iterative Scheme for Multilevel Thresholding Methods,"Signal Processing,vol.60,pp.305-313.
Yitzhaky,Y.,Lantzman,A.,andKopeika,N.S.[1998].“Direct Method for Restoration
of Motion Blurred Images,"!Opt. Soc.Amer.-A.Optics,Image Science,and Vision,
vol.15,no.6,pp.1512-1519.
You,J.and Bhattacharya,P.[2000].“A Wavelet-Based Coarse-to-Fine Image Matching Scheme in a Parallel Virtual Machine Environment,"IEEE Trans.Image Processing,
vol.9,no.9,pp.1547-1559.
Yu,D.and Yan,H.[2001].“Reconstruction of Broken Handwritten Digits Based on Structural Morphology,"Pattern Recog.,vol.34,no.2,pp.235-254.
Yu,S.S.and Tsai,W.H.[1990].“A New Thinning Algorithm for Gray-Scale Images,”
附录B 参考 书 目
Pattern Recog.,vol.23,no.10,pp.1067-1076.
Yuan,M.and Li,J.[1987]."A Production System for LSI Chip Anatomizing,"Pattern
Recog. Letters,vol.5,no.3,pp.227-232.
Zadeh,L.A.[1965]."Fuzzy Sets,"Inform.and Control,vol.8,pp.338-353.
Zadeh,L.A.[1973].“Outline of New Approach to the Analysis of Complex Systems and Decision Processes,"IEEE Trans. Systems,Man,Cyb,vol.SMC-3,no.1,pp.28-44.
Zadeh,L.A.[1976].“A Fuzzy-Algorithmic Approach to the Definition of Complex or
Imprecise Concepts,"Int.J.Man-Machine Studies,vol.8,pp.249-291.
Zahara,E.,Shu-Kai,S.,and Du-Ming.T.[2005].“Optimal Multi-Thresholding Using a Hy brid Optimization Approach," Pattern Recognition Letters,vol.26,no.8,pp.1082-1095.
Zahn,C.T.and Roskies,R.Z.[1972]."Fourier Descriptors for Plane Closed Curves,"
IEEE Trans. Comput,vol.C-21,no.3,pp.269-281.
Zhang,T.Y.and Suen,C.Y.[1984].“A Fast Parallel Algorithm for Thinning Digital Pat- terns,"Comm.ACM,vol.27,no.3,pp.236-239.
Zhang,Y.and Rockett,P.I.[2006].“The Bayesian Operating Point of the Canny Edge Detector,"IEEE Trans.Image Proc.,vol.15,no.11,pp.3409-3416.
Zhu,H.,Chan F.H.Y.,and Lam,F.K.[1999].“Image Contrast Enhancement by Con strained Local Histogram Equalization,"Computer Vision and Image Understanding,
vol.73,no.2,pp.281-290.
Zhu,P. and Chirlian,P.M. [1995].“On Critical Point Detection of Digital Shapes,” IEEE Trans. PatternAnal.Machine Intell,vol.17,no.8,pp.737-748.
Zimmer,Y,Tepper,R.,and Akselrod,S.[1997]."An Improved Method to Compute the Convex Hull of a Shape in a Binary Image," Pattern Recog.,vol.30,no.3,pp.397-402.
Ziou,D.[2001]."The Influenceof Edge Direction on the Estimation of Edge Contrast
andOrientation,"Pattern Recog.,vol.34,no.4,pp.855-863.
Ziv,J.and Lempel,A.[1977].“A Universal Algorithm for Sequential Data Compres sion,"IEEE Trans.Info.Theory,vol.IT-23,no.3,pp.337-343.
Ziv,J.and Lempel,A.[1978].“Compression of Individual Sequences Via Variable-Rate Coding,"IEEE Trans. Info.Theory,vol.IT-24,no.5,pp.530-536.
Zucker,S.W.[1976]."Region Growing:Childhood and Adolescence,"Comput.Graph ics Image Proc,vol.5,pp.382-399.
Zugaj,D.and Lattuati,V.[1998]."A New Approach of Color Images Segmentation
Based on Fusing Region and Edge Segmentation Outputs,"Pattern Recog.,vol.31,
no.2,pp.105-113.
619
索 引
A
Accumulative difference images(ADls) 累积差分图像 801-802
Achromatie(monochromatic) light 无色(单色)光 67,418
Acoustic imaging 声波成像 42-44
Acquisition 获取 见Image acquisirion
Adaptive context dependentprobability 自适应上下文相关概率
572-573
Adaptive filters 自适应滤波器 见Sparial fiters
Additive cost functions 加性代价函数 537
Additivity 加性 95.366
Adjacency of pixels 邻接像素 90-91
Affine transformations 仿射变换 109-111 见Geometric
transfonnarions
Aggregation of fuzzy sets 模糊集合的聚类 204,207
Aliasing 混淆(混叠)239-241.250-257
filtering and 滤波和- 240,251
image interpolation and resampling and 图像内插、重取样和
252-255
moiré pattems and 莫尔(波纹)模式和~ 255-257
spatial 空间251
temporal 时间- 251
Alpha-trimmed mean filter 修正的阿尔法均值滤波器 349-352
Analysis fiher banks 分析滤波器组 492,525-526 Analysis trees,wavelet packets 分析树，小波包 532-536
Ani-aliasing 反混淆(混叠)240.251
Approximation coefficients 近似系数 494,508,511
Approximation pyramids 近似金字塔 486-488
Arithmetic coding 算术编码 570-573
Arithmeticlogic unit(ALU)算术逻辑单元(ALU) 51
Arithmeticmean filter 算术均值滤波器 344
Arithmeticoperations 算术操作 96-102
Array operations 阵列操作 94-95
Autocorrelation 自相关 375
Autocorelation matrix 自相关矩阵 621
AVS compression AVS压缩 560,563
B
Back propagaion,necural network trainingby 反向传播。神经网络
训练的 914-921
Background 背景 92.105
Backprojections 反投影 385-387
fan-iltered 扇形滤波~ 403-409
fihered 滤波- 397-400.403-409
halo-effectblurring from-引起的晕环效应模糊 385-387
purallel-beam filtered 平行射线束滤波- 397-403
Band-limited functions 带限函数 236-239.249-250
Bandpass filters 带通滤波器 316,358,412
Bandrejctfilters 带阳滤波器 316.357.412
Bartlane cable system 沃特兰电缆系统 25-26
Basisfunctions 基函数 499,589,592-593
DCT 离散余弦变换- 591
Haar 哈尔- 496
series expansion using 使用-的级数展开 499
Walsh-Hadamard 沃尔什哈达玛 590
Basis images 基图像 见Basis finctions
Bayes 贝叶斯
classification-分类 896-904
classifier -分类器 895
decision function ~决策函数 896-898
decisionruke 决策规则 764
formula -公式 766
Bidirectional frames (B-frames)双向帧(B帧)612
Binary images 二值图像 90.650
border following -的边界追踪 818
boundary of -的边界 92
compression of 的压缩 576,584 logical operations on 对~的逻辑操作 105
morphologicaloperations on 对-的形态学操作 650-686
segmentationand 分割和- 465.718.748.796
Binary trees 二又树 532
Biorthogonality 双正交性 492
Bit-plane coding 比特(位)平面编码 584-588
Bit-plane slicing 比特平面分层(分割) 139
Bit rate 比特率 559
Bits 比特 52.80-81,82
Blind盲
deconvolution -去卷积 368
spot -点 59
Block matching 块匹配 612-613
Block transform soding 块变换编码 588-606
bit alocation for -的比特分配 596-601
JPEG compression and JPEG压缩和 601-606
selection of transform for 为-选取变换 589-595
subimage size and 子图像大小和- 595-596 threshold implementation -阈值实现 599-601
zonal implemen:ation -分区实现 598-599
Blurring 模糊 见Filkering
BMP compression BMP压缩 560,563,576
Border 边界 92 见Boundary
clearing -清除 685-686
following -追踪 818-820
inner 内- 92
outer 外92
Bottom-hat transformation 底帽变换 694-696
Boundary 边界 见Border,Regional descrijptors
definition -的定义 92
chain codes -链码 820
curvature of -的曲率 837-838
decompositionof-的分解 832-834
descripion ~的描述 837-844
detection of segmentation -的分剂检测 747-760
diameter -直径 837
eccentricity of -偏心率 837
edge linking and 边缘连接和～ 747-760
extraction -提取 211,664-665
following -追踪 818-820
Fourier descriptors for -的傅里叶描绘子 840-843
length -长度 837
Moore boundary tracking algorithm 摩尔边界追踪算法 818-819
pixels -像素 92-93
polygonal approximation -的多边形近似 823-830
representation-表示 817-837
segments -线段 832-834 signatures -的标记图 830-832
shape numbersof -的形状数 838-839
staistical moments of -的统计矩 843-844
索引 621
Brightness 亮度 61-65,67,418.420
adapation of human eye 人眼的-适应性 61-65 chromaticlight and 彩色光和~ 67.418
color image processing and 彩色图像处理和~ 418.420
subjective 主观- 61-62 Butterworthfilters 布特沃斯滤波器
bandpass 带通- 316,358
bandrejct 带阻- 316,357
highpass(BHPF)高通- 306-307
lowpass(BLPF)低通- 295-298,373
notch 陷波- 317,359 sharpening using 使用-锐化 306-307
smoothing using 使用-平滑 295-298
Coding 编码 488-495,549,550-552,562,564-636 见
Compression
methods for image compression 图像压缩的-方法 562,564-636
redundancy-冗余 549.550-552
subband 子带- 488-495
symbol-based (or token-based)基于符号(或基于标记)的- 581-584
Cohen-Daubechies-Feauveau biorthogonal wavekets Cohen
Daubechies-Feauveau双正交小波 540-541
Color 彩色(颜色)
fundamentals 基础 417
gamut -色域 422
models -模型 423-436
safebrowser 稳定浏览器 426 C
Canny edge detector 坎尼边缘检测器 741-747
Cartesian product 笛卡儿积 79.203,687
CAT 计算机轴向断层 见Compued tomography
Cataracts 白内障 59
safeRGB 稳定RGB- 426
safe(Web)稳定(Web)-426
Color image processing 彩色图像处理 416-482
chromaticity diagram 色度图 421-422
color corections 彩色校正 455
CCDarrays CCD阵列 60.72.81,335.414.473
CCTTT 国际电话电报咨询委员会 560
CCHTT compression CCTIT压缩 578-581
Chain codes 链码 820-823
Chessboard distance 棋盘距离 93
Chromatic (color) light 彩色光 67.418
Chromaticity diagram 色度图 421-422
Ciry-block distance 城市街区距离 93
Classifiers 分类器
color "gradien" 彩色梯度 471
CMY model CMY模型 424,428-429
CMYK model CMYK模型 424,429
color slicing 彩色分层(分割) 453
compression and 压缩和~ 476-477
edge detection 边缘检测 469
full-color processing 全彩色处理 416.446-448
histogram processing 直方图处理 460
HSI molel HIS模型 424,429-436
Bayes 贝叶斯 896-904
minimum distance 最小距离 888-891
neural network 神经网络 904-924
opimumstatistical 最佳统计- 894-904
probabilityand 概率和- 895-896 structurul结构- 925-928
intensity slicine 灰度分层 437 intensiry to color 灰度至彩色 440
Closing 闭操作 657-661,690-692,699
gray-scale morphology and 灰度级形态学和-690-692,699
morphological operation of -的形态学操作 657-661
modelsfor -的模型 423-436
noise in ~中的噪声 473-476
pseudocolor 伪彩色 416.436-446
RGB model RGB模型 423-424.424-428
segmentation 分割 467-472
sharpening(尖)锐化464-465
smoothing in -中的平滑 461-464
reconstruction,by -重建 699
CMY color model CMY彩色模型 424,428-429
CMYK color model CMYK 彩色模型 424.429
Code 编码(名词)见Compression
arithmetic 算术~ 570-573
block 块-565
CCITTmakeup CCTTT 补偿- 934
cCTTT teminating CCITT终结- 933 Eias gamma Elias gamma- 569
Golomb Golomb- 566-570
Gray 格雷- 585
Huffman 霍夫曼-564-566
JPEG defaukt AC JPEG默认AC- 935-936
JPEG default DC JPEG默认DC~935
instantaneous 瞬时- 565
length 长度- 549
Code 编码(动词)
MH(Modified Huffman) coding MH(改进的霍夫曼)- 577
MMR(modified modified READ) MME(改进的改进的
READ)- 578
MR(modified READ)MR(改进的READ)- 578
natural binary 自然二进制~ 550
READ (relative element address designute)相对元素寻址指
派- 578
Rice 莱斯 567
symbols 符号~549 unary 一元- 566
uniquely decodable 唯一可解码的- 565
variable-length 变长- 551
words 码字 549
Codee 编解码 558
transformations in -中的变换 448-461
trichromatic coefficients 三色系数 421
Color transformations 彩色变换 448-461
color circle for -的彩色环 452
color management systems(CMS) for -的彩色管理系统
455-459
complements -的补色 452-453
corrections to color and tone -中颜色和色调的校正 455-459
fomulation for -的公式 448-451
histogramprocessing for -的直方图处理 460-461
profiles for -的剖面线 455-456
slicing -分层(分割)453-455
tonal range for -的色调范围 456-458
Commission Intemationale del'Eclairage(CIE)国际照明委员会
419,421-422,456
Compact support 紧支撑 503
Complex numbers 复数 224-225
Compression 压缩 49.476-477.547-648
arithmetic coding 算术编码 570-573
bit-plane coding比特平面编码 584-588
block transform coding 块变换编码- 588-606
BMP 位图(扩展名)576
CCTTT 577-581
coding redundancy 编码冗余 549.550-551
color images 彩色图像- 476-477
containers for ~的容器(存储器)560-562.563
fidelity criteria -的保真度准则 556-558
formatsfor -的格式 560-562.563
fundamentals of -的基础 548-562
Golomb coding Golomb编码 566-570
Huffman coding 霍夫曼编码 564-566
622 数字图像处理(第三版)
imelevant information and 不相关的信息和~ 549.552-553
JBIG-2 JBIG-2- 583-588
JPEG JPEG~601-606
JPEG-2000 JPEG-2000-629-635
Lcmpel-Ziv-Welch(1ZW) coding LZW编码 573-575
mapping and 映射和- 552.559-560 measuring information for的度量信息 553-556
methods of -的方法 562.564-636
models for -的模型 558-560
MPEG4AVC(H.264) MPEG-4AVC(H.264)- 616-618
predictive coding 预测编码- 606-625
quantization and 量化和 553,559-560,618-620.624-625
ratio -率 548-549
run-length coding 行程编码-575-581
sputial redundancy,空间冗余-549.551-552
standards for -的标准 560-562,563
symbol-basedcoding 基于符号的编码581-584
temporal rdundancy 时间冗余- 549,551-552
wavelet coding 小波编码-626-636
Components of image processing system 图像处理系统的组成 50-52
Computed tomognaphy (CT) 计算机断层 28,33.71,334,384-409
Computerized axial tomography (CAT) 计算机轴向断层 见
Computed tomography
Conncted componcnt 连通分量
definition的定义 91
description -的描述 845-849
extraction of -的提取 667-669,707
segmentation -的分割 786.794
Coanected pixels 连通像素 91
Connected set 连通集 91
Constrained least squares filtering 约束最小平方滤波 379-383
Containers for image compression 图像压缩的存储器 560-562,
563
Continuous wavelet transfom(CWT)连续小波变换 513-515
scale and translation in -中的尺度和平移 513
admissibility criterion 容许准则 513
Contour 轮廓 见Border, Boundary
Contraharmonic mean filter Contraharmonic均值滤波器 345-347 Contrast 对比度 24,80.100,119,142,208,869 见Enhancement
local 局部~ 780
medium 中等~99.139
measure of -度量 850.854-856
simultancous 瞬时63
stretching -拉伸 128.137,138
Control points 控制点 112
Convex hull 凸壳
definition 的定义 669
extraction 的提取 669-671
for description 的描述 832-834
Convexdeficiency 凸缺 669
Convolution 卷积
by digiual filtering 数字滤波 489
circular 循环 245.271
fiher -滤波器 172
integral 积分 367
kemel -核 172
mask -模板 172
sputial continuous 空间连续- 231-32,433
spatial discrete 空间离散- 168-172
theorem -定理 232.271.276.285.367,401,811,892
Co-occurrence matrix 共生矩阵 852-858
Corelation 相关
circulr 循环- 276
coefficient —系数642,892
descripor 描绘子 853.856
matching by -匹配 891-894
spatial 空间 168-172
theorem ～定理 277
Cros-modulation 交叉调制 492
CT 见Computed tomography
Cutof frequency 截止频率 292
D
Dam construction for watersheds 分水岭的水坝构建 794-796
Data compression 数据压缩 548 见Compression Dead zones 死区 629
Decimation 抽取 253
Decision function 决策函数 888
Decision surfaces,complexity of 决策面，-的复杂度 921-924
Decoding 解码 558.560
Huffman coding and 霍夫曼编码和- 565
image decompression and 图像解压缩和- 558,560
inverse mapper for -的反映射器 560
symbol decoder for -的符号解码器 560 Decomposition 分解 537-540,628-629
boundarysegments from -导致的边界分割 832-834
level selection for wavelet coding 小波编码的-级别选取
628-629
trees in wavelet packets 小波包中的-树 537-540
wavelets and 小波和- 537-540.628-629
Defense Meteorological Satelite Pogram(DMSP)国防气象卫星计
划 37
Defuzzification 去模糊 204-205,207
Degnadation 退化 见Restoration
estimating -估计 368-372
linear,position-invariant 线性位(置)不变- 365-368
modelof -的模型 334-335
Delta modulation(DM) 德尔塔(增量)调制 619-620
Denoising 去噪 334,530
Derivative 导数 见Gradicnt,Laplacian
fist order 一阶 180-182,715
second order 二阶- 180-182,715
Descripion 描述 837-877
area 面积~ 837
basicrectangle 基本矩形- 837
boundary 边界 837 circularity ratio 圆度率~844
compactness 致密性- 844
diameter 直径- 837
ecenticity 偏心-837
Euler number 欧拉数- 845
Fourier descriptors 傅里叶描绘子。840 momentinvariants 矩不变- 861
perimeter 周长- 844
principal components 主分量864
regional 区域- 见Regional descriptors
relational 关系-874
shape numbers 形状数- 838
statistical moments 统计矩-843
texture 纹理 849-861
topological 拓扑- 845
Denoising 去哚 530
Detailcoefficients (horizontal, verical,and diagonal) 细节系数(水
平、垂直和对角线)494,508,511
Differential pulse code modulation(DPCM 差分脉冲编码调制
621-624
Digital 数字
filter -滤波器 见Fihers
image.definition of -图像、一图像的定义 23
Digital image processing 数字图像处理 见Image
defined -的定义 23-25
fields of -的领域 29-47
fundamentals of -基础知识 57-125
high-levelprocesses of -的高级处理 24
history of -的历史 25-29
索引 623
origins of -的起源 25-29
sensors for 的传感器 50,68-73
steps in -的步骤 47-50
Digital signal filtering 数字信号滤波 488-491
Digital signal processing (DSP)数字信号处理 488-491
Digital Video Disk(DVD) 数字视频光盘 547-548
Digitizer 数字化器 50.70
Dilation 膨胀 见Morphological image processing
Dilation equation 膨胀公式 504
Discretecosine transform(DCT)离散余弦变换 591 见JPEG
compression
Discrete Fourier transform(DFT) 离散傅里叶变换
average value 平均值 268,275
circular convolution 循环卷积 见Comolution
circular corelation 循环相关 见Correlation
derivation of -的导数 224-235
Fast Fourier Transform(FFT)快速傅里叶变换 321-325
implementation -的实现 320-325
padding -的填充 273-275
pair,1-D-一维对 258
periodiciy of -的周期性 259-261
phaseangle -的相角 267.275
polar representation -极坐标表示 275 properties -属性 258-275
sepurability -的可分离性 276
spetrum -谱 229,248.267,275 symmetry properties ~的对称性 264
two-dimensional 二维 257-258
zero pading -的零填充 273-274
wraparound error -的缠绕错误 272
Discrete wavelet transform(DWT)离散小波变换 510-512,524
见Wavelets
Discriminant (decision)analysis 判别(决策)分析 884-885,888
Distance measures 距离度量(测度)93-94,114-115,467,784-
785.831,837.888-891,899.925
Dots (pixels)点(像素)
per inch (DPD一每英寸 81.256,581
per unitdistance-每单位距离 81
Downsampling 下取(采)样 486-487
DPI 点每英寸 81.256,581
DV compression DV压缩 560,562
Dynamic range 动态范围 79-80
E
Edge 边缘 见Edge detection
color 彩色~ 469-472
definition -的定义 92
dinction -的方向 728
enhancement -增强 179-190,302-311,693
gradient -梯度 187.471,623,693,728 linking -连接 747-760
magnitude 幅度 187-188,728
map -映射 733
models ~模型 722-728
noise sensitivity -噪声敏感性 726-727
normal -法线_729
operators -算子 730
ramp 斜坡- 181,715.724
roof 屋顶 715.724
step 台阶-181,715,724 types -类型 180-182,716
unitnormal 单位法线- 729
wavelet transform and 小波变换和~ 526-527,529-530
zero crossing -零交叉 181.725.739
Edge detection 边缘检测 469472,722-747 见Edge
boundary detection 边界检测 747
Canny edgedetector 坎尼边缘检测器 741-747
derivatives 导数 180-184,715-716
edge linking 边缘连接 747-760
false negative 伪负值 744
false positive 伪正值 744
gradient 梯度 187.471,623.693.728-736 见Gnadient
gradient and thresholding 梯度和阀值处理 735
hysteresis thresholding 滞后阈值处理 744
Laplacianof Gaussian(LoG) 高斯拉普拉斯 737
Mar-Hildreth edge detcctor Marr-Hildreth 边缘检测器 736-741
models for -的模型 722-728
nonmaxima suppression 非最大抑制- 743 Prewit edge detector Prewit 边缘检测器 730-732,809
ramp edges 斜坡边缘 715-717.722 Roberts detector 罗伯特检测器 189.730
roof edges 屋顶边缘 715.723-724
Sobeledge detector Sobel边缘检测器 188-190,730-732.810 spagheti effect 意大利通心粉效应 739
spatial filters and 空间滤波器和-717
step edges 台阶边缘 715-717.722
wavelet-based 基于小波的- 529-530
Electromagnetic(EM)spectrum 电磁波谱 24.29-42,65-68
gamma radiation 伽马辐射 30-31,67-68 imaging in -图像处理 29-42
importance of -的重要性 24
infraredregions 红外区域 34-40.68
light and 光和 65-68
microwave band 微波频段 40-42,67.68
radio band 无线电频段 42.67.68
source of image from 来自-的图像源 29-30
units of -的单位66,67
visible band 可见光频段 34-40.66-67
X-rays X射线 31-33,67-68
Electron beam computed tomography 电子束计算机断层 389
Electron microscopy 电子显微镜 29.42.68,137,164,278
Eias gamma codes Elias gamma编码 569
Encoding 编码 558.559,575-577 见Campressiom
image compression and 图像压缩和~ 558,559
mapper for -映射器 559
quantizer for -量化器 559
run-length(RLE)行程- 575-577
symbol coder for 的符号编码器 559
Empty set 空集 102 Enhancement 增强
adapive 自适应- 150.352,354
contrast enhancement 对比度增强 135,149,150.208,311,332
contrast stretching 对比度拉伸 128.137.138
combined methods 组合的方法 191-195
defined 定义的- 47,129.223
frequency domain 频率域- 279-320
fuzzy techniques for -的模糊技术 208-213
homomorphicfilteing 同态滤波 311
image averaging 图像平均 97
image subtraction 图像相减 99
histogram processing for 的直方图处理 142-166
intensity transformations 灰度变换 129-141
local 局部~ 161.164,352,354
median filer 中值滤波器 178.217.348,354,411
order statisticfilters 统计排序滤波器 178,347
shapening(尖)锐化 179.302
smoothing 平滑 97.174.291
spatialfilters 空间滤波器 166-190 Entropy 嫡 554-555
Erlang(gamma) noise 爱尔兰(伽马)噪声 337-338
Erosion 腐蚀 见Morphological image processing
Estimating the degradation function 估计退化函数 368-372
Euclidean distance 欧氏距离 114 见Distanc
measures -度量(测度)
norm -范数 114
Expansions 展开 499-508,508-510
624 数字图像处理(第三版)
basis functions of 的基函数 499
biorthogonal 双正交 500
coefficients of -的系数 499
multiresolution analysis(MRA)多分辨率分析 499,503-504
orthonormal 归一化正交-500
overcomplete 过完备 500
scaling functions -尺度函数 499,501-505
series 级数 499-501.508-510
wavelet functions for -的小波函数 505-508
wavelet series 小波级数 508-510
Exponential Golomb codes 指数Golomb编码 569
Exponential noise 指数噪声 338
F
False color 假彩色 见Pseudocolor
False contouring 假轮廓 85.122.141.645
Fan-beam filered backprojections 扇形射线束滤波反投影 403-
409
Fast Fourier transfom(FFT) 快速傅里叶变换
Fast wavelet transform (FWT) 快速小波变换 515-523,524-527,
532-541
analysis filter banks 分析滤波器组 517-518,525-526
imagecompression using 使用-的图像压缩 626-635
inverse 反520-522
muli-resolution proesing using 使用~的多分辨率处理 515-
523.524-527
synthesis filter banks 综合滤波器组 521-522,525-526
time frequeney tiles 时间-频率片 522-523
two-dimensionual 二维523-527
wavelet pxckets for 的小波包 532-541
FAX 传真 577
Feature selection 特征选择 见Description
Fidelity criteria 保真度准则 556-558
Fiducial marks 基准标记 117
Flters 滤波器
deconvolution 去卷积- 368
frequency domain 频率域-
kermels -的核 见Spatial filters
finite impulse response(FR)有限冲激响应-
286,490
Hamming window -的汉明窗 399
Hann window 的汉宁窗 399
reconstruction ~重建 239
spatial 空间见Spatial filters,Spatial
filtering -滤波
transfer function -的传输函数 279
zero-phase-shif 零相移- 284
Filter banks 滤波器组 491-493
Filers,digiual 数字滤波器 488-495
biorthogonal 双正交-492,540-541
coefficients 系数 490
Cohen-Daubechies-Feaveau biorthogonal coefficients Cohen Daubechics-Feauveau双正交系数 540
convolution and 卷积和- 489
Daubechies 8-taporthononnual coefficients 8抽头Daubechies正
交归一化系数 494
filter banks 滤波器组 491-493
filter taps 滤波器抽头 490
finite impulse response 有限冲激响应 490
FIR 有限冲激响应 490
Haar coefficients 哈尔系数 519
impulse response 冲激响应 490
JPEG-2000 ireversible JPEG-2000不可逆 31-29,631
modulation in -中的调制 491
order of -的阶 490
order reversal in-的反阶 491
orthonomal 归一化正交- 493-494,519,529
perfeet reconstruction 完美重建 492
protorypes 原型 493
sign reversal in 的符号反转 490 symlet(4th order orthonormal)coefficients 对称小波(第4阶正
交归一化)系数 529
Filter banks 滤波器组 491-493
FWT analysis FWT分析- 517-520,533
FWT synthesis FWT合成~ 521-522
wavelet packet analysis 小波包分析 535
Filering 滤波
frequency 频率见Freqweney domain filhering
sputial 空间- 见Spatial filtering
Finite impubse respone(FR) fihers 有限冲激响应滤波器 286,490
Fixed increment correction rule 固定增量修正规则 908
Fuorescence microscopy 荧光显微镜 33-34
Foreground 前景 92.105
Formuts for image compression 图像压缩格式 560-562,563
Forward mapping 前向映射 109
Fourier deseriptors 傅里叶描绘子 840-843
Fourier series 傅里叶级数 222-223,225
Fourier-slice theorem 傅里叶切片定理 396-397
Fourier spetrum 傅里叶谱 131-132,228-229,267-271
log transformations and 对数变换和- 131-132
phase angle and 相角和- 267-271
plot of frequency of -的频率图 228-229
Fourier transform 博里叶变换 227-277
continuous 连续- 227.248
convolution 卷积 见Convoluarion
discrete 离散~ 见DiscreteFourier transform
FastFourier transform(FFT)快速傅里叶变换 见Discrete
Fourier trangfom
history of -的历史 222-223.326
pair -对 117,227.232,244,248,258.892
power spectrum~的功率谱 267
sampling and 取样和- 233-242,249-257
Fractal images 分形图像 46-47
Frame buffers 帧缓存器 52
Freeman chain code 费雷曼链码 820-823
Frequency domain 频率域 221-332.804-807
additional characteristics -的附加特征 277-279
aliasing -混淆(混叠)见Aliasing
convolution -卷积 见Comolution
discrete Fourier transform(DFT)-离散傅里叶变换 见
Discrete Fourier transform
fast Fourier transfom(FFT)-快速傅里叶变换 见Discrete
Fourier tranyform
filtering -滤波 见Frequency domain
Fourier series -傅里叶级数 222-223,225
Fourier spectrum 傅里叶谱 267-271
Fourier transform -傅里叶变换 见Fourier transform impulse -冲激 见Impulse
motionin segmentation -分割中的运动 804-807
sampling -取样 见Sampling
sifing property -取样特性 见impulse
Fraquency domain filtering 频率域滤波 277-320. 见Sparial
filering
bundpass filters 带通滤波器 316-320,357-362
bandreject filters 带阻滤波器 316-320,357-362
box filter 盒状滤波器 229
Butterworth filers 布特沃斯滤波器 295-298.306-307,316
319,357-360,373
corespondence with spuialfihtering 与空间滤波的对应性 285,291
fundamentals of -基础 279-285
Gaussian fiters for 的高斯诚波器 280-281.287-291,298-
299,307-308,316-319,357-360
highboost flters 高提升滤波器 310
high frequency emphasis 高频强调 310
highpass filters for -的高通滤波器 280,303-308
索引 625
homomophic filters 同态滤波器 311-315
idealfilters 理想滤波器 238-239,250,282-284.291-295.299.
303-307,316.357-360
Laplacian 拉普拉斯 308-310
lowpass fihers 低通滤波器 239,280,291-303
notch filers 陷波滤波器 316-320.357-362
sharpening(尖)锐化 303-315 smoothing 平滑 291-303
steps -的步骤 285
unsharp masking 非锐化模板 310
Frequeney intervals 顿率间隔 245-246
Frequeney spcctrum 频谱 见Spectnum
FWT 518,533
subband cxling 子带编码 491 wavelet pucket 小波包 535-536
Front-end subsystem 前端子系统 51
Full-color image processing 全彩色图像处理 416.446-448 Funcionally complete 功能完备的 105
Fuzzy sets 模糊集合 106-107,195-213
aggregation of -的聚集 204,207
color fuzzifiedby 被-模糊的彩色 200-208
definitions for -定义 196-200
defuzzification of -的去模糊 204-205,207
implication of -的含义 201-204,207
intensity transfornationsand 灰度变换和~ 208-211
membership (charateristic)functions 隶属度(特征)函数 106,
195-200
principles of theury 理论原理 196-200
set operations of -的集合操作 106-107,195-196
spatial filtering and空间滤波和208-213
use of -的用途 200-208.208-211,211-213
G
Gamma 伽马 corection -校正 133-135
noise -噪声 见Noise
Gamma-ray imaging 伽马射线成像 30,43,69
Gaussian filter 高斯滤波器
frequency 频率 见Frequency domain fihering
spatial 空间 见Sparial filering
Gaussiannoise 高斯噪声 见Noise
Gaussian patem class 高斯模式类 896-904
Gaussian pyramid 高斯金字塔 486
Gcometric mcanfilter 几何均值滤波器 345,383-384
Geometric transformations 几何变换 109-114
Affine 仿射 109
control points -控制点 112
identity 恒等- 110
rotation 旋转- 110
scaling 尺度110
shearing 剪切-110
tie points -连接点 112
ranslation -平移 110
GIF compression GIF压缩 560,563,573
Global threshokding 全局阀值处理 见Thresholding
Golomb codes and coding Glomb代码和编码 566-570
Golomb-Rice codes Golomb-Rice 编码 567
Gradient 梯度 187-190.469-473,693-694,728-736
color segmentation 彩色分割 469-473
edge detection 边缘检测 728-736
edge normal (vector)边缘法线(向量)729
edges 边缘 190.469-473
fist-order derivatives,as 一阶导数 187-190
gray-cale morphology 灰度级形态学 693-694
morphological 形态学-693
operators -算子 188-190,469-473.729-734
Prewit operators Prewit算子 731-732
properties of 的属性 728-729
Roberts operators Roberts算子 188-189.730-730 sharpening(尖)锐化 187-190
Sobeloperatos Sobel算子 188-190,731-732
thresholding,combined wih 阀值处理与-735-736
Granular noise 颗粒噪声620
Granulometry 粒度 696-697
Gray level 灰度级 23,67,74,128 见Intensity
Graylevelco-occurence matrix 灰度级共生矩阵 852 见 Intensiry
Gray scale 灰度级 67.74
Gray-scale morphology 灰度级形态学 687-701 见
Morphological image prcessing
botom-hat transformation 底帽变换 694-696
closing 闭操作 690-692,699
dilaion 膨胀 688-690,698-699
erosion 腐蚀688-690.699
gradient 梯度 693-694
granulometry 粒度 696-697
opening 开操作 690-692.699
reconstruction 重建 698-701
smoothing 平滑 692-693 textural segmentation 纹理分割 697-698
op-hat transformation 顶帽变换 694-696
H
Har transform 哈尔变换 496-499 Halftone dots 半色调点 256-257
Hamming window 汉明窗 399
Hann window 汉宁窗_399
Harmonic meanfilter 同态均值滤波器 345
HDV compression HDV压缩 560,563
Heisenberg cellsboxes 海森伯单元/盒 522
Heisenberg uncertainty pinciple 海森伯测不准原理 522
Hertz(Hz)赫兹 66
Highdefinition(HD)television 高清晰度电视 548 High-frequency-emphasis filering 高频强调滤波 310-311
Highboot filtering 高提升滤波 184-187,310-311
Highpass filters 高通滤波器 frequency -频率 见Frequency domain filering
spatial 空间- 见Sparial ilrering
HSI color model HSI彩色模型 424,429-436,465-467 conversion from RGB RGB至-的转换 432-433
conversion to RGB-至RGB的转换 433-435
manipulation of images 图像加工 435-436 plane concept of -的平面概念 430-432
segmentation-分割 465-467
uses of -的用途 429
Histogramproeessing 直方图处理 142-166,460-461
definition -的定义 142
color transformationusing 使用-的彩色变换 460-461
equalization 均衡- 144-150
global 全局- 142-160
intensity transformation 灰度变换 144.148 inverse transformation 反变换 144.150
local 局部- 161-166
matching(specification)匹配(规定化)150-160
normalized 归一化- 142
pobabiliy density function(PDF) for-的概率密度函数 145-147
statistics,use of 统计-.的用途 161-166
Hit-or-miss transformation 击中或击不中变换662-663
Hole filling 孔洞填充 665-667.682,684-685.707
Homogeniety 一致性 95,366,854
Homomorphicfiltering 同态滤波 311-315
Hough transform 霍夫变换 755-760
Hue,color image processing and 色调、彩色图像处理和- 420-
421,429-436
Huffman coding_霍夫曼编码 564-566
Human eye 人眼 见Visual perception
626 数字图像处理(第三版)
H.261,H.262.H.263,H.264 560,562.616-618
1
Ideal filter 理想滤波器 见Frequeney domain filering
IEC 国际电工委员会 560
Ilumination 照明 73-74.762-763
corection -校正 100-101.694-695.778,783
eye response 人眼响应- 39.59.62
image model,in-中的图像模型 73-74,311-315
nonuniform 不均匀100-101.694-695.763.778
segmentation and 分割与- 762-763
source -源 68-72
standard ~标准 456,630
structured light 结构光- 39
Image 图像
acquisition -获取 68-72
analysis -分析 24
blur 模糊 369-372
color processing 彩色-处理 416-482
compression -压缩 见Compression
deconvolution -去卷积 368
element -元素 见Pixel
enhancement -增强 见Enhancemen
filteing -滤波 见Fihering
formation model -的形成模型 72,311
ilumination-照明 见Ihominatim
intensity -亮度 见Intensiry
interpolation -内插 见Inerpolariom
mophology -形态学 见Mophological image proesing
pixel -像素 见Pivel
reflectance -反射 73,311
registration -配准 97,111.801,864
resampling -重取样 87,252.639.821
restoration -复原 见Image restoration
rotution -旋转 见Geometric transformatiomns
scaling -尺度变换 见Geometric trangformurions
segmentation -分割 见Segmenutation
sensing 遥感-29-47.68-72
sensors -传感器 68-72 shearing -剪切 见Geometric transgformarions
translation -平移 见Geometric transformmations
zooming -缩放 87.109.252
Image compression standards 图像压缩标准 560-563
Imagefile formats and image containers 图像文件格式和图像容器
560-563
Image informuation 图像信息 553-556
Image pyramids 图像金字塔 485-488
Image transforms 图像变换 见Transforms
Imaging modalities 成像模态 30-47
Implication in fuzzy sets 模糊集合中的含义 201-204,207
Impulse 冲激
continuous 连续~ 225-226,247-248
discrete 离散- 169-171,247-248
noise -噪声 178-179.338-340
response -响应 286,366-367,369.490.494.631
sifting property of -的取样特性 225-227,247-248,490
train -串 226-227.230-231.250
unitdiscrete 单位离散- 169-171.226.247-248
Independent frames (I-frames)独立帧(帧 611
Information theory 信息论 554-556
Infrared 红外 29.34.43.66,99.418.440,444.712.845.849.868.901
Intensity 灰度 23,67.81-87
fuzy techniques -模糊技术 195.208-211
mean -均值 见Moments
mapping -映射 564,109-111.128-166,448
quantization -量化 74-76
scale -尺度 74
scaling -尺度变换 101-102
statistical descriptors -统计描绘子 118-119.161-166
transformations -变换 107.127-166
thresholding -网值处理 760-785
transforutions -变换 128-166
variance -方差 162 见Moments
lntensity transformutions 灰度变换 128
bit-plane slicing 比特平面分层-139
contrast stretching 对比度拉伸-128,137.138
gamma 伽马- 132
histogramequalization 直方图均衡- 142-150
histogrammuatching 直方图匹配-150-160
histogramspecification 直方图规定化 150-160
intensity-level slicing 灰度级分层 137
local 局部~ 161-166
log 对数 131
negative 反转- 130
piecewise linear 分段线性- 137
power law 霉律~ 132
Intepolation 内插 87-90.109-113,242,252-255.485,562,615
bicubic 双立方- 88
bilinear 双线性88
nearest neighbor 最近邻- 87-88
resampling (shrinking and zooming) images by -重取样(缩放)
图像 87-90
Inverse filtering 逆滤波 373-374
Inverse Fourier transform 傅里叶反变换 见Fourier tangform. Discrete Fowrier transform
lnverse mapping 反(逆)映射 109
Inverse transforms 反变换 见Trangforms
Invisible watermarks 不可见水印 638-642
ISO 国际标准化组织 560
Isopreference curves 等偏爱曲线 86
Isotropic filers 各向同性滤波器 182
TU-T 国际电信联盟远程通信标准化组织 560
J
Jaggies 钢齿 254
JBIG compression JBIG压缩 560.561
JBIG2compression JBIG2压缩 560.561,583-584
JPEG compression JPEG压缩 560.561.601-606,629-636
block transform coding for 的块变换编码 601-606
JPEG-2000 standard JPEG-2000标准 629-636
wavelet coding for -的小波编码 629-636
JPEGLS compression JPEG-LS压缩 560,561,572
JPEG-2000compression JPEG-2000压缩 560,561,629-635
components -分量630
derived vsexpounded quantization 导出式量化与描述式量化633
ineversible component transform 不可逆分量变换 630
liting-based wavelet transforms 基于提升的小波变换 631
tile components 片分量 631
L
LANDSAT satellite LANDSAT 卫星 36,806,848
Laplacian 拉普拉斯
defined -的定义 182
color 彩色- 464
.convolution using 使用-的卷积 811
combinedwith gradicnt -与梯度的组合 191,772
decomposition -分解 812
frequeney domuin 频率域-277,308.329-330
isotropic propery -的各向同性 219.721
ofGaussian (LoG) 高斯- 737,811
operators -算子 183
PDF -概率密度函数 610
pyramid 金字塔- 488
restoration for -的复原 380
scaling -尺度变换 184
sharpening with 使用~锐化 184-185,309
索引 627
thresholding for 的阀值处理 718-721.736,771-775
zero crossing -零交又 181.725,739
Large scale integration(LD大规模集成 27
Least-mean-square(LMS) delta rule 最小均方德尔塔规则 909
Lempel Ziv-Wekch (IZW)oding Lempel-Ziv-Wekh 编码 573-575
Light 光 65-68,417-423 见Electromagnetic (EM)spectrum
absorption of-的吸收 418-419
achromatic 无色- 418
chromatic 色 418
color image proessing and 彩色图像处理和- 417-423
microscopy 显微镜 35
monochromatic 单色-67
vision and 视觉与～见Visual perception
EMspectrum visible band for -的EM谱可见波段 65-68,
417-418
primary and secondary color of ~的原色和二次色 419-420
Line detection 线检测 719-722
Line pairs 线对
per mm -每毫米 81
per unit distance 每单位距离 81
Linear 线性
convolution -卷积 见Comoution
correlation -相关 见Correlation
FIR filters FR滤波器 286
frequeney domuin filters 频率域滤波器 272
masks 模板 172
motion -运动 371,388
operations -操作 95-96,276,365-368
transforms -变换 115 spatial filters-空间滤波器 167.172
system -系统 225,334,365-368
Linearly sepurable classs 线性可分类 908-909
Live image 活动图像 99
Loyd-Max quantizer 劳埃德-马克斯量化器 625
Logtransformations 对数变换 131-132
Logical operations 逻辑操作(运算)105-106
Lossless predictive coding 无损预测编码 606-611
Lossy predictive coding 有损预测编码 618-621
Lowpass filters 低通滤波器
frequency -频率 见Frequency domain filtering -滤波
spatial 空间-见Sparial filhering
LSB watermarks LSB水印 638
Luminance,chromatic light and 亮度，色光和~ 67,418
LZWcoding LZW编码 见Lempel-Zh-Welch(ZW)coding
M
Mach bands 马赫带 63,64
Macroblocks 宏块 611
Magnetic resonance imuging(MRI 磁共振成像 42.72,112,135.390
Mahalanobis distance 马氏距离 785 见Distance measures Malat's herringbone algorithm Mallatherringbone算法 515
Mapper 映射器 559
Mapping 映射 109-110,154-155.157-158,552,559-560 见
Intensiry
decoding(decompression)and 解码(分解)和- 560
encoding (compression) and 编码(压缩)和- 559
forward 前向~ 109-110
histogram processing and 直方图处理和~ 154-155.157-158
inverse 反- 110,560
Markers 标记
morphological reconstruction for -的同态重建 678-686,698-
699
thresholding -阈值处理 772
watersheds for 分水岭 798-800
Markov sources 马尔可夫源 556
Mar-Hildrethedge detector Marr-Hildreth 边缘检测器 736-741
Masks 模板 见Spatial filters
definition -的定义 128
masking function 模板函数 593
threshold -阈值 599
unsharp masking and 非锐化模板和 184-187
Mask mode adiograpby 遮光方式造影 99
Matching 匹配 888-894,925-928
block 块- 612-613
correlation,by -相关891-894
minimum distance classificr 最小距离分类器
method -方法 888-891
shape numbers -形状数 925-926
stings -串 926-928
Matrix operations 矩阵操作 78.94-95,114-115
array operations versus 阵列操作与94-95
notation for pixels -像素的表示 78
vector operations and 向量运算和-114-115
Max filters 最大滤波器 174.348
Mean absolute distortion(MAD)均值绝对失真 612
Mean filters 均值滤波器 见Spatial fiters
Mean of intensity 亮度均值 见Momens
Meanpyramid 均值金字塔 486
Mean square error (MSE)均方误差
filtering in -的滤波 374-379
measure ~度量 376
Medial axis transformation(MAT) 中轴变换 834-835
Median filters 中值滤波器 178-179.348.411
adaptive 自适应- 354-357
updating 更新- 218
Membership(churacteristic) functions 隶属度(特征函数 106.
195-200
Mexican hat 墨西哥帽
operator -算子 737
wavelet -小波 514
Micron 微66
Micnoxdensitometer 微光密度计计 70
Microwave 微波 29.40.66,440
Midpoint filter 中点滤波器 349
Minfilter 最小滤波器 179,349
Minimum distance classifier 最小距离分类器 888-891
Minimum-perimcter polygon(MPP)最小周长多边形 823-829
Minkowsky 闵可夫斯基
addition -相加 705
subtraction -相减 704
M-JPEG 560,563
Moditied Huffman(MH)coding 改进的霍夫曼编码 577
Modified READ(MR)coding 改进的READ编码 578
Modified Modified READ (MMR)coding 改进的改进的READ编
码 578
Modulation 调制 491
Modulation function 调制函数 363
Moirépattems 莫尔(波纹)模式 255-257.318
Moments 矩
statistical 统计-118-119.843,850,881,885
invariant 不变- 861-864
Monochromatic(achromatic)light 单色(无色)光 67,418
Moore boundary tracking algorithm 摩尔边界追踪算法 818-819
Mophological image processing 形态学图像处理 649-710
alemating sequential fihering 交替顺序滤波- 692
binary images,summary 二值图像，小结 684-686
black top-bat 黑色顶帽-694
border clearing 边界清除 见Morphological reconstnuction bottom-hat transformation 底帽变换 694
boundary extraction 边界提取 664-665
closing 闭操作 657-391,690-692
connectedcomponents 连通分量 667-669
convexhull 凸壳669-671
dilation 膨胀 655-657,678-681.688-690
erosion 腐蚀 652-655,657,678-681,688-690
628 数字图像处理(第三版)
fitering 滤波 649.655.660,692.709
gradient 梯度 693
granulometry 粒度 696
gray-scale 灰度 687-702
hit-or-miss transformation 击中或击不中变换 662-663
holefilling 孔洞填充 665-667,684-685
opening 开操作 657-661.681.684.690-692
operations summary of -的操作小结 684-686
preliminaries -预备知识 650-652
pruning 裁剪 676-678
reconstruction -的重建 见Morphological reconstnuctiom
reflection of sets in 中的集合的反射 650
set operations for 的集合操作 102-106,650-652
shading coretion 阴影校正 695
skeletons 骨架 673-676 见Skeletons
smoothing 平滑 692
struchuring ekement 结构元 651 textural segmentation 纹理分割 697
thickening 粗化 672-673
thinning 细化 671-672
top-har transformations 顶帽变换 694.699
translation of sets in-的集合平移651
white top-hat 白色顶帽 694
Morphological reconstnuction 形态学重建 678-686,698-701
border clearing and 边界清除和~ 685-686
dilation by 被-膨胀 680-681.698-699
erosion by 被-腐蚀 680-681.699
geokesic dilation and erosion 测地膨胀和腐蚀678-681,698-699
gray-scale imagesand 灰度图像和698-701
hole filling and 孔洞填充和-684-685
opening by 被-开操作 681,684.699
top-hat by 被-顶帽 699
Motion compensation,predictive coding and 运动补偿，预测编码
和- 611-618
Motion estimation 运动估计 612-616
Motion in segmentation 分割中的运动 800-807
accumulative difference image(ADID累积差分图像 801-802
frequency domain techniques for 频率域技术 804-807
reference images,establisthment of 参考图像，-的建立 803-804
spatial techniques for ~的空间技术 800-804 Movingaverages for thresholding 阈值处理的移动平均 781-783
MPEG-L,MPEG-2,MPEG4(AVC) 560,562,616-618
MQ coder MQ编码器 572
Mulilayer feedforward ncural networks 多层前馈神经网络 841-924
Multiresolution analysis (MRA) 多分辨率分析 499,503-504
requirements for -的需求 503-504
Multiresolution proessing 多分辨率处理 483-546
expansions 展开 499-508
Haar transform 哈尔变换 496-499
image pyramids 图像金字塔 485-488
MRA equation MRA方程 504
multiresolution analysis (MRA)多分辨率分析 499,503-504
scaling functions 尺度函数 499,501-505,523-524
series expunsions 级数展开 499-501.508-510
subband coding 子带编码 488-495
theory of -的理论 483-484
wavelets and 小波和- 483-546
Multispectral imaging 多光谱成像 36-37.114,444,848.868-871.
901-903
N
Nanometer 纳米 66
Negative images 反转图像(负像) 104,107.130-131 Neighborthood 邻域
definition 的定义 90
operations -操作 107-109.127-128,167-191
Neighbor of a pixel 像素的邻域 90
nearest 最近- 88.109-111.242,252 见Interpolarion
types -类型90-91
Neural networks 神经网络 904-924
algorithms for -算法 908-911
back propagation,training by 反向传播。-训练 914-921
background of -的背景 904-905
decision surfaces,complexity of 决策面。-复杂性 921-924
multilayer feedforward 多层前馈 841-924
perceptrons for -的感知机 905-907.908-911 training (leaning) process for 的训练(学习)处理 904-924
training puttens 训练模式 904
N-largest coding 最大N编码 599
Noise 噪声 75.80.161
bipolar 双极338
color images in -中的彩色图像 473
data-drop-out 数据清除 338
Erang 爱尔兰-337
exponenial 指数- 338
gamma 伽马- 337
Gaussian 高斯98.336
impulse 脉冲- 178.338
models -模型 335
parameterestimution -参数估计 341
periodic 周期- 319.340-341.357
power spectrum 功率讲-375
probability density functions(PDF) 概率密度函数 336-341
Rayleigh 瑞利 336
reduction 降低 见Fihering
sal-andpepper 椒盐～ 178.338
sparial and froquenxy proprtiesof ~的空间和顿率属性 335-336
spike -尖峰 338
umiform 均匀- 338 unipolar 单极- 338
white 白- 335,376,530.742.806
Noiseless coding theorem 无噪声编码理论 555
Nonlinear 非线性
filtering -滤波 167.174.178.187,347.352,892
operation ~操作 95-96.124
Nonseparable classes 不可分类 909-911
Noch filters 陷波滤波器 见Frequeney domain filhering
Null set 空集 102
Nyquist rate 奈奎斯特率 见Sampling
0
Object recognition 对象识别 见Pattens,Recognition
Opening 开操作 见Morphological image prcesing
Opsicalillusions 错觉 64-65
Order-statisticfilters 统计排序滤波器 见Spurial filers
Ordered pairs product 顺序对积 见Cantesian
Orthonormuality 归一化正交 493
OLsu's method Osu方法 见Threshold.Thresholding
P
Parallel-beam filtered buckprojctions 平行射线束滤波反投影
397-403
Panalleldistrbuted processing(PDP) modkes 并行分布处理模型 904
Pattems 模式 883-931
back propagation and 反向传播与 914-921
class structureof -类结构 883-887
classifiers -分类器 888-891,894-904
decision surfaces and 决策面和-921-924
discriminant (decision) analysis for -的判别(决策)分析
884-885,887
Gaussian class 高斯类~896-904
linearly separable classes 线性可分类- 908-909
matching -匹配 888-894.925-928
multiclassrecognition 多类识别- 911-924
neuralnetworks and 神经网络与~904-924
nonseparable classes 不可分类- 909-911
索引 629
objcctrecognitionand 对象识别与 883-924
perceptrons and 感知与- 905-907.908-841
recognition and 识别与883-931
training (earning) -训练(学习)904-924
vector generation for 的向量生成 884-886
PDF 概率密度函数 560,563,585
Pel 像素 见Pirel
parameter esimation -参数估计 341
Rayleigh 瑞利~ 336
sal-and-peppr 椒盐- 178.338
uniform 均匀- 338
Probability mass function(PMF)概率质量函数 567
Probability models 概率模型 572-573
Percentile 百分比 179.348-349.773
Perceptrons 感知机 905-907.908-841
Perfect rconstruction filters 完关重建滤波器 492-493
Periodic impulses 周期冲激 见bupulse train
Projctions,imagereconstruction from 投影，图像重建形式 384 409
Pruning 截剪 见Morphological image processing
Phase angle 相角 见Fowrier trangform,Discrete Fourier transfom
Photoconverter 光电转换器 69
Photodiode 光电二极管 70
Photons 光子 29.67
Photopic vision 白昼(亮)视觉 59
Piocewise-linear transformation fiuntions 分段线性变换函数 137-141
Pixel 像素
adjacency of -邻接 90
arrayoperations -的阵列操作 91
connected 连通- 91
definition -的定义 24.78
distanceberween -间的距离 93
interpolation -内插 见lnterpolation
neighborhood operations filtering 邻域操作滤波 107-109 见
Spatial
neighbors of 的邻域 90
path -路径 91
per unit distance 每单位距离-81
relationships berween-间的关系 90
single operation -的单个操作 107
transformation -的变换 见Intensity trangformations
PNG compression PNG压缩 560,563,573
Poimt detection 点检测 见Segmeuarion
Point processing 点处理 128-129
Point spread funetion 点扩散函数 367
Polygonal approximation 多边形近似 823-829,829-830
merging techniques -聚合技术 829-830
minimum-perimeter polygons(MPP) 最小周长多边形 823-829
splittingtechniques -分裂技术 830
Positron emission tomography(PET)正电子发射断层术 31.72.
112.315,390.410
Power-law(gamma)transfonmations 幂律(伽马)变换 132-137
Power spectrum 功率谱 267,375
Predictionerors 预测误差 606
Predictionrsiduals 预测残差 610
motioncompensated 运动补偿- 611-617
pyramid 一金字塔 486.488
Predictivecoding 预测编码 606-625
delta modulation (DM)德尔塔(增量)调制 619-620
dfferenial pube code modulation(DPCM)差分脉冲编码调制
621-624
lossless 无损~ 606-611
lossy 有损- 618-621
motion compensationand 运动补偿和~611-618
optimal predictors for -的最佳预测器621-624
optimal quantization in-中的最佳量化624-625
prediction emr for -的预测误差 606-607.621-624
Predictive frames(P-frames) 预测帧(P帧)612
Previous pixel predictor 前像素预测器 608
Prewit gradient operators Prewin 梯度算子 见Spatial filters
Probability density function(PDF) 概率密度函数 145-147,336-
341.895-904
Eriang 爱尔兰-337
exponential 指数- 338
gamma 伽马- 337
Gaussian 高斯- 98.336,897
impulse 冲激 178,338
Pseudocolor image processing 伪彩色图像处理 416,436 446
intensity slicing for -的灰度分层 437-440
intensity-to color transformations 灰度至彩色变换 440-443
monochrome images and 单色图像和一 444-446
transformations of 的变换 436-446
Q
Q-coder Q编码器 572
Quantization 量化 74-90,553,559-560,618-620,624-625,629
见Sampling dead zone -死区 629
intensity resolution and 灰度分辨率和 81-87
interpolation and 内插和~ 87-90
Lloyd-Max quantizer 劳埃德马克斯量化器625
mapping and 映射和- 553.559-560
opimal最佳-624-625
predictivecoding and 预测编码和-618-620,624-625
wavelet coding design of -的小波编码设计 629
Quicktime 一种压缩格式 560,563
R
Radiance,chromatic light and 辐射、色光和-67,418
Radio band 无线电波段 29.42.66.301
Ram-Lak filter Ram-Lak滤波器 398
Random fields 随机场 120
Radon transfom 随机变换 388.390-395
Ramp edges Ramp 达缘 见Edges
Rayleigh noise 瑞利噪声 见Noise
Recognition 识别 49-50.883-931
Bayes classifier 贝叶斯分类器- 894-904
classifiersfor -的分类器 888-891.894-904 correlation 相关- 891-885
correlation coefficicnt 相关系数- 892-894
decision-theoretic methods for -的决策理论方法 888-924
dixcriminan analysis 判别分析- 884
feature selection 特征选取~ 885
leaming -学习883
matching and 匹配和-888-894.925-928
minimum-distance 最小距离-888
neural networks for -的神经网络 904-924
opimum classifiers 最佳分类器~894-896
pattems 模式- 883-924
shupenumber matching 形状数匹配-925-926
string matching 字符串匹配-926-928
structural methods for 的结构方法 925-928
Reconstruction 重建 239.241-242.384-409,678-686,699-702
backprojection 反投影- 385-387.397-403,403-409
computed tomography (CT)计算机断层-387-390
fan-beam filtered backprojections 扇形射线束滤波后的反投
影 403-409
filters 滤波器- 239
Fourier-slice theorem for ~的傅里叶切片定理 396-397
function,recovery of a 函数，-的恢复 241-242
gray-scalemophological 灰度形态学699-702
image restoration by -图像复原 384-409
laminogram 层图- 395
morphological 形态学-678-686,699-702
parallel-beam filtered 平行射线束滤波 backprojections 反投影 397-403
projections,from 投影，来自- 384 409
630 数字图像处理(第三版)
Radon transform for -的雷登变换 390-395
Ram-Lak filter Ram-Lak 滤波器- 398
Shepp-Logan phantom Shepp-Logan幻影- 394
sinogram 正弦图 393
Redundancy 冗余 548-552
coding 编码- 549.550-551
relative data 相对数据- 548-549
spatial 空间- 549.551-552
temporal 时间549,551-552
Reference images 参考图像 111-113,800-804,806
Refinemen equation 细化方程 504
Reflectance 反射 67,73-74,311-315,762-763
Region 区域
definition 的定义 91
growing -生长 见Region-based segmentation
of interest(ROD 感兴趣-100.633.665,677.790
quadregions 1/4- 789
spliting -分裂 见Region-based segmentation
descriptors -描绘子 见Descriprion
Region-based segmentation 基于区域的分割 785-791
merging regions 聚合区域 788-791
region growing 区域生长 785-788
splitingregions 分裂区域 788-791
Regional descriptors 区域描绘子 844-864
area 区域 844
cirularity atio for -的圆度率 844-845
compactness and 致密性和-844-845
contrast -对比 854-856
corelation -相关 854-856
entropy -的熵 854-856
Euler number 欧拉数 847
gray-kevel co-occurrence matrix 灰度级共生矩阵 852
homogeneity 同质性 854-856
maximum probability 最大概率 854-8S6
moment invariants for 的矩不变 861-864
perimeter 周长 844
principal components 主分量 864
relational descriptors 关系描绘子 874
texture content of -的纹理内容 849-861
topological 拓扑 845-849 uniformity 均匀性，一致性 854-856
Registration,image 配准，图像 97,111.801,864
Relative Element AddressDesignate(READ)coding 相对元素寻址
设计编码 578
Remote sensing 遥感 36-37,548.893,901
Representation 表示 49.817-882
boundary (border)following 边界(边界)追踪- 818-820
boundary segments for -的边界分段 832-834
chain codes for -的链编码 820-823
descripion and 描述和- 817-882
polygonulapproximation 多边形近似- 823-829,829-830
signatures for -的标记图 830-832
skeletons -的骨架 834-837
Resampling 重取样 见Image resampling
Reseau marks 网状标记 112
Restoration 复原 48,333-415
blind deconvolution 盲去卷积- 368
constrained keast squares fihering 约束最小二乘方滤波- 379
383
deconvolution 去卷积- 368
degradation functions,estimation 退化函数，估计 368-373
degrasdation of an image 一幅图像的退化 333.334-335,365-
368,368-373
frequency domain filtering for -的频率域滤波
noise reduction 降噪 357-365
geometricmean filter 几何均值滤波器 383-384
inverse filtering 逆滤波 373-374
least square eror filter 最小平方误差滤波器 375
linear.positive-invariant 线性-,位置不变-
degradations 退化 365-368
minimum mean sure enorfihering 最小均方误差滤波 374-379
noise models for 的噪声模型 335-343
noise reduction and 降噪和 344-357,357-365
parametrie Wiener filer 参数维纳滤波器 384
reconstruction -的重建 见Recomstruction
spatial fihering for noise 噪声的空间滤波
reduction 降低- 344-357
spectrum eyualization filter 谱均衡滤波器 384
Wicner filtering 维纳滤波器 374-379
RGB color models RGB彩色模型 423-424,424-428.432-435.
467-469
conversion from HSI format 从HIS格式至RGB格式的转换
433-435
conversion to HSI format 从RGB格式至HS格式的转换 432-433
cube concept of -的立方体概念 424-428
safe colors 稳定色 426-428
segmentation and 分割和- 467-469
Rice codes 菜斯编码 567
Robert crss-gradient operators 罗伯特交又梯度算子 188-189.
730-730
Robust invisible watermarks 鲁棒不可见水印 639
Roof edges 屋顶边缘 715.723-724
Root-mean-square (ms)error 均方根误差 376,556-558
Rubber-sheet transformations 橡皮膜变换 109-114
Run-length coding(RLE)行程编码 552.575-581
Run-length pairs 行程对 552,575
s
Safe colors 稳定色 426-428
Sal-and-epper noie 椒盐噪声 见Noie Sampling 取样 74-90.233-242.245-246.249-257 见
Qwantisation
aliasing -混淆 见Aliasing
busic concepts of-的基本概念 74-76
decimation -抽取 253
Fourier transform and 傅里叶变换和-233-242,249-257
intensity resolution -灰度分辨率 81-87
interpolation and 内插和- 87-90.252-255
intervals -间隔 245-246
jaggies -锯齿 254
moiré pattemsfrom -导致的莫尔模式 255-257
Nyquist rate 奈奎斯特率 237-238
one-variable functions 单变量函数 233-242
reconstruction (recovery)重建(恢复) 241-242,252-255
representing digital images by 由-表示数字图像 77-81
sensor aringement and 传感器排列和- 76
spatial coordinates (x.y and 空间坐标(x,y)和-74-90
spatial resolution 空间分辨率 81-87
super-sampling 超取样 253
theorem -定理 235-239.249-250
two-variable(2-D)functions 二变量(二维)函数 249-257
Saturation 饱和度 80,320-421
Scaling 尺度变换
geometric 几何 见Geometric trunsgformations
intensity 灰度- 101-102
Scaling functions 尺度函数 499,501-505,523-524
coefficients of -的系数 504
Haar 哈尔-502
separable 2D 可分二维-523
Scaling vectors 尺度向量 504
Scanning electronmicroscope(SEM)扫描电子显微镜 45.137.
164,278
Scotopie vision 略视觉 59
Segmentation 分剂 711-816
color 彩色~ 465-472
索引
definition 的定义 712
edge based 基于边缘的 见Edge detection
foundation 基础 712-717
generaing -生成 173
gcometric mean 几何平均- 345
gradient -梯度 187
frequency-based 基于频率的-804-807
line detection 线检测 719
motion and 运动和- 800-807
point detction 点检测 718
region growing 区域生长 见Regiom-based segmenation
texture based 基于-的纹理 791
hresholding阈值处理 见Threshokding
watersheds 分水岭 见Watersheds
harmonic mean 调和平均- 345
highboost 高提升- 184
isotropic 各向同性- 182
Laplacian 拉普拉斯~ 182-185
lowpass 低通- 174 max 最大- 179.348
median 中值- 178,348
midpoint 中点- 349
Sensors 传感器 50.68-74.76
acquisition and 获取与68-74 arays -阵列 72.76
cooling 冷却~ 3
image formation modelfor -的图像形成模型 73-74 imaging compsnent for -成像分量 50
sampling and quanization using 使用-取样和量化 76
single 单70
strips -条带 70-72.76
min 最小- 179.348
order statistic 统计排序- 178-179.347
Roberts 罗伯特- 189
sharpening(尖)锐化- 179-190
smoothing 平滑- 174-179.344
Sobel Sobel 189
Scquential bascline system 顺序基线系统 602
Series expansions 级数展开 499-501.508-510
unshap mask 非锐化模板- 184
vector represenuation-向量表示 172
weighted average 加权平均- 175
Sputial filtering 空间滤波 126-220,344-357
Setoperations 集合操作(运算)102-105.106-107,650-652,652- 657.657-661 见Fuzy sets
hasics of 的基础 102-105
closing的开操作 657-391
crisp 干脆 106
dilation -膨胀 655-657
erosion -腐蚀652-655.657
fuzzy concept of -的模糊概念 106-107.195-213
morphological image processing and 形态学图像处理和
650-652.652-657.657-661
opening 开操作 657-661,690-692
Shading corection 阴影校正 100-101,605.763.783
Shannon's first theorem 山农第一定理 555-556
Shapenumbers 形状数 838-839.925-926
Shurpening(尖)锐化 见Fitering
Shepp Logan phantom Shepp-Logan幻影 394
Shrinking 缩小 见Image resampling
Sifting propery 取样特性 见Impulse
Signal-10-noise(SNR)ratios 信哚比 376,557
Signatures 标记图 830-832
Simultaneous contrast 同时对比63-64
Single-pixeloperations 单像素操作 107
Skeletons 骨架 673-676.834-837
Slope overlod 斜率过载 620
Smoothing 平滑 见Fitering
SMPTE 活动图像和电视工程师协会 560
Sobel gradient operaos Sobel 梯度算子 见Spatialfilers
Software for imaging 图像处理软件 51-52
Spatial coordinates 空间坐标 23.77
Spatial domain 空间域
convolution -卷积 见Comoluiom
correlation 相关 见Correlarion
definition 的定义 77 image transform difference 图像变换差 115-116
filtering -滤波 见Sputial filering frequency domain 频率域与
correspondence -对应 285
operations 一操作 107-114
Spatial filers 空间滤波器 见Sparial fitering
adapive local 自适应局部 352-354
adaptive median 自适应中值- 354-357 alpha-itrimmed 修正的阿尔法 349
arithmetic mean 算术平均 344
averaging 平均- 174
contraharmonic mean 反调和平均。 345
defined ~的定义 128
631
adaptive local 自适应局部一 352-354
adapive median 自适应中值- 354-357
convolution and 卷积和- 168-172
correlation and 相关和- 168-172
detined -的定义 128
enhancement methods combined 组合-的增强方法 191-195
fundamentas of~的基础 166-174
fuzzy techniques for -模糊技术 195-213
linear 线性- 167-177
masks 模板 见Sparial filhers
mechanics of -的机理 167
noise reduction by 降噪 344-357
nonlincar 非线性- 167.177-179,344-357
order-statistic 统计排序- 177-179.347
sharpening(尖)锐化- 179-190 smoothing 平滑- 174-179
vector representation of -的向量表示 172-173
Spatial operations 空间操作 107-114
Spatial redundaney 空间冗余 549,551-552 Spatial resolution 空间分辨率 81-87
Spatial techniques for motion in segmentation 分割中运动的空间技
术 800-804
Spatial variables 空间变量 77
Spectrum 谱 见Fourier transform.Disrete Fourier trangfom
Standard definition(SD)television 标准清晰度电视 547-548
Standards for image compression 图像压缩标准 560-562,563
Statistical moments 统计矩 见Moments
Stochastic image processing 随机图像处理 120
Storage capuciry forimaging 成像的存储容量 52
String descipions 串描述 886-887,926-928
Subband coding 子带编码 488-495
Subjcctive brightness 主观亮度 61
Subsampling pyramids 子取样金字塔 486
Subspace analysis trees 子空间分析树 533
Successive doubling 逐次加倍 322
Sum of absolutedistortions(SAD)绝对失真之和 612
Supeposition integral 超位置积分 367
Super-sampling 超取样 253
Symbol coders 符号编码器 559
Symbol-based coding 基于符号的编码 581-584
Symlets 对称小波 527-529
Synthesis filher banks 综合滤波器组 492,521-522,525-526 Synthetic imaging 合成成像 46-47
T
Temporal redundancy 空间冗余 549.551-552
632 数宇图像处理(第三版)
Texure 纹理 697-698.791,849-861 trangfomarions
cooccurrence matrix for -的共生矩阵 852-858 descripion by -描述 849-861
gray-scale morphology and 灰度形态学和-697-698
intensity histogram for -的灰度直方图 850-852
segmentation-分割 697-698,791
spectral approuches to -的谱方法 859-861
statisticalapproaches for -的统计方法 850-858
structural approuches for ~的结构方法 858-859
Thematic bands 热波段 36
Thickening 粗化 见Morphological image preesing
Thinning 细化 见Morphological image processing
Threshold 阈值(处理)见Thresholding
basic -基础 129.760.763
Bayes 贝叶斯- 764,897.903-904
coding -编码 597-601
color -彩色 467
combined with blurring -与模糊相组合 191
combined with gradient -与梯度相组合 735,771
combined with Laplacian -与拉普拉斯相组合 772
global 全局- 763
hysteresis 滞后744.776
local 局部 780-783 optimum 最佳- 764
Otsu Osu-695.764,774
multiple 多~ 744.761,774-778
multivariable 多变量- 467,783-785
variable 可变-778
Thresholding 阀值处理 129.137,530,599-601.735-736,760-785
basics -基础 760
Bayes 贝叶斯~ 764,897,903-904
coding implementation编码实现 599-601
edges using in-中使用的边缘 771
function 函数 129.137
global 全局- 760.763-778
gradients,combined wih -梯度，与-的组合 735-736
hard 硬- 530
illumination and 照度和- 762-763
intensity 灰度 760-761
Laplacian,combined with 拉普拉斯，与-相组合 772
local 局部- 780-783
measure of sepurability 可分离性度量-767
moving averages 移动平均- 781
muliple threshoks 多阀值- 774
multivariabke 多变量 467,783-785
noise in -中的噪声 761-762
object point for -的目标点 760 optimum 最佳- 764
Osu Otsu-695.764.774
reflectance and 反射和762-763 segmentation and 分制和- 760-785
smoothing in -中的平滑 769
soft 软- 530
variable -变量 760.778-785
Tie(control) points 约束(控制)点 112
TIFF 一种图像压缩格式 560.563.573
Tight frame 紧框架 501
Tiling images 贴瓷砖图像 46.523
Time-frequencytiles (or plane)时间-频率片(或平面) 522-523
Tokens 标记 582
Top-hat transformation 顶帽变换 694-696
Top-hatby reconstruction 顶帽重建 699
Topologicaldesriptors 拓扑描绘子 845-849
Transformation 变换 109-114,126-220,662-663,694-696
Affine 仿射- 109-111
bottom-hat 底帽- 694-696
domains in -中的域 126
geometric (ubber-sheet) 几何(橡皮膜)见Geometric
gray-scale mophology and 灰度级形态学和-694-696
hit-or-miss 击中或击不中- 662-663
intensity 灰度- 126-220
kemels -核 117
morphological image processing and 形态学图像处理和- 662-663
rubber sheet 橡皮膜- 109.845
spatial 空间~ 107.127-193
top-ha 顶帽- 694-696
top-hat by reconstruction 顶帽重建 699
Transforms 变换 115-118,126,388,390-395.496-499.508-515.
523-532,588-606
block transform coding 块变换编码 588-606
discrete cosine 离散余弦- 591
domains in -中的域 115-116.126 discrete cosine 离散余弦- 118,561,591
discrete Kathunen-Loeve 离散Karhunen-Loeve~ 867
Fourier 傅里叶 见Fourier tmanyform
Haar 哈尔~ 118.496-499
Hoteling 霍特林867-874
Hough 霍夫-见Hough tranyfom
image(2-Dlinecar)图像(二维线性)115-118
morphological 形态学- 见Mophological image processing
pair -对 116
principnl components 主分量- 864-874
Radon 雷登- 388,390-395
selection of for block transform 为块变换选取的 coding-编码 589-595
slant 斜~ 118
Walsh-Hadanard 沃尔什-哈达玛- 118.590
wavelet 小波- 508-515,523-532 见Waelets
Transmission clectron microscope(TEM) 发射电子显微镜 45
Trichromatic coefficients 三色系数 421
U
Ulra large scale integration(ULSD 超大规模集成 27
Utrasound imaging 超声波成像 42.68,390.410
Ultraviolet 紫外线 29.33.59.66.67
Unary codes 一元编码 566
Unbiased estimate 无偏估计 163
Uniform 均匀 见Noise
Unit delays 单位延迟 488-489
Unit dicrete impulse 单位离散冲激 见Lmpule
Unit impulse 单位冲激 见Impudse
Units of measurement 单位度量 66,67.80-82
bits forimage storage 图像存储的比特 80-82 clectromagnetic(EM) spectrum 电磁波谱 66,67
intensity resolution 灰度分辨率 81-82
spatial resolution 空间分辨率 81
Unsharp masking 非锐化模板 184-187,310-311
Upsampling 上采(取)样 486-487
v
Variable thesholding 可变阈值处理 见Threshoding
Variable-length code 变长编码 551,564-566
Variance of intensity 灰度的方差 见Moments
VC-1 compression VC-1压缩 560.563.616
Vector opernations 向量操作 114-115.172-173,446-448
full color image processing 全彩色图像处理- 446-448
matrix operations and 矩阵操作和 114-115
spatial filtering 空间滤波- 172-173
Very large scaleintegration(VLSD 甚大规模集成电路 27
Visible band of the EM spectnum 电磁波谱的可见波段 34-40.66-67
Visible watermarks 可见水印 637
Vision 视觉 见Visual perception
human 人类 58-65,418,740,800
machine 机器-24-25.28,928
索引 633
Visual perception 视觉感知 58-65,417-423
absorption of light 光的吸收 418-419
brightness adaptation 亮度适应 61-65
separable 2D 可分二维- 524
time-frequeney characterisics -的时间-频率特性 522-523
Wavelet vectors 小波向量 506
colorimage processing and 彩色图像处理和417-423
discrimination between changes 变化间的分辨- 58-65r
humaneye physicalstructure 人眼的自然结构 58-60
image formation in eye 眼中的图像形成 60-61
Mach bands 马赫带 63,64
optical illusions 错觉 64-65
simultancous contrast 同时对比63-64
subjective brightness 主观亮度 61-62
Weber ratio 韦伯比62-63
Wavelet packets 小波包 532-541
binary treerepresentation -的二又树表示 532-540
cost functions for choosing 选择~的代价函数 537-540
subspace analysis tree -的子空间分析树 533
Wavelets 小波 49.483-546
compression -压缩 626-629
continuous wavelet transform(CWT)连续小波变换 513-515
discrete wavelet transform(DWT)离散小波变换 510-512,524
edge detection 边缘检测 529-530
fast wavelettransform(FWT)快速小波变换 515-523,524
w 527,532-541
Walsh-Hadumardtransform(WHT)活尔什哈达玛变换 590-591
Watermarking digital images 水印数字图像 636-643
block diagram for -的方框图639
reasons for -的原因 636
Watermarks 水印636-643
attacks on 对-的攻击 642-643
fragile invisible 脆弱不可见639
insertion and extraction -插入和提取 637-638,640-642
invisible watermak 不可见638
private (orrestricted key)私钥(或受限密钥)-639
public (or unrestrictedkey)公钥(或不受限密钥)-639
robust invisible 鲁棒不可见-639
visible watermark 可见-637
Watersheds(morphological)分水岭(形态学)791-800
algorithmfor -算法 796-798
damconstructionfor -水坝构建 794-796
knowledge incorporation in -中的知识合并 791
markers usedfor -使用的标记 798-800
segmentation using 使用-的分制 791-800
Wavelet coding 小波编码 626-636
decomposition level selection -的分解级数选取 628-629
JPEG-2000 compression JPEG-2000压缩 629-636
quantizer design for -的量化器设计 629
selection of wavelets for 小波的选取 626-628
Waveletfunctions 小波函数 S05
coefficients of 的系数 506
Haar 哈尔 506-507
functions -函数 505-508
JPEG-2000 一种压缩格式 629-635
Mexican hat 墨西哥草帽- 514-515
multiresolution processingand 多分辨率处理 483-546
noise removal 噪声消除 530-532
one-dimensional transforms 一维-变换 508-515
packets -包 532-541
series expunsions -级数展开 508-510
transforms -变换 508-515.523-532
two-dimensionaltransforns -二维变换 523-532
Weber ratio 韦伯比 62-63
Weighting function 加权函数，363
Wnite noise 白噪声 见Noise
Wiener iltering 维纳滤波 374-379
WMV9 compression WMV9压缩 560,563.616
X
X-ays X射线 31,137.179,311,346,384,385,387,439.442.668.
689,693,719,753.786,790
z
Zero crossing property 零交又特性 182.725.736-739
Zero-memory source 零记忆信源 554
Zero-phase-shift filters 零相移滤波器 284,316
Zonalcoding implementation 区域编码实现 598-599
Zooming 缩放 见/mage zoming
[General Information]
书名=数字图像处理
作者=（美）冈萨雷斯，（美）伍兹著
页数=633
出版社=北京市：电子工业出版社
出版日期=2011.05
SS号=12815534
DX号=000008105162
[ G e n e r a 1I n f o r m a t i o n I
书名= 数字图像处理
作者=(美)冈萨雷斯，(美)伍兹著
页数= 633
出版社= 北京市：电子工业出版社
出版日期= 2 O 1 1 .O 5
S S 号= 1 2 81 5 5 34
D X 号= o o o(O 81 O 51 6 2