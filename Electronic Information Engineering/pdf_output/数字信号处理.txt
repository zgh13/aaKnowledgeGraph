Catalo目 录
绪论…………………………………………………………………………………………1
第1章 时域离散信号和时域离散系统 ……………………………………………………4
1.1 引言………………………………………………………………4
1.2 时域离散信号…………………………………………………………………………………………5
1.2.1 常用的典型序列…………………………………………………………………………………7
1.2.2 序列的运算 ……………………………………………………………………………………10
1.3 时域离散系统………………………………………………………………………………………11
1.3.1 线性系统 ………………………………………………………………………………………12
1.3.2 时不变系统………………………………………………………………………………………12
1.3.3 线性时不变系统及其输入与输出之间的关系……………………………………………………13
1.3.4 系统的因果性和稳定性 ……………………………………………………………………………18
1.4 时域离散系统的输入输出描述法——线性常系数差分方程………………………………………21
1.4.1 线性常系数差分方程 ……………………………………………………………………………21
1.4.2 线性常系数差分方程的求解………………………………………………………………………21
1.5 模拟信号数字处理方法 …………………………………………………………………………………24
1.5.1 采样定理及A/D变换…………………………………………………………………………24
1.5.2 将数字信号转换成模拟信号 ………………………………………………………………………28
1.6 确定性信号的相关函数…………………………………………………………………………………32
1.6.1 信号的互相关函数和自相关函数…………………………………………………………………32
1.6.2 周期信号的相关性………………………………………………………………………………35
1.6.3 相关函数的性质 ……………………………………………………………………………………36
1.6.4 输入信号与输出信号的相关函数…………………………………………………………………38
1.6.5 相关函数的应用………………………………………………………………………………38
1.6.6 用MATLAB计算相关函数 ……………………………………………………………………41
习题与上机题…………………………………………………………………………………………43
第2章 时域离散信号和系统的频域分析……………………………………………………48
2.1 引言 ………………………………………………………………………………………………………………48
2.2 时域离散信号的傅里叶变换的定义及性质……………………………………………………………48
2.2.1 时域离散信号傅里叶变换的定义 ………………………………………………………………48
—1—
Created by ZhuangHeng
2.2.2 时域离散信号傅里叶变换的性质………………………………………………………………50
2.3 周期序列的离散傅里叶级数及傅里叶变换表示式 …………………………………………………56
2.3.1 周期序列的离散傅里叶级数……………………………………………………………………56
2.3.2 周期序列的傅里叶变换表示式………………………………………………58
2.4 时域离散信号的傅里叶变换与模拟信号傅里叶变换之间的关系…………………………………61
2.5 序列的Z变换………………………………………………………………………………………62
2.5.1 Z变换的定义 ……………………………………………………………………………………62
2.5.2 序列特性对收敛域的影响…………………………………………………………………………64
2.5.3 逆Z变换………………………………………………………………………………66
2.5.4 Z变换的性质和定理 ………………………………………………………………………………71
2.5.5 利用Z变换解差分方程…………………………………………………………………………77
2.6 利用Z变换分析信号和系统的频响特性……………………………………………………………78
2.6.1 频率响应函数与系统函数…………………………………………………………………………79
2.6.2 利用系统函数的极点分布分析系统的因果性和稳定性 ………………………………………80
2.6.3 利用系统的极零点分布分析系统的频率响应特性………………………………………………82
2.6.4 几种特殊系统的系统函数及其特点 ………………………………………………………………86
习题与上机题…………………………………………………………………………………90
第3章 离散傅里叶变换(DFT)……………………………………………………………95
3.1 离散傅里叶变换的定义及物理意义 ……………………………………………………………………95
3.1.1 DFT的定义……………………………………………………………………………………95
3.1.2 DFT与傅里叶变换和Z变换的关系………………………………………………………………96
3.1.3 DFT的隐含周期性…………………………………………………………………………………97
3.1.4 用MATLAB计算序列的DFT …………………………………………………………………99
3.2 离散傅里叶变换的基本性质………………………………………………………………………100
3.2.1 线性性质……………………………………………………………100
3.2.2 循环移位性质………………………………………………………100
3.2.3 循环卷积定理…………………………………………………………………………102
3.2.4 复共轭序列的DFT …………………………………………………………………………105
3.2.5 DFT的共轭对称性……………………………………………………………………………105
3.3 频率域采样……………………………………………………………………………………108
3.4 DFT的应用举例 ………………………………………………………………………………………111
3.4.1 用DFT计算线性卷积 ……………………………………………………………………111
3.4.2 用DFT对信号进行谱分析 ……………………………………………………………………117
习题与上机题……………………………………………………………………………………………128
第4章 快速傅里叶变换(FFT)……………………………………………………………133
4.1 引言…………………………………………………………………………133
4.2 基2FFT算法……………………………………………………………………………………133
4.2.1 直接计算DFT的特点及减少运算量的基本途径………………………………………………133
—2—
Created by ZhuangHeng
4.2.2 时域抽取法基2FFT基本原理…………………………………………………………………134
4.2.3 DIT-FFT算法与直接计算DFT运算量的比较……………………………………………137
4.2.4 DIT-FFT的运算规律及编程思想………………………………………………………138
4.2.5 频域抽取法FFT(DIF-FFT)…………………………………………………………………142
4.2.6 IDFT的高效算法 ………………………………………………………………………………………145
4.3 进一步减少运算量的措施…………………………………………………………………………145
4.3.1 多类蝶形单元运算………………………………………………………………145
4.3.2 旋转因子的生成…………………………………………………147
4.3.3 实序列的FFT算法…………………………………………………………………………147
4.4 其他快速算法简介…………………………………………………………………………………148
习题与上机题……………………………………………………………………………………………150
第5章 时域离散系统的网络结构…………………………………………………………151
5.1 引言……………………………………………………………………………151
5.2 用信号流图表示网络结构……………………………………………………………………152
5.3 IIR系统的基本网络结构…………………………………………………………………………154
5.4 FIR系统的基本网络结构………………………………………………………………………………159
5.5 FIR系统的线性相位结构………………………………………………………………………………160
5.6 FIR系统的频率采样结构………………………………………………………………………………161
5.7 格型网络结构………………………………………………………………………………………164
5.7.1 全零点格型网络结构…………………………………………………164
5.7.2 全极点格型网络结构……………………………………………………………167
习题与上机题………………………………………………………………………………………………171
第6章 无限脉冲响应数字滤波器的设计 …………………………………………………175
6.1 数字滤波器的基本概念……………………………………………………………………………175
6.2 模拟滤波器的设计…………………………………………………………………………………179
6.2.1 模拟低通滤波器的设计指标及逼近方法……………………………………………………180
6.2.2 巴特沃斯低通滤波器的设计…………………………………………………………………182
6.2.3 切比雪夫滤波器的设计………………………………………………………………………189
6.2.4 椭圆滤波器的设计………………………………………………………………………196
6.2.5 五种类型模拟滤波器的比较…………………………………………………………………198
6.2.6 频率变换与模拟高通、带通、带阻滤波器的设计……………………………………………198
6.3 用脉冲响应不变法设计IIR数字低通滤波器…………………………………………………………206
6.4 用双线性变换法设计IIR 数字低通滤波器…………………………………………………213
6.5 数字高通、带通和带阻滤波器的设计………………………………………………………………219
习题与上机题……………………………………………………………………………………………223
第7章 有限脉冲响应数字滤波器的设计 …………………………………………………226
7.1 线性相位FIR数字滤波器的条件和特点…………………………………………………………226
7.2 利用窗函数法设计FIR滤波器 ………………………………………………………………………232
—3—
Created by ZhuangHeng
7.2.1 窗函数法设计原理………………………………………………………………………232
7.2.2 典型窗函数介绍…………………………………………………………………………237
7.2.3 用窗函数法设计FIR 滤波器的步骤 …………………………………………………………242
7.2.4 窗函数法的MATLAB设计函数简介………………………………………………………244
7.3 利用频率采样法设计FIR 滤波器……………………………………………………………………248
7.4 利用等波纹最佳逼近法设计FIR数字滤波器 ………………………………………………………254
7.4.1 等波纹最佳逼近法的基本思想……………………………………………………………………255
7.4.2 remez和 remezord 函数及滤波器设计指标………………………………………………………257
7.5 IIR和FIR数字滤波器的比较………………………………………………………………………261
7.6 几种特殊类型滤波器简介………………………………………………………………………………262
7.7 滤波器分析设计工具FDATool ……………………………………………………………………263
习题与上机题……………………………………………………………………………………………267
第8章 多采样率数字信号处理……………………………………………………………272
8.1 引言……………………………………………………………………………………272
8.2 信号的整数倍抽取…………………………………………………………………………………273
8.3 信号的整数倍内插……………………………………………………………………………279
8.4 按有理数因子I/D的采样率转换…………………………………………………………………283
8.5 整数倍抽取和内插在数字语音系统中的应用……………………………………………………284
8.5.1 数字语音系统中的信号采样过程及其存在的问题……………………………………………285
8.5.2 数字语音系统中改进的A/D转换方案 …………………………………………………………286
8.5.3 接收端D/A转换的改进方案 ……………………………………………………………………287
8.6 采样率转换滤波器的高效实现方法……………………………………………………………………288
8.6.1 直接型 FIR滤波器结构 ………………………………………………………………………288
8.6.2 多相滤波器结构……………………………………………………………………………………292
8.7 采样率转换器的MATLAB实现…………………………………………………………………296
习题与上机题……………………………………………………………………………………………298
第9章 数字信号处理的实现 ………………………………………………………………300
9.1 数字信号处理中的量化效应…………………………………………………………………301
9.1.1 量化及量化误差……………………………………………………………………………………301
9.1.2 A/D变换器中的量化效应………………………………………………………………………302
9.1.3 数字系统中的系数量化效应…………………………………………………………………303
9.1.4 数字系统中的运算量化效应…………………………………………………………………308
9.2 数字信号处理技术的软件实现………………………………………………………………314
9.3 数字信号处理的硬件实现简介……………………………………………………………………318
第10章 上机实验………………………………………………………………321
10.1 实验一：系统响应及系统稳定性 ……………………………………………………………………321
10.2 实验二：时域采样与频域采样 ………………………………………………………………………323
10.3 实验三：用FFT对信号作频谱分析…………………………………………………………………326
—4—
Created by ZhuangHeng
10.4 实验四：IIR数字滤波器设计及软件实现……………………………………………………………327
10.5 实验五：FIR数字滤波器设计与软件实现 ………………………………………………………330
10.6 实验六：数字信号处理在双音多频拨号系统中的应用……………………………………………333
附录………………………………………………………………………………………339
附录A 用Masson公式求网络传输函数H(z)…………………………………………………………339
附录B MATLAB信号处理工具箱函数索引表……………………………………………………………340
参考文献 …………………………………………………………………………………………347
—5—
Created by ZhuangHeng
绪论
1.数字信号处理的基本概念
几乎在所有的工程技术领域中都会涉及信号处理问题，其信号表现形式有电、磁、机
械以及热、光、声等。信号处理一般包括数据采集以及对信号进行分析、变换、综合、估值
与识别等。这里的信号类别有4种：第1种是连续信号(即模拟信号),它的幅度和时间都
取连续变量；第2种是时域离散信号，其幅度取连续变量，而时间取离散值；第3种是幅度
离散信号，其时间变量取连续值，幅度取离散值，如振幅键控信号；第4种是数字信号，它
的幅度和时间都取离散值。一般来说，数字信号处理的对象是数字信号，模拟信号处理的
对象是模拟信号。但是，如果系统中增加数/模转换器和模/数转换器，那么,数字信号处理
系统也可以处理模拟信号。这里关键的问题是两种信号处理系统对信号处理的方式不同，
数字信号处理是采用数值计算的方法完成对信号的处理，而模拟信号处理则是通过一些模
拟器件(例如晶体管、运算放大器、电阻、电容、电感等)组成的网络来完成对信号的处理。
例如，图0.0.1(a)所示的是一个简单的模拟高通滤波器，它是由电阻R和电容C组成的，
而图0.0.1(b)所示的则是一个简单的数字滤波器，它是由一个加法器、一个乘法器和一个
延时器组成的。因此，简单地说，数字信号处理就是用数值计算的方法对信号进行处理，这
里“处理”的实质是“运算”,处理对象则包括模拟信号和数字信号。
绪
论
0
C x(n) y(n)
xa() R y?(0 a 延时
○ 0 ×
(a)简单的模拟高通滤波器 (b)简单的数字滤波器
图0.0.1 高通滤波器简型
2.数字信号处理的实现方法
数字信号处理的主要对象是数字信号，且是采用数值运算的方法达到处理目的的。因
1
Created by ZhuangHeng
口
数字信号处理(第五版)
2
此，其实现方法不同于模拟信号处理的实现方法。数字信号处理的实现方法基本上可以分
成两种，即软件实现方法和硬件实现方法。软件实现方法指的是按照原理和算法，自己编
写程序或者采用现成的程序在通用计算机上实现；硬件实现是按照具体的要求和算法，设
计硬件结构图，用乘法器、加法器、延时器、控制器、存储器以及输入输出接口等基本部件
实现的一种方法。显然，软件实现灵活，只要改变程序中的有关参数，例如只要改变图
0.0.1(b)中的参数a,数字滤波器可能就是低通、带通或高通滤波器，但是运算速度慢，一
般达不到实时处理，因此，这种方法适合于算法研究和仿真。硬件实现运算速度快，可以达
到实时处理要求，但是不灵活。
用单片机实现的方法属于软硬结合实现，现在单片机发展很快，功能也很强，配以数
字信号处理软件，既灵活，速度又比软件方法快。采用专用的数字信号处理芯片(DSP芯
片)是目前发展最快、应用最广的一种方法。因为DSP芯片比通用单片机有更为突出的优
点，它结合了数字信号处理的特点，内部配有乘法器和累加器，结构上采用了流水线工作
方式以及并行结构、多总线，且配有适合数字信号处理的指令，是一类可实现高速运算的
微处理器。DSP芯片已由最初的8位发展为16位、32位，且性能优良的高速DSP不断面
市，价格也在不断下降。可以说，用DSP芯片实现数字信号处理，正在变成或已经变成工
程技术领域中的主要实现方法。
综上所述，如果从数字信号处理的实际应用情况和发展考虑，数字信号处理的实现方
法分成软件实现和硬件实现两大类。而硬件实现指的是选用合适的DSP芯片，配有适合芯
片语言及任务要求的软件，实现某种信号处理功能的一种方法。这种系统无疑是一种最佳
的数字信号处理系统。对于更高速的实时系统，DSP的速度也不满足要求时，应采用可编
程超大规模器件或开发专用芯片来实现。
3.数字信号处理的特点
由于数字信号处理是用数值运算的方式实现对信号的处理的，因此，相对模拟信号处
理，数字信号处理主要有以下优点：
1)灵活性
数字信号处理系统(简称数字系统)的性能取决于系统参数，这些参数存储在存储器
中，很容易改变，因此系统的性能容易改变，甚至通过参数的改变，系统可以变成各种完全
不同的系统。灵活性还表现在数字系统可以时分复用，用一套数字系统分时处理几路信号。
数字系统可以实现智能系统的功能，可以根据环境条件、用户需求，自动选择最佳的处理
算法，例如，软件无线电等。软件无线电的基本思想就是：将宽带A/D变换器及D/A变换
器尽可能地靠近射频天线，建立一个具有“A/D-DSP-D/A”模型的通用的、开放的硬件平
台，在这个硬件平台上尽量利用软件技术来实现电台的各种功能模块。例如，通过可编程
数字滤波器对信道进行分离；使用数字信号处理器(DSP)技术，通过软件编程来实现通信
频段的选择以及完成传送信息抽样、量化、编码/解码、运算处理和变换等；通过软件编程
实现不同的信道调制方式的选择，如调幅、调频、单边带、跳频和扩频等；通过软件编程实
现不同的保密结构、网络协议和控制终端功能等。
Created by ZhuangHeng
2)高精度和高稳定性
数字系统的特性不易随使用条件变化而变化，尤其使用了超大规模集成的DSP芯片，
使设备简化，进一步提高了系统的稳定性和可靠性。运算位数又由8位提高到16、32位，
在计算精度方面，模拟系统是不能和数字系统相比拟的，为此，许多测量仪器为满足高精
度的要求只能采用数字系统。
3)便于大规模集成
数字部件具有高度的规范性，对电路元件参数要求不严，容易大规模集成和大规模生
产，价格不断降低，这也是DSP芯片和超大规模可编程器件发展迅速的主要因素之一。由
于采用了大规模集成电路，数字系统体积小、重量轻、可靠性强。
4)可以实现模拟系统无法实现的诸多功能
数字信号可以存储，数字系统可以进行各种复杂的变换和运算。这一优点更加使数字
信号处理不再仅仅限于对模拟系统的逼近，它可以实现模拟系统无法实现的诸多功能。例
如，电视系统中的画中画、多画面以及各种视频特技，包括画面压缩、画面放大、画面坐标
旋转、演员特技制作；变声变调的特殊的配音制作；解卷积；图像信号的压缩编码；高级加
密解密；数字滤波器严格的线性相位特性；等等。
4.数字信号处理涉及的理论、实现技术与应用
正是由于以上的优点，数字信号处理的理论和技术一出现就受到人们的极大关注，发
展非常迅速。国际上一般把1965年作为数字信号处理这一门新学科的开端，50多年以来，
这门学科基本上形成了自己一套完整的理论体系，其中也包括各种快速的和优良的算法。
而且随着各种电子技术及计算机技术的飞速发展，数字信号处理的理论和技术还在不断丰
富和完善，新的理论和新技术层出不穷。可以说，数字信号处理是发展最快、应用最广泛、
成效最显著的新学科之一，目前已广泛地应用在语音、雷达、声呐、地震、图像、通信、控
制、生物医学、遥感遥测、地质勘探、航空航天、故障检测、自动化仪表等领域。
绪
论
数字信号处理涉及的内容非常丰富广泛。其所应用的数学工具涉及微积分、随机过程、
高等代数、数值分析、复变函数、数值方法和各种变换(傅里叶变换，Z变换，离散傅里叶
变换，小波变换……)等；数字信号处理的理论基础包括网络理论、信号与系统、神经网络
等；数字信号处理的实现技术又涉及计算机、DSP技术、微电子技术、专用集成电路设计
和程序设计等方面；应用领域包括通信、雷达、人工智能、模式识别、航空航天、图像处理、
语音处理等。
由此可见，要从事数字信号处理理论研究和应用开发工作，需要学习的知识很多。本
书作为数字信号处理的基础教材，主要讲述数字信号处理的基本原理和基本分析方法，是
今后学习上述专门知识和技术的基础。
3
Created by ZhuangHeng
数字信号处理(第五版)
4
第1章
时域离散信号和时域离散系统
1.1 引 言
信号通常是一个自变量或几个自变量的函数。如果仅有一个自变量，则称为一维信号；
如果有两个以上的自变量，则称为多维信号。本书仅研究一维数字信号处理的理论与技术。
物理信号的自变量有多种，可以是时间、距离、温度、位置等，本书一般把信号看做时间的
函数。针对信号的自变量和函数值的取值情况，信号可分为以下三种。
如果信号的自变量和函数值都取连续值，则称这种信号为模拟信号或者称为时域连续
信号，例如语言信号、温度信号等；如果自变量取离散值，而函数值取连续值，则称这种信
号为时域离散信号，这种信号通常来源于对模拟信号的采样；如果信号的自变量和函数值
均取离散值，则称为数字信号。我们知道，计算机或者专用数字信号处理芯片的位数是有
限的，用它们分析与处理信号，信号的函数值必须用有限位的二进制编码表示，这样信号
本身的取值不再是连续的，而是离散值。这种用有限位二进制编码表示的时域离散信号就
是数字信号，因此，数字信号是幅度量化了的时域离散信号。
例如：x(t)=0.9 sin(50πt),这是一个模拟信号，如果将它按照时间采样间隔T=
0.005s进行等间隔采样，便得到时域离散信号r(n),即
x(n)=x(1)T=0.9 sin(50πnT)
={…,0.0,0.6364,0.9,0.6364,0.0,-0.6364,一0.9,-0.6364,…
显然，时域离散信号是时间离散化的模拟信号。如果用四位二进制数表示该时域离散信号，
便得到相应的数字信号x[n],即
x[n]=…,0.000,0.101,0.111,0.101,0.000,1.101,1.111,1.101,…
Created by ZhuangHeng
显然，数字信号是幅度、时间均离散化的模拟信号，或者说是幅度离散化的时域离散信号。
信号有模拟信号、时域离散信号和数字信号之分，按照系统的输入输出信号的类型，
系统也分为模拟系统、时域离散系统和数字系统。当然，也存在模拟网络和数字网络构成
的混合系统。
数字信号处理最终要处理的是数字信号，但为简单，在理论研究中一般研究时域离散
信号和系统。时域离散信号和数字信号之间的差别，仅在于数字信号存在量化误差，本书
将在第9章中专门分析实现中的量化误差问题。
本章作为全书的基础，主要学习时域离散信号的表示方法和典型信号、时域离散线性
时不变系统的时域分析方法，最后介绍模拟信号数字处理方法。
1.2 时域离散信号
实际中遇到的信号一般是模拟信号，对它进行等间隔采样便可以得到时域离散信号。
假设模拟信号为x。(t),在离散时间点t,对它进行采样，得到x。(t,),n为整数。x。(t)
是离散时间变量t的函数，仅在离散时间点t,上有意义，而在其他时间则没有定义。在实际
应用中，通常采样间隔为常数T,即t。=nT。这种采样称为等间隔采样(均匀采样),采样得
到的信号记为
x(n)=x。(1)|,=x(nT)0<n<0 (1.2.1)
这里，x(n)称为时域离散信号，式中的n取整数，将n=…,-2,-1,0,1,2,3,…代人
上式，得到：
x(n)={…,x。(-2T),x(一T),x(0),x(T),x。(2T),x(-3T),…}
显然x(n)是一个有序的数字的集合，因此时域离散信号也可以称为序列。注意，这里n取
整数，非整数时x(n)无定义。时域离散信号有三种表示方法。
1.用集合符号表示序列
数的集合用集合符号{·)表示。时域离散信号是一个有序的数的集合，可表示成集合：
x(n)=《x,n=…,-2,-1,0,1,2,…
例如，一个有限长序列可表示为
r(n)={1,2,3,4,3,2,1;n=0,1,2,3,4,5,6)
也可简单地表示为
x(n)=(1,2,3,4,3,2,1}
集合中有下划线的元素表示 n=0时刻的采样值。
2.用公式表示序列
例如：
第1章
时域离散信号和时域离散系统
x(n)=a0<a<1,-∞<n<∞
5
Created by ZhuangHeng
口口
口口
口口
口口
口
数字信号处理(第五版)
3.用图形表示序列
例如，时域离散信号x(n)=sin(πn/5),n=-5,-4,…,0,…,4,5,图1.2.1就是
它的图形表示。
1
n 0
-1
-5 0 5
n
图1.2.1 r(n)=sin(mn/5)的波形图
这是一种很直观的表示方法。为了醒目，常常在每一条竖线的顶端加一个小黑点。
实际中要根据具体情况灵活运用三种表示方法，对于一般序列，例如由实际模拟信号
采样得到的序列，或者是一些没有明显规律的数据，可以用集合或波形图表示。
下面介绍用MATLAB语言表示序列。
MATLAB用两个参数向量x和n表示有限长序列x(n),x是x(n)的样值向量，n是
位置向量(相当于图形表示方法中的横坐标n),n与x长度相等，向量n的第m个元素
n(m)表示样值x(m)的位置。位置向量n一般都是单位增向量，产生语句为：n=ns:nf;其
中ns表示序列x(n)的起始点，nf表示序列x(n)的终止点。这样将有限长序列x(n)记为
{x(n);n=ns:nf)。
例如，x(n)=(-0.0000,-0.5878,-0.9511,-0.9511,-0.5878,0.0000,
0.5878,0.9511,0.9511,0.5878,0.0000},相应的n=-5,-4,-3,…,5,所以序列
x(n)的MATLAB表示如下：
n=-5:5;
x=[-0.0000,-0.5878,-0.9511,-0.9511,-0.5878,0.0000,0.5878,
0.9511,0.9511,0.5878,0.0000]
这里x(n)的11个样值是正弦序列的采样值，即
x(n)=sin(πn/5) n=-5,-4,…,0,…,4,5
所以，也可以用计算的方法产生序列向量：
n=-5:5;x= sin(pi*n/5);
这样用MATLAB计算产生x(n)并绘图的程序如下：
?g121.m:sin(pi*n/5)信号产生及图1.2.1绘图程序
??置向量n从-5到5 n=-5:5;
x=sin(pi*n/5):??算序列向量x(n)的11个样值
subplot(3,2,1);stem(n,x,');line([-5,6].[0,0])
axis([-5,6,-1.2,1.2]):xlabel('n');ylabel('x(n))
运行程序输出波形如图1.2.1所示。
6
Created by ZhuangHeng
1.2.1 常用的典型序列
1.单位脉冲序列δ(n)
-{ (1.2.2)
单位脉冲序列也称为单位采样序列，特点是仅在n=0时取值为1,其他均为零。它在
时域离散线性时不变系统中的作用类似于模拟信号和系统中的单位冲激函数δ(t),但不同
的是，6(t)在t=0时取值为无穷大，t≠0时取值为零，对时间t的积分为1。单位脉冲序列
和单位冲激信号如图1.2.2所示。
8(n) 8(t)
1
(1)
-1012 3 n
0
(a)单位脉冲序列 (b)单位冲激信号
图1.2.2 单位脉冲序列和单位冲激信号
2.单位阶跃序列u(n)
-{“ (1.2.3)
单位阶跃序列如图1.2.3所示。它类似于模拟信号中的单位阶跃函数u(t)。δ(n)与
u(n)之间的关系如下列公式所示：
δ(n)=u(n)-u(n-1) (1.2.4)
u(n)=8(n-k) (1.2.5)
令n-k=m,代入式(1.2.5)得
(n)-8(m) (1.2.6)
u(n)
1
01 23
第)章时域离散信号和时域离散系统
n
图1.2.3 单位阶跃序列
3.矩形序列R(n)
R(n)={0≤n≤N-1
其他n (1.2.7)
式中，N称为矩形序列的长度。当N=4时，R?(n)的波形如图1.2.4所示。矩形序列可用
7
Created by ZhuangHeng
口
口口口
数字信号处理(第五版)
单位阶跃序列表示，如下式：
R(n)=u(n)-u(n-N) (1.2.8)
R?(n)
1
01 23
图1.2.4 矩形序列
4.实指数序列
x(n)=a"u(n) a为实数
如果|a|<1,x(n)的幅度随n的增大而减小，称x(n)为收敛序列；如果|a|>1,则称为发
散序列。其波形如图1.2.5所示。
du(n) dnn)
0<a<1 a>1
0 12 34567 8 9 n 01 2 34567 8 9 n
(a)收敛序列 (b)发散序列
图1.2.5 实指数序列
5.正弦序列
x(n)=sin(wn)
式中，w称为正弦序列的数字域频率(也称数字频率),单位是弧度(rad),它表示序列变化
的速率，或者说表示相邻两个序列值之间相位变化的弧度数。
如果正弦序列是由模拟信号x(t)采样得到的，那么
x,(t)=sin(Ωt)
x(n)=x,(1)|r=sin(QnT)=sin(wn)
因此得到数字频率w与模拟角频率Ω之间的关系为
w=QT (1.2.9)
(1.2.9)式具有普遍意义，它表示凡是由模拟信号采样得到的序列，模拟角频率Ω与序
列的数字域频率w呈线性关系。由于采样频率F,与采样周期T互为倒数，因而有 =
(1.2.10)
上式表示数字域频率是模拟角频率对采样频率的归一化频率。本书中用w表示数字域频
率，Ω和f分别表示模拟角频率和模拟频率。
6.复指数序列
复指数序列用下式表示：
8
Created by ZhuangHeng
x(n)=e
式中，w。为数字域频率。设s=0,用极坐标和实部虚部表示如下式：
x(n)=e"
x(n)=cos(won)+jsin(mon)
由于n取整数，下面等式成立：
e+aD=e
cos[(w。+2πM)n]=cos(w?n)
sin[(w。+2πM)n]=sin(w?n)
上面公式中M取整数，所以对数字域频率而言，正弦序列和复指数序列都是以2π为周期
的。在以后的研究中，在频率域只分析研究其主值区[-π,π]或[0,2π]就够了。
7.周期序列
如果对所有n,存在一个最小的正整数N,使下面等式成立：
m为整数 x(n)=x(n+mN) (1.2.11)
则称序列x(n)为周期性序列，周期为N。
例如：
x(n)=sin(4”)
式中数字频率是π/4,n取整数，可以写成下式：
x(n)=sin(4n)=sin(4n+2πm)=sin[4(n+8m)] m为整数
x(n)=sin(4n) 因此， 是周期为8的周期序列，波形如图1.2.6所示。下面讨论一般正弦
序列的周期性。 第1章 ”
1
5 67
0 1 2 3 4 8 910 n
图1.2.6 正弦序列 时域离散信号和时域离散系统
设
x(n)=A sin(wn+φ)
那么
x(n+mN)=A sin(w?(n+mN)+φ)=A sin(w?n+w?mN+φ)
如果
9
Created by ZhuangHeng
口
数字信号处理(第五版)
10
x(n+mN)=x(n)
则对于m=1,要求N=(2π/wo)k。式中，k与N均取整数，且k的取值要保证N是最小的
正整数，满足这些条件，正弦序列才是以N为周期的周期序列。
具体正弦序列有以下三种情况：
(1)当2π/w。为整数时，k=1,正弦序列是以2π/w。为周期的周期序列。例如，
sin(gn),=8,2=16,,该正弦序列周期为16。
(2)2π/w。不是整数，是一个有理数时，设2π/w。=P/Q,式中P、Q是互为素数的整
数，取k=Q,那么N=P,则该正弦序列是以P为周期的周期序列。例如，sin(4πn/5),
2π/wo=5/2,k=2,该正弦序列是以5为周期的周期序列。
(3)2π/w。是无理数，任何整数k都不能使N为正整数，因此，此时的正弦序列不是周
期序列。例如，wo=1/4,sin(a?n)即不是周期序列。
对于复数指数序列e"的周期性也有和上面同样的分析结果。
以上介绍了几种常用的典型序列，对于任意序列x(n),可以用单位脉冲序列的移位加
权和表示，即
x(n)=∑x(m)o(n-m) (1.2.12)
这种任意序列的表示方法，在信号分析中是一个很有用的公式。例如，x(n)的波形如图
1.2.7所示，可以用(1.2.12)式表示成：
x(n)=-28(n+2)+0.58(n+1)+28(n)+δ(n-1)+1.58(n-2)
-δ(n-4)+28(n-5)+δ(n-6)
x(n)
2
-2 4
-101 2 3 567 n
图1.2.7 用单位脉冲序列移位加权和表示序列
1.2.2 序列的运算
序列的简单运算有加法、乘法、移位、翻转及尺度变换。
1.加法和乘法
序列之间的加法和乘法，是指它的同序号的序列值逐项对应相加和相乘，如图1.2.8
所示。
Created by ZhuangHeng
x;(n) x?(n)+x?(n)
3
2 2
1 1
3 3
0 1 2 4 n 01 2 4 n
x?(n) xi(n)"x?(n)
3 3
2 2
1 1
4 4
012 3 0123 n
图1.2.8 序列的加法和乘法
2.移位、翻转及尺度变换
序列x(n)如图1.2.9(a)所示，其移位序列x(n-n。)(当n。=2时)如图1.2.9(b)所示。
当n。>0时，称为x(n)的延时序列；当n?<0时，称为x(n)的超前序列。x(-n)则是x(n)
的翻转序列，如图1.2.9(c)所示。x(mn)是x(n)序列每m点取一点形成的序列，相当于n
轴的尺度变换。当m=2时，其波形如图1.2.9(d)所示。
x(n) x(n-n?)
3 3
2 2
1 1
3 5
0 1 2 4 n 0 1 2 3 4 n
(a) (b)
第1章
x(一n) x(2n)
3 3
2
2
1
-3 1
-2-10 1 n 0 1 2 3 n
(c) (d) 时域离散信号和时域离散系统
图1.2.9 序列的移位、翻转和尺度变换
1.3 时域离散系统
设时域离散系统的输入为x(n),经过规定的运算，系统输出序列用y(n)表示。设运算
关系用T[·]表示，输出与输入之间关系用下式表示：
11
Created by ZhuangHeng
口
口口
口
数字信号处理(第五版)
y(n)=T[x(n)] (1.3.1)
其框图如图1.3.1所示。
在时域离散系统中，最重要和最常用的是线性时不变
系统，这是因为很多物理过程都可用这类系统表征，在一
定条件下，有些非线性时变系统可以用线性时不变系统近
似。线性时不变系统便于分析、设计与实现。
x(n) T·1 y(n)
图1.3.1 时域离散系统
1.3.1 线性系统
系统的输入、输出之间满足线性叠加原理的系统称为线性系统。设x?(n)和x?(n)分别
作为系统的输入序列，其输出分别用y?(n)和y?(n)表示，即
y?(n)=T[x?(n)],y?(n)=T[x?(n)]
那么线性系统一定满足下面两个公式：
T[z?(n)+x?(n)]=y?(n)+y?(n)
T[ar?(n)]=ay,(n)
(1.3.2)
(1.3.3)
(1.3.2)式表征线性系统的可加性；(1.3.3)式表征线性系统的比例性或齐次性，式中a是
常数。将以上两个公式结合起来，可表示成
y(n)=T[ar?(n)+bx?(n)]=ay,(n)+by:(n) (1.3.4)
上式中a和b均是常数。
【例1.3.1】 证明y(n)=ax(n)+b(a和b是常数)所代表的系统是非线性系统。
12
证明 y?(n)=T[x?(n)]=ax?(n)+b
y?(n)=T[x?(n)]=ax?(n)+b
y(n)=T[x?(n)+x?(n)]=ax?(n)+ax?(n)+b
y(n)≠y?(n)+y?(n)
因此，该系统不是线性系统。用同样方法可以证明y(n)=x(n)sin(wn+4))所代表的系统
是线性系统。
1.3.2 时不变系统
如果系统对输入信号的运算关系T[·]在整个运算过程中不随时间变化，或者说系统
对于输入信号的响应与信号加于系统的时间无关，则这种系统称为时不变系统，用公式表
示如下：
)=Tcn-m} (1.3.5)
式中n。为任意整数。检查一个系统是否是时不变系统，就是检查其是否满足(1.3.5)式。
【例1.3.2】 检查y(n)=ax(n)+b所代表的系统是否是时不变系统，式中a和b是
常数。
Created by ZhuangHeng
解 y(n)=ax(n)+b
y(n-n?)=ax(n-n?)+b
y(n-n)=T[x(n-n)]
因此该系统是时不变系统。
【例1.3.3】 检查y(n)=nx(n)所代表的系统是否是时不变系统。
解 y(n)=nx(n)
y(n-n。)=(n-n?)x(n-no)
T[x(n-no)]=nx(n-n?)
y(n-n。)≠T[x(n-n?)]
因此该系统不是时不变系统。此例从物理概念上可以理解成该系统是一个放大器，放大
器的放大量是n,它随n变化，因此是一个时变系统。依同样方法可以证明y(n)=
x(n)sin(won+4))所代表的系统也是时变系统。
1.3.3 线性时不变系统及其输入与输出之间的关系
线性时不变系统：同时满足线性和时不变特性的系统称为时域离散线性时不变系统。
时域离散系统的零输入响应、零状态响应和完全响应：设n。为初始观察时刻，则可将
系统的输入分为两部分，称 n.以前的输入为历史输入信号，称n。及n?以后的输入为当前输
入信号(简称输入信号)。仅由n。时刻的初始状态或历史输入信号引起的响应称为零输入响
应；仅由当前输入信号引起的响应称为零状态响应；将零输入响应与零状态响应之和称为
系统的完全响应。
设系统的输入x(n)=8(n),系统输出y(n)的初始状态为零，定义这种条件下的系统输
出为系统的单位脉冲响应，用h(n)表示。换句话说，单位脉冲响应即系统对于δ(n)的零状
态响应。用公式表示为
h(n)=T[δ(n)] (1.3.6)
h(n)和模拟系统中的单位冲激响应h(t)相类似，都代表系统的时域特征。
设系统的输入用x(n)表示，按照(1.2.12)式表示成单位脉冲序列移位加权和为
x(n)=∑x(m)o(n-m)
那么系统输出为
y(m)=T[∑(m)s(n-m]
根据线性系统的叠加性质
y(m)=∑zx(m)TLo[n-m]
又根据时不变性质
y(m)=∑z(mhCn-m)=r(n)*h(n) (1.3.7)
13
Created by ZhuangHeng
第1章
时域离散信号和时域离散系统
数字信号处理(第五版)
式中的符号“*”代表卷积运算，(1.3.7)式表示线性时不变系统的输出等于输入序列和该
系统的单位脉冲响应的卷积。计算卷积有三种方法：图解法，解析法，利用MATLAB语言
的工具箱函数计算法。下面先介绍图解法。
1)图解法
观察(1.3.7)式，计算卷积的基本运算是翻转、移位、相乘和相加，这类卷积称为序列
的线性卷积。如果两个序列的长度分别为N和M,那么卷积结果的长度为N+M-1。下面
用例题说明如何用图解法计算卷积。
【例1.3.4】 已知x(n)=R?(n),h(n)=R?(n),求y(n)=x(n)*h(n)。
y(n)=∑x(m)h(n-m)=∑R?(m)R,(n-m) 解
首先将h(n)用h(m)表示，并将波形翻转，得到h(-m),如图1.3.2(c)所示。然后将
x(n)
1
(a)
0 1 23 n
lx(m)
1
(b)
0 1 2 3 m
Ih(-m)
1
(c)
-3-2-10 m
h(1-m)
1
(d)
-2-10123 m
h(2-m)
1
(e)
-1012 3 m
4
y(n)
3
2
(f) 1
0 1 2 3 4 5 6 7 n
图1.3.2 例1.3.4线性卷积
14
Created by ZhuangHeng
h(-m)移位 n,得到h(n-m),n>0,序列右移；n<0,序列左移。如n=1,得到
h(1-m),如图1.3.2(d)所示。接着将x(m)和h(n-m)相乘后，再相加，得到y(n)的一个
值。对所有的n重复这种计算，最后得到卷积结果，如图1.3.2(f)所示，y(n)表达式为
y(n)={1,2,3,4,3,2,1}
其实这种图解法可以用列表法代替，上面的图解过程如表1.3.1所示。
表1.3.1 图解法(列表法)
x(m) 1 1 1 1
h(m) 1 1 1 1
h(-m) 1 1 1 1 y(0)=1
h(1-m) 1 1 1 1 y(1)=2
h(2-m) 1 1 1 1 y(2)=3
h(3-m) 1 1 1 1 y(3)=4
h(4-m) 1 1 1 1 y(4)=3
h(5-m) 1 1 1 1 y(5)=2
h(6-m) 1 1 1 1 y(6)=1
这种列表法的原理和图解法一样，但可以省去作图过程。
2)解析法
如果已知两个卷积信号的解析表达式，则可以直接按照卷积式进行计算，下面举例
说明。
【例1.3.5】 设x(n)=a"u(n),h(n)=R,(n),求y(n)=x(n)*h(n)。
解 y(n)=h(n)*z(n)=∑R(m)a”(n-m)
要计算上式，关键是根据求和号内的两个信号乘积的非零值区间确定求和的上、下限。
因为m≤n时，u(n-m)才能取非零值；0≤m≤3时，R?(m)取非零值，所以，求和区间中
m要同时满足下面两式：
m≤n
0≤m≤3
这样求和限与n有关系，必须将n进行分段然后计算。
n<0时，
y(n)=0
0≤n≤3时，乘积的非零值范围为0≤m≤n,因此
y(n)=a=a1-a
n≥4时，乘积的非零区间为0≤m≤3,因此
y(m)=∑a--a1a
第1章
时域离散信号和时域离散系统
15
Created by ZhuangHeng
D
口
口
口口
口
数字信号处理(第五版)
写成统一表达式为
3)用MATLAB计算两个有限长序列的卷积
MATLAB信号处理工具箱提供了conv 函数，该函数用于计算两个有限长序列的卷积
(或计算两个多项式相乘)。
C=conv(A,B) 计算两个有限长序列向量A和B的卷积。如果向量A和B的长度分
别为N和M,则卷积结果向量C的长度为N+M-1。如果向量A和B为两个多项式的系
数，则C就是这两个多项式乘积的系数。应当注意，conv 函数默认A和B表示的两个序列
都是从0开始，所以不需要位置向量。当然，默认卷积结果序列C也是从0开始，即卷积结
果也不提供特殊的位置信息。例1.3.4中的两个序列满足上述条件，直接调用conv函数求
解例1.3.4的卷积计算程序ep134.m如下：
?134.m:例1.3.4的卷积计算程序
xn=[1111];hn=[1111];
yn=conv(xn,hn);
运行结果：
yn=[1,2.3.4,3,2,1]
显然，当两个序列不是从0开始时，必须对conv函数稍加扩展。设两个位置向量已知
的序列：{x(n);nx=nxs:nxf),(h(n);nh=nhs:nhf},要求计算卷积：y(n)=h(n)*x(n)以及
y(n)的位置向量ny。下面编写计算这种卷积的通用卷积函数convu。
根据卷积原理知道，y(n)的起始点和终止点分别为：nys=nhs+nxs,nyf=nhf+nxf。
调用conv函数写出通用卷积函数convu 如下：
function [y,ny]=convu(h,nh,x,nx) ?nvu通用卷积函数，y为卷积结果序列向量，
?是y的位置向量，h和x是有限长序列，
?和nx分别是h和x的位置向量
nys=nh(1)+nx(1);nyf=nh(end)+nx(end);?d 表示最后一个元素的下标
y=conv(h,x);ny=nys:nyf;
如果h(n)=x(n)=R?(N+2),则调用convu 函数计算y(n)=h(n)*x(n)的程序
如下：
h=ones(1,5);nh=-2:2;
x=h;nx=nh;
[y, ny]=convu(h,nh,x,nx)
运行结果：
y=[123454321]
16
Created by ZhuangHeng
ny=[-4-3-2-101234]
线性卷积服从交换律、结合律和分配律。它们分别用公式表示如下：
x(n)*h(n)=h(n)*(n) (1.3.8)
x(n)*[h?(n)*h?(n)]=[x(n)*h?(n)]*h?(n) (1.3.9)
x(n)*[h?(n)+h?(n)]=x(n)*h?(n)+x(n)*h?(n) (1.3.10)
以上三个性质请读者自己证明。(1.3.8)式表示卷积服从交换律。(1.3.9)和(1.3.10)
式分别表示卷积的结合律和分配律。设h?(n)和h?(n)分别是两个系统的单位脉冲响应，
x(n)表示输入序列。按照(1.3.9)式的右端，信号通过h?(n)系统后再通过h?(n)系统，等
效于按照(1.3.9)式左端，信号通过一个系统，该系统的单位脉冲响应为h?(n)*h?(n),如
图1.3.3(a)、(b)所示。该式还表明两系统级联，其等效系统的单位脉冲响应等于两系统分
别的单位脉冲响应的卷积。按照(1.3.10)式，信号同时通过两个系统后相加，等效于信号
通过一个系统，该系统的单位脉冲响应等于两个系统分别的单位脉冲响应之和，如图
1.3.3(c)、(d)所示。换句话说，系统并联的等效系统的单位脉冲响应等于两个系统分别的
单位脉冲响应之和。
(a)- x() h(n) h?(n) )(n)
(b) x(n)
h(n)* h?(n) y(n)
(c) x(m) h?(n) +
n)
x(n) (d)
h?(n)
h(n)+h?(n) (n)
图1.3.3 卷积的结合律和分配律
需要再次说明的是，关于系统级联、并联的等效系统的单位脉冲响应与原来两系统分
别的单位脉冲响应的关系，是基于线性卷积的性质，而线性卷积是基于线性时不变系统满
足线性叠加原理和时不变特性。因此，对于非线性或者时变系统，这些结论是不成立的。
再考察(1.3.11)式，它也是一个线性卷积式，它表示序列x(n)与单位脉冲序列的线性
卷积等于序列本身x(n),
z(n)=∑r(m)o(n-m)=x(n)*8(n) (1.3.11)
如果序列与一个移位的单位脉冲序列8(n-n。)进行线性卷积，就相当于将序列本身移位 n。
(n。是整常数),如下式表示：
y(n)=a(n)*(n-n)=∑x(m)8(n-n。-m)
上式中求和项只有当m=n-n。时才有非零值，因此得到：
x(n)*8(n-n?)=x(n-n?) (1.3.12)
17
Created by ZhuangHeng
第1章
时域离散信号和时域离散系统
数字信号处理(第五版)
【例1.3.6】 在图1.3.4中，h?(n)系统与h?(n)系统级联，设
x(n)=u(n)
h,(n)=δ(n)-δ(n-4)
h?(n)=a"u(n) la|<1
求系统的输出y(n)。
x(n) m(n) h?(n) h?(n) (n)
图1.3.4 例1.3.6框图
解 先求第一级的输出m(n),再求y(n)。
m(n)=x(n)*h?(n)
=u(n)*[8(n)-δ(n-4)]
=u(n)*δ(n)-u(n)*δ(n-4)
=u(n)-u(n-4)
=R?(n)
y(n)=m(n)*h?(n)
=R,(n)*a"u(n)
由例1.3.5的计算结果知道：
n<0
0≤n≤3
4≤n
1.3.4 系统的因果性和稳定性
一般因果系统定义：
如果系统 n时刻的输出只取决于n时刻以及n时刻以前的输入序列，而和n时刻以后
的输入序列无关，则称该系统具有因果性质，或称该系统为因果系统。如果n时刻的输出
还取决于n时刻以后的输入序列，在时间上违背了因果性，系统无法实现，则系统被称为
非因果系统。因此系统的因果性是指系统的可实现性。
线性时不变系统具有因果性的充分必要条件：
系统的单位脉冲响应满足下式：
h(n)=0 n<0 (1.3.13)
满足(1.3.13)式的序列称为因果序列，因此因果系统的单位脉冲响应必然是因果序列。因
果系统条件(1.3.13)式从概念上也容易理解，因为单位脉冲响应是输入为8(n)的零状态响
应，在n=0时刻以前即n<0时，没有加入信号，输出只能等于零，因此得到因果性条件
(1.3.13)式。
18
Created by ZhuangHeng
一般稳定系统定义：
如果对有界输入，系统产生的输出也是有界的，则称该系统具有稳定性，或称该系统
为稳定系统。
线性时不变系统稳定的充分必要条件：
系统的单位脉冲响应绝对可和，用公式表示为
∑Ih(n)I<○ (1.3.14)
证明 先证明充分性。
y(n)=∑h(k)x(n-k)
ly(n)<2hCA)|x(n-k)|
因为输入序列x(n)有界，即
lx(n)|<B∞<n<∞,B为任意常数
因此
l y(n) |≤B∑ h(k)
如果系统的单位脉冲响应满足(1.3.14)式，那么输出y(n)一定也是有界的，即
Iy(n)|<0
下面用反证法证明其必要性。如果h(n)不满足(1.3.14)式，即
总可以找到一个或若干个有界的输入来引起无界的输出，例如：
∑Ih(n)|=∞,那么
y(n)=∑h(k)x(n-A)
令n=0,有
y(O)-∑hA)x(-k)-Zh(khk)
=∑Ih(k)I= 第)章时域离散信号和时域离散系统
上式说明n=0时刻的输出为无界，系统不稳定，证明了(1.3.14)式条件的必要性。
应当注意：线性时不变系统因果稳定性的判断方法仅适用于线性时不变系统，所以，
利用该方法判定系统是否因果稳定时，首先必须确定系统是线性时不变的。而一般因果稳
定系统的定义适用于判定任何系统。
【例1.3.7】 设系统的输入输出关系方程为y(n)=e,试分析该系统的因果稳定性。
解 因为y(n)只与x(n)有关，与n时刻以后的输入无关，所以，根据一般因果系统的
19
Created by ZhuangHeng
数字信号处理(第五版)
定义，该系统是因果系统。
如果|x(n)|<A,则e^<y(n)<e^,所以，根据一般稳定系统定义，该系统是稳定系统。
值得注意：如果不加判断，直接利用线性时不变系统因果稳定性的充分必要条件求证，
就会得出如下错误的结论：
令x(n)=8(n),代入系统差分方程得到h(n)=e,当n<0时，h(n)=e°=1≠0,由
此得出结论，该系统是非因果系统。
∑Ih(n)|=∑1e|=∞,所以，该系统是不稳定系统。 又因为
之所以得出错误结论，是因为线性时不变系统因果稳定性的充分必要条件只适用于线
性时不变系统。但对该系统
T[axr?(n)+bx?(n)]=e;(+h?m=e"·e"
=T[ar?(n)]·T[bx?(n)]
≠aT[x,(n)]+bT[x?(n)]
显然是非线性系统，不能用线性时不变系统因果稳定性的充分必要条件求证。此例说明，
应用性质和定理时，一定要注意其适用范围。
【例1.3.8】 设线性时不变系统的单位脉冲响应h(n)=a"u(n),式中a是实常数，试
分析该系统的因果稳定性。
解 由于n<0时，h(n)=0,因此系统是因果系统。
∑Th(n)I=21al=m21a=lm-a
只有当|a|<1时，才有
∑Thn)|=a
因此系统稳定的条件是|a|<1;否则，|a|≥1时，系统不稳定。系统稳定时，h(n)的模值
随n加大而减小，此时序列h(n)称为收敛序列。如果系统不稳定，h(n)的模值随n加大而
增大，则称为发散序列。
【例1.3.9】 设系统的单位脉冲响应h(n)=u(n),求对于任意输入序列x(n)的输出
y(n),并检验系统的因果性和稳定性。
解 h(n)=u(n)
y(n)=x(n)*h(n)=∑x(k)u(n-k)
因为当n-k<0时，u(n-k)=0;n-k≥0时，u(n-k)=1,因此，求和限为k≤n,所以
y(m)=∑x(A) (1.3.15)
上式表示该系统是一个累加器，它将输入序列从加上之时开始，逐项累加，一直加到n时
刻为止。
下面分析该系统的稳定性：由于
20
Created by ZhuangHeng
∑Th(n)|=∑1a(n)|=
因此该系统是一个不稳定系统。显然，该系统是一个因果系统。
根据以上介绍的稳定概念，可以通过检查系统单位脉冲响应是否满足绝对可和的条件
来判断线性时不变系统是否稳定。实际中，如何用实验信号测定系统是否稳定是一个重要
问题，显然，不可能对所有有界输入都检查是否得到有界输出。可以证明1,只要用单位
阶跃序列作为输入信号，如果稳态输出趋于常数(包括零),则系统一定稳定，否则系统不
稳定。不必要对所有有界输入都进行实验。
1.4 时域离散系统的输入输出描述法——线性常系数差分方程
描述一个系统时，可以不管系统内部的结构如何，将系统看成一个黑盒子，只描述或
者研究系统输出和输入之间的关系，这种方法称为输入输出描述法。对于模拟系统，我们
知道由微分方程描述系统输出输入之间的关系。对于时域离散系统，则用差分方程描述输
出输入之间的关系。线性时不变系统用线性常系数差分方程来描述。本节主要介绍这类差
分方程及其解法。差分方程均指线性常系数差分方程，本书中不另说明。
1.4.1 线性常系数差分方程
一个N阶线性常系数差分方程用下式表示：
y(m)=Zbxc(n-i)-as(n-) (1.4.1)
或者
∑asycn-)=∑bx(n-) a=1 (1.4.2)
式中，x(n)和y(n)分别是系统的输入序列和输出序列，a,和b,均为常数，式中y(n-i)和
x(n-i)项只有一次幂，也没有相互交叉相乘项，故称为线性常系数差分方程。差分方程的
阶数是用方程y(n-i)项中i的最大取值与最小取值之差确定的。在(1.4.2)式中，y(n-i)
项i最大的取值为N,i的最小取值为零，因此称为N阶差分方程。
1.4.2 线性常系数差分方程的求解 第1章时域离散信号和时域离散系统
已知系统的输入序列，通过求解差分方程可以求出输出序列。求解差分方程的基本方
法有以下三种：
(1)经典解法。这种方法类似于模拟系统中求解微分方程的方法，它包括齐次解与特
解，由边界条件求待定系数，较麻烦，实际中很少采用，这里不作介绍。
(2)递推解法。这种方法简单，且适合用计算机求解，但只能得到数值解，对于阶次较
高的线性常系数差分方程不容易得到封闭式(公式)解答。
21
Created by ZhuangHeng
口口□口
口
数字信号处理(第五版)
22
(3)变换域方法。这种方法是将差分方程变换到z域进行求解，方法简便有效，这部分
内容放在第2章学习。
当然还可以不直接求解差分方程，而是先由差分方程求出系统的单位脉冲响应，再与
已知的输入序列进行卷积运算，得到系统的输出。但是系统的单位脉冲响应如果不是预先
知道，仍然需要求解差分方程，求其零状态响应解。
本节只介绍递推法，其中包括如何用MATLAB求解差分方程。
观察(1.4.1)式，求n时刻的输出，要知道n时刻以及n时刻以前的M个输入序列值，
还要知道n时刻以前的N个输出序列值(初始条件)。因此求解差分方程在给定输入序列的
条件下，还需要确定N个初始条件。以上介绍的三种基本解法都只能在已知N个初始条件
的情况下，才能得到唯一解。如果求n。时刻以后的输出，n。时刻以前的N个输出值
y(n。-1)、y(n。-2)、…、y(n。-N)就构成了初始条件。
(1.4.1)式表明，已知输入序列和N个初始条件，则可以求出n时刻的输出；如果将该
公式中的n用n+1代替，可以求出n+1时刻的输出，因此(1.4.1)式表示的差分方程本身
就是一个适合递推法求解的方程。
【例1.4.1】 设因果系统用差分方程y(n)=ay(n-1)+x(n)描述，输入序列x(n)=
δ(n),求输出序列y(n)。
解 该系统差分方程是一阶差分方程，需要一个初始条件。
(1)设初始条件为y(-1)=0,则递推得到：
y(n)=ay(n-1)+x(n)
n=0时，y(0)=ay(-1)+8(0)=1
n=1时，y(1)=ay(0)+8(1)=a
n=2时，y(2)=ay(1)+8(2)=a2
…
n=n时，y(n)=a
y(n)=a"u(n)
(2)设初始条件为y(-1)=1,则递推得到：
n=0时，y(0)=ay(-1)+8(0)=1+a
n=1时，y(1)=ay(0)+8(1)=(1+a)a
n=2时，y(2)=ay(1)+δ(2)=(1+a)a2
……
n=n时，y(n)=(1+a)a"
y(n)=(1+a)a"u(n)
该例表明，对于同一个差分方程和同一个输入信号，因为初始条件不同，得到的输出
信号是不相同的。
对于实际系统，用递推解法求解，总是由初始条件向n>0的方向递推，是一个因果
解。但对于差分方程，其本身也可以向n<0的方向递推，得到的是非因果解。因此差分方
Created by ZhuangHeng
程本身不能确定该系统是因果系统还是非因果系统，还需要用初始条件进行限制。下面就
是向方向n<0递推的例题。
【例1.4.2】 设差分方程为
x(n)=δ(n),y(n)=0,n>0 y(n)=ay(n-1)+x(n)
求输出序列y(n)。
解 y(n-1)=a1(y(n)-δ(n))
n=1时，y(0)=a1(y(1)-8(1))=0
n=0时，y(-1)=a1(y(0)-8(0))=-a1
n=-1时，y(-2)=a1(y(-1)-8(-1))=-a
……
n=-|n|时，y(n-1)=-a"
将n-1用n代替，得到：
y(n)=-a"u(-n-1)
这确实是一个非因果的输出信号。用差分方程求系统的单位脉冲响应，由于单位脉冲响应
是当系统输入δ(n)时的零状态响应，因此只要令差分方程中的输入序列为δ(n),N个初始
条件都为零，其解就是系统的单位脉冲响应。实际上例题1.4.1(1)中求出的y(n)就是该系
统的单位脉冲响应，例题1.4.2求出的y(n)则是一个非因果系统的单位脉冲响应。
最后要说明的是，一个线性常系数差分方程描述的系统不一定是线性非时变系统，
这和系统的初始状态有关。如果系统是因果的，一般在输入x(n)=0(n<n。)时，则输出
y(n)=0(n<n?),系统是线性非时变系统。
下面介绍用MATLAB求解差分方程。
MATLAB信号处理工具箱提供的 filter 函数实现线性常系数差分方程的递推求解，调
用格式如下：
yn=filter(B,A.xn)
计算系统对输入信号向量xn的零状态响应输出信号向量yn,yn与xn长度相等，其中，B
和A是(1.4.2)式所给差分方程的系数向量，即
B=[b?,b?,…,bM],A=[a?,a?,…,an]
其中a。=1,如果a。≠1,则 filter用a。对系数向量B和A归一化。
yn=filter(B,A.xn,xi)
计算系统对输入信号向量xn的完全响应输出信号yn。其中，xi是等效初始条件的输入序
列，所以xi是由初始条件确定的。MATLAB信号处理工具箱提供的filtic就是由初始条件
计算 xi的函数，其调用格式如下：
第1章时域离散信号和时域离散系统
xi=filtic(B,A,ys,xs)
其中，ys和xs是初始条件向量：ys=[y(-1),y(-2),y(-3),…,y(-N)],xs=
[x(-1),x(-2),x(-3),…,x(-M)]。如果xn是因果序列，则xs=0,调用时可缺
省xs。
23
Created by ZhuangHeng
口
口
口
口
口
口口
数字信号处理(第五版)
例1.4.1的MATLAB求解程序ep141.m如下：
?141.m:调用 filter解差分方程y(n)-ay(n-1)=x(n)
??差分方程系数a=0.8,初始状态：y(-1)=1 a=0.8:ys=1;
xn=[1,zeros(1,30)]:?n)=单位脉冲序列，长度N=31
B=1;A=[1,-a]; ??分方程系数
xi=filtic(B,A,ys): ??初始条件计算等效初始条件的输人序列xi
yn=filter(B,A,xn,xi);??用filter解差分方程，求系统输出信号y(n)
n=0:length(yn)-1;
subplot(3,2.1;stem(n,yn,.
title('(a)');xlabel('n');ylabel('y(n)')
程序中取差分方程系数a=0.8时，得到系统输出y(n)如图1.4.1(a)所示，与例1.4.1的
解析递推结果完全相同。如果令初始条件y(-1)=0(仅修改程序中ys=0),则得到系统输
出y(n)=h(n),如图1.4.1(b)所示。
2 2
y(n)1 h(n) 1
0
0 10 20 30 0
0 10 20 30
n n
(a) (b)
图1.4.1 例1.4.1求解程序输出波形
1.5 模拟信号数字处理方法
在绪论中已介绍了数字信号处理技术相对于模拟信号处理技术的许多优点，因此人们
往往希望将模拟信号经过采样和量化编码形成数字信号，再采用数字信号处理技术进行处
理；处理完毕，如果需要，再转换成模拟信号。这种处理方法称为模拟信号数字处理方法，
其原理框图如图1.5.1所示。图中的预滤波与平滑滤波所起的作用在后面介绍。本节主要
介绍采样定理和采样恢复。
24
x?(4) 预滤波 A/DC 数字信号处理 D/AC 平滑滤波 y(0
图1.5.1 模拟信号数字处理框图
1.5.1 采样定理及A/D变换
对模拟信号进行采样可以看做一个模拟信号通过一个电子开关S。设电子开关每隔周
Created by ZhuangHeng
期T合上一次，每次合上的时间为t(r<T),在电子开关输出端得到其采样信号x,(t)。该
电子开关的作用等效成一宽度为z,周期为T的矩形脉冲串pr(t),采样信号(t)就是
x?(t)与p-(t)相乘的结果。采样过程如图1.5.2(a)所示。如果让电子开关合上的时间
→0,则形成理想采样，此时上面的脉冲串变成单位冲激串，用pa(t)表示。p?(t)中每个单
位冲激处在采样点上，强度为1,理想采样则是x(t)与p(t)相乘的结果，采样过程如图
1.5.2(b)所示。用公式表示为
pa(2)-∑8(1-nT) (1.5.1)
.(t)=z.(1)p;(1)=∑z.(28(-nT)
上式中8(t)是单位冲激信号，在上式中只有当t=nT时，才可能有非零值，因此写成下式：
z,(2)-∑z.(nT)6(-nT) (1.5.2)
x(t) 金，0 xa()
s × 金0
P?(T),p?(1)
x?() xa()
0 0
P?(1) P?()
0 0
T T
T
念(0 ,0
0 在 0
上 A
(a) (b)
图1.5.2 对模拟信号进行采样
下面研究理想采样前后信号频谱的变化，从而找出为了使采样信号能不失真地恢复原
模拟信号，采样速率F,(F,=T-)与模拟信号最高频率f。之间的关系。
我们知道在傅里叶变换中，两信号在时域乘积的傅里叶变换等于两个信号分别的傅里
叶变换的卷积除以2π,按照(1.5.2)式，推导如下：
设
第1章
时或离改言号和时域离敬系统
25
Created by ZhuangHeng
口
数字信号处理(第五版)
26
X,Gj2)=FT[r(t)]
X,(j2)=FT[x,(t)]
P?(jΩ)=FT[p?(t)]
对(1.5.1)式进行傅里叶变换，得到
P?i2)=∑2maB(Q-a) (1.5.3)
式中，Ω,=2π/T,称为采样角频率，单位是rad/s。
a=÷()em'd=云
因此
P?Gia)=经∑8a-kD.) (1.5.4)
根据傅里叶变换的频域卷积定理有
X,(jD)=2x,Gjn)*PGj)
=-·经_x.Go)∑8(Q-k.-0)de
=÷zx.(jO)8(2-ka,-0)de
-÷∑x.6in-jA2.) (1.5.5)
上式表明理想采样信号的频谱是原模拟信号的频谱沿频率轴，每间隔采样角频率Ω,重复
出现一次，并叠加形成的周期函数。或者说，理想采样信号的频谱是原模拟信号的频谱以
Ω,为周期，进行周期性延拓而成的。
在图1.5.3中，设x。(t)是带限信号，最高频率为2,其频谱X,(j2)如图1.5.3(a)所
示。p?(t)的频谱P?(j2)如图1.5.3(b)所示，那么按照(1.5.5)式，,(t)的频谱X,(j2)如图
1.5.3(c)所示，图中原模拟信号的频谱称为基带频谱。如果满足Ω,≥2Ω,或者用频率表示
该式，即满足F,≥2f。,基带谱与其他周期延拓形成的谱不重叠，如图1.5.3(c)所示情况，
可以用理想低通滤波器G(j2)从采样信号中不失真地提取原模拟信号，如图1.5.4所示。
但如果选择采样频率太低，或者说信号最高截止频率过高，使F.<2f,X,Gj2)按照采样频
率F,周期延拓时，形成频谱混叠现象，用图1.5.3(d)表示。这种情况下，再用图1.5.4所
示的理想低通滤波器对x,(t)进行滤波，得到的是失真了的模拟信号。用公式表示如下：
-aa (1.5.6)
Y,(j2)=FT[y.(t)]=X,Gj2)·GGj2)
Created by ZhuangHeng
y。(t)=FT?'[Y,(2)]
n.≤ a y.(t)=x,(t)
a.>2a y,(t)≠x(t)
这里需要说明的是，一般频谱函数是复函数，相加应是复数相加，图1.5.3和图1.5.4
仅是示意图。一般称F,/2为折叠频率，只有当信号最高频率不超过F,/2时，才不会产生
频率混叠现象，否则超过F,/2的频谱会折叠回来而形成混叠现象，因此频率混叠在F,/2
附近最严重。
1x,69)
(a) 0
GGO) y0)
(a) -Q 0 Q 口
PG9) ×,GD)
(b) (b) -Q 0 Q O 0
×,G9) GGO)
(c) -R 0,/20 Q,/2 Q
(e) -W/T 0 W/T 口
18,GO) X,G0)
(d) -Q 0 QQ Q
(d) 0
Q/2
图1.5.3 采样信号的频谱 图1.5.4 采样恢复
总结上述内容，采样定理叙述如下：
(1)对连续信号进行等间隔采样形成采样信号，采样信号的频谱是原连续信号的频谱
以采样频率2,为周期进行周期性的延拓形成的，用公式(1.5.5)表示。
(2)设连续信号x(t)属带限信号，最高截止频率为Ω,如果采样角频率Ω≥2Ω,那
么让采样信号x(t)通过一个增益为T、截止频率为Ω,/2=π/T的理想低通滤波器，可以唯
一地恢复出原连续信号x,(t)。否则，Ω,<2Ω。会造成采样信号中的频谱混叠现象，不可能
无失真地恢复原连续信号。
第1章时域离散信号和时域离散系统
实际中对模拟信号进行采样，需根据模拟信号的截止频率，按照采样定理的要求选择
采样频率，即Ω,≥2Ω,但考虑到理想滤波器G(jΩ)不可实现，要有一定的过渡带，为此可
选Ω,=(2+a)Ω,a>0。另外，可以在采样之前加一抗混叠的低通滤波器，滤除高于Ω,/2
的一些无用的高频分量和其他的一些杂散信号。这就是在图1.5.1中采样之前加预滤波的
原因。
27
Created by ZhuangHeng
口
■口 口
口
口口
□0口
■口
a口
数字信号处理(第五版)
28
上面我们通过对模拟信号进行理想采样分析推导出采样定理。采样定理表示的是采样
信号x,(t)的频谱与原模拟信号x,(t)的频谱之间的关系，以及由采样信号不失真地恢复原
模拟信号的条件。要进一步说明的是，采样信号用(1.5.2)式表示，它是用一串延时的单位
冲激加权和表示的。按照该式，在t=nT时，即在每个采样点上，采样信号的强度(幅度)准
确地等于对模拟信号的采样值x,(nT),而在t≠nT非采样点上采样信号的幅度为零。时域
离散信号(序列)x(n)只有在n为整数时才有定义，否则无定义，因此采样信号和时域离散
信号不相同。但如果序列是通过对模拟信号采样得到的，即x(n)=x.(nT),序列值等于采
样信号在t=nT时的幅度，在第2章将通过分析时域离散信号的频谱，得到此时序列的频
谱依然是模拟信号频谱的周期延拓，因此由模拟信号通过采样得到序列时，依然要服从采
样定理，否则同样也会产生频谱混叠现象。
将模拟信号转换成数字信号由模/数转换器(Analog/Digital Converter,ADC)完成，
模/数转换器的原理框图如图1.5.5所示。通过按等间隔T对模拟信号进行采样，得到一串
采样点上的样本数据，这一串样本数据可看作时域离散信号(序列)。设ADC有M位，那
么每个样本数据用M位二进制数表示，即形成数字信号。因此，采样以后到形成数字信号
的这一过程是一个量化编码的过程。例如：模拟信号x(t)=sin(2πft+π/8),式中f=
50 Hz,选采样频率F,=200 Hz,将t=nT代人x,(t)中，得到采样数据：
x.(nT)=sin(2πfnT+8) T=青
=sin(2π200"+8)
=sin(2m+8)
当n=…,0,1,2,3,…时，得到序列x(n)如下：
r(n)=(…,0.382.683,0.923 879,-0.382683,-0.923 879,…
x(n) x?(() 采样 量化编码 (n)
图1.5.5 模/数转换器原理框图
如果ADC按照M=6进行量化编码，即上面的采样数据均用6位二进制码表示，其中一位
为符号位，则数字信号用(n)表示：
x(n)={…,0.01100,0.11101,1.01100,1.11101,…}
用十进制数表示的i(n)为
x(n)={…,0.375 00,0.906 25,-0.375 00,-0.906 25,…}
显然量化编码以后的x(n)和原x(n)不同。这样产生的误差称为量化误差，这种量化误差的
影响称为量化效应，这部分内容将在第9章介绍。
1.5.2 将数字信号转换成模拟信号
我们已经知道模拟信号x(t)经过理想采样，得到采样信号x(1),x(1)和云(t)之间
Created by ZhuangHeng
的关系用(1.5.2)式描述。如果选择采样频率F、满足采样定理，(t)的频谱没有频谱混叠
现象，可用一个传输函数为GGjΩ2)的理想低通滤波器不失真地将原模拟信号x(t)恢复出
来，这是一种理想恢复。下面先分析推导该理想低通滤波器的输入和输出之间的关系，以
便了解理想低通滤波器是如何由采样信号恢复原模拟信号的，然后再介绍在实际中数字信
号如何转换成模拟信号。
下面由(1.5.6)式表示的低通滤波器的传输函数G(j2)推导其单位冲激响应g(t):
g(1)=元厂GGia)e"dn=2Te"da=sinC2/22
因为Ω=2πF,=2π/T,因此g(t)也可以用下式表示：
g(2)=sin(z/T (1.5.7)
理想低通滤波器的输人、输出分别为x(t)和y,(t),
v.(t)=i,(2)*g(t)=?i(z)g(-z)dr
将(1.5.7)式表示的g(t)和(1.5.2)式表示的x(t)代入上式，得到：
v.(1)=[∑z.(nT)S(r-nT)]g(t-zdr
=2_x(nT)δ(r-nT)g(t-z)dr
=2z.(nT)g(t-nT)
=2z.(nT)siacT/T (1.5.8)
由于满足采样定理，y,(t)=x,(t),因此得到：
z.(t)=∑x.(nT)inrr(-nTT/T (1.5.9)
式中，当n=…,-1,0,1,2,…时，x(nT)是一串离散的采样值，而x,(t)是模拟信号，t
取连续值，g(t)的波形如图1.5.6所示。其特点是：t=0时，g(0)=1;t=nT(n≠0)时，
g(t)=0。在(1.5.9)式中，g(t)保证了在各个采样点上，即t=nT时，恢复的x,(t)等于原
采样值，而在采样点之间，则是各采样值乘以g(t-nT)的波形伸展叠加而成的。这种伸展
波形叠加的情况如图1.5.7所示。g(t)函数所起的作用是在各采样点之间内插，因此称为
g()
1
T 3T
0 2T t
图1.5.6 内插函数g(1)波形
第1章
时域离散信号和时域离散系统
29
Created by ZhuangHeng
数字信号处理(第五版)
30
内插函数，而(1.5.9)式则称为内插公式。这种用理想低通滤波器恢复的模拟信号完全等于
原模拟信号x(t),是一种无失真的恢复。但由于g(t)是非因果的，因此理想低通滤波器是
非因果不可实现的。
x?(n)
-2T-TO T 2T 3T
x?(-2Tg(t+27)
石
x(-Dg(t+D)
O
x?(0)g()
0
x?(Tg(t-T)
石
x.(2Dgt-27)
O
x?(37g(-37)
O
x?()
0 1
图1.5.7 理想恢复
下面介绍实际的数字信号到模拟信号的转换。
实际中采用DAC(Digital/Analog Converter)完成数字信号到模拟信号的转换。DAC包
括三部分，即解码器、零阶保持器和平滑滤波器，DAC方框图如图1.5.8所示。解码器的
作用是将数字信号转换成时域离散信号x(nT),零阶保持器和平滑滤波器则将x(nT)变
Created by ZhuangHeng
成模拟信号。
x(n) 解码器 x?(nD) 零阶保持器 x0) 平滑滤波器 xa()
图1.5.8 DAC方框图
由时域离散信号x(nT)恢复模拟信号的过程是内插的过程。理想低通滤波的方法是用
g(t)函数作内插函数，还可以用一阶线性函数作内插。零阶保持器是将前一个采样值进行
保持，一直到下一个采样值来到，再跳到新的采样值并保持，因此相当于进行常数内插。零
阶保持器的单位冲激函数h(t)以及输出波形如图1.5.9所示。对h(t)进行傅里叶变换，得
到其传输函数：
HG2)=?hD)ed=?ed=TsinCT/2)e (1.5.10)
x(nD) h⑩
1
0T 2T3T 4T 0 T
X()
0T 2T3T4T
图1.5.9 零阶保持器的输出波形
其幅频特性和相频特性如图1.5.10所示。由该图看到，零阶保持器是一个低通滤波器，能
IIHG2)1
T
-4π/T -2π/T 0 WT 2π/T 4w/T
arg[HG2]]
π
2π/T 4π/T
-4π/T -2π/T 0 Q
一
图1.5.10 零阶保持器的频响特性
第1章时域离散信号和时域离散系统
31
Created by ZhuangHeng
口口
口口
口
口口
口口
口
数字信号处理(第五版)
32
够起到将时域离散信号恢复成模拟信号的作用。图中虚线表示理想低通滤波器的幅度特
性。零阶保持器的幅度特性与理想低通滤波器有明显的差别，主要是在|Ω|>π/T区域有
较多的高频分量，表现在时域上，就是恢复出的模拟信号是台阶形的。因此需要在D/AC
之后加平滑低通滤波器，滤除多余的高频分量，对时间波形起平滑作用，这也就是在图
1.5.1模拟信号数字处理框图中，最后加平滑滤波器的原因。虽然这种零阶保持器恢复的
模拟信号有些失真，但简单、易实现，是经常使用的方法。实际中，将解码器与零阶保持器
集成在一起，就是工程上的DAC器件。
1.6 确定性信号的相关函数
在检测技术中，相关检测已经发展成一个独立的分支，并引起人们的广泛关注。相关
函数的估计和计算是经典谱估计和现代谱估计的基础。相关函数是与卷积十分类似的数学
运算。与卷积运算一样，相关函数也涉及两个信号序列。但卷积主要关心对其中一个信号
的处理功能和处理效果，例如去除其中的干扰噪声。而相关运算是研究两个信号的相似性，
或一个信号经过延迟后与原信号的相似性，以实现对信号的检测、识别与信息提取。
本节主要介绍确定性信号的相关函数的定义、性质与应用。但在实际中，相关函数是
描述随机信号的重要统计量，在随机信号的分析与处理中有着重要作用。
1.6.1 信号的互相关函数和自相关函数
定义
ra(m)=∑x(n)s(n-m) (1.6.1)
为信号x(n)和y(n)的互相关函数①。从式(1.6.1)可见，将x(n)保持不动，若y(n)右移m
个采样周期，则得到y(n-m),再将x(n)与y(n-m)相乘并求和，则得到r,(m)在m时刻
的值。r,(m)反映了x(n)与y(n-m)两个波形的相似程度。
与序列卷积运算相比较，相关运算仅缺少了将y(n)翻转变成y(-n)的步骤，其他运算
过程完全相同。所以
r(m)=x(n)*y(-n)|- (1.6.2)
因此，用于卷积的计算过程和程序都可以直接用于计算序列的相关函数。将y(n)翻转变成
y(-n),再调用卷积函数计算x(m)*y(-m),则得到x(n)和y(n)的互相关函数r(m)。
如果式(1.6.1)中y(n)=x(n),则上面定义的互相关函数即变成x(n)的自相关函数，
记为r,(m),即
r(m)=∑x(n)y(n+m), ① 互相关函数也可以定义为， ,二者本质上是相同的。式(1.6.1)更便于工程
上借用卷积算法和程序进行计算。
Created by ZhuangHeng
ra(m)=∑x(n)(n-m) (1.6.3)
自相关函数表示了信号x(n)与其自身移位后的x(n-m)的相似程度。为了表示简单，
一般将自相关函数记为r,(m)。
r,(0)=∑2(n)一E (1.6.4)
式(1.6.4)说明，r(0)表示x(n)的能量，记为E。当E?<0时，信号x(n)称为能量信号；
当E,=0时，信号x(n)称为能量无限信号。对能量无限信号，我们主要研究其平均功率。
信号x(n)的功率定义为
P.=lm2N+1Iz()|2 (1.6.5)
当P,<o时，称 x(n)为功率信号。功率信号是工程实际和理论研究中的常用信号，如周期
信号。
当输入序列是有限长序列，或只能获得无限长序列的有限个序列值时，通常将互相关
函数和自相关函数表示成有限和的形式。特别是当x(n)和y(n)是长度为N的因果序列时，
互相关函数和自相关函数可以表示为
r(n)v(n-m)0<m
n
(1.6.6) <m<0
m 为其他值
m 为其他值
(1.6.7)
上述对相关函数的定义都是针对实信号的，如果x(n)和y(n)是复信号，其相关函数也
是复信号，此时定义式(1.6.1)和式(1.6.3)应该为
r(m)=∑z(n)y'(n-m) (1.6.8)
r,(m)=a(n)a'(n-m) (1.6.9)
在后面的讨论中，如果不做特别说明，x(n)和y(n)一律都视为实信号。
【例1.6.1】 设信号为x(n)=a"u(n),0<a<1。求其自相关函数。
解 由于x(n)是无限时宽的，所以r?(m)也是无限时宽的。下面分m≥0和m<0两种
情况来求解。
当m≥0时，由图1.6.1可见：
第)章时域离散信号和时域离散系统
33
Created by ZhuangHeng
数字信号处理(第五版)
r?(m)=∑=(n)x(n-m)=∑ara"=a∑(a2)
因为a<1,无限级数收敛，所以有
r?(m)=a∑(a2)°= m≥0
x(n)
1
…-2-101 23… n
(a)
x(n-m)
1
m>0
0 m n
(b)
m
xn-m)
m<0
册 0
(c)
1
nm)
…-2-1012… m
(d)
图1.6.1 信号x(n)=a"u(n)的自相关函数运算示意图
当m<0时，由图1.6.1可见：
r.(m)=∑=(n)r(n-m)=∑aa=a∑(a3)= m<0
因为m<0时，a"=a",于是，r,(m)的上述两段表示式可以合并为
r?(m)=1 -∞<m<0 (1.6.10)
自相关函数r?(m)如图1.6.1所示。由图可以观察到，r,(m)是偶对称函数，即r?(-m)=
r,(m)。后面会证明，自相关函数都是偶函数。
【例1.6.2】 已知序列x(n)和y(n)分别为
x(n)=(…,0,0,2,-1,3,7,1,2,-3,0,0,…
y(n)=(…,0,0,1,-1,2,-2,4,1,-2,5,0,0,…
求x(n)和y(n)的互相关函数r。(m)。
34
Created by ZhuangHeng
解 序列x(n)和y(n)均为有限长序列，但不是因果序列，所以不能直接套用式(1.6.6),
必须用式(1.6.1)计算。
r。(m)=∑x(n)y(n),乘积序列 (1)当m=0时，
v?(n)=x(n)y(n)={…,0,0,2,1,6,-14,4,2,6,0,0.0,…}
对于n的所有值，对乘积序列各项求和，可得
ra(m)=∑u(n)=2+1+6-14+4+2+6=7
(2)当m>0时，只要将y(n)相对x(n)向右平移m个时间单位，得到y(n-m),再计
r?(m)=∑v(n)可得 算乘积序列v.(n)=x(n)y(n-m),最后求
r。(1)=13;r。(2)=-18;r。(3)=16;r,(4)=-7;
r。(5)=5;r。(6)=-3;r(m)=0,m≥7
(3)当m<0时，只要将y(n)相对x(n)向左平移|m|个采样间隔，再进行同样的计算
可得
r。(-1)=0;r(-2)=33; r(-3)=-14;r(-4)=36;
r,(-5)=19;r。(-6)=-9;r(-7)=10;r,(m)=0,m≤-8
综上可得x(n)和y(n)的互相关函数r。(m)为
r(m)=(0.0.10,-9,19,36,-14,33,0,7,13,-18,16,-7,5,-3,0,0}
1.6.2 周期信号的相关性
在1.6.1节中定义了能量信号的互相关函数和自相关函数。在工程实际中，常常涉及
功率信号的相关性。下面讨论功率信号，特别是周期信号的相关性。
设x(n)和y(n)是两个功率信号，其互相关函数定义为
ra(m)=mN+(w)y(n-m) (1.6.11)
当y(n)=x(n)时，功率信号的自相关函数定义为
r(m)=2N+∑(n)xc(n-m) (1.6.12)
特别是，如果x(n)和y(n)是两个周期为N的周期信号，则式(1.6.11)和式(1.6.12)中有
限区间上的平均值就等于一个周期上的平均值，因此，式(1.6.11)和式(1.6.12)就可以简
化为
ra(m)=、2x()y(n-m (1.6.13)
r.(m)=六2z(n)a(n-m) (1.6.14)
35
Created by ZhuangHeng
第1章时域离散信号和时域离散系统
由周期信号的定义可得
口
口 口口
数字信号处理(第五版)
36
.(m+N-÷2x(n)zcn-m-M=÷2)cn-m)=;(m)
(1.6.15)
所以，周期为N的周期信号的自相关函数也是以N为周期的。这样，如果一个周期信号的
周期未知，我们可以根据其自相关函数的周期性质，估计其周期。
【例1.6.3】 已知x(n)=sin(wn),其周期为N,即w=2π/N,求x(n)的自相关函数。
解 由式(1.6.14)得
r.(m)=六2sin(an)sin(u(n-m))
-六2sin(an)Lsincan)coscm)-cos[un sin(cm)]
=1[osam]2sin2(an)-sincam]Zsin(con)csun]]
由于第二项中 sin(an)cosan)=0,第一项中
2sin(an)=2≥1-cos(2mn)]=
所以
r?(m)=2cos(am)
由此可见，正弦序列的自相关函数是同频率的余弦序列，显然自相关函数与原序列周
期相同。
1.6.3 相关函数的性质
互相关函数和自相关函数都有很重要的性质，这些性质可以使很多问题的分析和判断
更加简单。本节中，假设两个信号x(n)和y(n)均为能量信号，其能量分别为r,(0)=
∑x(n)=E.和r,(0)=∑y(n)=E,.
1.互相关函数性质
(1)r(m)不是偶函数，而且r,(m)≠r(m),但有
r。(m)=r(-m) (1.6.16)
ra(m)=∑a(n)y(n-m)=∑z(k+m)y(k)=∑y(e)x(k+m)=r?(-m) 证明
(2)r(m)满足
|r。(m)|≤√r.(0)r,(0)=√E,E, (1.6.17)
证明 生成线性组合序列
Created by ZhuangHeng
ar(n)+by(n-m)
其中，a和b为任意常数，m为整数(表示延时)。该线性组合序列的能量可以表示为
∑Car(m)+byn-mP=a2(m)+b∑y(n-m)+2b 2a(ns(n-m)
=a2r.(0)+b2r,(0)+2abr。(m) (1.6.18)
我们知道能量是非负的，所以下式成立：
a2r.(0)+b2r,(0)+2abr。(m)≥0 (1.6.19)
假设b≠0,则式(1.6.19)两边除以b2得
r.(0)(号)+2r。(m)(号)+r,(0)≥0
(方)的一元二次方程，其三个系数分别为 r?(0)、2r。(m)和r,(0)。由于方 把上式看成关于
程非负，所以二次判别式非正，即
4[r2(m)-r?(0)r,(0)]≤0
由上式可得互相关函数满足的条件：
|r。(m)|≤Vr?(O)r,(0)=√E,E,
如果互相关函数中任一信号或两个信号的幅度增大或缩小，其互相关函数的形状不会
改变，只是其幅度随之发生变化。由于相关函数幅度并不重要，所以为了检测判决方便，实
际中通常把互相关函数和自相关函数归一化到[-1,1]上。为此，定义归一化互相关函数为
e。(m)=O,-VEE, (1.6.20)
(3)r,(m)满足
limr(m)=0 (1.6.21)
式(1.6.21)说明，将y(n)相对x(n)移至无穷远处，则二者无相关性。这是因为一般能
量信号都是有限非零时宽的，所以当m→∞时，x(n)和y(n-m)的非零区不重叠，则式
(1.6.21)成立。
2.自相关函数性质
(1)若x(n)是实信号，r,(m)是实偶函数，即
r?(m)=r,(-m) (1.6.22)
当式(1.6.16)中y(n)=x(n)时，即可得式(1.6.22)。若x(n)是复信号，则r?(m)是共轭对
称函数，即r(m)=r(-m)。
(2)r,(m)在m=0时取得最大值，即r,(0)≥r,(m)。
证明 令式(1.6.17)中y(n)=x(n),则|r?(m)|≤√r?(0)r?(0)=r?(0),因此满足
r,(0)≥r(m)。
同理，定义归一化自相关函数为
e?(m)=7(mEm (1.6.23)
(3)对于能量信号x(n),将x(n)相对自身移至无穷远处，则二者不相关。即
37
Created by ZhuangHeng
第1章
时域离散信号和时域离散系统
数字信号处理(第五版)
38
limr,(m)=0 (1.6.24)
1.6.4 输入信号与输出信号的相关函数
下面讨论时域离散线性时不变系统输出信号与输入信号的互相关函数。假设系统输入
信号x(n)的自相关函数r?(m)已知，系统单位脉冲响应为h(n),系统输出信号为
y(n)=h(n)*z(n)=∑h(k)z(n-k)
由式(1.6.2)可知，输出信号与输入信号的互相关函数可表示为
r,(m)=y(m)*x(-m)=h(m)*x(m)*x(-m)
=h(m)*[x(m)*x(-m)]
=h(m)*r,(m) (1.6.25)
由式(1.6.25)可见，输出信号与输入信号的互相关函数等于系统单位脉冲响应h(m)
与输入信号自相关函数r(m)的卷积。所以，r(m)可以看成线性时不变系统对输入序列
r,(m)的响应输出，如图1.6.2所示。
r(m) rn(m) LTI系统
图1.6.2 r(m)的输入与输出关系
在式(1.6.2)中令x(n)=y(n),再利用卷积的性质，可以得到系统输出信号的自相关
函数r,(m):
r,(m)=y(m)*y(-m)=[h(m)*x(m)]*[h(-m)*x(-m)]
=[h(m)*h(-m)]*[x(m)*x(-m)]
=r(m)*r?(m)
h(m)
(1.6.26)
如果系统稳定，则h(n)为能量信号，r(m)存在。这样，如果r,(m)存在，则r,(m)存
在，即输出信号也是能量信号。在式(1.6.26)中令m=0,可得输出信号的能量为
,(0=∑r(n)r.(n) (1.6.27)
式(1.6.27)以相关函数的形式给出了输出信号的能量。实际上，本节所得输入信号与输出
信号的相关函数关系式对于能量信号和功率信号都适用。
1.6.5 相关函数的应用
如前所述，相关运算用来衡量两个信号之间的相似程度，并提取相关的有用信息。相
关函数的应用很广，在雷达、声呐、数字通信、地质和其他科学和工程领域的信号的相关性
分析中都有广泛的应用，例如噪声中信号的检测、信号中隐含周期性的检测、信号相关性
的检测、信号延时时间的测量等。
1.相关函数在雷达和主动声呐系统中的的应用
假设信号序列x(n)和y(n)是我们需要比较的两路信号，在雷达和主动声呐系统中，
Created by ZhuangHeng
x(n)一般是发射信号的采样，而y(n)表示接收端A/D变换器输出的信号。如果目标是某
个被雷达或声呐搜索的物体，则接收信号y(n)由发射信号被目标反射，并经加性噪声污染
后的延迟信号组成。雷达目标检测示意图如图1.6.3所示。
图1.6.3 雷达目标检测示意图
接收信号y(n)可以表示为
y(n)=ax(n-D)+w(n) (1.6.28)
其中，a是衰减因子，表示发射信号x(n)在发射信道和反射信道中的损耗；D是延迟量(假
设D为采样间隔的整数倍);w(n)表示天线接收到的加性噪声以及接收机前端电子器件或
放大器产生的噪声。如果在雷达或声呐搜索空间没有目标，则接收信号y(n)仅含有噪声信号
w(n)。
通常称x(n)为发射信号或参考信号，称y(n)为接收信号或观测信号。雷达探测的目的
是通过比较x(n)和y(n),判断目标是否存在。如果存在，则通过求延迟D来确定目标的距
离。工程实际中，由于加性噪声的污染严重，已经不可能从y(n)的波形判断目标是否存在，
而相关函数却提供了良好的检测方法。接收信号与发射信号的相关函数为
ra(m)=∑y(n)r(n-m)-∑[ar(n-D)+u(n)]a(n-m)
-∑ar(n-Da(n-m)+Zu(n)x(n-m)
=ar.(m-D)+r(m) (1.6.29)
由于信号x(n)与噪声w(n)的相关性很小，即r(m)非常小，所以当目标不存在时，无反
射信号，r(m)=r(m)≈0;当目标存在时，r(m)≈ar,(m-D),当m=D时，r(m)取
得最大值，r,(m)=r(D)≈ar?(0)=aE。这时雷达检测到目标，并根据r(m)取得最大
值时的m值换算出目标距离。
2.使用相关函数检测物理信号隐含的周期性
在实际应用中，自相关函数可以用来检测被随机噪声污染的观测物理信号y(n)隐含的
周期性。
假设
第1章时域离散信号和时域离散系统
y(n)=x(n)+w(n) (1.6.30)
39
Created by ZhuangHeng
数字信号处理(第五版)
40
其中，x(n)是一个未知周期N的周期信号，w(n)表示加性随机干扰噪声。假定观测到y(n)
的M个采样值，观测区间为0≤n≤M-1,且M>N。实际计算时，可以将y(n)看作长度
为M的因果序列，并引入归一化因子1/M,则y(n)的自相关函数为
,(m)=六2y(n)y(n-m)
=六Z[z(n)+ucn]J[r(n-m)+u(n-m)]
=mZz(n)x(n-m)+六Zr(n)ucn-m)+
2ucn)a(n-m)+m2ucn)u(n-m)]
=r.(m)+r(m)+r(m)+r(m) (1.6.31)
式(1.6.31)等号右边有四项，第一项为x(n)的自相关函数r?(m),由于x(n)是周期序列，
所以r(m)也是周期序列，且周期与x(n)的周期相同，因而在m=0,N,2N,…时，r(m)
会周期性地出现较大峰值。但随着m接近M值，峰值会逐渐减小，这是因为y(n)是长度为
M的有限长序列，当m接近M值时，乘积序列x(n)x(n-m)中大多数点为零。因此，当
m>M/2时，通常就不再计算了。
设计时，一般使信号x(n)与干扰噪声w(n)完全不相关，所以式(1.6.31)右边的
r(m)和r(m)相对很小。式(1.6.31)等号右边第四项为干扰噪声的自相关函数r(m),
由于干扰噪声w(n)一般近似于白噪声，所以只有在m=0时出现峰值r(0),但会迅速衰
减到很小。所以当m>0时，只有r(m)会周期性地出现较大峰值，根据这一特点，我们就
可以从干扰噪声中检测出y(n)中是否存在周期信号x(n),并确定其周期N。
【例1.6.4】 设信号x(n)=sin(πn/5),0≤n≤199,x(n)与加性噪声w(n)混合在一
起，w(n)是在[-A/2,A/2]上均匀分布的白噪声序列，A为分布参数。观测序列是y(n)=
x(n)+w(n)。求自相关函数r,(m),并确定信号x(n)的周期。
解 本例中，假设仅知道已被噪声污染的观测信号y(n)的200个采样值，而且y(n)中
包含一周期信号x(n),但并不知道其周期是多少。现在要通过计算y(n)的自相关函数确定
x(n)的周期。噪声w(n)的功率P。由分布参数A决定，由本书9.1.2节的式(9.1.3b)可
知，P=A2/12,信号x(n)的功率P,=1/2,因此信噪比(S/N)为
-春一是
通常，S/N以对数表示：S/N=10lg(P,/P),单位为dB。当S/N=10lg(P,/P)=
1 dB时，A=√6/10;当S/N=10lg(P,/P)=5dB时，A=√6/10°。
在1.6.6节中，将编写程序ep164.m,并运行，可产生S/N=1 dB时的噪声w(n)、观
测信号y(n)=x(n)+w(n)和y(n)的自相关函数r,(m),分别如图1.6.4(a)、(b)和(c)所
示；S/N=5dB时的噪声 w(n)、观测信号y(n)=x(n)+w(n)和y(n)的自相关函数
Created by ZhuangHeng
r,(m),分别如图1.6.5(a)、(b)和(c)所示。
2
(a) m然 0
-2 10 20 30 40 50 60 70 8090 100
n
2
(b) )(n 0
-2 10 20 30 40 50
n
60 70 80 90 100
(c) )mr 0
-1-50 40-30)-20 -10 0
m
10 20 3040 50
图1.6.4 干扰噪声、观测信号和观测信号自相关函数波形(S/N=1 dB)
2
(a)
-2 10 20 30 40 50 60 70 80 90 100
n
2
(b) f(n 0
-2 10 20 30 40 50 60 70 80 90100
n
1
(c) r用) 0
-1-50 -40 -30 -20 -10 0 10 20 30 40 50
m
图1.6.5 干扰噪声、观测信号和观测信号自相关函数波形(S/N=5 dB)
从图1.6.4(b)可看出，由于受到干扰噪声影响，很难由观测信号y(n)直接确定x(n)
的周期。但从图1.6.4(c)可看出，除了m=0处出现很大峰值以外，r,(m)是以10为周期
的，这正是y(n)中周期信号x(n)的自相关函数导致的，所以可以确定x(n)的周期为10。
r(0)的峰值是由白噪声w(n)的自相关函数导致的。
从图1.6.5(b)可看出，即使噪声功率较小，观测信噪比达到5dB,也很难直接由观测
信号y(n)确定x(n)的周期，但观察y(n)的自相关函数却很容易确定x(n)的周期。
第1章时域离散信号和时域离散系统
另外，MATLAB中的 rand 函数每次运行产生的随机信号可能不相同，所以程序
ep164.m每次运行时产生的w(n)和y(n)波形可能不相同。
1.6.6 用MATLAB计算相关函数
MATLAB包含多个可以产生各种常用信号的工具箱函数，例如 rand和 randn 函数可
41
Created by ZhuangHeng
数字信号处理(第五版)
以产生两种白噪声序列。此外，MATLAB还包含多个实现各种计算的函数，例如与本节有
关的xcorr函数可以计算相关函数。下面先介绍rand 函数和xcorr 函数，最后编写程序求
解例1.6.4。
1. rand函数
rand 函数用于产生均值为0.5,幅度在[0,1]上均匀分布的伪随机序列，在数字信号处
理中常用于模拟近似均匀分布的白噪声信号w(n)。理想的白噪声信号w(n)的功率谱是一
个常数，其自相关函数r。(m)=a2o(m),即仅在m=0时r(m)有值，m取其他值时r(m)
皆为零。其中，是w(n)的方差，即w(n)的平均功率：
=六2(ucn)-m,J2 (1.6.32)
式中m。表示w(n)的均值。rand 函数产生的w(n)的功率c2=1/12,m,=0.5。
rand函数的调用格式如下：
· w=rand(N);??生N维列向量w
·w=rand(M,N);??生M×N维矩阵w
请读者注意，另一个函数 randn可产生均值为0,方差(功率)为1,服从高斯分布的白
噪声，其调用格式与rand函数相同。
2.xcorr 函数
xcorr函数用于计算信号的互相关函数或自相关函数。xcorr函数的两种调用格式
如下：
· rxy= xcorr(x,y);??算序列x和y的互相关函数
如果x和y的长度都是N,则r。的长度为2N-1;如果x和y的长度不相等，则将短
的序列后面补零，再按照长度相等方法计算。
·rx=xcorr(x,M,'flag);??算序列x的自相关函数
M表示自相关函数r?的单边长度，总长度为2M+1;flag是定标标志，若flag=
biased,则表示有偏估计，需将r?(m)都除以N,见式(1.6.14);若flag=unbiased,则表示
无偏估计，需将r?(m)都除以N-abs(m)。若flag缺省，则r?不定标。M和 flag同样适用
于求互相关函数。
求解例1.6.4的程序为ep164.m,程序运行结果如图1.6.4和图1.6.5所示。
??1.6.4求解程序ep164.m
clear
??置信号和噪声序列长度N,y(n)自相关函数单边长度M N=200;M=50;
?R=1 dB时，计算噪声分布参数A Al=sqrt(6/10-0.1);
n=0:N-1;
w=Al*(rand(1,N)-0.5);??生白噪声，均值为零，在[-A1/2,A1/2]上均匀分布
x=sin(pi*n/5); ??生信号x(n)的200个值
y=x+w: ?n)=x(n)+w(n)
ry=xcorr(y,M,'biased');??算y(n)的自相关函数的2M+1个值
42
Created by ZhuangHeng
m=-M:M; ??相关函数的2M+1个值对应的自变量m=-M,…,0,…,M
figure(1)
subplot(3,1.1);stem(n,w.'.5);axis([1.100,-2.2]);
xlabel('n');ylabel('w(n));title('(a))
subplot(3,1,2);stem(n,y,'.');axis([1,100,-2,2]);
xlabel('n'):ylabelC'y(n)');title('(b))
subplot(3,1.3);stem(m,ry.'.');
xlabel'm');ylabel('ry(m));title('(c)')
?=======
A2=sqrt(6/10-0.5); ?N=5 dB时，计算噪声分布参数A
w=A2*(rand(1,N)-0.5);??生白噪声，均值为零，在[-A2/2,A2/2]上均匀分布
y=x+w; ?n)=x(n)+w(n)
ry=xcorr(y,M,'biased');??算y(n)自相关函数的2M+1个值
m=-M:M; ??相关函数的2M+1个值对应的自变量m=-M….0,…,M
figure(2)
subplotC3,1.1);stem(n,w.'.);axis([1,100,-2,2]);
xlabelC'n');ylabel('w(n));title('(a))
subplot(3,1,2);stem(n,y,'.);axis([1,100,-2,2]);
xlabelC'n');ylabelC'y(n));title('(b))
subplot(3,1,3);stem(m,ry,'.);
xlabel('m);ylabel('ry(m)');title('(c)')
习题与上机题 第1章
1.用单位脉冲序列8(n)及其加权和表示题1图所示的序列。
x(n)
4
2 2 2 2
1 0.5 -3 -1
-4 -2 0 1 2 3 4 56 n
时域离散信号和时域离散系统
-1
题1图
2.给定信号：
-
43
Created by ZhuangHeng
口
口
口
口
口
数字信号处理(第五版)
(1)画出x(n)序列的波形，标上各序列值；
(2)试用延迟的单位脉冲序列及其加权和表示x(n)序列；
(3)令x?(n)=2x(n-2),试画出x?(n)波形；
(4)令x?(n)=2x(n+2),试画出x?(n)波形；
(5)令x?=x(2-n),试画出x?(n)波形。
3.判断下面的序列是否是周期的；若是周期的，确定其周期。
(1)r(n)=A cos(7π-8) A是常数
(2)x(n)=e(=)
4.对题1图给出的x(n)要求：
(1)画出x(-n)的波形；
(2)计算x。(n)=2[x(n)+z(-n)],并画出x。(n)波形；
x。(n)=2[a(n)-x(-n)],并画出x。(n)波形； (3)计算a
(4)令x?(n)=x(n)+x。(n),将x?(n)与x(n)进行比较，你能得到什么结论?
5.设系统分别用下面的差分方程描述，x(n)与y(n)分别表示系统输入和输出，判断
系统是否是线性非时变的。
(1)y(n)=x(n)+2x(n-1)+3x(n-2)
(2)y(n)=2x(n)+3
(3)y(n)=x(n-n) n。为整常数
(4)y(n)=x(-n)
(5)y(n)=x2(n)
(6)y(n)=x(n2)
(7)y(n)=x(m)
(8)y(n)=x(n)sin(wn)
6.给定下述系统的差分方程，试判定系统是否是因果稳定系统，并说明理由。
(1)y(n)=六2z(n-k)
(2)y(n)=x(n)+x(n+1)
(3)ysm)-D)
(4)y(n)=x(n-n?)
(5)y(n)=e2
44
Created by ZhuangHeng
7.设线性时不变系统的单位脉冲响应h(n)和输入序列x(n)如题7图所示，要求画出
输出y(n)的波形。
h(n) x(n)
2 2
1 0.5 1
-2
01234 n -10 12 34 n
-1
题7图
8.设线性时不变系统的单位脉冲响应h(n)和输入x(n)分别有以下三种情况，分别求
出输出y(n)。
(1)h(n)=R,(n),x(n)=R?(n)
(2)h(n)=2R?(n),x(n)=8(n)-8(n-2)
(3)h(n)=0.5"u(n),x=R?(n)
9.证明线性卷积服从交换律、结合律和分配律，即证明下面等式成立：
(1)x(n)*h(n)=h(n)*x(n)
(2)x(n)*(h?(n)*h?(n))=(x(n)*h?(n))*h?(n)
(3)x(n)*(h?(n)+h?(n))=x(n)*h?(n)+x(n)*h?(n)
10.设系统的单位脉冲响应h(n)=(3/8)0.5"u(n),系统的输入x(n)是一些观测数据，
设x(n)={x?,x?,T?,…,x,…》,试利用递推法求系统的输出y(n)。递推时设系统初始
状态为零状态。
11.设系统由下面差分方程描述：
y(n)=2y(n-1)+x(n)+x(n-1)
设系统是因果的，利用递推法求系统的单位脉冲响应。
12.设系统用一阶差分方程y(n)=ay(n-1)+x(n)描述，初始条件y(-1)=0,试分
析该系统是否是线性非时变系统。
13.有一连续信号x,(t)=cos(2πft+φ),式中，f=20 Hz,φ=π/2。
(1)求出x,(t)的周期；
(2)对x(t)进行采样，采样间隔T=0.02 s,试写出采样信号x(t)的表达式；
(3)画出对应x(t)的时域离散信号(序列)x(n)的波形，并求出x(n)的周期。
14.已知滑动平均滤波器的差分方程为
y(n)=号(z(n)+x(n-1)+z(n-2)+z(n-3)+x(n-4))
(1)求出该滤波器的单位脉冲响应；
(2)如果输入信号波形如题14图所示，试求出y(n)并画出它的波形。
第)章时域离散信号和时域离散系统
45
Created by ZhuangHeng
口
数字信号处理(第五版)
2
1.8
1.6
1.4
1.2
x(n) 10
0.8
0.6
0.4
0.2
oL0
9999999999 I IIi IIIiIIiI9Ii
9
5 10 15 20 25 30 35
n
题14图
15°.已知系统的差分方程和输入信号分别为
y(n)+y(n-1)=x(n)+2x(n-2)
x(n)={1,2,3,4,2,1}
用递推法计算系统的零状态响应。
16°.已知两个系统的差分方程分别为
(1)y(n)=0.6y(n-1)-0.08y(n-2)+x(n)
(2)y(n)=0.7y(n-1)-0.1y(n-2)+2x(n)-x(n-2)
分别求出所描述的系统的单位脉冲响应和单位阶跃响应。
17*.已知系统的差分方程为
y(n)=-a?y(n-1)-a?y(n-2)+bx(n)
其中，a?=-0.8,a?=0.64,b=0.866。
(1)编写求解系统单位脉冲响应h(n)(0≤n≤49)的程序，并画出h(n)(0≤n≤49);
(2)编写求解系统零状态单位阶跃响应s(n)(0≤n≤100)的程序，并画出s(n)(0≤n≤
100)。
18*.在题18图中，有四个分系统T?、T?、T?和T?,四个分系统分别用下面的单位脉
冲响应或者差分方程描述：T T?:h?(m)={0其他.23,4,5
46
Created by ZhuangHeng
T?:y,(n)=—x(n)+2x(n-1)+—z(n-2)
T?:y(n)=0.9y(n-1)-0.81y(n-2)+v(n)+v(n-1)
编写程序计算整个系统的单位脉冲响应h(n),0≤n≤99。
x(n)
T? T?
+
z(n) T? y(n)
T? ;(n)
题18图
19.已知序列x?(n)=a"u(n),0<a<1,x?(n)=u(n)-u(n-N),分别求它们的自相
关函数，并证明二者都是偶对称的实序列。
20.设x(n)=e,n=0,1,2,…,,T为采样间隔。求x(nT)的自相关函数r.(mT)。
21.已知x(n)=Asin(2πf?nT)+Bsin(2πf?nT),其中A,B,f,f?均为常数。求
x(n)的自相关函数r(m)。
22*.设x(n)=Asin(wn)+w(n),其中w=π/6,w(n)是均匀分布的白噪声。
(1)调用MATLAB函数 rand,产生均匀分布，均值为0,功率P=0.1的白噪声信号
w(n),画出w(n)的时域波形，并求 w(n)的自相关函数r(m),画出r(m)的波形。
(2)欲使x(n)的信噪比为10 dB,试确定A的值，编程产生x(n),画出x(n)的时域波
形，并求x(n)的自相关函数r?(m),画出r?(m)的波形，最后从r?(m)的波形确定x(n)中
正弦序列的周期N。
第1章时域离散信号和时域离散系统
47
Created by ZhuangHeng
口
口口口
口
口口
数字信号处理(第五版)
48
第 2 章
时域离散信号和系统的频域分析
2.1 引 言
我们知道，信号和系统的分析方法有两种，即时域分析方法和频域分析方法。在模拟
领域中，信号一般用连续变量时间的函数表示，系统则用微分方程描述。在频率域，则用信
号的傅里叶变换(Fourier Transform)或拉普拉斯变换表示。而在时域离散信号和系统中，
信号用时域离散信号(序列)表示，系统则用差分方程描述。在频率域，则用信号的傅里叶
变换或Z变换表示。
本章学习序列的傅里叶变换和Z变换，以及利用Z变换分析系统和信号频域特性。该
章内容是本书也是数字信号处理的理论基础。
2.2 时域离散信号的傅里叶变换的定义及性质
时域离散信号不同于模拟信号，因此它们的傅里叶变换不相同，但都是线性变换，一
部分性质是相同的。
2.2.1 时域离散信号傅里叶变换的定义
序列x(n)的傅里叶变换定义为
x(e)=FT[x(n)]=∑x(n)e (2.2.1)
FT为Fourier Transform的缩写。FT[x(n)]存在的充分条件是序列x(n)绝对可和，即满
足下式：
∑Iz(n)I<○ (2.2.2)
Created by ZhuangHeng
为了得到傅里叶反变换公式，对公式(2.2.1)两边同时乘以e,并进行积分：
x(e)ed=[∑x(m)eed=∑x(m)d
由于
d-f[coso(n-m)+jsina(n-m)]d
-{o,m=”
所以
?x(e)ed=2mz(n)
由此可得傅里叶反变换公式：
z(n)=IFT[X(e)]=x(e)eda (2.2.3)
(2.2.1)式和(2.2.3)式组成一对傅里叶变换公式。(2.2.2)式是傅里叶变换存在的充分条件，
有些函数(例如周期序列)并不满足(2.2.2)式，说明它的傅里叶变换不存在，但如果引入冲激
函数，其傅里叶变换也可以用冲激函数的形式表示出来，这部分内容将在2.3节介绍。
【例2.2.1】 设x(n)=R、(n),求x(n)的傅里叶变换。
解 x(e)-∑R(n)e-2 =
=e-Du sincN/2)
当N=4时，其幅度与相位随频率w的变化曲线如图2.2.1所示。
x(n)
11
01 23
IX(el)1
0 π/2 π 2π
arg[X(e3")】 π
0
一π
图2.2.1 R?(n)的幅度与相位曲线
n
@
@
(2.2.4) 第2章时域离散信号和系统的频域分析
49
Created by ZhuangHeng
数字信号处理(第五版)
50
2.2.2 时域离散信号傅里叶变换的性质
1.FT的周期性
在定义(2.2.1)式中，n取整数，因此下式成立：
x(e)-2zm)c--2a(ne
=X(e+2MD)M为整数 (2.2.5)
观察上式，得到傅里叶变换是频率w的周期函数，周期是2π。这一特点不同于模拟信号的
傅里叶变换。
由FT的周期性进一步分析得到，在w=0和w=2πM附近的频谱分布应是相同的(M
取整数),在w=0,±2π,±4π,…点上表示x(n)信号的直流分量；离开这些点愈远，其频
率愈高，但又是以2π为周期，那么最高的频率应是w=π。另外要说明的是，所谓x(n)的
直流分量，是指如图2.2.2(a)所示的波形。例如，x(n)=coSan,当w=2πM,M取整数时，
x(n)的序列值如图2.2.2(a)所示，它代表一个不随n变化的信号(直流信号);当w=
(2M+1)π时，x(n)波形如图2.2.2(b)所示，它代表最高频率信号，是一种变化最快的正
弦信号。由于FT的周期是2π,一般只分析一π~十π之间或0~2π范围的频谱就够了。
cos @n cos an
1 1
… … … …
-1 1 3 5
-10 12 34 n 0 2 4 6 n
(a) w=2πM (b)w=(2M+1)π
图2.2.2 cosan 的波形
2.线性
设X?(e")=FT[x?(n)],X?(e")=FT[x?(n)],那么
FT[ar?(n)+bx?(n)]=aX?(e")+bX?(e") (2.2.6)
式中，a,b是常数。
3.时移与频移性质
设X(e")=FT[x(n)],那么
FT[x(n-n?)]=eX(e")
FT[e"x(n)]=X(e)
(2.2.7)
(2.2.8)
4.FT的对称性
在学习FT的对称性之前，先介绍什么是共轭对称与共轭反对称，以及它的性质。
设序列x(n)满足下式：
Created by ZhuangHeng
x.(n)=x(一n) (2.2.9)
则称x(n)为共轭对称序列。为研究共轭对称序列具有什么性质，将x。(n)用其实部与虚部
表示：
x,(n)=x.(n)+jx(n)
将上式两边的n用-n代替，并取共轭，得到：
x(-n)=x(-n)-jx.(-n)
对比上面两公式，因左边相等，因此得到：
x(n)=x(-n) (2.2.10)
x(n)=-x(-n) (2.2.11)
上面两式表明共轭对称序列其实部是偶函数，而虚部是奇函数。类似地，可定义满足
下式的共轭反对称序列：
x。(n)=-x(-n) (2.2.12)
将x。(n)表示成实部与虚部，如下式：
x。(n)=x(n)+jx(n)
可以得到：
x(n)=(-n) (2.2.13)
x(n)=x(-n) (2.2.14)
即共轭反对称序列的实部是奇函数，而虚部是偶函数。
【例2.2.2】 试分析 x(n)=e”的对称性。
解 因为
x(-n)=e"=x(n)
满足(2.2.9)式，所以x(n)是共轭对称序列，如展成实部与虚部，则得到：
x(n)=cOSwn+jsinwn
上式表明，共轭对称序列的实部确实是偶函数，虚部是奇函数。
一般序列可用共轭对称与共轭反对称序列之和表示，即
x(n)=x。(n)+x。(n) (2.2.15)
式中，x.(n)和x。(n)可以分别用原序列x(n)求出，将(2.2.15)式中的n用-n代替，再取
共轭，得到：
x(一n)=x(n)-x。(n) (2.2.16)
利用(2.2.15)和(2.2.16)式，得到：
x.(n)=2[a(n)+x'(-n)] (2.2.17)
x。(n)=2[x(n)-x'(-n)] (2.2.18)
利用上面两式，可以用x(n)分别求出x(n)的共轭对称分量x。(n)和共轭反对称分量x。(n)。
对于频域函数X(e"),也有和上面类似的概念和结论：
X(e")=X,(e")+X。(e") (2.2.19)
51
Created by ZhuangHeng
第2章时域离散信号和系统的频域分析
口口口
口
口口
数字信号处理(第五版)
52
式中，X(e")与X。(e")分别称为共轭对称部分和共轭反对称部分，它们满足：
X,(e")=X,(e)
X。(e")=-X。(e)
(2.2.20)
(2.2.21)
同样有下面公式成立：
x.(e)=2[x(e)+x*(e“)]
x。(e)=—[x(e)-x*(e")]
(2.2.22)
(2.2.23)
有了上面的概念和结论，下面研究FT的对称性。
(1)将序列x(n)分成实部r,(n)与虚部x?(n),即
x(n)=x,(n)+jx(n)
将上式进行傅里叶变换，得到：
X(e")=X,(e")+X。(e")
式中
x,(e)=FT[z,(n)]=∑x,(n)e
x。(e)=FTiz;(n)=i∑x(n)e
上面两式中，x,(n)和x(n)都是实数序列。容易证明：X。(e)满足(2.2.20)式，具有共轭
对称性，它的实部是偶函数，虚部是奇函数；X。(e)满足(2.2.21)式，具有共轭反对称性
质，它的实部是奇函数，虚部是偶函数。
最后得到结论：序列分成实部与虚部两部分，实部对应的傅里叶变换具有共轭对称性，
虚部和j一起对应的傅里叶变换具有共轭反对称性。
(2)将序列分成共轭对称部分x(n)和共轭反对称部分x。(n),即
x(n)=x(n)十x(n) (2.2.24)
将(2.2.17)和(2.2.18)式重写如下：
x。(n)=2[x(n)+x'(-n)]
x。(n)=2[x(n)-x'(-n)]
将上面两式分别进行傅里叶变换，得到：
FTLz.(n)]=2[X(e")+x'(e)]=Re[X(e)]=Xg(e))(2.2.25a)
FT[ra(n)]=2[x(e)-x(e")]=jlm[X(e)]=jX?(e")(2.2.25b)
因此(2.2.24)式的FT为
X(e")=XR(e")+jX?(e") (2.2.25c)
(2.2.25)式表示：序列x(n)的共轭对称部分x(n)对应着X(e")的实部Xg(e"),而序
Created by ZhuangHeng
列x(n)的共轭反对称部分x。(n)对应着X(e")的虚部(包括j)。
下面我们利用FT的对称性，分析实序列h(n)的对称性，并推导其偶函数h,(n)和奇函
数h。(n)与h(n)之间的关系。
因为h(n)是实序列，其FT只有共轭对称部分H,(e"),共轭反对称部分为零。
H(e)=H(e")
H(e")=H*(e)
因此实序列的FT是共轭对称函数，其实部是偶函数，虚部是奇函数，用公式表示为
Hg(e")=Hg(e)
H?(e")=-H?(e")
显然，其模的平方|H(e")I2=H(e")+Hi(e")是偶函数，相位函数arg[H(e)]=
arctan[H?(e")/He(e)]是奇函数，这和实模拟信号的FT有同样的结论。
如果h(n)为实因果序列，按照(2.2.17)和(2.2.18)式得到：
h(n)=h.(n)+h。(n)
h.(n)=2[h(n)+h(-n)]
h.(n)=—[h(n)-h(-n)]
因为h(n)是实因果序列，按照上面两式，h.(n)和h。(n)可用下式表示：
(2.2.26)
(2.2.27)
按照上面两式，实因果序列h(n)可以分别用h.(n)和h。(n)表示为
h(n)=h.(n)u(n) (2.2.28)
h(n)=h。(n)u+(n)+h(0)6(n) (2.2.29)
式中 第2章时域离散信号和系统的频域分析
-
(2.2.30)
因为h(n)是实序列，上面公式中h.(n)是偶函数，h。(n)是奇函数。按照(2.2.28)式，
实因果序列完全由其偶序列恢复，但按照(2.2.27)式，h。(n)中缺少n=0点h(n)的信息。
因此由h。(n)恢复h(n)时，要补充一点h(n)6(n)信息。
53
Created by ZhuangHeng
数字信号处理(第五版)
则
54
【例2.2.3】x(n)=a"u(n),0<a<1。求其偶对称分量x(n)和奇对称分量x。(n)。
解 x(n)=x(n)+x。(n)
按(2.2.26)式，得到：
按(2.2.27)式，得到：
x(n)、x(n)和x(n)波形如图2.2.3所示。
x(n)=du(n)
0 n
x?(n)
0 n
x。(n)
0 n
图2.2.3 例2.2.3图
5.时域卷积定理
设 y(n)=x(n)*h(n)
Y(e)=X(e")H(e") (2.2.31)
Created by ZhuangHeng
证明 y(n)-∑z(m)h(n-m)
Y(e)=FTSycn]=2[∑z(mh(n-m]e
令k=n-m,则
r(e)=三∑h(A)(m)ee--∑h(k)e“2z(m)e
=H(e)X(e")
该定理说明，两序列卷积的FT服从相乘的关系。对于线性时不变系统，输出的FT等
于输入信号的FT乘以单位脉冲响应的FT。因此，在求系统的输出信号时，可以在时域用
卷积公式(1.3.7)计算，也可以在频域按照(2.2.31)式，求出输出的FT,再作逆FT,求出
输出信号y(n)。
6.频域卷积定理
设
y(n)=h(n)x(n)
则
Y(e)=H(e)*X(e)=2厂H(e°)X(e)do (2.2.32)
证明
Y(e)=∑z(n)h(n)e-=∑z(n[H(e)ede]e (2.2.33)
交换积分与求和的次序，得到：
Y(e)=-H(e)[∑z(n)e]d0=-fH(e)x(e)de
=2H(e)*X(e) (2.2.34)
该定理表明，在时域两序列相乘，转移到频域时服从卷积关系。
7.帕斯瓦尔(Parseval)定理
∑Iz(m)P2=21x(e)|Pd (2.2.35)
证明
∑1z(n)I2=∑z(n)x'(n)=∑x(m[-x(e)eda]
=2x(e)∑x(n)ed
2时或焉敬言号和系统的顷或分折
=x(e5)x (e)du
=x(e)I2do
55
Created by ZhuangHeng
口口
口口
口口
口
数字信号处理(第五版)
56
帕斯维尔定理表明了信号时域的能量与频域的能量关系。
表2.2.1综合了FT的性质，这些性质在分析问题和实际应用中是很重要的。
表2.2.1 序列傅里叶变换的性质和定理
2.3 周期序列的离散傅里叶级数及傅里叶变换表示式
因为周期序列不满足(2.2.2)式绝对可和的条件，因此它的FT并不存在，但由于是周
期性的，可以展成离散傅里叶级数，引入奇异函数δ(a),其FT可以用公式表示出来。
2.3.1 周期序列的离散傅里叶级数
设(n)是以N为周期的周期序列，可以展成离散傅里叶级数。我们知道x(n)的基波
成分为e?(n)=a?e2/,k次谐波成分为e(n)=aeM。又因为e2/Nd+N=e2/,
所以，离散傅里叶级数中只有N个独立的谐波成分，展成离散傅里叶级数时，只能取
k=0～N-1的N个独立的谐波分量，k=0表示周期序列的直流成分。因此，x(n)展成离
散傅里叶级数如下：
序 列 傅里叶变换
r(n) X(e")
y(n) Y(e)
ar(n)+by(n) a、b为常数 aX(e")+bY(e")
x(n-n) eX(e")
r(n)e X(e)
x(n) X'(e)
x(-n) X(e)
r(n)*y(n) X(e)Y(e")
r(n)y(n) [x(e)Y(e)d
nr(n) jaxCe
Re[r(n)] X,(e“)
jIm[x(n)] X。(e")
x(n) Re[X(e")]
r。(n) jlm[X(e")]
∑lz(m)P-去Ixe)Pd 帕斯瓦尔定理：
(m)=2 (2.3.1)
Created by ZhuangHeng
为求系数a,将上式两边乘以e,,并对n在一个周期N中求和，即
2zme--22]e--2.
式中
2-{8A≠m (2.3.2)
(2.3.2)式的证明作为练习请读者自己证明。因此
a=六(m)e 0≤k≤N-1 (2.3.3)
式中，k和》均取整数。因为e=e,1取整数，即e是周期为N的周期函
数。所以，系数a,也是周期序列，满足a=a+N。
为了与第3章介绍的离散傅里叶变换(DFT)相比较，令X(k)=Na,并将(2.3.3)式
代入，得到：
(k)=∑z(n)e -0<k<0 (2.3.4)
式中，X(k)也是以N为周期的周期序列，称为(n)的离散傅里叶级数系数，用DFS
(Discrete Fourier Series)表示。
六X(k)代替(2.3.1)式中的a,得到： 用
(m)=六x()e (2.3.5)
将(2.3.4)式和(2.3.5)式重写如下：
X(A)=DFSG(m)=∑(m)e
()=IDFSCX(k)]=六2x()e
(2.3.6)
(2.3.7)
(2.3.6)式和(2.3.7)式称为一对DFS。(2.3.5)式表明将周期序列分解成N次谐波，第k
个谐波频率为w=(2π/N)k,k=0,1,2,…,N-1,幅度为(1/N)X(k)。基波分量的频率是
2π/N,幅度是(1/N)X(1)。一个周期序列可以用其DFS系数X(k)表示它的频谱分布规律。
【例2.3.1】设x(n)=R?(n),将x(n)以N=8为周期进行周期延拓，得到如图2.3.1
(a)所示的周期序列x(n),周期为8,求DFS[(n)]。
解 按照(2.3.6)式，有
×(6)=2acme“-立e1
第2章时域离散信号和系统的频域分析
57
Created by ZhuangHeng
口
口
口
口口
口
口
口
口口
0口
口
口0
数字信号处理(第五版)
58
其幅度特性|X(k)|如图2.3.1(b)所示。
(n)
1
(a)
01234567 n
1X(k)t
(b)
0 12 34 567 k
图2.3.1 例2.3.1图
2.3.2 周期序列的傅里叶变换表示式
在模拟系统中(见参考文献[28]),x。(t)=e°',其傅里叶变换是在Ω=Ω。处的单位冲
激函数，强度是2π,即
X,(j2)=FT[x?(z)]=edt=2π8(Ω-Ω) (2.3.8)
对于时域离散信号，x(n)=e",-π≤w?≤π,2π/w。为有理数，暂时假定其FT的形
式与(2.3.8)式一样，即是在w=w。处的单位冲激函数，其强度为2π。但由于n取整数，下
式成立：
e=e+2 r取整数
因此e"的FT为
x(e)=FTe"J=∑2mo(m--2mr) (2.3.9)
(2.3.9)式表示复指数序列的FT是在w。+2πr处的单位冲激函数，强度为2π,如图2.3.2
所示。但这种假定如果成立，则要求按照(2.3.9)式的逆变换必须存在，且唯一等于e",
下面进行验证。按照IFT定义，对(2.3.9)式两边进行 IFT,得到：
厂x(e)ed=∑2mo(m-a-2)ed
观察图2.3.2,在一π~+π区间，只包括一个单位冲
激函数δ(w-w),等式右边为e",因此得到下式：
X(e)
2π =x(e)ed=IFT[X(e)] 一
0叫π 2π @
证明了(2.3.9)式确实是e"的FT,前面的暂时
假定是正确的。
图2.3.2 e"的FT
对于一般周期序列x(n),按(2.3.7)式展成DFS,第k次谐波为(X(k)/N)e,类似
于复指数序列的FT,其FT为
Created by ZhuangHeng
2nX(k)6(m-2k-2m)
因此x(n)的FT如下式：
x(e)=FT[G(n)]=22X(k8(a---2m)
式中，k=0,1,2,…,N-1。如果让k在-○~区间变化，上式可简化成
x(eC)=2×(k)6(--) (2.3.10)
式中 X(k)=()e
(2.3.10)式就是周期序列的傅里叶变换表示式。需要说明的是，上面公式中的8(w)表
示单位冲激函数，而δ(n)表示单位脉冲序列，由于括弧中的自变量不同，因而不会引起
混淆。
表2.3.2中综合了一些基本序列的FT。
表2.3.2 基本序列的傅里叶变换
序列 傅里叶变换
8(n) 1
la|<1 a"u(n) (1-ae)
R(n) esin(/2
u(n) 1-e~)1+∑no(c-2)
x(n)=1 2m2acm-2xk)
 2π/m。为有理数，a∈[-π,π] 2∑8m--2x)
2π/m。为有理数，m∈[-π,π] cosan “∑[6(-m-2m)+a(+-2mD]
sinann π/ws为有理数，a∈[-π,π] -im 2[6cm-m-2mD0-8(+m-2mD]
第2章
表中u(n)序列的傅里叶变换推导如下：
用x(n)表示u(n)的交流分量，u(n)的直流分量为1/2,所以，
x(n)=u(n)- (2.3.11)
时域离散信号和系统的频域分析
用差分关系求x(n)的FT:
r(n-1)=u(n-1)-2
x(n)-x(n-1)=u(n)-u(n-1)=8(n) (2.3.12)
对(2.3.12)式进行FT,得到：
59
Created by ZhuangHeng
口
口
口
口口
口口
口
数字信号处理(第五版)
x(e)=
应当注意，如果信号有直流分量，差分运算就丢失了直流信息，所以不能用上述方法。对
(2.3.11)式进行FT,得到：
x(e)=Ue)-m∑8(m-2πk)
U(e)=1+2mo(u-2mk)
【例2.3.2】求例2.3.1中周期序列的FT。
解 将例2.3.1中得到的X(k)代入(2.3.10)式中，得到：
x(e)=∑esin(rk/8)8(m-4k)
其幅频特性如图2.3.3所示。
?(n)
1
(a)
01234567 n
iX(el")I
(b)
4344 4
@
图2.3.3 例2.3.2图
对比图2.3.1,对于同一个周期信号，其DFS和FT的模的形状是一样的，不同的是
FT用单位冲激函数表示(用带箭头的竖线表示)。因此周期序列的频谱分布用其DFS或者
FT表示都可以，但画图时应注意单位冲激函数的画法。
【例2.3.3】 令(n)=coSw?n,2π/w。为有理数，求其FT。
解 将x(n)用欧拉公式展开：
i(n)=2[e”+e"]
按照(2.3.9)式，其FT推导如下：
x(e)=FT[coson]=县·2π2[8(m-m-2w)+8(u+-2)]
=π∑[8(m--2mr)+8(u+a-2mr)] (2.3.13)
(2.3.13)式表明，coSau,n的FT是在w=±w。处的单位冲激函数，强度为π,且以2π
为周期进行延拓，如图2.3.4所示。
60
Created by ZhuangHeng
x(e)
-2π一π-a0 2π @
图2.3.4 cosan的FT
2.4 时域离散信号的傅里叶变换与模拟信号
傅里叶变换之间的关系
时域离散信号与模拟信号是两种不同的信号，傅里叶变换也不同，如果时域离散信号
是由某模拟信号采样得来，那么时域离散信号的傅里叶变换和该模拟信号的傅里叶变换之
间有一定的关系。下面推导这一关系式。
公式x(n)=x(t)l=r=x(nT)表示了由采样得到的时域离散信号和模拟信号的关
系，而理想采样信号x(t)和模拟信号的关系用(1.5.2)式表示，重写如下：
立.0)=∑zx,(nT)(t-nT)
对上式进行傅里叶变换，得到：
X.Gin)=t.(Ded=厂[∑z.(nT)8(-nT)]ed
-∑x(nT)8(t-nT)e"d
=∑z.T)e8(-nT)d
-∑z.NT)e
对比(2.2.1)式，并令w=ΩT,且x(n)=x(nT),得到：
X(e)=X,(jΩ) (2.4.1)
由(1.5.5)式得
x(e)=÷2x.Gin-jA2.) (2.4.2) 第2章时域离散信号和系统的频域分析
式中
0.=2πF,=
(2.4.2)式也可以表示成
x(e)=xGia)la--÷2x.(-n) (2.4.3)
61
Created by ZhuangHeng
口口
口
口口
口口
口口
口
数字信号处理(第五版)
(2.4.1)、(2.4.2)和(2.4.3)式均表示时域离散信号的傅里叶变换和模拟信号傅里叶变换
之间的关系。由这些关系式可以得出两点结论。一点结论是时域离散信号的频谱也是模拟
0.=2πF,=7,因此由模拟信号进行采样得到时域离散信 信号频谱的周期性延拓，周期为
号时，同样要满足前面推导出的采样定理，采样频率必须大于等于模拟信号最高频率的2
倍以上，否则也会产生频域混叠现象，频率混叠在Ω,/2附近最严重，在数字域则是在π附
近最严重。另一点结论是计算模拟信号的FT可以用计算相应的时域离散信号的FT得到，
方法是：首先按照采样定理，以模拟信号最高频率的两倍以上频率对模拟信号进行采样
得到时域离散信号，再通过计算机对该时域离散信号进行FT,得到它的频谱函数，截取
[-π,π]上的主值区，再乘以采样间隔T便得到模拟信号的FT,注意关系式w=ΩT。
按照数字频率和模拟频率之间的关系，在一些文献中经常使用归一化频率f=f/F,
或Ω'=Ω/Ω,w'=a/2π,因为f、Q'和w'都是无量纲量，刻度是一样的，将f、Ω、w、f、
Ω'、o的定标值对应关系用图2.4.1表示。
-F -F,/2 0 F./2 F
i-0.5 i-1 10
-Q -Q,/2 0
10.5
0/2
{-1
-2π
-0.5 0
一π 0
0.5
11 f
Ω
1 g
2π 0
-1 -0.5 0 0.5 1 a
图2.4.1 模拟频率与数字频率之间的定标关系
图2.4.1表明，模拟折叠频率F,/2对应数字频率π;如果采样定理满足，则要求模拟
最高频率f。不能超过F,/2;如果不满足采样定理，则会在w=π附近，或者f=F./2附近
引起频率混叠。以上几个频率之间的定标关系很重要，尤其在模拟信号数字处理中，经常
需要了解它们的对应关系。
2.5 序列的Z变换
在模拟信号和系统中，用傅里叶变换进行频域分析，拉普拉斯变换可作为傅里叶变换
的推广，对信号和系统进行复频域分析。在时域离散信号和系统中，用序列的傅里叶变换
进行频域分析，Z变换则是其推广，用以对序列和系统进行复频域分析。通过Z变换，时域
离散信号的卷积运算变成乘法运算，系统的差分方程变成代数方程，从而使分析更加方便。
因此Z变换在数字信号处理中同样起着很重要的作用。
2.5.1 Z变换的定义
序列x(n)的Z变换定义为
62
Created by ZhuangHeng
x(2)=∑z(n (2.5.1)
式中，z是一个复变量，它所在的复平面称为z平面。注意在定义中，对n求和是在
-0、十∞之间求和，称为双边Z变换。还有一种称为单边Z变换的定义，如下式：
x(2)=∑x(n) (2.5.2)
这种单边Z变换的求和限是从零到无限大，因此对于因果序列，用两种Z变换定义计算的
结果是一样的。本书中如不另外说明，均用双边Z变换对信号和系统进行分析。
(2.5.1)式Z变换存在的条件是等号右边级数收敛，要求级数绝对可和，即
∑Iz(n)s"I<○ (2.5.3)
使(2.5.3)式成立时，变量z取值的域称为Z变换的收敛域。一般收敛域为环状域，即
R_<|zl<R
令z=re",代入上式得到R_<r<R_,收敛域是分别以R和R,为收敛半径的两个圆
形成的环状域(如图2.5.1中所示的斜线部分)。当然，R_可以小到零，R可以大到无穷
大。收敛域的示意图如图2.5.1所示。
Imfzl
R
0 R. Re[z]
图2.5.1 Z变换的收敛域
常用的Z变换是一个有理函数，用两个多项式之比表示：
X(z)=P()
分子多项式P(z)的根是X(z)的零点，分母多项式Q(z)的根是X(z)的极点。在极点处Z
变换不存在，因此收敛域中没有极点，收敛域总是用极点限定其边界。
对比序列的傅里叶变换定义(2.2.1)式，很容易得到傅里叶变换和Z变换(ZT)之间的
关系，用下式表示：
X(e")=X(z)|- (2.5.4)
式中，z=e表示在z平面上r=1的圆，该圆称为单位圆。(2.5.4)式表明单位圆上的Z变
换就是序列的傅里叶变换。如果已知序列的Z变换，就可用(2.5.4)式很方便地求出序列的
傅里叶变换，条件是收敛域中包含单位圆。
【例2.5.1】 x(n)=u(n),求其Z变换。
第2章时域离散信号和系统的频域分析
63
Created by ZhuangHeng
口
口
口
口口口
口
口口
口
口
口口
数字信号处理(第五版)
64
解 X(2)-∑un)z7-
X(z)存在的条件是|z1|<1,因此收敛域为|z|>1,因此
X(z)= IzI>1
X(z)表达式表明，极点是z=1,单位圆上的Z变换不存在，或者说收敛域不包含单位圆，
因此其傅里叶变换不存在，更不能用(2.5.4)式求傅里叶变换。该序列的傅里叶变换不存
在，但如果引进奇异函数δ(w),其傅里叶变换则可以表示出来(见表2.3.2)。该例同时说
明一个序列的傅里叶变换不存在，但在一定收敛域内Z变换是可以存在的。
2.5.2 序列特性对收敛域的影响
序列的特性决定其Z变换收敛域，了解序列特性与收敛域的一般关系，对使用Z变换
是很有帮助的。
1.有限长序列
如序列x(n)满足下式：
-{其他”
即序列x(n)从n?到n?的序列值不全为零，此范围之外序列值为零，这样的序列称为有限
长序列。其Z变换为
x(a)-a(ns
设x(n)为有界序列，由于是有限项求和，除0与∞两点是否收敛与n?、n?取值情况有
关外，整个z平面均收敛。如果n?<0,则收敛域不包括一点；如果n?>0,则收敛域不包括
z=0点；如果是因果序列，收敛域包括z=点。具体有限长序列的收敛域表示如下：
n?<0,n?≤0时，0≤lzl<∞
n?<0,n?>0时，0<|z|<
n?≥0,n?>0时，0<Izl≤
【例2.5.2】求x(n)=Rg(n)的Z变换及其收敛域。
解 X(2)=∑Ra(ne-2-
这是一个因果的有限长序列，因此收敛域为0<z≤0。但由结果的分母可以看出，似乎
z=1是X(z)的极点，但同时分子多项式在z=1时也有一个零点，极、零点对消，X(z)在
单位圆上仍存在，求RN(n)的傅里叶变换，可将z=e代入X(z)得到，其结果和例题
2.2.1中的结果(2.2.4)式是相同的。
2.右序列
右序列是指在n≥n?时，序列值不全为零，而在n<n?时，序列值全为零的序列。右序
Created by ZhuangHeng
列的Z变换表示为
x(z)=Zxns-2z(n+Zanz
第一项为有限长序列，设n?≤-1,其收敛域为0≤lz|<0∞。第二项为因果序列，其收敛域
为R_<lz|≤∞,R是第二项最小的收敛半径。将两收敛域相与，其收敛域为
R_<|z|<∞。如果是因果序列，收敛域为R,<|z|≤∞。
【例2.5.3】求x(n)=a"u(n)的Z变换及其收敛域。
解 X(z)=∑au(n)a-∑aza
在收敛域中必须满足|az1|<1,因此收敛域为|z|>|a|。
3.左序列
左序列是指在n≤n?时，序列值不全为零，而在n>n?时，序列值全为零的序列。左序
列的Z变换表示为
x(2)=∑z(n
如果n?≤0,z=0点收敛，z=点不收敛，其收敛域是在某一圆(半径为R,)的圆内，
收敛域为0≤|z|<R_。如果n?>0,则收敛域为0<|z|<R。
【例2.5.4】求x(n)=-a"u(-n-1)的Z变换及其收敛域。
解 这里x(n)是一个左序列，当n≥0时，x(n)=0,
X(z)=∑-au(-n-1)e=2-az-2-a
X(z)存在要求|a?1z|<1,即收敛域为|z|<la|,因此
X(z)=a21-a 1z|<laI
4.双边序列
一个双边序列可以看做是一个左序列和一个右序列之和，其Z变换表示为
X(z)=∑x(n)s=X?(2)+X?(z)
x?(2)-7(w)e 0≤Iz|<R. 第2章时域离散信号和系统的频域分析
X?(2)=∑x(n)s R_<lzl≤0
X(z)的收敛域是X?(z)和X?(z)收敛域的交集。如果R?>R_,则其收敛域为R,<
|z|<R,.,是一个环状域；如果R,<R_,两个收敛域没有交集，X(z)则没有收敛域，因此
X(z)不存在。
【例2.5.5】x(n)=a",a为实数，求r(n)的Z变换及其收敛域。
65
Created by ZhuangHeng
口
数字信号处理(第五版)
解
x(a)-∑a-a+
-∑a+∑a
第一部分收敛条件为|az|<1,得到的收敛域为|z|<lal?1;第二部分收敛条件为|az1|<1,
得到的收敛域为|z|>la|。如果|a|<1,两部分的公共收敛域为|a|<|z|<la|?1,其Z变
换如下式：
X(z)=1-a+aa-a)(-a Ia|<|z|<|a|
如果|a|≥1,则无公共收敛域，因此X(z)不存在。当0<a<1时，x(n)的波形及X(z)
的收敛域如图2.5.2所示。
-6-4-202 4 6 n
Im[z]
a Re|z]
0 1/a
图2.5.2 例2.5.5图
我们注意到，例2.5.3和例2.5.4的序列是不同的，即一个是左序列，一个是右序列，
但其Z变换X(z)的函数表示式相同，仅收敛域不同。换句话说，同一个Z变换函数表达式，
收敛域不同，对应的序列是不相同的。所以，X(z)的函数表达式及其收敛域是一个不可分
离的整体，求Z变换就包括求其收敛域。
此外，收敛域中无极点，收敛域总是以极点为界的。如果求出序列的Z变换，找出其极
点，则可以根据序列的特性，较简单地确定其收敛域。例如在例2.5.3中，其极点为 z=a,
根据x(n)是一个因果性序列，其收敛域必为：|z|>|a|;又例如在例2.5.4中，其极点为
之=a,但x(n)是一个左序列，收敛域一定在某个圆内，即|z|<|a|。
2.5.3 逆Z变换
已知序列的Z变换X(z)及其收敛域，求原序列x(n)的过程称为求逆Z变换。重写
x(n)的Z变换定义(2.5.1)式如下：
66
Created by ZhuangHeng
X(2)=∑r(n)e”R_<|z|<R
对(2.5.1)式两端乘以z1,n为任一整数，并在X(z)的收敛域上进行积分，得
fx(z)dz=f[∑x(m)z-]?dz=∑x(mpzd
式中积分路径c是X(z)收敛域中一条包围原点的逆时针方向的闭合围线，如图2.5.3所
'dz= 示。根据复变函数理论中的柯西公式，只有当n-m-1=-1,即m=n时，
2πj,否则， φx”dz=0。考虑到m是整数，所以，求和式中除了m=n以外，其余各项全
为零，于是有
φX(z)e1dz=2mjr(n)
所以
x(n)=IZT[X(2)]=2-$x(2)a'dz (2.5.5)
(2.5.5)式就是逆Z变换公式。
Ima
c、
R
o R. Re[a]
图2.5.3 围线积分路径
计算逆Z变换的方法有留数法、部分分式展开法和幂级数法(长除法)。下面仅介绍留
数法和部分分式展开法，重点放在留数法。
1.用留数定理求逆Z变换
求逆Z变换时，直接计算(2.5.5)式给出的围线积分是比较麻烦的，用留数定理求则很
容易。为了书写简单，用F(z)表示被积函数：F(z)=X(z)z。
如果F(z)在围线c内的极点用z,表示，根据留数定理有
焉x(2)dx=∑Res[F(z),z] (2.5.6)
式中，Res[F(z),z]表示被积函数F(z)在极点z=z,的留数，逆Z变换是围线c内所有的
极点留数之和。
如果z 是单阶极点，则根据留数定理有
Res[F(z),z.]=(z-z)·F(z)| (2.5.7)
如果z,是m阶极点，则根据留数定理有
67
Created by ZhuangHeng
第2章时域离散信号和系统的频域分析
口
口
数字信号处理(第五版)
68
Res[F(z),z]=(m-D[(z-2)"F(2)] (2.5.8)
(2.5.8)式表明，对于m阶极点，需要求m-1次导数，这是比较麻烦的。如果c内有
多阶极点，而c外没有多阶极点，则可以根据留数辅助定理改求c外的所有极点留数之和，
使问题简单化。
如果F(z)在z平面上有N个极点，在收敛域内的封闭曲线c将z平面上的极点分成两
部分：一部分是c内极点，设有N?个极点，用z表示；另一部分是c外极点，设有N?个，
用z?表示。N=N?+N?。根据留数辅助定理，下式成立：
∑ResLF(2),zu]=-ZRs[F(a),zu] (2.5.9)
注意：(2.5.9)式成立的条件是F(z)的分母阶次应比分子阶次高二阶或二阶以上。设
X(z)=P(z)/Q(z),P(z)和Q(z)分别是z的M和N阶多项式。(2.5.9)式成立的条件是
N-M-n+1≥2
因此要求
n<N-M (2.5.10)
如果满足(2.5.10)式，c内极点中有多阶极点，而c外没有多阶极点，则逆Z变换的计算可
以按照(2.5.9)式，改求c圆外极点留数之和，最后加一个负号。
【例2.5.6】 已知X(z)=(1-az1)-1,|z|>|a|,求其逆Z变换x(n)。
解 x(n)=2f(1-az)1z?1dz
F(z)=-a
为了用留数定理求解，先找出F(z)的极点。显然，F(z)的极点与n的取值有关。
极点有两个：z=a;当n<0时，其中z=0的极点和n的取值有关。n≥0时，z=0不
是极点；n<0时，z=0是一个n阶极点。因此，分成n≥0和n<0两种情况求x(n)。
n≥0时，F(z)在c内只有1个极点：z?=a;
n<0时，F(z)在c内有2个极点：z?=a,z?=0(n阶);
所以，应当分段计算x(n)。
n≥0时， Im[z]
n阶极点
o a
*
1Re[z]
图2.5.4 例2.5.6中n<0时F(z)的
极点分布
Created by ZhuangHeng
x(n)=Res[F(z),a]=(z-a)?=a
n<0时，z=0是n阶极点，不易求留数。采用留数
辅助定理求解，先检查(2.5.10)式是否满足。该例
题中N=M=1,N-M=0,所以n<0时，满足
(2.5.10)式，可以采用留数辅助定理求解，改求c
外极点留数，但对于F(z),该例题中圆外没有极点
(见图2.5.4),故n<0,x(n)=0。最后得到该例题
的原序列为
x(n)=a"u(n)
事实上，该例题由于收敛域是|z|>a,根据前面分析的序列特性对收敛域的影响知道，
x(n)一定是因果序列，这样 n<0部分一定为零，无需再求。本例如此求解是为了证明用留
数辅助定理求解的正确性。
X(z)=1-az)(1-az5,la|<1, 【例2.5.7】 已知 ,求其逆变换x(n)。
解 该例题没有给定收敛域，为求出唯一的原序列x(n),必须先确定收敛域。分析
X(z),得到其极点分布如图2.5.5所示。图中有两个极点：z?=a和z?=a1,这样收敛域
有三种选法，它们是
(1)|z|>|a-1|,对应的x(n)是因果序列；
(2)|z|<|a|,对应的x(n)是左序列；
(3)|a|<|z|<|a?1|,对应的x(n)是双边序列。
Imla]
0
+
/1 a a Re[z]
图2.5.5 例2.5.7中X(z)的极点
下面分别按照不同的收敛域求其x(n)。
(1)收敛域为|z|>|a?1|:
F(x)=a-)-a=a(z--)(2-a5
这种情况的原序列是因果的右序列，无须求 n<0时的x(n)。当n≥0时，F(z)在c内有两
个极点：z=a和z=a?1,因此
x(n)= Res[F(z),a]+Res[F(z),a']
=(-(2)&(z-a)|+=a(zas()-a(z-a)
=a"-a"
最后表示成：x(n)=(a"-a")u(n)。
(2)收敛域为|z|<la|:
这种情况原序列是左序列，无须计算 n≥0情况。实际上，当n≥0时，围线c内没有极
点，因此x(n)=0。n<0时，c内只有一个极点z=0,且是n阶极点，改求c外极点留数之和。
n<0时，F(z)满足(2.5.10)式，所以按(2.5.9)式计算x(n):
第2章时域离散信号和系统的频域分析
69
Created by ZhuangHeng
数字信号处理(第五版)
70
x(n)=-Res[F(z),a]-Res[F(z),a1]
=(--)()a?(z-a)=a(-s()-a5(z-a)|
=-a"-(-a")=a"-a"
最后将x(n)表示成封闭式：
x(n)=(a"-a")u(-n-1)
(3)收敛域为|a|<|z|<|a1|:
这种情况对应的x(n)是双边序列。根据被积函数F(z),按n≥0和n<0两种情况分别
求x(n)。
n≥0时，c内只有1个极点：z=a,
x(n)=Res[F(z),a]=a"
n<0时，c内极点有2个，其中z=0是n阶极点，改求c外极点留数，c外极点只有
z=a?1,因此
r(n)=-Res[F(z),a1]=a"
最后将x(n)表示为
-n≥
即
x(n)=a"
2.部分分式展开法
对于大多数单阶极点的X(z),常常也用部分分式展开法求逆Z变换。
设x(n)的Z变换X(z)是有理函数，分母多项式是N阶，分子多项式是M阶，将X(z)
展成一些简单的常用的部分分式之和，通过查表(参考表2.5.1)求得各部分的逆变换，再
相加便得到原序列x(n)。设X(z)只有N个一阶极点，可展成下式：
X(2)=A+A
x(&)-A+A
(2.5.11)
(2.5.12)
观察上式，X(z)/z在z=0的极点留数就是系数A。,在极点z=z的留数就是系数A…。
A。=Res[(2),0] (2.5.13)
A=Res[(2),] (2.5.14)
求出A。系数(m=0,1,2,…,N)后，查表2.5.1可求得序列x(n)。
X(z)=1+52-62,2<lzl<3,求逆Z变换。 【例2.5.8】 已知
Created by ZhuangHeng
解 X(z)-1+52-6z-+5-6-(-2)(+3)=A2+2+3
A?=Res[×(),2]-x()(z-2)=1
A?=Res[×(),-3]=×(2)(z+3)|=-1
X(z)--2-2+3
X(z)=1-221+3
因为收敛域为2<|z|<3,第一部分极点是z=2,因此收敛域为|z|>2。第二部分极
点是z=-3,收敛域应取|z|<3。查表2.5.1,得到：
x(n)=2"u(n)+(-3)"u(-n-1)
注意：在进行部分分式展开时，也用到求留数问题；求各部分分式对应的原序列时，还
要确定它的收敛域在哪里，因此一般情况下不如直接用留数法求方便。
一些常见序列的Z变换可参考表2.5.1。
表2.5.1 常见序列的Z变换
序 列 Z 变 换 收 敛 域
6(n) 1 整体z平面
u(n) Izl>1
a"u(n) 1-a |z|>|a
RN(n) |z|>0
-a"u(-n-1) 1-a |z|<|al
nu(n) a- Iz|>1
na"u(n) a-a 1zl>|al
e"u(n) |z|>1
sin(a,n)u(n) 12+ |z|>1
cos(a,n)u(n) 1-2 [z|>1
2.5.4 Z变换的性质和定理
下面介绍Z变换重要的性质和定理。
第2章时域离散信号和系统的频域分析
71
Created by ZhuangHeng
口
口
口
口口
口
口
口口
口口
数字信号处理(第五版)
1.线性性质
设
m(n)=ax(n)+by(n) a,b为常数
X(z)=ZT[x(n)]R<|z|<R
Y(z)=ZT[y(n)] R,<|z|<R,+
则
M(z)=ZT[m(n)]=aX(z)+bY(z)R<|z|<Rm+
R+=min[R,R,+]
R=max[R_,R,]
(2.5.15)
这里，M(z)的收敛域(R_,R)是X(z)和Y(z)的公共收敛域，如果没有公共收敛域，例
如当R>R,>R,>R,时，则M(z)不存在。
2.序列的移位性质
设
则
X(z)=ZT[x(n)]R_<|z|<R?
ZT[x(n-n。)]=x"X(z)R_<|z|<R+ (2.5.16)
3.序列乘以指数序列的性质
设
X(z)=ZT[x(n)] R<|z|<R
y(n)=a"x(n) a为常数
则
证明
Y(z)=ZT[a"x(n)]=X(a?1z)|a|R,<|z]<|a|R, (2.5.17)
Y(?)=∑a(n)z=∑a(n)(a12)=X(a12)
因为R_<|a?1z|<R,得到|a|R,<|z|<|a|R+
4.序列乘以n的ZT
设
则
证明
X(z)=ZT[x(n)] R,_<|z|<R
ZT[nr(n)]=-dx(z)R_<|z|<R+
dx[2-∑x(n)a"]=∑x(n)
=∑nm(n)1=-∑u(n)2
=-z1ZT[nx(n)]
72
(2.5.18)
Created by ZhuangHeng
因此
ZT[nx(n)]=-aX(z)
由于X(z)是z的幂级数，其导函数是具有相同收敛域的另一个幂级数，故(2.5.18)式
的收敛域与X(z)相同。
5.复共轭序列的ZT
设
则
X(z)=ZT[x(n)] R_<|z|<R
ZT[x'(n)]=X*(z)R,<|z|<R (2.5.19)
证明 ZT[x'(n)]=∑x(n)s=∑[x(n)(z)"]
=[∑z(n)(z2)-]=x'(z')
6.初值定理
设x(n)是因果序列，X(z)=ZT[x(n)],则
x(0)= limX(z) (2.5.20)
证明 X(2)=z(n)a*=x(0)+x(1)a1+x(2)z2+…
因此
limX(z)=x(0
7.终值定理
若x(n)是因果序列，其Z变换的极点，除可以有一个一阶极点在z=1上，其他极点均
在单位圆内，则
limx(n)= lim(z-1X(z) (2.5.21)
证明 (z-1)X(2)=∑[z(n+1)-x(n]e”
因为x(n)是因果序列，x(n)=0,n<0,所以
(z-DX(2)=lim[∑(m+Dz"-∑z(m)=“]
因为(z-1)X(z)在单位圆上无极点，上式两端对z=1取极限：
im(z-1)X(z)=lim[∑x(m+1)-∑a(m)]
= lim[r(0)+x(1)+…x(n)+z(n+1)-x(0)-x(1)-…-(n)]
= limx(n+1)=limx(n)
终值定理也可用X(z)在z=1点的留数表示，因为
第2章时域离散信号和系统的频域分析
73
Created by ZhuangHeng
a口
口口
口
口口
口口
口口
口口
a口
口
数字信号处理(第五版)
lim(z-1DX(z)=Res[X(z),1]
因此
x(c)=Res[X(z),1] (2.5.22)
如果在单位圆上X(z)无极点，则x(o)=0。
8.时域卷积定理
设
w(n)=x(n)*y(n)
X(z)=ZT[x(n)]R,<|z|<R
Y(z)=ZT[y(n)]R,_<|z|<R,+
则
W(z)=ZT[w(n)]=X(z)Y(z)R_<|z|<R
R+=min[R,R,+]
R=max[R,,R,]
(2.5.23)
证明 W(z)=ZT[z(n)*y(n)]=∑[∑z(m)y(n-m)]。
-zm)[2som-mz2]-Sacme-2sa-me
=X(z)Y(z)
W(z)的收敛域就是X(z)和Y(z)的公共收敛域。如果X(z)和Y(z)相乘中有零、极点对
消，则W(z)的收敛域可能扩大。
【例2.5.9】已知网络的单位脉冲响应h(n)=a"u(n),|a|<1,网络输入序列x(n)=
u(n),求网络的输出序列y(n)。
解 y(n)=h(n)*x(n)
求y(n)可用两种方法，一种直接求解线性卷积，另一种是Z变换法。
(1) y(n)=∑h(m)z(n-m)=∑a"u(m)un-m)
=[∑a-]u(n)=1-“(n)
(2) y(n)=h(n)*x(n)
H(z)=ZT[a"u(n)]=a IzI>|al
X(z)=ZT[u(n)]=- Il>1
Y(z)=H(z)X(z)=a-)4-a) |zl>1
y(n)=嘉(z-1)(z-a)d
由收敛域判定
y(n)=0n<0
74
Created by ZhuangHeng
n≥0时，
y(n)=Res[Y(z)?1,1]+Res[Y(z)3,a]=+a-1=1-a
将y(n)表示为
y(n)=1-u(n)
9.复卷积定理
如果
ZT[x(n)]=X(z)R,<|z|<R
ZT[y(n)]=Y(z)R,_<|z|<R,
w(n)=x(n)y(n)
则
W(z)=2φx()Y(元) (2.5.24)
W(z)的收敛域为
R_R_<|z|<RR, (2.5.25)
(2.5.24)式中v平面上，被积函数的收敛域为
max(R,R)<10l<min(R,R) (2.5.26)
W(z)=∑z(n)y(n)z*-∑[焉fx()?do]y(n)z 证明
-焉fx(∽)y(n)(合)
=嘉fx(o)Y()
由X(z)的收敛域和Y(z)的收敛域得到：
R,<lvl<R
R-<|3|<R,
因此
R,R,<Iz|<RR,+
max(R,R)<10l<min(RR)
【例2.5.10】已知 x(n)=u(n),y(n)=a",0<|a|<1,若w(n)=x(n)y(n),求
W(z)=ZT[w(n)]。
第2章时域离散信号和系统的频域分析
解X(z)=1 1<|z|≤
Y(z)=a-a2a-a) Ia|<Iz|<Ia|?1
75
Created by ZhuangHeng
数字信号处理(第五版)
76
wa)-.fro×()-毒fa-5a
max(R,R)<1vl<min(R,R)
W(z)的收敛域为|a|<|z|≤∞;这里，R?=○,R_=1,R,+=|a|?1,R,=|a|。
因此被积函数v平面上的收敛域为max(|a|,0)<|v|<min(|a-11,|z1),v平面上极点有
a、a?1和z;c内极点有z=a。令F(o)=Y(o)x(二)?1,则
W(2)=Res[F(o),a]=a a<|z|≤∞
w(n)=a"u(n)
10.帕斯维尔(Parseval)定理
设
X(z)=ZT[x(n)]R,<|z|<R
Y(z)=ZT[y(n)]R,<lz|<R,
R,_R,_<1,RR,+>1
那么
∑z(n)y'(m)=嘉$x(ox(1)od (2.5.27)
v平面上，c所在的收敛域为
max(R-R)<10l<min(RR)
利用复卷积定理可以证明上面的重要的帕斯维尔定理。
证明 令
w(n)=r(n)y'(n)
按照(2.5.24)式得到：
W(z)=ZT[o(n)]=2-fxw)x(())o1du
按照(2.5.25)式，R,R,<|z|<RR+;按照假设，z=1在收敛域中，将z=1代入
W(z)中，则有
w(1)=2fx(0)Y()o1d
w(1)-∑a(ny'(m)-∑z(n)y(n)
因此
∑z(n)y'(n)=—xoy()0du
如果x(n)和y(n)都满足绝对可和，即单位圆上收敛，在上式中令v=e,得到：
Created by ZhuangHeng
∑z(n)y'(n)=-[x(e)x'(e)d
令x(n)=y(n),得到：
∑Ix(n)P=厂Ix(e)P2d (2.5.28)
上面得到的公式和在傅里叶变换中所讲的帕斯维尔定理(2.2.35)式是相同的。(2.5.28)
式还可以表示成下式：
∑Iz(n)I2=嘉$x(z)X(z1) (2.5.29)
注意：上式中X(z)收敛域包含单位圆，当x(n)为实序列时，X(e)=X'(e")。
2.5.5 利用Z变换解差分方程
在第1章中介绍了差分方程的递推解法，下面介绍Z变换解法。这种方法将差分方程
变成了代数方程，使求解过程简单。
设N阶线性常系数差分方程为
∑ay(n-k)=∑b(n-k) (2.5.30)
1.求稳态解
如果输入序列x(n)是在n=0以前一时加上的，n时刻的y(n)是稳态解，对(2.5.30)
式求Z变换，得到：
∑a,Y(z)z?-∑bX(z)a
-
Y(z)=H(z)X(z) (2.5.31)
式中
(2.5.32)
y(n)=IZT[Y(z)]
第2章时域离散信号和系统的频域分析
2.求暂态解
对于N阶差分方程，求暂态解必须已知N个初始条件。设x(n)是因果序列，即
x(n)=0,n<0,已知初始条件y(-1),y(-2),…,y(-N)。对(2.5.30)式进行Z变换
时，注意这里要用单边Z变换。该方程式的右边由于x(n)是因果序列，单边Z变换与双边
Z变换是相同的。下面先求移位序列的单边Z变换。
77 Created by ZhuangHeng
口
数字信号处理(第五版)
78
设
Y(z)=∑y(n)s
ZTy(n-m)u(n)]=∑y(n-m)s=∑y(n-m)
=∑y(A)s?="(2A)+∑y(b)z*]
=z”[Y(2)+∑y(k)z?] (2.5.33)
按照(2.5.33)式对(2.5.30)式进行单边Z变换，有
∑aa[Y(z)+≥(2]-∑bX(2)a
-
(2.5.34)
上式右边第一部分与系统初始状态无关，称为零状态解；而第二部分与输入信号无关，
称为零输入解。求零状态解时，可用双边Z变换求解也可用单边Z变换求解，求零输入解
却必须考虑初始条件，用单边Z变换求解。
【例2.5.11】 已知差分方程y(n)=by(n-1)+x(n),式中x(n)=a"u(n),y(-1)=
2,求y(n)。
解 将已知差分方程进行Z变换：
Y(z)=be?1Y(z)+by(-1)+X(z)
Y(z)=2+x(2
式中
X(z)=1-a[z|>|al
于是
Y(2)=1+a-a)4-ba)
收敛域为|z|>max(|a|,|b|),因此
y(n)=26**+1(a1-b1) n≥0
式中第一项为零输入解，第二项为零状态解。
2.6 利用Z变换分析信号和系统的频响特性
信号和系统的频率特性一般用傅里叶变换和Z变换进行分析。本节用Z变换方法进行
Created by ZhuangHeng
分析讨论。
2.6.1 频率响应函数与系统函数
设系统初始状态为零，系统对输入为单位脉冲序列8(n)的响应输出称为系统的单位脉
冲响应h(n)。对h(n)进行傅里叶变换，得到：
He)=∑h(n)e-=I H(e")|e (2.6.1)
一般称H(e")为系统的频率响应函数，或称系统的传输函数，它表征系统的频率响应特性。
|H(e)|称为幅频特性函数，p(w)称为相频特性函数。
将h(n)进行Z变换，得到H(z),一般称H(z)为系统的系统函数，它表征了系统的复
频域特性。对N阶差分方程(1.4.2)式，进行Z变换，得到系统函数的一般表示式
--
(2.6.2)
如果H(z)的收敛域包含单位圆|z|=1,则H(e")与H(z)之间的关系如下：
H(e")=H(z)| (2.6.3)
H(e")表示系统对特征序列e的响应特性，这也是H(e)的物理意义所在，下面具体阐述。
若系统输入信号x(n)=e",则系统输出信号为
y(n)=h(n)*x(n)=∑h(m)(n-m)=∑h(me
=∑h(m)e-=H(e)e
即
y(n)=H(e")e"=|H(e)1et
上式说明，单频复指数信号e通过频率响应函数为H(e")的系统后，输出仍为单频复指数
序列，其幅度放大|H(e")|倍，相移为p(w)。
为了加深读者对H(e")物理意义的理解，下面以大家熟悉的正弦信号为例进行讨论。
当系统输入信号x(n)=cos(wn)时，求系统的输出信号y(n):
因为
x(n)=cos(cm)=2[e"+e]
所以，利用上面的结论可得到：
y(n)=去[H(e)e"+H(e)e]
设h(n)为实序列，则
H'(e)=H(e),|H(e)|=|H(e?)|,p(w)=-q(-o),
第2章时域离散信号和系统的频域分析
故
79
Created by ZhuangHeng
数字信号处理(第五版)
y(n)=贵[H(e)1+H(e")|e]
=H(e")|e[m]+en
=|H(e")|cos[an+g(w)]
由此可见，线性时不变系统对单频正弦信号cos(an)的响应为同频正弦信号，其幅度放
大|H(e)|倍，相移增加q(a),这就是其名称“频率响应函数”、“幅频响应”和“相频响应”
的物理含义。如果系统输入为一般的序列x(n),则H(e")对x(n)的不同的频率成分
进行加权处理。对感兴趣的频段，取|H(e")|=1,其他频段|H(e")=0,则Y(e")=
X(e")·H(e"),这就是对输入信号的理想滤波处理。根据佩利-维纳准则①,理想滤波器的
H(e)不满足物理可实现的必要条件。38所以，实际中都是用可实现的滤波器来逼近理想
滤波器的。
2.6.2 利用系统函数的极点分布分析系统的因果性和稳定性
因果(可实现)系统其单位脉冲响应h(n)一定是因果序列，那么其系统函数H(z)的收
敛域一定包含点，即点不是极点，极点分布在某个圆内，收敛域在某个圆外。
∑Ih(n)|<∞,这正是H(e")=FT[h(n)]存在的条件，对照Z变换 系统稳定要求
与傅里叶变换的关系可知，系统稳定的条件是H(z)的收敛域包含单位圆。如果系统因果且
稳定，收敛域包含点和单位圆，那么收敛域可表示为
r<|z|≤ 0<r<1
这样 H(z)的极点集中在单位圆的内部。具体系统的因果性和稳定性可由系统函数H(z)的
极点分布和收敛域确定。下面通过例题说明。
如果系统函数分母多项式阶数较高(如3阶以上),用手工计算极点分布并判定系统是
否稳定，不是一件简单的事情。用MATLAB函数判定则很简单，判定函数程序如下：
function stab(A)
tab:系统稳定性判定函数，A是H(z)的分母多项式系数向量
disp('系统极点为：)
??H(z)的极点，并显示 P=roots(A)
dispC'系统极点模的最大值为：')
M=max(abs(P))??所有极点模的最大值，并显示
if M<1 disp('系统稳定),else,disp('系统不稳定'),end
① 佩利-维纳准则：H(e")满足物理可实现的必要条件是：
厂Hd<0
即|H(e")|可以在某些离散点上为零，但不能在某一有限频带内全为零。
80
Created by ZhuangHeng
请注意，这里要求 H(z)是正幂有理分式。给H(z)的分母多项式系数向量A赋值，调
用该函数，求出并显示系统极点和极点模的最大值M,判断M值，如果M<1,则显示“系
统稳定”,否则显示“系统不稳定”。如果H(z)的分母多项式系数A=[2 -2.98 0.17
2.3418 -1.5147],则调用该函数输出如下：
P=-0.9000 0.7000+0.6000i 0.7000-0.6000i 0.9900
系统极点模的最大值为：M=0.9900
系统稳定。
H(z)=1-a-1-a2),0<a<1 【例2.6.1】 已知 ,分析其因果性和稳定性。
解 H(z)的极点为z=a,z=a1,如图2.5.5所示。
(1)收敛域为a1<|z|≤0:对应的系统是因果系统，但由于收敛域不包含单位圆，
因此是不稳定系统。单位脉冲响应h(n)=(a"-a")u(n)(参考例2.5.7),这是一个因果序
列，但不收敛。
(2)收敛域为0≤|z|<a:对应的系统是非因果且不稳定系统。其单位脉冲响应
h(n)=(a"-a")u(-n-1)(参考例2.5.7),这是一个非因果且不收敛的序列。
(3)收敛域为a<|z|<a1:对应一个非因果系统，但由于收敛域包含单位圆，因此是
稳定系统。其单位脉冲响应h(n)=a",这是一个收敛的双边序列，如图2.6.1(a)所示。
h(n)=a
(a)
-6-4-20 2 4 6 n
2N+1
h(n)
(b)
0 24 6 8 10 12 n
图2.6.1 例2.6.1图示
下面分析如同例2.6.1这样的系统的可实现性。 第2章时域离散信号和系统的频域分析
H(z)的三种收敛域中，前两种系统不稳定，不能选用；最后一种收敛域，系统稳定但
非因果，还是不能具体实现。因此严格地讲，这样的系统是无法具体实现的。但是我们利用
数字系统或者说计算机的存储性质，可以近似实现第三种情况。方法是将图2.6.1(a)从
-N到N 截取一段，再向右移，形成如图2.6.1(b)所示的h'(n)序列，将h'(n)作为具体实
现的系统单位脉冲响应。N愈大，h'(n)表示的系统愈接近h(n)系统。具体实现时，预先将
h'(n)存储起来，备运算时应用。这种非因果但稳定的系统的近似实现性，是数字信号处理
81
Created by ZhuangHeng
数字信号处理(第五版)
82
技术比模拟信息处理技术优越的地方。
说明：对一个实际的物理实现系统，其H(z)的收敛域是唯一的。
2.6.3 利用系统的极零点分布分析系统的频率响应特性
将(2.6.2)式因式分解，得到：
(2.6.4)
A=, 式中， 是H(z)的零点，d,是其极点。A 参数影响频率响应函数的幅度大小，影
响系统特性的是零点c,和极点d,的分布。下面我们采用几何方法研究系统零极点分布对
系统频率特性的影响。
将(2.6.4)式分子、分母同乘以zN+M,得到：
-
(2.6.5)
设系统稳定，将z=e"代人上式，得到频率响应函数
(2.6.6)
在z平面上，e"-c,用一根由零点c,指向单位圆上e点B的向量c,B表示，同样，e"-d,
用由极点指向e点B的向量d,B表示，如图2.6.2所示，即c,B和d,B分别称为零点向量和
极点向量，将它们用极坐标表示：
c,B=c,Be
d,B=d,Be
将c,B和d,B表示式代入(2.6.6)式，得到：
(2.6.7)
g(o)=a(N-m)+2-2B
(2.6.8)
(2.6.9)
Created by ZhuangHeng
系统的频响特性由(2.6.8)式和(2.6.9)式确定。当频率w从0变化到2π时，这些向量的终
点B沿单位圆逆时针旋转一周，按照(2.6.8)式和(2.6.9)式，分别估算出系统的幅频特性
和相频特性。例如图2.6.2表示了具有一个零点和两个极点的频率特性。
Ijlm[=] 11H(e3")I
B.
d
dB B
GB 0
φ()
π 2π@
a, 0
Re[=]
0
d, π 2π@
一π
图2.6.2 频响的几何表示法
按照(2.6.8)式，知道零极点的分布后，可以很容易地确定零极点位置对系统特性的影
响。当B点转到极点附近时，极点向量长度最短，因而幅度特性可能出现峰值，且极点愈
靠近单位圆，极点向量长度愈短，峰值愈高愈尖锐。如果极点在单位圆上，则幅度特性为
,系统不稳定。对于零点，情况相反，当B点转到零点附近时，零点向量长度变短，幅度
特性将出现谷值，零点愈靠近单位圆，谷值愈接近零。当零点处在单位圆上时，谷值为零。
总结以上结论：极点位置主要影响频响的峰值位置及尖锐程度，零点位置主要影响频响的
谷点位置及形状。
这种通过零极点位置分布分析系统频响的几何方法为我们提供了一个直观的概念，对
于分析和设计系统是十分有用的。基于这种概念，可以用零极点累试法设计简单滤波器。
下面介绍用MATLAB计算零、极点及频率响应曲线。首先介绍MATLAB工具箱中
两个函数zplane和freqz的功能和调用格式。
第2章
zplane 绘制H(z)的零、极点图。
zplane(z,p) 绘制出列向量z中的零点(以符号“O”表示)和列向量p中的极点(以符
号“×”表示),同时画出参考单位圆，并在多阶零点和极点的右上角标出其阶数。如果z和
p为矩阵，则zplane 以不同的颜色分别绘出z和p各列中的零点和极点。
zplane(B,A)绘制出系统函数H(z)的零极点图。其中B和A为系统函数H(z)=
B(z)/A(z)的分子和分母多项式系数向量。假设系统函数H(z)用下式表示： 时域离散信号和系统的频域分析 H(2)=B(2)-B①)+B(2)21+…+BMz+BA(M+1D
则
B=[B(1)B(2)B(3)… B(M+1)],A=[A(1)A(2)A(3)…A(N+1)]
freqz 计算数字滤波器H(z)的频率响应。
H=freqz(B,A,w)计算由向量w指定的数字频率点上数字滤波器H(z)的频率响
83
Created by ZhuangHeng
口口
0口
数字信号处理(第五版)
应H(e"),结果存于H向量中。B和A仍为H(z)的分子和分母多项式系数向量(同上)。
[H,w]= freqz(B,A,M)计算出M个频率点上的频率响应，存放在H向量中，M
个频率存放在向量w中。freqz 函数自动将这M个频率点均匀设置在频率范围[0,π]上。
[H,w]= freqz(B,A,M,'whole')自动将M个频率点均匀设置在频率范围
[0,2π]上。
当然，还可以由频率响应向量H得到各采样频点上的幅频响应函数和相频响应函数；
再调用plot绘制其曲线图。
|H(e")|=abs(H)
φ(o)=angle(H)
式中，abs函数的功能是对复数求模，对实数求绝对值；angle 函数的功能是求复数的相角。
freqz(B,A) 自动选取512个频率点计算。不带输出向量的 freqz 函数将自动绘出固
定格式的幅频响应和相频响应曲线。所谓固定格式，是指频率范围为[0,π],频率和相位是
线性坐标，幅频响应为对数坐标。
其他几种调用格式可用命令 help查阅。
【例2.6.2】已知H(z)=z1,分析其频率特性。
解 由H(z)=z1,可知极点为z=0,幅频特性|H(e")|=1,相频特性φ(w)=-w,
频响特性如图2.6.3所示。用几何方法也容易确定，当w=0转到w=2π时，极点向量的长
度始终为1。
由该例可以得到结论：处于原点处的零点或极点，由于零点向量长度或者极点向量长
度始终为1,因此原点处的零极点不影响系统的幅频响应特性，但对相频特性有贡献。
11H(el")I
1
o @
φ(@)
o ①
图2.6.3 H(z)=z?1的频响特性
【例2.6.3】设一阶系统的差分方程为
y(n)=by(n-1)+x(n)
用几何法分析其幅度特性。
解 由系统差分方程得到系统函数为
H(2)=bb IzI>Ib
84
Created by ZhuangHeng
式中，0<b<1。系统极点z=b,零点z=0,当B点从w=0逆时针旋转时，在w=0点，由
于极点向量长度最短，形成波峰；在w=π点形成波谷；z=0处零点不影响幅频响应。极零
点分布及幅度特性如图2.6.4所示。
Im[z] IIH(e1°)I
-1 o b /1 Re[z] 0 π 2π @
图2.6.4 例2.6.3插图
【例2.6.4】 已知H(z)=1-z~,试定性画出系统的幅频特性。
解 H(z)=1-z~=
H(z)的极点为z=0,这是一个N阶极点，它不影响系统的幅频响应。零点有N个，由分
子多项式的根决定
zN-1=0 即 zN=e*
z=e k=0,1,2,…,N-1
N个零点等间隔分布在单位圆上，设N=8,极零点分布如图2.6.5所示。当w从0变化到
2π时，每遇到一个零点，幅度为零，在两个零点的中间幅度最大，形成峰值。幅度谷值点频
率为：w=(2π/N)k,k=0,1,2,…,N-1。一般将具有如图2.6.5所示的幅度特性的滤
波器称为梳状滤波器。
调用zplane和freqz求解本例的程序ep264.m如下：
?264.m:例2.6.4求解程序
??置系统函数系数向量B和A B=[10000000-1];A=1;
??制零极点图 subplot(2,2,1);zplane(B,A);
??算频率响应 [H,w]=freqz(B.A);
subplot(2,2,2);plot(w/pi,abs(HD): ??制幅频响应曲线
xlabel('\omega/\pi);
ylabel('TH(ej\omega)|);
axis([0,1,0,2.5])
??制相频响应曲线 subplot(2,2,4);plot(w/pi, angle(H));
xlabel('\omega/\pií);
ylabel('\phi(\omega)):
运行上面的程序，绘制出8阶梳状滤波器的零极点图和幅频特性、相频特性如图
2.6.5所示。
第2章时域离散信号和系统的频域分析
85
Created by ZhuangHeng
0口
口
口
口
■■
口
口口口
口口
口口
口
口
数字信号处理(第五版)
86
1F 2.5 2
0.5 2 1
oy 0
8
IH(e3)1.5
-os 1
(百0
0.5 -1
-1 oL -2L -1 -0.5 0 0.5 1 0 0.5 1 0.5 1
Real Part a/π m/m
图2.6.5 梳状滤波器的极零点分布及幅频、相频特性
2.6.4 几种特殊系统的系统函数及其特点
这一节介绍几种特殊的系统，即全通滤波器、梳状滤波器、最小相位系统等。
1.全通滤波器
如果滤波器的幅频特性对所有频率均等于常数或1,即
1H(e)|=10≤w≤2π (2.6.10)
则该滤波器称为全通滤波器(或称全通系统、全通网络)。全通滤波器的频率响应函数可表
示成
H(e")=e (2.6.11)
(2.6.11)式表明信号通过全通滤波器后，幅度谱保持不变，仅相位谱随φ(w)改变，起纯相
位滤波作用。
全通滤波器的系统函数一般形式如下式：
-
ao=1(2,6.12)
或者写成二阶滤波器级联形式：
H(2)=+a2+a (2.6.13)
上面两式中的系数均为实数。容易看出，全通滤波器系统函数H(z)的构成特点是其分子、
分母多项式的系数相同，但排列顺序相反。下面证明(2.6.12)式表示的滤波器具有全通幅
频特性。
(2.6.14)
D(2)=2aa。 式中，1 。由于系数a,是实数，因此
D(z1)|=D(e)=D'(e~)
Created by ZhuangHeng
H(e)|=De)|=1
这就证明了(2.6.12)式表示的H(z)具有全通滤波特性。
下面分析全通滤波器的零点和极点的分布规律。设z为
H(z)的零点，按照(2.6.14)式，z1必然是H(z)的极
点，记为p,=z1,则pz,=1,全通滤波器的极点和零
点互为倒数关系。如果再考虑到D(z)和D(z1)的系数
为实数，其极点、零点均以共轭对出现，这样，复数零
点、复数极点必然以四个一组出现。例如，z是H(z)的
零点，则必有零点z、极点p=1、pi=(z)。对
实数零极点，则以两个一组出现，且零点与极点互为倒
数关系。零极点位置示意图如图2.6.6所示。
Im(2)
A
pi
Re(z)
P?×
图2.6.6 全通滤波器一组零
极点示意
观察图2.6.6,如果将零点z和极点p组成一对，将零点z与极点p。组成一对，那
么全通滤波器的极点与零点便以共轭倒易关系出现，即如果z1为全通滤波器的零点，则
z必然是全通滤波器的极点。因此，全通滤波器系统函数也可以写成如下形式：
H(s)= (2.6.15)
显然，(2.6.15)式中极点和零点互为共轭倒易关系。其全通特性的证明留作习题。应当注
意，为了保证分子、分母多项式系数是实数，极点、零点分别以共轭对形式出现，当N=1
时，零点、极点均为实数。
全通滤波器是一种纯相位滤波器，经常用于相位均衡。如果要求设计一个线性相位滤
波器，可以设计一个具有线性相位的FIR滤波器，也可以先设计一个满足幅频特性要求的
IIR 滤波器，再级联一个全通滤波器进行相位校正，使总的相位特性是线性的。IIR和FIR
滤波器设计分别在第6章和第7章介绍。
2.梳状滤波器
在前一节例2.6.4中，曾提到具有如图2.6.5所示的幅度特性的滤波器称为梳状滤波
器，显然，梳状滤波器起名于它的幅度特性形状。下面介绍一般梳状滤波器的构成方法。
设滤波器的系统函数为H(z),我们知道，其频率响应函数H(e”)以2π为周期。将
H(z)的变量z用z~代替，得到H(z),则相应的频率响应函数H(e)是以2π/N为周期
的，在区间[0,2π]上有N个相同频率特性周期。利用这种性质，可以构成各种梳状滤
波器。
H(z)=-,0<a<1,零点为1,极点为a,所以H(z)表示一个高通滤波 例如，1
器。以z代替H(z)的z,得到：
H(z*)=11a
第2章
时域离散信号和系统的频域分析
87
Created by ZhuangHeng
口
数字信号处理(第五版)
88
当N=8时，零点为≈=e,k=0,1,…,7;极点为p=Vae,k=0,1,…,7。H(z)
零极点分布和幅频响应特性绘制程序为fig267.m,其中a=0.2部分程序如下：
?2.6.7绘制程序：fig267.m
a=0.2;
B=[1,0,0,0,0,0,0.0,-1]:
A=[1,0,0,0.0,0.0.0,-a];
subplot(2,2.1);
zplane(B,A);title('(a)零极点分布(a=0.2,N=8))
[Hk,w]=freqz(B,A,1024):??算频响特性(a=0.2,N=8)
subplot(2,2.2);
plot(w/pi,abs(Hk)/max(abs(Hk)));
xlabel('\omega/\pi):
axis([0.1.0.1.5]):
title('(b)幅频特性(a=0.2,N=8)')
a=0.9;
B=[1,0,0,0,0,0.0.0.-1];
A=[1,0.0,0.0,0,0.0,-a]:
以下程序与a=0.2时相同(省略)。
运行本书程序集程序fig267.m,绘制出当N=8,a=0.2和a=0.9时，H(z)的零极
点分布和幅频响应特性曲线如图2.6.7所示。
1 1.5 *
1
0.5
-1 -0.5 00.5 1
0
0 0.5 1
Real Part 60/π
(a)零极点分布(a=02,N=8) (b)幅频特性(a=0.2,N=8)
1.5
1
0.5
0 0.5 -1-0.5 1
o
0 0.5 1
Real Part 0/π
(c)零极点分布(a=0.9,N=8) (d)幅频特性(a=0.9.N=8)
图2.6.7 梳状滤波器的零极点分布和幅频响应特性
Created by ZhuangHeng
Imaginary Part
Imaginary Part
0.5
0
-0.5
-1
1
0.5
0
-0.5
-1
梳状滤波器可滤除输入信号中 2π,
w=k,k=0,1,…,N-1的频率分量。这种滤波器
N
可用于消除信号中的电网谐波干扰和其他频谱等间隔分布的干扰。
由图2.6.7可见，a取值越接近1,幅频特性越平坦。将图2.6.7和图2.6.5比较，形
状很相似，不同的是每一个梳状周期的形状不同。显然，图2.6.5对应的系统函数是由
(1-z1)中变量z用z代替后得到的，用于消除电网谐波干扰时，特性不如H(z)=
1-的滤波性能好。但图2.6.5对应的梳状滤波器适用于分离两路频谱等间隔交错分
布的信号，例如，彩色电视接收机中用于进行亮色分离和色分离等。
3.最小相位系统
一个因果稳定的时域离散线性非移变系统H(z),其所有极点必须在单位圆内，但其零
点可在z平面上任意位置，只要频响特性满足要求即可。如果因果稳定系统H(z)的所有零
点都在单位圆内，则称之为“最小相位系统”,记为H(z);反之，如果所有零点都在单位
圆外，则称之为“最大相位系统”,记为Hm(z);若单位圆内、外都有零点，则称之为“混合
相位系统”。
最小相位系统在工程理论中较为重要。下面给出最小相位系统的几个重要特点。
(1)任何一个非最小相位系统的系统函数H(z)均可由一个最小相位系统H(z)和一
个全通系统H(z)级联而成，即
H(z)=Hm(z)H(z) (2.6.16)
证明 假设因果稳定系统H(z)仅有一个零点在单位圆外，令该零点为z=1/z,
|z|<1,则H(z)可表示为
H(z)=H?(2)(c3-z)=H(z)(3-0)
=H?(2)(1-zz) (2.6.17)
d 因为H?(z)为最小相位系统，所以H?(z)(1-zx1)也是最小相位系统，又因为
为全通系统，故H(z)=H(z)H(z)。显然，|H(e")|=|H(e)|。
该特点说明了在滤波器优化中很有用的结论：将系统位于单位圆外的零(或极)点z用
其镜像1/z代替时，不会影响系统的幅频响应特性。这一点在滤波器优化设计中已用到。
在那里，将单位圆外的极点用其镜像代替，以确保滤波器因果稳定。该结论为我们提供了
一种用非最小相位系统构造幅频特性相同的最小相位系统的方法：将非最小相位系统H(z)
位于单位圆外的零点z用1/z代替(k=1,2,…,m;m。为单位圆外零点数目),即得最
小相位系统H(z),且H(z)与H(z)的幅频响应特性相同。
第2章时域离散信号和系统的频域分析
(2)在幅频响应特性相同的所有因果稳定系统集中，最小相位系统的相位延迟(负的相
位值)最小。
由(2.6.16)式可知，任何一个非最小相位系统H(z)的相位函数，是一个与H(z)的幅
频特性相同的最小相位系统H(z)的相位函数加上一个全通系统H(z)的相位函数。可
89
Created by ZhuangHeng
数字信号处理(第五版)
90
以证明全通系统H(z)的相位函数是非正的1,因此任意系统比最小相位系统多了一个负
相位，这样使最小相位系统具有最小相位延迟的性质，或者从时域说，最小相位系统的时
域响应波形延迟和能量延迟均最小。
(3)最小相位系统保证其逆系统存在。给定一个因果稳定系统H(z)=B(z)/A(z),定
义其逆系统为
Hw(2)=H=B
当且仅当H(z)为最小相位系统时，Hsy(z)才是因果稳定的(物理可实现的)。
逆滤波在信号检测及解卷积中有重要应用。例如，信号检测中的信道均衡器实质上就
是设计信道的近似逆滤波器。
习题与上机题
1.设X(e")和Y(e")分别是x(n)和y(n)的傅里叶变换，试求下面序列的傅里叶变换：
(1) x(n-n?) (2)x'(n)
(4)x(n)*y(n) (3)x(-n)
(6)nx(n) (5)x(n)y(n)
(8)x2(n) (7) x(2n)
(w-{)一衡数 (9)
2.已知
xe)-{<sl<
求X(e")的傅里叶反变换x(n)。
3.线性时不变系统的频率响应(频率响应函数)H(e)=|H(e")|e,如果单位脉冲
响应h(n)为实序列，试证明输入x(n)=A cos(w?n+φ)的稳态响应为
y(n)=A|H(e)|cos[wn+φ+0(a?)]
4.设
={“其他
将x(n)以4为周期进行周期延拓，形成周期序列x(n),画出x(n)和x(n)的波形，求出
(n)的离散傅里叶级数X(k)和傅里叶变换。
5.设题5图所示的序列x(n)的FT用X(e")表示，不直接求出X(e),完成下列
运算或工作：
Created by ZhuangHeng
(1)X(e);
厂x(e)do; (2)
(3)X(e");
(4)确定并画出傅里叶变换实部Re[X(e")]的时间序列x(n);
(5)1x(e)P2do;
(6)[x(c|'d
x(n)
2 2
1 1 1 1
-3 7
-2-101234 56 n
-1 -1
题5图
6.试求如下序列的傅里叶变换：
t?(n)=2o(n+1)+8(n)+28(n-1) (1) x?(n)=6(n-3) (2)
(4) x(n)=u(n+3)-u(n-4) 0<a<1 (3) x?(n)=a"u(n)
7.设：
(1)x(n)是实偶函数，
(2)x(n)是实奇函数，
分别分析推导以上两种假设下，其x(n)的傅里叶变换性质。
8.设x(n)=R?(n),试求x(n)的共轭对称序列x(n)和共轭反对称序列x。(n),并分
别用图表示。
9.已知x(n)=a"u(n),0<a<1,分别求出其偶函数x(n)和奇函数x(n)的傅里叶变换。
10.若序列h(n)是实因果序列，其傅里叶变换的实部如下式：
Hg(e")=1+cosw
求序列h(n)及其傅里叶变换H(e")。
11.若序列h(n)是实因果序列，h(0)=1,其傅里叶变换的虚部为
H?(e")=-sina
求序列h(n)及其傅里叶变换H(e")。
12.设系统的单位脉冲响应h(n)=a"u(n),0<a<1,输入序列为
x(n)=8(n)+28(n-2)
第2章时域离散信号和系统的频域分析
完成下面各题：
91
Created by ZhuangHeng
口口
口
口口
□
口口
口口
口
数字信号处理(第五版)
(1)求出系统输出序列y(n);
(2)分别求出x(n)、h(n)和y(n)的傅里叶变换。
13.已知x,(t)=2cos(2πf。1),式中f。=100 Hz,以采样频率f,=400 Hz对x(t)进行
采样，得到采样信号x(t)和时域离散信号x(n),试完成下面各题：
(1)写出x(t)的傅里叶变换表示式X(j2);
(2)写出x(t)和x(n)的表达式；
(3)分别求出x(t)的傅里叶变换和x(n)的傅里叶变换。
14.求出以下序列的Z变换及收敛域：
(1)2"u(n) (2)-2"u(-n-1)
(3)2?"u(-n) (4)δ(n)
(5)δ(n-1) (6)2"[u(n)-u(n-10)]
15.求以下序列的Z变换及其收敛域，并在z平面上画出极零点分布图。
N=4 (1)r(n)=RN(n)
(2)x(n)=Ar"cos(w?n+φ)u(n)r=0.9,w=0.5π rad,φ=0.25π rad
0≤n≤N 3) -z- N+1≤n≤2N
其他
式中，N=4。
16.已知
xa)+1-
求出对应X(z)的各种可能的序列表达式。
17.已知 x(n)=a"u(n),0<a<1。分别求：
(1)x(n)的Z变换；
(2)nx(n)的Z变换；
(3)a"u(-n)的Z变换。
X(z)=2-523+22 18.已知入 ,分别求：
(1)收敛域0.5<|z|<2对应的原序列x(n);
(2)收敛域|z|>2对应的原序列x(n)。
19.用部分分式法求以下X(z)的反变换：
(1)x(a)-2 Iel>2
(2)x-<贵
92
Created by ZhuangHeng
20.设确定性序列x(n)的自相关函数用下式表示：
ra(m)=∑z(n)(n+m)
试用x(n)的Z变换X(z)和傅里叶变换X(e")分别表示自相关函数的Z变换R_(z)和傅里
叶变换R(e")。
21.用Z变换法解下列差分方程：
(1) y(n)-0.9y(n-1)=0.05u(n) y(n)=0,n≤-1
(2) y(n)-0.9y(n-1)=0.05u(n) y(-1)=1,y(n)=0,n<-1
(3) y(n)-0.8y(n-1)-0.15y(n-2)=8(n)
y(-1)=0.2,y(-2)=0.5,y(n)=0,n≤-3
22.设线性时不变系统的系统函数H(z)为
H(z)=-a a为实数
(1)在z平面上用几何法证明该系统是全通网络，即|H(e")|=常数；
(2)参数a如何取值，才能使系统因果稳定?画出其极零点分布及收敛域。
23.设系统由下面差分方程描述：
y(n)=y(n-1)+y(n-2)+x(n-1)
(1)求系统的系统函数H(z),并画出极零点分布图；
(2)限定系统是因果的，写出H(z)的收敛域，并求出其单位脉冲响应h(n);
(3)限定系统是稳定性的，写出H(z)的收敛域，并求出其单位脉冲响应h(n)。
24.已知线性因果网络用下面差分方程描述：
y(n)=0.9y(n-1)+x(n)+0.9x(n-1)
(1)求网络的系统函数H(z)及单位脉冲响应h(n);
(2)写出网络频率响应函数H(e")的表达式，并定性画出其幅频特性曲线；
(3)设输入x(n)=e",求输出y(n)。
25.已知网络的输入和单位脉冲响应分别为
x(n)=a"u(n),h(n)=b"u(n) 0<a<1,0<b<1
(1)试用卷积法求网络输出y(n);
(2)试用ZT法求网络输出y(n)。
26.线性因果系统用下面差分方程描述：
y(n)-2ry(n-1)cosθ+r3y(n-2)=x(n) 第2章时域离散信号和系统的频域分析
式中，x(n)=a"u(n),0<a<1,0<r<1,θ=常数，试求系统的响应y(n)。
27.如果x(n)和x?(n)是两个不同的因果稳定实序列，求证：
宗x?(e)X?(e)d=[2x?(e)da][x?(e)da]
式中，X?(e")和X?(e")分别表示x?(n)和x?(n)的傅里叶变换。
28.若序列h(n)是因果序列，其傅里叶变换的实部如下式：
93
Created by ZhuangHeng
口口
口 口
□口
口
口口
口
数字信号处理(第五版)
Ha(C)=1+--2a cosla|<1
求序列h(n)及其傅里叶变换H(e")。
29.若序列h(n)是因果序列，h(0)=1,其傅里叶变换的虚部为
H?(e~)=1+a-2a cosla|<1
求序列h(n)及其傅里叶变换H(e")。
30°.假设系统函数如下式：
H(z)=3-3.982+1.172(+2.34182-1.5147
试用MATLAB语言判断系统是否稳定。
31'.假设系统函数如下式：
H(2)=2-2.982+0.1752+2.34182-1.5147
(1)画出极、零点分布图，并判断系统是否稳定；
(2)求出输入单位阶跃序列u(n)检查系统是否稳定。
32".下面四个二阶网络的系统函数具有一样的极点分布：
H?(2)=1-1.6z1+0.9425
H(2)=1-1.6-0.30.9425。
H?(2)=1-1.620+8.9425
H(z)=-11662+0.9425
试用MATLAB语言研究零点分布对于单位脉冲响应的影响。要求：
(1)分别画出各系统的零、极点分布图；
(2)分别求出各系统的单位脉冲响应，并画出其波形；
(3)分析零点分布对于单位脉冲响应的影响。
94
Created by ZhuangHeng
3 章 第
离散傅里叶变换(DFT)
傅里叶变换和Z变换是数字信号处理中常用的重要数学变换。对于有限长序列，还有
一种更为重要的数学变换，即本章要讨论的离散傅里叶变换(Discrete Fourier Transform,
DFT)。DFT之所以更为重要，是因为其实质是有限长序列傅里叶变换的有限点离散采样，
从而实现了频域离散化，使数字信号处理可以在频域采用数值运算的方法进行，这样就大
大增加了数字信号处理的灵活性。更重要的是，DFT有多种快速算法，统称为快速傅里叶
变换(Fast Fourier Transform,FFT),从而使信号的实时处理和设备的简化得以实现。因
此，时域离散系统的研究与应用在许多方面取代了传统的连续时间系统。所以说，DFT不
仅在理论上有重要意义，而且在各种信号的处理中亦起着核心作用。
本章主要讨论DFT的定义、物理意义、基本性质以及频域采样和DFT的应用举例等
内容。
3.1 离散傅里叶变换的定义及物理意义
3.1.1 DFT的定义
设x(n)是一个长度为M的有限长序列，则定义x(n)的N点离散傅里叶变换为
x(k)=DFTLZ(n)]=∑x(m)w k=0,1,…,N-1 (3.1.1)
X(k)的离散傅里叶逆变换(Inverse Discrete Fourier Transform,IDFT)为
x(m)=IDFT[X(A)]=六2x(A)w n=0,1,…,N-1(3.1.2)
95
Created by ZhuangHeng
第3章君散博里叶变奂(□n下
口
口
数字信号处理(第五版)
式中，W=e,N称为DFT变换区间长度，N≥M。通常称(3.1.1)式和(3.1.2)式为离
散傅里叶变换对。为了叙述简洁，常常用DFT[x(n)]、和IDFT[X(k)]、分别表示N点离
散傅里叶变换和N点离散傅里叶逆变换。下面证明IDFT[X(k)]的唯一性。
把(3.1.1)式代入(3.1.2)式，有
IDFT[X(A)]=六z[∑z(m)W]w
-∑=(m)六w-
由于
六w--{m=+,为整数
所以，在变换区间上满足下式：
IDFT[X(k)]N=r(n) 0≤n≤N-1
由此可见，(3.1.2)式定义的离散傅里叶逆变换是唯一的。
【例3.1.1】 x(n)=R?(n),求x(n)的4点和8点DFT。
解 设变换区间N=4,则
X(k)=a(nw:=e
-{o=1.2,3
设变换区间N=8,则
x(A)=∑=(m)w?-
k=0,1,…,7
由此例可见，x(n)的离散傅里叶变换结果与变换区间长度N的取值有关。对DFT与
Z变换和傅里叶变换的关系及DFT的物理意义进行讨论后，上述问题就会得到解释。
3.1.2 DFT与傅里叶变换和Z变换的关系
设序列x(n)的长度为M,其Z变换和N(N≥M)点DFT分别为
X(z)=ZT[x(n)]=∑zn
x(k)=DFTr(n)]=∑(nw k=0,1,…,N-1
比较上面二式可得关系式
96
Created by ZhuangHeng
X(k)=X(z)|k=0,1,…,N-1 (3.1.3)
或
X(k)=X(e)L k=0,1,…,N-1 (3.1.4)
(3.1.3)式表明序列x(n)的N点DFT是x(n)的Z变换在单位圆上的N点等间隔采
样。(3.1.4)式则说明X(k)为x(n)的傅里叶变换X(e")在区间[0,2π]上的N点等间隔采
样。这就是DFT的物理意义。由此可见，DFT的变换区间长度N不同，表示对X(e")在区
间[0,2π]上的采样间隔和采样点数不同，所以DFT的变换结果不同。上例中，
x(n)=R?(n),DFT变换区间长度N分别取8、16时，X(e")和X(k)的幅频特性曲线图如
图3.1.1所示。由此容易得到x(n)=R?(n)的4点DFT为X(k)=DFT[x(n)].=48(k),
这一特殊的结果在下面将得到进一步解释。
4
Ix(ca)1 2
0
0 0.5 1
O/π
1.5 2
(a)x(n)的幅频特性曲线
4
×* 2
0
0 2 4 6 8
k
(b)x(n)的8点DFT
4
(xx 2
0
0 5 10 15
k
(e)x(n)的16点DFT
图3.1.1 R?(n)的FT和DFT的幅度特性关系 第3章离散傅里叶变换(DF1)
3.1.3 DFT的隐含周期性
前面定义的DFT变换对中，x(n)与X(k)均为有限长序列，但由于W～的周期性，使
(3.1.1)和(3.1.2)式中的X(k)和x(n)隐含周期性，且周期均为N。对任意整数m,总有
WN=Wk,m为整数，N为自然数
所以(3.1.1)式中，X(k)满足：
x(k+mN)=x(mw--2z(mw=x(k)
97
Created by ZhuangHeng
口
口 口
口口
口
口口
口
数字信号处理(第五版)
实际上，任何周期为N的周期序列(n)都可以看做长度为N的有限长序列x(n)的周
期延拓序列，而x(n)则是x(n)的一个周期，即
(n)=∑x(n+mN) (3.1.5)
x(n)=i(n)R√(n) (3.1.6)
上述关系如图3.1.2(a)和(b)所示。一般称周期序列x(n)中从n=0到N-1的第一个周期
为x(n)的主值区间，而主值区间上的序列称为x(n)的主值序列。因此x(n)与x(n)的上述
关系可叙述为：x(n)是x(n)的周期延拓序列，x(n)是x(n)的主值序列。
为了以后叙述简洁，当N大于等于序列x(n)的长度时，将(3.1.5)式用如下形式表示：
x(n)=x((n)) (3.1.7)
式中x((n))、表示x(n)以N为周期的周期延拓序列，((n))、表示模N对n求余，即如果
n=MN+n0≤n?≤N-1,M为整数
则
((n))=n?
例如，N=8,x(n)=x((n))。,则有
x(8)=x((8))。=x(0)
x(9)=x((9))。=x(1)
所得结果符合图3.1.2(a)和(b)所示的周期延拓规律。
5
哥
0
-5 0 5 10 15
n
(a)x(n)
x((n))s 5
0
-5 0 5 10 15
n
(b)x(n)的周期延拓序列，N=8
10
(n 5
0
-5 0 5 10 15
n
(c)x(n)的周期延拓序列，N=4
图3.1.2 x(n)及其周期延拓序列
应当说明，若x(n)实际长度为M,延拓周期为N,则当N<M时，(3.1.5)式仍表示
以N为周期的周期序列，但(3.1.6)和(3.1.7)式仅对N≥M时成立。图3.1.2(a)中x(n)
实际长度M=6,当延拓周期N=4时，x(n)如图3.1.2(c)所示。
98
Created by ZhuangHeng
如果x(n)的长度为M,且x(n)=x((n))N,N≥M,则可写出(n)的离散傅里叶级数
表示式
X(A)=(nw=2=(m)、W=2x(n)w (3.1.8)
(n)=÷2×(A)W=÷2x(k)W (3.1.9)
式中
X(k)=X(k)R(k) (3.1.10)
即X(k)为X(k)的主值序列。将(3.1.8)和(3.1.9)式与DFT的定义(3.1.1)和(3.1.2)式
相比较可知，有限长序列x(n)的N点离散傅里叶变换X(k)正好是x(n)的周期延拓序列
x((n))、的离散傅里叶级数系数X(k)的主值序列，即X(k)=X(k)R(k)。后面要讨论的
频域采样理论将会加深对这一关系的理解。我们知道，周期延拓序列频谱完全由其离散傅
里叶级数系数X(k)确定，因此，X(k)实质上是x(n)的周期延拓序列x((n))、的频谱特
性，这就是N点DFT的第二种物理解释(物理意义)。
现在解释DFT[R?(n)].=48(k)。根据DFT第二种物理解释可知，DFT[R?(n)],表示
R?(n)以4为周期的周期延拓序列R?((n)),的频谱特性，因为R?((n)),是一个直流序列，
只有直流成分(即零频率成分)。
3.1.4 用MATLAB计算序列的DFT
MATLAB提供了用快速傅里叶变换算法FFT(算法见第4章介绍)计算 DFT的函数
fft,其调用格式如下：
Xk=fft(xn,N)
调用参数xn为被变换的时域序列向量，N是DFT变换区间长度，当N大于xn的长度
时，fft 函数自动在xn后面补零。函数返回xn的N点DFT变换结果向量Xk,这时，
X(k)=DFT[x(n)]x=Xk(k+1),k=0~N-1。当N小于xn的长度时，fft函数计算xn
的前面N个元素构成的N长序列的N点DFT,忽略xn后面的元素。
ifft 函数计算IDFT,其调用格式与fft 函数相同，可参考 help文件。
【例3.1.2】 设x(n)=R?(n),X(e")=FT[x(n)]。分别计算 X(e)在频率区间
[0,2π]上的16点和32点等间隔采样，并绘制X(e")采样的幅频特性图和相频特性图。
解 由DFT与傅里叶变换的关系知道，X(e")在频率区间[0,2π]上的16点和32点
等间隔采样，分别是x(n)的16点和32点DFT。调用fft 函数求解本例的程序ep312.m
如下：
??3.1.2程序ep312.m

FT的MATLB计算
xn=[1111]: ??人时域序列向量xn=R?(n)
Xk16=fft(xn,16); ??算xn的16点DFT
Xk32=fft(xn,32); ??算xn的32点DFT
第3章离散傅里叶变换(DFT)
99
Created by ZhuangHeng
口
口
口
口
数字信号处理(第五版)
??下为绘图部分(省略，程序集中有)
程序运行结果如图3.1.3所示。
4 4
幅度 2 幅度 2
0
0
0
0.5 1 1.5 2 0 0.5 1 1.5 2
o/π 0/π
(a)16点DFT的幅频特性图 (c)32点DFT的幅频特性图
2 2
相位 0 相位 0
-2 -2
0 0.5 1 1.5 2 0 0.5 1 1.5 2
0/π 0/π
(b)16点DFT的相频特性图 (d)32点DFT的相频特性图
图3.1.3 程序ep312.m运行结果
3.2 离散傅里叶变换的基本性质
3.2.1 线性性质
如果x?(n)和x?(n)是两个有限长序列，长度分别为N?和N?,且
y(n)=ar?(n)+bx?(n)
式中，a、b为常数，取N≥max[N?,N?],则y(n)的N点DFT为
Y(k)=DFTLy(n)]=aX?(k)+bX?(k)0≤k≤N-1 (3.2.1)
其中X?(k)和X?(k)分别为x?(n)和x?(n)的N点DFT。
3.2.2 循环移位性质
1.序列的循环移位
设x(n)为有限长序列，长度为M,M≤N,则r(n)的循环移位定义为
y(n)=x((n+m))R～(n) (3.2.2)
(3.2.2)式表明，将x(n)以N为周期进行周期延拓得到x(n)=x((n))。,再将x(n)左移m
得到x(n+m),最后取x(n+m)的主值序列则得到有限长序列x(n)的循环移位序列y(n)。
M=6,N=8,m=2时，x(n)及其循环移位过程如图3.2.1所示。显然，y(n)是长度为N
100
Created by ZhuangHeng
的有限长序列。观察图3.2.1可见，循环移位的实质是将x(n)左移m位，而移出主值区
[0≤n≤N-1]的序列值又依次从右侧进入主值区。“循环移位”就是由此得名的。
1 1
0.5 0.5
0 ol -5 0 5 10 15 -5 0 5 10 15
n
(a)x(n)
n
(b)x((n)
1 1
0.5 0.5
0L 0
-5 0 5 10 15 -5 0 5 10 15
n n
(c)x((n+2)。 (d)x((n+2))?Rg(n)
图3.2.1 x(n)及其循环移位过程
由循环移位的定义可知，对同一序列x(n)和相同的位移m,当延拓周期N不同时，
y(n)=x((n+m))NR(n)则不同。请读者画出N=M=6,m=2时，x(n)的循环移位序
列y(n)波形图。
2.时域循环移位定理
设x(n)是长度为M(M≤N)的有限长序列，y(n)为x(n)的循环移位，即
y(n)=x((n+m))NR(n)
则
Y(k)=DFT[y(n)]、=WNX(k) (3.2.3)
其中 X(k)=DFT[x(n)]N0≤k≤N-1
证明
Y(k)=DFTSy(n)x=∑x(n+m)、Ra(n)w=Zx(n+m)W
令n+m=n',则有
Y(k)=Zx(),wW=wa(n')WS
由于上式中求和项x((n'))NW以N为周期，因此对其在任一周期上的求和结果相同。将
上式的求和区间改在主值区，则得
Y(k)=w∑x(m)W=w∑z(n)w=w×(k)
3.频域循环移位定理
如果
第3章
离散傅里叶变换(DF1)
X(k)=DFT[x(n)]、0≤k≤N-1
Y(k)=X(Ck+D))、RN(k)
101
Created by ZhuangHeng
口
口口
口口
口
口
数字信号处理(第五版)
102
则
y(n)=IDFT[Y(k)]、=WNx(n) (3.2.4)
(3.2.4)式的证明方法与时域循环移位定理类似，直接对Y(k)=X(Ck+1)、R(k)进行
IDFT即得证。
3.2.3 循环卷积定理
时域循环卷积定理是DFT中最重要的定理，具有很强的实用性。已知系统输入和系统
的单位脉冲响应，计算系统的输出，以及用FFT实现FIR滤波器等，都是基于该定理的。
下面首先介绍循环卷积的概念和计算循环卷积的方法，然后介绍循环卷积定理。
1.两个有限长序列的循环卷积
设序列h(n)和x(n)的长度分别为N和M。h(n)与x(n)的L点循环卷积定义为
v.(n)=[Zh(m)x((n-m),]R?(m) (3.2.5)
式中，L称为循环卷积区间长度，L≥max[N,M]。上式显然与第1章介绍的线性卷积不同，
为了区别线性卷积，用◎表示循环卷积，用D表示L点循环卷积，即y.(n)=h(n)Dx(n)。观
察(3.2.5)式，x((n-m)),是以L为周期的周期信号，n和m的变化区间均是[0,L-1],
因此直接计算该式比较麻烦。计算机中采用矩阵相乘或快速傅里叶变换(FFT)的方法计算
循环卷积。下面介绍用矩阵计算循环卷积的公式。
当n=0,1,2,…,L-1时，由x(n)形成的序列为：{x(0),x(1),…,x(L-1)}。令
n=0,m=0,1,…,L-1,由式(3.2.5)中x((n-m)),形成x(n)的循环倒相序列为
{x((0)):,x((-1)),x((-2)),…,x((-L+1)))
={x(0),x(L-1),x(L-2),…,x(1)}
与序列x(n)进行对比，相当于将第一个序列值x(0)不动，将后面的序列{x(1),x(2),…
x(L-1)}反转180°再放在x(0)的后面。这样形成的序列称为x(n)的循环倒相序列。
令n=1,m=0,1,…,L-1,由式(3.2.5)中x((n-m)),形成的序列为
{x((1))L,x((0)),x((-1)),…,x((-L+2))}
=(x(1),x(0),x(L-1),…,x(2)}
观察上式等号右端序列，它相当于x(n)的循环倒相序列向右循环移一位，即向右移1位，
移出区间[0,L-1]的序列值再从左边移进。
再令n=2,m=0,1,…,L-1,此时得到的序列又是上面的序列向右循环移1位。
依次类推，当n和m均从0变化到L-1时，得到一个关于x((n-m))的矩阵如下：
x(0)r(L-1) x(L-2)
x(1)x(0) x(L-1)… x(2)
(3.2.6)
Created by ZhuangHeng
上面矩阵称为x(n)的L点“循环卷积矩阵”,其特点是：
(1)第1行是序列{x(0),x(1),…,x(L-1)}的循环倒相序列。注意，如果x(n)的长
度M<L,则需要在x(n)末尾补L-M个零后，再形成第一行的循环倒相序列。
(2)第1行以后的各行均是前一行向右循环移1位形成的。
(3)矩阵的各主对角线上的序列值均相等。
有了上面介绍的循环卷积矩阵，就可以写出式(3.2.5)的矩阵形式如下： E
h(0) x(1)]
(3.2.7)
按照上式，可以在计算机上用矩阵相乘的方法计算两个序列的循环卷积，这里关键是先形
成循环卷积矩阵。上式中如果h(n)的长度N<L,则需要在h(n)末尾补L-N个零。
【例3.2.1】 计算下面给出的两个长度为4的序列h(n)与x(n)的4点和8点循环
卷积。
x(n)=(x(0),x(1),x(2),x(3))={1,2,3,4}
h(n)={h(0),h(1),h(2),h(3)}={1,1,1,1}
解 按照式(3.2.7)写出h(n)与x(n)的4点循环卷积矩阵形式为
h(n)与x(n)的8点循环卷积矩阵形式为
1 3
1 6
1 10
=
0 9
7 0
4 0
Lo] -0
第3章离散傅里叶变换(DFT)
h(n)和x(n)及其4点和8点循环卷积结果分别如图3.2.2(a)、(b)、(c)和(d)所示。请读者
计算验证本例的8点循环卷积结果等于h(n)与x(n)的线性卷积结果。后面将证明，当循
环卷积区间长度L大于等于y(n)=h(n)*x(n)的长度时，循环卷积结果就等于线性
卷积。
103
Created by ZhuangHeng
口
口
口
口
口
口
口
口口
口 口
口
口口
口口
口 口
口口
a口
数字信号处理(第五版)
15 4
其刀2 h(n) 1
0.5
0
0 2 4 6 8
o
0 2 4 6 8
n n
(a)x(n) (b)h(n)
10 10
y.(n) s yn 5
% 2 4 6 8 % 2 4 6 8
n n
(c)4点循环卷积 (d)8点循环卷积
图3.2.2 序列及其循环卷积波形
2.循环卷积定理
有限长序列x?(n)和x?(n)的长度分别为N?和N?,N≥max[N,N?],x?(n)和x?(n)
的N点循环卷积为
a(m)=a?WOz;(w=[2A(m)n(n-m)JRa(m) (3.2.8)
则x(n)的N点DFT为
其中
X(k)=DFT[x(n)]n=X?(k)X?(k)
X?(k)=DFT[x?(n)]N,X?(k)=DFT[x?(n)]~
(3.2.9)
证明 直接对(3.2.8)式两边进行DFT,则有
X(k)=DFT[x(n)]、
=2[Zz?(m)t?((n-m)、R(n]w
=2x(mz?(n-m)w
令n-m=n',则有
x()=2z(m)2?(m/)w
=z(mw-(n)w
因为上式中x?((n'))~WN是以N为周期的，所以对其在任一个周期上求和的结果不变。
因此
x(A)=Zx?(mw·2z()w
=X?(k)X?(k)0≤k≤N-1
由于X(k)=DFT[x(n)]=X?(k)X?(k)=X?(k)X?(k),因此
x(n)=IDFT[X(k)]=x?(n)×x?(n)=x?(n)x?(n)
104
Created by ZhuangHeng
即循环卷积亦满足交换律。
作为习题请读者证明以下频域循环卷积定理：
如果x(n)=x?(n)x?(n),则
X(k)=DFT[x(n)]x=六x?(k)OX?(k)
-[∑x,(DX?(k-)AJRa() (3.2.10a)
或
X(k)=六x:(k)OX?(k)=六[∑x?CDx?((k-D)、JR(k)(3.2.10b)
式中
X.(k)=DFTa(Oo≤k≤N-1
相对频域循环卷积定理，称(3.2.9)式为时域循环卷积定理。
3.2.4 复共轭序列的DFT
设x(n)是x(n)的复共轭序列，长度为N,X(k)=DFT[x(n)],则
DFT[x(n)]=X(N-k) 0≤k≤N-1 (3.2.11)
且X(N)=X(0)。
证明 根据DFT的唯一性，只要证明(3.2.11)式右边等于左边即可。
x'(N-k)=[2x(nwS]=Zx(nw
-∑x(nw=DFT[a(n]。
又由X(k)的隐含周期性，有
X(N)=X(0)
用同样的方法可以证明
DFT[x'(N-n)]x=X(k) (3.2.12)
3.2.5 DFT的共轭对称性
第3章离散傅里叶变换(DFT)
如前所述，序列傅里叶变换满足共轭对称性，其对称性是指关于坐标原点的纵坐标的
对称性。DFT也有类似的对称性，但在DFT中涉及的序列x(n)及其离散傅里叶变换X(k)
均为有限长序列，且定义区间为0到N-1,所以这里的对称性是指关于N/2点的对称性。
下面讨论DFT的共轭对称性。
1.有限长共轭对称序列和共轭反对称序列
为了区别于傅里叶变换中所定义的共轭对称(或共轭反对称)序列，下面用x(n)和
105
Created by ZhuangHeng
数字信号处理(第五版)
x(n)分别表示有限长共轭对称序列和共轭反对称序列，则二者满足如下关系式：
x(n)=(N-n) 0≤n≤N-1 (3.2.13a)
x(n)=-x(N-n)0≤n≤N-1 (3.2.13b)
当N为偶数时，将上式中的n换成N/2-n,可得到：
(-n)=x(2+n) 0≤n≤2-1
(2-n)=-x(2+n) 0≤n≤-1
上式更清楚地说明了有限长共轭对称序列是关于n=N/2点共轭对称。容易证明，如同任
何实函数都可以分解成偶对称分量和奇对称分量一样，任何有限长序列x(n)都可以表示成
其共轭对称分量和共轭反对称分量之和，即
x(n)=x(n)+x(n) 0≤n≤N-1 (3.2.14)
将上式中的n换成N-n,并取复共轭，再将(3.2.13a)式和(3.2.13b)式代入，得到：
x"(N-n)=x(N-n)+x(N-n)=x(n)-x(n) (3.2.15)
(3.2.14)式分别加减(3.2.15)式，可得
x(n)=-[z(n)+x'(N-n] (3.2.16a)
r(n)=_[z(n)-x'(N-n)] (3.2.16b)
2.DFT的共轭对称性
(1)如果将x(n)表示为
x(n)=r,(n)+jx;(n) (3.2.17)
其中
x,(n)=Re[z(n)]=[x(n)+x'(n)]
jx;(n)=j Im[x(n)]=[z(n)-x'(n)]
那么,由(3.2.11)式和(3.2.16a)式可得
DFT[x,(n)]=DFT[r(n)+x'(n)]=2[X(k)+X*(N-k)]=X(k)
(3.2.18)
由(3.2.11)式和(3.2.16b)式可得
DFTLiz(n)]=DFT[z(n)-x'(n)]=号[X(k)-x'(N-k)]=X,(k)
(3.2.19)
由DFT的线性性质即可得
X(k)=DFT[x(n)]=X(k)+X。(k) (3.2.20)
其中，X(k)=DFT[x,(n)]是X(k)的共轭对称分量，X(k)=DFT[jx;(n)]是X(k)的共
106
Created by ZhuangHeng
轭反对称分量。
(2)如果将x(n)表示为
x(n)=x(n)+x(n) 0≤n≤N-1 (3.2.21)
(n)=2[x(n)+x'(N-n)]是x(n)的共轭对称分量，(n)=2[x(n)- 其中，
x"(N-n)]是x(n)的共轭反对称分量，那么,由(3.2.12)式可得
DFT[z(n)]=DFT[x(n)+x'(N-n)]=[X(k)+X"(k)]=Re[X(k)]
DFT[x(n)]=DFT[Lz(n)-x'(N-n)]=[X(k)-x'(k)]=j Im[X(k)]
因此
X(k)=DFT[x(n)]=X&(k)+jX?(k) (3.2.22)
其中
Xg(k)=Re[X(k)]=DFT[x(n)]
jX?(k)=jIm[X(k)]=DFT[x(n)]
综上所述，可总结出DFT的共轭对称性质：如果序列x(n)的DFT为X(k),则x(n)
的实部和虚部(包括j)的DFT分别为X(k)的共轭对称分量和共轭反对称分量；而x(n)的
共轭对称分量和共轭反对称分量的DFT分别为X(k)的实部和虚部乘以j。
另外，请读者根据上述共轭对称性证明有限长实序列DFT的共轭对称性(见本章习题
题7)。
设x(n)是长度为N的实序列，且X(k)=DFT[x(n)]N,则X(k)满足如下对称性：
(1)X(k)共轭对称，即
X(k)=X*(N-k)k=0,1,…,N-1 (3.2.23)
(2)如果x(n)是实偶对称序列，即x(n)=x(N-n),则X(k)实偶对称，即
X(k)=X(N-k) (3.2.24)
(3)如果x(n)是实奇对称序列，即x(n)=-x(N-n),则X(k)纯虚奇对称，即
X(k)=-X(N-k) (3.2.25)
实际中经常需要对实序列进行DFT,利用上述对称性质，可减少DFT的运算量，提高
运算效率。例如，计算实序列的N点DFT时，当N=偶数时，只需计算 X(k)的前面
N/2+1点，而N=奇数时，只需计算X(k)的前面(N+1)/2点，其他点按照(3.2.23)式
即可求得。例如，X(N-1)=X"(1),X(N-2)=X*(2),…,这样可以减少近一半运
算量。
【例3.2.2】 利用DFT的共轭对称性，设计一种高效算法，通过计算一个N点DFT,
就可以计算出两个实序列x?(n)和x?(n)的N点DFT。
解 构造新序列x(n)=x?(n)+jx?(n),对x(n)进行N点DFT,得到：
X(k)=DFT[x(n)]=X(k)+X(k)
由(3.2.17)、(3.2.18)和(3.2.19)式得到：
第3章
离散傅里叶变换(DF1)
107
Created by ZhuangHeng
口
口
口
数字信号处理(第五版)
X。(k)=DFT[Lz;(n)]=[X(k)+x'(N-k)]
X,(k)=DFTLiz?(n)]=[X(k)-x'(N-k)]
所以，由X(k)可以求得两个实序列x?(n)和x?(n)的N点DFT:
x?(k)=DFT[z?(n)]=2[X(k)+x(N-k)]
X?(k)=DFT[r?(n)]=-j [X(k)-x'(N-k)]
3.3 频率域采 样
时域采样定理告诉我们，在一定条件下，可以由时域离散采样信号恢复原来的连续信
号。那么能不能也由频域离散采样恢复原来的信号(或原连续频率函数)?其条件是什么?
内插公式又是什么形式?本节就上述问题进行讨论。
设任意序列x(n)的Z变换为
X(2)=∑a(n)z
且X(x)的收敛域包含单位圆(即x(n)存在傅里叶变换)。在单位圆上对X(z)等间隔采样N
点，得到：
X(k)=X(z)=∑z(n)e-∑z(n)W 0≤k≤N-1(3.3.1)
显然，(3.3.1)式表示在区间[0,2π]上对x(n)的傅里叶变换X(e")的N点等间隔采样。将
X(k)看做长度为N的有限长序列x(n)的DFT,即
xN(n)=IDFT[X(k)]0≤n≤N-1
下面推导序列xx(n)与原序列x(n)之间的关系，并导出频域采样定理。
由DFT与DFS的关系可知，X(k)是xn(n)以N为周期的周期延拓序列x(n)的离散
傅里叶级数系数X(k)的主值序列，即
X(k)=X((k))、=DFS[(n)]
X(k)=X(k)RN(k)
(n)=x×(n)。=IDFSCX(A)]=卡2x()W=÷x(k)W
将(3.3.1)式代入上式得
(m)=÷2[2x(mW]w=a(m)÷2w
108
Created by ZhuangHeng
式中
m=n+iN,i为整数 六w={ 其他m
因此
(n)=∑z(n+iN) (3.3.2)
所以
z(n)=(n)R、(n)=∑z(n+iN)R&(n) (3.3.3)
式(3.3.3)说明，X(z)在单位圆上的N点等间隔采样X(k)的N点IDFT是原序列x(n)以
N为周期的周期延拓序列的主值序列。综上所述，可以总结出频域采样定理：
如果序列x(n)的长度为M,则只有当频域采样点数N≥M时，才有
x(n)=IDFT[X(k)]=x(n)
即可由频域采样X(k)恢复原序列x(n),否则产生时域混叠现象。
满足频域采样定理时，频域采样序列X(k)就是原序列x(n)的N点DFT,所以 X(k)
的N点IDFT是原序列x(n),必然可以由X(k)恢复X(z)和X(e")。下面推导用频域采样
X(k)表示X(z)和X(e")的内插公式和内插函数。设序列x(n)长度为M,在频域[0,2π]上
等间隔采样N点，N≥M,则有
x(z)=2z(ne
X(k)=X(z)| k=0,1,2,…,N-1
因为满足频域采样定理，所以式中
z(n)=IDFTX(A)]=÷2xck)W
将上式代入X(z)的表示式中，得到：
x(e)=22x(k)w-]-÷2x(k)Zw
-六2x(A)W (3.3.4a) 3(章离散博里变换(□山卜
式中，W=1,因此
x(2)=六x(k) (3.3.4b)
令
e.(2)=六—w (3.3.5)
则
109
Created by ZhuangHeng
数字信号处理(第五版)
x(z)-x(k)g(2) (3.3.6)
式(3.3.6)称为用X(k)表示X(z)的复频域内插公式，p(z)称为复频域内插函数。将z=e
代入(3.3.4a)式，并进行整理化简，可得
x(e)=x(k)e(m--)
(w)=Nsin(N/2)。()
(3.3.7)
(3.3.8)
(3.3.7)式称为频域内插公式，p(w)称为频域内插函数。在数字滤波器的结构与设计
中，我们将会看到，频域采样理论及有关公式可提供一种有用的滤波器结构和滤波器设计
途径，(3.3.7)式有助于分析FIR滤波器频率采样设计法的逼近性能。
【例3.3.1】长度为26的三角形序列x(n)如图3.3.1(b)所示。编写MATLAB程序
验证频域采样理论。
解 解题思想：先计算 x(n)的32点DFT,得到其频谱函数X(e")在频率区间[0,2π]
上等间隔32点采样X?(k),再对X?(k)隔点抽取，得到X(e")在频率区间[0,2π]上等间
隔16点采样X??(k)。最后分别对X??(k)和Xg(k)求IDFT,得到：
x?(n)=IDFT[X?(k)]
x??(n)=IDFT[X2(k)]2
绘制x??(n)和x(n)波形图验证频域采样理论。
MATLAB求解程序ep331.m如下：
??数字信号处理(第四版)》第3章例3.3.1程序ep331.m
??域采样理论验证
M=26;N=32;n=0:M;
xa=0:M/2;xb= ceil(M/2)-1:-1:0;xn=[xa,xb];??生M长三角波序列x(n)
Q2点FFT[x(n)] Xk=fft(xn,512);
X32k=fft(xn,32); 2点FFT[x(n)]
2点IFFT[X32(k)]得到x32(n) x32n=ifft(X32k):
X16k=X32k(1:2:N); ??点抽取X32k得到X16(k)
x16n=ifft(X16k,N/2); 点IFFT[X16(k)]得到x16(n)
以下绘图部分省略。
程序运行结果如图3.3.1所示。图3.3.1(a)和(b)分别为X(e")和x(n)的波形；图
3.3.1(c)和(d)分别为X(e")的16点采样|X??(k)|和x(n)=IDFT[X??(k)],波形图；图
3.3.1(e)和(f)分别为X(e")的32点采样|X?(k)|和x(n)=IDFT[X(k)]2波形图；由
于实序列的DFT满足共轭对称性，因此频域图仅画出[0,π]上的幅频特性波形。本例中
x(n)的长度M=26。从图中可以看出，当采样点数N=16<M时，x??(n)确实等于原三角序列
x(n)以16为周期的周期延拓序列的主值序列。由于存在时域混叠失真，因而x??(n)≠x(n);
当采样点数N=32>M时，无时域混叠失真，x(n)=IDFT[X(k)]=x(n)。
110
Created by ZhuangHeng
200 15
Ix(emgI 10
100 (u)x 5
0
0 0.5 1 % 10 20 30
o/t n
(a)FT[x(n)] (b)三角波序列x(n)
200 15
X?(k) 100 (u)lx 10
5
0L
0 2 4 6 8 % 10 20 30
k n
(c)16点频域采样 (d)16点IDFT[X??(k)]
200 15
)krrX 100 xira 10
5
0
0 5 10 15 % 10 20 30 k n
(e)32点频域采样 (1)32点IDFT[X?(k)]
图3.3.1 频域采样定理验证
3.4 DFT的应用举例
DFT的快速算法FFT的出现，使DFT在数字通信、语音信号处理、图像处理、功率
谱估计、系统分析与仿真、雷达信号处理、光学、医学、地震以及数值分析等各个领域都得
到广泛应用。然而，各种应用一般都以卷积和相关运算的具体计算为依据，或者以DFT作
为连续傅里叶变换的近似为基础。所以本节主要介绍用DFT计算卷积的基本原理以及用
DFT对连续信号和序列进行谱分析等最基本的应用。只要掌握了这两种基本应用的原理，
就为用DFT解决数字滤波和系统分析等问题打下了基础。
3.4.1 用DFT计算线性卷积
用DFT计算循环卷积很简单。设h(n)和x(n)的长度分别为N和M,其L点循环卷积为
v.(n)=h(n)r(n)-Zh(m)z((n-m),R?(m)
且
X(k)=DFTaco≤k≤L-1,L≥max[N,M
则由DFT的时域循环卷积定理有
Ye(k)=DFT[y.(n)]=H(k)X(k)0≤k≤L-1
第3章
离散傅里叶变换(DFT)
111
Created by ZhuangHeng
由此可见，循环卷积既可以在时域直接计算，也可以按照图3.4.1所示的计算框图在频域
计算。由于DFT有快速算法，当L很大时，在频域计算循环卷积的速度快得多，因而常用
DFT(FFT)计算循环卷积。
数字信号处理(第五版)
h(n) 补L-N个零 L点DFT H(k)
× Ye(k) L点IDFT y.(n)
x(n) 补L-M个零 L点DFT X(k)
图3.4.1 用DFT计算循环卷积的原理框图
在实际应用中，为了分析时域离散线性时不变系统或者对序列进行滤波处理等，需要计
算两个序列的线性卷积。与计算循环卷积一样，为了提高运算速度，也希望用DFT(FFT)计算
线性卷积。而DFT只能直接用来计算循环卷积，因此，下面先导出线性卷积和循环卷积之间
的关系以及循环卷积与线性卷积相等的条件，最后得出用图3.4.1计算线性卷积的条件。
假设h(n)和x(n)都是有限长序列，长度分别是N和M。它们的线性卷积和循环卷积
分别表示如下：
y,(m)=h(n)*z(n)=Zh(m)a(n-m) (3.4.1)
y.(n)=h(n)@r(n)=(∑hcm)r((n-m)E]R?(m) (3.4.2)
其中
L≥max[N,M],x((n),=∑x(n+L)
所以
v.(m)=[2h(m)2(n-m+L)]R(m)=[22h(m)rcn+L-m]]R?(n)
对照(3.4.1)式可以看出，上式中
∑h(m)r(n+iL-m)=y(n+L)
即
v.(n)=[2v.(n+L)]R?(n) (3.4.3)
(3.4.3)式说明，y.(n)等于y,(n)以L为周期的周期延拓序列的主值序列。我们知道，
y,(n)长度为N+M-1,因此只有当循环卷积长度L≥N+M-1时，y,(n)以L为周期进行
周期延拓时才无时域混叠现象。此时取其主值序列显然满足y.(n)=y,(n)。由此证明了循
环卷积等于线性卷积的条件是L≥N+M-1。图3.4.2中画出了h(n)、x(n)、h(n)*x(n)以
及L分别取6、8、10时h(n)①x(n)的波形。由于h(n)长度N=4,x(n)长度M=5,
N+M-1=8,因此只有L≥8时，h(n)Dr(n)波形才与h(n)*x(n)相同。
112
Created by ZhuangHeng
1.5 1.5
1
是 0.5 x(n) 0.5
1
0
0 5
n
10 5 10
n
(a)h(n)波形 (b)x(n)波形 5 5
y(n ydn
0
0
n
5 10 5 10 n
(c)yi(n)-h(n)°x(n) (d)6点循环卷积
5 5
n y.(n)
0
0 5 10
n
5
n
10
(e)8点循环卷积 1)10点循环卷积
图3.4.2 线性卷积与循环卷积波形图
综上所述，取L≥N+M-1,则可按照如图3.4.1所示的计算框图用DFT(FFT)计算
线性卷积。其中DFT和IDFT通常用快速算法(FFT)来实现，故常称其为快速卷积。
实际上，经常遇到两个序列的长度相差很大的情况，例如M>N。若仍选取L≥N+M
-1,以L为循环卷积区间，并用上述快速卷积法计算线性卷积，则要求对短序列补很多零
点，而且长序列必须全部输入后才能进行快速计算。因此要求存储容量大，运算时间长，并
使处理延时很大，不能实现实时处理。况且在某些应用场合，序列长度不定或者认为是无
限长，如电话系统中的语音信号和地震检测信号等。显然，在要求实时处理时，直接套用上
述方法是不行的。解决这个问题的方法是将长序列分段计算，这种分段处理方法有重叠相
加法和重叠保留法两种。下面只介绍重叠相加法，重叠保留法作为本章习题21,留给读者
讨论。
设序列h(n)长度为N,x(n)为无限长序列。将x(n)等长分段，每段长度取M,则 第3章离散博里叶变换(DrT
x(n)=∑x,(n) x?(n)=x(n)R(n-kM) (3.4.4a)
于是，h(n)与x(n)的线性卷积可表示为
y(n)=h(n)*x(n)=h(n)∑z(m)=Zh(n)*x(n)=(n) (3.4.4b)
式中
y.(n)=h(n)*x(n) (3.4.4c)
(3.4.4b)式说明，计算h(n)与x(n)的线性卷积时，可先计算分段线性卷积y(n)=h(n)*
113
Created by ZhuangHeng
口口
口
口
口口
口
口
口
口
口
数字信号处理(第五版)
x?(n),然后把分段卷积结果叠加起来即可，如图3.4.3所示。每一分段卷积y,(n)的长度
为N+M-1,因此相邻分段卷积y(n)与y+1(n)有N-1个点重叠，必须把重叠部分的
y.(n)与y+i(n)相加，才能得到正确的卷积序列y(n)。显然，可用图3.4.1所示的快速卷
积法计算分段卷积y,(n),其中L=N+M-1。由图3.4.3可以看出，当第二个分段卷积
y?(n)计算完后，叠加重叠点便可得输出序列y(n)的前2M个值；同样道理，分段卷积
y,(n)计算完后，就可得到y(n)第i段的M个序列值。因此，这种方法不要求大的存储容
量，且运算量和延时也大大减少，最大延时Tpmx=2MT,+T。,T,是系统采样间隔，T。是
计算1个分段卷积所需时间，一般要求T。<MT,。这样，就实现了边输入边计算边输出，
如果计算机的运算速度快，可以实现实时处理。
h(m)
0
N
n
x(n)
0
xo(n) x?(n) x?(n)
M M M
n
yo(n)
0
N+M-1
N-1
n
yi(n)
0
y?(n)
N+M-1
N+M-1
n
0
(n)=yo(n)+y(n)+y?(n)+…
2M M
3M+N-1
图3.4.3 用重叠相加法计算线性卷积的时域关系示意图
用DFT 计算分段卷积y,(n)的方法如下：
(1)i=0;L=N+M-1;计算并保存H(k)=DFT[h(n)]_;
(2)读入x,(n)=x(n)RM(n-iM),构造变换区间[0,L-1]上的序列(n)=
x?(n+iMR(n),实际中就是将x,(n)的M个值存放在长度为M的数组中，并计算X,(k)=
DFT[x,(n)];
(3)Y(k)=H(k)X,(k);
(4)j(n)=y(n+kM)R?(n)=IDFT[Y,(k)]?,n=0,1,2,…,L-1;
(5)计算： voM+-M+.N-I<n-M-(重蚕区不加)
(6)i=i+1,返回(2)。
114
Created by ZhuangHeng
应当说明，一般x(n)是因果序列，假设初始条件y-(n)=0。
MATLAB信号处理工具箱中提供了一个函数fftfilt,该函数用重叠相加法实现线性卷
积的计算。调用格式为：y=fftfilt(h,x,M)。调用参数中，h是系统单位脉冲响应向量；x
是输入序列向量；y是系统的输出序列向量(h与x的卷积结果);M是由用户选择的输入
序列x的分段长度，缺省M时，默认输入序列x的分段长度M=512。
【例3.4.1】 假设h(n)=R;(n),x(n)=[cos(πn/10)+cos(2πn/5)]u(n),用重叠相
加法计算y(n)=h(n)*x(n),并画出h(n)、x(n)和y(n)的波形。
解 h(n)的长度为N=5,对x(n)进行分段，每段长度为M=10。计算h(n)和x(n)的
线性卷积的MATLAB程序如下：
??3.4.1重叠相加法的MATLAB实现程序：ep341.m
Lx=41;N=5;M=10; ?为信号序列x(n)长度
hn=ones(1,N); hnl=[hnzeros(1,Lx-N)]: ??生h(n),其后补零是为了绘图好看
n=0:Lx-1;
xn=cos(pi*n/10)+cos(2*pi*n/5); ??生x(n)的Lx个样值
yn=fftfilt(hn,xn,M); ??用fftfilt用重叠相加法计算卷积
??下为绘图部分(省略)
运行程序画出h(n)、x(n)和y(n)的波形如图3.4.4所示。请读者从理论上证明y(n)
的稳态波形是单一频率的正弦波。
1
h(n) 0.5
0
0 5 10 15 20 25 30 35 40 45
2
(u)x 0
-20 5 10 15 20 25 30 35 40 45
5
y(n) 0
第3章离散傅里叶变换(DFT)
-50 5 10 15 20 25 30 35 40 45
n
图3.4.4 例3.4.1的求解程序运行结果
运行绘图程序fig345.m可以得到用重叠相加法求解本例题的x (n),y?(n)和y(n)=
y。(n)+y;(n)+y?(n)+y?(n),如图3.4.5所示。
115
Created by ZhuangHeng
口
数字信号处理(第五版)
h(n)
(u)x
)a)°x
)0),虽
(u)2x
x(m)
)ay
u)(y
y?(n)
y?(n)
y(n)
1
0.5
ol0
2
0
-2。
2
-2
0
0
2
0
-20
2
0
-20
2
0
-2。
5[
0
-50
5[
0
-5。
5[
0
-5。
5
0
-5l
0
5
0
-50
5
5
5
5
5
5
5
5
5
5
5
10 15 20 25 30
10 15 20 25 30
10 15 20 25 30
10 15 20 25 30
10 15 20 25 30
10 15 20 25 30
10 15 20 25 30
10 15 20 25 30
10 30 15 20 25
10 15 20 25 30
10 15 20 25 30 n
图3.4.5 重叠相加法时域波形
35
35
35
35
35
35
35
35
35
35
35
40
40
40
40
40
40
40
40
40
40
40
116
45
45
45
45
45
45
45
45
45
45
45
Created by ZhuangHeng
3.4.2 用DFT对信号进行谱分析
所谓信号的谱分析，就是计算信号的傅里叶变换。连续信号与系统的傅里叶分析显然
不便于直接用计算机进行计算，使其应用受到限制。而DFT是一种时域和频域均离散化的
变换，适合数值运算，成为用计算机分析离散信号和系统的有力工具。对连续信号和系统，
可以通过时域采样，应用DFT进行近似谱分析。下面分别介绍用DFT对连续信号和离散
信号(序列)进行谱分析的基本原理和方法。
1.用DFT对连续信号进行谱分析
工程实际中，经常遇到连续信号x(t),其频谱函数X。(j2)也是连续函数。为了利用
DFT对x(t)进行频谱分析，先对x,(t)进行时域采样，得到x(n)=x(nT),再对x(n)进
行DFT,得到的X(k)则是x(n)的傅里叶变换X(e")在频率区间[0,2π]上的N点等间隔
采样。这里x(n)和X(k)均为有限长序列。然而，由傅里叶变换理论知道，若信号持续时间
有限长，则其频谱无限宽；若信号的频谱有限宽，则其持续时间必然为无限长。所以严格地
讲，持续时间有限的带限信号是不存在的。因此，按采样定理采样时，上述两种情况下的采
样序列x(n)=x,(nT)均应为无限长，不满足DFT的变换条件。实际上对频谱很宽的信号，
为防止时域采样后产生频谱混叠失真，可用预滤波器滤除幅度较小的高频成分，使连续信
号的带宽小于折叠频率。对于持续时间很长的信号，采样点数太多，以致无法存储和计算，
只好截取有限点进行 DFT。由上述可见，用DFT对连续信号进行频谱分析必然是近似的，
其近似程度与信号带宽、采样频率和截取长度有关。实际上从工程角度看，滤除幅度很小
的高频成分和截去幅度很小的部分时间信号是允许的。因此，在下面分析中，假设x(t)是
经过预滤波和截取处理的有限长带限信号。
设连续信号x(t)持续时间为T,最高频率为f。,如图3.4.6(a)所示。x,(1)的傅里叶
变换为X,(j2),对x(t)进行时域采样得到x(n)=x(nT),x(n)的傅里叶变换为X(e")。
由假设条件可知 x(n)的长度为
N==T,F. (3.4.5)
式中，T为采样间隔，F,=1/T为采样频率。用X(k)表示 x(n)的N点DFT,下面推导出
X(k)与X(j2)的关系，最后由此关系归纳出用X(k)表示X。(j2)的方法，即用DFT对连
续信号进行谱分析的方法。
由(2.4.3)式知道，x(n)的傅里叶变换X(e")与x(t)的傅里叶变换X,(j2)满足如下
关系：
x(e)=÷∑x.[i(-m)]
将w=2T代人上式，得到：
x(e)=÷∑x.[;(a-)]“×Gia) (3.4.6)
117
Created by ZhuangHeng
第3章离散傅里叶变换(DF1)
式中
X.Gja)=∑x.[i(a-m)]
表示模拟信号频谱X,(j2)的周期延拓函数。由x(n)的N点DFT的定义有
X(k)=DFT[z(n)]x=X(e)一 0≤k≤N-1
将(3.4.7)式代入(3.4.6)式，得到：
(3.4.7)
口口
口
数字信号处理(第五版)
X(k)=x(e)=—.(jk)=—.(ik) 0≤k≤N-1(3.4.8)
(3.4.8)式说明了X(k)与X,(j2)的关系。为了符合一般的频谱描述习惯，以频率f为自变
量，整理(3.4.8)式。令
:c)=x.-.(2 (3.4.9)
则(3.4.8)式变为
xA)-×,“(E) k=0,1,2,…,N-1
由此可得
X'(kF)=TX(k)=T·DFT[x(n)]~k=0,1,2,…,N-1(3.4.10)
式中，F表示对模拟信号频谱的采样间隔，所以称之为频率分辨率，T,=NT为截断时间长度。
F==立= (3.4.11)
x?() x;(f)
(a) T。 -f。 0 f。
x.(n) -F 1xo
(b) T -F/2 0 F,/2 F. NT x(n) X;(kF)
(c)
-NT nT 0 (N-DF F
图3.4.6 用DFT分析连续信号谱的原理示意图
(3.4.10)式说明，可以通过对连续信号采样并进行DFT再乘以T,得到模拟信号频谱的
周期延拓函数在第一个周期[0,F,]上的N点等间隔采样X'(kF),如图3.4.6所示。对满足
假设的持续时间有限的带限信号，在满足时域采样定理时，X'(kF)包含了模拟信号频谱的全
部信息(k=0,1,2,…,N/2,表示正频率频谱采样；k=N/2+1,N/2+2,…,N-1,表示
负频率频谱采样)。所以，上述分析方法不丢失信息，即可由X(k)恢复X,(j2)或x(t)。
118
Created by ZhuangHeng
但直接由分析结果X(k)看不到X,(j2)的全部频谱特性，而只能看到N个离散采样点
的谱线，这就是所谓的栅栏效应。对实信号，其频谱函数具有共轭对称性，所以分析正频率
频谱就足够了。不存在频谱混叠失真时，正频率[0,F,/2]频谱采样为
X'(kF)=TX(k)=T·DFT[x(n)]Nk=0,1,2,…,N/2 (3.4.12)
值得注意，如果x,(t)持续时间无限长，上述分析中要进行截断处理，所以会产生所谓的
截断效应，从而使谱分析产生误差。本节最后将讨论上述误差问题产生的原因及改进措施。
下面举例说明截断效应。理想低通滤波器的单位冲激响应h,(t)及其频响函数H()
分别如图3.4.7(a)、(b)所示(图3.4.7(a)中只画出h。(t)所截取的一段)。图中，
h,(t)=sifr(--a)] a=2
现在用DFT来分析h,(t)的频率响应特性。由于h,(t)的持续时间为无穷长，因此要截取一
段T,,假设T,=8s,采样间隔T=0.25s(即采样频率F,=4 Hz),采样点数N=T./T=
32;频域采样间隔F=1/T,=0.125 Hz;由于h,(1)为实信号，因此仅取正频率[0,F./2]频
谱采样：
H(kF)=T·DFT[h(n)] 0≤k≤16
其中，h(n)=h.(nT)R?(n)。
h,()-R?(-T,/2)
8
0 4
T, 1/s
(a)
H?G
1
-1/2 0 1/2 f/Hz
(b) HA)
1 第3章离散傅里叶变换(DFT)
0 1 2 2 4 5 10 15 k
(c)
图3.4.7 用DFT计算理想低通滤波器的频响曲线
|H(kF)|如图3.4.7(c)中黑点所示。由图可见，低频部分近似理想低通频响特性，而
高频误差较大，且整个频响都有波动。这些误差就是由于对h.(t)截断所产生的，所以通常
称之为截断效应。为减少这种截断误差，可适当加长T,,增加采样点数N或用窗函数处理
119
Created by ZhuangHeng
口
口
口
口口
口
口
数字信号处理(第五版)
后再进行DFT。有关窗函数的内容将在FIR数字滤波器设计中详细叙述。
在对连续信号进行谱分析时，主要关心两个问题，这就是谱分析范围和频率分辨率。
谱分析范围为[0,F,/2],直接受采样频率F,的限制。为了不产生频谱混叠失真，通常要求
信号的最高频率f,<F,/2。频率分辨率用频率采样间隔F描述，F表示谱分析中能够分辨
的两个频率分量的最小间隔。显然，F越小，谱分析就越接近X,(jf),所以F较小时，我们
称频率分辨率较高。下面讨论用DFT对连续信号谱分析的参数选择原则。
在已知信号的最高频率f(即谱分析范围)时，为了避免频率混叠现象，要求采样速率
F.满足下式：
F.>2f. (3.4.13)
按照(3.4.11)式，谱分辨率F=F,/N,如果保持采样点数N不变，要提高频谱分辨率(减
小F),就必须降低采样频率，采样频率的降低会引起谱分析范围变窄和频谱混叠失真。如
维持F,不变，为提高频率分辨率可以增加采样点数N,因为NT=T,,T=F,1,只有增加
对信号的观察时间T,才能增加N。T。和N可以按照下面两式进行选择：
N>2 (3.4.14)
To≥卡 (3.4.15)
【例3.4.2】 对实信号进行谱分析，要求谱分辨率F≤10 Hz,信号最高频率f=
2.5kHz,试确定最小记录时间Tpm,最大的采样间隔Tm,最少的采样点数Nm。如果
f.不变，要求谱分辨率提高1倍，最少的采样点数和最小的记录时间是多少?
解 To≥卡=10=0.1s
因此Tmn=0.1 s。因为要求F,≥2f.,所以
T=1-方=2×2500=0.2×103s
N=2F=2×2500=500
为使用DFT的快速算法FFT,希望N符合2的整数幂，为此选用N=512点。为使频率
分辨率提高1倍，即F=5Hz,要求：
N=2×2500=1000,T,=号=0.2s
用快速算法FFT计算时，选用N=1024点。
上面分析了为提高谱分辨率，又保持谱分析范围不变，必须增长记录时间T,增大采
样点数N。应当注意，这种提高谱分辨率的条件是必须满足时域采样定理，即绝对不能保
持N不变，通过增大T来增加记录时间T。
2.用DFT对序列进行谱分析
我们知道单位圆上的Z变换就是序列的傅里叶变换，即
X(e")=X(z)|
120
Created by ZhuangHeng
X(e")是w的连续周期函数。如果对序列x(n)进行N点DFT得到X(k),则X(k)是在区
间[0,2π]上对X(e")的N点等间隔采样，频谱分辨率就是采样间隔2π/N。因此序列的傅
里叶变换可利用DFT(即FFT)来计算。
对周期为N的周期序列x(n),由(2.3.10)式知道，其频谱函数为
x(e)=FTGi(n)=2×(k)6(m--)
其中
X(A)=DFSC[m]=i(me
由于X(k)以N为周期，因而X(e")也是以2π为周期的离散谱，每个周期有N条谱线，第
k条谱线位于w=(2π/N)k处，代表(n)的k次谐波分量。而且，谱线的相对大小与X(k)
成正比。由此可见，周期序列的频谱结构可用其离散傅里叶级数系数X(k)表示。由DFT
的隐含周期性知道，截取x(n)的主值序列x(n)=x(n)R(n),并进行N点DFT,得到：
XCk)=DFT[x(n)]~=DFT[x(n)R(n)]=X(k)R~(k) (3.4.16)
所以可用X(k)表示 x(n)的频谱结构。
如果截取长度M等于x(n)的整数个周期，即M=mN,m为正整数，即
(n)=&(n)R(n) (3.4.17)
Xa(A)=DFTzm(w)]=()e-(ne k=0,1,…,mN-1
令n=n'+iN;i=0,1,…,m-1;n'=0,1,…,N-1,则
X,(k)=2Z2+i)e-2x(m)e]
-x()。-x(m)云
因为
-{/m-整数
所以
(3.4.18) 第3章离散傅里叶变换(DF1) ()
由此可见，X(k)也能表示x(n)的频谱结构，只是在k=im时，XM(im)=mX(i),表示x(n)
的i次谐波谱线，其幅度扩大m倍。而其他k值时，XM(k)=0,当然，X(i)与XM(im)对应
(:=2N·mi)。。所以，只要截取(n)的整数个周期进行DFT,就可得 点频率是相等的
到它的频谱结构，达到谱分析的目的。
如果x(n)的周期预先不知道，可先通过计算(n)的自相关函数1239]估算x(n)的周
期，然后按上述方法对周期信号进行谱分析。
121
Created by ZhuangHeng
■ g
a口
口
口
□口0
口口口口
口口口
□口口口口口
口
数字信号处理(第五版)
122
在很多实际应用中，并非整个单位圆上的频谱都很有意义。例如，对于窄带信号，往往
只希望对信号所在的一段频带进行谱分析，这时便希望采样能密集地在这段频带内进行，
而带外部分可完全不予考虑。另外，有时希望采样点不局限于单位圆上。例如，语音信号处
理中，常常需要知道系统极点所对应的频率，如果极点位置离单位圆较远，则其单位圆上
的频谱就很平滑，如图3.4.8(a)所示，这时很难从中识别出极点对应的频率。如果使采样
点轨迹沿一条接近这些极点的弧线或圆周进行，则采样结果将会在极点对应的频率上出现
明显的尖峰，如图3.4.8(b)所示。这样就能准确地测定出极点频率。对均匀分布在以原点
为圆心的任何圆上的N点(z,=re,k=0,1,…,N-1)频率采样，可用 DFT(FFT)计
算，而沿螺旋弧线采样，则要用线性调频Z变换(Chirp-Z变换，简称CZT)计算。
Im[z] Im[z]
x× × × B ×
×× Re=]
× ×× Re[z]
×
X(e) X(z)
0 π@ 0 A B @
(a) (b)
图3.4.8 单位圆与非单位圆谱分析示意图
例如，要求计算序列在半径为r的圆上的频谱，那么N个等间隔采样点为z=re,
k=0,1,…,N-1,z的频谱分量为
x(a)=X(2)-2x(nre
令x(n)=x(n)r",则
x(z)=∑i(n)e=DFT[i(m)]0≤k≤N-1 (3.4.19)
上式说明，要计算x(n)在半径为r的圆上的N点等间隔频谱分量，可以先对x(n)乘以
r",再计算N点DFT(FFT)即可得到。若要求 x(n)分布在该圆的有限角度2π/M内的N
点等间隔频谱采样，可以取L=MN,在尾部补L-N个零，仍按(3.4.19)式用DFT分析
整个圆上的L点等间隔频谱，最后只取所需角度内的N点等间隔采样即可。显然，这种方
法的计算量大，效率低。下面要介绍的Chirp-Z变换可使这种谱分析的运算量大大减少。
3. Chirp-Z变换
设序列x(n)长度为N,要求分析z平面上M点频谱采样值，设分析点z为
z=AW0≤k≤M-1 (3.4.20)
Created by ZhuangHeng
式中A和W为复数，用极坐标形式表示为 jlm[a]
(3.4.21) 。(M 1)名
8
式中，A。和W。为正实数。当k=0时，有 A
2。=A?e"=A (3.4.22) 1 Re[a]
由此可见，(3.4.20)式中，A决定谱分析起始点
z。的位置，W。的值决定分析路径的盘旋趋势，
φ则表示两个相邻分析点之间的夹角。如果
w,<1,则随着k增大，分析点z以φ。为步长
向外盘旋；而W?>1时，向内盘旋，如图3.4.9
所示。
图3.4.9 Chirp-Z变换分析频点分布
将z,代入Z变换公式得到：
x(x)=Z(n[AwJ--2=(wA-w~ 0≤k≤M-1
利用下面的关系式：
nk= [n2+k2-(k-n)2]
得到：
x(a)=Zowa-ww0=w2(wA~w2wwa
令
y(n)=x(n)A"w22 (3.4.23)
h(n)=w22 (3.4.24)
则
X(z)=w2∑y(n)h(k-n) 0≤k≤M-1 (3.4.25)
(3.4.25)式说明，长度为N的序列x(n)的M点Chirp-Z变换可通过预乘得到y(n),再计算
y(n)与h(n)的卷积v(k),最后乘以W22这三个步骤得到。计算方框图如图3.4.10所示。图
中，h(n)=W-",看成一个数字网络的单位脉冲响应，输出v(n)=y(n)*h(n)|-=V(k)。
第3章离散傅里叶变换(DFT)
x(n) y(n) v(n)=V(k) X(z)
图3.4.10 Chirp-Z变换的计算框图
当W。=1时，h(n)=e”是一个频率随时间线性增长的复指数序列。在雷达系统
123
Created by ZhuangHeng
口
口
口
口口
数字信号处理(第五版)
124
中，这样的信号称作线性调频信号，并用专用词汇 Chirp表示，因此对上述变换起名为线性
调频Z变换，简称Chirp-Z变换(CZT)。
下面介绍用DFT(FFT)计算Chirp-Z变换的原理和实现步骤。首先要确定线性卷积
的区间。由于序列x(n)的长度为N(即0≤n≤N-1),因此y(n)的长度也是N,如图
3.4.11(a)所示。然而h(n)=W-22是无限长序列，v(n)=y(n)*h(n)必然是无限长序列。
而谱分析点数为M,即我们只对0≤k≤M-1区间上的卷积结果感兴趣，因此只要计算出
V(k)=v(n)在区间[0～M-1]上的M个值就可以了。根据上述要求，只要截取区间
[-(N-1)~M-1]上的h(n)就可以了。如图3.4.11(b)所示，这时经线性卷积所得v(n)
长度为2N+M-2。由(3.4.3)式知，y(n)①h(n)是v(n)的周期延拓序列的主值序列，延
拓周期为L,即
y(n)@h(n)=∑on+qL)·R?(n)
而v(n)的非零区间为[-(N-1),N+M-2]。为了用循环卷积代替线性卷积计算出v(n)
在[0~M-1]区间上的M个序列值，以L为周期进行周期延拓时，只要保证[0,M-1]区
间上不混叠即可，所以循环卷积区间长度L应大于或等于N+M-1。一般用快速卷积法
(n)
(a)
0 N-1 n
h(n)
(b)
-(N-1) 0 M-1 n
h?(n)
(c)
0 M-1 L-1 n
y(n)①h?(n)
(d)
0
M-1 n
y(n)*h(n)=v(n)
图3.4.11 Chirp-Z变换中h?(n)的形成
Created by ZhuangHeng
(FFT算法)计算，故应选择L≥(N+M-1),同时又满足L=2"(m为自然数)的最小值。
若选择L=N+M-1,那么y(n)尾部应补M-1个零，并将h(n)从-(N-1)到M-1所截
取的一段序列以L为周期进行周期延拓，取主值序列形成h,(n),如图3.4.11(c)所示。这
时可以用快速卷积法计算如上构造的两个序列y(n)和h?(n)的循环卷积。应当注意，当选
择L=2">N+M-1时，y(n)应补L-N个零点，而h(n)应从M-L到M-1区间上截取
[或按上述区间-N+1~M-1截取后在-N+1点前面补L-(N+M-1)个零点]后，以
L为周期进行周期延拓。
综上所述，可归纳出具体计算步骤如下：
(1)形成h?(n)序列：
M<n<L m)=w
(2)计算 H?(k)=DFT[h?(n)] 0≤k≤L-1
(n-{AwO≤n≤N-1 (3)计算 N≤n≤L-1
(4)计算 Y(k)=DFT[y(n)]0≤k≤L-1
(5)计算 Y(k)H(k);
(6)计算 V(k)=IDFT[Y(m)H(m)]0≤k≤L-1
(7)计算 X(z?)=w23V(k)0≤k≤M-1
与标准DFT(FFT)算法相比较，Chirp-Z变换有以下特点：
(1)输入序列长度N和输出序列长度不需要相等，且二者均可为素数。
(2)分析频率点z的起始点z。及相邻两点的夹角。是任意的(即频率分辨率是任意
的),因此可从任意频率上开始，对输入数据进行窄带高分辨率的谱分析。
(3)谱分析路径可以是螺旋形的。
(4)当A=1,M=N,W=e时，z均匀分布在单位圆上，此时 Chirp-Z变换就是序
列的DFT。因此可以说，DFT是Chirp-Z变换的特例。
总之，Chirp-Z变换用作谱分析时，具有灵活、适应性强和运算效率高等优点。
4.用DFT进行谱分析的误差问题
第3章离散傅里叶变换(DFT
DFT(实际中用FFT计算)可用来对连续信号和数字信号进行谱分析。在实际分析过
程中，要对连续信号采样和截断，有些非时限数据序列也要截断，由此可能引起分析误差。
下面分别对可能产生误差的三种现象进行讨论。
(1)混叠现象。对连续信号进行谱分析时，首先要对其采样，变成时域离散信号后才能
用DFT(FFT)进行谱分析。采样速率F,必须满足采样定理，否则会在w=π(对应模拟频率
f=F./2)附近发生频谱混叠现象。这时用DFT分析的结果必然在f=F./2附近产生较大
误差。因此，理论上必须满足F,≥2f.(f。为连续信号的最高频率)。对F,确定的情况，一
125
Created by ZhuangHeng
数字信号处理(第五版)
般在采样前进行预滤波，滤除高于折叠频率F,/2的频率成分，以免发生频谱混叠现象。
(2)栅栏效应。我们知道，N点DFT是在频率区间[0,2π]上对时域离散信号的频谱
进行N点等间隔采样，而采样点之间的频谱是看不到的。这就好像从N个栅栏缝隙中观看
信号的频谱情况，仅得到N个缝隙中看到的频谱函数值。因此称这种现象为栅栏效应。由
于栅栏效应，有可能漏掉(挡住)大的频谱分量。为了把原来被“栅栏”挡住的频谱分量检测
出来，就必须提高频率分辨率。对有限长序列，可以在原序列尾部补零；对无限长序列，可
以增大截取长度及DFT变换区间长度，从而使频域采样间隔变小，增加频域采样点数和采
样点位置，使原来漏掉的某些频谱分量被检测出来。对连续信号的谱分析，只要采样速率
F,足够高，且采样点数满足频率分辨率要求(见(3.4.14)式和(3.4.15)式),就可以认为
DFT后所得离散谱的包络近似代表原信号的频谱。
(3)截断效应。实际中遇到的序列x(n)可能是无限长的，用DFT对其进行谱分析时，
必须将其截短，形成有限长序列y(n)=x(n)w(n),w(n)称为窗函数，长度为N。w(n)=
R(n),称为矩形窗函数。根据傅里叶变换的频域卷积定理，有
Y(e)=FT[y(n)]=2x(e)*W(e)=x(e)W(e")de
其中
X(e")=FT[x(n)],W(e")=FT[w(n)]
对矩形窗数w(n)=RN(n),有
W(e)=FT[u(n)]=ei(N/2)=w,(u)er
w.(w)=sin(/2
幅度谱W(w)～w曲线如图3.4.12所示(W,(w)以2π为周期，只画低频部分)。图中，
lwl<2π/N的部分称为主瓣，其余部分称为旁瓣。
W,(a)
0 @
图3.4.12 矩形窗的幅度谱
r(n)=cos(4n), 例如， ,其频谱为
x(e)=m2[8(m--2π1)+8(a+4-2m)]
x(n)的频谱X(e)如图3.4.13(a)所示。将x(n)截断后，y(n)=x(n)R(n)的幅频曲线如
图3.4.13(b)所示。
126
Created by ZhuangHeng
由上述可见，截断后序列的频谱Y(e")与原序列频谱X(e")必然有差别，这种差别对
谱分析的影响主要表现在如下两个方面：
(1)泄露。由图3.4.13(b)可知，原来序列x(n)的频谱是离散谱线，经截断后，使原来
的离散谱线向附近展宽，通常称这种展宽为泄露。显然，泄露使频谱变模糊，使谱分辨率降
低。从图3.4.13可以看出，频谱泄露程度与窗函数幅度谱的主瓣宽度直接相关，在第7章
将证明，在所有的窗函数中，矩形窗的主瓣是最窄的，但其旁瓣的幅度也最大。所以，在窗
函数长度N相同时，用矩形窗截取，产生的泄露最小。
X(e")
-W/4 0 W/4 @
(a)
IY(el")
-W4 0 W/4 @
(b)
图3.4.13 x(n)=cos(an)加矩形窗前、后的幅频特性
(2)谱间干扰。在主谱线两边形成很多旁瓣，引起不同频率分量间的干扰(简称谱间干
扰),特别是强信号谱的旁瓣可能湮没弱信号的主谱线，或者把强信号谱的旁瓣误认为是另
一频率的信号的谱线，从而造成假信号，这样就会使谱分析产生较大偏差。由于矩形窗的
旁瓣最大，所以，用矩形窗截取时，产生的谱间干扰最大。
由于上述两种影响是由对信号截断引起的，因此称之为截断效应。由图3.4.12可以看
出，增加N可使W(w)的主瓣变窄，减小泄露，提高频率分辨率，但旁瓣的相对幅度并不
减小。为了减小谱间干扰，应用其他形状的窗函数w(n)代替矩形窗(窗函数将在FIR 数字
滤波器设计中介绍)。但在N一定时，旁瓣幅度越小的窗函数，其主瓣就越宽。所以，在
DFT变换区间(即截取长度)N一定时，只能以降低谱分析分辨率为代价，换取谱间干扰
的减小。通过进一步学习数字信号处理的功率谱估计等现代谱估计内容可知，减小截断效
应的最好方法是用近代谱估计的方法。但谱估计只适用于不需要相位信息的谱分析
场合。
第3章
离散傅里叶变换(DF1
最后要说明的是，栅栏效应与频率分辨率是不同的两个概念。如果截取长度为N的一
段数据序列，则可以在其后面补N个零，再进行2N点DFT,使栅栏宽度减半，从而减轻
了栅栏效应。但是这种截短后补零的方法不能提高频率分辨率。因为截短已经使频谱变模
糊，补零后仅使采样间隔变小，但得到的频谱采样的包络仍是已经变模糊的频谱，所以频
率分辨率没有提高。因此，要提高频率分辨率，就必须对原始信号截取的长度加长(对模拟
信号，就是增加采样时间T。的长度)。
127
Created by ZhuangHeng
口
口
甲
数字信号处理(第五版)
习题与上机题
1.计算以下序列的N点DFT,在变换区间0≤n≤N-1内，序列定义为
(1) x(n)=1
(2) x(n)=8(n)
(3) x(n)=8(n-n?)0<n?<N
(4) x(n)=R(n) 0<m<N
(5) x(n)=e 0<m<N
r(n)=cos(mn) (6) 0<m<N
(7) x(n)=e"R(n)
(8)x(n)=sin(won)·R(n)
(9)x(n)=cos(w?n)·RN(N)
(10) x(n)=nRN(n)
2.已知下列X(k),求x(n)=IDFT[X(k)]:
(1)
(2)
其中，m为正整数，0<m<N/2。
3.已知长度为N=10的两个有限长序列：
作图表示 x?(n)、x?(n)和y(n)=x?(n)关x?(n),循环卷积区间长度L=10。
4.证明DFT的对称定理，即假设X(k)=DFT[x(n)],证明
DFT[X(n)]=Nx(N-k)
5.如果X(k)=DFT[x(n)],证明DFT的初值定理
x(0)=六2x(A)
128
Created by ZhuangHeng
6.设x(n)的长度为N,且
X(k)=DFT[x(n)] 0≤k≤N-1
令 h(n)=x((n))Rv(n) m为自然数
H(k)=DFT[h(n)]mN0≤k≤mN-1
求H(k)与X(k)的关系式。
7.证明：若x(n)为实序列，X(k)=DFT[x(n)]n,则X(k)为共轭对称序列，即
X(k)=X*(N-k);若x(n)实偶对称，即x(n)=x(N-n),则X(k)也实偶对称；若x(n)
实奇对称，即x(n)=-x(N-n),则X(k)为纯虚函数并奇对称。
8.证明频域循环移位性质：设X(k)=DFT[x(n)],Y(k)=DFT[y(n)],如果Y(k)=
X((k+1))Rn(k),则
y(n)=IDFT[Y(k)]=Wx(n)
9.已知x(n)长度为N,X(k)=DFT[x(n)],
)-{N≤n≤m--1,m为自然数
Y(k)=DFT[y(n)] 0≤k≤mN-1
求Y(k)与X(k)的关系式。
10.证明离散相关定理。若
X(k)=Xi(k)X?(k)
则
z(n)=DFTX(k)]=Zxi(Dz?(U+n)Ra(n)
11.证明离散帕塞瓦尔定理。若X(k)=DFT[x(n)],则
lz(n)P2=六21×(k)P
12.已知f(n)=x(n)+jy(n),x(n)与y(n)均为长度为N的实序列。设
F(k)=DFT[f(n)]N0≤k≤N-1
(1) F(k)=1-aw+i-6w a,b为实数
(2) F(k)=1+jN
第3章离散傅里叶变换(DFT
试求X(k)=DFT[x(n)]n,Y(k)=DFT[y(n)]、以及x(n)和y(n)。
13.已知序列x(n)=a"u(n),0<a<1,对x(n)的Z变换X(z)在单位圆上等间隔采样
N点，采样序列为
X(k)=x(z)| k=0,1,…,N-1
求有限长序列IDFT[X(k)]N。
14.两个有限长序列x(n)和y(n)的零值区间为
x(n)=0 n<0,8≤n
129
Created by ZhuangHeng
口口
口口
口口
口
中国事
数字信号处理(第五版)
y(n)=0 n<0,20≤n
对每个序列作20点DFT,即
X(k)=DFT[r(n)]k=0,1,…,19
Y(k)=DFT[y(n)]k=0,1,…,19
如果
F(k)=X(k)·Y(k)k=0,1,…,19
f(n)=IDFT[F(k)]k=0,1,…,19
试问在哪些点上f(n)与x(n)*y(n)值相等，为什么?
15.已知实序列x(n)的8点DFT的前5个值为0.25,0.125-j0.3018,0,0.125-
j0.0518,0。
(1)求X(k)的其余3点的值；
(2)zx?(n)=∑x(n+5+8m)R,(n),求X?(k)=DFT[z;(n)];
(3)x?(n)=x(n)e,求x?(k)=DFT[x?(n)]。
16.x(n)、x?(n)和x?(n)分别如题16图(a)、(b)和(c)所示，已知 X(k)=
DFT[x(n)]。。求
X?(k)=DFT[x?(n)]。和 X?(k)=DFT[x?(n)]。
[注：用X(k)表示X?(k)和X?(k)。]
x(n)
(a) 01 1 23 7 n
x?(n)
(b) 0 i 2 3 7 n
x?(n)
(c) 0 i 2 3 7 n
题16图
17.设x(n)是长度为N的因果序列，且
X(e)=FT[z[n],y(n)=[∑x(n+mM)]Ra(n),Y(k)=DFTLy(n)]u
试确定Y(k)与X(e")的关系式。
18.用微处理机对实数序列作谱分析，要求谱分辨率F≤50 Hz,信号最高频率为
1 kHz,试确定以下各参数：
(1)最小记录时间T,;
130
Created by ZhuangHeng
(2)最大取样间隔Tmax;
(3)最少采样点数Nmm;
(4)在频带宽度不变的情况下，使频率分辨率提高1倍(即F缩小一半)的N值。
19.已知调幅信号的载波频率f.=1kHz,调制信号频率f=100 Hz,用FFT对其进
行谱分析，试求：
(1)最小记录时间Tpmm;
(2)最低采样频率f,m;
(3)最少采样点数Nmi
20.在下列说法中选择正确的结论。线性调频Z变换可以用来计算一个有限长序列
h(n)在z平面实轴上诸点{z}的Z变换H(z),使
(1)z=a?,k=0,1,…,N-1,a为实数，a≠1;
(2)z=ak,k=0,1,…,N-1,a为实数，a≠1;
(3)(1)和(2)都不行，即线性调频Z变换不能计算H(z)在z平面实轴上的取样值。
21.我们希望利用h(n)长度为N=50的FIR滤波器对一段很长的数据序列进行滤波
处理，要求采用重叠保留法通过DFT(即FFT)来实现。所谓重叠保留法，就是对输入序列
进行分段(本题设每段长度为M=100个采样点),但相邻两段必须重叠V个点，然后计算
各段与h(n)的L点(本题取L=128)循环卷积，得到输出序列y(n),m表示第m段循环
卷积计算输出。最后，从y(n)中选取B个样值，使每段选取的B个样值连接得到滤波输
出y(n)。
(1)求V;
(2)求B;
(3)确定取出的B个采样应为y(n)中的哪些样点。
22.证明DFT的频域循环卷积定理。
23.已知序列x(n)={1,2,3,3,2,1}。
(1)求出x(n)的傅里叶变换X(e"),画出幅频特性和相频特性曲线(提示：用1024点
FFT近似X(e));
(2)计算x(n)的N(N≥6)点离散傅里叶变换X(k),画出幅频特性和相频特性曲线；
(3)将X(e")和X(k)的幅频特性和相频特性曲线分别画在同一幅图中，验证X(k)是
X(e")的等间隔采样，采样间隔为2π/N;
(4)计算X(k)的N点IDFT,验证DFT和IDFT的唯一性。
24°.给定两个序列：x?(n)={2,1,1,2},x?(n)=(1,-1,-1,1}。
(1)直接在时域计算x?(n)与x?(n)的卷积：
(2)用DFT计算 x?(n)与x(n)的卷积，总结出DFT的时域卷积定理。
25*.已知序列h(n)=R,(n),r(n)=nR.(n)。
第3章离散傅里叶变换(DFT)
131
Created by ZhuangHeng
(1)计算y.(n)=h(n)⑧r(n);
(2)计算y.(n)=h(n)x(n)和y(n)=h(n)*x(n)。
(3)画出h(n)、x(n)、y.(n)和y(n)的波形图，观察总结循环卷积与线性卷积的关系。
26°.验证频域采样定理。设时域离散信号为
)-{IL
其中a=0.9,L=10。
(1)计算并绘制信号x(n)的波形。
(2)证明：x(e)=FT[(nJ=x(0)+22a(n)csom)。
(3)按照N=30对X(e")采样得到C=X(e~)|,k=0,1,2,…, N-1。
(m)=÷2ce,试根据频域采样定理解释序列x(n) (4)计算并图示周期序列
与x(n)的关系。
y(n)=∑x(n+mN),比较x(n)与y(n),验证(4)中的 (5)计算并图示周期序列
解释。
(6)对N=15,重复(3)～(5)。
27°.选择合适的变换区间长度N,用DFT对下列信号进行谱分析，画出幅频特性和
相频特性曲线。
(1) x?(n)=2cos(0.2πn)
(2) x?(n)=sin(0.45πn)sin(0.55πn)
(3) x?(n)=2-R?(n+10) 数字信号处理(第五版)
132
Created by ZhuangHeng
4章 第
快速傅里叶变换(FFT)
4.1 引 言
DFT是数字信号分析与处理中的一种重要变换。但直接计算 DFT的计算量与变换区
间长度N的平方成正比，当N较大时，计算量太大，所以在快速傅里叶变换FFT(Fast
Fourier Transform)出现以前，直接用DFT算法进行谱分析和信号的实时处理是不切实际
的。直到1965年提出 DFT的一种快速算法以后，情况才发生了根本的变化。
自从1965年库利(T.W.Cooley)和图基(J.W.Tuky)在《计算数学》(Math. Compu tation,Vol.19,1965)杂志上发表了著名的《机器计算傅里叶级数的一种算法》论文后，桑
德(G.Sand)—图基等快速算法相继出现，又经人们进行改进，很快形成一套高效计算方
法，这就是现在的快速傅里叶变换(FFT)。这种算法使DFT的运算效率提高了1～2个数
量级，为数字信号处理技术应用于各种信号的实时处理创造了条件，大大推动了数字信号
处理技术的发展。
人类的求知欲和科学的发展是永无止境的。多年来，人们继续寻求更快、更灵活的好
算法。1984年，法国的杜哈梅尔(P. Dohamel)和霍尔曼(H. Hollmann)提出的分裂基快速
算法，使运算效率进一步提高。本章主要讨论基2 FFT算法及其编程思想。
4.2 基2FFT算法
4.2.1 直接计算DFT的特点及减少运算量的基本途径
有限长序列x(n)的N点DFT为
第4章(快速博里叶变换(πFT)
133
Created by ZhuangHeng
数字信号处理(第五版)
x(k)=z(nwk=0,1,…,N-1 (4.2.1)
考虑x(n)为复数序列的一般情况，对某一个k值，直接按(4.2.1)式计算X(k)的1个
值需要N次复数乘法和(N-1)次复数加法。因此，计算X(k)的所有N个值，共需N2次
复数乘法和N(N-1)次复数加法运算。当N>1时，N(N-1)≈N2。由上述可见，N点
DFT的乘法和加法运算次数均为N2。当N较大时，运算量相当可观。例如N=1024时，
N2=1048576。这对于实时信号处理来说，必将对处理设备的计算速度提出难以实现的要
求。所以，必须减少其运算量，才能使DFT在各种科学和工程计算中得到应用。
如前所述，N点 DFT的复乘次数等于N2。显然，把N点DFT分解为几个较短的
DFT,可使乘法次数大大减少。另外，旋转因子W"具有明显的周期性和对称性。其周期性
表现为
w=e=e-=w (4.2.2)
其对称性表现为
Wn"=WN"或者 [WN"]=W
w=-W
(4.2.3a)
(4.2.3b)
FFT算法就是不断地把长序列的DFT分解成几个短序列的DFT,并利用W的周期性和
对称性来减少 DFT的运算次数。算法最简单最常用的是基2FFT。
4.2.2 时域抽取法基2FFT基本原理
基2FFT算法分为两类：时域抽取法FFT(Decimation-In-Time FFT,简称DIT-FFT);
频域抽取法FFT(Decimation-In-Frequency FFT,简称DIF-FFT)。本节介绍DIT-FFT
算法。
设序列x(n)的长度为N,且满足N=2“,M为自然数。按n的奇偶把x(n)分解为两
个N/2点的子序列
2-1 x?(r)=x(2r) r=0,1,…,
2-1 z?(r)=x(2r+1) r=0,1,…,
则x(n)的DFT为
x(k)=∑z(m)w+∑x(nW
-a(2)w+2x(2r+Dwo
-22?()w+w2x()w
因为
w=。=e=w
134
Created by ZhuangHeng
所以
x(k)=z()wa+w:2(Wa
=X?(k)+WNX?(k)k=0,1,2,…,N-1 (4.2.4)
其中X?(k)和X?(k)分别为x?(r)和x?(r)的N/2点DFT,即
x,(A)=2z(r)Wa=DFT[Zx(r)]sa (4.2.5)
x?k)-2z()W?DFT[z(>)]s (4.2.6)
由于X?(k)和X?(k)均以N/2为周期，且W=-W,因此X(k)又可表示为
2-1 X(k)=X?(k)+WX?(k)k=0,1,…,
x(k+)=X?(k)-WX?(k) k=0,1,…,2-1
(4.2.7)
(4.2.8)
这样，就将N点DFT分解为两个N/2点 DFT和(4.2.7)式以及(4.2.8)式的运算。
(4.2.7)和(4.2.8)式的运算可用图4.2.1所示的流图符号表示，称为蝶形运算符号。采用
这种图示法，经过一次奇偶抽取分解后，N点DFT运算图可以用图4.2.2表示。图中，
N=23=8,X(0)~X(3)由(4.2.7)式给出，而X(4)～X(7)则由(4.2.8)式给出。
A A+CB
B
C
A-CB
图4.2.1 蝶形运算符号
x(0)
N/2点
DFT
X?(0) X(O)
X?(1) x(2) X(1)
x(4) X?(2) X(2)
X?(3) x(6) X(3)
x(1)
N/2点
DFT
X?(0) w X(4)
x(3) X?(1) w! X(5)
x(5) X?(2) w X(6)
第4章快速傅里叶变换(FFT)
x(7) X?(3) w X(7)
图4.2.2 8点DFT一次时域抽取分解运算流图
由图4.2.1可见，要完成一个蝶形运算，需要一次复数乘法和两次复数加法运算。由
图4.2.2容易看出，经过一次分解后，计算1个N点DFT共需要计算两个N/2点DFT和
N/2个蝶形运算。而计算一个N/2点DFT需要(N/2)2次复数乘法和N/2(N/2-1)次复
数加法。所以，按图4.2.2计算N点DFT时，总的复数乘法次数为
135
Created by ZhuangHeng
口
数字信号处理(第五版)
2(贵)+2-nNt1|~竺
复数加法次数为
N(-1)+2N-2
由此可见，仅仅经过一次分解，就使运算量减少近一半。既然这样分解对减少 DFT的运算
量是有效的，且N=2M,N/2仍然是偶数，故可以对N/2点DFT再作进一步分解。
与第一次分解相同，将x?(r)按奇偶分解成两个N/4点的子序列x?(L)和x?(L),即
()=2(2/+1}l=0,1,…4-1
X?(k)又可表示为
x,A)-2A(2w+;(22+1W
-2x(W+wx(Dw%
-1 k=0,1,…, =X?(k)+W/2X?(k) (4.2.9)
式中
x,)=Z()W?FTL?(D)m
X,(A)=2z(Dw=DFT[z:(D]
同理，由X?(k)和X?(k)的周期性和WN/2的对称性(WN/2N4=-W*/)最后得到：
f-5x}k=0,1,…4-1
用同样的方法可计算出
(4.2.10)
X,(k)=X(k)土W x.(+)-xA-?k-0,1…-1 (4.2.11)
其中
x?(k)-2z(Dws=DFT[za(1)
x.A)=2z.(Dws=DFT[z(0)
()=.(2Z+1}l=0,1,…,--1
这样，经过第二次分解，又将N/2点DFT分解为2个N/4点DFT和(4.2.10)式或
(4.2.11)式所示的N/4个蝶形运算，如图4.2.3所示。依次类推，经过M次分解，最后将
136
Created by ZhuangHeng
N点DFT分解成N个1点DFT和M级蝶形运算，而1点DFT就是时域序列本身。一个
完整的8点DIT-FFT运算流图如图4.2.4所示。图中用到关系式 WN/=WN。图中输入
序列不是顺序排列，但后面会看到，其排列是有规律的。图中的数组A用于存放输入序列
和每级运算结果，在后面讨论编程方法和倒序时要用到。
N/4点
DFT
X?(0) X?(0) x(0) X(O)
x(4) X?(1) X?(1) X(1)
N/4点
DFT
X?(0) x(2) w° X?(2) X(2)
X(1) x(6) W
X?(3) X(3)
x(1) N/4点
DFT
X?(0) X?(0) wg X(4)
x(5) X?(1) X?(1) W X(5)
x(3) N4点
DFT
X?(0) w
X?(2) w: ●X(6)
x(7) X?(1) Wn X?(3) w X(7)
图4.2.3 8点DFT二次时域抽取分解运算流图
x(0) A(0) A(0) A(0) A(0) X(0)
x(4) A(1) A(1) A(1) A(1) w X(1)
x(2) A(2) A(2) w
A(2) A(2) X(2)
x(6) A(3) A(3) w° W2 A(3) A(3)X(3)
x(1) A(4) A(4) A(4) w A(4)X(4)
x(5) A(5) A(5) A(5) w w A(5)X(5)
x(3) A(6) A(6) A(6) w w3 A(6) X(6)
x(7) A(7 A(7) w w2 A(7) w A(7)X(7)
图4.2.4 8点DIT-FFT运算流图
4.2.3 DIT-FFT算法与直接计算DFT运算量的比较 第4章快速傅里叶变换(FFT) 由DIT-FFT算法的分解过程及图4.2.4可见，N=2"时，其运算流图应有M级蝶形，
每一级都由N/2个蝶形运算构成。因此，每一级运算都需要N/2次复数乘和N次复数加
(每个蝶形需要两次复数加法)。所以，M级运算总的复数乘次数为
C=·M=21bN
复数加次数为
CA=N·M=NIbN
而直接计算 DFT的复数乘为N2次，复数加为N(N-1)次。当N》1时，N2》
137
Created by ZhuangHeng
①口 :。。。:
口口
口
口口
重
重
口
口
口
口口
口
面单
数字信号处理(第五版)
(N/2)IbN,所以，DIT-FFT算法比直接计算 DFT的运算次数大大减少。例如，N=
21=1024时，
4576-204.8
这样，就使运算效率提高200多倍。图4.2.5为FFT算法和直接计算DFT所需复数乘法
次数CM与变换点数N的关系曲线。由此图更加直观地看出FFT算法的优越性，显然，N
越大时，优越性就越明显。
乘法次数/1000 512
256
128
640
直接计算DFT
DIT-FFT算法
64128 256 512 1024
N(取样点数)
图4.2.5 DIT-FFT算法与直接计算 DFT所需复数乘法次数的比较曲线
4.2.4 DIT-FFT的运算规律及编程思想
为了最终写出DIT-FFT运算程序或设计出硬件实现电路，下面介绍DIT-FFT的运
算规律和编程思想。
1.原位计算
由图4.2.4可以看出，DIT-FFT的运算过程很有规律。N=2M点的FFT共进行M
级运算，每级由N/2个蝶形运算组成。同一级中，每个蝶形的两个输入数据只对计算本蝶
形有用，而且每个蝶形的输入、输出数据结点又同在一条水平线上，这就意味着计算完一
个蝶形后，所得输出数据可立即存入原输入数据所占用的存储单元(数组元素)。这样，经
过M级运算后，原来存放输入序列数据的N个存储单元(数组A)中便依次存放X(k)的N
个值。这种利用同一存储单元存储蝶形计算输入、输出数据的方法称为原位(址)计算。原
位计算可节省大量内存，从而使设备成本降低。
2.旋转因子的变化规律
如上所述，N点DIT-FFT运算流图中，每级都有N/2个蝶形。每个蝶形都要乘以因
子W,称其为旋转因子，p为旋转因子的指数。但各级的旋转因子和循环方式都有所不
同。为了编写计算程序，应先找出旋转因子W与运算级数的关系。用L表示从左到右的
138
1024
Created by ZhuangHeng
运算级数(L=1,2,…,M)。观察图4.2.4不难发现，第L级共有2--1个不同的旋转因子。
N=23=8时的各级旋转因子表示如下：
L=1时，
W=W!=WJ=0
L=2时，
Wk=W=WJ=0,1
L=3时，
we=W=WJ=0,1,2,3
对N=2M的一般情况，第L级的旋转因子为
W=WJ=0,1,2,…,2-1-1
因为
24=2M×2M=N·z1-M
所以
WC=W-=WJ=0,1,2,…,2?1-1 (4.2.12)
p=J·2M- (4.2.13)
这样，就可按(4.2.12)和(4.2.13)式确定第L级运算的旋转因子(实际编程序时，L为最外
层循环变量)。
3.蝶形运算规律
设序列x(n)经时域抽选(倒序)后，按图4.2.4所示的次序(倒序)存入数组A中。如果
蝶形运算的两个输入数据相距B个点，应用原位计算，则蝶形运算可表示成如下形式：
A?(J)∈A-1(J)+A_(J+B)WN
A?(J+B)∈A(J)-A?_i(J+B)W
式中
p=J×2J=0,1,…,21-1;L=1,2,…,M
下标L表示第L级运算，A,(J)则表示第L级运算后的数组元素A(J)的值(即第L级蝶形
的输出数据)。而A?_(J)表示第L级运算前A(J)的值(即第L级蝶形的输入数据)。
4.编程思想及程序框图
仔细观察图4.2.4,还可以归纳出一些对编程有用的运算规律：第L级中，每个蝶形的
两个输入数据相距B=2-1个点；每级有B个不同的旋转因子；同一旋转因子对应着间隔
为2点的2M-个蝶形。
总结上述运算规律，便可采用下述运算方法。先从输入端(第1级)开始，逐级进行，共
进行M级运算。在进行第L级运算时，依次求出B个不同的旋转因子，每求出一个旋转因
子，就计算完它对应的所有2M-个蝶形。这样，我们可用三重循环程序实现DIT-FFT运
算，程序框图如图4.2.6所示。
第4章快速傅里叶变换(FFT)
139
Created by ZhuangHeng
口
口口
口口
口口
口口
口
数字信号处理(第五版)
开始
读入x(n),M
N=2"
倒序
L=1,M
B=24-1
J-0,B-1
P=2*IJ
k=J.N-1,2
T=A(k)+A(k+B)W
A(k+B)=A(k)-Ak+B)W
Aik)=T
输出
结束
图4.2.6 DIT-FFT运算程序框图
另外，DIT-FFT算法运算流图的输出X(k)为自然顺序，但为了适应原位计算，其输
入序列不是按x(n)的自然顺序排列，这种经过M次偶奇抽选后的排序称为序列x(n)的倒
序(倒位)。因此，在运算M级蝶形之前应先对序列x(n)进行倒序。下面介绍倒序算法。
5.序列的倒序
DIT-FFT算法的输入序列的排序看起来似乎很乱，但仔细分析就会发现这种倒序是
很有规律的。由于N=2M,因此顺序数可用M位二进制数(nM-1nM-2…n,n。)表示。M次偶
奇时域抽选过程如图4.2.7所示。第一次按最低位n。的0和1将x(n)分解为偶奇两组，第
二次又按次低位n?的0、1值分别对偶奇组分组；依次类推，第M次按ns-1位分解，最后
所得二进制倒序数如图4.2.7所示。表4.2.1列出了N=8时以二进制数表示的顺序数和
倒序数，由表显而易见，只要将顺序数(n?n?n?)的二进制位倒置，则得对应的二进制倒序值
(n?n?n)。按这一规律，用硬件电路和汇编语言程序产生倒序数很容易。但用有些高级语言
程序实现时，直接倒置二进制数位是不行的，因此必须找出产生倒序数的十进制运算规律。
由表4.2.1可见，自然顺序数I增加1,是在顺序数的二进制数最低位加1,逢2向高位进
位。而倒序数则是在M位二进制数最高位加1,逢2向低位进位。例如，在(000)最高位加
1,则得(100),而(100)最高位为1,所以最高位加1要向次高位进位，其实质是将最高位
140
Created by ZhuangHeng
变为0,再在次高位加1,得到(010)。用这种算法，可以从当前任一倒序值求得下一个倒
序值。
n? 0
1
0
"
no b?b?b
0
0000
1004 0
1
0102
1 1106
0
1
0
(b?b?bo) 0011
0
1
1015
1
1
0113
1117
图4.2.7 形成例序的树状图(N=23)
表4.2.1 顺序和倒序对照表
为了叙述方便，用J表示当前倒序数的十进制数值。对于N=2M,M位二进制数最高
位的十进制权值为N/2,且从左向右二进制位的权值依次为N/4,N/8,…,2,1。因此，
最高为加1相当于十进制运算J+N/2。如果最高位是0(J<N/2),则直接由J+N/2得下
一个倒序值；如果最高位是1(J≥N/2),则先将最高位变成0(J∈J-N/2),然后次高位
加1(J+N/4)。但次高位加1时，同样要判断0、1值，如果为0(J<N/4),则直接加1
(J∈J+N/4),否则将次高位变成0(J=J-N/4),再判断下一位；依此类推，直到完成最
顺 序 倒 序
十进制数I 二进制数 二进制数 十进制数J
0
1
2
3
4
5
6
7
000
001
010
011
100
101
110
111
000
100
010
110
0.01
101
011
111
0
4
2
6
1
5
3
7
第4章快速傅里叶变换(FFT)
高位加1,逢2向右进位的运算。图4.2.9所示的倒序的程序框图中的虚线框内就是完成计
算倒序值的运算流程图。
形成倒序J后，将原数组A中存放的输入序列重新按倒序排列。设原输入序列x(D先
按自然顺序存入数组A中。例如，对N=8,A(0),A(1),…,A(7)中依次存放着x(0),
x(1),x(2),…,x(7)。对x(n)的重新排序(倒序)规律如图4.2.8所示。倒序的程序框图
如图4.2.9所示。由图4.2.8可见，第一个序列值x(0)和最后一个序列值x(N-1)不需要
重排，所以，顺序数I初值为1,终值为N-2,倒序数J的初值为N/2。每计算出一个倒序
值J,便与循环语句自动生成的顺序I比较，当I=J时，不需要交换，当I≠J时，A(1)与
141
Created by ZhuangHeng
口
口
口
口口
口口
口
口口
口口
口□
口口
口
数字信号处理(第五版)
A(J)交换数据。另外，为了避免再次调换前面已调换过的一对数据，框图中只对I<J的情
况调换A(I)和A(J)的内容。
LHe-N2
N?=N-2 J=LH
I-1,N
I≥? Y
N
x(0) x(1) x(2)x(3) x(4) x(5) x(6)x(7)
A(0) A(1) A(2) A(3) A(4) 4(5) 4(6)A(7)
TK-A()
A()=A()
A()=T
K=LH
KK? N J-/-K
K=K/2
[Y
A(O) A(1)A(2) A(3) A(4) A(5) A(6) A(7)
x(0) x(4) x(2) x(6)x(1) x(5) x(3) x(7)
图4.2.8 倒序规律
J+K
图4.2.9 倒序程序框图
第3章介绍的MATLAB函数fft是一个计算 DFT的智能程序，如果计算点数N=
2,则自动按DIT-FFT快速算法计算，否则，直接计算 DFT。所以，调用该函数计算
DFT时，最好选取N=2M,使处理速度大大提高。
4.2.5 频域抽取法FFT(DIF-FFT)
在基2FFT算法中，频域抽取法FFT也是一种常用的快速算法，简称DIF-FFT。
设序列x(n)长度为N=2M,首先将x(n)前后对半分开，得到两个子序列，其DFT可
表示为如下形式：
X(k)=DFTLx(n)]=∑x()W
-Z7()w+2a(nw
=z(m)w+Z=(n+)ws
=2[(n)+w≠(n+)]w
142
Created by ZhuangHeng
式中
w=-°-{1k一奇数
将X(k)分解成偶数组与奇数组，当k取偶数(k=2m,m=0,1,…,N/2-1)时
X(2m)=2[x(n)+x(n+2)]w-
-2[zx(n)+x(n+号)]w (4.2.14)
当k取奇数(k=2m+1,m=0,1,…,N/2-1)时，
x(2m+1-2[z)-=(n+号)]w
=2[z(n)-=(n+号)]ws·w (4.2.15)
令
-
n=0,1,2, 2-1 …,
将x?(n)和x?(n)分别代入(4.2.14)和(4.2.15)式，可得
(4.2.16)
(4.2.16)式表明，X(k)按奇偶k值分为两组，其偶数组是x?(n)的N/2点DFT,奇数组则
是x?(n)的N/2点DFT。x?(n)、x?(n)和x(n)之间的关系也可用图4.2.10所示的蝶形运
算流图符号表示。图4.2.11表示N=8时第一次分解的运算流图。
x()=xO+(n+) x(n)
岭(m-[K-(a+÷]m n+号)
第4章(快速博里叶变换(FFT
图4.2.10 DIF-FFT蝶形运算流图符号
由于N=2M,N/2仍然是偶数，继续将N/2点DFT分成偶数组和奇数组，这样每个
N/2点DFT又可由两个N/4点DFT形成，其输入序列分别是x?(n)和x?(n)按上下对半
分开形成的四个子序列。图4.2.12示出了N=8时第二次分解运算流图。这样继续分解下
去，经过M-1次分解，最后分解为2M-1个两点DFT,两点DFT就是一个基本蝶形运算流
143
Created by ZhuangHeng
口
口
口
口
数字信号处理(第五版)
x(0) x?(0)
N/2点
DFT
X70)
x(1) xi(1) X(2)
x(2) x?(2) X(4)
x(3) x?(3) X6)
x(4) w
x?(0)
N2点
DFT
X(1)
x(5) w x?(1) X3)
x(6) w x?(2) X(5)
x(7) w x?(3) X(7)
图4.2.11 DIF-FFT第一次分解运算流图(N=8)
图。当N=8时，经两次分解，便分解为四个两点DFT。N=8的完整DIF-FFT运算流
图如图4.2.13所示。
144
x(0) N/4点 DFT
X(O)
x(1) X(4)
x(2) w N/4点
DFT
X(2)
x(3) w X(6)
x(4) w N/4点
DFT
X(1)
x(5) w X(5)
x(6) w w N4点 X(3)
x(7) w w: DFT X(7)
图4.2.12 DIF-FFT第二次分解运算流图(N=8)
x(0) X(O)
x(1) w X(4)
x(2) w X(2)
x(3) w w X6)
x(4) w X(1)
x(5) w w X(S)
x(6) w w X(3)
x(7) w w w X(7)
图4.2.13 DIF-FFT运算流图(N=8)
这种算法是对X(k)进行奇偶抽取分解的结果，所以称之为频域抽取法FFT。观察图
Created by ZhuangHeng
4.2.13可知，DIF-FFT算法与DIT-FFT算法类似，可以原位计算，共有M级运算，每
级共有N/2个蝶形运算，所以两种算法的运算次数亦相同。不同的是DIF-FFT算法输人
序列为自然顺序，而输出为倒序排列。因此，M级运算完后，要对输出数据进行倒序才能
得到自然顺序的X(k)。另外，蝶形运算略有不同，DIT-FFT蝶形先乘后加(减),而
DIF-FFT蝶形先加(减)后相乘。
最后要说明的是，上述两种FFT的算法流图形式不是唯一的。只要保证各支路传输比
不变，改变输入与输出点以及中间结点的排列顺序，就可以得到其他变形的FFT运算流
图，各种运算流图各有特点1.
4.2.6 IDFT的高效算法
上述FFT算法流图也可以用于计算 IDFT。比较DFT和IDFT的运算公式：
x(k)=DFT[Lz(n)]=2r(nw
r(n)=IDFTLz(n)]=六x(k)W
只要将DFT运算式中的系数W、改变为W,最后乘以1/N,就是IDFT运算公式。所
以，只要将上述的DIT-FFT与DIF-FFT算法中的旋转因子W改为W,最后的输出
再乘以1/N就可以用来计算IDFT。只是现在流图的输入是X(k),输出就是x(n)。因此，
原来的DIT-FFT改为IFFT后，称为DIF-IFFT更合适；DIF-FFT改为IFFT后，应称
为DIT-IFFT。
如果希望直接调用FFT子程序计算IFFT,则可用下面的方法：
由于
(n)=2x (k)Ws]'=六[DFTLX'(k)])
所以，可以先将X(k)取复共轭，然后直接调用FFT子程序，或者送入 FFT专用硬件设备
进行DFT运算，最后取复共轭并乘以1/N得到序列x(n)。这种方法虽然用了两次取共轭
运算，但可以与FFT共用同一子程序，因而用起来很方便。
4.3 进一步减少运算量的措施 第，快重尊里叶变奂(nT卜
前面讨论的DIT-FFT和DIF-FFT算法，由于其算法简单，编程效率高，得到广泛
应用。下面介绍进一步减少运算量的途径，以程序的复杂度换取计算效率的进一步提高。
4.3.1 多类蝶形单元运算
由DIT-FFT运算流图已得出结论，N=2"点FFT共需要MN/2次复数乘法。由
(4.2.12)式，当L=1时，只有一种旋转因子W=1,所以，第一级不需要乘法运算。当
L=2时，共有两个旋转因子：W=1和WN=-j,因此，第二级也不需要乘法运算。在
145
Created by ZhuangHeng
口口
口
口口
口
口
数字信号处理(第五版)
DFT中，又称其值为±1和士j的旋转因子为无关紧要的旋转因子，如W°,WN2,WN等。
综上所述，先除去第一、二两级后，所需复数乘法次数应是
CM=2(M-2) (4.3.1)
进一步考虑各级中的无关紧要旋转因子。当L=3时，有两个无关紧要的旋转因子W°
和WN,因为同一旋转因子对应着2M-I=N/21个碟形运算，所以第三级共有2N/2?=
N/4个碟形不需要复数乘法运算。依此类推，当L≥3时，第L级的2个无关紧要的旋转因
子减少复数乘法的次数为2N/21=N/2-1。这样，从L=3至L=M共减少复数乘法次
数为
A-2N2()-2-2 (4.3.2)
因此，DIT-FFT的复乘次数降至
CM=2(M-2)-(2-2)=2(M-3)+2 (4.3.3)
下面再讨论FFT中特殊的复数运算，以便进一步减少复数乘法次数。一般实现一次复
数乘法运算需要四次实数乘，两次实数加。但对WN?=(1-j)√2/2这一特殊复数，任一复
数(x+jy)与其相乘时，
2a-j)(x+js)=(x+jy-jx+y)=[(x+y)-j(x-y]=R+jl
R=(x+y
I=-(x-y)=(y-x)
只需要两次实数加和两次实数乘就可实现。这样，WN?对应的每个蝶形节省两次实数乘。
在DIT-FFT运算流图中，从L=3至L=M级，每级都包含旋转因子WN,第L级中，
wN?对应N/2个蝶形运算。因此从第三级至最后一级，旋转因子WN节省的实数乘次数
与(4.3.2)式相同。所以从实数乘运算考虑，计算N=2"点DIT-FFT所需实数乘法次
数为
Rx=4[(M-3)+2]-(-2)=N(2M-2)+10 (4.3.4)
在基2FFT程序中，若包含了所有旋转因子，则称该算法为一类碟形单元运算；若去
掉W"=±1的旋转因子，则称之为二类碟形单元运算；若再去掉W"=±j的旋转因子，则
称为三类碟形单元运算；若再判断处理WN=(1-j)√2/2,则称之为四类碟形运算。我们将
后三种运算称为多类碟形单元运算。显然，碟形单元类型越多，编程就越复杂，但当N较
大时，乘法运算的减少量是相当可观的。例如，N=4096时，三类碟形单元运算的乘法次数
为一类碟形单元运算的75??
146
Created by ZhuangHeng
4.3.2 旋转因子的生成
在FFT运算中，旋转因子W=cos(2πm/N)-jsin(2πm/N),求正弦和余弦函数值的
计算量是很大的。所以编程时，产生旋转因子的方法直接影响运算速度。一种方法是在每
级运算中直接产生；另一种方法是在FFT程序开始前预先计算出W",m=0,1,…,
N/2-1,存放在数组中，作为旋转因子表，在程序执行过程中直接查表得到所需旋转因子
值，不再计算。这样使运算速度大大提高，其不足之处是占用内存较多。
4.3.3 实序列的FFT算法
在实际工作中，数据x(n)常常是实数序列。如果直接按FFT运算流图计算，就是把
x(n)看成一个虚部为零的复序列进行计算，这就增加了存储量和运算时间。处理该问题的
方法有三种。早期提出的方法是用一个N点FFT计算两个N点实序列的FFT,一个实序
列作为x(n)的实部，另一个作为虚部，计算完FFT后，根据DFT的共轭对称性，用例
3.2.2所述的方法由输出X(k)分别得到两个实序列的N点DFT。第二种方法是用N/2点
FFT计算一个N点实序列的DFT。第三种方法是用离散哈特莱变换(DHT)。下面简要
介绍第二种方法。
设x(n)为N点实序列，取x(n)的偶数点和奇数点分别作为新构造序列y(n)的实部和
虚部，即
2-1 x?(n)=x(2n),x?(n)=x(2n+1) n=0.1,…,
2-1 y(n)=x?(n)+jz?(n) n=0,1,…
对y(n)进行N/2点FFT,输出Y(k),则 第4章
x[-DPFT]-x} 2-1 k=0,1,…,
根据DIT-FFT的思想及(4.2.7)和(4.2.8)式，可得到X(k)的前+1个值：
2 X(k)=X?(k)+WNX?(k)k=0,1,…, (4.3.5) 快速傅里叶变换(TTT)
式中，x,()=x?(0),X?(号)=X?(0)。。由于x(n)为实序列，因此X(k)具有共轭对称
性，X(k)的另外N/2点的值为
2-1 k=1,…, X(N-k)=X(k)
N2 A(M-1), 计算 点FFT的复乘次数为 ,计算式(4.3.5)的复乘次数为 所以用这种
4(M-1)+2=4(M+1)。相对一般的N点FFT 算法，计算X(k)所需复数乘法次数为
147
Created by ZhuangHeng
口
口
口
数字信号处理(第五版)
”MA(M+1)=MH,当N=2"=2时，η=20/11, 算法，上述算法的运算效率为
运算速度提高近1倍。
4.4 其他快速算法简介
快速傅里叶变换算法是信号处理领域重要的研究课题。自从1965年提出基2FFT算法
以来，现在已提出的快速算法有多种，且还在不断研究探索新的快速算法。由于教材篇幅
和教学大纲所限，本章仅介绍算法最简单、编程最容易的基2FFT算法原理及其编程思想，
使读者建立快速傅里叶变换的基本概念，了解研究FFT算法的主要途径和编程思路。其他
高效快速算法请读者参考文献[1]、[3]、[12]。例如，分裂基FFT算法、离散哈特莱变换
(DHT)、基4FFT、基8FFT、基rFFT、混合基FFT,以及进一步减少运算量的途径等内
容，对研究新的快速算法都是很有用的。本节简要介绍其他几种快速算法的运算量及其主
要特点，以便读者选择快速算法时参考。
从理论上讲，不同基数的FFT算法的运算效率不同，实际中最常用的是基2FFT、基4
FFT、分裂基FFT和DHT。为此，下面简要介绍后三种FFT算法的特点和运算效率，
以扩展读者的视野。其具体算法请参考文献[1]、[12]。
在基rFFT算法中，基4FFT算法运算效率与基8FFT很接近，但基4FFT算法实现程
序简单，且判断开销少。可以证明，当FFT的基大于4时，不会明显降低计算量。基4FFT
要求N=4M,M为自然数。其复数乘法次数为12]
Ca(基4)=8N bN (4.4.1)
C(2)=2N IbN,基 其中未计入乘以±j和1的计算。比较基2FFT的复数乘法次数
4FFT的复数乘法次数减少25??
1984年，法国的杜梅尔(P.Dohamel)和霍尔曼(H. Hollmann)将基2分解和基4分解
糅合，提出了分裂基FFT算法，其复数乘法次数接近FFT理论最小值，但其运算流图却与
基2FFT很相似，编程简单，运算程序也很短，是一种很实用的高效算法。分裂基FFT算
法复数乘法次数为
Ca(分裂基)=号1bN-fN+(-1)“鲁 (4.4.2)
只考虑(4.4.2)式的第一项，分裂基FFT算法的复数乘法次数就比基2FFT减少33比
基4FFT减少11??应当说明，在比较时，未考虑(4.4.2)式后2项减少的运算量，所以分
裂基FFT算法的效率更高。
由以上比较可见，分裂基FFT算法的效率最高，所以得到广泛应用。但是，对实序列
x(n),上述各种FFT算法仍将其看成虚部为零的复序列存储和计算。而一次复数乘法需要
四次实数乘法和二次实数加法。所以，必然浪费存储资源和增加多余的运算量。我们知道，
148
Created by ZhuangHeng
实序列的N点DFT具有共轭对称性，即
X(N-k)=X'(k)k=0,1.2,…,N-1
所以，只要计算出X(k)的前面N/2个值，则其后面的N/2个值可以由对称性求得。因此，
FFT算法得到的N个X(k)值有一半是多余的。由以上分析可见，对实序列一定存在更高
效的快速算法。离散哈特莱变换(DHT)就是针对实序列的一种高效变换算法，相对一般的
FFT算法，DHT的快速算法FHT可以减少近一半的计算量1。N点基2时域抽取快速
DHT(基2DIT-FHT)算法的实数乘法次数为1
MHT=NM-3N+4 (4.4.3)
N点基2DIT-FHT算法的实数加法次数为1
Am=3NM-1+2 (4.4.4)
由式(4.4.3)可见，基2DIT-FHT算法的实数乘法次数约为基2DIT-FFT算法的一半。
与前面三种FFT算法比较，对实序列，基2DIT-FHT算法的实数乘法次数最少。
应当说明，DHT是与DFT不同的变换，所以要想得到实序列的DFT,还要根据二者
的关系式进行转换。下面会看到该关系非常简单。
DHT具有以下主要优点：
(1)DHT是实数变换，在对实信号进行处理时避免了复数运算，运算效率高，且实现
硬件简单经济。
(2)DHT的正、逆变换(除了因子1/N外)具有相同的形式，所以实现硬件或程序亦相
同。N点DHT定义如下：
xn(k)=DHTz(w)-z(w)cas() k=0,1,2,…,N-1
(4.4.5)
N点逆DHT变换定义为
x(n)=IDHT[Xn(k)]、=六2Xa(k)cas() n=0,1,2,…,N-1
(4.4.6)
式中，casa=cosa+sina。 第4章快速傅里叶变换(F下1
(3)DHT满足循环卷积定理，所以，可以直接用FHT实现实序列的快速卷积，大大
提高处理速度口，并使处理硬件简化。
(4)DHT与DFT之间的关系非常简单，容易实现二者之间的转换，关系式如下：
X(k)=2[Xa(k)+Xn(N-k)]-j-[Xa(k)-X?(N-k)](4.4.7)
所以对实信号x(n)进行谱分析时，可以先对x(n)进行FHT,得到XH(k)=DHT[x(n)]~
然后再将X日(k)转换成X(k)=DFT[x(n)]n,这样可以提高分析速度，减少存储空间。
149
Created by ZhuangHeng
习题与上机题
1.如果某通用单片计算机的速度为平均每次复数乘需要4μs,每次复数加需要1μs,
用来计算N=1024点DFT,问直接计算需要多少时间。用FFT计算呢?照这样计算，用
FFT进行快速卷积来对信号进行处理时，估计可实现实时处理的信号最高频率。
2.如果将通用单片机换成数字信号处理专用单片机TMS320系列，计算复数乘和复数
加各需要10 ns。请重复做上题。
3.已知X(k)和Y(k)是两个N点实序列x(n)和y(n)的DFT,希望从X(k)和Y(k)求
x(n)和y(n),为提高运算效率，试设计用一次N点IFFT来完成的算法。
4.设x(n)是长度为2N的有限长实序列，X(k)为x(n)的2N点DFT。
(1)试设计用一次N点FFT完成计算 X(k)的高效算法；
(2)若已知X(k),试设计用一次N点IFFT实现求X(k)的2N点IDFT运算。
5.分别画出16点基2DIT-FFT和DIF-FFT运算流图，并计算其复数乘次数，如果
考虑三类碟形的乘法计算，试计算复乘次数。
6°.按照下面的IDFT算法编写MATLAB语言IFFT程序，其中的FFT部分不用写
出清单，可调用fft 函数。并分别对单位脉冲序列、矩形序列、三角序列和正弦序列进行
FFT和IFFT,验证所编程序。
x(n)=IDFT[X(k)]=六[DFT[X'(k)]]
数字信号处理(第五版)
150
Created by ZhuangHeng
第 5章
时域离散系统的网络结构
5.1 引 言
一般时域离散系统或网络可以用差分方程、单位脉冲响应以及系统函数进行描述。如
果系统输入、输出服从N阶差分方程：
(n)=bx(n-)-Zay(n-5 (5.1.1)
则其系统函数H(z)为
--
(5.1.2)
为了用计算机或专用硬件完成对输入信号的处理(运算),必须把(5.1.1)式或者(5.1.2)式
变换成一种算法，按照这种算法对输入信号进行运算。其实(5.1.1)式就是对输入信号的一
种直接算法，如果已知输入信号x(n)以及a、b,和n时刻以前的y(n-i),则可以递推出
第5章
时域离散系统的网络结构
y(n)值。但给定一个差分方程，不同的算法有多种，例如：
H?(2)=1-0.821+0.152
H?(2)=1-0.35+12.5
H?(z)=1-0.320.52
可以证明以上H?(z)=H?(z)=H?(z),但它们具有不同的算法。不同的算法直接影响系统
151
Createdby ZhuangHeng
口
a
数字信号处理(第五版)
运算误差、运算速度以及系统的复杂程度和成本等，因此研究实现信号处理的算法是一个
很重要的问题。我们用网络结构表示具体的算法，因此网络结构实际表示的是一种运算结
构。这一章是第9章数字信号处理实现的必要基础。
在介绍数字系统的基本网络结构之前，先介绍网络结构的表示方法。
5.2 用信号流图表示网络结构
观察(5.1.1)式可知，数字信号处理中有三种基本运算，即乘法、加法和单位延迟。三
种基本运算框图及其流图如图5.2.1所示。
x(n)- z -xin-D) x(n) x(n-1)
x(n)- × ax(n) a
x(n) ax(n)
a
x(n)- + x(n)+x?(n) x?(n) x?(n)+x?(n)
A?(n) x?(n)
图5.2.1 三种基本运算的流图表示
z1与系数a作为支路增益写在支路箭头旁边，箭头表示信号流动方向。如果箭头旁边
没有标明增益，则认为支路增益是1。两个变量相加，用一个圆点表示(称为网络节点),这
样整个运算结构完全可用这样一些基本运算支路组成，图5.2.2所示的就是这样的流图，
该图中圆点称为节点，输入x(n)的节点称为源节点或输入节点，输出y(n)称为吸收节点或
输出节点。每个节点处的信号称节点变量，这样信号流图实际上是由连接节点的一些有方
向性的支路构成的。和每个节点连接的有输入支路和输出支路，节点变量等于所有输人支
路的输出之和。在图5.2.2中，
(5.2.1)
(n)+bov/(n)
从该例中，我们看到用信号流图表示系统的运算情况(网络结构)是比较简明的。以下我们
均用信号流图表示网络结构。
不同的信号流图代表不同的运算方法，而对于同一个系统函数可以有多种信号流图与
之相对应。从基本运算考虑，满足以下条件，称为基本信号流图。
(1)信号流图中所有支路都是基本支路，即支路增益是常数或者是z1;
(2)流图环路中必须存在延迟支路；
(3)节点和支路的数目是有限的。
152
Created by ZhuangHeng
b
b
x(n) w W? W
b? y(n) x(n) y(n) H(z) -a
-a?
(a)基本信号流图 (b)非基本信号流图
图5.2.2 信号流图
图5.2.2(a)是基本信号流图，图中有两个环路，环路增益分别为-a?z?1和—a?z?2,
且环路中都有延时支路，而图5.2.2(b)不是基本信号流图，它不能决定一种具体的算法，
不满足基本信号流图的条件。
根据信号流图可以求出网络的系统函数，方法是列出各个节点变量方程，形成联立方
程组，并进行求解，求出输出与输入之间的z域关系。
【例5.2.1】 求图5.2.2(a)信号流图决定的系统函数H(z)。
解 图5.2.2(a)信号流图的节点变量方程为(5.2.1)式，对(5.2.1)式进行Z变换，
得到：
经过联立求解得到：
H(2)=()-1+4121+12
当结构复杂时，上面利用节点变量方程联立求解的方法较麻烦，不如用梅逊(Masson)
公式直接写H(z)表示式方便。关于梅逊公式请参考本书附录A。
一般将网络结构分成两类，一类称为有限长单位脉冲响应网络，简称FIR(Finite
Impulse Response)网络，另一类称为无限长单位脉冲响应网络，简称IIR(Infinite Impulse
Response)网络。FIR网络中一般不存在输出对输入的反馈支路，因此差分方程用下式
描述：
(n)=∑bx(n-) (5.2.2)
其单位脉冲响应h(n)是有限长的，按照(5.2.2)式，h(n)表示为
(n)={o其他”<M
IIR网络结构存在输出对输入的反馈支路，也就是说，信号流图中存在反馈环路。这类网络
的单位脉冲响应是无限长的。例如，一个简单的一阶IIR网络的差分方程为
y(n)=ay(n-1)+x(n)
第5章
时域离散系统的网络结构
153
Created by ZhuangHeng
a口
数字信号处理(第五版)
其单位脉冲响应h(n)=a"u(n)。这两类不同的网络结构各有不同的特点，下面分类叙述其
网络结构。
5.3 IIR系统的基本网络结构
IIR系统的基本网络结构有三种，即直接型、级联型和并联型。
1.直接型
将N阶差分方程重写如下：
y(n)=br(n-i)+∑as(n-D)
对应的系统函数为
设M=N=2,按照差分方程可以直接画出网络结构如图5.3.1(a)所示。图中第一部分系统
函数用H?(z)表示，第二部分用H?(z)表示，那么H(z)=H?(z)·H?(z),当然也可以写
成H(z)=H?(z)·H?(z),按照该式，相当于将图5.3.1(a)中两部分流图交换位置，如图
5.3.1(b)所示。该图中节点变量w?=w?,因此前后两部分的延时支路可以合并，形成如图
5.3.1(c)所示的网络结构流图，我们将图5.3.1(c)所示的这类流图称为IIR 直接型网络
x(n) b% y(n)
(a) x(n-1) h
a
y(n-1)
x(n-2) 4 a
y(n-2)
H?(2) H?(z)
x(n) w W? b y(n)
a b
(b) a b?
H?(2) H?(2)
x(n) b% y(n)
(c)
图5.3.1 IIR网络直接型结构
a
z1 b
a? h
154
Created by ZhuangHeng
结构。
M=N=2时的系统函数为
H(2)=1-a12-h2
对照图5.3.1(c)的各支路的增益系数与H(z)分母分子多项式的系数可见，可以直接按照
H(z)画出直接型结构流图。
【例5.3.1】设IIR数字滤波器的系统函数H(z)为
a
画出该滤波器的直接型结构。
解 由H(z)写出差分方程如下：
y(n)=5y(n-1)-3y(n-2)+gy(n-3)
+8x(n)-4x(n-1)+11x(n-2)-2x(n-3)
按照差分方程画出如图5.3.2所示的直接型网络结构。
x(n) 8 y(n)
图5.3.2 例5.3.1图
上面我们按照差分方程画出了网络结构，也可以按照H(z)表达式，直接画出直接型网
络结构，这里需要用到Masson公式。
下面讲述直接型的MATLAB的表示与实现。
在MATLAB中，直接型结构由2个行向量B和A表示，B和A与数字滤波器系统函
数的关系如下：
A=[a,a1,a?,…,ax],B=[b,b?,b?,…,ba]
则直接型系统函数为
5/4 z-4
-3/4 z 11
1/8 z1 -2
第5章
时域离散系统的网络结构
-
调用1.4.2节介绍的MATLAB信号处理工具箱函数 filter 就是按照直接型结构实现滤波
器。如果滤波器输入信号向量为xn,输出信号向量为yn,则yn=filter(B,A.xn)按照直接
型结构实现对xn的滤波，计算系统对输入信号向量xn的零状态响应输出信号向量yn,yn
与xn长度相等。
155
Created by ZhuangHeng
口
口
口
数字信号处理(第五版)
2.级联型
在(5.1.2)式表示的系统函数H(z)中，分子、分母均为多项式，且多项式的系数一般
为实数。现将分子、分母多项式分别进行因式分解，得到：
(5.3.1)
式中，A是常数；c,和d,分别表示H(z)的零点和极点。由于多项式的系数是实数，c,和
d,是实数或者是共轭成对的复数，将共轭成对的零点(极点)放在一起，形成一个二阶多项
式，其系数仍为实数；再将分子、分母均为实系数的二阶多项式放在一起，形成一个二阶网
络H(z)。H(z)如下式：
H(2)=R+e+ (5.3.2)
式中，B、β、β、a和a均为实数。这样H(z)就分解成一些一阶或二阶的子系统函数的
相乘形式：
H(z)=H?(z)H?(z)…H(z) (5.3.3)
式中H?(z)表示一个一阶或二阶的数字网络的子系统函数，每个H?(z)的网络结构均采用
前面介绍的直接型网络结构，如图5.3.3所示，H(z)则由k个子系统级联构成。
x(n) A y(n) x(n) A y(n)
a A
(a)直接型一阶网络结构
a z1R
a? R
(b)直接型二阶网络结构
图5.3.3 一阶和二阶直接型网络结构
【例5.3.2】 设系统函数H(z)如下式：
H(z)=1-1.2542+0.75-2.125
试画出其级联型网络结构。
解 将H(z)的分子、分母进行因式分解，得到：
H(z)=2-0.370.2524-1.24+0.52642
为减少单位延迟的数目，将一阶的分子、分母多项式组成一个一阶网络，二阶的分子、分母
多项式组成一个二阶网络，画出级联结构图如图5.3.4所示。
级联型结构中每一个一阶网络决定一个零点、一个极点，每一个二阶网络决定一对零
点、一对极点。在(5.3.2)式中，调整B?、β和β三个系数可以改变一对零点的位置，调整
aj和a2可以改变一对极点的位置。因此，相对直接型结构，其优点是调整方便。此外，级联
结构中后面的网络输出不会再流到前面，运算误差的积累相对直接型也小。
156
Created by ZhuangHeng
x(n) 2 4 y(n)
124
0.25 -0.379
-0.5 Fsz
图5.3.4 例5.3.2图
3.并联型
如果将级联形式的H(z)展成部分分式形式，则得到：
H(z)=H,(z)+H?(z)十…+H,(z) (5.3.4)
对应的网络结构为这k个子系统并联。上式中，H,(z)通常为一阶网络或二阶网络，网络系
数均为实数。二阶网络的系统函数一般为
H(2)=R+Ba
式中，β、β、a和a,都是实数。如果β=a=0,则构成一阶网络。由(5.3.4)式，其输出
Y(z)表示为
Y(z)=H?(z)X(z)+H?(z)X(z)+…+H?(z)X(z)
上式表明将x(n)送入每个二阶(包括一阶)网络后，将所有输出加起来得到输出y(n)。
【例5.3.3】 画出例题5.3.2中的H(z)的并联型结构。
解 将例5.3.2中H(z)展成部分分式形式：
H(2)=16+1-0.52+?-16+20.5
将每一部分用直接型结构实现，其并联型网络结构如图5.3.5所示。
x(n) 16 y(n)
8
0.5 -16
20 当见打骨书的用的民省
图 5.3.5 例5.3.3图
在这种并联型结构中，每一个一阶网络决定一个实数极点，每一个二阶网络决定一对
共轭极点，因此调整极点位置方便，但调整零点位置不如级联型方便。另外，各个基本网络
是并联的，产生的运算误差互不影响，不像直接型和级联型那样有误差积累，因此，并联形
式运算误差最小。由于基本网络并联，可同时对输入信号进行运算，因此并联型结构与直
接型和级联型比较，其运算速度最高。
MATLAB信号处理工具箱提供了14种线性系统网络结构变换函数，实现各种结构之
-0.5
157
Created by ZhuangHeng
数字信号处理(第五版)
间的变换。可惜缺少并联结构与其他结构之间的变换函数，参考文献[10,18]中开发了直
接型与并联型的相互变换函数tf2par和par2tf。本书涉及的3种常用结构(直接型、级联
型、格型)之间的变换函数有如下4种：
(1)tf2sos 直接型到级联型结构变换。
(2)sos2tf级联型到直接型网络结构的变换。
(3)tf2latc 直接型到格型结构变换。
(4)late2tf格型到直接型结构变换。
下面先简要介绍变换函数tf2sos和 sos2tf及其调用格式，tf2latc和 latc2tf在5.7节
介绍。
(1)[S,G]=tf2sos(B,A):实现直接型到级联型的变换。B和A分别为直接型系统
函数的分子和分母多项式系数向量，当A=1时，表示FIR系统函数。返回L级二阶级联
型结构的系数矩阵S和增益常数G。
S为L×6矩阵，每一行表示一个二阶子系统函数的系数向量，第k行对应的2阶系统函
数为
H?(2)=1+h2+baz2 k=1,2,…,L
级联结构的系统函数为
H(z)=H?(z)H?(z)…H,(z)
例5.3.2的求解程序如下：
B=[8,-4,11,-2];
A=[1,-1.25,0.75,-0.125];
[S,G]=tf2sos(B,A)
运行结果：
S=1.0000 -0.1895 0 1.0000 -0.25000
1.0000 -0.3100 1.3161 1.0000 -1.0000 0.5000
G=8
H(z)=81-0.252.1-0.32z3+01.3161z3
该结果与例5.3.2所得结果等价，但本程序结果更标准。
(2)[B,A]=sos2tf(S,G):实现级联型到直接型网络结构的变换。B、A、S和G的
含义与[S,G]=tf2sos(B,A)中相同。
158
Created by ZhuangHeng
5.4 FIR系统的基本网络结构
FIR网络结构特点是没有反馈支路，即没有环路，其单位脉冲响应是有限长的。设单
位脉冲响应h(n)长度为N,其系统函数H(z)和差分方程分别为
H(a)=2h(n)z
y(n)-∑h(m)z(n-m)
1.直接型
按照H(z)或者卷积公式直接画出结构图如图5.4.1所示。这种结构称为直接型网络
结构或者称为卷积型结构。
x(n) z
h(O) h() h(2) h(N-2) h(N-1)
y(n)
图5.4.1 FIR直接型网络结构
2.级联型
将H(z)进行因式分解，并将共轭成对的零点放在一起，形成一个系数为实数的二阶形
式，这样级联型网络结构就是由一阶或二阶因子构成的级联结构，其中每一个因式都用直
接型实现。
【例5.4.1】设FIR网络系统函数H(z)如下式：
H(z)=0.96+2.0z1+2.8z2+1.5z
画出 H(z)的直接型结构和级联型结构。
解 将H(z)进行因式分解，得到：
H(z)=(0.6+0.5z?)(1.6+2z1+3z2)
其级联型结构和直接型结构如图5.4.2(a)和(b)所示。
x(n) 0.6 1.6 y(n) x(n) z
z1 2 0.5
0.96 2 2.8
3
(b)
第5章
时域离散系统的网络结构
1.5
(a)
图5.4.2 例5.4.1图
y(n)
159
Created by ZhuangHeng
口
口口
数字信号处理(第五版)
例5.4.1的求解程序如下：
B=[0.96,2,2.8,1.5];
A=1;
[S,G]=tf2sos(B,A)
运行结果：
S=1.0000 0.8333(0 1.000000
1.0000 1.2500 1.8750 1.00000 0
G=0.9600
级联结构的系统函数为
H(z)=0.96(1+0.833z?1)(1+1.25z?1+1.875z2)
级联型结构每一个一阶因子控制一个零点，每一个二阶因子控制一对共轭零点，因此
调整零点位置比直接型方便，但H(z)中的系数比直接型多，因而需要的乘法器多。在例
5.4.1中直接型需要四个乘法器，而级联型则需要五个乘法器。分解的因子愈多，需要的乘
法器也愈多。另外，当H(z)的阶次高时，也不易分解。因此，普遍应用的是直接型。
5.5 FIR系统的线性相位结构
线性相位结构是FIR系统的直接型结构的简化网络结构，特点是网络具有线性相位特
性，比直接型结构节约了近一半的乘法器。第7章将证明，如果系统具有线性相位，它的单
位脉冲响应满足下面公式：
h(n)=士h(N-n-1) (5.5.1)
式中，“十”代表第一类线性相位滤波器；“一”代表第二类线性相位滤波器。系统函数满足
下面两式：
当N为偶数时，
H)-Zhne± (5.5.2)
当N为奇数时，
He)=hCe±I+A(=1) (5.5.3)
观察(5.5.2)式和(5.5.3)式，运算时先进行方括号中的加法(减法)运算，再进行乘法运算，
这样就节约了乘法运算。按照这两个公式，第一类线性相位网络结构的流图如图5.5.1所
示，第二类线性相位网络结构的流图如图5.5.2所示。和直接型结构比较，如果N取偶数，
直接型需要N个乘法器，而线性相位结构减少到N/2个乘法器，节约了一半的乘法器。如
果N取奇数，则乘法器减少到(N+1)/2个，也近似节约了近一半的乘法器。
160
Created by ZhuangHeng
x(n)
…
z h(o) h(D h(2) h(N/2-DT
y(n)
(a)N为偶数
z x(n)
…
h(2)
…
z h(o) h(D) h(N-1)/2)
y(n)
(b)N为奇数
图5.5.1 第一类线性相位网络结构流图
x(n) z …
-1 -1 -1 -1 -1 z
h(2)
…
z z
h(O) h(1) h(N/2-D|
y(n)
(a)N为偶数
x(n)
…
-1 -1 -1 -1
z1
…
h(O) h(1) h(2) h((N-1/2)
·y(n)
(b)N为奇数 第5章
图5.5.2 第二类线性相位网络结构流图
5.6 FIR系统的频率采样结构
我们已经知道，频率域等间隔采样，相应的时域信号会以采样点数为周期进行周期性
延拓。如果在频率域采样点数N大于等于原序列的长度M,则不会引起信号失真，此时由
(3.3.6)式得到原序列的Z变换H(z)与频域采样值H(k)满足下面关系式：
时域离散系统的网络结构
H(a)=(1-六2H) (5.6.1)
设FIR滤波器单位脉冲响应h(n)长度为M,系统函数H(z)=ZT[h(n)],则(5.6.1)式中
H(k)用下式计算：
H(k)=H(z)|_k=0,1,2,…,N-1
要求频率域采样点数N≥M。(5.6.1)式提供了一种称为频率采样的网络结构。由于这种结
构是通过频域采样得来的，存在时域混叠的问题，因此不适合IIR系统，只适合FIR系统。
161
Created by ZhuangHeng
口口
口口
口口
口
数字信号处理(第五版)
但这种网络结构中又存在反馈网络，不同于前面介绍的FIR网络结构，下面进行分析。
将(5.6.1)式写成下式：
H(z)=青H)∑H?(2)
H(z)=1-z
H?(z)=-Wk?
(5.6.2)
式中H.(z)是前面学习过的梳状滤波器，H?(z)是IIR的一阶网络。这样，H(z)是由梳状
滤波器H(z)和N个一阶网络H(z)的并联结构进行级联而成的，其网络结构如图5.6.1
所示。我们看到该网络结构中有反馈支路，它是由H?(z)产生的，其极点为
z=ek=0,1,2,…,N-1
即它们是单位圆上等间隔分布的N个极点，第2章已学过H.(z)是一个梳状滤波网络，其
零点为
z=e k=0,1,2,…,N-1
刚好和极点相同，也是等间隔地分布在单位圆上。理论上，极点和零点相互抵消，保证了网
络的稳定性，使频率域采样结构仍属FIR网络结构。
x(n) H(O) y(n)
-z w
H(1)
-之
w H(N-D
z1 w
图5.6.1 FIR 滤波器频率采样结构
频率域采样结构有两个突出优点：
(1)在频率采样点w,处，H(e)=H(k),只要调整H(k)(即一阶网络H?(z)中乘法
器的系数H(k)),就可以有效地调整频响特性，使实践中调整方便，可以实现任意形状的
频响曲线。
(2)只要h(n)长度N相同，对于任何频响形状，其梳状滤波器部分和N个一阶网络部
分结构完全相同，只是各支路增益H(k)不同。这样，相同部分便可以标准化、模块化。各
支路增益可做成可编程单元，生产可编程FIR 滤波器。
然而，上述频率采样结构亦有两个缺点：
(1)系统稳定是靠位于单位圆上的N个零极点相互对消保证的。实际上，因为寄存器
字长都是有限的，对网络中支路增益WN量化时产生量化误差，可能使零极点不能完全对
消，从而影响系统稳定性。
162
Created by ZhuangHeng
(2)结构中，H(k)和Wn一般为复数，要求乘法器完成复数乘法运算，这对硬件实现
是不方便的。
为了克服上述缺点，对频率采样结构作以下修正。
首先将单位圆上的零极点向单位圆内收缩一点，收缩到半径为r的圆上，取r<1且
r≈1。此时H(z)为
H(z)=(-rs六2wA) (5.6.3)
式中，H,(k)是在r圆上对H(z)的N点等间隔采样值。由于r≈1,因此可近似取H,(k)≈
H(k)。这样，零极点均为re,k=0,1,2,…,N-1。如果由于实际量化误差，零极点不
能抵消时，极点位置仍处在单位圆内，保持系统稳定。
另外，由DFT的共轭对称性知道，如果h(n)是实数序列，则其离散傅里叶变换H(k)
关于N/2点共轭对称，即H(k)=H*(N-k)。而且WN=WN,我们将H?(z)和
HN-(z)合并为一个二阶网络，并记为H,(z),则
H?(2)=-rw)+HwN-k
w+w)
1-2(+
式中
—-2RdFHW} k=1,2,3,…,2-1
显然，二阶网络H?(z)的系数都为实数，其结构如图5.6.2(a)所示。当N为偶数时，H(z)
可表示为
Ho-a-+点
(5.6.4) 第5章时域离散系统的网络结构 式中，H(0)和H(N/2)为实数。(5.6.4)式对应的频率采样修正结构由N/2-1个二阶网
络和两个一阶网络并联构成，如图5.5.4(b)所示。当N=奇数时，只有一个采样值H(O)
为实数，H(z)可表示为
Ha=a-”+(5.6.5)
N等于奇数的修正结构由一个一阶网络和(N-1)/2个二阶网络结构构成。
由图5.6.2可见，当采样点数N很大时，其结构显然很复杂，需要的乘法器和延时单
163
Created by ZhuangHeng
口
口口 口
数字信号处理(第五版)
164
ao x(n) H(O) y(n)
a
z z
H?(z)
1/N
2() r2 z
H?(2)
H(2)
H(N/2)
z -r
(a) (b)
图5.6.2 频率采样修正结构
元很多。但对于窄带滤波器，大部分频率采样值H(k)为零，从而使二阶网络个数大大减
少。所以频率采样结构适用于窄带滤波器。
5.7 格型网络结构
格型网络结构适用于一般时域离散系统，结构的优点是对有限字长效应比较不敏感，
且适合递推算法。它在一般数字滤波器、自适应滤波器、线性预测以及谱估计中都有广泛
的应用。
5.7.1 全零点格型网络结构
1.全零点格型网络的系统函数
全零点格型网络结构的流图如图5.7.1所示。该流图只有直通通路，没有反馈回路，
因此可称为FIR格型网络结构。观察该图，它可以看成是由图5.7.2的基本单元级联而成。
x(n)=e。(n) e?(n) n(n) ea(n)=y(n)
k? k? k
k? k
(n)z (n) z ?(n) (n)z r(n)
图5.7.1 全零点格型网络结构
e(n) e?(n)
k,
k
(n) 5(n)
图5.7.2 基本单元
Created by ZhuangHeng
按照图5.7.2写出差分方程如下：
e,(n)=e-i(n)+r-1(n-1)k (5.7.1)
r,(n)=e1(n)k,+r_(n-1) (5.7.2)
将上式进行Z变换，得到
E?(z)=E-?(z)+z1R(z)k?
R?(z)=E(z)k,+z1R?(z)
(5.7.3)
(5.7.4)
再将上式写成矩阵形式
R(e)-R( (5.7.5)
将N个基本单元级联后，得到：
Re]-[]Re] (5.7.6)
令Y(z)=EN(z),X(z)=E。(z)=R。(z),其输出为
Ya)=Re]-立][]xa) (5.7.7)
由上式得到全零点格型网络的系统函数为
Ha)--[] (5.7.8)
只要知道格型网络的系数k?,L=1,2,3,…,N,由上式可以直接求出FIR格型网络的系
统函数。
2.由FIR直接型网络结构转换成全零点格型网络结构
假设N阶FIR型网络结构的系统函数为
H(2)=h()s” (5.7.9)
式中，h(0)=1;h(n)是FIR 网络的单位脉冲响应。令a=h(k),得到：
H(2)=∑a (5.7.10) 离
式中，ao=h(0)=1;k,为全零点格型网络的系数，L=1,2,…,N。
下面仅给出转换公式，推导过程请参考文献[19]:
a=a
af=k
(5.7.11)
(5.7.12)
a?=-ka k=1,2,3,…,1-1 (5.7.13)
式中，L=N,N-1,…,1。
165
Created by ZhuangHeng
口口
口
口口
品
口口
口
数字信号处理(第五版)
166
解释 公式中的下标k(或1)表示第k(或D个系数，这里FIR结构和格型结构均各有
N个系数；(5.7.13)式是一个递推公式，上标(带圆括弧)表示递推序号，从(N)开始，然后
是N-1,N-2,…,2;注意(5.7.12)式a{=k?,当递推到上标圆括弧中的数字与下标相
同时，格型结构的系数k,刚好与FIR的系数a{=a,相等。下面举例说明。
【例5.7.1】 将下面三阶FIR系统函数H?(z)转换成格型网络，要求画出该FIR直接
型结构和相应的格型网络结构流图。
H?(z)=1-0.9z1+0.64z2-0.576z
解 例题中N=3,按照(5.7.11)式，有
a{"=-0.9,a2=0.64,a=-0.576
由(5.7.12)式，得到：
ks=a3)=-0.576
按照(5.7.13)式，递推得到：
L=3,k=1时，
=k==0.9+0.57×0.64=-0.795 18245
L=3,k=2时，
a=ka=0.64-0.576×0.9=0.18197491
k?=a=0.18197491
l=2,k=1时，
a=a=0.79518245.×81974.18197491)=-0.672 75747
k?=-0.672 757 47
最后按照算出的格型结构的系数，画出三阶FIR直接型结构和三级格型网络结构流图如图
5.7.3所示。
x(n)
1.0 -0.9 0.64 -0.576
y(n)
(a)直接型结构
x(n)=e,(n) e?(n) e?(n) e(n)=y(n)
k?=-0.67276 k?=0.18197 k,=-0.576
k? k? k?
(n)z (n) z(n) F?(n)
(b)格型网络结构
图5.7.3 例5.7.1图
Created by ZhuangHeng
略去由全零点格型网络结构转换到FIR直接型网络结构的公式，如需要了解该内容，
请参考文献[19]。
实际上，调用MATLAB函数实现直接型网络结构与格型网络结构之间的相互转换非
常容易。tf2latc实现直接型到格型结构变换，latc2tf 实现格型到直接结型结构变换。
K=tf2late(hn):求FIR格型结构的系数向量K=[k?,k?,…,k、],hn为FIR滤波器
的单位脉冲响应向量，并关于hn(1)=h(0)归一化。应当注意，当FIR系统函数在单位圆
上有零极点时，可能发生转换错误。
hn=latc2tf(K)将FIR格型结构转换为FIR直接型结构。K为FIR格型结构的系数向
量，hn为FIR 滤波器的单位脉冲响应向量，即FIR 直接型结构系数向量。显然，该函数可
以用于求格型结构的系统函数的系数。
例5.7.1的求解程序如下：
hn=[1,-0.9,0.64,-0.576];
K=tf2late(hn)
运行结果：
K=[-0.6728 0.1820 -0.5760]
与上面的递推结果相同。
5.7.2 全极点格型网络结构
全极点IIR系统的系统函数用下式表示： + (5.7.14)
A(2)=1+a (5.7.15)
式中，A(z)是FIR系统，因此全极点IIR系统H(z)是FIR系统A(z)的逆系统。下面先介
绍如何将H(z)变成A(z)。
假设系统的输入和输出分别用x(n)、y(n)表示，由(5.7.14)式得到全极点IIR 滤波器
的差分方程为
y(n)=-Zay(n-k)+x(n) (5.7.16)
第5章时域离散系统的网络结构
如果将x(n)、y(n)的作用相互交换，差分方程则变成下式：
x(n)=-ax(n-k)+y(n)
则
y(m)=z(n)+∑ar(n=k) (5.7.17)
观察上式，它描述的是具有系统函数H(z)=A(z)的FIR系统，而(5.7.16)式描述的是
167
Created by ZhuangHeng
……………dooo □ ■
口
口口
品口口
口
□口00
数字信号处理(第五版)
H(z)=1/A(z)的IIR系统。按照(5.7.16)式描述的全极点直接型结构如图5.7.4所示。
x(n)
-a -a-r -a? -a
y(n)
图5.7.4 全极点IIR系统的直接型结构
基于上面的事实，我们将FIR格型结构通过交换公式中的输入输出作用，形成它的逆
系统，即全极点格型IIR系统。重新定义输入输出
z(n)=ex(n),y(n)=e。(n)
再将FIR格型结构的基本公式(5.7.1)、(5.7.2)重写如下：
e,(n)=e(n)+r-(n-1)k (5.7.18)
r?(n)=e_i(n)k,+r_(n-1) (5.7.19)
由于重新定义了输入输出，将e,(n)按降序运算，r?(n)不变，即
x(n)=en(n) (5.7.20)
e?-(n)=e?(n)-r(n-1)k?l=N,N-1,…,1
r,(n)=e?-?(n)k?+r(n-1)l=N,N-1,…,1
(5.7.21)
(5.7.22)
y(n)=e。(n)=r。(n) (5.7.23)
按照上面四个方程画出它的结构如图5.7.5所示。为了说明这是一个全极点IIR系统，令
N=1,得到方程为
x(n)=e?(n) (5.7.24)
e。(n)=e?(n)-r。(n-1)k
r?(n)=e。(n)k?+r。(n-1)
(5.7.25)
(5.7.26)
y(n)=e。(n)=x(n)-k?y(n-1) (5.7.27)
x(n)=ey(n) e(n) e,(n) o(n) y(n)
-k -k? -k?
k k: k?
(n) z (n) ?(n) z1r(n) 1(n)
图5.7.5 全极点IIR格型结构
当x(n)和y(n)分别作为输入和输出时，(5.7.27)式就是一个全极点的差分方程，由
(5.7.24)～(5.7.27)式描述的结构就是一阶的单极点格型网络，如图5.7.6(a)所示。如果
N=2,可得到下面方程组：
x(n)=e?(n)
e?(n)=e?(n)-k?r?(n-1)
(5.7.28)
(5.7.29)
168
Created by ZhuangHeng
r?(n)=k?e?(n)+r?(n-1) (5.7.30)
e。(n)=e?(n)-k?r?(n-1) (5.7.31)
r?(n)=k?ea(n)+r。(n-1) (5.7.32)
y(n)=e。(n)=r。(n) (5.7.33)
x(n) e(n) e。(n) y(n) x(n) e?(n) g?(n) e。(n) y(n)
k?
-k
k?
-k?
k? k
r(n) (n) F(n) z?r(n) z1?)
(a) (b)
图5.7.6 单极点和双极点IIR格型网络结构
经过化简，得到：
y(n)=-k?(1+k?)y(n-1)-k?y(n-2)+x(n) (5.7.34)
r?(n)=k?y(n)+k?(1+k?)y(n-1)+y(n-2) (5.7.35)
显然，(5.7.34)式差分方程表示的就是双极点IIR系统。按照上面两式构成的双极点IIR
格型结构如图5.7.6(b)所示。
由上面分析知道，全极点网络可以由全零点格型网络形成，这是一个求逆的问题。对
比全零点格型结构和全极点结构，可以归纳出下面的一般求逆准则：
(1)将输入到输出的无延时通路全部反向，并将该通路的常数支路增益变成原常数的
倒数(此处为1);
(2)将指向这条新通路的各节点的其他节点的支路增益乘以-1;
(3)将输入输出交换位置。
调用MATLAB转换函数可以实现全极点系统的直接型和格型结构之间的转换。
K=tf2latc(1,A):求IIR全极点系统格型结构的系数向量K,A为(5.7.14)式给出
的IIR全极点系统函数的分母多项式A(z)的系数向量。
具有零点和极点的IIR格型网络称为格梯型网络结构，这部分内容请参考文献[18]和
[26]的例7.21。
[K,V]= tf2late(B,A):求具有零点和极点的IIR格型网络系数向量K,及其梯型网
络系数向量V。应当注意，当IIR系统函数在单位圆上有极点时，可能发生转换错误。
[B,A]=late2tf(K,'allpole):将IIR全极点系统格型结构转换为直接型结构。K为
IIR全极点系统格型结构的系数向量，A为IIR全极点系统系数函数的分母多项式A(z)的
系数向量。显然，该函数可以用于求格型结构的系统函数，这时分子为常数1,所以B=1。
[B,A]=latc2tf(K,V):将具有零点和极点的IIR格梯型网络结构转换为直接型结构。
例如：
第5章时域离散系统的网络结构
169 Created by ZhuangHeng
数字信号处理(第五版)
A(z)=1+24z1+5z2+3z
则求IIR全极点系统格型结构系数向量K的程序为
A=[1,13/24,5/8,1/3];
K=tf2late(1,A)
运行结果：
K=[0.2500 0.5000 0.3333]
对上面所求格型结构的系数向量K,调用latc2tf求其对应的格型结构的系统函数的程
序如下：
K=[0.2500,0.5000.0.3333];
[B.A]=late2tf(K,'allpole)
运行结果：
00] B=[1 0
A=[1.0000 0.5417 0.6250 0.3333]
对应的系统函数为
H(z)=②)-1+0.5417z1+0.625z2+0.3332
下面再推导全极点网络结构的系统函数，将(5.7.21)和(5.7.22)式进行Z变换，得到：
E_(z)=E?(z)-z?1R_(z)k,
R?(z)=E_(z)k?+z'R(z)
(5.7.36)
(5.7.37)
写成矩阵形式：
R(a)-② (5.7.38)
将N个基本单元级联后，得到：
X(z)=EN(z),Y(z)=E(z)=R。(z)
x(a)=1e]-{]}[]re) (5.7.39)
m-- (5.7.40)
与全零点格型网络的系统函数(5.7.8)式比较，全极点格型网络的系统函数正好是(5.7.8)
式的倒数。
全极点格型网络同样存在稳定问题，可以证明稳定的充分必要条件是|k,|≤1,L=1,
2,…,N。
具有零点和极点的IIR格型网络称为格梯形网络结构，这部分内容请参考文献[12]。
170
Created by ZhuangHeng
习题与上机题
1.已知系统用下面差分方程描述：
y(n)=3y(n-1)-gy(n-2)+x(n)+3z(n-1)
试分别画出系统的直接型、级联型和并联型结构。式中x(n)和y(n)分别表示系统的输入和
输出信号。
2.设数字滤波器的差分方程为
y(n)=x(n)+x(n-1)+3y(n-1)+iy(n-2)
试画出系统的直接型结构。
3.设系统的差分方程为
y(n)=(a+b)y(n-1)-aby(n-2)+x(n-2)+(a+b)x(n-1)+abx(n)
式中，[a|<1,[b|<1,x(n)和y(n)分别表示系统的输入和输出信号，试画出系统的直接
型和级联型结构。
4.设系统的系统函数为
H(z)=4a-0.5)d+1.94+0.8125
试画出各种可能的级联型结构，并指出哪一种最好。
5.题5图中画出了四个系统，试用各子系统的单位脉冲响应分别表示各总系统的单位
脉冲响应，并求其总系统函数。
x(n) h?(n) h(n) h(n) y(n)
(a)
h?(n)
x(n)
x(n) h;(n) y(n) h?(n) h?(n) y(n)
hj(n)
(b)
h(n)
(e) 第5章时域离散系统的网络结构 h?(n)
h(n) y(n)
x(n) h?(n)
hs(n)
(d)
题5图
6.题6图中画出了10种不同的流图，试分别写出它们的系统函数及差分方程。
h(n)
171
Created by ZhuangHeng
见■ 口
口
口口
口
口口
口口
口
口
口
□
a口
数字信号处理(第五版)
172
x(n) y(n) x(n) y(n) x(n) z
z a b
a z 0.3 0.5 c y(n)
(a) (b) (c)
x(n) 2 y(n) x(n) y(n)
x(n) a y(n) 0.24 z z
0.25 0.5 -0.75
b
0.2
(d) (e) 1
x(n)
x(n) 2 y(n)
z 0.25
0.25 -m 2 y(n)
-3/8
(8) (h)
x(n) b% y(n) x(n) b y(n)
a
z1
a? b? a
z
a b
z
b a
a
b
b
①) ()
题6图
7.假设滤波器的单位脉冲响应为
h(n)=a"u(n) 0<a<1
求出滤波器的系统函数，并画出它的直接型结构。
8.已知系统的单位脉冲响应为
h(n)=8(n)+28(n-1)+0.38(n-2)+2.58(n-3)+0.58(n-5)
试写出系统的系统函数，并画出它的直接型结构。
9.已知FIR滤波器的系统函数为
H(2)=11+0.9z1+2.1z2+0.9z3+z?)
试画出该滤波器的直接型结构和线性相位结构。
10.已知FIR滤波器的单位脉冲响应为：
(1)N=6
h(0)=h(5)=15
h(1)=h(4)=2
Created by ZhuangHeng
h(2)=h(3)=3
(2)N=7
h(0)=-h(6)=3
h(1)=-h(5)=-2
h(2)=-h(4)=1
h(3)=0
试画出它们的线性相位型结构图，并分别说明它们的幅度特性、相位特性各有什么特点。
11.已知FIR滤波器的16个频率采样值为：
H(0)=12, H(3)～H(13)=0
H(1)=-3-j√3, H(14)=1-j
H(2)=1+j, H(15)=-3+j√3
试画出其频率采样结构，选择r=1,可以用复数乘法器。
12.已知FIR滤波器系统函数在单位圆上16个等间隔采样点为：
H(0)=12 H(3)~H(13)=0
H(1)=-3-j√3 H(14)=1-j
H(2)=1+j H(15)=-3+j√3
试画出它的频率采样结构，取修正半径r=0.9,要求用实数乘法器。
13.已知FIR滤波器的单位脉冲响应为
h(n)=8(n)-8(n-1)+δ(n-4)
试用频率采样结构实现该滤波器。设采样点数N=5,要求画出频率采样网络结构，写出滤
波器参数的计算公式。
14.令：
H?(z)=1-0.6x?1-1.414z2+0.864z?3
H?(z)=1-0.98z1+0.9z2-0.898z
H?(z)=H?(z)/H?(z)
分别画出它们的直接型结构。
15.写出题15图中系统的系统函数和单位脉冲响应。
5
x(n) 3
z
y(n)
1/2 2
题15图
16.画出题15图中系统的转置结构，并验证两者具有相同的系统函数。
第5章时域离散系统的网络结构
173
Created by ZhuangHeng
口
口
口
口口
数字信号处理(第五版)
17.用b?和b?确定a?、a2、c?和c。,使题17图中的两个系统等效。
x(n) y(n) x(n) co y(n)
z
b? a a? G
(a) (b)
题17图
18.对于题18图中的系统，要求：
(1)确定它的系统函数；
(2)如果系统参数为
① b=b?=1,b?=2,a?=1.5,a?=-0.9
② b。=b?=1,b?=2,a?=1,a?=-2
画出系统的零极点分布图，并检验系统的稳定性。
x(n)
b? b b
y(n)
a? a
z1
题18图
19°.假设滤波器的系统函数为
H(z)=5-2-32
在单位圆上采样六点，选择r=0.95,试画出它的频率采样结构，并在计算机上用DFT求
出频率采样结构中的有关系数。
20.已知FIR滤波器的系统函数为：
(1)H(z)=1+0.8z1+0.65z?2
(2) H(z)=1-0.6z1+0.825z2-0.9z
试分别画出它们的直接型结构和格型结构，并求出格型结构的有关参数。
21.假设FIR格型网络结构的参数k?=-0.08,k?=0.217,k?=1.0,k?=0.5,求系
统的系统函数并画出FIR直接型结构。
22.假设系统的系统函数为
H(z)=1+2.88z1+3.4048z2+1.74z3+0.4z
要求：
(1)画出系统的直接型结构以及描述系统的差分方程；
(2)画出相应的格型结构，并求出它的系数；
(3)判断系统是否为最小相位系统。
174
Created by ZhuangHeng
第6章
无限脉冲响应数字滤波器的设计
6.1 数字滤波器的基本概念
所谓数字滤波器，是指输人、输出均为数字信号，通过数值运算处理改变输入信号所
含频率成分的相对比例，或者滤除某些频率成分的数字器件或程序。因此，数字滤波的概
念和模拟滤波相同，只是信号的形式和实现滤波方法不同。正因为数字滤波通过数值运算
实现滤波，所以数字滤波器处理精度高、稳定、体积小、重量轻、灵活、不存在阻抗匹配问
题，可以实现模拟滤波器无法实现的特殊滤波功能。如果要处理的是模拟信号，可通过
A/DC和D/AC,在信号形式上进行匹配转换，同样可以使用数字滤波器对模拟信号进行
滤波。
第6章
1.数字滤波器的分类
按照不同的分类方法，数字滤波器有许多种类，但总起来可以分成两大类：经典滤波
器和现代滤波器。经典滤波器的特点是其输入信号中有用的频率成分和希望滤除的频率成
分各占有不同的频带，通过一个合适的选频滤波器滤除干扰，得到纯净信号，达到滤波的
目的。例如，输入信号x(t)中含有干扰，其时域波形和频谱图分别如图6.1.1(a)、(b)所
示，由图可见，信号和干扰的频带互不重叠，可用图6.1.1(c)所示低通滤波器滤除干扰，
无限脉冲响应数字滤波器的设计
得到纯信号，如图6.1.1(d)所示。
但是，如果信号和干扰的频谱相互重叠，则经典滤波器不能有效地滤除干扰，最大限
度地恢复信号，这时就需要现代滤波器，例如维纳滤波器、卡尔曼滤波器、自适应滤波器等
最佳滤波器。现代滤波器是根据随机信号的一些统计特性，在某种最佳准则下，最大限度
地抑制干扰，同时最大限度地恢复信号，从而达到最佳滤波的目的。本书仅介绍经典滤波器
175 Created by ZhuangHeng
口
口口
口口口口
口口
B口
口
数字信号处理(第五版)
10
x0 0
-100 0.05 0.1 0.15 0.2 0.25
t/s
(a)信号加噪声波形
1
幅度 0.5
0L0 50 100150 200 250300 350400 450500
f/Hz
(b)信号加噪声的频谱
1.5
1
幅度 0.5
0l
0 50100150200 250 300 350 400450500
f/Hz
(c)低通滤波器幅频特性
1
0
-1
0 0.05 0.1 0.15 0.2 0.25
1/s
(d)滤除噪声后的信号波形
图6.1.1 用经典滤波器从噪声中提取信号
的设计分析与实现方法，而现代滤波器属于随机信号处理范畴，已超出本书学习范围。
经典数字滤波器从滤波特性上分类，可以分成低通、高通、带通和带阻等滤波器。它们
的理想幅频特性如图6.1.2所示。这种理想滤波器是不可能实现的，因为它们的单位脉冲
1IH(e1")I 1IH(e")I
0 π 2π② 0 π 2π @
(a)低通 (b)高通
11H(el)I 1IH(em)I
0 π 2π @ 0 π 2π @
(c)带通 (d)带阻
图6.1.2 理想低通、高通、带通和带阻滤波器幅度特性
176
Created by ZhuangHeng
响应均是非因果且无限长的，我们只能按照某些准则设计滤波器，使之在误差容限内逼近
理想滤波器，理想滤波器可作为逼近的标准。另外，需要注意的是，数字滤波器的频率响应
函数H(e")都是以2π为周期的，低通滤波器的通频带中心位于2π的整数倍处，而高通滤
波器的通频带中心位于π的奇数倍处，这一点和模拟滤波器是有区别的。一般在数字频率
的主值区[一π,π]描述数字滤波器的频率响应特性。
数字滤波器从实现的网络结构或者从单位脉冲响应长度分类，可以分成无限长单位脉
冲响应(IIR)滤波器和有限长单位脉冲响应(FIR)滤波器。它们的系统函数分别为：
Hs)=∑hns
(6.1.1)
(6.1.2)
(6.1.1)式中的H(z)称为N阶IIR数字滤波器系统函数；(6.1.2)式中的H(z)称为N-1
阶FIR数字滤波器系统函数。这两种数字滤波器的设计方法有很大区别，因此下面分成两
章分别进行学习。
根据滤波器对信号的处理作用又将其分为选频滤波器和其他滤波器。上述低通、高通、
带通和带阻滤波器均属于选频滤波器，其他滤波器有微分器、希尔伯特变换器、频谱校正
等滤波器。
滤波器可用于波形形成、调制解调器、从噪声中提取信号(见图6.1.1)、信号分离和信
道均衡等。所以学习滤波器的设计与实现是必不可少的。运行本书程序集中的绘图程序
fig611b.m可以清楚地观察用滤波器分离载波频率不同的两路双边带信号的原理。
2.数字滤波器的技术指标
常用的数字滤波器一般属于选频滤波器。假设数字滤波器的频率响应函数H(e")用下
式表示：
H(e”)=|H(e)|e
式中，|H(e")|称为幅频特性函数；θ(w)称为相频特性函数。幅频特性表示信号通过该滤
波器后各频率成分振幅衰减情况，而相频特性反映各频率成分通过滤波器后在时间上的延
时情况。因此，即使两个滤波器幅频特性相同，而相频特性不同，对相同的输入，滤波器输
出的信号波形也是不一样的。一般选频滤波器的技术指标由幅频特性给出，对几种典型滤
波器(如巴特沃斯滤波器),其相频特性是确定的，所以设计过程中，对相频特性一般不作
要求。但如果对输出波形有要求，则需要考虑相频特性的技术指标，例如波形传输、图像信
号处理等。本章主要研究针对幅频特性指标的选频滤波器设计。如果对输出波形有严格要
求，则需要设计线性相位数字滤波器，这部分内容在第7章介绍。
第6章无限脉冲响应数字滤波器的设计
对于图6.1.2所示的各种理想滤波器，我们必须设计一个因果可实现的滤波器去近似
实现。另外，也要考虑复杂性与成本问题，因此实用中通带和阻带中都允许一定的误差容
限，即通带不是完全水平的，阻带不是绝对衰减到零。此外，按照要求，在通带与阻带之间
177
Created by ZhuangHeng
数字信号处理(第五版)
178
还应设置一定宽度的过渡带。
图6.1.3表示低通滤波器的幅频特性，w。和w,分别称为通带边界频率和阻带截止频
率。通带频率范围为0≤lw|≤w,在通带中要求(1-δ?)<|H(e)|≤1,阻带频率范围为
w,≤lw|≤π,在阻带中要求|H(e")|≤δ?。从w。到w,称为过渡带，过渡带上的频响一般是
单调下降的。通常，通带内和阻带内允许的衰减一般用分贝数表示，通带内允许的最大衰
减用a,表示，阻带内允许的最小衰减用a,表示。对低通滤波器，a和a,分别定义为：
=2018mx|He)dB o≤1ml< (6.1.3a)
a.=2018疆带中max H) (6.1.4a)
显然，a,越小，通带波纹越小，通带逼近误差就越小；a,越大，阻带波纹越小，阻带逼近误
差就越小；u。与w,间距越小，过渡带就越窄。所以低通滤波器的设计指标完全由通带边界
频率a,、通带最大衰减αp、阻带边界频率w,和阻带最小衰减a,确定。
片段常数特性：对于选频型滤波器，一般对通带和阻带内的幅频响应曲线形状没有具
体要求，只要求其波纹幅度小于某个常数，通常将这种要求称为“片段常数特性”。所谓片
段，是指“通带”和“阻带”,常数是指“通带波纹幅度δ,”和“阻带波纹幅度δ?”,而通带最大
衰减a。和阻带最小衰减a,是与δ,和δ?完全等价的两个常数。片段常数特性概念在选频型
滤波器设计中很重要，尤其有助于理解IIR数字滤波器的双线性变换设计思想。
对图6.1.3所示的单调下降幅频特性，a,和a,分别可以表示为
=201gHdB (6.1.3b)
a.=201gH)aB (6.1.4b)
1
1-8
1/√2
H(em)
8?
00 ,@ @
图6.1.3 低通滤波器的幅频特性指标示意图
如果将|H(e°)|归一化为1,(6.1.3b)和(6.1.4b)式则表示为：
a=-20 lg|HCe)|dB (6.1.5)
a.=-20 lg|H(e")|dB (6.1.6)
Created by ZhuangHeng
当幅度下降到√2/2时，标记w=w.,此时α=-20 lg|H(e)|=3 dB,称w。为3 dB通带截
止频率。wp、w.和w,统称为边界频率，它们是滤波器设计中所涉及的很重要的参数。对其
他类型的滤波器，(6.1.3b)式和(6.1.4b)式中的H(e°)应改成H(e),o。为滤波器通带中
心频率。
3.数字滤波器设计方法概述
IIR滤波器和FIR滤波器的设计方法完全不同。IIR 滤波器设计方法有间接法和直接
法，间接法是借助于模拟滤波器的设计方法进行的。其设计步骤是：先设计过渡模拟滤波
器得到系统函数H,(s),然后将H(s)按某种方法转换成数字滤波器的系统函数H(z)。这
是因为模拟滤波器的设计方法已经很成熟，不仅有完整的设计公式，还有完善的图表和曲
线供查阅；另外，还有一些典型的优良滤波器类型可供我们使用。直接法直接在频域或者
时域中设计数字滤波器，由于要解联立方程，设计时需要计算机辅助设计。FIR滤波器不
能采用间接法，常用的设计方法有窗函数法、频率采样法和切比雪夫等波纹逼近法。
对于线性相位滤波器，经常采用FIR滤波器。可以证明，FIR滤波器的单位脉冲响应
满足一定条件时，其相位特性在整个频带是严格线性的，这是模拟滤波器无法达到的。当
然，也可以采用IIR滤波器，但必须使用全通网络对其非线性相位特性进行校正，这样增加
了设计与实现的复杂性。
本章只介绍IIR 滤波器的间接设计方法。为此，我们先介绍模拟低通滤波器的设计，这
是因为低通滤波器的设计是设计其他滤波器的基础。模拟高通、带通和带阻滤波器的设计
过程是：先将希望设计的各种滤波器的技术指标转换为低通滤波器技术指标，然后设计相
应的低通滤波器，最后采用频率转换法将低通滤波器转换成所希望的各种滤波器。
应当说明，滤波器设计公式较多，计算繁杂。但是，在计算机普及的今天，各种设计方
法都有现成的设计程序(或设计函数)供我们调用。所以，只要掌握了滤波器基本设计原理，
在工程实际中采用计算机辅助设计滤波器是很容易的事。
6.2 模拟滤波器的设计
模拟滤波器的理论和设计方法已发展得相当成熟，且有多种典型的模拟滤波器供我们
选择，如巴特沃斯(Butterworth)滤波器、切比雪夫(Chebyshev)滤波器、椭圆(Ellipse)滤波
器、贝塞尔(Bessel)滤波器等。这些滤波器都有严格的设计公式、现成的曲线和图表供设计
人员使用，而且所设计的系统函数都满足电路实现条件。这些典型的滤波器各有特点：巴
特沃斯滤波器具有单调下降的幅频特性；切比雪夫滤波器的幅频特性在通带或者阻带有等
波纹特性，可以提高选择性；贝塞尔滤波器通带内有较好的线性相位特性；椭圆滤波器的
选择性相对前三种是最好的，但通带和阻带内均呈现等波纹幅频特性，相位特性的非线性
也稍严重。设计时，根据具体要求选择滤波器的类型。
第6章无限脉冲响应数字滤波器的设计
选频型模拟滤波器按幅频特性可分成低通、高通、带通和带阻滤波器，它们的理想幅
179
Created by ZhuangHeng
数字信号处理(第五版)
频特性如图6.2.1所示。但设计滤波器时，总是先设计低通滤波器，再通过频率变换将低
通滤波器转换成希望类型的滤波器。下面先介绍低通滤波器的技术指标和逼近方法，然后
分别介绍巴特沃斯滤波器和切比雪夫滤波器的设计方法。椭圆滤波器的设计理论比较复
杂，所以只介绍其MATLAB设计函数，并举例说明直接调用MATLAB函数设计椭圆滤
波器的方法。其他滤波器的设计方法请参考文献[9]。
IH,GD)I IIH,G9)t
0 Q 0 Q
(a)低通 (b)高通
IH,GO) 11B,GD)I
0 O 0 Q
(c)带通 (d)带阻
图6.2.1 各种理想模拟滤波器幅频特性
6.2.1 模拟低通滤波器的设计指标及逼近方法
本书中，分别用h。(t)、H(s)、H?Gj2)表示模拟滤波器的单位冲激响应、系统函数、频
率响应函数，三者的关系如下：
H,(s)=LT[h.(2)]=?h.(t)e"d
H,(ja)=FTLh,[2]=厂h.(2)ed
可以用h。(t)、H,(s)、H,(j2)中任一个描述模拟滤波器，也可以用线性常系数微分方程描
述模拟滤波器。但是设计模拟滤波器时，设计指标一般由幅频响应函数|H,(j2)|给出，而
模拟滤波器设计就是根据设计指标，求系统函数H(s)。
工程实际中通常用所谓的损耗函数(也称为衰减函数)A(Ω)来描述滤波器的幅频响应
特性，对归一化幅频响应函数(max|H.(j2)|=1,本书后面都是针对该情况，特别说明的
除外),A(Ω)定义如下(其单位是分贝，用dB表示):
A(Ω)=-20 IgIH?(j2)|=-10 lg|H,(j2)IdB (6.2.1)
应当注意，损耗函数A(2)和幅频特性函数|H(j2)|只是滤波器幅频响应特性的两种
描述方法。损耗函数的优点是对幅频响应|H,(j2)|的取值非线性压缩，放大了小的幅度，
从而可以同时观察通带和阻带频响特性的变化情况。二者的特点如图6.2.2所示。图
6.2.2(a)所示的幅频响应函数完全看不清阻带内取值较小(0.001以下)的波纹，而图6.2.2
(b)所示的同一个滤波器的损耗函数则能很清楚地显示出阻带-60 dB以下的波纹变化曲线。
180
Created by ZhuangHeng
另外，直接画出的损耗函数曲线图正好与幅频特性曲线形状相反，所以，习惯将
-A(Ω)曲线称为损耗函数(本书中也如此称谓),如图6.2.2(b)所示。
1
0F
0.8 -20
HG 0.6
0.4 -A()dB -40
-60
0.2 -80
oL0 2000 40006000 8000
-100
0 2000 4000 60008000
f/Hz f/Hz
(a)幅频特性曲线 (b)损耗函数曲线
图6.2.2 幅频响应与损耗函数曲线的比较
模拟低通滤波器的设计指标参数有ap、2、a,和Ω。其中Ω和Ω,分别称为通带边界
频率和阻带截止频率，a。称为通带最大衰减(即通带[0,2]中允许A(Ω)的最大值),a,称
为阻带最小衰减(即阻带Ω≥Ω,上允许A(Ω)的最小值),ap和a,的单位为dB。以上技术指
标如图6.2.3所示，图(a)以幅频特性描述，图(b)以损耗函数描述。
1
1-8 o4下
1/√2 IR"on1 -A(2)
-α. 6
0
0 a,Q Q 0 B,Q Q
Q Q
图6.2.3 模拟低通滤波器的设计指标参数示意图
由图6.2.3可见，对于单调下降的幅度特性，a。和a,可表示成：
a=-10 Ig|H.Gj2)|2 (6.2.2)
a,=-10 lgIH?(jΩ)I (6.2.3)
因为图6.2.3中|H,(Ω)|=1/√2,-20 lg|H,(jΩ)=3dB,所以Ω。称为3 dB截止频率。
δ?和8?分别称为通带和阻带波纹幅度，容易得到关系式：
ap=-20 Ig(1-8) (6.2.4)
a,=-20 lgo? (6.2.5)
滤波器的技术指标给定后，需要设计一个系统函数H,(s),希望其幅度平方函数
|H,(j2)|2满足给定的指标。一般滤波器的单位冲激响应为实函数，因此
第6章无限脉冲响应数字滤波器的设计
181
Created by ZhuangHeng
口
口
口口
口口
■口
口口
口
口
数字信号处理(第五版)
182
IH,(j2)2=H,(s)H(-s)n=H,(j2)H(j2) (6.2.6)
如果能由αp、、a,和Ω,求出|H,(jΩ)2,那么就可以求出H,(s)H(-s),由此可求出所
需要的H,(s)。H?(s)必须是因果稳定的，因此极点必须落在s平面的左半平面，相应的
H?(-s)的极点必然落在右半平面。这就是由H(s)H(-s)求所需要的H?(s)的具体原
则，即模拟低通滤波器的逼近方法。因此幅度平方函数在模拟滤波器的设计中起着很重要
的作用。对于上面介绍的五种典型滤波器，其幅度平方函数都有确知表达式，可以直接
引用。
6.2.2 巴特沃斯低通滤波器的设计
1.巴特沃斯低通模拟滤波器设计原理
巴特沃斯低通滤波器的幅度平方函数|H,(j2)|2用下式表示：
B.o)P-+() (6.2.7)
式中，N称为滤波器的阶数。当Ω=0时，|H?Gj2)|=1;Ω=Ω。时，|H,(j2)|=1/√2,Ω
是3dB截止频率。在Ω=Ω附近，随Ω加大，幅度迅速下降。幅度特性与Ω和N的关系如
图6.2.4所示。幅度下降的速度与阶数N有关，N愈大，通带愈平坦，过渡带愈窄，过渡
带与阻带幅度下降的速度愈快，总的频响特性与理想低通滤波器的误差愈小。
以s替换j2,将幅度平方函数|H?(j2)|2写成s的函数：
B.OH(-1+() (6.2.8)
复变量s=a+j2,此式表明幅度平方函数有2N个极点，极点s,用下式表示：
s=(-1)*Gj0)=Ωe"() (6.2.9)
式中，k=0,1,2,…,2N-1。2N个极点等间隔分布在半径为Ω。的圆上(该圆称为巴特沃
斯圆),间隔是π/N rad。例如N=3,极点间隔为π/3 rad,如图6.2.5所示。
1
jQ
S Ss 0.8
1H.6r)1 0.6 N=8
0.4 N=4 S1 S4
N=2 0
0.2
0
0 Q 52
Ω
图6.2.4 巴特沃斯低通滤波器幅度特性与
n和N的关系
图6.2.5 三阶巴特沃斯滤波器极点分布图
Created by ZhuangHeng
为形成因果稳定的滤波器，2N个极点中只取s平面左半平面的N个极点构成H(s),
而右半平面的N个极点构成H(一s)。H,(s)的表达式为
-
(6.2.10)
设N=3,极点有6个，它们分别为
s=Ωe3,s?=-Ω,s?=Ωe
ss=Ae+,s=Ω,ss=ne
取s平面左半平面的极点s。、S1、S?组成系统函数H,(s),即
B.S=+a.)G-c-a.e5
由于不同的技术指标对应的边界频率和滤波器幅频特性不同，为使设计公式和图表统
一，将频率归一化。巴特沃斯滤波器采用对3 dB截止频率Ω。归一化，归一化后的系统函
数为
.)一) (6.2.11)
令p=η+jλ=s/Ω,λ=Ω/2,λ称为归一化频率，p称为归一化复变量，这样巴特沃斯滤波
器的归一化低通原型系统函数为
Bco-A) (6.2.12)
式中，p=s/Ω,为归一化极点，用下式表示：
p=e=(++) k=0,1,…,N-1 (6.2.13)
显然，
s,=Ωp (6.2.14)
这样，只要根据技术指标求出阶数N,按照(6.2.13)式求出N个极点，再按照(6.2.12)式
得到归一化低通原型系统函数G(p),如果给定Ω,再去归一化，即将p=s/Ω代入G(p)
中(或由(6.2.14)式求出s=Ω.p),便得到期望设计的系统函数H,(s)。
将极点表示式(6.2.13)代入(6.2.12)式，得到G(p)的分母是p的N阶多项式，用下
式表示： 第6章无限脉冲响应数字滤波器的设计 C.(D)=p+bp+b+…+b,p+b (6.2.15)
归一化原型系统函数G(p)的系数b,k=0,1,…,N-1,以及极点p,可以由表6.2.1
得到。另外，表中还给出了G.(p)的因式分解形式中的各系数，这样只要求出阶数N,查表
可得到G(p)及各极点，而且可以选择级联型和直接型结构的系统函数表示形式，避免了
因式分解运算工作。
183
Created by ZhuangHeng
数字信号处理(第五版)
表6.2.1 巴特沃斯归一化低通滤波器参数
184
极点位置
阶数N
Ps.n- P.n- Pi.N-r Po,N-1 P
1 -1.0000
2 -0.7071±j0.7071
3 -0.5000±j0.8660 -1.0000
4 -0.3827±j0.9239 -0.9239±j0.3827
5 -0.3090±j0.9511 -0.8090±j0.5878 -1.0000
6 -0.2588±j0.9659 -0.7071±j0.7071 -0.9659±j0.2588
7 -0.2225±j0.9749 -0.6235±j0.7818-0.9091±j0.4339 -1.0000
8 -0.1951±j0.9808 -0.5556±j0.8315 -0.8315±j0.5556 -0.9808±j0.1951
9 -0.1736±j0.9848 -0.5000±j0.8660 -0.7660±j0.6428 -0.9397±j0.3420 -1.0000
分母多项式
阶数N
B(p)=p*+bn-ipN-1+bn-zpN-2+…+b?p+b。
b? b? b? b bb h b
1 1.0000
2 1.4142 1.0000
3 2.0000 2.0000 1.0000
4 2.613 3.4142 2.6131 1.0000
5 3.2361 5.2361 3.2361 1.0000 5.2361
6 3.8637 7.4641 9.1416 7.4641 3.8637 1.0000
7 14.5918 10.0978 4.4940 4.4940 1.0000 10.0978 14.5918
8 13.1371 21.8462 25.6884 5.1258 1.0000 21.8642 13.1371 5.1258
9
分母因式
阶数N
41.9864 41.9864 31.1634 16.5817 5.7588 16.5817 31.1634 5.7588 1.0000
[ B(p)=B?(p)B?(p)…BMa|(p) 表示取大于等于 的最小整数
1 (p+1)
2 (p2+1.4142p+1)
3 (p2+p+1)(p+1)
4 (p2+0.7654p+1(p3+1.8478p+1)
5 (p2+0.6180p+D(p2+1.6180p+1D(p+1)
6 (p2+0.5176p+D(p2+1.4142p+1(p2+1.9319p+1)
7 (p2+0.4450p+D(p2+1.2470p+1)(p2+1.8019p+1)(p+1)
8 (p2+0.3902p+D(p2+1.1111p+1)(p2+1.6629p+1)(p2+1.9616p+1)
9 (p+0.3473p+D(p2+p+1(p2+1.5321p+1(p2+1.8974p+1)(p+1)
Created by ZhuangHeng
由(6.2.9)式和(6.2.10)式可知，只要求出巴特沃斯滤波器的阶数N和3 dB截止频率
Ω,就可以求出滤波器的系统函数H(s)。所以，巴特沃斯滤波器的设计实质上就是根据设
计指标求阶数N和3 dB截止频率2。的过程。下面先介绍阶数N的确定方法。
阶数N的大小主要影响通带幅频特性的平坦程度和过渡带、阻带的幅度下降速度，它
由技术指标Ω、ap、Ω,和a,确定。将Ω=Ω。代入幅度平方函数(6.2.7)式中，再将幅度平
方函数|H?(j2)|2代入(6.2.2)式，得到：
1+()-10 (6.2.16)
将Ω=Ω,代入(6.2.7)式中，再将[H,(j2)|2代入(6.2.3)式中，得到：
1+()=10 (6.2.17)
由(6.2.16)和(6.2.17)式得到：
)"-√
令
-
k=√
(6.2.18a)
(6.2.18b)
则N由下式表示：
N= (6.2.18c)
用上式求出的N可能有小数部分，应取大于或等于N的最小整数。关于3dB截止频率
Ω,如果技术指标中没有给出，可以按照(6.2.16)式或(6.2.17)式求出。由(6.2.16)式
得到：
Ω=2(10°?)k (6.2.19)
由(6.2.17)式得到：
n.=Ω,(10°18-1) (6.2.20)
请注意，如果采用(6.2.19)式确定Ω,则通带指标刚好满足要求，阻带指标有富余；如果
采用(6.2.20)式确定Ω,则阻带指标刚好满足要求，通带指标有富余。
总结以上，低通巴特沃斯滤波器的设计步骤如下：
(1)根据技术指标、a、Ω和a,用(6.2.18)式求出滤波器的阶数N。
(2)按照(6.2.13)式，求出归一化极点p,将p.代入(6.2.12)式，得到归一化低通原
型系统函数G(p)。也可以根据阶数N直接查表6.2.1得到p,和G,(p)。
(3)将G(p)去归一化。将p=s/Ω。代人G(p),得到实际的滤波器系统函数
H,(s)=G(p)|
方白中本后七口名
185
Created by ZhuangHeng
口
数字信号处理(第五版)
这里Ω为3 dB截止频率，如果技术指标没有给出Ω,可以按照(6.2.19)式或(6.2.20)式
求出。
【例6.2.1】已知通带截止频率f=5kHz,通带最大衰减a=2 dB,阻带截止频率
f,=12 kHz,阻带最小衰减a,=30 dB,按照以上技术指标设计巴特沃斯低通滤波器。
解(1)确定阶数N。
k=√o1=41.3223
入=2/。=2.4
N=I?412.223=4.25,取N=5
(2)按照(6.2.13)式，其极点为
p。=e,pp?=e3,p?=e
ps=e,p=e3
按照(6.2.12)式，归一化低通原型系统函数为
Do-)
上式分母可以展开成五阶多项式，或者将共轭极点放在一起，形成因式分解式。这里不如
直接查表6.2.1简单，由N=5直接查表得到：
极点：
-0.3090±j0.9511,-0.8090±j0.5878,-1.0000
归一化低通原型系统函数为
G.(p)=p+bp+bp3+bp2+b?p+bo
式中，bo=1.0000,b?=3.2361,b?=5.2361,b?=5.2361,b?=3.2361。
分母因式分解形式为
G.(p)=(p2+0.6180p+1)(p'+1.6180p+1D(p+1)
以上公式中的数据均取小数点后四位。
(3)为将G(p)去归一化，先求3 dB截止频率Ω。按照(6.2.19)式，得到：
n=Q。(10°1?)=2π×5.2755 krad/s
将Ω代入(6.2.20)式，得到：
a'=Ω(10.18-1)=2π×10.525 krad/s
此时算出的Ω'比题目中给的Ω,小，因此，过渡带小于指标要求。或者说，在Ω,=2π×12
krad/s时衰减大于30 dB,所以说阻带指标有富余量。
将p=s/Ω。代入G(p)中，得到：
186
Created by ZhuangHeng
H.(6)=+ba++?a+,s+ba
2.用MATLAB工具箱函数设计巴特沃斯滤波器
MATLAB信号处理工具箱函数buttap,buttord和 butter是巴特沃斯滤波器设计函
数。其5种调用格式如下。
·[Z,P,K]=buttap(N)
该格式用于计算N阶巴特沃斯归一化(3 dB截止频率Ω=1)模拟低通原型滤波器系统
函数的零、极点和增益因子。返回长度为N的列向量Z和P,分别给出N个零点和极点的
位置，K表示滤波器增益。得到的系统函数为如下形式：
G.(p)=kp-P(1)(p-P(2))…(p-P(N) (6.2.21)
式中，Z(k)和P(k)分别为向量Z和P的第k个元素。如果要从计算得到的零、极点得到系统
函数的分子和分母多项式系数向量B和A,可以调用结构转换函数[B,A]=zp2tf(Z,P,K)。
· [N,wc]=buttord(wp,ws,Rp,As)
该格式用于计算巴特沃斯数字滤波器的阶数N和3 dB截止频率wc。调用参数wp和ws
分别为数字滤波器的通带边界频率和阻带边界频率的归一化值，要求0≤wp≤1,0≤ws≤1,
1表示数字频率π(对应模拟频率F./2,F,表示采样频率)。Rp和As分别为通带最大衰减
和阻带最小衰减(dB)。当ws≤wp时，为高通滤波器；当wp和ws为二元矢量时，为带通
或带阻滤波器，这时wc 也是二元向量。N和we作为butter 函数的调用参数。
·[N,we]= buttord(wp,ws,Rp,As,'s')
该格式用于计算巴特沃斯模拟滤波器的阶数N和3 dB截止频率we。wp、ws和we是
实际模拟角频率(rad/s)。其他参数与格式2)相同。
·[B,A]=butter(N,wc,'ftype')
计算N阶巴特沃斯数字滤波器系统函数分子和分母多项式的系数向量B和A。调用参
数N和we分别为巴特沃斯数字滤波器的阶数和3 dB截止频率的归一化值(关于π归一
化),一般按格式2)调用函数buttord计算N和wc。由系数向量B和A可以写出数字滤波
器系统函数：
H(z)=A②)-BCD+B(2)+…+B(N)+AN+1)2 (6.2.22)
式中，B(k)和A(k)分别为向量B和A的第k个元素。
·[B,A]=butter(N,wc,'ftype','s') 第6章无限脉冲响应数字滤波器的设计
计算巴特沃斯模拟滤波器系统函数的分子和分母多项式的系数向量B和A。调用参数
N和 we分别为巴特沃斯模拟滤波器的阶数和3dB截止频率(实际角频率)。由系数向量B
和A写出模拟滤波器的系统函数为
H.(s)=AS)-B(1)s+B(2)s+…+B(N)s+BA(N+1) (6.2.23)
由于高通滤波器和低通滤波器都只有一个3dB截止频率wc,因此仅由调用参数wc不
187
Created by ZhuangHeng
口口
口
数字信号处理(第五版)
能区别要设计的是高通还是低通滤波器。当然仅由二维向量wc也不能区分带通和带阻。所
以用参数ftype来区分。ftype=high 时，设计3 dB截止频率为we的高通滤波器。缺省
ftype时默认设计低通滤波器。ftype=stop时，设计3dB截止频率为we的带阻滤波器，此
时 we为二元向量[wel,wcu],wel和wcu分别为带阻滤波器的通带3 dB下截止频率和上
截止频率。缺省 ftype时设计带通滤波器，通带为频率区间wcl<w<wcu。应当注意，设计
的带通和带阻滤波器系统函数是2N 阶的。这是因为带通滤波器相当于N阶低通滤波器与
N阶高通滤波器级联。
(6.2.21)、(6.2.22)和(6.2.23)式也适用于后面要介绍的切比雪夫和椭圆滤波器的
MATLAB设计函数。
【例6.2.2】 调用buttord和butter设计巴特沃斯低通模拟滤波器。要求与例6.2.1
相同。
设计程序ep622.m如下：
wp=2*pi*5000;ws=2*pi*12000;Rp=2;As=30;??置滤波器参数
[N, we]=buttord(wp, ws,Rp,As,'s'); ??算滤波器阶数N和3dB截止频率we
[B,A]=butter(N, we,'s'); ??算滤波器系统函数分子分母多项式系数
k=0:511;fk=0:14000/512:14000;wk=2*pi*fk;
Hk=freqs(B,A,wk);
subplot(2,2.1);
plot(fk/1000,20*log10(abs(Hk)));grid on
xlabelC'频率(kHz)');ylabel('幅度(dB))
axis([0,14,-40,5])
运行结果：
N=5,wc=3.7792e+004,B=7.7094e+022
A=[1 1.2230e+005 7.4785e+009 2.8263e+014 6.6014e+018 7.7094e+022]
将B和A代人(6.2.23)式写出系统函数为
H,(s)=+A(2)s'+AC3)s+A?)s2+A5)s+A?)
与例6.2.1计算结果形式相同。滤波器的损耗函数曲线如图6.2.6所示。
0
-10 ad()A- -20
-30
-400 3 69 12
f/kHz
图6.2.6 程序ep622.m运行输出的损耗函数(例6.2.1的设计结果)
188
Created by ZhuangHeng
由图可以看出，在f,=12 kHz时，衰减30 dB,即阻带刚好满足指标要求，通带指标有
富余。这就说明buttord函数使用(6.2.20)式计算3 dB截止频率。
6.2.3 切比雪夫滤波器的设计
1.切比雪夫滤波器的设计原理
巴特沃斯滤波器的频率特性曲线，无论在通带还是阻带都是频率的单调减函数。因此，
当通带边界处满足指标要求时，通带内肯定会有较大富余量。因此，更有效的设计方法应
该是将逼近精确度均匀地分布在整个通带内，或者均匀分布在整个阻带内，或者同时均匀
分布在两者之内。这样，就可以使滤波器阶数大大降低。这可通过选择具有等波纹特性的
逼近函数来达到。
切比雪夫滤波器的幅频特性就具有这种等波纹特性。它有两种形式：幅频特性在通带
内是等波纹的、在阻带内是单调下降的切比雪夫I型滤波器；幅频特性在通带内是单调下
降、在阻带内是等波纹的切比雪夫Ⅱ型滤波器。采用何种形式的切比雪夫滤波器取决于实
际用途。图6.2.7(a)和(b)分别画出不同阶数的切比雪夫I型和Ⅱ型滤波器幅频特性。
N=10 N=2
0.8- 0.8
N-5
糖度 0.6 0.6 糖度 N=3
04- N-6 0.4
0.2 N=4 0.2
% 05 1.5
归一化角频率
2 2.5 3 。0204 060.814 16 182
归一化角预率
(a)切比雪夫I型滤波器的幅频特性 (b)切比雪夫Ⅱ型滤波器的幅频特性
图6.2.7 不同阶数的切比雪夫I型和Ⅱ型滤波器幅频特性
我们这里仅介绍切比雪夫I型滤波器的设计方法。其幅度平方函数用|H,G2)2表示：
B.GoP-1+ec(A) (6.2.24)
式中，e为小于1的正数，表示通带内幅度波动的程度，e愈大，波动幅度也愈大；Ω。称为
通带截止频率。令λ=Ω/Q,称为对Ω的归一化频率。C(x)称为N阶切比雪夫多项式，
定义为
C(z)={ch(Narcha)Iz≥1
当N=0时，C。(x)=1;当N=1时，C?(x)=x;当N=2时，C?(x)=2x2-1;当
N=3时，C?(x)=4x3-3x。由此可归纳出高阶切比雪夫多项式的递推公式为
第6章无限脉冲响应数字滤波器的设计
189
Created by ZhuangHeng
口
口口
口
口口
口口口口口口
0口
数字信号处理(第五版)
令λ,=Ω,/Ω,由λ,>1,有
190
CN+:(x)=2xCN(x)-Cn-1(x) (6.2.25)
切比雪夫多项式的特性：
(1)切比雪夫多项式的过零点在|x|≤1的范围内；
(2)当|x|<1时，|C(x)|≤1,在|x|<1范围内具有等波纹性；
(3)当|x|>1时，CN(x)是双曲线函数，随x单调上升。
这样，当|x|≤1时，e3C、(x)在0至e2之间波动，函数1+e2C(x)的倒数即是幅度平
方函数|H?(j2)|2。所以|H,(j2)|2在[0,a]上有等波纹波动，最大值为1,最小值为
1/(1+e2)。当Q>Ω时，|H.Gj2)I2随Ω加大很快接近于零。图6.2.8分别画出了四阶切
比雪夫I型和巴特沃斯低通滤波器的幅频特性，显然，切比雪夫滤波器比巴特沃斯滤波器
有较窄的过渡带。
1
0.8
幅度 0.6
0.4
0.2
0l0 1 2 3
频率/kHz
图6.2.8 四阶切比雪夫I型和巴特沃斯低通滤波器的幅频特性比较
按照(6.2.24)式，幅度平方函数与三个参数(e、Ω、N)有关。其中e与通带内允许的
波动幅度有关，定义允许的通带内最大衰减a,用下式表示：
=1018mnBGi) IΩ|≤Ω
式中
max|H,Gj2)P2=1,min|H,Gj2)I2=1+e
因此
a=10 lg(1+e)
E2=10°-1
(6.2.26)
(6.2.27)
这样，根据通带内最大衰减ap,可以求出参数E。阶数N影响过渡带的宽度，同时也影响通
带内波动的疏密，因为N等于通带内最大值与最小值的总个数。设阻带的起始点频率(阻
带截止频率)用Ω,表示，在Ω,处的|H.GΩ2)|2用(6.2.24)式确定：
18.G)c() (6.2.28)
Created by ZhuangHeng
C.a)=ch(Narchà)=1√IHGia.)-1
可以解出
LiJnsa,- (6.2.29)
a.=a,ch{—arch[!√B.G2]-1]} (6.2.30)
3 dB截止频率用Ω。表示，
IH,Gia)I2=2
按照(6.2.24)式，有
eC(a)=1,λ=
通常取λ,>1,因此
CxCA)=±1=ch(Narch)
上式中仅取正号，得到3 dB截止频率计算公式：
a.=n,ch(#arch1) (6.2.31)
Ω,通常是设计指标给定的，由(6.2.27)和(6.2.29)式求出e和N后，可以求出滤波器的极
点，并确定归一化系统函数G.(p),p=s/Ω。下面略去繁杂的求解过程，仅介绍一些有用
的结论。
设H(s)的极点为s,=o,+jΩ,可以证明：
-
=1.2,3.…,N (6.2.32)
式中
= arsh1
hh-1
(6.2.33)
(6.2.34)
(6.2.33)式是一个椭圆方程，长半轴为Ωche(在虚轴上),短半轴为Ωshe(在实轴上)。令
b2。和aΩ,分别表示长半轴和短半轴，可推导出：
a=2(-g*) (6.2.35)
b=—(3+β*) (6.2.36)
式中
第6章无限脉冲响应数字滤波器的设计
191
Created by ZhuangHeng
口口
口
数字信号处理(第五版)
R=1+√+1 (6.2.37)
因此切比雪夫滤波器的极点就是一组分布在b。为长半轴、aΩ,为短半轴的椭圆上的点。
为因果稳定，用左半平面的极点构成G(p),即
co-) (6.2.38)
式中，c是待定系数。根据幅度平方函数(6.2.24)式可导出：c=e·2N-1,代入(6.2.38)式，
得到归一化的系统函数为
)c-) (6.2.39)
去归一化后的系统函数为
B.D-Cc)efa-) (6.2.40)
按照以上分析，归纳出切比雪夫I型滤波器设计步骤：
(1)确定技术指标参数a、Ωp、a。和Ω。ap是Ω=Ω。时的衰减，a,是Ω=Ω,时的衰
减，它们满足
o=10 1gH.GD) (6.2.41)
a,=101gH.G?.) (6.2.42)
这里ap就是前面定义的通带最大衰减，见(6.2.26)式。
(2)求滤波器阶数N和参数e。归一化边界频率为λp=1,λ=0,/Q。由(6.2.24)式
得到：
H.G?)=1+eCAC)
H.Gin)=1+eCAC.)
将以上两式代入(6.2.41)和(6.2.42)式，得到：
10°1=1+e2CNC?)=1+e2cos2(N arccos1)=1+e
10°=1+e2CN(a,)=1+e2ch2(N archλ.)
0=ch(Narch,)
令
k2=√o (6.2.43)
则ch[Narchà,]=ki1,因此
192
Created by ZhuangHeng
N=arch. (6.2.44)
这样，先由(6.2.43)式求出k?1,代入(6.2.44)式，求出阶数N,最后取大于或等于N的最
小整数。
按照(6.2.27)式求e:
e2=10°.-1 (6.2.45)
(3)求归一化系统函数G(p)。为求G.(p),先按照(6.2.32)式求出归一化极点p,
k=1,2,…,N。
p.=-chesin(2k2-N"+j chscos(2k2-N)" (6.2.46)
将极点p,代人(6.2.39)式，得到：
cc-A)
(4)将G(p)去归一化，得到实际的H?(s),即
H,(s)=G,(p)|-v/, (6.2.47)
【例6.2.3】 设计低通切比雪夫滤波器，要求通带截止频率f,=3kHz,通带最大衰减
a=0.1 dB,阻带截止频率f,=12 kHz,阻带最小衰减a,=60 dB。
解(1)滤波器的技术要求：
ap=0.1 dB,2=2πf,=6π krad/s
a,=60 dB,2,=2πf,=24π krad/s
A,=1,a.=余。=4
(2)由(6.2.44)和(6.2.45)式求阶数N和e:
N=arch,
k'=√1o1=6553
N=arcrc6553-9.46=4.6,取N=5
e=√10°?=√10°-1=0.1526
(3)将极点p、N和e代入(6.2.39)式求G.(p):
的中水长中
c-
由(6.2.46)式求出N=5时的极点p,,代入上式，得到：
c.(P)-2.42(P+0.5896+0.332p+1.1949)(P'+0.8720p+0.6359)
193
Created by ZhuangHeng
数字信号处理(第五版)
(4)将G(p)去归一化，得到：
H?(S)=G.(D)l,=(+1.0158×10)(9.+6.2788×10°+4.2455×105
+1.6437×10'+2.2594×10°5
2.用MATLAB设计切比雪夫滤波器
MATLAB信号处理工具箱函数cheblap、cheblord和chebyl是切比雪夫I型滤波器
设计函数。其调用格式如下：
·[z,p,k]=cheblap(N,Rp)
·[N,wpo]=cheblord(wp,ws,Rp,As)
·[N,wpo]= cheblord(wp,ws,Rp,As,'s')
·[B,A]=chebyl(N,Rp,wpo,'ftype')
·[B,A]=chebyl(N,Rp,wpo,'ftype','s')
切比雪夫I型滤波器设计函数与前面的巴特沃斯滤波器设计函数比较，只有两点不
同。一是这里设计的是切比雪夫I型滤波器；二是格式2)和3)的返回参数与格式4)和5)
的调用参数wpo是切比雪夫I型滤波器的通带截止频率，而不是3dB截止频率。其他参数
含义与巴特沃斯滤波器设计函数中的参数相同。系数向量B和A与数字和模拟滤波器系统
函数的关系由(6.2.22)和(6.2.23)式给出。
MATLAB信号处理工具箱函数cheb2ap、cheb2ord和cheby2是切比雪夫Ⅱ型滤波器
设计函数。其调用格式如下：
·[z,p,G]= cheb2ap(N,Rs)
该格式用于计算N阶切比雪夫Ⅱ型归一化(阻带截止频率Ω,=1)模拟低通滤波器系统
函数的零、极点和增益因子。返回长度为N的列向量z和p,分别给出N个零点和极点的
位置。G表示滤波器增益。Rs是阻带最小衰减(dB)。
·[N,wso]=cheb2ord(wp,ws,Rp,As)
该格式用于计算切比雪夫Ⅱ型数字滤波器的阶数N和阻带截止频率wso。调用参数
wp和ws分别为数字滤波器的通带边界频率和阻带边界频率的归一化值，要求0≤wp≤1,
0≤ws≤1,1表示数字频率π(对应模拟频率F,/2)。Rp和As分别为通带最大衰减和阻带
最小衰减(dB)。当ws≤wp时，为高通滤波器；当wp和ws为二元矢量时，为带通或带阻
滤波器，这时wso 也是二元向量。N和wso作为cheby2的调用参数。
·[N,wso]=cheb2ord(wp,ws,Rp,As,'s')
该格式用于计算切比雪夫Ⅱ型模拟滤波器的阶数N和阻带截止频率wso。wp、ws和
wso是实际模拟角频率(rad/s)。其他参数与格式2)相同。
·[B,A]=cheby2(N,As,wso,'ftype')
该格式用于计算N阶切比雪夫Ⅱ型数字滤波器系统函数的分子和分母多项式系数向量
B和A。调用参数N和wso分别为切比雪夫Ⅱ型数字滤波器的阶数和阻带截止频率的归一
194
Created by ZhuangHeng
化值(关于π归一化),一般调用函数cheb2ord计算N和wso。
·[B,A]=cheby2(N,As,wso,'ftype','s')
该格式用于计算N阶切比雪夫Ⅱ型模拟滤波器系统函数的分子和分母多项式系数向量
B和A。调用参数N和wso分别为N阶切比雪夫Ⅱ型模拟滤波器的阶数和阻带截止频率
(实际角频率)。
ftype的定义与巴特沃斯滤波器设计函数中的ftype相同。
【例6.2.4】设计切比雪夫I型和切比雪夫Ⅱ型模拟低通滤波器。要求与例6.2.3相同。
解 设计程序ep624.m如下：
??6.2.4设计程序：ep624.m
??计切比雪夫I型模拟低通滤波器
wp=2*pi*3000;ws=2*pi*12000;Rp=0.1;As=60;??置指标参数
[N1,wpl]=cheblord(wp,ws,Rp,As,'s);??算切比雪夫I型模拟低通滤波器阶数和通带
??界频率
[BI,Al]=chebyl(N1,Rp,wpl,'s');??算切比雪夫I型模拟低通滤波器系统函数系数
subplot(2,2,1);
fk=0:12000/512:12000;wk=2*pi fk;
Hk=freqs(B1,Al,wk):
plot(fk/1000,20*log10(abs(Hk)));grid on
xlabel(频率(kHz)');ylabelC'幅度(dB))
axis([0,12,-70,5])
??计切比雪夫Ⅱ型模拟低通滤波器(省略)
运行结果：
N=5
切比雪夫I型模拟低通滤波器通带边界频率：wpl=1.8850e+004
切比雪夫I型模拟低通滤波器系统函数分子分母多项式系数：
B1=9.7448e+020
A1=[13.2873e+004 9.8445e+008 1.6053e+013 1.8123e+017 9.7448e+020]
切比雪夫I型和Ⅱ型滤波器损耗函数分别如图6.2.9(a)和(b)所示。
0 0F
幅度/dB -20
-40 幅度/dB -20
-40 第6章无限脉冲响应数字滤波器的设计
-60 -60
0 5 10 0 5 10
频率/kHz 频率/kHz
(a)切比雪夫I型滤波器损耗函数 (b)切比雪夫Ⅱ型滤波器损耗函数
图6.2.9 五阶切比雪夫I型和Ⅱ型模拟低通滤波器损耗函数(例6.2.3的设计结果)
195
Created by ZhuangHeng
数字信号处理(第五版)
6.2.4 椭圆滤波器的设计
椭圆(Elliptic)滤波器在通带和阻带内都具有等波纹幅频响应特性。由于其极点位置与
经典场论中的椭圆函数有关，所以由此取名为椭圆滤波器。又因为在1931年考尔(Cauer)
首先对这种滤波器进行了理论证明，所以其另一个通用名字为考尔(Cauer)滤波器。椭圆滤
波器的典型幅频响应特性曲线如图6.2.10所示。由图6.2.10(a)可见，椭圆滤波器通带和
阻带波纹幅度固定时，阶数越高，过渡带越窄；由图6.2.10(b)可见，当椭圆滤波器阶数固
定时，通带和阻带波纹幅度越小，过渡带就越宽。所以椭圆滤波器的阶数N由通带边界频
率Ω、阻带边界频率Ω、通带最大衰减a。和阻带最小衰减a,共同决定。后面对五种滤波
器的比较将证实，阶数相同时，椭圆滤波器可以获得对理想滤波器幅频响应的最好逼近，
是一种性能价格比最高的滤波器，所以应用非常广泛。
1 1
N-4
N=3 1dB.la-20dB a.-1dB.a-10dB
0.8 0.8
a-0.1 dB.a-20dB
0.6 幅度 N=4 幅度 0.6 a-0.05dB,a-40dB
0.4 0.4
N6
0.2 0.2
% 0.5 15
归一化角频率
2 2.5 % 0.5 15 1
归一化角频率
2 2.5
(a)α,=1dB;α=20dB;N=3,4,6 (b)N=4:a,=1,0.1,0.05dB;α=10,20.40dB
图6.2.10 椭圆滤波器幅频响应特性曲线
椭圆滤波器逼近理论是复杂的纯数学问题，该问题的详细推导已超出本书的范围。只
要给定滤波器指标，通过调用MATLAB信号处理工具箱提供的椭圆滤波器设计函数，就
很容易得到椭圆滤波器系统函数和零极点位置。
MATLAB信号处理工具箱提供椭圆滤波器设计函数ellipap、ellipord和ellip。其调用
格式如下：
·[z,p,k]=ellipap(N,Rp,As)
用于计算N阶归一化(通带边界频率wp=1)模拟低通椭圆滤波器的零点向量 z、极点
向量p和增益因子k。Rp和As分别为通带最大衰减和阻带最小衰减(dB)。返回长度为N
的列向量z和p分别给出N个零点和N个极点的位置。
·[N,wpo]= ellipord(wp,ws,Rp,As)
用于计算满足指标的椭圆数字滤波器的最低阶数N和通带边界频率wpo,指标要求由
参数(wp,ws,Rp,As)给定。参数(wp,ws,Rp,As)的定义与巴特沃斯滤波器设计函数
buttord中的相应参数相同。
·[N,wpo]=ellipord(wp,ws,Rp,As,'s')
196
Created by ZhuangHeng
用于计算满足指标的椭圆模拟滤波器的最低阶数N和通带边界频率wpo。
·[B,A]=ellip(N,Rp,wpo,'ftype')
当wpo是表示滤波器通带边界频率的标量，而且缺省参数ftype时，该格式返回N阶
低通椭圆数字滤波器系统函数的分子和分母多项式系数向量B和A,滤波器通带波纹为
Rp dB;当 ftype=high时，返回N阶高通椭圆数字滤波器系统函数系数向量B和A。当
wpo是表示带通滤波器通带边界频率的二元向量，而且缺省参数ftype时，该格式返回2N
阶带通椭圆数字滤波器系统函数的分子和分母多项式系数向量B和A,滤波器通带波纹为
Rp dB。当ftype=stop时，返回2N 阶带阻椭圆数字滤波器系统函数系数向量B和A。二元
向量参数wpo表示阻带上下边界频率(关于π归一化)。
·[B,A]=ellip(N,Rp,wpo,'ftype','s')
计算椭圆模拟滤波器系统函数系数向量B和A。当然，其中的边界频率均为实际模拟
角频率值(rad/s)。
【例6.2.5】 设计椭圆模拟低通滤波器。要求与例6.2.3相同。设计程序ep625.m
如下：
??圆滤波器设计程序：ep625.m
wp=2*pi*3000;ws=2*pi*12000;Rp=0.1;As=60;??置指标参数
[N, wpo]=ellipord(wp,ws,Rp,As,'s);??算椭圆低通模拟滤波器阶数和通带边界频率
[B.A]=ellip(N,Rp,As,wpo,'s); ??算低通模拟滤波器系统函数系数
??去以下绘图部分
运行结果：
椭圆模拟低通滤波器阶数：N=4
模拟低通滤波器通带边界频率：wpo=1.8850e+004
椭圆模拟低通滤波器系统函数分子分母多项式系数：
B=[0.0010 -8.3913e-015 2.9126e+007 8.0051e-004 1.0859e+017]
A=[1 3.3792e+004 9.3066e+008 1.3646e+013 1.0984e+017]
滤波器损耗函数如图6.2.11所示。虽然本例中椭圆滤波器阶数是4,但从图6.2.11可
以看出，四阶椭圆模拟低通滤波器的过渡带宽度小于7kHz,比指标要求(9 kHz)窄
2 kHz。而例6.2.4中需要五阶切比雪夫模拟低通滤波器，且其过渡带宽度大于7kHz。对
于本例的设计指标，如果用巴特沃斯模拟低通滤波器，计算所要求的阶数N=7。
0
-20
幅度/dB -40
-60
-80
0 5 10
频率/kHz
图6.2.11 四阶椭圆模拟低通滤波器损耗
第6章无限脉冲响应数字滤波器的设计
197
Created by ZhuangHeng
□ oodd……………
口口口 0□□
0口
□口
数字信号处理(第五版)
6.2.5 五种类型模拟滤波器的比较
前面讨论了四种类型的模拟低通滤波器(巴特沃斯、切比雪夫I型、切比雪夫Ⅱ型和椭
圆滤波器)的设计方法，这四种滤波器是主要考虑逼近幅度响应指标的滤波器，第五种(贝
塞尔滤波器)是主要考虑逼近线性相位特性的滤波器。为了正确地选择滤波器类型以满足
给定的幅频响应指标，必须比较四种幅度逼近滤波器的特性。为此，下面比较相同阶数的
归一化巴特沃斯、切比雪夫I型、切比雪夫Ⅱ型和椭圆滤波器的频率响应特性。
调用MATLAB滤波器设计函数，很容易验证：当阶数相同时，对相同的通带最大衰
减a。和阻带最小衰减a,巴特沃斯滤波器具有单调下降的幅频特性，过渡带最宽。两种类
型的切比雪夫滤波器的过渡带宽度相等，比巴特沃斯滤波器的过渡带窄，但比椭圆滤波器
的过渡带宽。切比雪夫I型滤波器在通带具有等波纹幅频特性，过渡带和阻带是单调下降
的幅频特性。切比雪夫Ⅱ型滤波器的通带幅频响应几乎与巴特沃斯滤波器相同，阻带是等
波纹幅频特性。椭圆滤波器的过渡带最窄，通带和阻带均是等波纹幅频特性。
相位逼近情况：巴特沃斯和切比雪夫滤波器在大约3/4的通带上非常接近线性相位特
性，而椭圆滤波器仅在大约半个通带上非常接近线性相位特性。贝塞尔滤波器在整个通带
逼近线性相位特性，而其幅频特性的过渡带比其他四种滤波器宽得多。
复杂性：对前四种滤波器，在满足相同的滤波器幅频响应指标条件下，巴特沃斯滤波
器阶数最高，椭圆滤波器的阶数最低，而且阶数差别较大。所以，就满足滤波器幅频响应指
标而言，椭圆滤波器的性能价格比最高，应用较广泛。
由上述比较可见，五种滤波器各具特点。工程实际中选择哪种滤波器取决于对滤波器
阶数(阶数影响处理速度和实现的复杂性)和相位特性的具体要求。例如，在满足幅频响应
指标的条件下希望滤波器阶数最低时，就应当选择椭圆滤波器。
6.2.6 频率变换与模拟高通、带通、带阻滤波器的设计
高通、带通、带阻滤波器的幅频响应曲线及边界频率分别如图6.2.12(a)、(b)和(c)
所示。
IIHG2)I IH(2)1 11HsG2)I
1- 1- .1l
1-8
δ
0
Q A
8
0- Q?Q2QQ
8
0
Ω R.ΩQa
(a)高通滤波器 (b)带通滤波器 (c)带阻滤波器
图6.2.12 各种滤波器幅频特性曲线及边界频率示意图
|HGj2)|为偶函数，只画出正频率部分)
低通、高通、带通和带阻滤波器的通带最大衰减和阻带最小衰减仍用a。和a,表示。图
6.2.12中，Ω表示高通滤波器的通带边界频率；Ω和Ω分别表示带通和带阻滤波器的通
198
Created by ZhuangHeng
带下边界频率和通带上边界频率；Ω和Ω分别表示带通和带阻滤波器的阻带下边界频率
和阻带上边界频率。
从原理上讲，通过频率变换公式，可以将模拟低通滤波器系统函数Qp)变换成希望设
计的低通、高通、带通和带阻滤波器系统函数H(s)。在模拟滤波器设计手册中，各种经典
滤波器的设计公式都是针对低通滤波器的，并提供从低通到其他各种滤波器的频率变换公
式。所以，设计高通、带通和带阻滤波器的一般过程是：
(1)通过频率变换公式，先将希望设计的滤波器指标转换为相应的低通滤波器指标；
(2)设计相应的低通滤波器系统函数Q(p);
(3)对Qp)进行频率变换，得到希望设计的滤波器系统函数H?(s)。
设计过程中涉及的频率变换公式和指标转换公式较复杂，其推导更为复杂。幸好一些
学者已经开发出根据设计指标直接设计高通、带通和带阻滤波器的CAD程序函数，只要根
据设计指标直接调用CAD程序，就可以得到高通、带通和带阻滤波器系统函数。前面所提
到的MATLAB信号处理工具箱函数butter,cheby1,cheby2和ellip都具有这样的功能。
本节先简要介绍模拟滤波器的频率变换公式，再举例说明调用MATLAB信号处理工
具箱函数直接设计高通、带通和带阻滤波器的方法。对那些繁杂的设计公式推导不做叙述，
有兴趣的读者请参阅相关书籍[9]。
后面的设计举例将说明，如果低通滤波器Qp)是关于某边界频率的“归一化低通滤波
器”,则设计计算将大大简化。这里，“归一化低通滤波器”是指关于某个边界频率归一化的
低通滤波器，其系统函数就用Q(p)表示。归一化频率根据设计需要而定，对巴特沃斯滤波
器，关于3dB截止频率归一化的系统函数称为巴特沃斯归一化低通原型(记为G(p)),而
切比雪夫和椭圆滤波器的归一化低通原型一般是关于通带边界频率2,归一化的低通系统
函数(即Q(p)的通带边界频率为1)。
为了叙述方便，定义p=η+jà为Q(p)的归一化复变量，其通带边界频率记为λ,λ称
为归一化频率。用H?(s)表示希望设计的模拟滤波器的系统函数，s=a+j2表示H?(s)的
复变量。例如，一阶巴特沃斯低通原型系统函数为
G(p)=p+1
显然，其3dB截止频率λ。=1,是关于3dB截止频率归一化的。模拟滤波器设计手册中给
出了各种模拟滤波器归一化低通系统函数的参数(零、极点位置，分子、分母多项式系
数等)。
下面简单介绍各种频率变换公式。从p域到s域映射的可逆变换记为p=F(s)。低通
系统函数Qp)与H(s)之间的转换关系为
H?(s)=Q(p)|p=Fo
Qp)=H?(s)|-p1cp
(6.2.48)
(6.2.49)
1.模拟高通滤波器设计
从低通到高通滤波器的映射关系为
199 Created by ZhuangHeng
第6章无限脉冲响应数字滤波器的设计
■口口
口口口□□口
0口
数字信号处理(第五版)
p=AC (6.2.50)
在虚轴(频率轴)上该映射关系简化为如下频率变换公式：
λ=- (6.2.51)
式中，Ω为希望设计的高通滤波器Hp(s)的通带边界频率。频率变换公式(6.2.51)意味
着将低通滤波器的通带[0,λ。]映射为高通滤波器的通带[-∞,-Ω],而将低通滤波器的
通带[-λ,0]映射为高通滤波器的通带[Qm,○]。同样，将低通滤波器的阻带[λ。,○]映
射为高通滤波器的阻带[-Ω,0],而将低通滤波器的阻带[-,-λ,]映射为高通滤波器
的阻带[0,a]。映射关系式(6.2.50)确保低通滤波器Qp)通带[-λp,λp]上的幅度值出
现在高通滤波器H(s)的通带Ω≤|2|上。同样，低通滤波器Qp)阻带λ,≤la|上的幅度
值出现在高通滤波器HH(s)的阻带[-Ω,Ω]上。
所以只要将(6.2.50)式代入(6.2.48)式，就可将通带边界频率为λ。的低通滤波器的系
统函数Q(p)转换成通带边界频率为Ω的高通滤波器系统函数：
HHp(s)=G(p)|a (6.2.52)
【例6.2.6】 设计巴特沃斯模拟高通滤波器，要求通带边界频率为4kHz,阻带边界频
率为1 kHz,通带最大衰减为0.1 dB,阻带最小衰减为40 dB。
解(1)通过映射关系式(6.2.51),将希望设计的高通滤波器的指标转换成相应的低
通滤波器Qp)的指标。为了计算简单，一般选择Q(p)为归一化低通，即取Q(p)的通带边
界频率λ。=1。则由(6.2.51)式可求得归一化阻带边界频率为
A=1,A,==2π×1000=4
转换得到低通滤波器的指标为：通带边界频率λp=1,阻带边界频率A,=4,通带最大衰减
ap=0.1 dB,阻带最小衰减a,=40 dB。
(2)设计相应的归一化低通系统函数Q(p)。本例调用MATLAB函数buttord和
butter来设计Qp)。也可以仿照例6.2.1的设计，留作读者练习。
(3)用(6.2.48)式和(6.2.50)式将Q(p)转换成希望设计的高通滤波器的系统函数
Hp(s)。本例调用MATLAB函数lp2hp实现低通到高通的变换。Ip2hp函数的功能可用
help命令查阅。[BH,AH]=lp2hp(B,A,wph)将系统函数分子和分母系数向量为B和A
的低通滤波器变换成通带边界频率为 whp的高通滤波器，返回结果BH和AH是高通滤波
器系统函数分子和分母的系数向量。实现步骤(2)和(3)的程序ep626.m如下：
??6.2.6设计巴特沃斯模拟高通滤波器程序：ep626.m
wp=1:ws=4;Rp=0.1:As=40; ??置低通滤波器指标参数
[N, we]=buttord(wp,ws,Rp,As,'s);??算低通滤波器Q(p)的阶数N和3dB截止频率we
[B,A]=butter(N, we,'s); ??算低通滤波器系统函数Q(p)的分子分母多项式系数
??拟高通滤波器通带边界频率wph wph=2*pi*4000;
[BH,AH]=lp2hp(B,A.wph); ??通到高通转换
200
Created by ZhuangHeng
由系数向量B和A写出归一化低通系统函数为
Q(p)=p+5.1533p'+13.278p+2.145p2+20.8101p+10.2405
由系数向量BH和AH写出希望设计的高通滤波器系统函数为
Hm(s)=+5.1073×4×70+1.30425146×+2.054×19393+2.5678×+10.94+9.7921×10
Q(p)和HHp(s)的损耗函数曲线如图6.2.13所示。
0F 0[
-20 -20
幅度/dB -40 幅度/dB -40
-60 -60
-800 2 46 8 10
-80l0 1000 2000 3000 4000 5000 6000
归一化频率 频率/Hz
(a)归一化低通滤波器Qp) (b)高通滤波器Ho(s)
图6.2.13 例6.2.6所得低通、高通滤波器损耗函数曲线
值得注意的是，实际上调用函数buttord和butter可以直接设计巴特沃斯高通滤波器。
设计程序ep626b.m如下：
??6.2.6直接设计巴特沃斯模拟高通滤波器程序：ep626b.m
wp=2*pi*4000;ws=2*pi-1000;Rp=0.1;As=40; ??置高通滤波器指标参数
[N, we]=buttord(wp, ws,Rp,As,'s');??算高通滤波器阶数N和3 dB截止频率
[BH,AH]=butter(N, we,'high','s');??算高通滤波器系统函数H(s)分子分母多项式
??数
程序运行结果：
N=5
BH=[1 0000 0]
AH=[1 5.1073e+004 1.3042e+009 2.0584e+013 2.0078e+017 9.7921e+020]
分母多项式系数向量AH与程序ep626.m的运行结果相同。但是，分子多项式系数向
量BH与程序ep626.m的运行结果有较大差别，这是由运算误差引起的。由于butter 函数
采用了归一化处理，所以计算误差小。本程序所得分子多项式系数向量BH与理论设计结
果相同。所以实际中应当用程序p626b.m设计高通滤波器。由BH和AH写出希望设计的
高通滤波器系统函数：
H(s)=+5.1073×10's+1.3042×10°s3+2.0584×10"s+2.0078×101?s+9.7921×10
2.低通到带通的频率变换
低通到带通的频率变换公式如下：
第6章无限脉冲响应数字滤波器的设计
201
Created by ZhuangHeng
口口
口口
口
口口
口
口口
数字信号处理(第五版)
p=x. (6.2.53)
在p平面与s平面虚轴上的频率关系为
λ=-λBa (6.2.54)
式中，B=Ω-Q,表示带通滤波器的通带宽度，Ω和Ω分别为带通滤波器的通带下截
止频率和通带上截止频率；Ω。称为带通滤波器的中心频率。根据式(6.2.54)的映射关系，
频率λ=0映射为频率Ω=±2,频率λ=λ,映射为频率Ω和-Ω,频率λ=-λ。映射为频
率-Ω和Ω。也就是说，将低通滤波器G(p)的通带[-A,λ,]映射为带通滤波器的通带
[-Ω,-Ω]和[Ω,]。同样道理，频率λ=λ,映射为频率Ω和-Ω,频率λ=-λ。映
射为频率-Ω和Ω。所以将式(6.2.53)带入式(6.2.48),就将Q(p)转换为带通滤波器的
系统函数，即
Hm(S)=Q(p)1 (6.2.55)
可以证明
Q=QQ= (6.2.56)
所以，带通滤波器的通带(阻带)边界频率关于中心频率Ω。几何对称。如果原指标给定的边
界频率不满足式(6.2.56),就要改变其中一个边界频率，以便满足式(6.2.56),但要保证
改变后的指标高于原始指标。具体方法是，如果Ω2m>ΩΩ,则减小Ω(或增大Ω)使
式(6.2.56)得到满足。具体计算公式为 = =
或 (6.2.57)
减小Ω使通带宽度大于原指标要求的通带宽度，增大Ω或减小Ω都使左边的过渡带宽度
小于原指标要求的过渡带宽度；反之，如果Ω<Ω2,则减小Ω(或增大Ω)使式
(6.2.56)得到满足。而且在关于中心频率Ω。几何对称的两个正频率点上，带通滤波器的幅
度值相等。综上所述，低通到带通的边界频率及幅频响应特性的映射关系如图6.2.14所
11GG2)I
1
0 λ
1IH(2)I
-Q-Q-Q-0-Q 0 D00
图6.2.14 低通原型到带通的边界频率及幅频响应特性的映射关系
202
Created by ZhuangHeng
示，低通原型的每一个边界频率都映射为带通滤波器两个相应的边界频率。图中标出了设
计时有用的频率对应关系。请读者画出正频率部分的带通滤波器各边界频率与低通原型各
边界频率的对应关系。
【例6.2.7】 设计巴特沃斯模拟带通滤波器，要求通带上、下边界频率分别为4 kHz
和7kHz,阻带上、下边界频率分别为2kHz和9kHz,通带最大衰减为1 dB,阻带最小衰
减为20 dB。
解 所给带通滤波器指标为：
fu=4kHz,fm=7kHz,ap=1 dB
fa=2kHz,f=9kHz,a,=20 dB
ffm=4000×7000=28×10?
faf。=2000×9000=18×10?
因为fufm>faf,所以不满足(6.2.56)式。按照(6.2.57)式增大f,则
f=r29×10°=3.111 kHz
采用修正后的f,按如下步骤设计巴特沃斯模拟带通滤波器。
①通过映射关系式(6.2.54),将希望设计的带通滤波器指标转换为相应的低通原型滤
波器Q(p)的指标。为了设计方便，一般选择Q(p)为归一化低通，即取Q(p)的通带边界频
率λ=1。因为λ=λ,的映射为-Ω,所以将λ,=1、λ=λ。和Q=-Q代入式(6.2.54)可求
得归一化阻带边界频率为
x.=PB.-23.-3.×3-1.9630
转换得到的归一化低通滤波器指标为：通带边界频率λ=1,阻带边界频率λ,=1.963,通
带最大衰减a=1 dB,阻带最小衰减a=20 dB。
②设计相应的归一化低通系统函数Qp)。设计过程与例6.2.1完全相同，留作读者
练习。
③用式(6.2.55)将Q(p)转换成所希望设计的带通滤波器系统函数H?(s)。
本例调用MATLAB函数buttord和butter 直接设计巴特沃斯模拟带通滤波器。设计
程序ep627.m如下：
??6.2.7设计巴特沃斯模拟带通滤波器程序：ep627.m
wp=2*pi*[4000,7000];ws=2*pi*[2000,9000];Rp=1;As=20;??置带通滤波器指标参数
[N,we]=buttord(wp, ws,Rp,As,'s'); ??算带通滤波器阶数N和3dB截止频率we
[BB,AB]=butter(N, we.'s'); ??算带通滤波器系统函数分子分母多项式系数向
??BB和AB
程序运行结果：
阶数：N=5
第6章无限脉冲响应数字滤波器的设计
203
Created by ZhuangHeng
数字信号处理(第五版)
204
系统函数分子多项式系数向量：
BB=1.0e+021*[000006.970300000]
系统函数分母多项式系数向量：
AB=[1 7.5625e+004 8.3866e+009 4.0121e+014 2.2667e+019 7.0915e+023
2.5056e+028 4.9024e+032 1.1328e+037 1.1291e+041 1.6504e+045]
由运行结果可知，带通滤波器是2N阶的。10阶巴特沃斯带通滤波器损耗函数曲线如
图6.2.15所示。
0
-20
幅度/dB -40
-60
-80L
0 5000 10000 15 000
频率/Hz
图6.2.15 例6.2.6巴特沃斯模拟带通滤波器损耗函数
3.低通到带阻的频率变换
低通到带阻的频率变换公式为
p=a+ (6.2.58)
在p平面与s平面虚轴上的频率变换关系为
λ=-. (6.2.59)
式中，B.=Ω-Ω,表示带阻滤波器的阻带宽度，Ω和Ω分别为带阻滤波器的阻带下截
止频率和阻带上截止频率；Ω。称为带阻滤波器的阻带中心频率。由(6.2.59)式知道，λ是
Ω的二次函数，从低通滤波器频率λ到带阻滤波器频率Ω为双值映射。
当λ从-0→-λ→-λ→0_时，①Ω从-Ω→-→-Ω→-○,形成如图
6.2.12(c)所示的带阻滤波器H(j2)在(-,-Ω)上的频响；②Ω从+Ω→+Ω→
+Ω→0+,形成Hs(j2)在[0+,2.]上的频响。
当λ从0+→λ→λ,→+时，①Ω从0-→-Ω→-Ω→-2,形成Hs(j2)在
[-Ω.0_]上的频响；②Ω从+0→+Ω→+→+Ω,形成Hs(j2)在[+Ω,∞]上
的频响。
所以将(6.2.58)式带入(6.2.48)式，就将阻带边界频率为λ。的低通原型滤波器Q(p)
转换为所希望的带阻滤波器的系统函数：
He(s)=G(p) (6.2.60)
Created by ZhuangHeng
与低通到带通变换情况相同，有
Ωam=ΩΩ= (6.2.61)
由于带阻滤波器的设计与带通滤波器的设计过程相同，因此下面仅举例说明调用
MATLAB函数直接设计模拟带阻滤波器的设计程序。
【例6.2.8】 分别设计巴特沃斯、椭圆模拟带阻滤波器，要求阻带上、下边界频率分别
为4kHz和7kHz,通带上、下边界频率分别为2kHz和9kHz,通带最大衰减为1 dB,阻
带最小衰减为20 dB。
解 所给带阻滤波器指标为
f=4 kHz,fm=7kHz,a,=20 dB;fn=2kHz,f=9kHz,ap=1dB
调用MATLAB函数buttord,butter,ellipord和ellip直接设计巴特沃斯带阻、椭圆带阻模
拟滤波器的设计程序ep628.m如下：
??6.2.8设计模拟带阻滤波器程序：ep628.m
wp=2*pi+[2000,9000]:ws=2*pi*[4000,7000];Rp=1:As=20:??置带阻滤波器指标参数
??计巴特沃斯模拟带阻滤波器
[Nb,we]=buttord(wp,ws,Rp,As,'s);??算带阻滤波器阶数N和3 dB截止频率
[BSb,ASb]=butter(Nb,we,'stop','s');??算带阻('stop)滤波器系统函数分子分母多项式系数
??计椭圆模拟带阻滤波器
[Ne, wep]=ellipord(wp,ws,Rp,As,'s');??算带阻滤波器阶数N和3dB截止频率
[BSe,ASe]=ellip(Ne,Rp,As,wep,'stop','s');??算带阻滤波器系统函数分子分母多项式系数
程序运行结果：
巴特沃斯模拟带阻滤波器阶数：Nb=5
巴特沃斯模拟带阻滤波器系统函数分子多项式系数向量：
BSb=1.0e+021*[00000 6.970300000]
巴特沃斯模拟带阻滤波器系统函数分母多项式系数向量：
ASb=[1 7.5625e+004 8.3866e+009 4.0121e+014 2.2667e+019 7.0915e+023
2.5056e+028 4.9024e+032 1.1328e+037 1.1291e+041 1.6504e+045]
椭圆模拟带阻滤波器阶数：Ne=3
椭圆模拟带阻滤波器系统函数分子多项式系数向量：
BSe=[1 -1.9827e-011 3.9765e+009 -0.0918 4.3956e+018 -6.1168e+007
1.3507e+027] 第6章无限脉冲响应数字滤波器的设计
椭圆模拟带阻滤波器系统函数分母多项式系数向量：
ASe=[1 6.9065e+004 5.3071e+009 2.2890e+014 5.8665e+018 8.4390e+022
1.3507e+027]
由运行结果可知，带阻滤波器也是2N阶的。10阶巴特沃斯带阻滤波器和6阶椭圆带阻滤
波器损耗函数分别如图6.2.16(a)和(b)所示。
205
Created by ZhuangHeng
口 口
口
口口
■着
口口
口
数字信号处理(第五版)
0 0
-20 -20
幅度/dB-40 幅度/dB -40
-60 -60
-80
030006000 9000 12 000 -80030006000 9000 12 000
频率/Hz 频率/Hz
(a)巴特沃思带阻滤波器 (b)椭圆带阻滤波器
图6.2.16 例6.2.8的巴特沃斯、椭圆模拟带阻滤波器损耗函数
6.3 用脉冲响应不变法设计IIR数字低通滤波器
利用模拟滤波器成熟的理论及其设计方法来设计IIR 数字低通滤波器是常用的方法。
设计过程是：按照数字滤波器技术指标要求设计一个过渡模拟低通滤波器H(s),再按照
一定的转换关系将H(s)转换成数字低通滤波器的系统函数H(z)。由此可见，设计的关键
问题就是找到这种转换关系，将s平面上的H,(s)转换成z平面上的H(z)。为了保证转换
后的H(z)稳定且满足技术指标要求，对转换关系提出两点要求：
(1)因果稳定的模拟滤波器转换成数字滤波器，仍是因果稳定的。我们知道，模拟滤波
器因果稳定的条件是其系统函数H(s)的极点全部位于s平面的左半平面；数字滤波器因
果稳定的条件是H(z)的极点全部在单位圆内。因此，转换关系应使s平面的左半平面映射
到z平面的单位圆内部。
(2)数字滤波器的频率响应模仿模拟滤波器的频响特性，s平面的虚轴映射为z平面的
单位圆，相应的频率之间呈线性关系。
将系统函数H(s)从s平面转换到z平面的常用方法有脉冲响应不变法和双线性变换
法。本节先研究脉冲响应不变法。
设模拟滤波器的系统函数为H,(s),相应的单位冲激响应是h,(t),H,(s)=
LT[h。(1)]。
LT[·]代表拉氏变换，对h.(1)进行等间隔采样，采样间隔为T,得到h.(nT),将
h(n)=h,(nT)作为数字滤波器的单位脉冲响应，那么数字滤波器的系统函数H(z)便是
h(n)的Z变换。因此脉冲响应不变法是一种时域逼近方法，它使h(n)在采样点上等于
h,(1)。但是，模拟滤波器的设计结果是H?(s),所以下面基于脉冲响应不变法的思想，导出
直接从H(s)到H(z)的转换公式。
设模拟滤波器H(s)只有单阶极点，且分母多项式的阶次高于分子多项式的阶次，将
H,(s)用部分分式表示：
206
Created by ZhuangHeng
H()=A (6.3.1)
式中s,为H(s)的单阶极点。将H?(s)进行逆拉氏变换，得到：
h,(2)=∑A,eu(2) (6.3.2)
式中，u(t)是单位阶跃函数。对h,(t)进行等间隔采样，采样间隔为T,得到：
h(n)=h,(nT)-ZAcaGT) (6.3.3)
对上式进行Z变换，得到数字滤波器的系统函数H(z),即
H(2)=A (6.3.4)
对比(6.3.1)和(6.3.4)式，H(s)的极点s,映射到≈平面的极点为e",系数A,不变。
下面我们分析从模拟滤波器转换到数字滤波器，s平面和z平面之间的映射关系，从而找到
这种转换方法的优缺点。这里以理想采样信号h,(1)作为桥梁，推导其映射关系。
设h.(t)的理想采样信号用h(t)表示，即
b,(t)=∑h.(1)8(t-nT)
对h(t)进行拉氏变换，得到：
A,(s)=5h.(2)e"d=[[Zh.()8(-nT)]e“d
=Zh.(nT)e
式中，h,(nT)是h(t)在采样点t=nT时的幅度值，它与序列h(n)的幅度值相等，即
h(n)=h(nT),因此得到：
H,(s)=∑h(n)e"=h(n"1=H(z)1 (6.3.5)
上式表明理想采样信号h,(2)的拉氏变换与相应的采样序列h(n)的Z变换之间的映射关系
可用下式表示： z=e” (6.3.6)
(6.3.6)式就是脉冲响应不变法对应的s平面到z平面的映射关系。设s=a+j2,z=re",
按照(6.3.6)式，得到re"=eTe"。由此得到：
-ar}
第6章无限脉冲响应数字滤波器的设计
(6.3.7)
207
Created by ZhuangHeng
由(6.3.7)式可见：
口
口
口
口
口口
u口
数字信号处理(第五版)
上面关系式说明，s平面的虚轴(o=0)映射为z平面的单位圆(r=1),s平面左半平面
(o<0)映射为z平面单位圆内(r<1),s平面右半平面映射为z平面单位圆外(r>1)。这说
明如果H,(s)因果稳定，转换后得到的H(z)仍是因果稳定的。
另外，注意到z=e"是一个周期函数，可写成
e"=e"eT=ee(a+p),M为任意整数
当σ不变，模拟频率Ω变化2π/T的整数倍时，映射值不变。或者说，将s平面沿着j2轴分
割成一条条宽为2π/T的水平带，每条水平面都按照前面分析的映射关系对应着整个z平
面。此时H(s)所在的s平面与H(z)所在的z平面的映射关系如图6.3.1所示。当模拟频
率Ω从-π/T变化到π/T时，数字频率w则从一π变化到π,且按照(6.3.7)式，w=AT,
即w与Ω之间呈线性关系。
jo jlm(2)
3π/T
π/T
-1 1
0 0 Re(z)
-π/T
-3π/T 2平面
s平面
图6.3.1 脉冲响应不变法s平面和z平面之间的映射关系
下面讨论数字滤波器的频响特性与模拟滤波器的频响特性之间的关系。因为h(n)=
h,(nT),由(2.4.2)和(2.4.3)式得到：
H(e")=÷∑H.(ia-j经) (6.3.8)
H(e)=÷∑H.(j-2n) (6.3.9)
上式说明，H(e")是H.Gj2)以2π/T为周期的周期延拓函数(对数字频率w,则是以2π为
周期)。如果原h。(t)的频带不是限于士π/T之间，则会在奇数π/T附近产生频谱混叠，对
应数字频率在w=±π附近产生频谱混叠。脉冲响应不变法的频谱混叠现象如图6.3.2所
示。这种频谱混叠现象会使设计出的数字滤波器在w=土π附近的频率响应特性程度不同
的偏离模拟滤波器在π/T附近的频率特性，严重时使数字滤波器不满足给定的技术指标。
为此，希望设计的模拟滤波器是带限滤波器，如果不是带限的，例如高通滤波器、带阻滤波
器，需要在高通和带阻滤波器之前加保护滤波器，滤除高于折叠频率π/T以上的频带，以
免产生频谱混叠现象。但这样会增加系统的成本和复杂性，因此，高通与带阻滤波器不适
合用这种方法设计。
208
Created by ZhuangHeng
11BH,G9)I
0
πT 2T Q
(a)
IH(e3")1
… …
-π o -3π-2π π2π 3π o=ΩT
(b)
图6.3.2 脉冲响应不变法的频谱混叠现象示意图
假设H(e")没有频谱混叠现象，即满足
H?Gj2)=0 al≥
由(6.3.9)式得到：
H(e)=H.(i号)wl<π (6.3.10)
上式说明，如果不考虑频谱混叠现象，用脉冲响应不变法设计的数字滤波器可以很好地重
现原模拟滤波器的频响特性。但是，H(e")的幅度与采样间隔成反比，当T很小时，
|H(e")|就会有太高的增益。为避免这一现象，令
h(n)=Th(nT)
那么
H(2)-IA (6.3.11)
(6.3.11)式称为实用公式，此时
H(e")=H.(j号)lwl<π (6.3.12)
H,(s)的极点s,一般是一个复数，且以共轭成对的形式出现，将(6.3.1)式中一对对复
数共轭极点s,和s,放在一起，形成一个二阶基本节。如果模拟滤波器的二阶基本节的形
式为
s+8°+ 极点为-a,±j2 (6.3.13) 第6章无良泳中响应数字虑波器的设计
可以推导出相应的数字滤波器二阶基本节(只有实数乘法)的形式为
1-2s.T+T (6.3.14)
如果模拟滤波器二阶基本节的形式为
s+a)2+ 极点为-σ,±jΩ (6.3.15)
209
Created by ZhuangHeng
口口
口
口口
数字信号处理(第五版)
则对应的数字滤波器二阶基本节的形式为
1-2zsaTT (6.3.16)
利用以上这些变换关系，可以简化设计，使实现结构中无复数乘法器。
综上所述，脉冲响应不变法的优点是频率变换关系是线性的，即w=ΩT,如果不存在
频谱混叠现象，用这种方法设计的数字滤波器会很好地重现原模拟滤波器的频响特性。另
外一个优点是数字滤波器的单位脉冲响应完全模仿模拟滤波器的单位冲激响应波形，时域
特性逼近好。但是，有限阶的模拟滤波器不可能是理想带限的，所以，脉冲响应不变法的最
大缺点是会产生不同程度的频谱混叠失真，其适合用于低通、带通滤波器的设计，不适合
用于高通、带阻滤波器的设计。
【例6.3.1】 已知模拟滤波器的系统函数H,(s)为
H.(s)=7+0.64595+0.707
用脉冲响应不变法将H(s)转换成数字滤波器的系统函数H(z)。
解 首先将H(s)写成部分分式：
H.(s)=s+0.32243220.772+s+0.32232290.772
极点为
S?=-(0.3224+j0.7772),s?=-(0.3224-j0.7772)
那么H(z)的极点为
=e,2=e3
按照(6.3.4)式，并经过整理，得到：
H(z)=1-2°32.720)772T
式中，T是采样间隔，若T选取过大，则会使w=π附近频谱混叠现象严重。这里选取T=
1s和T=0.1s两种情况，以便进行比较。设T=1s时用H?(z)表示，T=0.1s时用
H?(z)表示，则
H?(2)=1-1.0328.32760.5247
H?(z)=1-1.930704850.93752
转换时，也可以直接按照(6.3.14)、(6.3.16)式进行转换。首先将H(s)写成(6.3.15)式的
形式，令极点S?.=-o?±jΩ,则
H.(s)=0.5012+1+a=0.6449+a1)+
再按照(6.3.16)式，H(z)为
210
Created by ZhuangHeng
H(2)=0.64492T+
将T=1s、T=0.1s分别代入 H(z)中，得到H?(z)和H?(z),其结果和前面得到的
H?(z)、H?(z)完全一样。将H?(jΩ)、H?(e")和H?(e")的幅频特性用它们的最大值归一化
后，如图6.3.3所示。由图6.3.3(a)可见，模拟滤波器H,(s)通带很窄，但阻带衰减慢，拖
了很长的“尾巴”,不是带限滤波器。图6.3.3(b)表示的是两种采样间隔(T=0.1s,1s),转换
成数字滤波器的损耗函数，它的横坐标是对π归一化的数字频率。图6.3.3(a)、(b)两张图
的横坐标服从线性关系，即w=ΩT关系。按照这种关系，T=0.1 s时，图6.3.3(a)的A、
B、C、D、E点对应图(b)的a、b、c、d、e点；而T=1s时，图(a)的H、1、J点对应图(b)
的h、i、j点。显然，T=0.1s时，它们的幅度特性很相似，只是在折叠频率π(模拟频率是
10π=31.42 rad/s)附近有很轻的混叠现象。而对于T=1s情况，频率混叠现象很严重，原
模拟滤波器的J点幅度衰减近26 dB,而对应的数字滤波器的j点幅度衰减却只有18 dB,
J点的模拟频率只有3.142 rad/s,I点附近失真都很厉害。数字滤波器的幅度特性在w=π
以后又上升，是由于数字系统频响函数的周期性形成的。
0tH
0
h
-10F T -10 Z=is
-20 —20— 7-0.1s
幅度/dB -30 20 1gIH?(e3")I
-40 B
-50 C
幅度/dB -30 a
T=0.1s -40
D
b 20 1gIH?(e)
-60 E -50 ae
-7005 10 15 20 25 30
-60L
0 0.5 1 1.5 2
Q/(rad/s) o/π
(a) (b)
图6.3.3 例6.3.1中不同采样频率转换结果对比
【例6.3.2】 用脉冲响应不变法设计数字低通滤波器，要求通带和阻带具有单调下降
特性，指标参数如下：w,=0.2π rad,a=1 dB,w.=0.35π rad,a,=10 dB。
解 例6.3.1仅是将给定的模拟滤波器转换成数字滤波器，本例才是用脉冲响应不变
法设计数字滤波器。根据间接设计法的基本步骤求解。
(1)将数字滤波器设计指标转换为相应的模拟滤波器指标。设采样周期为T,由
(6.3.7)式得到： 第6章无限脉冲响应数字滤波器的设计
=“=0.2 rad/s,a=1dB
a.=学=0.35 rad/s,a,=10dB
(2)设计相应的模拟滤波器，得到模拟系统函数H,(s)。根据单调下降要求，选择巴特
沃斯滤波器。设计过程与例6.2.1完全相同，求出阶数N=4。求解计算留做读者练习。
211
Created by ZhuangHeng
数字信号处理(第五版)
(3)按照(6.3.1)和(6.3.11)式，将模拟滤波器系统函数H,(s)转换成数字滤波器系统
函数H(z):
H(3)=A,H(s)=iA,
如上求解计算相当复杂。本例调用MATLAB信号处理工具箱函数进行设计。设计程序
ep632.m如下。读者可以改变程序中的T值，观察T的大小与频谱混叠失真的关系。
??6.3.2用脉冲响应不变法设计数字滤波器程序：ep632.m
T=1; }1s
wp=0.2*pi/T;ws=0.35*pi/T;rp=1;rs=10;}1s的模拟滤波器指标
[N, we]=buttord(wp,ws,rp,rs,S);??算相应的模拟滤波器阶数N和3dB截止频率we
[B,A]=butter(N, we,s); ??算相应的模拟滤波器系统函数
[Bz,Az]=impinvar(B,A,1/T);??脉冲响应不变法将模拟滤波器转换成数字滤波器
省略绘图部分。
程序中，impinvar是脉冲响应不变法的转换函数，[Bz,Az]=impinvar(B,A,Fs)实
现用脉冲响应不变法将分子和分母多项式系数向量为B和A的模拟滤波器系统函数H,(s)
转换成数字滤波器的系统函数H(z),H(z)的分子和分母多项式系数向量为Bz和Az。Fs
为采样频率，缺省时，其值为1 Hz。
取T=1s时的运行结果：
N=4
模拟滤波器系统函数H(s)分子和分母多项式系数向量B和A:
B=[0000 0.4872]
A=[1.0000 2.1832 2.3832 1.5240 0.4872]
数字滤波器的系统函数H(z)分子和分母多项式系数向量Bz和Az:
Bz=[0 0.0456 0.1027 0.0154 0]
Az=[1.0000 -1.9184 1.6546 -0.6853 0.1127]
由Bz和Az写出数字滤波器系统函数：
H(z)=1-1.91845621.6546027-0.685315420.1127
T=1s时模拟滤波器和数字滤波器的损耗函数分别如图6.3.4(a)和(b)所示。
如果取T=0.1 s,运行程序得到的H(z)与T=1s的H(z)基本相同(保留四位小数),
模拟滤波器差别较大。这说明当给定数字滤波器指标时，采样间隔T的取值对频谱混叠程
度的影响很小(见后面解释)。所以，一般取T=1s使设计运算最简单。T=1s时，设计的
模拟滤波器和数字滤波器损耗函数曲线如图6.3.4(a)和(b)所示。T=0.1s时，设计的模
拟滤波器和数字滤波器损耗函数曲线如图6.3.4(c)和(d)所示。图中数字滤波器满足指标
要求，但是，由于频谱混叠失真，使数字滤波器在w=π(对应模拟频率F,/2 Hz)附近的衰
减明显小于模拟滤波器在f=F./2附近的衰减。
212
Created by ZhuangHeng
0 0
-10 -10
幅度/dB -20
-30 幅度/dB -20
-30
-40 -40
-500 0.1 0.2 0.3 0.4 -500 0.200.4 0.60.8 1
f/Hz @/π (a)模拟滤波器(T=1 s) (b)数字滤波器(T=1s)
0 0
-10 -10
幅度/dB -20
-30 幅度/dB -20
-30
-40 -40
-500 1 23 4 5
-500 0.2 0.40.6 0.8 1
f/Hz @/π
(c)模拟滤波器(T-=0.1 s) (d)数字滤波器(T-0.1 s)
图6.3.4 例6.3.2设计的模拟和数字滤波器的损耗函数
6.4 用双线性变换法设计IR数字低通滤波器
脉冲响应不变法的主要缺点是会产生频谱混叠现象，使数字滤波器的频响偏离模拟滤
波器的频响特性。产生的原因是模拟低通滤波器不是带限于折叠频率π/T,在离散化(采
样)后产生了频谱混叠，再通过映射关系 z=e",使数字滤波器在w=π附近形成频谱混叠。
为了克服这一缺点，可以采用非线性频率压缩方法，将整个模拟频率轴压缩到士π/T之间，
再用z=e”转换到z平面上。设H(s),s=j2,经过非线性频率压缩后用H(s?),s?=j2?
表示，这里用正切变换实现频率压缩：
a=?tan(2a,T) (6.4.1)
式中，T仍是采样间隔。当Ω?从-π/T经过0变化到π/T时，Ω则由一∞经过0变化
到十∞,实现了s平面上整个虚轴完全压缩到s?平面上虚轴的士π/T之间的转换。由
(6.4.1)式有
ia=?+e=2i+e
代人s=j2,s?=jΩ?,得到：
s=异+e (6.4.2)
再通过z=e''从s,平面转换到z平面上，得到：
213
Created by ZhuangHeng
第6章
无限脉冲响应数字滤波器的设计
口
口口
口口
只
口口
口
口
数字信号处理(第五版)
s=21 (6.4.3)
(6.4.4)
(6.4.3)式或(6.4.4)式称为双线性变换。从s平面映射到s,平面，再从s?平面映射到z平
面，其映射关系如图6.4.1所示。由于从s平面到s,平面的非线性频率压缩，使H(s?)带
限于π/T rad/s,因此再用脉冲响应不变法从s平面转换到z平面不可能产生频谱混叠现
象。这就是双线性变换法最大的优点。另外，从s?平面转换到z平面仍然采用转换关系
z=e?',s?平面的±π/T之间水平带的左半部分映射到z平面单位圆内部，虚轴映射为单
位圆，这样H,(s)因果稳定，转换成的H(z)也是因果稳定的。
jO
s平面 iQ jlm(z) s?平面 z平面
π/T
1
0 0
o -1 Re(2)
-π/T
图6.4.1 双线性变换映射关系示意图
下面分析双线性变换法的转换性能。先分析模拟频率Ω和数字频率。之间的关系。令
s=j2,z=e",并代入(6.4.3)式，得到：
ia=?+e
a=2tan (6.4.5)
上式说明，s平面上Ω与z平面的w成非线性正切关系，如图6.4.2所示。在w=0附近接
近线性关系；当w增加时，Ω增加得愈来愈快；当w趋近π时，Ω趋近于一。正是因为这种
非线性关系，消除了频谱混叠现象。
①
π
0
-π
图6.4.2 双线性变换法的频率关系
w与Ω之间的非线性关系是双线性变换法的缺点，使数字滤波器频响曲线不能保真地
模仿模拟滤波器的频响曲线形状。幅度特性和相位特性失真的情况如图6.4.3所示。这种
非线性影响的实质问题是：如果Ω的刻度是均匀的，则其映像w的刻度不是均匀的，而是
214
Created by ZhuangHeng
随w增加愈来愈密。因此，如果模拟滤波器的频响具有片段常数特性，则主要是数字滤波
器频响特性曲线的转折点频率值与模拟滤波器特性转折点的频率值成非线性关系。当然，
对于不是片段常数的相位特性仍有非线性失真。因此，双线性变换法适合片段常数特性的
滤波器的设计。实际中，一般选频滤波器的通带和阻带均要求是片段常数特性，因此双线
性变换法得到了广泛的应用。但在设计时，要注意边界频率(如通带截止频率、阻带截止频
率等)的转换关系要用(6.4.5)式计算。如果设计指标中边界频率以数字频率给出，则必须
按(6.4.5)式求出相应模拟滤波器的边界频率，将这种计算称为“预畸变校正”。只有这样，
才能保证将设计的H,(s)转换成H(z)后仍满足给定的数字滤波器技术指标。如果边界频
率以模拟频率给出，则设计过程见下小节例6.5.2和例6.5.3。
QΩ
Q Q
o
IB,G?)I00H(e") 0 ∠H,G2) 0- @
0
0 ∠H(e3")
图6.4.3 双线性变换法幅度和相位特性的非线性映射示意图
双线性变换法可由简单的代数公式(6.4.3)将H(s)直接转换成H(z),这是该变换
法的优点。但当阶数稍高时，将H(z)整理成需要的形式，也不是一件简单的工作。
MATLAB信号处理工具箱提供的几种典型的滤波器设计函数，用于设计数字滤波器时，
就是采用双线性变换法。所以，只要掌握了基本设计原理，工程实际中设计就非常容易。
【例6.4.1】试用脉冲响应不变法和双线性不变法将 R
图6.4.4所示的RC低通滤波器转换成数字滤波器。 o- o
解 首先按照图6.4.4写出该滤波器的系统函数 C
H,(s)为
H?(S)=,+a=RC 图6.4.4 简单RC低通滤波器
利用脉冲响应不变法转换，数字滤波器的系统函数H?(z)为
H?(z)=1e
利用双线性变换法转换，数字滤波器的系统函数H?(z)为
H?(z)=H,(S)142
=+2,a=T+2
第6章无限脉冲响应数字滤波器的设计
215
Created by ZhuangHeng
口 口
口口
口
数字信号处理(第五版)
设a=1000,T=0.001s和0.002 s,H?(z)和H?(z)的归一化幅频特性分别如图
6.4.5(b)和(c)所示。图6.4.5(a)是模拟滤波器幅频特性，是一个低通滤波器，但由于阶数
低，选择性差，拖了很长的尾巴。图6.4.5(b)是采用脉冲响应不变法转换成的数字滤波器
幅频特性曲线，图中w=π处对应的模拟频率与采样间隔T有关，当T=0.001s时，对应
的模拟频率为1/(2T)=500 Hz;当T=0.002s时，对应的模拟频率为250 Hz。对照图
6.4.5(a),图(b)所示的数字滤波器与原模拟滤波器的幅度特性差别很大，且频率愈高，差
别愈大。这是由频率混叠失真引起的。相对而言，T=0.001s时混叠少一些。图6.4.5(c)
是采用双线性变换法转换成的数字滤波器幅频特性曲线，由于该转换法的频率压缩作用，
使w=π处的幅度降为零，无频谱混叠。但曲线的形状与原模拟滤波器幅度特性曲线的形
状差别较大，这是由于该转换法的非线性造成的，T小一些，非线性的影响少一些。
1
0.8
噩
0.6
0.4
0.2
0
0 200 400 600 800 10 000
f/Hz
(a)
1 1
0.9 --T=0.001s 0.8 —T=0.002s
0.8 噩 0.7 噩 0.6
0.4 0.6
0.5 ---T-0.001s
—T-0.002s 0.2
0.40 0.2 0.40.6 0.8 1
0
0 0.2 0.4 0.6 0.8 1
o/π w/π
(b) (e)
图6.4.5 例6.4.1中H(s)、H?(z)和H?(z)的幅频特性
下面我们总结利用模拟滤波器设计IIR数字低通滤波器的步骤。
(1)确定数字低通滤波器的技术指标：通带边界频率w,、通带最大衰减a、阻带截止
频率w,、阻带最小衰减a,。
(2)将数字低通滤波器的技术指标转换成相应的模拟低通滤波器的技术指标。这里主
要是边界频率w。和w,的转换，a和a,指标不变。如果采用脉冲响应不变法，边界频率的
转换关系为
216
Created by ZhuangHeng
一
(6.4.6)
如果采用双线性变换法，边界频率的转换关系为
(6.4.7)
(3)按照模拟低通滤波器的技术指标设计过渡模拟低通滤波器。设计方法及设计步骤
参考本章6.2节。
(4)用所选的转换方法，将模拟滤波器H(s)转换成数字低通滤波器系统函数H(z)。
在设计过程中，要用到采样间隔T,下面介绍T的选择原则。如采用脉冲响应不变法，
为避免产生频率混叠现象，要求所设计的模拟低通带限于一π/T~π/T区间。由于实际滤
波器都是有限阶的，因此有一定宽度的过渡带，且频响特性不是带限于π/T。当给定模拟
滤波器H(s),要求单向转换成数字滤波器 H(z),且a。足够大时，选择T满足|Ω,|<
π/T,可使频谱混叠足够小，满足数字滤波器指标要求。但如果先给定数字低通的技术指标
时，情况则不一样。由于数字滤波器频响函数H(e")以2π为周期，最高频率在w=π处，
因此，w,<π,按照线性关系Ω,=w,/T,那么一定满足2,<π/T,这样T可以任选。一般选
T=1s。这时，频谱混叠程度完全取决于a,a,越大，混叠越小。对双线性变换法不存在频
谱混叠现象，尤其对于设计片段常数滤波器，T也可以任选。为了简化计算，一般取
T=2s。
【例6.4.2】 设计低通数字滤波器，要求频率低于0.2π rad时，容许幅度误差在1 dB
以内；在频率0.3π到π之间的阻带衰减大于15 dB。指定模拟滤波器采用巴特沃斯低通滤
波器。试用双线性变换法设计数字滤波器。
解(1)数字低通技术指标为
。=0.2π rad,ap=1 dB
w,=0.3π rad,a,=15 dB
(2)为了计算简单，取T=1s,预畸变校正计算相应模拟低通的技术指标为
a=2tan=2 tan0.1π=0.6498 rad/s,a=1dB
n.=2tan=2 tan0.15m=1.0191 rad/s,a,=15dB
(3)设计巴特沃斯低通模拟滤波器。根据(6.2.18)式阶数N计算如下：
=.=0.6498=1.568
=√=10.8751
第6，章无良脉中向应数字虑皮的没
217
Created by ZhuangHeng
数字信号处理(第五版)
N==I11.561=5.3056
取N=6。将Ω,和a,代人(6.2.20)式，求得Ω=0.7663 rad/s。这样保证阻带技术指标满
足要求，通带指标有富余。
根据N=6,查表6.2.1得到的归一化低通原型系统函数G(p)为
G.(D)=(p+0.5176p+D(p+1.4142b+D(p'+1.9319p+D
将p=s/Ω。代人G(p),去归一化得到实际的H,(s)为
H.(s)=s2+0.396s+0.5871)(2+1.083s+0.5871)(2+1.480s+0.5871)
(4)用双线性变换法将H,(s)转换成数字滤波器H(z),即
H(z)=H?(S)
=a-1.268+0.7051(-1.17837840.358)4-0.9042+0.21555
本例设计的模拟和数字滤波器幅度特性分别如图6.4.6(a)和(b)所示。此图表明数字滤波
器满足技术指标要求，且无频谱混叠。
0F 0
-20 -20}
幅度/dB -40
-60 幅度/dB -40
-60
-80 -80
-1000 0.2 0.4 0.6 0.8 -10000.2 0.4 0.6 0.8 1
f/Hz w/π
(a) (b)
图6.4.6 例6.4.2设计的模拟和数字滤波器幅度特性
本例的设计程序为ep642.m。程序中分别采用本例中的双线性变换法的分步设计法和
调用MATLAB工具箱函数buttord和butter直接设计数字滤波器，所得结果完全相同。这
就说明该函数默认采用双线性变换法。
??6.4.2设计程序：ep642.m
??双线性变换法设计 DF
T=1;Fs=1/T;
wpz=0.2;wsz=0.3:
wp=2*tan(wpz* pi/2):ws=2*tan(wsz*pi/2);rp=l;rs=15;??畸变校正转换指标
[N,we]=buttord(wp,ws,rp,rs,'s');??计过渡模拟滤波器
[B.A]=butter(N,we,'s);
[Bz,Az]=bilinear(B,A,Fs); ??双线性变换法转换成数字滤波器
218
Created by ZhuangHeng
[Nd, wde]=buttord(wpz,wsz,rp,rs); ??用buttord和butter直接设计数字滤波器
[Bdz,Adz]=butter(Nd,wde);
??制滤波器的损耗函数曲线(省略)
6.5 数字高通、带通和带阻滤波器的设计
前面我们已经学习了模拟低通滤波器的设计方法，以及基于模拟滤波器的频率变换，
模拟高通、带通和带阻滤波器的设计方法。对于数字高通、带通和带阻滤波器的设计，通用
方法为双线性变换。可以借助于模拟滤波器的频率变换设计一个所需类型的过渡模拟滤波
器，再通过双线性变换将其转换成所需类型的数字滤波器，例如高通数字滤波器等。具体
设计步骤如下：
(1)确定所需类型数字滤波器的技术指标。
(2)将所需类型数字滤波器的边界频率转换成相应类型的过渡模拟滤波器的边界频
率，转换公式为
a=2tan2 (6.5.1)
(3)将相应类型模拟滤波器技术指标转换成模拟低通滤波器技术指标(具体转换公式
参看本章6.2节)。
(4)设计模拟低通滤波器。
(5)通过频率变换将模拟低通转换成相应类型的过渡模拟滤波器。
(6)采用双线性变换法将相应类型的过渡模拟滤波器转换成所需类型的数字滤波器。
MATLAB信号处理工具箱中的各种IIR-DF 设计函数就是按照如上步骤编程设计
的，工程实际中可以直接调用这些函数设计各种类型的IIR数字滤波器。下面先通过例题
说明按照如上步骤设计高通数字滤波器的方法，再直接调用MATLAB函数设计带通、带
阻数字滤波器。
【例6.5.1】 设计一个数字高通滤波器，要求通带截止频率w=0.8π rad,通带衰减不
大于3dB,阻带截止频率w=0.44π rad,阻带衰减不小于15 dB。希望采用巴特沃斯滤波器。
解(1)确定数字高通的技术指标：
wp=0.8π rad,a=3dB
w,=0.44π rad,a,=15 dB
(2)将高通数字滤波器的技术指标转换成高通模拟滤波器的设计指标：令T=2s,预
第6章无限脉冲响应数字滤波器的设计
畸变校正得到模拟边界频率：
m=tan2=3.0775 rad/s,a=3dB
Q=tan2=0.8275rad/s,a,=15dB
(3)模拟低通滤波器的技术指标计算如下：对通带边界频率(本例中就是3dB截止频
219
Created by ZhuangHeng
口
口
数字信号处理(第五版)
率Ω)归一化，即
λ=λ=1,ap=3dB
将λ。=1和-Ω代入(6.2.51)式，求出归一化低通滤波器的阻带截止频率
λ.==3.7190,a,=15dB
(4)设计归一化模拟滤波器G(p)。
k-√o-5.5463,A。-=3.719
N==1.3043,取N=2
查表6.2.1,得到归一化模拟低通原型系统函数G(p)为
Cp)=+zp+1
(5)利用频率变换公式(6.2.50)式将G(p)转换成模拟高通HHp(s):
H.S)=G(p),-7+0+4.352+9.4710
(6)用双线性变换法将模拟高通H,(s)转换成数字高通H(z):
H(z)=H?S)-.671.1423490.412875
实际上，上述复杂的设计过程的实现程序ep651.m只有下面3行：
wpz=0.8;wsz=0.44:rp=3;rs=15;
[N, we]=buttord(wpz,wsz,rp,rs);??用buttord和butter直接设计数字滤波器
[Bz,Az]=butter(N, we,'high');
程序运行结果：
N=2;Bz=[0.1326 -0.2653 0.1326];Az=[1.0000 0.7394 0.2699]
H(z)的系数虽然不相同，但手算结果和程序运行结果均满足指标要求。数字滤波器损
耗函数如图6.5.1所示。
0
-20
幅度/dB -40
-60
-80
-1000 0.2 0.4 0.6 0.8
@/π
图6.5.1 高通数字滤波器损耗函数
220
Created by ZhuangHeng
【例6.5.2】 希望对输入模拟信号采样并进行数字带通滤波处理，系统采样频率F,=
8 kHz,要求保留2025～2225 Hz频段的频率成分，幅度失真小于1 dB;滤除0～1500 Hz
和2700 Hz以上频段的频率成分，衰减大于40 dB。试设计数字带通滤波器实现上述要求。
解 这是一个用数字滤波器对模拟信号进行带通滤波处理的应用实例(先对模拟信号
进行A/D变换，再进行数字带通滤波处理)。首先确定数字滤波器技术指标：
=2Ff=280225=0.5062π,=2=20225=0.5563π
4=2R/=28000=0.3750π,a=2F=28200=0.6750π
=1dB,a,=40 dB
为了使滤波器阶数最低，选用椭圆滤波器。调用MATLAB信号处理工具箱函数
(ellipord和ellip)直接设计数字带通滤波器的程序为ep652.m。
??6.5.2 调用函数ellipord和ellip直接设计数字椭圆带通滤波器程序：ep652.m
fpl=2025;fpu=2225;fsl=1500;fsu=2700;Fs=8000;
wp=[2*fpl/Fs,2*fpu/Fs];ws=[2*fsl/Fs,2*fsu/Fs]:??波器边界频率(关于π归一化)
rp=1;rs=40:
[N.wpo]=ellipord(wp,ws,rp,rs);??用ellipord 计算滤波器阶数N和通带截止频率wpo
[B.A]=ellip(N,rp, rs, wpo);??用ellip 计算带通滤波器系统函数系数向量B和A
程序运行结果：
N=3
wpo =[0.5062 0.5563];ws=[0.3750 0.6750]
B=[0.0053 0.0020 0.0045 0.0000 -0.0045 -0.0020 -0.0053]
A=[1.0000 0.5730 2.9379 1.0917 2.7919 0.5172 0.8576]
由系数向量B和A可知，系统函数分子分母是2N阶多项式：
H(2)=b+ah++az+a3+aa+a
式中
b=B(k+1),a=A(k+1)k=0,1,2,3,4,5,6
6阶椭圆数字带通滤波器损耗函数曲线如图6.5.2所示。
幅度/dB -20 第6章无限脉冲响应数字滤波器的设计
-40
-60L 0.4 0.5 0.6 0.7
@/t
图6.5.2 六阶椭圆数字带通滤波器损耗函数曲线
221
Created by ZhuangHeng
数字信号处理(第五版)
【例6.5.3】 希望对输人模拟信号采样并进行数字带阻滤波处理，系统采样频率F,=
8kHz,要求滤除2025～2225 Hz频段的频率成分，衰减大于40 dB;保留0~1500 Hz和
2700 Hz以上频段的频率成分，幅度失真小于1dB。试设计数字带阻滤波器实现上述要求。
解 首先确定数字滤波器技术指标：
-2f=2×2025=0.5062,=f=2-80225=0.563π
=2mf=2×000=0.3750π,a=2mf=2×2700=0.6750m
a=1 dB,a,=40 dB
选用椭圆滤波器，调用MATLAB信号处理工具箱函数(ellipord和ellip)直接设计数字带阻
滤波器的程序为ep653.m。除了ellip 中加入滤波器类型参数'stop'外，该程序与程序
ep652.m完全相同。
??6.5.3调用函数ellipord和ellip直接设计数字椭圆带阻滤波器程序：ep653.m
fsl=2025:fsu=2225;fpl=1500:fpu=2700;Fs=8000;
ws=[2*fsl/Fs,2*fsu/Fs];wp=[2*fpl/Fs,2*fpu/Fs];??算滤波器边界频率(关于π归一化)
rp=1;rs=40;
[N,wpo]=ellipord(wp,ws,rp,rs)??用ellipord计算滤波器阶数N和通带截止频率wpo
[B,A]=ellip(N,rp,rs,wpo,stop):??用ellip计算带阻滤波器系统函数系数向量B和A
程序运行结果：
N=3,wpo=[0.3811 0.6750]
B=[0.3600 0.2078 1.0749 0.4094 1.0749 0.2078 0.3600]
A=[1.0000 0.3982-1.1068 0.3508 0.7452 0.0761 0.0178]
根据系统函数系数向量B和A画出6阶数字椭圆带阻滤波器损耗函数曲线如图6.5.3
所示。
0
-20 幅度/dB -40
60L0.3 0.4 0.5 0.60.7
@/a
图6.5.3 六阶椭圆数字带阻滤波器损耗函数曲线
以上仅介绍了用双线性变换法设计数字高通、数字带通和数字带阻滤波器的基本步
骤，并举例说明了高通数字滤波器的设计过程。这种方法基于模拟滤波器的频率变换，即
先设计模拟低通滤波器，再利用频率变换将模拟低通滤波器转换成所需类型的模拟滤波器
(例如模拟高通滤波器),最后采用双线性变换法将所需类型的模拟滤波器转换成所需类型
的数字滤波器。这里要说明的是，如果设计的是数字低通或者数字带通滤波器，则也可以
222
Created by ZhuangHeng
采用脉冲响应不变法。但对于数字高通或者数字带阻滤波器，则只能采用双线性变换法进
行转换。
按照以上步骤设计数字滤波器的计算繁杂，MATLAB提供的滤波器设计工具箱函数
就是按照这种理论来实现各种类型滤波器的设计的。工程实际中，调用对应函数就可以直
接设计所需要的各种滤波器。
请注意，对于滤波器的频率变换，除了本节介绍的模拟域的频率变换以外，在数字域
也可以进行频率变换。利用数字域频率变换的设计过程是：先将模拟低通滤波器采用脉冲
响应不变法或者双线性变换法转换成数字低通滤波器，再在数字域利用频率变换将低通滤
波器转换成所需类型的数字滤波器(例如数字高通滤波器)。限于篇幅，本书未编入这部分
内容，读者若感兴趣，可阅读参考文献[12,19]。
最后要说明的是，前面所介绍的IIR数字滤波器的间接设计法是通过先设计模拟滤波
器，再进行s-z平面转换，来达到设计数字滤波器的目的的。这种设计方法使数字滤波器
幅度特性受到所选模拟滤波器特性的限制。例如，巴特沃斯低通幅度特性是单调下降，而
切比雪夫低通特性带内或带外有上、下波动等。所以，对于要求任意幅度特性的滤波器，则
不适合采用这种方法。数字域直接设计IIR 滤波器的方法和FIR数字滤波器的设计方法可
以解决这种问题。
IIR滤波器的数字域直接设计方法有零极点累试法、频域幅度平方误差最小法和时域
直接设计法。后两种方法都属于优化设计方法。在下章7.7节将介绍的MATLAB
滤波器设计分析工具(fadtool)中，也有任意形状频响特性数字滤波器的直接设计方法。
零极点累试法的基本思想是根据期望的幅频特性先确定零极点位置，再按照确定的零
极点写出其系统函数，画出其幅度特性，并与希望的幅频特性进行比较，如不满足要求，可
通过移动零极点位置或增加(减少)零极点进行修正。这种修正是多次的，因此称为零极点
累试法。这种设计方法主要适用于实现简单、选择性要求很低的简单的滤波器设计。
限于篇幅和高等学校本科教学要求，本书未编入直接设计法的具体内容。
习题与上机题
1.设计一个巴特沃斯低通滤波器，要求通带截止频率f=6kHz,通带最大衰减a=
3dB,阻带截止频率f.=12 kHz.阻带最小衰减α,=25 dB。求出滤波器归一化系统函数
G(p)以及实际的H(s)。
第章无限脉冲响应数字滤波器的设计
2.设计一个切比雪夫低通滤波器，要求通带截止频率f,=3kHz,通带最大衰减a=
0.2 dB,阻带截止频率f=12 kHz,阻带最小衰减a=50 dB。求出滤波器归一化系统函数
G(p)和实际的H(s)。
3.设计一个巴特沃斯高通滤波器，要求其通带截止频率f。=20 kHz,阻带截止频率
f,=10kHz,f。处最大衰减为3dB,阻带最小衰减a,=15 dB。求出该高通滤波器的系统函
223
Created by ZhuangHeng
数字信号处理(第五版)
数H,(s)。
4.已知模拟滤波器的系统函数H(s)如下：
(1)H,(s)=s+a)2+6
H?s)=s+a)3+b2 (2)
式中a、b为常数，设H,(s)因果稳定，试采用脉冲响应不变法将其转换成数字滤波器
H(z)。
5.已知模拟滤波器的系统函数如下：
H,(s)=+s+1 (1)
H,(s)=22+3+1 (2)
试采用脉冲响应不变法和双线性变换法将其转换为数字滤波器。设T=2s。
6.设h(1)表示一模拟滤波器的单位冲激响应，即
-{
用脉冲响应不变法，将此模拟滤波器转换成数字滤波器(用h(n)表示单位脉冲响应，即
h(n)=h,(nT))。确定系统函数H(z),并把T作为参数，证明：T为任何值时，数字滤波
器是稳定的，并说明数字滤波器近似为低通滤波器还是高通滤波器。
7.假设某模拟滤波器H?(s)是一个低通滤波器，又知 H(z)=H?(s)|-出，数字滤波
器H(z)的通带中心位于下面哪种情况?并说明原因。
(1)w=0(低通)。
(2)w=π(高通)。
(3)除0或π以外的某一频率(带通)。
8.题8图是由RC组成的模拟滤波器，写出其系统函数H(s),并选用一种合适的转
换方法，将H(s)转换成数字滤波器H(z),最后画出网络结构图。
-0
C
x?(4) R y.(t)
○- 0
题8图
9.设计低通数字滤波器，要求通带内频率低于0.2π rad时，容许幅度误差在1 dB之
内；频率在0.3π到π之间的阻带衰减大于10 dB。试采用巴特沃斯型模拟滤波器进行设计，
用脉冲响应不变法进行转换，采样间隔T=1ms。
10.要求同题9,试采用双线性变换法设计数字低通滤波器。
11.设计一个数字高通滤波器，要求通带截止频率w=0.8π rad,通带衰减不大于
224
Created by ZhuangHeng
3 dB,阻带截止频率w.=0.5π rad,阻带衰减不小于18 dB,希望采用巴特沃斯型滤波器。
12.设计一个数字带通滤波器，通带范围为0.25π rad到0.45π rad,通带内最大衰减
为3dB,0.15π rad 以下和0.55π rad 以上为阻带，阻带内最小衰减为15 dB。试采用巴特
沃斯型模拟低通滤波器。
13°.设计巴特沃斯数字带通滤波器，要求通带范围为0.25π rad≤w≤0.45π rad,通带
最大衰减为3dB,阻带范围为0≤w≤0.15π rad和0.55π rad≤w≤π rad,阻带最小衰减为
40 dB。调用MATLAB工具箱函数buttord和butter 设计，并显示数字滤波器系统函数
H(z)的系数，绘制数字滤波器的损耗函数和相频特性曲线。这种设计对应于脉冲响应不变
法还是双线性变换法?
14*.设计一个工作于采样频率80 kHz的巴特沃斯低通数字滤波器，要求通带边界频
率为4kHz,通带最大衰减为0.5 dB,阻带边界频率为20kHz,阻带最小衰减为45 dB。调
用MATLAB工具箱函数buttord和 butter设计，并显示数字滤波器系统函数H(z)的系
数，绘制损耗函数和相频特性曲线。
15°,设计一个工作于采样频率80 kHz的切比雪夫I型低通数字滤波器，滤波器指标
要求与题14*的相同。调用MATLAB工具箱函数cheblord和chebyl设计，并显示数字滤
波器系统函数H(z)的系数，绘制损耗函数和相频特性曲线。与题14*的设计结果比较，简
述巴特沃斯滤波器和切比雪夫I型滤波器的特点。
16°.设计一个工作于采样频率2500 kHz的椭圆高通数字滤波器，要求通带边界频率
为325 kHz,通带最大衰减为1 dB,阻带边界频率为225kHz,阻带最小衰减为40 dB。调
用MATLAB工具箱函数ellipord和ellip 设计，并显示数字滤波器系统函数H(z)的系数，
绘制损耗函数和相频特性曲线。
17°.设计一个工作于采样频率5MHz的椭圆带通数字滤波器，要求通带边界频率为
560 kHz和780kHz,通带最大衰减为0.5dB,阻带边界频率为375kHz和1MHz,阻带
最小衰减为50 dB。调用MATLAB工具箱函数ellipord和ellip设计，并显示数字滤波器系
统函数H(z)的系数，绘制损耗函数和相频特性曲线。
18°.设计一个工作于采样频率5kHz的椭圆带阻数字滤波器，要求通带边界频率为
500 Hz和2125 Hz,通带最大衰减为1 dB,阻带边界频率为1050 kHz和1400 Hz,阻带最
小衰减为40 dB。调用MATLAB工具箱函数ellipord和ellip设计，并显示数字滤波器系统
函数H(z)的系数，绘制损耗函数和相频特性曲线。 第6章无恨脉中响数字虑皮器的设计 19°.用脉冲响应不变法设计一个巴特沃斯低通数字滤波器，指标要求与题14的相
同。编写程序先调用MATLAB工具箱函数buttord和butter设计过渡模拟低通滤波器，再
调用脉冲响应不变法数字化转换函数impinvar,将过渡模拟低通滤波器转换成低通数字滤
波器H(z),并显示过渡模拟低通滤波器和数字滤波器系统函数的系数，绘制损耗函数和相
频特性曲线。请归纳本题的设计步骤和所用的计算公式，并比较本题与题14°的设计结果，
观察双线性变换法的频率非线性失真和脉冲响应不变法的频谱混叠失真。
225
Created by ZhuangHeng
口口
数字信号处理(第五版)
226
第7章
有限脉冲响应数字滤波器的设计
IIR 数字滤波器的设计方法是利用模拟滤波器成熟的理论及设计图表进行设计的，因
而保留了一些典型模拟滤波器优良的幅度特性。但设计中只考虑了幅度特性，没考虑相位
特性，所设计的滤波器一般是某种确定的非线性相位特性。为了得到线性相位特性，对IIR
滤波器必须另外增加相位校正网络，使滤波器设计变得复杂，成本也高，又难以得到严格
的线性相位特性。有限脉冲响应(FIR)滤波器在保证幅度特性满足技术要求的同时，很容
易做到有严格的线性相位特性。本章中用N表示FIR滤波器单位脉冲响应h(n)的长度，
其系统函数H(z)为
H2)-∑hn)a
H(z)是z1的N-1次多项式，它在z平面上有N-1个零点，在原点z=0处有一个N-1重
极点。因此，H(z)绝对稳定。稳定和线性相位特性是FIR 滤波器最突出的优点。
FIR滤波器的设计方法和IIR滤波器的设计方法截然不同。FIR滤波器设计任务是选
择有限长度的h(n),使频率响应函数H(e")满足技术指标要求。本章主要介绍三种设计方
法：窗函数法、频率采样法和切比雪夫等波纹逼近法。
7.1 线性相位FIR数字滤波器的条件和特点
本节主要介绍FIR 滤波器具有线性相位的条件及幅度特性以及零点的分布特点。
1.线性相位FIR数字滤波器
对于长度为N的h(n),频率响应函数为
He)-∑h(n)e (7.1.1)
Created by ZhuangHeng
H(e")=H(w)e (7.1.2)
式中，H?(w)称为幅度特性；θ(w)称为相位特性。注意，这里H(w)不同于|H(e)|,
H(w)为w的实函数，可能取负值，而|H(e)|总是正值。线性相位FIR滤波器是指θ(w)
是w的线性函数，即
0(w)=-w t为常数 (7.1.3)
如果θ(w)满足下式：
0(w)=0。-w0。是起始相位 (7.1.4)
严格地说，此时θ(o)不具有线性相位特性，但以上两种情况都满足群时延是一个常数，即
d=
也称这种情况为线性相位。一般称满足(7.1.3)式是第一类线性相位(严格线性相位特性);
满足(7.1.4)式为第二类线性相位。8?=-π/2是第二类线性相位特性常用的情况，所以本
章仅介绍这种情况。
2.线性相位FIR滤波器的时域约束条件
线性相位FIR 滤波器的时域约束条件是指满足线性相位时，对h(n)的约束条件。为了
使滤波器对实信号的处理结果仍是实信号，一般要求h(n)为实序列。
1)第一类线性相位对h(n)的约束条件
第一类线性相位FIR数字滤波器的相位函数θ(w)=-wr,由式(7.1.1)和(7.1.2)得到：
H(e)=∑h(n)e=H,()e
∑hCn)(csn-jsinun)=H,()(csr-jsinor) (7.1.5)
由式(7.1.5)得到： 二二
将(7.1.6)式中两式相除得到：
(7.1.6) = 第7章有限脉冲响应数字滤波器的设计
即
∑hcn)csn sior-2hcn sinon cos
移项并用三角公式化简得到：
(7.1.7)
227
Created by ZhuangHeng
∑h(n)sin[o(n-)]=0
数字信号处理(第五版)
函数h(n)sinw(n-r)关于求和区间的中心(N-1)/2奇对称，是满足(7.1.7)式的一组解。
因为sina(n-r)关于n=r奇对称，如果取r=(N-1)/2,则要求h(n)关于(N-1)/2偶对
称，所以要求r和h(n)满足如下条件：
—1—-1
(7.1.8)
由以上推导结论可知，如果要求单位脉冲响应为h(n)、长度为N的FIR数字滤波器具有
第一类线性相位特性(严格线性相位特性),则h(n)应当关于n=(N-1)/2点偶对称。当N
确定时，FIR数字滤波器的相位特性是一个确知的线性函数，即θ(w)=-w(N-1)/2。N
为奇数和偶数时，h(n)的对称情况分别如表7.1.1中的情况1和情况2所示。
2)第二类线性相位对h(n)的约束条件
第二类线性相位 FIR数字滤波器的相位函数θ(w)=-π/2-wr,由式(7.1.1)和
式(7.1.2)有
H(e)=hn)e”=H?()e
经过同样的推导过程可得到：
∑h(wcsCo[n-2]=0 (7.1.9)
函数h(n)cos[u(n-t)]关于求和区间的中心(N-1)/2奇对称，是满足式(7.1.9)的一组
解，因为cos[u(n-r)]关于n=t偶对称，所以要求r和h(n)满足如下条件：
=N21 N-1一分。0≤n≤N-1
(7.1.10)
由以上推导结论可知，如果要求单位脉冲响应为h(n)、长度为N的FIR 数字滤波器
具有第二类线性相位特性，则h(n)应当关于n=(N-1)/2点奇对称。N为奇数和偶数时
h(n)的对称情况分别如表7.1.1中情况3和情况4所示。
3.线性相位FIR滤波器幅度特性H?(o)的特点
实质上，幅度特性的特点就是线性相位FIR滤波器的频域约束条件。将时域约束条件
h(n)=±h(N-n-1)代入式(7.1.1),设h(n)为实序列，即可推导出线性相位条件对FIR
数字滤波器的幅度特性H?(w)的约束条件。当N取奇数和偶数时对H?(w)的约束不同，因
此，对于两类线性相位特性，下面分四种情况讨论其幅度特性的特点。这些特点对正确设
计线性相位FIR数字滤波器具有重要的指导作用。为了推导方便，引人两个参数符号：
=N-1.M=|Nz1]
式中，(N-1)/2|表示取不大于(N-1)/2的最大整数。显然，仅当N为奇数时，M=r=
(N-1)/2。
228
Created by ZhuangHeng
表7.1.1 线性相位FIR数字滤波器的时域和频域特性一览表
第一类线性相位特性 h(n)=h(N-1-n)
情况1 r=~ B(w)=-@r,
(以N=5为例画图)
0
-2
0())
-6
-8。 0.5
o/π
N为奇数(N=13)
0.3
0.2
加m
0
-0.1
B,O=m+ZZmofeu-D
15r
H()
0
-0.5 0.5 1 15 2
a/π
-4
0.1
0 2 4 6 8 10 12 14
05
0
N为偶数(N=12)
0.3r
0.2
是 0.1
-0.10 246 8 10 12 14
B,O-Z2hosuw-
1
0.5
-1
0 0.5 1 1.5 2
@/π
情况2
h(n)=-h(N-1-n) 第二类线性相位特性
情况3 e)---or,r=~
(以N=5为例画图)
0
-2F
-4
6
-8 05 1
@/π
N为奇数(N=13)
0.4r
02
是 0F
-02
-04 5
n
10
B.-22mmno-切
2
1
ofH 0
-1
-2。 0.5 1 1.52
@/π
15
N为偶数(N=14)
0.5
加m) 0
-0.5 5 10 15
n
.-mmio-b
1.5
o用
o
-0.5 0.5 1 1.5 2
w/π
0
0.5-
0
情况
第7章有限脉冲响应数字滤波器的设计
229
Created by ZhuangHeng
口
口
■□
口
口
口口
口
口口
口口
口口
口口
口
数字信号处理(第五版)
情况1:h(n)=h(N-n-1),N为奇数。
将时域约束条件h(n)=h(N-n-1)和θ(w)=-wr代入式(7.1.1)和(7.1.2),得到：
H(e)=H?(m)e~-Zhn)e
=h(N-1)+∑(hcn)e-+h(N-n-1)e]
=h(N=1)+[h(n)em+h(n)e]
-en(Nz1)+Zh(n)[e]+e]}
=e(he)+22hcn)cstLo[n-2]}
所以
H,(u)=h(z)+2h(n)cos[Lu(n-z)] (7.1.11)
因为cos[w(n-t)]关于w=0,π,2π三点偶对称，所以由式(7.1.11)可以看出，H?(w)关于
w=0,π,2π三点偶对称。因此情况1可以实现各种(低通、高通、带通、带阻)滤波器。对
于N=13的低通情况，H(w)的一种例图如表7.1.1中情况1所示。
情况2:h(n)=h(N-n-1),N为偶数。
仿照情况1的推导方法得到：
H(e)=H,()e--2hn)e=c~∑2h(mcsocn-)
H(m)=∑zh(n)cs[Lo(n-)] (7.1.12)
式中，z=(N-1)/2=N/2-1/2。因为N是偶数，所以当w=π时
cos[u(n-x)]=cos[π(n-2)+2]=-sin[n(n-)]=0
而且cos[w(n-t)]关于过零点奇对称，关于w=0和2π偶对称。所以H?(π)=0,H?(w)关
于w=π奇对称，关于w=0和2π偶对称。因此，情况2不能实现高通和带阻滤波器。对
N=12的低通情况，H(w)如表7.1.1中情况2所示。
情况3:h(n)=-h(N-n-1),N为奇数。
将时域约束条件h(n)=-h(N-n-1)和θ(w)=-π/2—wr代人式(7.1.1)和(7.1.2),并
考虑h(N-1)=0,得到：
H(e)=H,)e-h(n)e
-∑ChCn)e?+h(N-n-De)
230
Created by ZhuangHeng
-∑LhCn)e--hn)e]
Zhcn(e)-)
=-je-Z2hCn) sintocn-]
=c2h(n) ifocn-]
H,(m)=2h(n)sin[o(n-)]
式中，N是奇数，z=(N-1)/2是整数。所以，当w=0,π,2π时，sin[w(n-r)]=0,而且
sin[w(n-r)]关于过零点奇对称。因此H?(w)关于w=0,π,2π三点奇对称。由此可见，情
况3只能实现带通滤波器。对N=13的带通滤波器举例，H?(w)如表7.1.1中情况3所示。
情况4:h(n)=-h(N-n-1),N为偶数。
用情况3的推导过程可以得到：
H.()=∑2h[w sinton-] (7.1.13)
式中，N是偶数，z=(N-1)/2=N/2-1/2。所以，当w=0,2π时，sin[u(n-r)]=0;当
w=π时，sin[w(n-t)]=(-1)N,为峰值点。而且 sin[w(n-r)]关于过零点w=0和2π
两点奇对称，关于峰值点w=π偶对称。因此H?(w)关于w=0和2π两点奇对称，关于w=
π偶对称。由此可见，情况4不能实现低通和带阻滤波器。对N=12的高通滤波器举例，
H?(w)如表7.1.1中情况4所示。
为了便于比较，将上面四种情况的h(n)及其幅度特性需要满足的条件列于表7.1.1
中。应当注意，对每一种情况仅画出满足幅度特性要求的一种例图。例如，情况1仅以低通
的幅度特性曲线为例。当然也可以画出满足情况1的幅度约束条件(H?(w)关于w=0,π,
2π三点偶对称)的高通、带通和带阻滤波器的幅度特性曲线。所以，仅从表7.1.1就认为情
况1只能设计低通滤波器是错误的。
3.线性相位FIR数字滤波器的零点分布特点
H(2)=∑hn)z" 第7章有限脉冲响应数字滤波器的设计
将h(n)=±h(N-1-n)代入上式，得到：
H(2)=∑h(n)e=±∑hCN-1-n)
=±Zh(m)2W=±H(a) (7.1.14)
由(7.1.14)式可以看出，如z=z,是H(z)的零点，其倒数z?3也必然是其零点；又因为
231
Created by ZhuangHeng
口
口口
口 口
口
口口
口
口口
口口
口
口
数字信号处理(第五版)
h(n)是实序列，H(z)的零点必定共轭成对，因此z和(z1)也是其零点。这样，线性相
位FIR 滤波器零点必定是互为倒数的共轭对，确定其中一个，另外三个零点也就确定了，
如图7.1.1中z?、z、z和(z)1。当然，也有一些特殊情况，如图7.1.1中z?、z?和z
情况。
0.8
0.6
0.4
0.2
虚部-0.2
0
-0.4
-0.6
-0.8
-1
-1-0.5
。 至
。 z
。2
。
0 0.5 1 1.5
实部
图7.1.1 线性相位FIR数字滤波器的零点分布
7.2 利用窗函数法设计FIR滤波器
7.2.1 窗函数法设计原理
设希望逼近的滤波器频率响应函数为H?(e"),其单位脉冲响应是ha(n)。
H?(e)=∑h?(n)e
ha(n)=H(e)ed
如果能够由已知的H?(e")求出h(n),经过Z变换可得到滤波器的系统函数。但通常以理
想滤波器作为H?(e"),其幅度特性逐段恒定，在边界频率处有不连续点，因而h(n)是无
限时宽的，且是非因果序列。例如，线性相位理想低通滤波器的频率响应函数H?(e")为
H)-{<lai<x (7.2.1)
其单位脉冲响应h(n)为
h(n)=ed=si--a (7.2.2)
由上式看到，理想低通滤波器的单位脉冲响应ha(n)是无限长，且是非因果序列。h(n)的
波形如图7.2.1(a)所示。为了构造一个长度为N的第一类线性相位FIR滤波器，只有将
h(n)截取一段，并保证截取的一段关于n=(N-1)/2偶对称。设截取的一段用h(n)表
232
Created by ZhuangHeng
示，即
h(n)=h(n)R(n) (7.2.3)
式中，R√(n)是一个矩形序列，长度为N,波形如图7.2.1(b)所示。由该图可知，当α取值
为(N-1)/2时，截取的一段h(n)关于n=(N-1)/2偶对称，保证所设计的滤波器具有线
性相位。
0.2
h(n) 0.1
04
-0.1
-10
1 1l
-5 0 5 10 15 20 25 30 35 40
1
RMn) 0.5
oL
-10 -5 0 5 10 15 20 25 30 3540
0.2
h(n) 0.1
0
-0.1l-10
I1。 I
-5 0 5 10 15 20 25 30 35 40
n
图7.2.1 窗函数设计法的时域波形(矩形窗，N=30)
我们实际设计的滤波器的单位脉冲响应为h(n),长度为N,其系统函数为H(z),
Hs)-h(n)
这样用一个有限长的序列h(n)去代替h(n),肯定会引起误差，表现在频域就是通常所说
的吉布斯(Gibbs)效应。该效应引起过渡带加宽以及通带和阻带内的波动，尤其使阻带的衰
减小，从而满足不了技术上的要求，如图7.2.2所示。这种吉布斯效应是由于将h(n)直接
截断引起的，因此，也称为截断效应。下面讨论这种截断效应的产生，以及如何构造窗函数 第7章有限脉冲响应数字滤波器的设计
w(n),用来减少截断效应，设计一个能满足技术要求的FIR线性相位滤波器。
以上就是用窗函数法设计FIR滤波器的思想。另外，我们知道H。(e")是一个以2π为
周期的函数，可以展为傅里叶级数，即
Ha(e)=∑ha(n)e
傅里叶级数的系数为h?(n),当然就是H(e")对应的单位脉冲响应。设计FIR 滤波器就是
233
Created by ZhuangHeng
根据要求找到N个傅里叶级数系数h(n),n=0,1,2,…,N-1,以N项傅氏级数去近似
代替无限项傅氏级数，这样在一些频率不连续点附近会引起较大误差，这种误差就是前面
说的截断效应，如图7.2.2所示。因此，从这一角度来说，窗函数法也称为傅氏级数法。显
然，选取傅氏级数的项数愈多，引起的误差就愈小，但项数增多即h(n)长度增加，也使成
本和滤波计算量加大，应在满足技术要求的条件下，尽量减小h(n)的长度。
1k
0.8
数字信号处理(第五版)
幅度 0.6
0.4 幅度/dB -20
-40
0.2
oL0 0.2 0.4 0.6 0.81
-60L0 0.2 0.4 0.60.8 1
w/π @/π
(a)幅频响应函数曲线 (b)损耗函数曲线
图7.2.2 吉普斯效应
在(7.2.3)式中，Rn(n)(矩形序列)就是起对无限长序列的截断作用，可以形象地把
Rx(n)看做一个窗口，h(n)则是从窗口看到的一段h(n)序列，所以称h(n)=h(n)Rx(n)
为用矩形窗对h(n)进行加窗处理。下面分析用矩形窗截断的影响和改进的措施。为了叙述
方便，用w(n)表示窗函数，用下标表示窗函数类型，矩形窗记为wg(n)。用N表示窗函数
长度。
根据傅里叶变换的时域卷积定理，得到(7.2.3)式的傅里叶变换：
H(e)=fH(e°)W(e”)de (7.2.4)
式中，H?(e")和Wg(e")分别是h(n)和R√(n)的傅里叶变换，即
Wa(e)-Zu(n)e--2e
=esic/2)
=Wge(w)e (7.2.5)
式中
a=N-1 W(m)=sicN/2)
Wrg(a)称为矩形窗的幅度函数，如图7.2.3(b)所示，将图中[-2π/N,2π/N]区间上的
一段波形称为WR(w)的主瓣，其余较小的波动称为旁瓣。将H?(e")写成H?(e")=
H(a)e,则按照(7.2.1)式，理想低通滤波器的幅度特性函数(如图7.2.3(a)所示)为
He)-{<l<l<x
234
Created by ZhuangHeng
H?(θ)
(a)
一π
-
0 @ θ
W?(θ)
(b) -2π/N 2π/N
0 0
H(@) W,(@-0)
(c)
0 @= θ
H(@)
W(@-0) (d)
0
0=a-2π/N θ
H(0)
Wg(0-)
(e)
0
@=a+2n/N θ
H?(a)/H?(0) 0.0895
1
1
0.5 0.0468 0.50.0468
-a 0 a @
-0.0895
图7.2.3 矩形窗加窗效应
将H?(e")和Wg(e")代入(7.2.4)式，得到：
H(e)=2H(f)eW(u-0)ede
=e厂H?(O)Wa(u-0)do
第7章有限脉冲响应数字滤波器的设计
将H(e)写成H(e)=H(w)e,则
H?(m)=2H(O)Wn(w-0)de (7.2.6)
式中H?(w)是H(e")的幅度特性。该式说明加窗后的滤波器的幅度特性等于理想低通滤波
器的幅度特性H(w)与矩形窗幅度特性WR(w)的卷积。
235
Created by ZhuangHeng
口口
口口口
口
口
数字信号处理(第五版)
图7.2.3(f)表示H(w)与W(o)卷积形成的H(w)波形。当w=0时，H?(0)等于图
7.2.3(a)与(b)两波形乘积的积分，相当于对Wr(w)在土w.之间一段波形的积分，当w》
2π/N时，近似为士π之间波形的积分。将H(0)值归一化到1。当w=w.时，情况如图
7.2.3(c)所示，当w>2π/N时，积分近似为WRg(0)一半波形的积分，对H?(0)归一化后
的值近似为1/2。当w=w。-2π/N时，情况如图7.2.3(d)所示，Wg(w)主瓣完全在区间
[-w,w.]之内，而最大的一个负旁瓣移到区间[-w,w.]之外，因此H?(w.-2π/N)有一
个最大的正峰。当w=w.+2π/N时，情况如图7.2.3(e)所示，Wgg(w)主瓣完全移到积分区
间外边，由于最大的一个负旁瓣完全在区间[-,w]内，因此H(w+2π/N)形成最大的
负峰。图7.2.3表明，H?(w)最大的正峰与最大的负峰对应的频率相距4π/N。通过以上分
析可知，对h(n)加矩形窗处理后，H?(w)与原理想低通H(w)的差别有以下两点：
(1)在理想特性不连续点w=w。附近形成过渡带。过渡带的宽度近似等于W(w)主瓣
宽度4π/N。这里将H(w)最大正、负峰值对应的频率间距称为近似过渡带宽度，其精确值
为1.8π/N,见表7.2.2。
(2)通带内产生了波纹，最大的峰值在w.-2π/N处。阻带内产生了余振，最大的负峰
在w+2π/N处。通带与阻带中波纹的情况与窗函数的幅度谱有关，Wr(w)旁瓣幅度的大
小直接影响H(w)波纹幅度的大小。
以上两点就是对h(n)用矩形窗截断后，在频域的反映，称为吉布斯效应。这种效应直
接影响滤波器的性能。通带内的波纹影响滤波器通带的平稳性，阻带内的波纹影响阻带内
的衰减，可能使最小衰减不满足技术指标要求。当然，一般滤波器都要求过渡带愈窄愈好。
下面研究如何减少吉布斯效应的影响，设计一个满足要求的FIR滤波器。
直观上，好像增加矩形窗的长度，即加大N,就可以减少吉布斯效应的影响。只要分析
一下N加大时WR(w)的变化，就可以看到这一结论不是完全正确。我们讨论在主瓣附近
的情况。在主瓣附近，按照式(7.2.5),WR(a)可近似为
W(u)=sinc/2/2)≈Nsinz
该函数的性质是随x加大(N加大),主瓣幅度加高，同时旁瓣也加高，保持主瓣和旁瓣幅
度相对值不变；另一方面，N加大时，WR(w)的主瓣和旁瓣宽度变窄，波动的频率加快。
三种不同长度的矩形窗函数的幅度特性Wg(w)曲线如图7.2.4(a)、(b)、(c)所示。用这三
种窗函数设计的FIR滤波器的幅度特性H?(a)曲线如图7.2.4(d)、(e)、(f)所示。因此，
当N加大时，H(w)的波动幅度没有多大改善，带内最大肩峰比 H(0)高8.95阻带最
大负峰值为H(0)的8.95使阻带最小衰减只有21 dB。加大N只能使H(w)过渡带变
窄(过渡带近似为主瓣宽度4π/N)。因此加大N,并不是减小吉布斯效应的有效方法。
以上分析说明，调整窗口长度N只能有效地控制过渡带的宽度，而要减少带内波动以
及增大阻带衰减，只能从窗函数的形状上找解决问题的方法。构造新的窗函数形状，使其
谱函数的主瓣包含更多的能量，相应旁瓣幅度更小。旁瓣的减小可使通带、阻带波动减小，
从而加大阻带衰减。但这样总是以加宽过渡带为代价的。下面介绍几种常用的窗函数。
236
Created by ZhuangHeng
0 0 0
w(o)rda -20 -20 -20
-40l -40l
0 0.5 1 0 0.5 1
-40l0 0.5
w/π w/π @/π
(a)N=14 (b)N=20 (c)N=36
0 0 0
apl(o)H -20 -20 -20
-40 -40 -40
-60l
0 0.5 1
-6010 0.5 1
-60l0 0.5 1
w/π w/π o/π
(d)N-14 (e)N-20 1)N=36
图7.2.4 矩形窗函数长度的影响
7.2.2 典型窗函数介绍
本节主要介绍几种常用窗函数的时域表达式、时域波形、幅度特性函数(衰减用dB计
量)曲线，以及用各种窗函数设计的FIR数字滤波器的单位脉冲响应和损耗函数曲线。为了
叙述简单，我们把这组波形图简称为“四种波形”。下面均以低通为例，H?(e")取理想低通，
w.=π/2,窗函数长度N=31。
1.矩形窗(Rectangle Window)
wg(n)=R、(n)
前面已分析过，按照(7.2.5)式，其幅度函数为
Wa(m)=sin(a/2 (7.2.7)
为了描述方便，定义窗函数的几个参数：
旁瓣峰值a——窗函数的幅频函数|W(w)|的最大旁瓣的最大值相对主瓣最大值的衰
减值(dB);
过渡带宽度B?——用该窗函数设计的FIR数字滤波器(FIRDF)的过渡带宽度；
阻带最小衰减a——用该窗函数设计的FIRDF的阻带最小衰减。
图7.2.4所示的矩形窗的参数为：a=-13 dB;B.=4π/N;a,=-21 dB。
2.三角形窗(Bartlett Window)
第7章有限脉冲响应数字滤波器的设计 一
(7.2.8)
237
Created by ZhuangHeng
口
口
口口
口
口口
a口
数字信号处理(第五版)
其频谱函数为
wa(e)=[in24]。 (7.2.9)
其幅度函数为
w()=元[si/4] (7.2.10)
三角窗的四种波形如图7.2.5所示，参数为：a=-25 dB;B=8π/N;a,=-25 dB。
0F 1
0.8
)m)同 0.6
0.4
0.2
20181W,,(ool -20
-40
-60
0
0 10 20 30 -80
0 0.5 1
n o/
0.6 0
0.4
0.2
0
201g1H,(on -10
-20
-30
-0.2
0
-40l 10 20 30 0 0.5 1
n w/π
图7.2.5 三角窗的四种波形
3.汉宁(Hanning)窗——升余弦窗
wma(n)=0.5[1-cos(N?-")]R~(n)
W(e”)=FT[wm(n)]=Wng(m)e
(7.2.11)
WH(e")=FT[WH(n)]
={0.5We(u)+0.25[wn(u+N-)+W(-N-)]}e
=Wn(m)e
当N>1时，N-1≈N
Wma()=0.5W(u)+0.25[W(w+)+W(-)]
汉宁窗的幅度函数WHng(w)由三部分相加，旁瓣互相对消，使能量更集中在主瓣中。汉宁窗
的四种波形如图7.2.6所示，参数为：a=-31 dB;B=8π/N;a,=-44 dB。
238
Created by ZhuangHeng
1
0
0.8
(u)aw 0.6
0.4
0.2 20e1w".(on -20
-40
-60
0k0 10 20 30 -80
0 0.5
n w/
0.6 0
0.4
h(n) 0.2
0
工 工 201g1H.(o) -20
-40
-60 B
-0.2l -80L
0 10 20 30 0 0.5
n w/m
图7.2.6 汉宁窗的四种波形
4.哈明(Hamming)窗——改进的升余弦窗
wm(n)=[0.54-0.46 cos(2-)]R~(n) (7.2.12)
其频谱函数WH(e")为
w.(e)=0.54Wa(e)-0.23We(e(始))-0.23Wa(e(音))
其幅度函数WHm(w)为
W(a)=0.54W(a)+0.23W(u-N-)+0.23We(+N-)
当N>1时，其可近似表示为
W(w)≈0.54W(m)+0.23W(@-)+0.23W(+)
这种改进的升余弦窗，能量更加集中在主瓣中，主瓣的能量约占99.96旁瓣峰值幅度为
40 dB,但其主瓣宽度和汉宁窗的相同，仍为8π/N。可见哈明窗是一种高效窗函数，所以
MATLAB窗函数设计函数的默认窗函数就是哈明窗。哈明窗的四种波形如图7.2.7所示，
参数为：a=-41 dB;B=8π/N;a,=-53 dB。
5.布莱克曼(Blackman)窗
wn(n)=(0.42-0.5 cs2+0.08coN-)R≈(n) (7.2.13)
第7章有限脉冲响应数字滤波器的设计
其频谱函数为
Wn(e)=0.42Wa(e)-0.25[W(e(章))+W(e())]
+0.04[W(e(弱))+W(e())]
239
Created by ZhuangHeng
其幅度函数为
口
口口
口
口口
口
数字信号处理(第五版)
240
0
1
0.8 wm 0.6
0.4
0.2 201gWM)ot -20
-40
-60
oL
0 10 20 30 -800 0.5 1
n @/π
0.6r 0
0.4
是 0.2
0
1 1 201glH,(on -20
-40
-60
-0.2
0 10 20 30 -800 0.5 1
@/π
图7.2.7 哈明窗的四种波形
Wng(u)=0.42W()+0.25[W(u-N-)+w(m+N-)]
+0.04[W(w-N-)+W(w+N-)] (7.2.14)
这样其幅度函数由五部分组成，它们都是移位不同，且幅度也不同的WR(u)函数，使旁瓣
再进一步抵消。旁瓣峰值幅度进一步增加，其幅度谱主瓣宽度是矩形窗的3倍。布莱克曼
窗的四种波形如图7.2.8所示，参数为：a=-57 dB;△B=12π/N;a,=-74 dB。
0F i
0.8
(u)藏w 0.6
0.4
0.2
20181wa (oo -20
-40
-60
0l0
-80l A
10 20 30 0 0.5
n a/π
0.6r 0
0.4
是 0.2
0
1 1 201g1H,(o) -20
-40
-60
-80
-020 10 20 30 -1000 0.5 1
n o/π
图7.2.8 布莱克曼窗的四种波形
6.凯塞一贝塞尔窗(Kaiser-Basel Window)
以上五种窗函数都称为参数固定窗函数，每种窗函数的旁瓣幅度都是固定的。凯塞一
Created by ZhuangHeng
贝塞尔窗是一种参数可调的窗函数，是一种最优窗函数。
w(n)=1(o≤n≤N-1 (7.2.15)
式中 β=a√1-(“-1)
I。(β)是零阶第一类修正贝塞尔函数，可用下面级数计算：
I。(B)=1+[(号)
一般I。(β)取15～25项，便可以满足精度要求。a参数可以控制窗的形状。一般a加大，
主瓣加宽，旁瓣幅度减小，典型数据为4<a<9。当α=5.44时，窗函数接近哈明窗。
a=7.865时，窗函数接近布莱克曼窗。在设计指标给定时，可以调整a值，使滤波器阶数最
低，所以其性能最优。凯塞(Kaiser)给出的估算β和滤波器阶数M(h(n)的长度N=M+1)
的公式如下：
se-20*+0.o7me a,>50 dB
50 dB(7.2.16) a,-21) 21 dB <a,<
a,<21
M=2.285B, (7.2.17)
式中，B?=|w,-w|,是数字滤波器过渡带宽度。应当注意，因为式(7.2.17)为阶数估算，
所以必须对设计结果进行检验。另外，凯塞窗函数没有独立控制通带波纹幅度，实际中通
带波纹幅度近似等于阻带波纹幅度。凯塞窗的幅度函数为
w,()=u(0)+2∑u(n)cos(can) (7.2.18)
对α的8种典型值，将凯塞窗函数的性能列于表7.2.1中，供设计者参考。由表可见，当
a=5.568时，各项指标都好于哈明窗。6种典型窗函数基本参数归纳在表7.2.2中，可供
设计时参考。
表7.2.1 凯塞窗参数对滤波器的性能影响
a 过渡带宽 通带波纹/dB 阻带最小衰减/dB
2.120 3.00π/N 土0.27 -30
3.384 4.46π/N 士0.0864 -40
4.538 5.86π/N ±0.0274 -50
5.568 7.24π/N 士0.00868 -60
6.764 8.64π/N ±0.002 75 -70
7.865 10.0π/N ±0.000 868 -80
8.960 11.4π/N 士0.000 275 -90
10.056 10.8π/N ±0.000 087 -100
第7章有限脉冲响应数字滤波器的设计
241
Created by ZhuangHeng
数字信号处理(第五版)
表7.2.2 6种窗函数的基本参数
表中过渡带宽和阻带最小衰减是用对应的窗函数设计的FIR数字滤波器的频率响应指
标。随着数字信号处理的不断发展，学者们提出的窗函数已多达几十种，除了上述6种窗
函数外，比较有名的还有Chebyshev窗、Gaussian窗。MATLAB信号处理工具箱提供
了14种窗函数的产生函数，下面列出上述6种窗函数的产生函数及其调用格式：
wn=boxcar(N)
wn=bartlett(N)
wn=hanning(N)
wn=hamming(N)
wn=blackman(N)
wn=kaiser(N,beta)
窗函数类型
旁瓣峰值
a/dB
过渡带宽度B. 阻带最小衰减
a./dB 近似值 精确值
矩形窗 -13 4π/N 1.8π/N -21
三角窗 -25 8π/N 6.1π/N -25
汉宁窗 -31 8π/N 6.2π/N -44
哈明窗 -41 8π/N 6.6π/N -53
布莱克曼窗 -57 12π/N 11π/N -74
凯塞窗(β=7.865) -57 10π/N -80
?向量 wn中返回长度为N的矩形窗函数w(n)
?向量wn中返回长度为N的三角窗函数w(n)
?向量wn中返回长度为N的汉宁窗函数w(n)
?向量wn中返回长度为N的哈明窗函数w(n)
?向量wn中返回长度为N的布莱克曼窗函数w(n)
?向量wn中返回长度为N的凯塞一贝塞尔窗函数w(n)
7.2.3 用窗函数法设计FIR滤波器的步骤
用窗函数法设计FIR滤波器的步骤如下：
(1)根据对阻带衰减及过渡带的指标要求，选择窗函数的类型，并估计窗口长度N。先
按照阻带衰减选择窗函数类型。原则是在保证阻带衰减满足要求的情况下，尽量选择主瓣
窄的窗函数。然后根据过渡带宽度估计窗口长度N。待求滤波器的过渡带宽度B,近似等于
窗函数主瓣宽度，且近似与窗口长度N成反比，N≈A/B?,A取决于窗口类型，例如，矩
形窗的A=4π,哈明窗的A=8π等，参数A的近似和精确取值参考表7.2.2。
(2)构造希望逼近的频率响应函数H?(e"),即
H?(e")=H(w)eN-D/
所谓的“标准窗函数法”,就是选择H?(e")为线性相位理想滤波器(理想低通、理想高
通、理想带通、理想带阻)。以低通滤波器为例，Hg(w)应满足：
<l< H(a)={0 (7.2.19)
由图7.2.3知道，理想滤波器的截止频率w。近似位于最终设计的FIRDF的过渡带的
中心频率点，幅度函数衰减一半(约-6 dB)。所以如果设计指标给定通带边界频率和阻带
242
Created by ZhuangHeng
边界频率w,和w,一般取
=2 (7.2.20)
(3)计算h(n)。如果给出待求滤波器的频响函数为H?(e"),那么单位脉冲响应用下
式求出：
ha(n)=2H?(e)e"d (7.2.21)
如果H?(e")较复杂，或者不能用封闭公式表示，则不能用上式求出h(n)。我们可以对
H?(e”)从w=0到w=2π采样M点，采样值为HM(k)=H?(e),k=0,1,2,…,M-1,进行
M点IDFT(IFFT),得到：
ha(n)=IDFT[Ha(k)]M (7.2.22)
根据频域采样理论，ha(n)与ha(n)应满足如下关系：
hau(n)=∑h(n+M)Rx(n)
因此，如果M选得较大，可以保证在窗口内hau(n)有效逼近h?(n)。
对(7.2.19)式给出的线性相位理想低通滤波器作为H(e"),由(7.2.2)式求出单位脉
冲响应ha(n):
ha(n)=sinr--2]
为保证线性相位特性，a=(N-1)/2。
(4)加窗得到设计结果：h(n)=h。(n)w(n)。
【例7.2.1】 用窗函数法设计线性相位高通FIRDF,要求通带截止频率=π/2 rad,
阻带截止频率w.=π/4 rad,通带最大衰减a=1 dB,阻带最小衰减a,=40 dB。
解(1)选择窗函数w(n),计算窗函数长度N。已知阻带最小衰减a,=40 dB,由表
(7.2.2)可知汉宁窗和哈明窗均满足要求，我们选择汉宁窗。本例中过渡带宽度B?≤wp-w,=
π/4,汉宁窗的精确过渡带宽度B,=6.2π/N,所以要求B,=6.2π/N≤π/4,解之得
N≥24.8。对高通滤波器N必须取奇数，取N=25。由式(7.2.11),有
u(n)=0.5[1-cos()]Rs(n)
(2)构造H(e"):
HC)-{l<
式中 =N-1=12,==8
(3)求出ha(n):
ha(n)=-H?(e)edo
第7章有限脉冲响应数字滤波器的设计
243
Created by ZhuangHeng
口
口□
口口
口
数字信号处理(第五版)
-去(~cd+ccd)
=sincn--sin-
将r=12代入得
h?(n)=8(n-12)-sin3(n-12)/8
sinBcn-12)/8 δ(n-12)对应全通滤波器， 是截止频率为3π/8的理想低通滤波器的单位
脉冲响应，二者之差就是理想高通滤波器的单位脉冲响应。这就是求理想高通滤波器的单
位脉冲响应的另一个公式。
(4)加窗：
h(n)=h(n)w(n)
={o(n-12)-sin3can-12)/8\[0.5-0.5cos(婴)]Ra(n)
7.2.4 窗函数法的MATLAB设计函数简介
实际设计时一般用MATLAB工具箱函数。可调用工具箱函数 firl实现窗函数法设计
步骤(2)～(4)的解题过程。
(1)firl是用窗函数法设计线性相位FIR数字滤波器的工具箱函数，实现线性相位
FIR数字滤波器的标准窗函数法设计。这里的所谓“标准”,是指在设计低通、高通、带通和
带阻FIR滤波器时，Ha(e")分别表示相应的线性相位理想低通、高通、带通和带阻滤波器
的频率响应函数。因而将所设计的滤波器的频率响应称为标准频率响应。
firl的调用格式及功能：
·hn=firl(M,wc),返回6dB截止频率为we的M阶(单位脉冲响应h(n)长度N=
M+1)FIR低通(wc为标量)滤波器系数向量hn,默认选用哈明窗。滤波器单位脉冲响应
h(n)与向量hn的关系为
h(n)=hn(n+1)n=0,1,2,…,M
而且满足线性相位条件：h(n)=h(N-1-n)。其中we为对π归一化的数字频率，
0≤we≤1。
当we=[wel,wcu]时，得到的是带通滤波器，其-6 dB通带为wel≤w≤wcu。
·hn=firl(M,we,'ftype'),可设计高通和带阻FIR滤波器。当ftype=high时，设计
高通FIR滤波器；当ftype=stop,且wc=[wel,wcu]时，设计带阻FIR滤波器。
应当注意，在设计高通和带阻FIR滤波器时，阶数M只能取偶数(h(n)长度N=M+1
为奇数)。不过，当用户将M设置为奇数时，fir1会自动对M加1。
·hn=firl(M,we,window),可以指定窗函数向量window。如果缺省 window 参数，
则firl默认为哈明窗。例如：
244
Created by ZhuangHeng
hn=fir1(M,we,bartlett(M+1)),使用Bartlett 窗设计；
hn=firl(M,we,blackman(M+1)),使用blackman 窗设计；
hn=firl(M,wc,ftype,window),通过选择 wc、ftype和window 参数(含义同上),
可以设计各种加窗滤波器。
(2)fir2为任意形状幅度特性的窗函数法设计函数，用fir2设计时，可以指定任意形状
的H?(e"),它实质是一种频率采样法与窗函数法的综合设计函数。主要用于设计幅度特性
形状特殊的滤波器(如数字微分器和多带滤波器等)。用help命令查阅其调用格式及调用参
数的含义。
例7.2.1的设计程序ep721.m如下：
?721.m:例7.2.1用窗函数法设计线性相位高通FIR数字滤波器
wp=pi/2;ws=pi/4:
??算过渡带宽度 Bt=wp-ws;
??据表7.2.2汉宁窗计算所需h(n)长度NO,ceil(x)取大于等于 NO=ceil(6.2*pi/Bt);
的最小整数
??保h(n)长度N是奇数 N=NO+mod(N0+1,2):
??算理想高通滤波器通带截止频率(关于π归一化) we=(wp+ws)/2/pi:
hn=firl(N-1,we,high,hanning(N));??用 firl计算高通 FIR数字滤波器的h(n)
??去绘图部分
运行程序得到h(n)的25个值：
h(n)=[-0.0004 -0.0006 0.0028 0.0071 -0.0000 -0.0185 -0.0210
0.0165 0.0624 0.0355 0.1061 -0.2898 0.6249 -0.2898
-0.1061 0.0355 0.0624 0.0165 -0.0210 0.0185 -0.0000
0.0071 0.0028 -0.0006 -0.0004]
高通FIR 数字滤波器的h(n)及损耗函数如图7.2.9所示。
1 oF
0.5
是
0 201g1N.(o) -20
-40
-60 A
-0.50
-80 10 20 30 0 0.5 1
n @/π
(a)h(n)波形 (b)损耗函数曲线 第7章有限脉冲响应数字滤波器的设计
图7.2.9 高通FIR数字滤波器的h(n)波形及损耗函数曲线
【例7.2.2】 对模拟信号进行低通滤波处理，要求通带0≤f≤1.5kHz内衰减小于
1 dB,阻带2.5kHz≤f≤上衰减大于40dB。希望对模拟信号采样后用线性相位FIR数
字滤波器实现上述滤波，采样频率F,=10 kHz。用窗函数法设计满足要求的FIR 数字低通
245
Created by ZhuangHeng
数字信号处理(第五版)
滤波器，求出h(n),并画出损耗函数曲线。为了降低运算量，希望滤波器阶数尽量低。
解(1)确定相应的数字滤波器指标：
通带截止频率为
=/=2m×1000-0.3π
阻带截止频率为
-=2π×1000=0.5m
阻带最小衰减为
a,=40 dB
(2)用窗函数法设计FIR 数字低通滤波器，为了降低阶数选择凯塞窗。根据式
(7.2.16)计算凯塞窗的控制参数为
a=0.5842(a,-21)°?+0.07886(a,-21)=3.3953
指标要求过渡带宽度B,=w,-w,=0.2π,根据式(7.2.17)计算滤波器阶数为
M=2.285B.2.285×8.2π=22.2887
取满足要求的最小整数M=23。所以h(n)长度为N=M+1=24。但是，如果用汉宁窗，
h(n)长度为N=40。理想低通滤波器的通带截止频率w.=(w,+w。)/2=0.4π,所以由式
(7.2.2)和式(7.2.3),得到：
h(n)=ha(n)u(n)=sinlo.4(n-)u(n) r=N21=11.5
式中，w(n)是长度为24(α=3.395)的凯塞窗函数。
实现本例设计的MATLAB程序为ep722.m。
?722.m:例7.2.2用凯塞窗函数设计线性相位低通 FIR数字滤波器
fp=1500;fs=2500;rs=40;
wp=2*pi*fp/Fs;ws=2*pi*fs/Fs;
Bt=ws-wp; ??算过渡带宽度
alph=0.5842*(rs-21)0.4+0.07886*(rs-21):??据(7.2.16)式计算kaiser窗的控制参数α
M=ceil((rs-8)/2.285/Bt);??据(7.2.17)式计算kaiser 窗所需阶数M
wc=(wp+ws)/2/pi:??算理想高通滤波器通带截止频率(关于π归一化)
hn=firl(M,we,kaiser(M+1,alph));??用 firl计算低通 FIRDF的h(n)
??下绘图部分省去
运行程序得到h(n)的24个值：
h(n)=[ 0.0039 0.0041 -0.0062 -0.0147 0.0000 0.0286 0.0242
-0.0332 -0.0755 0.0000 0.1966 0.3724 0.3724 0.1966
0.0000 -0.0755 -0.0332 0.0242 0.0286 0.0000 -0.0147
-0.0062 0.0041 0.0039]
低通FIR数字滤波器的h(n)波形和损耗函数曲线如图7.2.10所示。
246
Created by ZhuangHeng
0.4 o
0.3
-20
是
02
0.1
0
. 20181H")oor-60
-40
-0.10 10 20 30 -800 0.5 1
"
w/
(a)h(n)波形 (b)损耗函数曲线
图7.2.10 低通FIR 数字滤波器的h(n)波形及损耗函数曲线
【例7.2.3】 用窗函数法设计一个线性相位FIR带阻滤波器。要求通带下截止频率
o=0.2π,阻带下截止频率w,=0.35π,阻带上截止频率wm=0.65π,通带上截止频率
=0.8π,通带最大衰减ap=1 dB,阻带最小衰减a=60 dB。
解 本例直接调用firl 函数设计。因为阻带最小衰减a,=60 dB,所以选择布莱克曼
窗，再根据过渡带宽度选择滤波器长度N,布莱克曼窗的过渡带宽度B?=12π/N,所以
12x≤up-=0.35π-0.2π=0.15π
=[2,2]. 解之得N=80。调用参数
设计程序为ep723.m,参数计算也由程序完成。
?723.m:例7.2.3用窗函数法设计线性相位带阻FIR数字滤波器
wlp=0.2*pi;wls=0.35*pi;wus=0.65*pi:wup=0.8*pi;??计指标参数赋值
??渡带宽度 B=wls-wlp;
M=ceil(12*pi/B)-1: ??算阶数M, ceil(x)为大于等于x的最小整数
wp=[(wls+wlp)/2/pi,(wus+wup)/2/pi]:??置理想带阻截止频率
hn=firl(M,wp,'stop',blackman(M+1));??阻滤波器要求h(n)长度为奇数，firl会自动处理
??略绘图部分
程序运行结果：
N=80
由于h(n)数据量太大，因而仅给出h(n)的波形及损耗函数曲线，如图7.2.11所示。
0.6
0.4
加m 0.2
0
-0.2
0
oF
-20
20181H,(o-40
-60
-80
20 40 60 80 0 0.2 0.4 0.6
n o/π
(a)h(n)波形 (b)损耗函数曲线
图7.2.11 带阻FIR 数字滤波器的h(n)波形及损耗函数曲线
第7章有限脉冲响应数字滤波器的设计
0.8 1
247
Created by ZhuangHeng
数字信号处理(第五版)
248
由图可见，阻带衰减有较大的富余。如果选用凯塞窗设计，滤波器长度N=50就可以满足
设计指标。由此可以看出凯塞窗函数的显著优点。
7.3 利用频率采样法设计FIR滤波器
1.用频率采样法设计FIR滤波器的基本思想
设希望逼近的滤波器的频响函数用H?(e")表示，对H(e)在w=0到2π之间等间隔
采样N点，得到H(k):
H?(k)=H?(e~)|- k=0,1,2,…,N-1 (7.3.1)
再对H(k)进行N点IDFT,得到h(n):
h()=六H?(A)Wn=0,1,2,…,N-1 (7.3.2)
将h(n)作为所设计的FIR 滤波器的单位脉冲响应，其系统函数H(z)为
H(2)=_h(n (7.3.3)
另外根据频率域采样理论，利用频率域采样值恢复原信号Z变换的(3.3.5)和(3.3.6)式，
得到H(z)的内插表示形式：
H(2)=1=2IHwk) (7.3.4)
此式就是直接利用频率采样值H?(k)形成滤波器的系统函数，(7.3.3)式适合FIR 直接型
网络结构，(7.3.4)式适合频率采样结构。下面讨论两个问题：一个是为了设计线性相位
FIR滤波器，频域采样序列H?(k)应满足的条件；另一个是逼近误差问题及其改进措施。
2.设计线性相位滤波器时对H(k)的约束条件
FIR 滤波器具有线性相位的条件是h(n)为实序列，且满足h(n)=h(N-n-1),在此
基础上我们已推导出其频响函数应满足的条件是：
H?(e")=H(o)e (7.3.5)
(m)=-N-1 (7.3.6)
H(w)=H(2π-w)N=奇数 (7.3.7)
H(a)=-H(2π-a)N=偶数 (7.3.8)
在w=0~2π区间上N个等间隔的采样频点为
=2 k=0,1,2,…,N-1
将w=w,代入(7.3.5)～(7.3.8)式中，并写成k的函数：
H?(k)=H?(k)e (7.3.9)
8(k)=-N-12k=-N1k (7.3.10)
Created by ZhuangHeng
H?(k)=H(N-k)N=奇数 (7.3.11)
H?(k)=-H?(N-k)N=偶数 (7.3.12)
(7.3.9)～(7.3.12)式就是对频率采样值的约束条件。(7.3.11)式说明，N等于奇数时
H,(k)关于N/2点偶对称。(7.3.12)式说明，N等于偶数时，H?(k)关于N/2点奇对称，
且H(N/2)=0。
设用理想低通作为希望逼近的滤波器H(e),截止频率为w.,采样点数为N,H?(k)
和θ(k)用下列公式计算：
N=奇数时，
N-k)=1 k=0,1,2,…,k
B,A)=0k=k+1,k+2, (7.3.13)
k=0,1.2. ….N
N=偶数时，
,--+1.A+2,, (7.3.14)
上面公式中的k。是通带内最后一个采样点的序号，所以k。的值取不大于[w.N/(2π)]的最
大整数。另外，本节设计的是第一类线性相位FIR滤波器，所以，对于高通和带阻滤波器，
N只能取奇数。
3.逼近误差及其改进措施
如果待逼近的滤波器为H?(e"),对应的单位脉冲响应为h(n),则由频率域采样定理
知道，在频域0~2π范围等间隔采样N点，利用IDFT得到的h(n)应是ha(n)以N为周期
的周期延拓的主值区序列，即
h(n)=∑ha(n+mN)Rx(n)
如果H?(e")有间断点，那么相应的单位脉冲响应h(n)应是无限长的。这样，由于时域混
叠及截断，使h(n)与ha(n)有偏差。所以，频域的采样点数N愈大，时域混叠愈小，设计出
的滤波器频响特性愈逼近H(e")。
上面是从时域分析其设计误差的来源，下面从频域分析。频域采样定理表明，频率
域等间隔采样H(k),经过IDFT得到h(n),由(3.3.7)和(3.3.8)式，得到H(e")=
FT[h(n)]的内插表示形式：
H(e)=2H(k)om--)
第7章有限脉冲响应数字滤波器的设计
式中
249
Created by ZhuangHeng
口
口
口口
n
数字信号处理(第五版)
(m)=1sincuN/2)。
上式表明，在采样频点，w=2πk/N,k=0,1,2,…,N-1,Φ(w-2πk/N)=1,因此采样点
处H(e”)与H(k)相等，逼近误差为0。在采样点之间，H(e")由N项H(k)φ(w-2πk/N)之
和形成。频域幅度采样序列H?(k)及其内插波形 H(w)如图7.3.1所示。图7.3.1(a)中，实
线表示希望逼近的理想幅度函数H(w),黑点表示幅度采样序列H?(k);图7.3.1(b)中，实
线H?(co)与虚线H(w)的误差与H(w)特性的平滑程度有关，H(w)特性愈平滑的区域，误
差愈小；特性曲线间断点处，误差最大。表现形式为间断点变成倾斜下降的过渡带曲线，过渡
带宽度近似为2π/N。通带和阻带内产生震荡波纹，且间断点附近振荡幅度最大，使阻带衰减
减小，往往不能满足技术要求。当然，增加N可以使过渡带变窄，但是通带最大衰减和阻带
最小衰减随N的增大并无明显改善。且N太大，会增加滤波器的阶数，即增加了运算量和成
本。N=15和N=75两种情况下的幅度内插波形 H(w)如图7.3.2所示，图中的空心圆和实
心圆点分别表示N=15和N=75时的频域幅度采样。运行本书程序库程序fig731-2.m,即可
绘制出图7.3.1和图7.3.2,并分别输出两种采样点数(N=15和N=75)的通带最大衰减a。和阻
带最小衰减α,。N=15时，通带最大衰减a=0.8340 dB,阻带最小衰减a=-15.0788 dB;
N=75时，通带最大衰减a=1.0880 dB,阻带最小衰减a,=-16.5815 dB。所以，直接对理想滤
波器的频率响应采样的“基本频率采样设计法”不能满足一般工程对阻带衰减的要求。
1+
0.8
H?(k) 0.4
0.6
0.2
0
0
1
0.8
o),月 0.6
0.4
0.2
0
-0.2
0
0.5 1 1.5
w/π
0.5 1 1.5
w/π
图7.3.1 频域幅度采样序列H?(k)及其内插波形H(w)
2
2
250
(a)
(b)
Created by ZhuangHeng
1*
0.8
0.6
@),月 0.4
0.2
0
-0.20 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
w/π
图7.3.2 N=15和N=75的幅度内插波形H?(a)
在窗函数设计法中，通过加大过渡带宽度换取阻带衰减的增加。频率采样法同样满足
这一规律。提高阻带衰减的具体方法是在频响间断点附近区间内插一个或几个过渡采样
点，使不连续点变成缓慢过渡带，这样，虽然加大了过渡带，但阻带中相邻内插函数的旁瓣
正负对消，明显增大了阻带衰减。
过渡带采样点的个数与阻带最小衰减a。的关系以及使阻带最小衰减α,最大化的每个
过渡带采样值求解都要用优化算法解决。其基本思想是将过渡带采样值设为自由量，用一
种优化算法(如线性规划算法)改变它们，最终使阻带最小衰减α,最大。该内容已超出本书
要求。为了说明这种优化的有效性和上述改进措施的正确性，例7.3.1中，运行程序时，采
用累试法得到满足指标要求的过渡带采样值。
将过渡带采样点的个数m与滤波器阻带最小衰减α,的经验数据列于表7.3.1中，我们
可以根据给定的阻带最小衰减α,选择过渡带采样点的个数m。
表7.3.1 过渡带采样点的个数m与滤波器阻带最小衰减α,的经验数据
m 1 2 3
a 44~54 dB 65~75 dB 85～95 dB
4.频率采样法设计步骤
综上所述，可归纳出频率采样法的设计步骤：
(1)根据阻带最小衰减a。选择过渡带采样点的个数m。
(2)确定过渡带宽度B,,估算频域采样点数(即滤波器长度)N。如果增加m个过渡带
采样点，则过渡带宽度近似变成(m+1)2π/N。当N确定时，m越大，过渡带越宽。如果给
定过渡带宽度B,,则要求(m+1)2π/N≤B,,滤波器长度N必须满足如下估算公式：
第7章有限脉冲响应数字滤波器的设计
N≥(m+D管 (7.3.15)
(3)构造一个希望逼近的频率响应函数：
H?(e")=H(w)eN-1/
设计标准型片段常数特性的FIR数字滤波器时，一般构造幅度特性函数H(w)为相应的
251
Created by ZhuangHeng
数字信号处理(第五版)
理想频响特性，且满足表7.1.1要求的对称性。
(4)按照(7.3.1)式进行频域采样：
H(k)=H?(e~)L=H?(k)e (7.3.16) k=0,1,2,…,N-1
H?(k)=H() k=0,1,2,…,N-1 (7.3.17)
并加入过渡带采样。过渡带采样值可以设置为经验值，或用累试法确定，也可以采用优化
算法估算。
(5)对H(k)进行N点IDFT,得到第一类线性相位FIR数字滤波器的单位脉冲响应：
h(n)=IDFT[H(k)]=六≥H(k)Wn=0,1,2,…,N-1(7.3.18)
(6)检验设计结果。如果阻带最小衰减未达到指标要求，则要改变过渡带采样值，直到
满足指标要求为止。如果滤波器边界频率未达到指标要求，则要微调H(w)的边界频率。
上述设计过程中的计算相当烦琐，所以通常借助计算机设计。MATLAB就是一种很
有效的语言。
【例7.3.1】 用频率采样法设计第一类线性相位低通FIR数字滤波器，要求通带截止
频率w=π/3,阻带最小衰减大于40 dB,过渡带宽度B?≤π/16。
解 查表7.3.1,a,=40 dB时，过渡带采样点数m=1。将m=1和B?≤π/16代人
(7.3.15)式估算滤波器长度：N≥(m+1)2π/B=64,留一点富余量，取N=65。构造H?(e)=
H(w)eN-D/2为理想低通特性，其幅度响应函数H(a)如图7.3.3(a)中实线所示。
设计由以下程序ep731.m完成：
?731.m:用频率采样法设计FIR低通滤波器
T=input('T=') ??入过渡带采样值T
Bt=pi/16;wp=pi/3; ??渡带宽度为pi/16,通带截止频率为pi/3
m=1;N=ceil((m+1)*2*pi/Bt); ??式(7.3.15)估算采样点数N
??N为奇数 N=N+mod(N+1,2):
?+1为通带[0,wp]上采样点数 Np=fix(wp/(2*pi/N)):
?为阻带[wp.2×pi-wp]上采样点数 Ns=N-2*Np-1:
Hk=[ones(1.Np+1),zeros(1,Ns),ones(1,Np)];
为奇数，幅度采样向量偶对称A(k)=A(N-k)
Hk(Np+2)=T:Hk(N-Np)=T; ?一个过渡采样
??位采样向量θ(k)=(N-1)πk/N.0≤k≤N-1 thetak=-pi*(N-1)(0:N-1)/N;
Hdk=Hk.*expGj*thetak); ??造频域采样向量Hd(k)
hn=real(ifft(Hdk)); ?n)=IDFT[H(k)],real只取实部，忽略计算误差引起的虚部
Hw=fft(hn,1024); ??算频率响应函数：DFT[h(n)]
wk=2*pix[0:1023]/1024;
Hgw=Hw.*expG·wk+(N-1/2);??算幅度响应函数Hg(m)=H(e-)·e
??算通带最大衰减Rp和阻带最小衰减Rs
Rp=max(20*log10(abs(Hgw)))
252
Created by ZhuangHeng
hgmin=min(real(Hgw));Rs=20*log10(abs(hgmin))
??下绘图部分略去
运行程序，输入T=0.38,得到设计结果如图7.3.3所示，并输出通带最大衰减a=
0.4767dB,阻带最小衰减α。=-43.4411 dB。但是，如果过渡带采样值T=0.5和0.6,则
得到阻带最小衰减a=-29.6896 dB和-25.0690 dB。由此可见，当过渡带采样点数给定
时，过渡带采样值不同，则逼近误差不同。所以，对过渡带采样值进行优化设计才是有效的
方法。
1
H 0.5 (a)
0
0 0.5 1 1.5 2
@/π
0.4
州用 0.2 (b)
0
-0.2
0 20 40 60
0F
20181N,(oo -20
(c)
-40
-60l0 0.5 1
o/π
图7.3.3 一个过渡点的设计结果(过渡带采样值T=0.38)
MATLAB信号处理工具箱函数fir2是一种频率采样法与窗函数法相结合的FIR 数字
滤波器设计函数。
hn= fir2(M,F,A,window(M+1))设计一个M阶线性相位FIR数字滤波器，返回长
度为N=M+1的单位脉冲响应序列向量hn。window表示窗函数名，缺省该项时默认选用
Hamming窗。可供选择的窗函数有Boxcar、Bartlett、Hann、Hamm、Blackman、Kaiser和
Chebwin。当window=boxcar时，fir2就是纯粹的频率采样设计法。希望逼近的幅度特性由边
界频率向量F和相应的幅度向量A确定，plot(F,A)画出的就是希望逼近的幅度特性曲线。
F为对π归一化的数字频率向量，0≤F≤1。而且F的元素必须是单调递增的，以0开始，
以1结束，1对应于模拟频率Fs/2。对例7.3.1,F=[0,wp/pi,wp/pi+2/N,wp/pi+4/N,
第7章有限脉冲响应数字滤波器的设计
1];A=[1,1,T,0,0]。其中，we/pi+2/N为过渡带采样点频率，T为过渡带采样值。
253
Created by ZhuangHeng
口
口
口口
口
口口
口口
口
口
数字信号处理(第五版)
plot(F,A)画出的就是希望逼近的幅度特性曲线，如图7.3.4所示。调用fir2求解例7.3.1
的程序为ep731b.m。与程序ep731.m比较，ep731b.m更加简单。
1
日。(or 0.5
0
0 0.2 0.4 0.60.8 1
@/π
图7.3.4 例7.3.1希望逼近的幅度特性(T=0.38)
应当注意，用Fir2设计FIR数字滤波器时，应当灵活利用其频率采样法与窗函数法相
结合的特性，既可以采用优化过渡带采样，设计希望逼近的幅度特性，来控制阻带最小衰
减(程序ep731b.m中采用这种方法),又可以不加过渡带采样，通过选用合适的窗函数来
控制阻带最小衰减。但优化过渡带采样可以使滤波器阶数更低。
??用 fir2求解例7.3.1的程序ep731b.m
T=input('T=) ??入过渡采样值T
??渡带宽度pi/16,通带截止频率为pi/3; Bt=pi/16:wp=pi/3;
m=1: ??渡点个数m=1
N=ceil((m+1)*2·pi/Bt)+1 ??(7.3.15)式估算采样点数N
F=[0,wp/pi,wp/pi+2/N.wp/pi+4/N,1];A=[1,1.T,0.0]:??置调用参数向量F和A
hn=fir2(N-1.F,A,boxcar(N));??用矩形窗函数
以下与ep731.m相同(省略)。
窗函数设计法和频率采样法简单方便，易于实现。但它们存在以下缺点：①滤波器边
界频率不易精确控制。②窗函数设计法总使通带和阻带波纹幅度相等，频率采样法只能依
靠优化过渡带采样点的取值控制阻带波纹幅度，所以两种方法都不能分别控制通带和阻带
波纹幅度。但是工程上对二者的要求是不同的，希望能分别控制。③所设计的滤波器在阻
带边界频率附近的衰减最小，距阻带边界频率越远，衰减越大。所以，如果在阻带边界频率
附近的衰减刚好达到设计指标要求，则阻带中其他频段的衰减就有很大富余量。这就说明
这两种设计法存在较大的资源浪费，或者说所设计滤波器的性能价格比低。下一节介绍一
种能克服上述缺点的最优逼近设计方法。
7.4 利用等波纹最佳逼近法设计FIR数字滤波器
等波纹最佳逼近法是一种优化设计法，它克服了窗函数设计法和频率采样法的缺点，
使最大误差(即波纹的峰值)最小化，并在整个逼近频段上均匀分布。用等波纹最佳逼近法
设计的FIR数字滤波器的幅频响应在通带和阻带都是等波纹的，而且可以分别控制通带和
阻带波纹幅度。这就是等波纹的含义。最佳逼近是指在滤波器长度给定的条件下，使加权
254
Created by ZhuangHeng
误差波纹幅度最小化。与窗函数设计法和频率采样法比较，由于这种设计法使最大误差均
匀分布，所以设计的滤波器性能价格比最高。阶数相同时，这种设计法使滤波器的最大逼
近误差最小，即通带最大衰减最小，阻带最小衰减最大；指标相同时，这种设计法使滤波器
阶数最低。
等波纹最佳逼近设计法的数学证明复杂，已超出本科生的数学基础。所以本节略去等
波纹最佳逼近法复杂的数学推导，只介绍其基本思想和实现线性相位FIR数字滤波器的等
波纹最佳逼近设计的MATLAB信号处理工具箱函数 remez和 remezord. remez函数采用
数值分析中的remez多重交换迭代算法求解等波纹最佳逼近问题，求得满足等波纹最佳逼
近准则的FIR数字滤波器的单位脉冲响应h(n)。由于切比雪夫(Chebyshev)和雷米兹
(Remez)对解决该问题做出了贡献，所以又称之为切比雪夫逼近法，或雷米兹逼近法。
7.4.1 等波纹最佳逼近法的基本思想
用H(w)表示希望逼近的幅度特性函数，要求设计线性相位FIR数字滤波器时，
H?(w)必须满足线性相位约束条件。用H?(o)表示实际设计的滤波器幅度特性函数。定义
加权误差函数E(w)为
E(w)=W(w)[H(w)-H(w)] (7.4.1)
式中，W(w)称为误差加权函数，用来控制不同频段(一般指通带和阻带)的逼近精度。等波
纹最佳逼近基于切比雪夫逼近，在通带和阻带以|E(w)|的最大值最小化为准则，采用
Remez多重交换迭代算法求解滤波器系数h(n)。所以W(w)取值越大的频段，逼近精度
越高，开始设计时应根据逼近精度要求确定W(w),在Remez多重交换迭代过程中W(w)是
确知函数。
等波纹最佳逼近设计中，把数字频段分为“逼近(或研究)区域”和“无关区域”。逼近区
域一般指通带和阻带，而无关区域一般指过渡带。设计过程中只考虑对逼近区域的最佳逼
近。应当注意，无关区宽度不能为零，即H(w)不能是理想滤波特性。
利用等波纹最佳逼近准则设计线性相位FIR数字滤波器数学模型的建立及其求解算法
的推导复杂，求解计算必须借助计算机，幸好滤波器设计专家已经开发出MATLAB信号
处理工具箱函数 remezord和remez,只要简单地调用这两个函数就可以完成线性相位FIR
数字滤波器的等波纹最佳逼近设计。
在介绍MATLAB工具箱函数 remezord和 remez之前，先介绍等波纹滤波器的技术指
标及其描述参数。
图7.4.1给出了等波纹滤波器技术指标的两种描述参数。图7.4.1(a)用损耗函数描
第7章有限脉冲响应数字滤波器的设计
述，即w。=π/2,a=2 dB,w,=11π/20,a,=20 dB。这是工程实际中常用的指标描述方法。
但是，用等波纹最佳逼近设计法求滤波器阶数N和误差加权函数W(w)时，要求给出滤波
器通带和阻带的振荡波纹幅度δ?和δ?。图7.4.1(b)给出了用通带和阻带的振荡波纹幅度
δ,和δ。描述的技术指标。显然，两种描述参数之间可以换算。如果设计指标以ap和a,给
出，为了调用MATLAB工具箱函数 remezord和 remez进行设计，就必须由ap和a,换算
255
Created by ZhuangHeng
出通带和阻带的振荡波纹幅度δ?和δ?。对比图7.4.1(a)和(b)得出关系式：
=-201g(1+i)=201g() (7.4.2)
a,=-201g(1+i)~-20lgo? (7.4.3)
由式(7.4.2)和(7.4.3)得到
=11 (7.4.4)
8?=102 (7.4.5)
按照式(7.4.4)和(7.4.5)计算得到图7.4.1(b)中的参数：8?=0.1146,δ?=0.1。实际中，
δ,和δ?一般很小，这里为了观察等波纹特性及参数δ?和δ?的含义，特意取较大值。
口
数字信号处理(第五版)
10 1+6
0 无关区 1-8 201g1H,(o) -10 0.8
-20 )o),H 无关区
0.6
-30 0.4 δ
-40 0.2
-50l0 0.4以a @/π
0.8 0
0 0.4以 0.8
(a)
w/m
(b)
图7.4.1 等波纹滤波器的幅频特性函数曲线及指标参数
下面举例说明误差加权函数W(w)的作用，以及滤波器h(n)长度N和波纹幅度8?和
8?的制约关系。设期望逼近的通带和阻带分别为[0,π/4]和[5π/16,π],对下面四种不同
的控制参数，等波纹最佳逼近的损耗函数曲线分别如图7.4.2(a)、(b)、(c)和(d)所示。图
中，W=[w?,w?]表示第一个逼近区[0,π/4]上的误差加权函数W(w)=w?,第二个逼近
区[5π/16,π]上的误差加权函数W(w)=w?。图7.4.2(a)中，通带频段[0,π/4]上的
W(w)=1,阻带频段[5π/16,π]上的W(w)=10。
比较图7.4.2(a)、(b)、(c)和(d)可以得出结论：当N一定时，误差加权函数W(w)较
大的频带逼近精度较高，W(w)较小的频带逼近精度较低，如果改变W(w)使通(阻)带逼近
精度提高，则必然使阻(通)带逼近精度降低。滤波器阶数N增大才能使通带和阻带逼近精
度同时提高。所以，W(w)和N由滤波器设计指标(即ap和a,以及过渡带宽度)确定。所以
用等波纹最佳逼近法设计FIR数字滤波器的过程是：
(1)根据给定的逼近指标估算滤波器阶数N和误差加权函数W(w);
(2)采用remez算法得到滤波器单位脉冲响应h(n)。
MATLAB工具箱函数 remezord和 remez就是完成以上2个设计步骤的有效函数。
256
Created by ZhuangHeng
0 0l
201g1H,(o) -20
-40
201g1H.(o) -20
-40
-60l -60L
00.2 0.4 0.6 0.8 0 0.2 0.4 0.60.8
o/π o/π
(a)N=33,W=[1,10] (b)N=33,W=[10.1]
0 ol
201g1H,(on-20
-40 -40F
-60l -60L
0 0.2 0.4 0.6 0.8 0 0.2 0.4 0.6 0.8
o/π a/π
(c)N-33,W=[1.1] (d)N-63,W-[1,1]
图7.4.2 误差加权函数W(a)和滤波器阶数N对逼近精度的影响
7.4.2 remez和 remezord函数及滤波器设计指标
1. remez和 remezord 函数
1)remez
remez函数实现线性相位FIR数字滤波器的等波纹最佳逼近设计。其调用格式为
hn=remez(M,f,m,w)
调用结果返回单位脉冲响应向量hn。remez 函数的调用参数(M,f,m,w)一般通过调用
remezord 函数来计算。调用参数含义如下：
M为FIR 数字滤波器阶数，hn长度N=M+1。
f和m给出希望逼近的幅度特性。f为边界频率向量，0≤f≤1,要求f为单调增向量
(即f(k)<f(k+1),k=1,2,…),而且从0开始，以1结束，1对应数字频率w=π(模拟频
第7章有限脉冲响应数字滤波器的设计
率F./2,F,表示时域采样频率)。m是与f对应的幅度向量，m与f长度相等，m(k)表示频
点f(k)的幅度响应值。如果用命令Plot(f,m)画出幅频响应曲线，则k为奇数时，频段
[f(k),f(k+1)]上的幅频响应就是期望逼近的幅频响应值，频段[f(k+1),f(k+2)]为无
关区。简言之，Plot(f,m)命令画出的幅频响应曲线中，起始频段为第一段，奇数频段为逼
近区，偶数频段为无关区。
257
Created by ZhuangHeng
口
口
口
口口
口口
口口
a口
数字信号处理(第五版)
例如，对图7.4.2,f=[0,1/4,5/16,1];m=[1,1,0.0]:plot(f,m)画出的幅度特
性曲线如图7.4.3所示，图中奇数段(第一、三段)的水平幅度为希望逼近的幅度特性，偶
数段(第二段)的下降斜线为无关部分，逼近时形成过渡带，并不考虑该频段的幅频响应
形状。
w为误差加权向量，其长度为f的一半。w(i)表示对m中第i个逼近频段的误差加权
值。图7.4.2(a)中，w=[1,10]。缺省w时，默认w为全1(即每个逼近频段的误差加权值
相同)。除了设计选频FIR数字滤波器，remez 函数还可以设计两种特殊滤波器：希尔伯特
变换器和数字微分器，调用格式分别为
hn=remez(M,f,m,w,hilbert')
hn=remez(M,f,m,w,'defferentiator')
希尔伯特变换器和数字微分器设计和应用的详细内容请参考文献[10,19]。
2)remezord
采用 remezord 函数，可根据逼近指标估算等波纹最佳逼近FIR 数字滤波器的最低阶
数M、误差加权向量w和归一化边界频率向量f,使滤波器在满足指标的前提下造价最低。
其返回参数作为 remez函数的调用参数。其调用格式为
[M,fo,mo,w]=remezord(f,m,rip,Fs)
参数说明：
f与remez中的类似，这里f可以是模拟频率(单位为Hz)或归一化数字频率，但必须
从0开始，到Fs/2(用归一化频率时对应1)结束，而且其中省略了0和Fs/2两个频点。Fs
为采样频率，缺省时默认Fs=2Hz。但是这里f的长度(包括省略的0和Fs/2两个频点)是
m的两倍，即m中的每个元素表示f给定的一个逼近频段上希望逼近的幅度值。例如，对
图7.4.3,f=[1/4,5/16],m=[1,0]。
1
E0.5
0L0 0.2 0.4 0.6 0.81
f
图7.4.3 希望逼近的幅度特性曲线
注意：①省略Fs时，f中必须为归一化频率。②有时估算的阶数M略小，使设计结果
达不到指标要求，这时要取M+1或M+2(必须注意对滤波器长度N=M+1的奇偶性要
求)。所以必须检验设计结果。③如果无关区(过渡带)太窄，或截止频率太接近零频率和
Fs/2时，设计结果可能不正确。
rip 表示f和m描述的各逼近频段允许的波纹幅度(幅频响应最大偏差),f的长度是
rip的两倍。
一般以[N,fo,mo,w]=remezord(f,m,rip,Fs)返回的参数作为 remez的调用参数，
258
Created by ZhuangHeng
计算单位脉冲响应：hn=remez(N,fo,mo,w)。对比前面介绍的 remez调用参数，可清楚
地看出 remezord返回参数N、fo、mo和w的含义。
综上所述，调用 remez和 remezord 函数设计线性相位FIR数字滤波器，关键是根据设
计指标求出 remezord函数的调用参数f、m、rip和Fs,其中Fs一般是题目给定的，或根据
实际信号处理要求(按照采样定理)确定。下面给出由给定的各种滤波器设计指标确定
remezord调用参数f、m和 rip的公式，编程时直接套用即可。
2.滤波器设计指标
1)低通滤波器设计指标
逼近通带：[0,wp],通带最大衰减：adB;逼近阻带：[w,,π],阻带最小衰减：a,dB。
remezord调用参数：
f=(,一),m=[1,0],rip=[8i,oz] (7.4.6)
其中，f向量省去了起点频率0和终点频率1,δ,和8?分别为通带和阻带波纹幅度，由式
(7.4.4)和(7.4.5)计算得到，下面相同。
2)高通滤波器设计指标
逼近通带：[w。,π],通带最大衰减：a,dB;逼近阻带：[0,w.],阻带最小衰减：a,dB。
remezord调用参数：
f=(,),m=[0,1],rip=[6z,oi] (7.4.7)
3)带通滤波器设计指标
逼近通带：[w,wm],通带最大衰减：a,dB;逼近阻带：[0,wa],[w,π],阻带最小
衰减：a,dB。
remezord调用参数：
f=(,,,),m=[0,1,0],rip=[8:,i,8?] (7.4.8)
4)带阻滤波器设计指标
逼近阻带：[w,w.],阻带最小衰减：a,dB;逼近通带：[0,a].[w,π],通带最大
衰减：apdB。
remezord调用参数：
r=(,,,),m=[1,0,1],rip=[oi,8:,bi] (7.4.9)
工程实际中常常给出对模拟信号的滤波指标要求，设计数字滤波器，对输入模拟信号采样
后进行数字滤波。这时，调用参数f可以用模拟频率表示。但是，调用 remezord时一定要
加入采样频率参数Fs。这种情况的调用参数及调用格式见例7.4.3。
【例7.4.1】 利用等波纹最佳逼近法重新设计FIR 带阻滤波器。指标与例7.2.3相
同，即
逼近通带：[0,0.2π],[0.8π,π],通带最大衰减：a=1 dB
第7章有限脉冲响应数字滤波器的设计
259
Created by ZhuangHeng
口
口
口
口口
口口do■国
口
数字信号处理(第五版)
逼近阻带：[0.35π,0.65π],阻带最小衰减：a.=60 dB
解 调用 remezord和 remez函数求解。由调用格式知道，首先要根据设计指标确定
remezord函数的调用参数，再直接编写程序调用 remezord和remez 函数设计得到h(n)。
将设计指标带入式(7.4.9)即可得到remezord函数的调用参数f、m和 rip。
本例设计程序为ep741.m,即
?741.m:例7.4.1用remez函数设计带阻滤波器
f=[0.2,0.35,0.65,0.8];??略了0和1
m=[1,0.1];
rp=I;rs=60;
??式(7.4.4)和式(7.4.5)求通带和阻带波纹幅度 datl、dat2和 rip:
datl=(10-(rp/20)-1)/(10(rp/20)+1);dat2=10(-rs/20);rip=[dat1,dat2,dat1]:
[M,fo,mo,w]=remezord(f,m, rip);
hn=remez(M,fo,mo,w);
??下绘图检验部分略去
程序运行结果：M=28。即h(n)的长度N=29。h(n)及其损耗函数曲线如图7.4.4所示。
例7.2.3中N=80。由此例可见，等波纹最佳逼近设计方法可以使滤波器阶数大大降低。
0.6
0.4
-20
是 0.2 幅度/dB -40
0 1 -60
-0.2L0 10 20 30
-80L
0 0.2 0.4 0.6 0.8
o/π
(a) (b)
图7.4.4 调用remez 函数设计的带阻 FIR数字滤波器的h(n)及损耗函数曲线
注意：设计结果应当是单位脉冲响应h(n)的数据序列，但是一般N较大，列出h(n)的
全部数据序列所占篇幅太大，而且从一大堆数据中看不出h(n)的变化规律，所以每道例题
只给出其波形。读者运行程序就可以得到h(n)的数据。
【例7.4.2】 利用等波纹最佳逼近法设计FIR数字低通滤波器，实现对模拟信号的数
字滤波处理。要求与例7.2.2相同。求出h(n),并画出损耗函数曲线。
解 将例7.2.2中所给指标重写如下：
通带截止频率：f,=1500 Hz,通带最大衰减：ap=1 dB
阻带截止频率：f,=2500 Hz,阻带最小衰减：a,=40 dB
对模拟信号的采样频率：F,=10 kHz
调用 remezord和remez函数设计的程序为ep742.m,即
?742.m:例7.4.2用remez函数设计低通滤波器
260
Created by ZhuangHeng
Fs=10000; ??模拟信号采样的频率为10kHz
f=[1500,2500]; ??界频率为模拟频率(Hz)
m=[1.0];
rp=1;rs=40;
datl=(10-(rp/20)-1)/(10-(rp/20)+1);dat2=10-(-rs/20);
rip=[datl,dat2];
[M,fo,mo,w]=remezord(f,m,rip,Fs);??界频率为模拟频率(Hz)时必须加入采样频率Fs
M=M+1;??算的M值达不到要求，加1后满足要求
hn=remez(M,fo,mo,w);
??下绘图检验部分省略
运行结果：滤波器阶数M=15。h(n)及损耗函数曲线如图7.4.5所示。请读者注意，例
7.2.2中用窗函数设计的滤波器阶数为23。
0.4
0
0.3
-20 0.2
是 0.1 幅度/dB —40—
0咔 —60—
-0.1
0 5 10 15 -80L
00.2 0.4 0.6 0.8
A @/π
(a) (b)
图7.4.5 调用 remez函数设计的低通FIR数字滤波器的h(n)及损耗函数曲线
7.5 IIR和FIR数字滤波器的比较
前面我们讨论了IIR和FIR两种滤波器的设计方法。这两种滤波器究竟各自有什么特
点?在实际运用时应该怎样去选择它们呢?为了回答这个问题，下面对这两种滤波器作一
简单的比较。
首先，从性能上来说，IIR滤波器系统函数的极点可位于单位圆内的任何地方，因此零
点和极点相结合，可用较低的阶数获得较高的选择性，所用的存储单元少，计算量小，所以
经济高效。但是这个高效率是以相位的非线性为代价的。相反，FIR滤波器却可以得到严
格的线性相位，然而由于FIR滤波器系统函数的极点固定在原点，因而只能用较高的阶数
(即较多的零点)达到高的选择性；对于同样的滤波器幅频特性指标，FIR滤波器所要求的
阶数一般比IIR滤波器高5～10倍，使成本较高，信号延时也较大；如果按相同的选择性和
相同的线性相位要求来说，则IIR滤波器就必须加全通网络进行相位校正，同样要大大增
加滤波器的阶数和复杂性。
第7章有限脉冲响应数字滤波器的设计
从结构上看，IIR滤波器必须采用递归结构，极点位置必须在单位圆内，否则系统将不
261 Created by ZhuangHeng
口口
口
□
数字信号处理(第五版)
稳定。另外，在这种结构中，由于运算过程中对序列的舍入处理，这种有限字长效应有时会
引起寄生振荡。相反，FIR滤波器主要采用非递归结构，不论在理论上还是在实际的有限
精度运算中都不存在稳定性问题，运算误差引起的输出信号噪声功率也较小。此外，FIR
滤波器可以采用FFT算法实现，在相同阶数的条件下，运算速度可以大大提高。
从设计工具看，IIR滤波器可以借助成熟模拟滤波器设计成果，因此一般都有封闭形
式的设计公式可供准确计算，计算工作量比较小，对计算工具的要求不高。FIR滤波器计
算通带和阻带衰减等仍无显式表达式，其边界频率也不易精确控制。一般，FIR滤波器的
设计只有计算程序可循，因此对计算工具要求较高。但在计算机普及的今天，很容易实现
其设计计算。
另外，也应看到，IIR滤波器虽然设计简单，但主要是用于设计具有片段常数特性的选
频型滤波器，如低通、高通、带通及带阻等，往往脱离不了几种典型模拟滤波器的频响特性
的约束。而FIR 滤波器则要灵活得多，易于适应某些特殊的应用，如构成微分器或积分器，
或用于巴特沃斯、切比雪夫等逼近不可能达到预定指标的情况，例如由于某些原因要求三
角形幅频响应或一些更复杂的幅频响应形状，因而FIR滤波器有更大的适应性和更广阔的
应用场合。
从上面的简单比较可以看到，IIR与FIR滤波器各有所长，所以在实际应用时应该全
面考虑加以选择。例如，从使用要求上看，在对相位要求不敏感的场合，如语音通信等，选
用IIR滤波器较为合适，这样可以充分发挥其经济高效的特点；而对于图像信号处理，数据
传输等以波形携带信号的系统，则对线性相位要求较高，采用FIR滤波器较好。
7.6 几种特殊类型滤波器简介
前面详细介绍了通用IIR和FIR数字滤波器的分析与设计方法，可以根据选频型滤波
器技术指标要求，用通用的设计方法设计出满足要求的滤波器。但是通用的设计方法不能
满足工程实际中的一些特殊需求。例如0.19]:①梳状滤波器；②希尔伯特变换器；③数
字微分器；④全通滤波器；⑤最小相位滤波器；⑥数字谐振器；⑦正弦波发生器；⑧数
字陷波器；⑨简单整系数滤波器，等等。这些滤波器各有特点，其设计分别涉及一些特殊
的方法或理论，不能简单地用前面介绍的通用方法设计。如果用通用的滤波器设计方法设计
特殊滤波器，其结果可能复杂很多。例如，梳状滤波器的系统函数为H(z)=1-ZN,非常简
单，但是，如果用频域最小均方误差优化设计法设计，其系统函数就可能非常复杂。
不过，这些都属于实际应用技术，掌握了滤波的概念和滤波器分析与设计理论，这些
技术都很容易掌握。而且，随着集成电路技术和计算机技术的发展，有些特殊滤波器没有
过去那么重要了。例如，简单整系数滤波器是指滤波网络中的乘法增益均为简单整数的滤
波器。其优点是避免乘法运算，缺点是只能实现选择性要求不高的简单滤波。适用于要求
处理速度快，对滤波器性能要求较低，设计与实现简单的场合。现在实现数字硬件乘法器
非常容易，速度也很快，所以很多实时处理场合可以采用滤波性能更好的滤波器代替简单
262
Created by ZhuangHeng
整系数滤波器。所以，这些内容不再详细叙述，感兴趣的读者请参考有关书籍(文献[4])。
7.7 滤波器分析设计工具FDATool
FDATool(Filter Design and Analysis Tool)是一个功能强大的数字滤波器设计与分析
工具，它涵盖了信号处理工具箱中所有的滤波器设计方法。利用它可以方便地设计出满足
各种性能指标的滤波器，并可查看该滤波器的各种分析图形。待滤波器设计满意后，还可
以把其系数直接导出为MATLAB变量、文本文件或C语言头文件等。
在命令窗中运行FDATool,启动滤波器分析设计工具，界面如图7.7.1所示。
2
t
Np6)
Dne
加 上
叶
Bw
521
F
e
口
G ao0
品 C
Am Dn m0 lo
Roady
 65"n t 2四
图7.7.1 FDATool启动界面
FDATool的界面分上、下两个部分：上面部分显示有关滤波器的信息，下面部分用来
指定设计指标参数。下面按照滤波器的一般设计步骤对FDATool加以介绍。
(1)在Filter type下选择滤波器类型：低通，高通，带通，带阻，微分器，Hilbert 变换
器，多带，任意频率响应，升余弦等(如果安装了滤波器设计工具箱，则会有更多选项),然
后在Design Method下从众多的IIR或FIR滤波器设计方法中选择一个合适的设计方法
(例如，IIR 滤波器的巴特沃斯、切比雪夫、椭圆滤波器等设计方法)。
第7章有限脉冲响应数字幾波器的设计
(2)在Filter Order下选择滤波器阶数，可以使用满足要求的最小滤波器阶数或直接指
定滤波器的阶数。
(3)根据前面两步中选择的设计方法，Options下会显示与该方法对应的可调节参数。
263 Created by ZhuangHeng
口
口口
口口口口口n
口
数字信号处理(第五版)
例如选择FIR窗函数设计法时，Options 如图7.7.2所示。在该面板的Window 中可选择
不同的窗函数(包括自定义窗函数，或窗函数需要的参数),单击View 按钮可在wvtool中
查看选中的窗函数。
Options
Scnle Dlonsband
Wrsow Kaiser
Fumcion Namei
Bet 5
Vlew
图7.7.2 FIR 窗函数法对应的Options选项
(4)指定设计指标：选择滤波器的类型、设计方法和滤波器阶数时，相应的设计指标及
其含义会在Filter Specifications中用图形直观地显示出来以供设计参考。这些设计指标的
具体参数需要在Frequency Specifications和Magnitude Specifications下明确指定。
例如，选择了FIR 等波纹低通最小阶数设计后的FADTool 如图7.7.1所示，其
中，Filter Specifications显示了所选设计需指定的设计指标参数。即必须在Frequency
Specifications下设置频率单位(归一化频率单位或Hz等)、采样频率Fs、通带截止频率
Fpass和阻带截止频率Fstop,在Magnitude Specifications下设置幅度单位(dB或线性)、
通带最大衰减Apass和阻带最小衰减Astop。
一般来说，对不同的滤波器类型和设计方法需要不同的设计参数。这些参数设置栏会自
动显示在Frequency Specifications和Magnitude Specifications中，参照Filter Specifications中
的图示，可以直观地看出这些参数的含义。
(5)指定所有的设计指标后，单击FDATool最下面的Design Filter 按钮即可完成滤波
器设计。(设计完成后Design Filter按钮变为不可用，除非再次修改了设计指标。)
(6)通过FDATool的工具条(如图7.7.3所示)查看设计的滤波器性能。
幅频/相频曲线 单位阶跃响应 滤波器信息
全屏显示分析 幅频曲线 群延时 零极点图 幅度响应估计
D日凸
显示滤波器指标 单位脉冲响应 舍入噪声功率谱
相频曲线 滤波器系数
图7.7.3 FDATool的工具条
(7)使用菜单【Edit/Convert】可转换当前滤波器的实现结构。所有滤波器都能在直接
I型、直接Ⅱ型、转置直接I型、转置直接Ⅱ型、状态空间模型和格形结构之间直接转换。
此外，系统安装滤波器设计工具箱后将有更多的结构形式可供转换。
使用菜单【Edit/Convert to Second—order Sections】或【Edit/Convert to Single Section】实现
滤波器级联结构与直接型结构之间的转换。
264
Created by ZhuangHeng
(8)使用菜单【File/Export】可导出或保存设计结果。可以选择导出的是滤波器的系数
向量还是整个滤波器对象(把设计结果导出为滤波器对象qfilt时，系统应安装有滤波器设
计工具箱),可以选择把导出结果保存为MATLAB工作空间中的变量、文本文件或.MAT
文件。
(9)使用菜单【File/Export to C Header File】可以把滤波器系数保存为C语言格式的
头文件，其中系数变量的数据类型可以选择。
(10)使用菜单【file/Export to SPtool】可以把滤波器导出到信号处理工具SPtool中。
有关SPtool的使用可参阅MATLAB帮助文件或参考文献[25]。
(11)使用菜单【File】中与Session有关的子菜单，可以把整个设计保存为一个.fda文
件，或调入一个已有的设计文件，继续进行设计。
(12)如果安装了其他相关组件，FDATool的菜单条上会出现【targets】项。例如安装了
MATLAB与TI CCS的连接后，该菜单下会出现【Export to Code Composer-Studio(tm)
IDE】子项，利用它可以把滤波器系数直接传递到TI CCS Studio或DSP的内存中。
以上介绍了FDATool启动时默认显示的滤波器设计分析界面。此外，FDATool启动
界面左下侧竖向工具栏内还有7个按钮(如图7.7.1所示),自上而下依次为；①【Simulink
模型实现】(需安装DSP模块库);②【设计多采样率滤波器】;③【频率变换】;④【量化并分
析滤波器】;⑤【零极点编辑器】;⑥【导入并分析滤波器】;⑦【设计并分析滤波器(默认)】。
如果安装了滤波器设计工具箱和信号处理工具箱，单击这些按钮还可以显示其他相应的设
计分析界面。有关这方面的内容可参考文献[25]。下面仅对【量化并分析滤波器】按钮进行
简单介绍，以便读者观察滤波器系数量化效应。
(13)进行滤波器量化。在MATLAB环境下，运行在PC机上的滤波器都是双精度格
式(即滤波器系数的数据类型为64位双精度浮点制),可认为没有量化误差。但在空间和能
量都十分有限的设备(如手机)上，系统字长较短，常常要对滤波器进行定点或浮点量化处
理。FDATool启动界面左下侧竖向工具栏内按钮④【Set Quantization Parameters】提供滤
波器量化分析的功能。下面仅对滤波器系数量化分析方法作简要介绍。按照前面的步骤设
计的滤波器(系数未量化)称为参考滤波器(Reference Filter),系数量化后的滤波器称为量
化滤波器(Quantized Filter)。下面主要针对定点量化介绍。
①单击该按钮，显示滤波器量化分析界面如图7.7.4所示。滤波器算法(Filter Arithmetic)
默认双精度浮点格式(Double-Precision Floating point)。这时不需要设置量化参数。
②选择Filter arithmetic为定点制，并选择滤波器系数(coefficient),进行16位量化，
分子、分母小数部分字长选14位。对设计的8阶椭圆滤波器，采用4级级联结构时，系数
量化前后零极点位置和频响特性曲线均无明显变化。
第7章有限脉冲响应数字滤波器的设计
③使用菜单【Edit/Convert to Single Section】将滤波器结构转换成直接型结构。量化字
长不变，点击按钮【Apply】,显示量化参数设置与量化结果界面，如图7.7.5所示。由图可
见，实线所示的量化滤波器频响曲线与参考滤波器(虚线)偏差很大，且当前滤波器信息显
示滤波器为不稳定状态。由此直观地看出，系数量化误差对直接型结构滤波器性能的影响
265
Created by ZhuangHeng
口
口
■ ■
0□0
口口
□口口□00
a口
数字信号处理(第五版)
Fe DeinAndyss Tool-[omtitedJd'] 同回区
Fe ArTagds ew dow 
Crerd F omcn-
⑥③0× 日广05EIA?
trude Ratson60-
sbuchee octFom
Scre
Shctone rde
Secon
yor 相通和而貌制 90
400 sorc 0esper
15
goree a 10
Frrpier00t)
20
rae
poueoien tonget口 Fte hnite
Theont sTgs tor Doute peeson fosrg-tot wteato
Peady
图7.7.4 滤波器量化分析界面
F康er DesinkAnalysis Tool [unttledida'] H回图
TaMo ow
D日
Cnrt Fer hlormoion_
⑥四0X 口贝日子厅□同◎日E?
Mytue Rorpone()_
50
同者料的的 50
Saro Cawrtsd mwtieD
100
150 Sef 5 10
frune Ot
15 20
F Wg
F aithmeskFoedport Coethcrte|rotouou|Fee Wems
固露招
困
雳圈
Coeffert word irgdke 6 厂Bestprecolon factonlory toe inonesrrdan
fumerte ic lere 4 厂scnerenmor cotioeta to tuay
rethe rae nnerar Ceso s000(+)
FDrornatr noo,king 4
Cbmonostor r(
Computng Respone done
图7.7.5 量化参数设置与直接型结构系数量化结果界面
15
suctue pectfom
Sactont
266
Created by ZhuangHeng
比级联型结构大得多。
第9章关于系数量化误差敏感度理论将解释这一现象。通过FDATool的工具条查看
量化前后的零极点位置如图7.7.6所示。由图可见，系数量化误差使极点位置偏移很大，
更严重的是有3个极点移到单位圆外，所以滤波器不稳定。
Pole/Zero Plot
1
.G
0.8 卡
0.6 d
0.4 Imaginary Part 0.2
0
-0.2·|
口 量化后零点
O参考零点
× 参考极点
+ 量化后极点
x
-0.4-
-0.6 × +
—0.8-
-1 3
6 -1 -0.5 0 0.5 1 1.5
Real Part
图7.7.6 直接型结构系数量化前后的零极点位置
如前所述，FDATool是一个功能强大的数字滤波器设计与分析工具。SPTool(Signal
Processing Tool)提供了一个便于完成信号处理任务的GUI集成环境。利用它，可以从
MATLAB工作空间或从数据文件直接导入已经设计好的信号、滤波器或频谱；可以分析、
比较、聆听和输出时域信号；可以设计、分析和输出滤波器；可以完成对信号的滤波；可以
对输入、输出信号进行各种谱分析并输出分析结果，等等。所以SPTool的功能更全，可以
用于数字信号处理课程所有内容的实验。限于篇幅，本书对此不作详细介绍，请读者参阅
参考书[25]。
习题与上机题
1.已知FIR滤波器的单位脉冲响应为：
(1)h(n)长度N=6
h(0)=h(5)=1.5
h(1)=h(4)=2
h(2)=h(3)=3
(2)h(n)长度N=7
h(0)=-h(6)=3
h(1)=-h(5)=-2
h(2)=-h(4)=1
第7章有限脉冲响应数字滤波器的设计
267
Created by ZhuangHeng
口
数字信号处理(第五版)
h(3)=0
试分别说明它们的幅度特性和相位特性各有什么特点。
2.已知第一类线性相位FIR滤波器的单位脉冲响应长度为16,其16个频域幅度采样
值中的前9个为：
H?(0)=12,H?(1)=8.34,H?(2)=3.79,H?(3)～H(8)=0
根据第一类线性相位FIR滤波器幅度特性H?(w)的特点，求其余7个频域幅度采样值。
3.设FIR滤波器的系统函数为
H(2)=(1+0.9z1+2.1z2+0.9z3+z)
求出该滤波器的单位脉冲响应h(n),判断是否具有线性相位，求出其幅度特性函数和相位
特性函数。
4.用矩形窗设计线性相位低通FIR滤波，要求过渡带宽度不超过π/8 rad。希望逼近
的理想低通滤波器频率响应函数Ha(e")为
h?C)-{<e<
(1)求出理想低通滤波器的单位脉冲响应ha(n);
(2)求出加矩形窗设计的低通FIR滤波器的单位脉冲响应h(n)表达式，确定α与N之
间的关系；
(3)简述N取奇数或偶数对滤波特性的影响。
5.用矩形窗设计一线性相位高通滤波器，要求过渡带宽度不超过π/10 rad。希望逼近
的理想高通滤波器频率响应函数Ha(e")为
He)-{8其他
(1)求出该理想高通的单位脉冲响应ha(n);
(2)求出加矩形窗设计的高通FIR滤波器的单位脉冲响应h(n)表达式，确定a与N的
关系；
(3)N的取值有什么限制?为什么?
6.理想带通特性为
BCc)-{o<k+B<lol<
(1)求出该理想带通的单位脉冲响应h.(n);
(2)写出用升余弦窗设计的滤波器的h(n)表达式，确定α与N之间的关系；
(3)要求过渡带宽度不超过π/16 rad。N的取值是否有限制?为什么?
7.试完成下面两题：
(1)设低通滤波器的单位脉冲响应与频率响应函数分别为h(n)和H(e"),另一个滤波
器的单位脉冲响应为h?(n),它与h(n)的关系是h?(n)=(-1)"h(n)。试证明滤波器h?(n)
268
Created by ZhuangHeng
是一个高通滤波器。
(2)设低通滤波器的单位脉冲响应与频率响应函数分别为h(n)和H(e"),截止频率为
w.,另一个滤波器的单位脉冲响应为h?(n),它与h(n)的关系是h?(n)=2h(n)coSwn,且
w.<w?<(π-w)。试证明滤波器h?(n)是一个带通滤波器。
8.题8图中h?(n)是偶对称序列，N=8,设
H?(k)=DFT[h?(n)]k=0,1,…,N-1
H?(k)=DFT[h?(n)]k=0,1,…,N-1
(1)试确定H?(k)与H?(k)的关系式。I H?(k)|=|H?(k)|是否成立?为什么?
(2)用h?(n)和h?(n)分别构成的低通滤波器是否具有线性相位?群延时为多少?
4 4
h,(n) 2
h?(n) 2
0
0 2 4 6 8
0
0 2 4 6 8
n n
题8图
9.对下面的每一种滤波器指标，选择满足FIRDF设计要求的窗函数类型和长度。
(1)阻带衰减为20 dB,过渡带宽度为1kHz,采样频率为12 kHz;
(2)阻带衰减为50 dB,过渡带宽度为2kHz,采样频率为20 kHz;
(3)阻带衰减为50 dB,过渡带宽度为500 Hz,采样频率为5kHz。
10.利用矩形窗、升余弦窗、改进升余弦窗和布莱克曼窗设计线性相位FIR 低通滤波
器。要求希望逼近的理想低通滤波器通带截止频率w=π/4 rad,N=21。求出分别对应的
单位脉冲响应。
(1)求出分别对应的单位脉冲响应h(n)的表达式。
(2*)用MATLAB画出损耗函数曲线。
11.将技术要求改为设计线性相位高通滤波器，重复题10。
12.利用窗函数(哈明窗)法设计一数字微分器，逼近题12图所示的理想微分器特性，
并绘出其幅频特性。
IH?(o)!
π_
-π 0 π @
题12图
13.用窗函数法设计一个线性相位低通FIRDF,要求通带截止频率为π/4 rad,过渡带
宽度为8π/51 rad,阻带最小衰减为45 dB。
(1)选择合适的窗函数及其长度，求出h(n)的表达式。
(2°)用MATLAB画出损耗函数曲线和相频特性曲线。
第7章有限脉冲响应数字滤波器的设计
269
Created by ZhuangHeng
口
口口
口口
口口
口口
口
数字信号处理(第五版)
14.要求用数字低通滤波器对模拟信号进行滤波，要求：通带截止频率为10 kHz,阻
带截止频率为22 kHz,阻带最小衰减为75 dB,采样频率为F.=50 kHz。用窗函数法设计
数字低通滤波器。
(1)选择合适的窗函数及其长度，求出h(n)的表达式。
(2*)用MATLAB画出损耗函数曲线和相频特性曲线。
15.利用频率采样法设计线性相位FIR低通滤波器，给定N=21,通带截止频率w=
0.15π rad。求出h(n)。为了改善其频率响应(过渡带宽度、阻带最小衰减),应采取什么
措施?
16.重复题15,但改为用矩形窗函数法设计。将设计结果与题15进行比较。
17.利用频率采样法设计线性相位FIR低通滤波器，设N=16,给定希望逼近的滤波
器的幅度采样值为
0,1,2,3
?k)=10.389 k=4
k=5,6,7
18.利用频率采样法设计线性相位FIR带通滤波器，设N=33,理想幅度特性H(w)
如题18图所示。
H?(m)
1
-0.5π-0.4π 0 0.4π 0.5π 其o
题18图
19*.设信号x(t)=s(t)+v(t),其中v(t)是干扰，s(t)与v(t)的频谱不混叠，其幅度谱
如题19*图所示。要求设计数字滤波器，将干扰滤除，指标是允许|S(D|在0≤f≤15 kHz
频率范围中幅度失真不超过±2??=0.02);f>20 kHz,衰减大于40 dB(8?=0.01);希
望分别设计性价比最高的FIR和IIR两种滤波器进行滤除干扰。请选择合适的滤波器类型
和设计方法进行设计，最后比较两种滤波器的幅频特性、相频特性和阶数。
x(D)I
1s(f)
Ivf)l
0 20 35 f/kHz
题19图
20°.调用MATLAB工具箱函数firl设计线性相位低通FIR滤波器，要求希望逼近的
270
Created by ZhuangHeng
理想低通滤波器通带截止频率w=π/4 rad,滤波器长度N=21。分别选用矩形窗、
Hanning窗、Hamming窗和Blackman窗进行设计，绘制用每种窗函数设计的单位脉冲响
应h(n)及其损耗函数曲线，并进行比较，观察各种窗函数的设计性能。
21.将要求改成设计线性相位高通FIR滤波器，重作题20。
22*.调用MATLAB工具箱函数 remezord和 remez设计线性相位低通FIR 滤波器，
实现对模拟信号的采样序列x(n)的数字低通滤波处理。指标要求：采样频率为16 kHz;通
带截止频率为4.5kHz,通带最小衰减为1 dB;阻带截止频率为6 kHz,阻带最小衰减为
75 dB。列出h(n)的序列数据，并画出损耗函数曲线。
23*.调用MATLAB工具箱函数 remezord和 remez设计线性相位高通FIR 滤波器，
实现对模拟信号的采样序列x(n)的数字高通滤波处理。指标要求：采样频率为16 kHz;通
带截止频率为5.5kHz,通带最小衰减为1 dB;过渡带宽度小于等于3.5kHz,阻带最小衰
减为75 dB。列出h(n)的序列数据，并画出损耗函数曲线。
24°.用窗函数法设计一个线性相位低通FIR滤波器，要求通带截止频率为0.3π rad,
阻带截止频率为0.5π rad,阻带最小衰减为40dB。选择合适的窗函数及其长度，求出并显
示所设计的单位脉冲响应h(n)的数据，并画出损耗函数曲线和相频特性曲线，请检验设计
结果。试不用firl函数，直接按照窗函数设计法编程设计。
25*.调用MATLAB工具箱函数firl设计线性相位高通FIR滤波器。要求通带截止频
率为0.6π rad,阻带截止频率为0.45π rad,通带最大衰减为0.2 dB,阻带最小衰减为
45 dB。显示所设计的单位脉冲响应h(n)的数据，并画出损耗函数曲线。
26'.调用MATLAB工具箱函数 firl设计线性相位带通FIR 滤波器。要求通带截止频
率为0.55π rad和0.7π rad,阻带截止频率为0.45π rad和0.8π rad,通带最大衰减为
0.15 dB,阻带最小衰减为40 dB。显示所设计的单位脉冲响应h(n)的数据，并画出损耗函
数曲线。
27°.调用 remezord和 remez函数完成题25*和26*所给技术指标的滤波器的设计，
并比较设计结果(主要比较滤波器阶数的高低和幅频特性)。 限脉中向应数虑皮的设
271
Created by ZhuangHeng
数字信号处理(第五版)
第 8章
多采样率数字信号处理
8.1 引 言
前面所讨论的信号处理的各种方法都是把采样率F,视为固定值，即在一个数字系统
中只有一个采样频率。但在实际系统中，经常会遇到采样率的转换问题，即要求一个数字
系统能工作在“多采样率”状态。例如：
(1)在数字电视系统中，图像采集系统一般按4:4:4标准或4:2:2标准采集数字
电视信号，再根据不同的电视质量要求，将其转换成其他标准的数字信号(如4:2:2,
4:1:1,2:1:1等标准)进行处理、传输。这就要求数字电视演播室系统工作在多采样率
状态。(4:2:2标准的含义是“亮度信号Y的采样率：红色差信号R-Y的采样率：蓝色
差信号B-Y的采样率=4:2:2”,其他标准以此类推。)
(2)在数字电话系统中，传输的信号既有语音信号，又有传真信号，甚至有视频信号，
这些信号的带宽相差甚远。所以，该系统应具有多采样率功能，并根据所传输的信号自动
完成采样率转换。
(3)对一个非平稳随机信号(如语音信号)作谱分析或编码时，对不同的信号段，可根
据其频率成分的不同而采用不同的采样率，以达到既满足采样定理，又最大限度地减少数
据量的目的。
(4)如果以高采样率采集的数据存在冗余，这时就希望在该数字信号的基础上降低采
样速率，剔除冗余，减少数据量，以便存储、处理与传输。
以上所列举的几个方面都是希望能对采样率进行转换，或要求数字系统工作在多采样
率状态。近年来，建立在采样率转换基础上的“多采样率数字信号处理”已成为数字信号处
272
Created by ZhuangHeng
理学科的主要内容之一。
一般认为，在满足采样定理的前提下，首先将以采样率F,采集的数字信号进行 D/A
转换，变成模拟信号，再按采样率F?进行A/D变换，从而实现从F?到F?的采样率转换。
但这样较麻烦，且易使信号受到损伤，所以实际上改变采样率是在数字域实现的。根据采
样率转换理论，对采样后的数字信号x(n)直接进行采样率转换，以得到最新采样率下的采
样数据。
采样率转换通常分为“抽取(Decimation)”和“插值(Interpolation)”。抽取是降低采样率
以去掉多余数据的过程，而插值则是提高采样率以增加数据的过程。本章先讨论抽取和插
值的一般概念，然后讨论其几种基本的实现方法。本章所涉及的内容也是语音及图像数据
压缩新技术——子带编码的重要理论基础。
8.2 信号的整数倍抽取
设x(n?T?)是连续信号x(1)的采样序列，采样率F?=1/T?(Hz),T?称为采样间隔，
单位为秒，即
x(n?T?)=X,(n?T?) (8.2.1)
如果希望将采样率降低到原来的1/D,D为大于1的整数，称为抽取因子。最简单的方法
是对x(n,T?)每D点抽取1点，抽取的样点依次组成新序列y(n?T?)。y(n?T?)的采样间隔
为T.,采样率为F?=1/T?(Hz),T?与T?的关系为
T?=DT, (8.2.2)
为了后面叙述方便，我们将上述的抽取系统用图8.2.1(a)表示，图中符号D表示采样率
降低为原来的1/D(D为Decimation的第一个字母，表示抽取)。r(n?T?)和y(n?T?)分别如
图8.2.1(b)和(c)所示。图中n?和n?分别表示x(n?T?)和x(n?T?)序列的序号，于是有
y(n?T?)=x(n?DT?) (8.2.3)
当n?=n?D时，y(n?T?)=x(n?T?)。
上面在时域讨论了整数倍抽取的概念。抽取看起来好像很简单，只要每隔D-1个抽
取一个就可以了，但抽取降低了采样频率，可能引起频谱混叠现象。下面讨论抽取过程中
可能出现的频谱混叠及改进措施。
如果x(n?T?)是连续信号x(t)的采样信号，则x。(t)和x(n?T?)的傅里叶变换X,(j2)
和X(e”)分别是
X,Gia)=?z.(1)ed (8.2.4)
x(e)=∑zcn,T,)e (8.2.5)
其中，Ω=2πf rad/s,f为模拟频率变量；w?为数字频率，
273
Created by ZhuangHeng
第8章
多采样率数字信号处理
口
口口
888
口
数字信号处理(第五版)
x(n,T) D
y(n?T?)
-D
(a)
x(n,T)
01 3 579 11 1315 17 19 21 23 25 n
T?
(b)
y(n?T?)
0
T
1 2 3 4 5 n?
(c)
图8.2.1 数字信号的时域抽取示意图
=AT?=2mF (8.2.6)
由(2.4.3)式有
x(e)=÷∑x.(i-jk2) (8.2.7)
式中，Ω=2π/T:rad/s,亦称为采样频率。
为了对抽样前后的频谱进行比较，作图时均以模拟角频率Ω为自变量(横坐标),为此
按(8.2.6)式将X(e)写成Ω的函数为
X(e)=x(e)m-六∑z.(jn-jka) (8.2.8)
因为这里x(t)是一般的非周期连续函数，所以X,(jΩ2)也是模拟频率Ω的非周期函数，
如图8.2.2(a)所示。而x(n?T?)的傅里叶变换X(e”)为连续频率w,的周期函数。在满足
采样定理时，X(e")的频谱在[-a/2,Ω/2]上与X,(j2)相似(差一个比例常数1/T?),
且无混叠现象，如图8.2.2(b)所示。但如果将采样率降低到原来的1/D,即T?=DT?,当
D=4时，得到y(n?T?)及其频谱Y(e)如图8.2.3所示(实际上，Y(e”)应为图中各重复
谱的叠加曲线)。图中，y(n?T?)为对x(n?T?)抽取的结果，Y(e”)为y(n?T?)的傅里叶变
换。Y(e”的周期Ω=2π/T?=2π/DT?=Ω/D。这就是说，Y(e”)的周期是X(e”)周期
的1/D。
274
Created by ZhuangHeng
x(1) X,G2)
FT
0 -Q0Ω
(a)
x(n,T) X(e)=X(e)
FT
0
T?
-
-Q0Ω
(b)
-
Q
图8.2.2 x,(1)与x(n,T?)及其频谱图
y(n?T?) Y(e)
FT
0
T? 0 Q
=方a
图8.2.3 抽取引起的频谱混叠现象
由图8.2.3可见，Y(e”)是有混叠的，无法从y(n?T?)中恢复出x(n?T?)来。所以随意
对x(n?T?)进行抽取是不行的。只有在抽取后仍能满足采样定理时才能恢复出原来的信号
r(t),否则就必须另外采取措施。通常采取的措施是抗混叠滤波。所谓抗混叠滤波，就是
在抽取之前先对信号进行低通滤波，把信号的频带限制在Ω/2以下。这种抽取系统框图
如图8.2.4所示。图中h(n?T?)为抗混叠滤波器，它的输出v(n?T?)的最高频率已被
h(n?T?)限制在Ω/2=Ω/(2D)以下。即抗混叠滤波器的阻带截止频率为Ω/(2D),对
应的数字阻带截止频率为
2Ti=TDTi=芬
所以，在理想情况下，抗混叠低通滤波器h(n?T)的频率响应H(e")由下式给出：
-oi (8.2.9)
275
Created by ZhuangHeng
第8章多采样率数字信号处理
口
数字信号处理(第五版)
于是λ(n?T?)的DFS展开式为
276
图8.2.4中各点的信号在时域和频域中的示意图如图8.2.5所示。这种办法虽然把
x(n?T?)中的高频部分损失掉了，但由于抽取后避免了混叠，所以在Y(e)中完好无损地
保留了X(e")中的低频部分，可以从Y(e3)中恢复出X(e")的低频部分。
x(n,T) v(n,T) y(n?T) h(m?T) D
图8.2.4 带有抗混叠滤波器的抽取系统框图
x(n,T) 11X(e)
FT
0
T? m -Q -Q a0 Q Q
(a)
(nT) IV(e3)I
FT
0
T
m -A -Am0an Q Q
(b)
y(n?T?) iY(e1)
FT
0
T? n -Q 0 Q Q Q
(c)
图8.2.5 抽取前后信号的时域和频域示意图
为了进一步搞清x(n?T?)经↓D前后的频谱关系，对信号的抽取过程进行等效的数学
描述，如图8.2.6所示，以便于进行频谱分析，找出Y(e"?)与X(e)之间的关系。在抽取
前先令x(n?T?)乘以周期序列ā(n?T?),即
x(n?T?)=x(n?T?)·ā(n?T?) (8.2.10)
其中，λ(n?T?)定义如下：
(m,T)={ 其他，±D,±2D,
然后对x(n?T?)进行D,得到y(n?T?)。ā(n?T?)的离散傅里叶级数(DFS)系数λ(k)为
a(k)-2acmT)e=1 (8.2.11)
Created by ZhuangHeng
a(m,T)-—ac)e2 (8.2.12)
将(8.2.12)式代入(8.2.10)式，得
i(,T)=方2(m,T)e (8.2.13)
对x(n?T?)进行抽取，每隔D-1个点抽取一个样值，所取得抽样点均在λ(n?T?)=1的点
上。把这样抽取的结果作为y(n?T?),如图8.2.6所示(D=4)。
x(n;T) x(n?T)
n?T n
Aā(,Z)
1
o n?T? i(nZ)=x(n,Z)ā(nZ) 直接抽取
0 T?2T? n?T?
=DT
y(n?T?) y(n?T?)
0 T? 2T? 3T? 4T? 5T?n?T? 0 1 2 3 4 5m
HT?=DT T?
图8.2.6 抽取过程的等效数学描述与直接抽取波形
下面推导Y(e)与X(e)的关系：
Y()=∑s(.T)e-2s(LDT)e∑scn.DT)e
当n?D=n?时，y(n?DT?)=i(n?T?),而当n:D≠n?时，(n,T?)=0,所以
rm)-2icmT)e~-2GT,)c]
第8章)多采样率数字信号处理
-方2x) (8.2.14)
277 Created by ZhuangHeng
口口
口口
口
口
数字信号处理(第五版)
令z?=e”,z?=e,W=e带，则
Y()=方2x(c?w) (8.2.15)
式中，z=e=e"=e=z°。所以有(省去z的下标)
Y(a)-2x20w) (8.2.16)
(8.2.14)式就是Y(e)与X(e)的关系，即Y(e“)是X(e”)的D个平移样本之和，
相邻的平移样本在频率轴ay上相差2π/D,在模拟频率轴Ω上相差2π/(DT?)=Ω/D=
,如图8.2.7和图8.2.8所示。
x(n?Ti) IX(e)I
工
矿 ←T n?T -Q (a) 0
Q Q Ω
(nT) A(k) 三 i …
-T? n?T ò 1 2 3 4 k
DT? (b) 4余(n?T) 1X(e)
工
0 DI 2DT3DT m?T ò R Ω
(c)
(n?T?) 1Y(e)I
工
n?T 0 Q Ω
(d)
图8.2.7 Ω,>0/2时，抽取前后的频谱关系示意图
为了更清楚地说明上述关系，将由x(n?T?)求得y(n?T?)频谱的过程用图8.2.7和图
8.2.8表示出来。图8.2.7给出了抽取后产生混叠的情况，即X(e)中的最高频率
Ω>Ω,/(2D)=Ω/2。这里Ω为X(e")的周期，Ω为Y(e")的周期。图8.2.8
给出了抽取后不产生混叠的情况，即X(e)中的最高频率Ω<Ω/(2D)=Ω/2的
情况。
278
Created by ZhuangHeng
1X(e)I
-Q.0Q Q Q
(a)
A(k)
-3-2-1 0 1 2 3 4 5 k
(b)
1x(e)I
0 Q,/D Q Q
(c)
1Y(e)
0 Q Ω
(d)
图8.2.8 n,<Ω/2时，抽取前后的频谱关系示意图
8.3 信号的整数倍内插
1.整数倍内插的概念与内插方法
整数I倍内插是在已知的相邻两个原采样点之间等间隔插入I-1个新的采样值。由于
这I-1个采样值并非已知的值，所以关键问题是如何求出这I-1个采样值。从理论上讲，
可以对已知的采样序列x(n?T?)进行 D/A转换，得到原来的模拟信号x,(t),然后再对
x,(t)进行较高采样率的采样得到y(n?T?),这里
T?=IT? (8.3.1)
第8章多采样率数字信号处理
式中，I为大于1的整数，称为内插因子。上述过程可用图8.3.1表示。但这样的插入方法
是不经济的，且附加D/A和A/D变换易对信号产生损伤。实际工作中采用下述内插方法。
整数内插是先在已知采样序列x(n?T?)的相邻两个样点之间等间隔插入I-1个0值
点，然后进行低通滤波，即可求得I倍内插的结果。这种内插方案如图8.3.2所示。图中
个I表示在x(n?T?)相邻样点之间插入I-1个0值采样，称为零值内插器。I为英文单词
Interpolation的第一个字母。零值内插后，得到v(n?T?)。v(n?T?)经过h(n?T?)低通滤波
后变成y(n?T?)。x(n?T?)、v(n?T?)及y(n?T?)如图8.3.3所示。
279 Created by ZhuangHeng
8。。。
口口
口
口口
品
口口
口
■口
数字信号处理(第五版)
Ax(n;T) x(n?T) 7
v(n?T?) h(n?T?) y(n?T?)
图8.3.2 零值内插方案原理框图
Ax(n?Ti) 0
n
(a)
Ax?(0) 0
T n
Az(n?T?)
0
(b)
0
Ay(n?T?) -T? n
T
Ly(n?T?)
0
-T? n2
(c) 0
T? n2
图8.3.1 内插概念示意图 图8.3.3 内插过程时域波形
2.整数倍内插的频域解释
上述的零值内插方案中，x(n?T?)、v(n?T?)及y(n?T?)的频谱关系是怎样的?回答这
一问题的过程，就是解释为什么v(n?T?)经低通滤波就能得出采样率升高I倍的y(n?T?)
的原理。这样才能提出对低通滤波器的技术要求。
为了回答上面的问题，设x(n?T?)为模拟信号x(t)的采样序列，并假定x,(t)及其傅
里叶变换X,(j2)如图8.3.4所示。
Ax() A1X,G2)I
0 1
-
0 Ωa
图8.3.4 模拟信号及其频谱示意图
按照内插的概念，y(n?T?)应为以采样间隔T?对x(t)的采样序列，且满足T?=T?/I。于
是x(n?T?)、y(n?T?)及其傅里叶变换X(e”)、Y(e”)应该如图8.3.5所示。X(e")和
Y(e”)均为周期函数，若二者都用模拟频率Ω表示，则X(e”)=X(e),周期为Q=
280
Created by ZhuangHeng
2π/T?;Y(e)=Y(e),周期为Ω=2π/T?=2π/(T?/D=IQ。
Ax(m;T) ix(e)1
1动
0 m
T
-Q0QQ 32 Q
(a)
A(n?T) AIY(e)I
1T
0
H-T? n? -Q0a Q? Q
(b)
图8.3.5 x(n?T?)、y(n?T?)、X(e")、Y(e2)的波形(I=3)
下面分析图8.3.2中v(n?T?)的频谱，最后讨论为了得到满足插值要求的y(n?T?)(如
图8.3.5所示),对h(n?T?)的技术要求。
T,)-- 当n,=0,±I,±2I,…
其他
(8.3.2)
v(n?T?)的傅里叶变换V(e)为
v(e)-∑o(nT?)e-∑DCnT)e-Z=(T?)e
-2zcnT)e两=x()=x(e) (8.3.3)
上式表明V(e")和X(e)的频谱相同，如图8.3.6所示。实质上，v(n?T?)的信息与
x(n?T?)完全相同，所以二者应具有相同的频谱。图8.3.6中，Ω=2π/T?,Ω2=2π/T?=
x(m?T) 1X(e1)1
1上
T n 0 Q 30 Q
(a) 0 2π 6π
(n?T?) iv(e)I
1不
-T? n? 0 Q=1DΩ
(b) 0 2π 码
图8.3.6 零值内插前后的时域信号及其频谱
第8章
多采样率数字信号处理 0
0
281
Created by ZhuangHeng
数字信号处理(第五版)
2π/(T?/D=IΩ。与图8.3.5中的Y(e"2)相比较，图8.3.6中的V(e")多出了从Ω/2
到Ω-Ω/2的部分，通常将这部分频谱称为镜像频谱。由此可见，要想从V(e”)得到如
图8.3.5(b)所示的Y(e),就必须滤除这些镜像频谱。所以，要求滤波器h(n?T?)的理想
低通幅频特性如图8.3.7所示。实际工作中Ω>2Ω,所以允许H(e2)有一定的过渡带，
可用线性相位FIR 滤波器实现。根据其功 AIH(e)
能，将h(n?T?)称为镜像滤波器。
将理想镜像滤波器的阻带截止频率换算
成数字频率为 -Q/20Q:/2 Q:/2 Q2 a
2T=子- -m/I 0 w/I 2π
图8.3.7 镜像滤波器的理想幅频特性
所以，理想情况下，镜像滤波器h(n?T?)的
频率响应特性为
c)- (8.3.4)
式中，C为定标系数。因此输出频谱为
0≤lw,I<
≤1,I≤π (8.3.5)
定标系数C的作用是，在m=0,±I,±2I,±3I,…时，确保输出序列y(m)=x(m/I)。
为了计算简单，取m=0来求解C的值。
y(0)=Y(e)d=x(e")da?
因为w?=w?/I,所以
y(o)=9x(e)d=Sr(0)=x(0)
由此得出，定标系数C=I。
3.内插器的输入、输出关系
1)时域输入、输出关系
由图8.3.2有
y(n?T?)=∑o(mT?)h(n?T?-mT?) (8.3.6)
因为
cmr)=()=x6T)mm及T,-r 共池
282
Created by ZhuangHeng
所以
yonT)=∑z(n,T)h(nST?-n,T)=∑z(mT)A[(m-mDT.]((8.3.7)
上式就是内插器时域输入、输出关系。
2)频域输入、输出关系
Y(e2)=V(e“)H(e) (8.3.8)
由(8.3.3)式知道V(e"?)=X(e"),所以
Y(e)=XCe)H(e2)=X(e')H(e) (8.3.9)
在复频域分析图8.3.2时，其输入x(n?T?)的Z变换X(z?)与输出y(n?T?)的Z变换Y(z?)
的关系推导如下：
Y(z?)=V(z?)·H(z?) (8.3.10)
其中
V()=V(n?T?)2
-∑=(T) =n时 n2为I的整数倍即'
-DaomT,)6-x() (8.3.11)
Y(z?)=X(z)H(z?) (8.3.12)
(8.3.12)式中所有变量都为z?,所以可去掉下标，得到：
Y(z)=X(z1)H(z) (8.3.13)
8.4 按有理数因子I/D的采样率转换
在按整数因子I内插和整数因子D抽取的基础上，本节介绍按有理数因子I/D采样率
转换的一般原理。显然，可以用图8.4.1所示方案实现有理数因子I/D采样率转换。
x(n) h() hp() D (m) 第8章多采样率数字信号处理
内插器 抽取器
图8.4.1 按有理数因子I/D的采样率转换方法
首先对输入序列x(n)按整数因子I内插，然后再对内插器的输出序列按整数因子D抽
取，达到按有理数因子I/D的采样率转换。应当注意，先内插后抽取，才能最大限度地保
留输入序列的频谱成分。
用F,=1/T,和F,=1/T,分别表示输入序列x(n)和输出序列y(m)的采样频率，则
F,=(I/D)F,。另外，图中镜像滤波器h,(D)和抗混叠滤波器hp(1)级联，而且工作在相同
的采样频率IF,因此完全可以将它们合成为一个等效滤波器h(L),得到按有理数因子
283
Created by ZhuangHeng
□ ■ 口
口
口
口
a口
数字信号处理(第五版)
I/D采样率转换的实用原理方框图，如图8.4.2所示。
z() w() iD I x(n) h() y(m)
图8.4.2 按有理数因子1/D采样率转换的实用原理方框图
如前所述，理想情况下，h,(1)和hp(1)均为理想低通滤波器，所以二者级联的等效滤波
器h()仍是理想低通滤波器，其等效带宽应当是h,(L)和hp(1)中最小的带宽。h(D)的频率
响应为
(8.4.1)
现在推导图8.4.2中输出序列y(m)的时域表达式。零值内插器的输出序列为
-()-0,t1.±27,±31, (8.4.2)
线性滤波器输出序列为
u(2)=∑h(l-k)2(k)=∑hCL-kD)a(k) (8.4.3)
整数因子D抽取器最后输出序列为y(m),其时域表达式为
y(m)=u(Dm)=∑h(Dm-kD)r(k) (8.4.4)
如果线性滤波器用FIR滤波器实现，则可以根据式(8.4.4)计算输出序列y(m)。
除了前面介绍的采样率变换技术，在实际工作中还会遇到任意因子采样率转换(F,/F
为任意有限数或可能随机变化)。有兴趣的读者请参考文献[24]。
8.5 整数倍抽取和内插在数字语音系统中的应用
为了下面叙述方便，首先说明本节对信号时域和频域的表示方法和描述符号。设x(t)
为模拟信号，x,(nT?)表示对x(t)的采样序列，y(mT?)是对x(nT)进行采样率转换(内插
或抽取)后的序列。并定义
X (jΩ2)=FT[x,(t)]
X(e")=X(e)=FT[x(nT?)]
Y(e)=Y(e)=FT[y(mT?)]
其中，数字频率与模拟频率的关系为w?=ΩT?,a?=ΩT?。x(nT?)的采样频率记为F=
1/T?Hz,y(nT?)的采样频率记为F=1/T? Hz,相应的采样角频率记为Ω=2πF=
2π/T,rad/s,Ω2=2πF=2π/T? rad/s。
为了通过观察比较x(t)、x(nT?)和y(mT?)的频谱关系，理解采样率转换在数字语音
284
Created by ZhuangHeng
系统中的应用原理，本节全部以模拟角频率Ω为自变量(横坐标),并采用上面定义的符号，
来绘制应用系统中各信号的频谱曲线。
8.5.1 数字语音系统中的信号采样过程及其存在的问题
在数字语音系统中，语音信号的采样过程如图8.5.1所示。图中，z(t)为模拟信号，
其有用频谱分布范围为[一f,f],f。表示x(t)中有用频率成分的最高频率。信号中一般
含有干扰噪声，其频带宽度远大于f。x?(t)及其幅频特性|X.Gj2)|如图8.5.1(b)所示。下
面以电话系统中的数字语音系统为例，讨论图8.5.1(a)所示的基本采集系统中存在的技术
问题。
x?() h() AD (nD
x?() (a) 1IX,G2)I
o -a 0a=2x/
(b) 1HGD)I
-a, 0= a
(e) 0 IiVg2)I
0 -A 0 R Q
n) (d)
iv(e)
o T n 0
N11 Q
(e)
图8.5.1 语音信号的一般采样过程示意图 第8章多采样率数字信号处理 在电话系统中，一般要保证4kHz的音频带宽，即取f=4kHz。但送话器发出的信号
x。(t)的带宽比子。大很多。因此，在A/D变换之前要对其进行模拟预滤波，以防止采样后
发生频谱混叠失真。为了使信号采集数据量尽量小，取采样频率F,=2f=8kHz。这时要
求低通模拟滤波器h(t)的幅频响应特性|HGj2)|如图8.5.1(c)所示。预滤波后的信号v(t)
及其采样序列v(nT)和相应的频谱分别如图8.5.1(d)、(e)所示。
上述基本采集系统对x,(t)进行A/D变换的困难在于对预滤波器h(t)的技术要求太高
(要求过渡带宽度为0,用理想低通滤波器),因而是难以设计与实现的。显然，在接收端
D/A变换过程中同样会遇到此问题。如果简单地将采样率提高，如取F,=16 kHz,则预滤
波器就容易实现(允许有4kHz的过渡带),但使采集信号的数据量加大1倍，传输带宽也加
285
Created by ZhuangHeng
大1倍。下面讨论如何采用整数因子抽取与整数因子内插来解决该问题，而不增加数据量。
8.5.2 数字语音系统中改进的A/D转换方案
为了降低对模拟预滤波器的技术要求，采用如图8.5.2(a)所示的改进方案。先用较高
的采样率进行采样，如采样率F=1/T?=16 kHz,经过A/D后，再按因子D=2抽取，把
数字信号处理(第五版)
286
x(t) g(0 A/DnT) h(nT) v(nT) 12 y(mT?)
x(1) (a)
IXg2)1
0
-2 0 2 2
(b) IGG2)!
-32 -Q0Ω 32Q
(c)
w() AIWG2)1
0- -30 -Ω 0a 32Q Ω
(d)
w(nT) AIW(e3)
0
-T? n
0 32 Q
(e) AIH(e1)I
(1) -Ω 0a QΩ
V(nT) AIV(e)I
0
-T? n Ω -A0 Q Ω
(g)
A)(mT?) IY(e)I
0
-T? m -20220 (h) 4Ω Ω
图8.5.2 数字语音系统中改进的A/D转换方案及各点信号波形与频谱示意图
Created by ZhuangHeng
采样率降至8kHz。这时，模拟预滤波器g(t)的过渡带为4≤f≤12 kHz,如图8.5.2(c)所
示。这样的预滤波器会导致采样信号w(nT?)的频谱W(e")在4~12 kHz的频带中发生
混叠，如图8.5.2(e)所示。但这部分混叠在抽取前用数字滤波器h(nT?)滤掉了。数字滤波
器h(nT?)的幅频特性|H(e")|如图8.5.2(f)所示。这样，模拟预滤波器就容易设计和实
现了。现在把问题转移到设计和实现技术要求很高的数字滤波器h(nT?)上了，这就是解决
问题的关键技术。数字滤波器可用FIR结构，容易设计成线性相位和陡峭的通带边缘特性。
这种方案最终并未增加信号数据量。
8.5.3 接收端D/A转换的改进方案
设数字信号序列y(mT?)传送到接收端后变成y(mT?),若不考虑信道噪声，则其频谱
与图8.5.2(h)相同。要将y(mT?)恢复为模拟信号(t),若采用基本方案，先将y(mT?)经
D/A转换器，再进行模拟低通滤波，得到i(t)。这种方案同样会对模拟恢复低通滤波器
g(t)提出难以实现的技术要求。为了解决这一难题，可采用如图8.5.3所示 D/A转换器的
改进方案。该方案的思路是，采用整数因子内插，将模拟恢复低通滤波器g(t)的设计与实
现的困难转移到设计滤除镜像频谱的高性能数字滤波器h(nT?)来解决。具体实现原理
如下。
o mT) AnT) SnT) 80 D/A 2
图8.5.3 D/A转换器的改进方案
设输入数字信号y(mT?)如图8.5.4(a)所示(与图8.5.2(h)相同)。经内插后将采样率
提高2倍，滤波器h(nT?)的输出为v(nT?),假定h(nT)可设计成陡峭通带边缘特性，则
ü(nT?)的时域和频域波形如图8.5.4(b)所示。对v(nT?)进行D/A变换，得到：
)-{ (8.5.1)
mT) AIf(e)I
0
T m o
(a) -会 Q
第8章多采样率数字信号处理
CnT) AIV(e)I
0
-T? i
m 0 ΩQ Ω
(b)
图8.5.4 y(mT?)和i(nT?)时域和频域示意图
i(t)及其幅频特性|VGj2)|如图8.5.5所示。应当说明，这种D/A转换器难以实现，实
287
Created by ZhuangHeng
数字信号处理(第五版)
际中常用零阶保持型D/A转换器代替，但其频响特性不理想，会引入幅频失真。这种失真
可在数字域进行预处理补偿。
0) AIVG2
0
HK-T? 0云 Q Q
图8.5.5 v(t)时域和频域示意图
对i(t)进行模拟低通滤波，这时要求模拟低通滤波器g(t)的通带边缘频率为Ω=
π/(2T?),过渡带为π/(2T?)≤IΩ|≤3π/(2T?),阻带为3π/(2T?)≤I2|。g(t)的幅频特性
曲线如图8.5.6所示，当然，过渡带上的频响曲线可以不是直线。g(t)的输出则为模拟信号
x(t)。由于过渡带较宽，所以模拟低通滤波器g(t)的设计与实现较容易。我们希望恢复的
信号就是x(t),其时域和频域示意图如图8.5.7所示。
A1GG21 0 A1×Ga)
oL 云云°云 Ω 1 云0云
图8.5.6 g(2)的幅频特性曲线 图8.5.7 恢复的模拟信号x(1)及其频谱示意图
8.6 采样率转换滤波器的高效实现方法
在多采样率系统中，总是设法把乘法运算安排在低采样率一侧，以使每秒钟内的乘法
次数最少。但在前面介绍的两种采样率转换方案中，滤波器的卷积运算均在采样率较高的
一侧。因此，必须对多采样率系统的网络结构进行研究，以便得到乘法次数最少的高效实
现结构。
用FIR 结构实现多采样率系统具有很大的优越性。这是由于FIR结构绝对稳定且很容
易做成线性相位，特别是容易实现高效结构。所以在多采样率系统的实现中绝大多数采用
FIR滤波器。本节只介绍FIR 直接实现和多相结构，其他两种高效实现结构(多级实现和时
变网络)请参阅文献[12,19,24]。
8.6.1 直接型FIR滤波器结构
1.整数倍抽取器的FIR 直接实现
整数(D)倍抽取器框图如图8.2.4所示。抗混叠低通滤波器用FIR结构时，抽取器的
时域输入、输出关系为(设h(n?T?)长度为N)
288
Created by ZhuangHeng
mT)-ZhrT)r[(m-)T,]
y(n?T?)=v(n?DT?)
(8.6.1)
(8.6.2)
如果滤波器用FIR直接型结构，则该抽取器的实现网络结构如图8.6.1(a)所示。经滤
波卷积运算得出v(n?T),最后将 v(n?T?)每隔D-1个取一个作为输出y(n.T?),即
v(n?T?)中有(D-1)/D的样值都被舍弃了。所以这种结构是一种低效实现结构，而且要求
计算每一个v(n?T?)的N次乘法和N-1次加法在一个T?时间内完成。
x(n?T) h(O) z(m;T)
h(T)
tD y(n?T?)
x[(m-D)Ti] 1z
要要垂
1h[(N-2)T] x[(n?-N+2)Ti]
x[(m-N+1)T]
zh[(N-DT]
(a)
x(n?Ti) D
h(O) y(n?T?)
z
x[(n?-1)T] tD h(T)
1
tD h[(N-2)Ti1 x[(m?-N+2)T]
x[(m-N+1)TI iD h[(N-1)T]
(b)
图8.6.1 按整数因子D抽取系统的直接型FIR滤波器结构
为了得到相应的高效FIR直接实现，对图8.6.1(a)进行等效变换。显然，将图8.6.1
(a)中的vD移在N条乘法器支路中的乘法器之前，如图8.6.1(b)所示，所得y(n?T?)与
原结构输出相同，即图8.6.1(a)与图8.6.1(b)是等效的。
图8.6.1(b)中各条支路里的↓D同时在n=n?D时开通，例如D=4,N=11,n?=5
第8章
多采样率数字信号处理 时，n?=20,第0条支路通过的是x(20T?),第1条支路通过的是x(19T?),……,最下面
的第N-1条支路通过的是x(10T?)。此刻开始计算N个支路的N次乘法和最后的N-1
次加法，得到一个输出样值：y(n?T?)=y(5T?)=y(5DT?)=y(20T?)。由于在x(21T?)到
来之前所有的↓D同时关闭，直到n?=6时，即n?=n?D=24时，N个VD才又同时开
通，分别让x(24T?),x(23T?),…,x(11T?)通过，开始计算下一个输出序列样值y(6T?)。
所以，改进后的实现结构将乘法运算移到低采样率一侧，使乘法运算速度要求降低到原来
的1/D,即原来要在一个T?时间内完成的运算，现在只要在DT,时间之内完成就可以了。
当然，也使计算量减少到原来的1/D。故称之为高效结构。
289
Created by ZhuangHeng
口
oo口
口
口口
□o■■ ■
口
口
数字信号处理(第五版)
应当说明，图8.6.1(b)中将↓D放在hCO),h(T?),…,h[(N-1)T?]之前，减少了
运算量，但这并不是把抗混叠滤波放到了抽取之后，而是与原来的滤波作用等效。对此作
如下解释：
滤波和抽取的作用次序在FIR实现结构中体现在滤波器输入端及延迟链上所加的信号
序列，如果所加信号是抽取以前的信号，则是先滤波后抽取，反之是先抽取后滤波。图
8.6.1(b)中，所有D均安排在延迟链之后，即滤波器延迟链上各点的信号仍然是原序列
x(n?T?),x[(n?-1)T?],…,x[(n?-N+1)T?],而不是抽取后的信号。每当D开通
时，进入左侧的信号是未抽取的原信号，即输出的y(n.T?)与图8.6.1(a)中抽选的y(n?T?)
相同，而两次开通之间所阻挡的信号恰好就是图8.6.1(a)中将来要舍弃的部分，所以计算
结果是正确的。但绝对不能将D提前到延迟链之前，那样才是真正的先抽取后滤波，会
产生严重的混叠现象。
由于常常希望把FIR滤波器设计成线性相位的，因而可用FIR线性相位结构，这样又
可以使乘法计算量减少一半。根据线性相位时域特性
h(nT?)=h[(N-1-n)T?]
可画出抽取器FIR结构的线性相位形式如图8.6.2所示。
h(O) y(n?T?)
x(n?T) tD
ID
ID
|D
tD
图8.6.2 抽取器FIR结构的线性相位形式(N=11)
2.整数倍内插器的FIR直接实现
整数倍内插方案原理框图如图8.3.2所示。镜像滤波器h(n?T?)采用FIR 结构时，I倍
内插器的FIR 直接实现结构如图8.6.3所示。
图8.6.3中乘法是在高采样率一侧进行的，不是高效结构，应设法将乘法运算移到低
采样率一侧以减少计算量。可采用以下方法进行网络等效变换，得出相应的高效结构。
先将FIR滤波网络部分进行转置，得到图8.6.4所示的FIR转置型结构，再用其代替
图8.6.3中的FIR滤波网络，得到图8.6.5所示的内插系统直接实现结构。
290
1D h(T)
1D zh(2T)
1D 1h(3T)
1D
tD
h(5T) tD
Created by ZhuangHeng
x(m?T) +
v(n?T?) h(O) y(n?T?) v(n?T?) h(O) y(n?T?)
h(T?) h(T?)
z
重中果 善曲曲
h[(N-2)T?I H[(N-2)T]
z h[(N-1)T?] h[(N-1)T] z
图8.6.3 按整数因子I内插系统的直接型FIR
滤波器结构
图8.6.4 FIR转置型结构
由整数倍抽取系统的FIR直接实现的等效变换概念可知，图8.6.5中先零值内插后分
支相乘与先分支相乘后零值内插等效。因此，可将图8.6.5中的个1分别移到FIR网络的
各支路的乘法器之后，可得到图8.6.6所示的内插系统直接实现高效结构。由于延时链上
所加的仍然是内插后的信号，因而等效变换后的高效结构仍是先内插后滤波。
x(n;T) +
v(n?T?) h(O) y(n?T?) x(n?T) h(O)
h(T?)
杠 y(n?T?)
h(T?) z
z 杠 z
重垂用
h[(N-2)T] h[(N-2)T]
h[(N-1)T] z
h[(N-1)T?]
图8.6.5 滤波网络转置后的内插器的
FIR 直接实现
图8.6.6 内插器FIR 直接实现的
高效结构
当满足线性相位条件[h(n?T?)=h((N-1-n?)T?)]时，可用线性相位结构实现，将乘
法次数再减少一半。取N=9,画出内插器的线性相位FIR直接高效实现结构，如图8.6.7
所示。
x(n?T) h(0)
h(T?) 1 +7 yn?T?)
h(2T?) 中 z
h(3T?)
+
z
1 h(4T)
z
口 z
图8.6.7 内插器的线性相位 FIR直接实现结构
第8章
多采样率数字信号处理
291
Created by ZhuangHeng
观察图8.6.6和图8.6.1(b)可发现一个有趣的规律：图8.6.6所示的按整数因子I内
插系统的高效FIR滤波器结构与图8.6.1(b)所示的按整数因子D抽取系统的高效FIR滤
波器结构互为转置关系。这种关系有助于简化整数因子抽取系统和整数因子内插系统的高
效FIR滤波器结构的研究，在多相实现结构的讨论中将用到该关系。
3.按有理数因子1/D的采样率转换系统的高效FIR滤波器结构
为了叙述方便，先由图8.4.2画出按有理数因子I/D采样率转换系统的直接型FIR结
构，如图8.6.8所示。
数字信号处理(第五版)
h(O) x(n)
h(1)
ID (m)
z
z
h(2)
h(M-2)
z
图8.6.8 按有理数因子1/D采样率转换系统的直接型 FIR滤波器结构
按有理数因子I/D采样率转换系统的高效结构一般基于内插系统的高效FIR滤波器
结构与抽取系统的高效FIR滤波器结构进行设计。其指导思想是，使FIR滤波器运行于最
低采样速率。为此，当I>D时，F,>F,,将图8.6.8中的直接型 FIR结构与前面的个1用
图8.6.6所示的整数因子I内插器的高效FIR 滤波器结构代替即可。当I<D时，F,<F,
将图8.6.8中的直接型FIR结构与后面的D用图8.6.1(b)所示的整数因子D抽取器的
高效FIR滤波器结构代替即可。如果采用线性相位FIR滤波器，则应当用相应的线性相位
FIR滤波器的高效内插结构或高效抽取结构来实现。
8.6.2 多相滤波器结构
可以证明，图8.6.6所示的按整数因子I内插系统的高效FIR滤波器结构可以用一组
较短的多相滤波器组实现。如果FIR滤波器总长度为M=NI,则多相滤波器组由I个长度
为N=M/I的短滤波器构成，且1个短滤波器轮流分时工作。
为了证明上述结论，观察图8.6.3给出的整数因子I内插系统的直接型FIR滤波器结
构。为了下面描述简单，用x(n)表示x(n?T?),用v(m)表示 v(n?T?),y(m)表示y(n?T?)。
输出序列y(m)为
y(m)=Zh(n)(m-m)
h[(M-1)]
(8.6.3)
零值内插器的输出序列v(m)是在输入序列x(n)的两个相邻样值之间插入I-1个零样值得
292
Created by ZhuangHeng
到的，因此 v(m)进入 FIR滤波器的M个样值中只有N=M/I个非零值。所以在任意m时
刻，计算y(m)=h(m)*v(m)时只有N个非零值与h(m)中的N个系数相乘。由(8.3.2)式
知道
m-()其，.±z1,±.
所以，m=jI时刻，
y(m)=_hcn)cm-n)=2hG)xj-n)
=h(O)x(j)+h(DzGj-1+h(2Da(j-2)+… +h(N-Dx(j-(N-1)) (8.6.4)
m=jI+1时刻，(8.6.4)中v(jI-n)右移1位，N个x(n)的非零值与h(n)的对应关系又右
移1位，所以
y(m)-Zhcm)ocm-m)-Zh(+m)xGj-m)
=h(1)x(j)+h(1+Dx(j-1+h(1+2Dx(j-2)+…
+h(1+N-Dr(j-(N-D) (8.6.5) ……
当m=jI+I时刻，N个x(n)的值与h(n)的对应关系又重复(8.6.4)式，只是x(n)又移进
1位，所以
(m)=2hn)o(m-”
-hCnD)a(j+1-)
=h(0)x(j+1)+h(Dx(j)+h(2D)xGj-1)+…
+h(N-Dx(j+1-(N-1)) (8.6.6)
综上所述，当m=jI+k,k=0,1,2,…,I-1,j=0,1,2,…时，有
y(m)=Zhcn)(m-n)=Zh(k+nDa(j-n) (8.6.7)
把式(8.6.7)中的h(k+nl)看做长度N=M/I的子滤波器的单位脉冲响应，并用p,(n)
表示：
p,(n)=h(k+nl)k=0,1,2,…,I-1;n=0.1,2,…,N-1
这样，从m=0开始，整数因子I内插系统的输出序列y(m)计算如下：
(8.6.8)
y(m)=∑p(n)xj-)=p(n)*2(n) (8.6.9)
293 Created by ZhuangHeng
第8章多采样率数字信号处理
式中，m=jI+k;k=0,1,2,…,I-1:j=0,1,2,…。显然，当m=jI+k从0开始增大
时，k从0开始以I为周期循环取值；j表示循环周期数。所以，实现(8.6.9)式的多相滤波
器结构如图8.6.9所示。I个子滤波器均运行于低采样率F,下，且系数少，计算量小，所
以多相滤波器结构是一种高效结构。输入端的x(n)每移入一个样值，I个子滤波器分别计
算出y(m)的I个样值，选择电子开关以高采样率F,=IF,依次逆时针循环选取I个子滤
波器的输出，形成输出序列y(m)。实现了整数因子I内插功能。
口口
数字信号处理(第五版)
x(n) Pa(n)
P?(n) 速率=IF
P?(n) y(m)
采样速率F=IF
采样率F P?(n) 采样率F
图8.6.9 整数因子I内插系统的多相滤波器结构
从I个子滤波器的频响特性可以解释“多相滤波器”的含义。对低通滤波器h(n)按整数
因子I抽取得到子滤波器p(n)。h(n)是截止频率为π/I的理想低通滤波器，则p?(n)的截
止频率必然是π,即I个子滤波器都是全通滤波器，幅度特性相同，它们的唯一区别是相位
特性不同，故称为“多相滤波器”结构。正是由h(n)的I个不同的起始点抽取得到I个子滤
波器，形成了这种多相特性。
根据整数因子I内插器的实现结构与整数因子D抽取器的实现结构互为转置关系的规
律，将图8.6.9给出的整数因子I内插系统的多相滤波器结构进行转置，则得到图8.6.10
所示的整数因子D抽取系统的多相滤波器结构。
294
P。(n) y(m)
速率F/D
速率F?
x(n)
图8.6.10 整数因子D抽取系统的多相滤波器结构
定义多相滤波器的单位脉冲响应为
p(n)=h(k+nD)k=0,1,2,…,D-1;n=0,1,2,…,N-1
p?n)
P?(n)
Po(n)
(8.6.10)
Created by ZhuangHeng
式中，N为p(n)的长度。一般选择原抗混叠FIR滤波器总长度M=DN,N=M/D。电子
开关以速率F,逆时针旋转，从子滤波器p。(n)在m=0时刻开始，并输出y(0);然后电子
开关以速率F,逆时针每旋转一周，即每次转到子滤波器p。(n)时，输出端就以速率F,=
F,/D送出一个y(m)样值。
下面以N=D=2,M=DN=4为例，验证图8.6.10所示的抽取系统多相结构的正确
性。首先根据图8.6.1(a)计算出抽取器的正确输出y(m):
D(n)=h(n)*2(n)=∑h(D(n-D
y(m)=v(Dm)=v(2m)
假设x(n)为因果信号，则
y(0)=v(0)=h(O)x(0) --oape+ 现在根据图8.6.10计算多相实现结构的输出y(m)。图8.6.10中，多相子滤波器p。(n)=
(8.6.11)
{h(0),h(2)},p?(n)={h(1),h(3)),开始时k=0,n=0,只有x(0)进入p。(n),p?(n)中
无信号，所以总输出y(0)=p。(0)x(0)=h(0)x(0)。逆时针旋转开始下一周期：k=D-1=1
时，电子开关转到p?(n),x(1)进入p?(n),p?(n)的输出为p,(0)x(1)=h(1)x(1);k=0时，
电子开关又转到p。(n),此时，x(2)进入p。(n)第一节，上一周期中进入p。(n)的x(0)移位到
p。(n)的第二节，所以p。(n)的输出为
p。(0)x(2)+p。(1)x(0)=h(0)x(2)+h(2)x(0)
总的输出y(1)为po(n)与p?(n)输出之和，即
y(1)=h(0)x(2)+h(2)x(0)+h(1)x(1)
同样道理，可求出下一旋转周期得到的输出为
y(2)=p?(0)x(3)+p?(1)x(1)+p。(0)x(4)+p。(1)x(2)
=h(1)x(3)+h(3)x(1)+h(0)x(4)+h(2)x(2)
所求y(0)、y(1)和y(2)与(8.6.11)式相同，所以，图8.6.10所给结构是正确的。 第8章多采样率数字信号处理 需要说明，在实际采样率转换系统中，常常会遇到抽取因子和内插因子很大的情况。
例如，按有理数因子I/D=150/61的采样率转换系统，从理论上讲，可以采用多相滤波器
结构准确地实现这种采样率转换，但是实现结构中将需要150个多相滤波器，而且其工作
效率很低。“多级实现结构”可以很好地解决该问题。而且，多级实现结构可以使滤波器总
长度大大降低。多级实现内容请参考文献[12,19]。按有理数因子I/D采样率转换系统还
可以采用线性时变滤波器结构实现]。
【例8.6.1】 设计一个按因子I=5的内插器，要求镜像滤波器通带最大衰减为
0.1 dB,阻带最小衰减为30 dB,过渡带宽度不大于π/20。设计FIR滤波器系数h(n),并
295 Created by ZhuangHeng
口
口
口
口口
口口口口
口口
n口
数字信号处理(第五版)
求出多相滤波器实现结构中的5个多相滤波器系数。
解 由(8.3.4)式知道FIR滤波器h(n)的阻带截止频率为π/5,根据题意可知滤波器
其他指标参数：通带截止频率为π/5-π/20=3π/20,通带最大衰减为0.1 dB,阻带最小衰
减为30 dB。调用 remezord函数求得h(n)长度M=47,为了满足5的整数倍，取M=50。
调用remez 函数求得h(n)如下：
h(0)=6.684246e-002=h(49) h(1)=-3.073256e-002=h(48)
h(2)=-4.303671e-002=h(47) h(3)=-5.803096e-002=h(46)
h(4)=-6.759203e-002=h(45) h(5)=-6.493009e-002=h(44)
h(6)=-4.657608e-002=h(43) h(7)=-1.386252e-002=h(42)
h(8)=2.674276e-002=h(41) h(9)=6.463158e-002=h(40)
h(10)=8.776083e-002=h(39) h(11)=8.607506e-002=h(38)
h(12)=5.500303e-002=h(37) h(13)=-1.800562e-003=h(36)
h(14)=-7.220485e—002=h(35) h(15)=-1.370181e-001=h(34)
h(16)=-1.740193e-001=h(33) h(17)=-1.631924e—001=h(32)
h(18)=-9.215300e-002=h(31) h(19)=4.004513e—002=h(30)
h(20)=2.202029e-001=h(29) h(21)=4.239994e-001=h(28)
h(22)=6.191918e-001=h(27) h(23)=7.725483e-001=h(26)
h(24)=8.568808e-001=h(25)
根据(8.6.8)式确定多相滤波器实现结构中的5个多相滤波器系数如下：
p。(n)=h(nl)={h(0),h(5),h(10),h(15),h(20),h(25),h(30),h(35),h(40),h(45)}
p?(n)=h(1+nl)={h(1),h(6),h(11),h(16),h(21),h(26),h(31),h(36),h(41),h(46)
p?(n)=h(2+nD)={h(2),h(7),h(12),h(17),h(22),h(27),h(32),h(37),h(42),h(47))
ps(n)=h(3+n)={h(3),h(8),h(13),h(18),h(23),h(28),h(33),h(38),h(43),h(48)}
p?(n)=h(4+nl)={h(4),h(9),h(14),h(19),h(24),h(29),h(34),h(39),h(44),h(49)}
8.7 采样率转换器的MATLAB实现
MATLAB信号处理工具箱提供的采样率转换函数有 upfirdn,interp,decimate,
resample,其功能简述如下。
Y=upfirdn(X,H,1,D):先对输入信号向量X进行I倍零值内插，再用H提供的
FIR数字滤波器(FIRDF)对内插结果滤波，其中H为FIRDF 的单位脉冲响应向量，
FIRDF采用高效的多相实现结构。最后按因子D抽取得到输出信号向量Y。
Y=interp(X,D):采用低通滤波插值法实现对序列向量X的I倍插值，其中的插值滤
波器让原序列无失真通过，并在X的两个相邻样值之间按照最小均方误差准则插入I-1
个序列值。得到的输出信号向量Y的长度为X长度的I倍。
296
Created by ZhuangHeng
Y=decimate(X,D,N):先对序列X抗混叠滤波，再按整数因子D对滤波输出序列抽
取。输出序列Y的长度是X长度的1/D。抗混叠滤波用N阶切比雪夫I型低通滤波器，阻
带截止频率为0.8F,/(2D),如果省略N,则默认用8阶切比雪夫I型低通滤波器；Y=
decimate(X,D,N,FIR)用长度为N的FIR滤波器，FIR 滤波器是抽取函数 decimate自
动调用firl(N,1/D)设计的。省略N,则默认用30点FIR数字滤波器。
Y=resample(X,I,D):采用多相滤波器结构实现按有理数因子I/D的采样率转换。
如果原序列向量X的采样频率为F,长度为L,则序列Y的采样频率为F,=(I/D)F,,长
度为(I/D)L,(当(I/D)L,不是整数时，Y的长度取不小于(I/D)L、的最小整数)。该函数具
有默认的抗混叠滤波器设计功能，按照最小均方误差准则调用函数 firls设计。
[Y,B]=resample(X,I,D):返回输出信号向量Y和抗混叠滤波器的单位脉冲响应
序列向量B。
Y=resample(X,I,D,B):允许用户提供抗混叠滤波器的单位脉冲响应序列向量B。
这些函数的其他调用格式请用help命令查阅。
【例8.7.1】 编写程序产生长度为41的序列x(n)=sin(0.1πn)+0.5sin(0.5πn),再
调用 resample函数对x(n)按因子3/8进行采样率变换，并绘制采样率变换器的输入序列
x(n)、输出序列y(n)和采样率变换器中的FIR 数字滤波器的单位脉冲响应h(n)及其频率
响应特性曲线。
解 本例题的实现程序ep871.m如下：
??8.7.1实现程序ep871.m:调用 resample 函数实现按因子3/8进行采样率变换
n=0:40;xn=sin(0.1*pin)+0.5*sin(0.5*pi*n);??生长度为41的序列向量xn
[yn,hn]=resample(xn,3,8);??xn按因子3/8进行采样率变换，yn为转换器输出序列，hn是
?RDF的单位脉冲响应
??下是绘图部分
subplot(3,2,D;stem(hn,.);axis([0,160,-0.1,0.5]);title('(a)');xlabel(t);
ylabel('hGi))
w=(0:1023)*2/1024;
subplot(3,2,2):plot(w,20*log10(abs(fft(hn,1024)))):axis([0,1/4,-80,20]):grid on
title('(b));xlabel('\omega/\pi);ylabel('20lg(|Hg(\omega)|5)
subplot(3,1,2);stem(n,xn,'.):titleC'(e));xlabel('n'):ylabel('x(n)) 第8章多采样率数字信号处理
ny=0:length(yn)-1;
subplot(3,1,3);stem(ny,yn,.);titleC'(d)');xlabelC'm2);ylabel('y(m)')
运行程序得到采样率转换器的输入信号x(n)、输出信号y(m)、FIR数字滤波器的单位
脉冲响应h(n)及其频率响应的波形分别如图8.7.1(c)、(d)、(a)和(b)所示。由图(b)可以
看出，resample函数默认设计的抗混叠滤波器的阻带最小衰减大于40dB,满足理论要求。
x(n)的长度为40,y(m)的长度为40×3/8=15,h(n)的长度为161。由图8.7.1可见，低
通滤波器滤除输入信号中较高的频率成分0.5sin(0.5πn),采样率变换器输出单频正弦波
采样，采样频率为F,=3F,/8,所以输出序列
297
Created by ZhuangHeng
口口口 ■■ ■ ■
口口
口
□□ 口
口
口
口
口
数字信号处理(第五版)
y(m)=sin(0.1π×3m)=sin(5πm)
20 0.4
0.2
0 201aHae) 0
-20
-40
-60
0 50 100 150 -80
0
VW
0.05 0.1 0.15 0.2 1 @/π
(a) (b)
2
x(n) 0
-2
0 5 10 15 20 25 30 35 40
n
(c)
2
Mm) 0
-2
0 5 10 15
m
(d)
图8.7.1 程序ep871.m运行结果
习题与上机题
1.已知信号x(n)=a"u(n),|a|<1。
(1)求信号x(n)的频谱函数X(e")=FT[x(n)];
(2)按因子D=2对x(n)抽取得到y(m),试求y(m)的频谱函数。
(3)证明：y(m)的频谱函数就是x(2n)的频谱函数。
2.假设信号x(n)及其频谱X(e")如题2图所示。按因子D=2直接对x(n)抽取，得到
信号y(m)=x(2m)。画出y(m)的频谱函数曲线，说明抽取过程中是否丢失了信息。
X(el)
298
一π 恐 0
3
π@
题2图
3.按整数因子D=4抽取器原理方框图如题3图(a)所示。其中，F,=1kHz,F,=
Created by ZhuangHeng
250 Hz,输入序列x(n)的频谱如题3图(b)所示。请画出题3图(a)中理想低通滤波器
hp(n)的频率响应特性曲线和序列v(n)、y(m)的频谱特性曲线。
X(e)
RIr ho(n) z(n) 0pIT-FJD 1
一篇 0
@
(a) (b)
题3图
4.按整数因子I内插器原理方框图如题4图所示。图中，F,=200 Hz,F,=1kHz,输
人序列x(n)的频谱如题3图(b)所示。确定内插因子I,并画出题4图中理想低通滤波器
h?(n)的频率响应特性曲线和序列v(m)、y(m)的频谱特性曲线。
Frun-17 z(m) m-
题4图
5°.设计一个抽取器，要求抽取因子D=5。用 remez函数设计抗混叠FIR滤波器，图
示滤波器的单位脉冲响应和损耗函数。要求通带最大衰减为0.1 dB,阻带最小衰减为
30 dB,过渡带宽度为0.02π rad。画出实现抽取器的多相结构，并求出多相实现时各子滤
波器的单位脉冲响应。
6°.设计一个内插器，要求内插因子I=2。用remez 函数设计镜像FIR滤波器，图示
滤波器的单位脉冲响应和损耗函数。要求通带最大衰减为0.1 dB,阻带最小衰减为30 dB,
过渡带宽度为0.05π rad。画出实现内插器的多相结构，并求出多相实现时各子滤波器的
单位脉冲响应。
7°.设计一个按因子2/5降低采样率的采样率转换器，画出系统原理方框图。要求其
中的FIR低通滤波器的过渡带宽为0.04π rad,通带最大衰减为1 dB,阻带最小衰减为
30 dB,设计FIR低通滤波器的单位脉冲响应，并画出一种高效实现结构。
8°.假设信号x(n)是以奈奎斯特采样频率对模拟信号x(1)的采样序列，采样频率
F,=10 kHz。现在为了减少数据量，只保留0≤f≤3 kHz的低频信息，希望尽可能降低采
样频率，请设计采样率转换器。要求经过采样率转换器后，在频带0≤f≤2.8 kHz中频谱
失真不大于1dB,频谱混叠不超过1??
(1)确定满足要求的最低采样频率F,和相应的采样率转换因子；
(2)画出采样率转换器原理方框图；
(3)确定采样率转换器中FIR低通滤波器的技术指标，用等波纹最佳逼近法设计FIR
低通滤波器，画出滤波器的单位脉冲响应及其损耗函数曲线，并标出指标参数(通带截止频
率、阻带截止频率、通带最大衰减和阻带最小衰减);
(4)求出多相实现结构中子滤波器的单位脉冲响应，并列表显示或打印。
第8章多采样率数字信号处理
299
Created by ZhuangHeng
0■
口口口
口口口 …口口
0口
口
数字信号处理(第五版)
第9章
数字信号处理的实现
数字系统的实现方法有软件实现和硬件实现。软件实现就是按照系统运算结构设计软
件并在通用计算机上运行实现。硬件实现方法则是按照设计的运算结构，利用加法器、乘
法器和延时器等组成专用的设备，完成特定的信号处理算法。利用数字信号处理专用单片
处理器(DSP)实现，无疑是一种好的实现方法，此方法属于软硬结合实现。一般理论设计
后，只得到系统的系统函数或者差分方程，还必须再具体设计一种算法，进行实现。第5章
学习了各种各样的网络结构，它们均代表了一种具体算法，根据这些具体算法才能设计软
件或硬件进行实现。
不同网络结构的计算误差、计算中要求的存储量、计算的复杂性及计算速度，设备成
本等均不相同。这里计算的复杂性指的是乘法次数、加法次数、取数存数次数以及两数之
间的比较次数等。存储量指的是为存储系统参数、中间计算结果以及输入输出信号值等要
求的存储量。运算速度除了和硬件本身的速度有关以外，主要和计算的复杂性有关。
运算误差主要来自有限字长效应，它是数字信号处理实现中特有的重要问题。因为数
字计算机用二进制编码信号进行运算，二进制编码的位数(或字长)有限，带来了各种量化
误差，形成有限精度的运算。因此需要研究各种网络结构对有限字长效应的敏感程度，以
及为给定的运算误差所需要的字长等。
本章主要学习各种量化误差，包括系数量化误差、运算量化误差以及A/D变换器中的
量化误差，最后介绍数字信号处理的软件实现及硬件实现方法。
300
Created by ZhuangHeng
9.1 数字信号处理中的量化效应
9.1.1 量化及量化误差
数字信号处理技术实现时，信号序列值、运算结果及参加运算的各个参数都必须用二
进制的编码形式存储在有限长的寄存器中，如果该编码长度长于寄存器的长度，需要进行
尾数处理；运算中，二进制乘法会使位数增多，也需要进行尾数处理。尾数处理必然带来误
差，例如，序列值0.8012用二进制表示为(0.1100110101…)。,如用7位二进制表示，序列
值则为(0.110011)?,其十进制为0.796 875,与原序列值的差值为0.8012-0.796 875=
0.004 325,该差值是因为用有限位二进制数表示序列值形成的误差，称为量化误差。量化
误差产生的原因是用有限长的寄存器存储数字引起的，因此也将这种误差引起的各种效应
称为有限寄存器长度效应。这些量化效应在数字信号处理技术实现中，表现在以下几方面：
A/DC中量化效应，数字网络中参数量化效应，数字网络中运算量化效应，FFT中量化效
应等。这些量化效应在数字信号处理技术实现时，都是很重要的问题，一直受到科技工作
者的重视，并在理论上进行了很多研究。随着科学技术的飞速发展，主要是数字计算机的
发展，计算机字长由8位、16位提高到32位；一些结合数字信号处理特点发展起来的数字
信号处理专用芯片近几年来发展尤其迅速，不仅处理快速，字长达到32 bit;另外，高精度
的A/D变换器也已商品化。这样，随着计算字长的大大增加，量化误差大大减少了，因此，
对于处理精度要求不高、计算字长较长的一般数字信号处理技术的实现，可以不考虑这些
量化效应。但是对于要求成本低，用硬件实现时，或者要求高精度的硬件实现时，这些量化
效应问题亦然是重要问题。
如果信号值用b+1位二进制数表示(量化),其中一位表示符号，b位表示小数部分，
能表示的最小单位称为量化阶(或量化步长),用q表示，q=2?。对于超过b位的部分进行
尾数处理。尾数处理有两种方法：一种是舍人法，即将尾数第b+1位按逢1进位，逢0不进
位，b+1位以后的数略去的原则处理；另一种是截尾法，即将尾数第b+1位以及以后的数
码略去。显然这两种处理方法的误差会不一样。
如果信号x(n)值量化后用Q[x(n)]表示，量化误差用e(n)表示，
e(n)=Q[x(n)]-x(n)
一般x(n)是随机信号，那么e(n)也是随机的，经常将e(n)称为量化噪声。为便于分析，一
般假设e(n)是与x(n)不相关的平稳随机序列，且是具有均匀分布特性的白噪声。设采用定
点补码制，截尾法和舍入法的量化噪声概率密度曲线分别如图9.1.1(a)和(b)所示。这样
截尾法量化误差的统计平均值为-q/2,方差为q2/12;舍入法的统计平均值为0,方差也为
q2/12,这里q=2”。很明显，字长b+1愈长，量化噪声方差愈小。后面我们将分别介绍各
种量化效应。
根据上述量化原理，四舍五入量化的数学模型为
第9章数字信号处理的实现
301
Created by ZhuangHeng
口口
口
口口
口口o□00
口口
面而
数字信号处理(第五版)
ple(n)] p[e(n)]
q
q
-q 0 e(n) 9
0 e(n)
(a) (b)
图9.1.1 量化噪声e(n)的概率密度曲线
Q[x]=q·round[x/q] (9.1.1)
式中，round[x]表示对x四舍五人后取整，round[x/q]表示x包含量化阶q的个数，所以
Q[x]=q·round[x/q]就是量化后的数值。x可以是标量、向量和矩阵。将数取整的方法有
四舍五入取整、向上取整、向下取整、向零取整，对应的MATLAB取整函数分别为
round(x)、ceil(x)、floor(x)、fix(x)。round最常用，对应的MATLAB量化语句为xq=
q*round(x/q)。
例如，x=0.8012,b=6,量化程序如下：
x=0.8012;b=6;
q=2-b;
xq=q*round(x/q)
e=x-xq
??算量化阶q
??x舍入量化
??算量化误差e
运行结果：
xq=0.796875,e=0.004325
9.1.2 A/D变换器中的量化效应
A/D变换器的功能原理图如图9.1.2(a)所示，图中(n)是量化编码后的输出，如果
未量化的二进制编码用x(n)表示，那么量化噪声为e(n)=i(n)-x(n),因此A/D变换器
的输出x(n)为
(n)=x(n)+e(n) (9.1.2)
考虑A/D变换器的量化效应，其统计模型如图9.1.2(b)所示。这样，由于e(n)的存在而降
低了输出端的信噪比。
e(n)
由细 (n) x?(0) x?(n7) x?() 理想ADC 采样 量化编码
(b)统计模型 (a)A/D变换器功能原理图
图9.1.2 A/DC功能原理图及统计模型
假设A/D变换器输入信号x?(t)不含噪声，输出x(n)中仅考虑量化噪声e(n),信号
x,(t)平均功率用c2表示，e(n)的平均功率用。表示，输出信噪比用S/N表示，
S-
302
Created by ZhuangHeng
信噪比通常用dB数表示：
S-1018dB (9.1.3a)
A/D变换器采用定点舍入法，e(n)的统计平均值m.=0,方差
a=12°2=12“ (9.1.3b)
将c,代入式(9.1.3a),得到：
S=6.02b+10.79+10lgo (9.1.3c)
此式表明，A/D变换器的位数b愈多，信噪比愈高；每增加一位，输出信噪比增加约6dB。
当然，输出信噪比也和输入信号功率有关，为增加输出信噪比，应在A/D变换器动态范围
中，尽量提高信号幅度。如果对输出端信噪比提出要求，根据式(9.1.3c)可以估计对A/D
变换器的位数要求。设x,(t)服从标准正态分布N(0,c2),A/D变换器的动态范围为
±1V。我们知道，对于正态分布，x?(t)的幅度落入±3a,以外的概率很小，可以忽略。为
=3v, 充分利用其动态范围，取 ,代入式(9.1.3c),得
S=6.02b+1.29
如果要求S/N≥60 dB,由上式计算出b≥10;如果S/N≥80 dB,则b≥13。增加A/D变换
器的位数，会增加输出端信噪比，但A/D变换器的成本也会随位数b增加而迅速增加；另
外，输入信号本身有一定的信噪比，过分追求减少量化噪声提高输出信噪比是没有意义的。
因此，应根据实际需要，合理选择A/D变换器位数。
输入最大幅度为±1V的b位A/D变换器，根据舍入量化模型式(9.1.1),可以写出b
位A/D变换器的MATLAB量化函数quant:
function y=quant(x,b.V)
if nargin<3V=max(abs(x)):end ??省V,则默认V等于x的最大值
?掉负号 ax=abs(x):
q=V/(2-(b-1)); ??算量化阶q
??|x|舍入值量化 xq=q*round(ax/q);
?入负号，恢复带负号的量化值y y=sign(x),*xq:
第…
该函数可以对带负号的数据x进行A/D变换，x可以是标量、向量和矩阵。
应当注意，上述A/D为线性量化，其缺点是不利于小信号。为了改善小信号量化信噪
比，工程上常常采用非线性量化。
9.1.3 数字系统中的系数量化效应
系统对输入信号进行处理时需要若干参数或者称为系数，这些系数都要存储在有限位
数的寄存器中，因此存在系数的量化效应。系数的量化误差直接影响系统函数的零、极点
位置，如果发生了偏移，会使系统的频率响应偏离理论设计的频率响应，不满足实际需要。
303
Created by ZhuangHeng
数字信号处理(第五版)
量化误差严重时，极点移到单位圆上或者单位圆外，造成系统不稳定。
系数量化效应直接和寄存器的长度有关，但也和系统的结构有关，有的结构对系数的
量化误差不敏感，有的却很敏感。各种结构对系数量化误差的敏感度也是本节要研究的内
容之一。
MATLAB按二进制双精度格式表示数，表示一个数用8字节(64位二进制数)。键入
命令eps、realmin和 realmax,可以显示出MATLAB浮点制表示的量化阶q=252=
2.2204×10-1?、可以表示的最小数和最大数分别为2.2251×10-308和0.7977×10。所以
MATLAB的量化误差可以忽略不计，用MATLAB设计的滤波器系数可以看成精确的理
论值。工程实际中要把用MATLAB设计的滤波器付诸实现，必须采用嵌入式的DSP芯片
(或专用数字硬件电路),DSP芯片(或专用数字硬件电路)的字长一般为8、16、32 bit,采
用定点或浮点二进制表示数，并进行数值运算。因此，用MATLAB设计完成后，必须考虑
实际系统的有效字长，对设计结果进行量化仿真检验。当然，实际系统的有效字长越长，实
际实现的性能越逼近MATLAB设计结果。好在MATLAB提供了定点运算方真模块库
(Fix-Point Blockset),有兴趣的读者请找相关书籍学习。
1.系数量化对系统频响特性的影响
数字网络或者数字滤波器的系统函数用下式表示：
(9.1.4)
式中的系数b,和a,必须用有限位二进制数进行量化，存储在有限长的寄存器中，经过量化
后的系数用b,和a,表示，量化误差用△b,和△a,表示，那么
a,=a,+△a, (9.1.5)
b,=b,+△b, (9.1.6)
实际的系统函数用H(z)表示，公式为
(9.1.7)
显然，系数量化后的频率响应不同于原来设计的频率响应。
【例9.1.1】 假设带通滤波器的系统函数如下式：
H(z)=i-0.17z3+0.965
如果用b+1位二进制表示上式中的系数，b=4,采用舍人法处理尾数，试分析系数量化误
差对极点位置和频响特性的影响。
解 求解本例的系数量化与绘图程序为ep911.m。
?911.m:例题9.1.1系数量化与图9.1.3绘图程序
304
Created by ZhuangHeng
B=1;A=[1.-0.17.0.965]:
b=4;
??化前系统函数系数向量
??化二进制位数
Aq=quant(A,b);
p=roots(A)
pq=roots(Aq)
ap=abs(p)
apq=abs(pq)
??下为绘图部分(省略)
??系统函数分母系数向量A进行b位量化
??算量化前的极点
??算量化后的极点
??算量化前极点的模
??算量化后极点的模
运行程序，得到量化后的系统函数H(z)为
A(z)=i-0.200021+0.933
并求出H(z)和H(z)的极点分别为
Pi.2=0.0850±j0.9787
Pi.2=0.1000±j0.9609
显然，因为系数的量化，使极点位置发生变化，算出极点的模为：Ipi.zl=0.9823,Ip.zl=
0.9661,说明量化后的极点离单位圆稍远一些，会使带通滤波器的幅度特性的峰值减小，
中心频率有所移动。程序自动画出H(z)和H(z)的幅频特性曲线分别如图9.1.3中的实线
和虚线所示。该例题说明由于系数量化效应，使极点位置发生了变化，从而改变了原来设
计的频率响应特性。
30
25
lH(e) 量化前
20
量化后 15
10
0.46 0.48 0.5
a/
图9.1.3 量化前后系统幅频响应曲线 第9章数字信号处理的实现 应当注意，数字滤波器的系数的大小有时差别很大，如果用b位定点数表示时，以最
大的系数确定量化阶q,对所有系数统一量化，必然使较小的系数相对量化误差很大，使滤
波器性能远离设计指标要求。所以工程实际中常常采用浮点制表示系数。
2.极点位置敏感度
下面分析系数量化误差对极零点位置的影响。如果极零点位置改变了，严重时不仅IIR
系统的频率响应会发生变化，还会影响系统的稳定性。因此研究极点位置的改变更加重要。
为了表示系数量化对极点位置的影响，引入极点位置灵敏度的概念，所谓极点灵敏度，是
指每个极点对系数偏差的敏感程度。相应的还有零点位置灵敏度，分析方法相同。下面讨
论系数量化对极点位置的影响。
305
Created by ZhuangHeng
口口
口口
数字信号处理(第五版)
(9.1.4)式中，分母多项式A(z)有N个极点，用p(k=1,2,…,N)表示，系数量化
后的极点用p(k=1,2,3,…,N)表示，那么
p=p+△p
上式中极点偏差△p.表示第k个极点的偏差，它应该和各个系数偏差都有关，它和各系数
偏差的关系用下式表示：
△p= (9.1.8)
的大小直接影响第；个系数偏差△a,对第k个极点偏差△p的影响大小， 上式中，
愈小，△p, 愈小。称 为极点p,对系数a,变化的灵敏度。下面推导 愈大，△p,愈大，
该灵敏度和极点的关系。
?a
-aA(2)p (9.1.9)
式中
A(2)=1-a=πa-na) (9.1.10)
A()=- (9.1.11)
一a-n)a-a) (9.1.12)
将(9.1.11)和(9.1.12)式代入(9.1.9)式，得到
i- (9.1.13)
上式即是第k个极点对系数a,变化的敏感度。将上式代入(9.1.8)式，得到
(9.1.14)
上式表示系数量化误差引起的第k个极点的偏差，由该式可以得到以下结论：
(1)极点偏移和系数量化误差大小有关。如果系统采用定点补码制，尾数采用b位舍
入法处理，那么△a,的变化范围为[-q/2,q/2],q=2,均方误差为q2/12,因此为减小
极点偏移，应加长寄存器长度。
(2)分母多项式中，p-p?是极点p,指向极点p。的矢量，整个分母是所有极点(不包
括p。极点)指向极点p,的矢量之积。如果极点密集在一起，极点间距短，(9.1.13)式分母
306
Created by ZhuangHeng
就很小，那么极点对系数量化误差的敏感度高，相应的极点偏差就大。
(3)极点偏差与系统函数的阶数N有关，阶数愈高，极点灵敏度愈高，极点偏差也愈
大。这样对于一些窄带滤波器，因为要求选择性高，势必要求阶数高，且极点密集，所以极
点的偏差会很大。严重时使极点移到单位圆上或者单位圆外，引起系统不稳定。
考虑以上因素，系统的结构最好不用高阶的直接型结构，而将其分解成一阶或者二阶
系统，再将它们进行并联或者级联，以便减小极点偏移量。
【例9.1.2】 按照例6.5.2数字带通滤波的设计指标：系统采样频率F,=8kHz,要求
保留2025~2225 Hz频段的频率成分，幅度失真小于1 dB;滤除0~1500 Hz和2700 Hz以
上频段的频率成分，衰减大于40 dB。调用MATLAB滤波器设计分析工具FDATool,设计
该滤波器，并对其系数用16位字长量化，其中尾数15位。
直接型结构系数量化前后的零极点分布图和频响特性曲线分别如图9.1.4(a)和(b)所
示。级联型结构系数量化前后的零极点分布图和频响特性曲线分别如图9.1.4(c)和(d)所
示。由图可见，六阶椭圆带通滤波器的直接型结构的极点对系数量化误差的敏感度高，相
应的极点偏差大，量化误差使频响曲线偏差很大。量化后的滤波器无法使用。但级联型结
构的零极点对系数量化误差的敏感度很低，相应的极点几乎看不出偏差，量化前后频响曲
线基本重合。所以，工程上高阶滤波器一般都用级联型结构和并联型结构。
1
0.8
0.6
0.4 Imaginary 0.2
0
-0.2
-0.4
-0.6
-0.8
-1
1
0.8
0.6
0.4 Imaginary 0.2
0
-0.2
-0.4
-0.6
-0.8
-i
0. 10
0
一考幅度
…化运度
A -10
幅度/dB -20
-30
-40
-50
-60
考视
口量化后零点
干量化石概点 -70
-1-0.5 0 0.5 1
-80L0 500 1000 1500 2000 2500 3000 3500 4000
Real 频率/Hz
(a) (b)
waro 10
0
一幅度
…后幅度
-10
幅度/dB -20
-30
-40
-50
-60 O零点
:e
被点
口世化后零点
十量化后酸点
-70
-1 -0.5 0 0.5 1
-80L0 500 1000 1500 2000 2500 3000 3500 4000
Real 频率/Hz
(c) (d)
图9.1.4 窄带滤波器系数量化前后的零极点分布图和频响特性曲线比较
第9章数字信号处理的实现
307
Created by ZhuangHeng
数字信号处理(第五版)
观察图9.1.4(a)和(c)发现，直接型结构和级联型结构系数量化前后的零点偏移都很
小。这是因为该滤波器的各零点之间距离较大(不密集)。而窄带带通滤波器的极点分布密
集，所以直接型结构的极点对系数量化误差的敏感度高，相应的极点偏差大。本例的实验
结果与理论结论一致。
9.1.4 数字系统中的运算量化效应
在数字网络的运算中，其中间结果和最后结果的位数，如果超出了规定的有限位二进
制数长度，则需要进行尾数处理，这样便引起了运算量化误差；运算中还可能出现溢出，造
成更大的误差；运算误差的大小除了和规定的二进制数的长度有关以外，还和网络结构有
关。下面就以上三个问题进行介绍。
1.运算量化效应
在定点制运算中，二进制乘法的结果尾数可能变长，需要对尾数进行截尾或舍入处理；
在浮点制运算中无论乘法还是加法都可能使二进制的位数加长，也需要对尾数进行截尾或
舍入处理。这样不管是采用定点制还是浮点制，都会因运算产生量化误差，这种误差称为
运算量化误差。下面我们仅介绍定点制的乘法量化误差。
由于输入信号是随机信号，产生的运算量化误差同样是随机的，需要进行统计分析。
运算量化误差在系统中起噪声作用，会使系统的输出信噪比降低。为了分析计算简单，假
定运算量化误差具有以下统计特性：①系统中所有的运算量化噪声都是平稳的白噪声；
②所有的运算量化噪声之间以及和信号之间均不相关；③这些噪声的概率密度都是均匀
分布的。
假设定点乘法运算按b位进行量化，量化误差用e(n)表示。对于一个乘法支路，如图
9.1.5(a)所示，图中节点变量v?(n)=av?(n),经过量化后用o?(n)=Q[av?(n)]表示，那么
e(n)=Q[av?(n)]-v?(n)
ü?(n)=Q[av?(n)]=v?(n)+e(n)
这样量化以后乘法支路的统计模型如图9.1.5(b)所示。因此系统中所有的乘法支路都和图
9.1.5(b)一样引入一个噪声源。
e(n)
v(n) v(n) a
v?(n) (n)=e(n)+v(n) a
(a) (b)
图9.1.5 乘法支路及其量化模型
图9.1.6中，有两个乘法支路，采用定点制时共引入两个噪声源，即e?(n)和e?(n),
噪声e?(n)直接输出，噪声e?(n)经过网络h(n)输出，输出噪声e(n)为
e?(n)=e?(n)*h(n)+e?(n)
如果尾数处理采用定点舍人法，则输出端噪声统计平均值为
308
Created by ZhuangHeng
x(n) (n)+er(n)
e?(n)
a
zb
e(n)
图9.1.6 考虑运算量化误差的一阶网络结构
m,= E[e?(n)*h(n)]+E[e?(n)]
=E[∑h(m)e?(n-m)]+E[e:(n)]
=m∑h(m)+m
上式中E[]表示求统计平均值，m?和m2分别表示两个噪声源的统计平均值，这里m?=
m?=0,因此，
m=0
由于e?(n)和e?(n)互不相关，求输出端噪声方差时，可分别求其在输出端的方差，再相加。
这里，每个噪声源的方差均为
d=1
式中q=2”。输出端的噪声e?(n)的方差为
=E[(e,(n)-m,)2]=E[ej(n)]=E[e(n)]+E[e?(n)]
式中，e(n)和e,?(n)分别表示e?(n)和e?(n)在输出端的输出；
E[e?(n)]=}
ELe(w)]=E[∑h(m)e;(n-m)ZhCDe:(n-D]
=∑Zh(m)h(D)E[e?(n-m)e?(n-1)]
=2Zh(m)h(1)s(m-)
=Zh2(m)
=cZh2(m)+a:
第9章数字信号处理的实现
根据帕斯维尔定理((2.5.29)式),,也可以用下式计算：
a=fH(2)H(z)+
式中
H(z)=1±a
309
Created by ZhuangHeng
口口
口
口口
□
口
口口
口
数字信号处理(第五版)
2.网络结构对输出噪声的影响
下面我们通过一个二阶网络的例子说明不同网络结构对输出噪声的影响。
【例9.1.3】 已知网络系统函数为
H(z)=1-1.4+0+0.72 IzI>0.9
网络采用定点补码制，尾数处理采用舍入法。试分别计算直接型、级联型和并联型结构输
出噪声功率。
解 H(z)=1-1.4+0+0.72-0.4+0..2-0.8
1-0.92+-0.8
按照以上H(z)的三种表示公式，画出考虑乘法量化误差的直接型、级联型和并联型网络结
构图如图9.1.7所示。下面分别计算这三种网络结构的输出信噪比。
eo(n)
x(m) 0.4
1.7 z0.2
-0.72 z1
nFy(n)+e(n)
e?(n) e?(n)
es(n)
(a)
ei(n) ea(n)
x(n) 0.4 食n=y(n)+e(n) x(n) 5.6 nFy(n)+e/n)
z1 z
eon) 0.9 0.2 0.8
e?(n) e3(n)
es(n)
(b)
er(n) 0.9
te?(n)
-5.2
0.8
(c)
图9.1.7 例9.1.3的网络结构图
(1)直接型。
e?(n)=e。(n)+e?(n)+[e?(n)+e?(n)]*h(n)
=e×2+g2×2×元H(z)H(s)d
式中
蠹fH(z)H(z1)d-嘉a-0.94+0.20.8z5×a-0.42+0.20.82)
=Res[H(z)H(z1),0.9]+Res[H(z)H(z1),0.8]
=61.053-28.899=32.164
310
Created by ZhuangHeng
=62+?q×32.164=5.527q2
(2)级联型。
e?(n)=e。(n)*h(n)+[e?(n)+e?(n)+e?(n)]*h?(n)
H?(2)=1-0.82,h(n)=zT'[H?(z)]
=i×fH(2)H(z1)d+2×嘉9H?(2)H?(z)
焉fH?(2)H?(z1)餐=嘉9.a-0.82)a-0.82)
=Re[H?(2)H?(z1)a,0.8]
=2.778
=12g×32.164+4a×2.778=3.375q
(3)并联型。
e?(n)=[e。(n)+e?(n)]*h?(n)+[e?(n)+e?(n)]*h?(n)
H?(2)=-0.8=ZT[h?(n)],h?(m)=0.9°u(n)
H?(z)=-0.8=ZT[h?(n)],h?(n)=0.8"u(n)
=1×2×∑hi(n)+z×2×Zh(n
=言×0.g+?0.8
以上式中
=1.34q2
q2=2-
此例表明，对同一个系统函数H(z),因乘法量化误差在输出端引起的量化噪声功率除
了与量化位数b有关外，还与网络结构形式有关。量化位数b愈长，输出量化噪声愈小；网
络结构中，输出端量化噪声以直接型最大，级联型次之，并联型最小。原因是直接型量化噪
声通过全部网络，经过反馈支路有积累作用，级联型仅一部分噪声通过全部网络，并联型
每个一阶网络的乘法运算量化噪声通过相应的一阶网络后直接送到输出端。而对于三种不
同网络结构输出端的信号功率都是一样的。设输入信号x(n)方差为o2,均值m,=0,输出
端信号功率用a,表示
=c∑h2(m)=焉fH(2)H(z1)
输出信噪比S/N用信号和噪声的功率比计算
S-
第9章数字信号处理的实现
311
Created by ZhuangHeng
口
口
口口
口
数字信号处理(第五版)
因此，输出信噪比也同样随量化位数b增加而增加；网络结构中以并联型输出信噪比最大，
直接型最差。对于定点制，输出信噪比还与输入信号功率有关，应在保证运算中不发生溢
出的前提下，尽量增大输入信号幅度。
实际时域离散线性时不变系统可以用线性常系数差分方程表示：
y(n)=∑bx(n-)+ay(n-i)
所以，不论采用哪种结构，其中与量化有关的基本运算单元如下：
y=k?x?+k?x?
只要调用定点量化函数quant分别对每个基本运算单元量化，求解差分方程，即可得到量
化后的实际系统输出响应y(n),也可以计算e(n)=y(n)-y(n)分析各种结构的有限字长
效应。基本运算y=k?x?+k?x?的MATLAB函数qbcu.m为
function yq=qbcu(k1,xl,k2,x2,b,V)
?本运算y=kx*x1+k2*x2的定点量化运算函数
???量化尾数位数，V为量化动态范围
klq=quant(kl,b,V);k2q=quant(k2,b,V);
xlq=quant(x1,b,V);x2q=quant(x2,b,V);
vl=klq*xlq;vlq=quant(yl,b,V);
v2=k2q*x2q;v2q=quant(v2,b,V):
yq=vlq+v2q;
3.防止溢出的措施
我们知道，在数字网络中有两种运算，即乘法和加法，由于存在有限寄存器长度效应，
乘法会产生乘法量化效应，加法不会产生量化误差，但却会产生溢出。例如，在定点制网络
系统中，补码二进制0.110加0.011,结果为1.001,其真值为-7/8,实际真值应是9/8。
这样，由于加法进位，产生了溢出，形成了很大的误差。在浮点制系统中，由于动态范围
大，一般不产生溢出。下面介绍一般防止溢出的方法。
可以采用限制输入信号动态范围的方法来防止溢出。设网络节点用v.表示，从输入节
点x(n)到v,节点的单位脉冲响应为h,(n),
=∑h,(m)x(n-m)
l,I≤1x1--21n(m)1 (9.1.15)
式中，|xlm为|x(n)|的最大值。为保证节点v,不溢出，要求[v,|<1,那么要求：
1c1 (9.1.16)
上式即是对输入信号动态范围的限制。例如，一阶IIR网络，单位取样响应h(n)=a"u(n),
|a|<1
312
Created by ZhuangHeng
<c-1-la
要求输入信号的动态范围为1-|a|,显然该动态范围与一阶网络的极点a有关。极点愈靠
近单位圆，限制输入信号的动态范围就愈小。另外，如果输入信号幅度固定在一定范围中，
可以在输入支路上加衰减因子来防止溢出。例如，在图9.1.8中，为防止溢出，输入支路上
y(n) x(n) A 加衰减因子A,0<A<1。
z1 y(n)=A∑h(m)e(n-m) a
设|x(n)|=m,则有 图9.1.8 一阶滤波网络
Iy(n)I≤Ar21h(m) 0<A<1
为防止溢出，要求|y(n)|<1,即
A<1c (9.1.17)
对于该例，有
A<1-la (9.1.18)
对于级联型或并联型结构，可在每个基本节的输入支路加衰减因子，如图9.1.9中A?和
A?。如果xm=1,图中A?和A?均按下式计算：
A<o (9.1.19)
式中，h(m)是每个相应基本节的单位脉冲响应。这样可保证每个基本节的输出节点不溢
出。对于基本节内部的加法可能有溢出，但理论可以证明对补码加法，只要输出节点不溢
出，网络内部的溢出不影响结果的正确性。
A? A? y(n)
(n) a zb? a? zb?
a? b? a4 b? 第9章数字信号处理的实现
x(n) A n)
z a?
a? b?
b?
z1
a
图9.1.9 级联型与并联型的衰减因子
最后要指出的是按照(9.1.17)式或(9.1.19)式选择衰减因子是比较保守或者说是比较
313
Created by ZhuangHeng
苛刻的。经常用下式计算：
<C (9.1.20)
式中，8是大于1的数，如果输入信号是方差为1的白噪声，可选δ≥5。
9.2 数字信号处理技术的软件实现
数字信号的处理可以用软件实现，也可以用硬件实现。软件实现指的是在通用计算机
上执行数字信号处理程序。这种方法灵活，但一般不能实现实时处理。硬件实现是利用数
字信号处理专用集成电路或单片数字信号处理器DSP(Digital Signal Processor)来实现的。
目前，这些器件一般都照顾到数字信号处理的特点，内部带有乘法器、累加器，采用流水线
工作方法以及并行结构，多总线，速度快，并配有适合数字信号处理的指令等。一些特殊的
专用器件有：FFT专用芯片，FIR滤波器、卷积和相关等专用芯片，它的软件算法已在芯
片内部用硬件实现，随着超大规模集成电路的发展，DSP芯片成本在不断下降，从而使这
种实现方法成为数字信号处理的主导方法。本节主要介绍软件实现方法。
在第1章已学习过描写系统的线性常系数差分方程，具有递推求解的特点，可以求解
系统的暂态解、稳态解以及系统的单位脉冲响应。求暂态解时，对于N阶差分方程要给定
N个初始条件；求系统的单位脉冲响应时，要令系统初始状态为零和输入信号为单位脉冲
序列。
下面通过例题说明按照差分方程求解系统输出的软件流程图。
【例9.2.1】 假设两个二阶网络的级联结构如图9.2.1所示。
数字信号处理(第五版) x(n) bow(n) b? y(n)
ai zbi a b
a? b a bs
图9.2.1 例题9.2.1图
从n=0开始加入x(n)信号，x(-1)=0,x(-2)=0,初始条件为：w(-1)=0,
w(-2)=0,y(-1)=0,y(-2)=0,a?、a?、ay、a、bo、b?、b?、b?、b?、b,均为已知参数。
要求设计求输出响应的软件流程图。
解 其差分方程为
w(n)=a?w(n-1)+a?w(n-2)+b?x(n)+b?x(n-1)+b?x(n-2)
y(n)=a,y(n-1)+a,y(n-2)+b,u(n)+b,u(n-1)+b?u(n-2)
其软件流程图如图9.2.2所示。
上面介绍了求解差分方程的软件流程图，仿真实验时用MATLAB语言求解最方便。
314
Created by ZhuangHeng
MATLAB语言的filter函数和 filtic 函数可以求解差分方程。我们知道，系统函数与差分方
程是等价的，系统函数的系数就是差分方程的系数。所以，根据系统函数的系数和初始条
件，调用 filter 函数和 filtic函数可以方便地求系统输出响应。下面是求系统输出响应的
MATLAB通用程序。
x(n),n=0,1,2,3,…,N-1 输入： a.aza,a,bo,b?,b?b?,b,bs
w(-D=0,w(-2)=0,(-1)=0,y(-2)=0,x(-1)=0,x(-2)=0
w(n)=aw(n-1)+a?w(n-2)+box(n)+b?x(n-1)+b?x(n-2)
y(n)=aw(n-1)+a(n-2)+b?w(n)+b?w(n-1)+bsw(n-2)
N
n=0
输出：y(n)
n=n+1
n>(N-1)?
Y
结束
图9.2.2 两个二阶网络的级联结构软件流程图
??用 filter和 filtic函数求系统输出响应的通用程序
B=[b0,bl,…,bM]:A=[aO,al,…,aN];??置H(z)的分子和分母多项式系数向量B和A
xn=input('x(n)='); ??入信号x(n),也可以直接赋值，或读取数据文件
??置初始条件 ys=[y(-1),y(-2),…,y(-N)];
xi=filtic(B.A,ys);??初始条件计算等效初始条件的输入序列xi,设x(n)为因果序列
??用filter求系统输出信号y(n),n≥0 yn=filter(B.A,xn,xi);
【例9.2.2】 设系统函数H(z)=1/(1-bz?1),x(n)=a"u(n),求系统输出响应。
解 对于给定的H(z),分子、分母多项式系数B=1、A=[1,-b]。
求系统输出的程序ep922.m如下：
?922m:例9.2.2调用 filter 函数和 filtic 函数求系统输出响应
b=input('b=);
a=input('a=');
??入差分方程系数b
??入信号x(n)的参数a
B=1;A=[1,-b]:
n=0:31;xn=a.n;
ys=input('ys=');
xi0=filtic(B,A,ys)
yn=filter(B.A,xn,xi0);
?z)的分子、分母多项式系数B、A
??算产生输入信号x(n)的32个样值
??出初始条件y(-1)
??初始条件计算等效初始条件的输入序列xi
??用 filter解差分方程，求系统输出信号y(n)
subplot(3,2,1);stem(n,yn,'.);title('(a)b=0.8,a=0.8,y(-1)=2)
第9章数字信号上理的实现
315
Created by ZhuangHeng
口
口口
口
口口
口口
0口
■口
数字信号处理(第五版)
xlabel('n');ylabel('y(n));axis([0,32,min(yn),max(yn)+0.5])
运行程序，并输入不同的参数b和a以及初始条件，得到系统不同的输出y(n)波形。
如果b=0.8,a=0.8,y(-1)=2,输出响应如图9.2.3(a)所示。如果令初始状态为y(-1)=
0,b=0.8,a=1,得到的是系统的零状态响应，如图9.2.3(c)所示。如果令x(n)=u(n),b=
0.8,y(-1)=2,得到的系统响应如图9.2.3(b)所示。如果x(n)=u(n),b=-0.8,
y(-1)=0,得到的系统响应如图9.2.3(d)所示。
3
4
y(n) 2
y(n)
1
2
0 o
0 10 20 30 0 10 20 30 n n
(a)b=0.8,a=0.8,y(-1)=2 (b)b=0.8,a=1.y(-1)=2
1.5
4
1
y(n) 会 2 0.5
0 oL
0 10 20 30 0 10 20 30 n n
(c)b=0.8,a=1.y(-1)=0 (d)b=-0.8,a-1,y(-1)-0
图9.2.3 例题9.2.2系统输出响应
以上求系统输出响应的方法，并没有涉及网络结构的问题，下面我们介绍按照网络结
构编写程序的方法。
首先将信号流图的节点进行排序，延时支路输出节点变量是其输入节点变量前一时刻
已存储的数据，起始时，作为已知值(初始条件),网络输入是已知数值，这样延时支路输出
节点以及网络输入节点排序k=0,网络中可以由k=0节点变量计算出的节点排序k=1,
然后由k=0,1,可以计算出的节点排序k=2,…,依照这样的规律进行节点排序，直到将
全部节点排完。最后按照k从小到大写出运算次序。
图9.2.4(a)的二阶网络排序如图9.2.4(b)所示，图中圆圈中的数字表示排序。其运算
次序如下：
起始数据：v?=0,v?=0
a{-aA+a
(2)v?=x(n)+v?
(3)v?=v
316
Created by ZhuangHeng
x(n)
◎ Vs②
V%③
b? y(n)
④ ⑤
x(n) b? y(n)
ai b
b? a?
①
a
◎
b?
V] z
①
V
a? ◎ b?
(a) (b)
图9.2.4 二阶网络的节点排序
(4)v?=b?v?+v
(5)y(n)=v?
(6)数据更新：v?=v?,v?=v?
循环执行以上步骤，可完成网络运算。也可以进行简化：(2)、(3)合成一步，(4)、(5)合成
一步。软件流程图如图9.2.5所示。这种编写程序的方法的特点是充分考虑了不同结构的
特点；只要知道网络结构，不需要写出差分方程，就可编写程序；运算操作的基本公式为
v=cx+dy。对于图9.2.1两个二阶网络级联结构，节点排序如图9.2.6所示，其软件流程
图如图9.2.7所示。上述软件实现思想适合各种不同的编程语言，如C语言、汇编语
言等。
输入：x(n),n=0,1,2,3,…N
a,az,bo,b?,b?
?=0,v?=0
n=0
v=av?+avz,v?=b+b?p
v?=x(n)+v?
y(n)=b?v+v,输出y(n) 第9章数字信号处理的实现 =v,=v
n=n+1
N
n>N?
Y
结束
图9.2.5 图9.2.4软件流程
317 Created by ZhuangHeng
口
□
口
口
口
口
口
口口
口
数字信号处理(第五版)
x(n) ◎ ②
6③
bo ④
V12⑤
V1 b? ⑥ ⑦
yn)
⑧
z1 v14
①
a
◎I
b? ①
4
①
V10
a
O
ba
VSJ
①
Tvir z1
a? ◎2
b? a ◎v
bs
图9.2.6 图9.2.1的节点排序
输入：x(n),n=0,1,2,3,….N
aj,a2,aj,aa,bo.bj,b?,b,babs
v?=0,v?=0,v=0,v=0
v3=aivi+ajO2,v?=bivi+b?O2 vno=aps+aay,vn=ba+bgh
v2=v,V?=V6,vg=vs,U8=I3
N
n=0
T?=x(n)+v
v?=bov?+v4
vn=v7+vio
y(n)=byszns+vn
输出：y(n)
n=n+1
n>N?
y
结束
图9.2.7 图9.2.6的软件流程图
9.3 数字信号处理的硬件实现简介
如前所述，数字信号处理可分为软件实现与硬件实现。但实质上这两种实现方法是不
能截然分开的。因为所谓的软件实现，需要硬件支持才能运行，而硬件实现一般也离不开
软件。最流行的通用数字信号处理单片机，通常又称为通用数字信号处理器(DSP)就是这
种软、硬结合的实现方式，但习惯上将其划为硬件实现。
数字信号处理的硬件实现又可分为专用硬件实现和数字信号处理器实现。前者属于硬
318
Created by ZhuangHeng
件实现，后者称为软硬结合实现。
所谓硬件实现，就是根据数字滤波器的数学模型和算法，设计专用数字信号处理电路
(集成电路),使计算程序全部硬件化。专用处理器中的硬件电路包括加法器、乘法器、存储
器、控制器和输入/输出接口等。例如按照第5章介绍的直接型、级联型、并联型或FFT实
现方案，用FPGA设计实现电路。硬件实现的优点是处理速度高，但灵活性差，开发周期
长。因为硬件电路一旦做好就不易改变(如滤波器阶数和结构类型等)。
所谓软硬结合实现，就是用通用数字信号处理器(DSP)实现信号处理系统。DSP实质
上是一种适用于数字信号处理的单片微处理器，其主要特点是灵活性大，适应性强，具有
可编程功能，且处理速度高(DSP的指令周期已达到ns级)。例如TI公司的TMS320系列
DSP就是应用广泛的通用数字信号处理器的典型产品。例如，数字滤波器的DSP实现，就
是设计 DSP硬件电路，充分利用DSP的软硬件资源，开发并优化程序，实现数据采集、滤
波器单位脉冲响应h(n)与所采集的数字信号x(n)的快速卷积运算、输出滤波结果。
实际中选用何种实现方法，要视具体要求而定。例如，数字通信中的信道均衡器和雷
达信号处理中，对信号处理要求有限且具体，但要求实时性好，因而可采用专用硬件。在信
号处理算法复杂，处理种类繁多，并要求有智能化控制功能的系统中最好选用DSP实现方
法，以便简化开发过程，缩短开发周期。例如软件无线电和认知无线电系统。
自从1980年以来，DSP技术引发了现代电子系统设计的革命。在当今数字化时代，
DSP已经成为信号处理、通信、雷达、计算机和消费类电子产品等领域的基础器件。DSP
芯片不同于通用单片微计算机，DSP是一种对数字信号进行高速实时处理的专用单片处理
器，其处理速度比最快的CPU还快10～50倍。这主要是因为DSP芯片内包含硬件并行乘
法器和并行ALU,并采用流水线高速操作。随着集成电路技术的发展，以及精简指令系统
计算机(RISC)结构的出现，DSP的处理速度不断提高。DSP的字长和处理精度也在不断提
高，从最初的8位已经发展到32位。以美国德州仪器(TD公司为例，其产品有定点DSP和
浮点DSP,字长有8位、16位、32位和64位，DSP时钟速率高达1 GHz以上。例如，
TMS320C64x具有64位数据并行读写端口，内核有6个并行32位ALU和2个并行32位
硬件乘法器。所以，DSP技术成为数字信号处理的核心技术。
很多信号处理功能过去在普通微处理器中是用微码实现的，而现在大多是基于高速DSP
硬件实现。DSP技术最主要的贡献是其可编程装置的可塑性，它兼顾了软硬件实现的优点，
可以实现复杂的线性和非线性算法，同时可以跳转到程序的不同部分。所以，相对于基于数字
逻辑电路的专用硬件实现，基于高速DSP的硬件实现开发容易，且开发周期短，更加经济高
效。随着各种新的DSP设计开发平台的出现，DSP实现系统的开发将更加容易。
第9章数字信号处理的实现
随着多媒体通信、图像传输与处理、宽带无线接入等领域的高速发展，对信号处理速
度的要求不断提高，DSP实现的速度也不能满足要求。另外，随着超大规模集成电路和可
编程器件的发展，专用硬件实现方法应用越来越广泛。如卫星图像数据实时压缩编码器一
般采用硬件实现。
另外，MATLAB的Simulink 系统仿真组件用来仿真线性系统、非线性系统、连续系
319
Created by ZhuangHeng
口
口口
口口
品
口
数字信号处理(第五版)
统、离散系统、连续与离散混合系统、多采样率系统等。还利用MATLAB DSP模块库提供
的关键DSP算法模块能快速高效地进行复杂 DSP系统原理设计与仿真，与RTW
(Real-Time Workshop)配合使用可以为实时DSP硬件生成优化的ANSIC(美国国家标准C
语言)代码，或把定点DSP程序编译成能在嵌入式系统中执行的C代码。这些也是DSP实
现的现代辅助工具，从事DSP工作的技术人员常常用到它。
由上述可见，不论是基于高速DSP的软硬结合实现，还是专用硬件实现技术，都涉及
很多知识和技术，不可能用一节或一章讲清楚，更不可能使读者理解、掌握并学会使用。例
如，基于高速DSP的实现所涉及的内容有DSP软硬件原理与应用技术、DSP开发平台技
术，工程实现过程包括硬件电路设计与处理程序开发等。这些内容专业性很强，都必须经
过系统学习和工程实践才能掌握。所以，信号处理工程师必须熟悉DSP的硬件结构、指令
系统、软件开发平台、开发方法与开发过程。
但是，只要掌握了数字信号处理的基本原理，再学习其各种实现技术就比较容易。所
以本书仅介绍数字信号处理硬件实现的基本概念和基本方法，以便读者建立数字信号处理
的完整概念。
320
Created by ZhuangHeng
第10章
上机实验
数字信号处理是一门理论和实际密切结合的课程。为了深入掌握课程内容，应在学习
理论的同时，认真做习题和上机实验。上机实验不仅可以帮助读者深入理解和消化基本理
论，而且能锻炼初学者独立解决问题的能力。本章包括六个实验，前五个实验属基础理论
实验，第六个属综合应用实验。实验名称如下：
实验一：系统响应及系统稳定性
实验二：时域采样与频域采样
实验三：用FFT对信号作频谱分析
实验四：IIR数字滤波器设计及软件实现
实验五：FIR数字滤波器设计与软件实现
实验六：综合实验——数字信号处理在双音多频拨号系统中的应用
任课教师可根据教学进度，安排学生上机进行实验。建议自学的读者在学习完第1章
后做实验一；在学习完第3、4章后做实验二和实验三；实验四在学习完第6章后进行；实
验五在学习完第7章后进行；实验六在学习完本课程后再进行。
10.1 实验一：系统响应及系统稳定性
1.实验目的
(1)掌握求系统响应的方法。
(2)掌握时域离散系统的时域特性。
第口章上机实验
321
Created by ZhuangHeng
口口
数字信号处理(第五版)
(3)分析、观察及检验系统的稳定性。
2.实验原理与方法
在时域中，描写系统特性的方法是差分方程和单位脉冲响应，在频域可以用系统函数
描述系统特性。已知输入信号，可以由差分方程、单位脉冲响应或系统函数求出系统对于
该输入信号的响应，本实验仅在时域求解。在计算机上适合用递推法求差分方程的解，最
简单的方法是采用MATLAB语言的工具箱函数 filter 函数。也可以用MATLAB语言的工
具箱函数conv函数计算输入信号和系统的单位脉冲响应的线性卷积，求出系统的响应。
系统的时域特性指的是系统的线性时不变性质、因果性和稳定性。重点分析系统的稳
定性，包括观察系统的暂态响应和稳态响应。
系统的稳定性是指对任意有界的输入信号，系统都能得到有界的系统响应。或者系统
的单位脉冲响应满足绝对可和的条件。系统的稳定性由其差分方程的系数决定。
实际中检查系统是否稳定，不可能检查系统对所有有界的输人信号，输出是否都是有
界输出，或者检查系统的单位脉冲响应满足绝对可和的条件。可行的方法是在系统的输入
端加入单位阶跃序列，如果系统的输出趋近一个常数(包括零),就可以断定系统是稳定
的。系统的稳态输出是指当n→∞时系统的输出。如果系统稳定，信号加入系统后，系统
输出的开始一段称为暂态响应，随n的加大，幅度趋于稳定，达到稳态输出。
注意：在以下实验中均假设系统的初始状态为零。
3.实验内容及步骤
(1)编制程序，包括产生输入信号、单位脉冲响应序列的子程序，以及用 filter 函数或
conv 函数求解系统输出响应的主程序。程序中要有绘制信号波形的功能。
(2)给定一个低通滤波器的差分方程为
y(n)=0.05x(n)+0.05x(n-1)+0.9y(n-1)
输入信号
z?(n)=R?(n),x?(n)=u(n)
①分别求出x?(n)=R?(n)和x?(n)=u(n)的系统响应，并画出其波形。
②求出系统的单位脉冲响应，画出其波形。
(3)给定系统的单位脉冲响应为
h?(n)=R?(n)
h?(n)=6(n)+2.58(n-1)+2.58(n-2)+δ(n-3)
用线性卷积法求x?(n)=R(n)分别对系统h?(n)和h?(n)的输出响应，并画出波形。
(4)给定一谐振器的差分方程为
y(n)=1.8237y(n-1)-0.9801y(n-2)+b?x(n)-b?x(n-2)
令b?=1/100.49,谐振器的谐振频率为0.4 rad.
①用实验方法检查系统是否稳定。输入信号为u(n)时，画出系统输出波形。
②给定输入信号为
x(n)=sin(0.014n)+sin(0.4n)
322
Created by ZhuangHeng
求出系统的输出响应，并画出其波形。
4.思考题
(1)如果输入信号为无限长序列，系统的单位脉冲响应是有限长序列，可否用线性卷
积法求系统的响应?如何求?
(2)如果信号经过低通滤波器，把信号的高频分量滤掉，时域信号会有何变化?用实验
内容(2)的①的结果进行分析说明。
5.实验报告要求
(1)简述在时域求系统响应的方法。
(2)简述通过实验判断系统稳定性的方法。分析实验内容(4)的①的稳定输出的波形。
(3)对各实验所得结果进行简单分析和解释。
(4)简要回答思考题。
(5)打印程序清单和要求的各信号波形。
10.2 实验二：时域采样与频域采样
1.实验目的
时域采样理论与频域采样理论是数字信号处理中的重要理论。要求掌握模拟信号
采样前后频谱的变化，以及如何选择采样频率才能使采样后的信号不丢失信息；要求
掌握频域采样会引起时域周期化的概念，以及频域采样定理及其对频域采样点数选择
的指导作用。
2.实验原理与方法
时域采样定理的要点是：
①对模拟信号x,(t)以T进行时域等间隔理想采样，形成的采样信号的频谱X(j2)是
原模拟信号频谱X,(j2)以采样角频率Ω,(Ω,=2π/T)为周期进行周期延拓。公式为
x,(j2)=FT[a。(2]=÷∑x,(in-jn.)
②采样频率Ω,必须大于等于模拟信号最高频率的两倍以上，才能使采样信号的频谱
不产生频谱混叠。
利用计算机计算上式并不方便，下面我们导出另外一个公式，以便在计算机上进行
实验。
理想采样信号x(t)和模拟信号x,(t)之间的关系为
.()=z.(2)∑8a-nT)
第1章上机实验
对上式进行傅里叶变换，得到：
323
Created by ZhuangHeng
数字信号处理(第五版)
X,Gin)=厂[z.②∑8(t-nT)]ed
-2x()80-nT)ed
在上式的积分号内只有当t=nT时，才有非零值，因此：
X.Gin)=∑z.(nT)e
上式中，在数值上x,(nT)=x(n),再将w=ΩT代入，得到：
X.jin)=∑z(n)e
上式的右边就是序列的傅里叶变换X(e"),即
X,(j2)=X(e")|-r
上式说明采样信号的傅里叶变换可用相应序列的傅里叶变换得到，只要将自变量w用ΩT
代替即可。
频域采样定理的要点是：
①对信号x(n)的频谱函数X(e")在[0,2π]上等间隔采样N点，得到：
XN(k)=X(e")L梦 k=0,1,2,…,N-1
则N点IDFT[XN(k)]得到的序列就是原序列x(n)以N为周期进行周期延拓后的主值区
序列，公式为
zN(n)=IDFT[Xa(k)]x=[2z(n+iN)]Rn(n
②由上式可知，频域采样点数N必须大于等于时域离散信号的长度M(即N≥M),才
能使时域不产生混叠，则N点IDFT[X(k)]得到的序列xx(n)就是原序列x(n),
即xn(n)=x(n)。如果N>M,xx(n)比原序列尾部多N-M个零点；如果N<M,则
xn(n)=IDFT[XN(k)]发生了时域混叠失真，而且xx(n)的长度N也比x(n)的长度M短，
因此，x(n)与x(n)不相同。
在数字信号处理的应用中，只要涉及时域或者频域采样，都必须服从这两个采样理论
的要点。
对比上面叙述的时域采样原理和频域采样原理，得到一个有用的结论：这两个采样理
论具有对偶性，即“时域采样频谱周期延拓，频域采样时域信号周期延拓”。因此，将它们放
在一起进行实验。
3.实验内容及步骤
(1)时域采样理论的验证。给定模拟信号
x,(t)=Ae "sin(Ωt)u(t)
式中，A=444.128,a=50√2π,Ω=50√2π rad/s,它的幅频特性曲线如图10.2.1所示。
现用DFT(FFT)求该模拟信号的幅频特性，以验证时域采样理论。
324
Created by ZhuangHeng
1
0.8
1x6/) 0.6
0.4
0.2
0
0 100 200 300 400 500
f/Hz
图10.2.1 x,(1)的幅频特性曲线
按照x,(t)的幅频特性曲线，选取三种采样频率，即F,=1kHz,300 Hz,200 Hz。观
测时间选T,=64 ms。
为使用DFT,首先用下面的公式产生时域离散信号，对三种采样频率、采样序列按顺
序用x?(n)、x?(n)、x?(n)表示。
x(n)=x(nT)=Aesin(ΩnT)u(nT)
因为采样频率不同，得到的x?(n)、x?(n)、x?(n)的长度不同，长度(点数)用公式N=
T。×F,计算。选FFT的变换点数为M=64,序列长度不够64的尾部加零。
X(k)=FFT[x(n)]k=0,1,2,3,…,M-1
式中，k代表的频率为
=2
要求：编写实验程序，计算x?(n)、x?(n)和x?(n)的幅度特性，并绘图显示。观察分析
频谱混叠失真。
(2)频域采样理论的验证。给定信号如下： 第1章上机实验 编写程序分别对频谱函数X(e")=FT[x(n)]在区间[0,2π]上等间隔采样 32点和16点，
得到X??(k)和X??(k):
Xa(k)=X(e)一建 k=0,1,2,….31
X??(k)=X(e")L- k=0,1,2,…,15
再分别对X(k)和X?(k)进行32点和16点IFFT,得到x(n)和x??(n):
x(n)=IFFT[X(k)]n=0,1,2,…,31
x??(n)=IFFT[X?(k)]?n=0,1,2,…,15
分别画出X(e")、X(k)和X??(k)的幅度谱，并绘图显示 x(n)、xn(n)和x??(n)的波形，
进行对比和分析，验证总结频域采样理论。
提示：频域采样用以下方法容易编程实现。
(1)直接调用MATLAB函数fft计算X??(k)=FFT[x(n)]2就得到X(e")在[0,2π]
325
Created by ZhuangHeng
数字信号处理(第五版)
的32点频率域采样X??(k)。
(2)抽取X(k)的偶数点即可得到X(e”)在[0,2π]的16点频率域采样X?(k),即
X??(k)=X?2(2k),k=0,1,2,…,15。
(3)当然，也可以按照频域采样理论，先将信号r(n)以16为周期进行周期延拓，取其
主值区(16点),再对其进行16点DFT(FFT),得到的就是X(e")在[0,2π]上的16点频率
域采样X??(k)。
4.思考题
如果序列x(n)的长度为M,希望得到其频谱X(e")在[0,2π]上的N点等间隔采样，
当N<M时，如何用一次最少点数的DFT得到该频谱采样?
5.实验报告及要求
(1)运行程序，打印要求显示的图形。
(2)分析比较实验结果，简述由实验得到的主要结论。
(3)简要回答思考题。
(4)附上程序清单和有关曲线。
10.3 实验三：用FFT 对信号作频谱分析
1.实验目的
学习用FFT对连续信号和时域离散信号进行谱分析的方法，了解可能出现的分析误差
及其原因，以便正确应用FFT。
2.实验原理
用FFT对信号作频谱分析是学习数字信号处理的重要内容。经常需要进行谱分析的信
号是模拟信号和时域离散信号。对信号进行谱分析的重要问题是频谱分辨率D和分析误
差。频谱分辨率直接和FFT的变换区间N有关，因为FFT能够实现的频率分辨率是
2π/N,因此要求2π/N≤D。可以根据此式选择FFT的变换区间N。误差主要来自用FFT
作频谱分析时，得到的是离散谱，而信号(周期信号除外)是连续谱，只有当N较大时，离
散谱的包络才能逼近于连续谱，因此N要适当选择大一些。
周期信号的频谱是离散谱，只有用整数倍周期的长度作FFT,得到的离散谱才能代表
周期信号的频谱。如果不知道信号周期，可以尽量选择信号的观察时间长一些。
对模拟信号进行谱分析时，首先要按照采样定理将其变成时域离散信号。如果是模拟
周期信号，也应该选取整数倍周期的长度，经过采样后形成周期序列，按照周期序列的谱
分析进行。
3.实验步骤及内容
(1)对以下序列进行谱分析：
326
Created by ZhuangHeng
x?(n)=R?(n)
-
选择FFT的变换区间N为8和16两种情况进行频谱分析。分别打印其幅频特性曲
线，并进行对比、分析和讨论。
(2)对以下周期序列进行谱分析：
z?(n)=cos4”
x?(n)=cosn+cos8”
选择FFT的变换区间N为8和16两种情况分别对以上序列进行频谱分析。分别打印
其幅频特性曲线，并进行对比、分析和讨论。
(3)对模拟周期信号进行谱分析：
x?(t)=cos8πt+cos16πt+cos20πt
选择采样频率F,=64 Hz,对变换区间N=16,32,64三种情况进行谱分析。分别打印其幅
频特性，并进行分析和讨论。
4.思考题
(1)对于周期序列，如果周期不知道，如何用FFT进行谱分析?
(2)如何选择FFT的变换区间?(包括非周期信号和周期信号)
(3)当N=8时，x?(n)和x(n)的幅频特性会相同吗?为什么?N=16呢?
5.实验报告要求
(1)完成各个实验任务和要求，附上程序清单和有关曲线。
第1章上机实验
(2)简要回答思考题。
10.4 实验四：IIR数字滤波器设计及软件实现
1.实验目的
(1)熟悉用双线性变换法设计IIR 数字滤波器的原理与方法；
(2)学会调用MATLAB信号处理工具箱中滤波器设计函数(或滤波器设计分析工具
FDATool)设计各种IIR 数字滤波器，学会根据滤波需求确定滤波器指标参数。
(3)掌握IIR数字滤波器的MATLAB实现方法。
(4)通过观察滤波器输入、输出信号的时域波形及其频谱，建立数字滤波的概念。
327
Created by ZhuangHeng
口
口口
口
数字信号处理(第五版)
2.实验原理
设计IIR数字滤波器一般采用间接法(脉冲响应不变法和双线性变换法),应用最广泛
的是双线性变换法。基本设计过程是：①将给定的数字滤波器的指标转换成过渡模拟滤波
器的指标；②设计过渡模拟滤波器；③将过渡模拟滤波器系统函数转换成数字滤波器的系
统函数。MATLAB信号处理工具箱中的各种IIR 数字滤波器设计函数都是采用双线性变
换法。第6章介绍的滤波器设计函数butter、cheby1 、cheby2和ellip可以分别被调用来直
接设计巴特沃斯、切比雪夫1、切比雪夫2以及椭圆模拟与数字滤波器。本实验要求读者调
用如上函数直接设计IIR 数字滤波器。
本实验的数字滤波器的MATLAB实现是指调用MATLAB信号处理工具箱函数 filter
对给定的输入信号x(n)进行滤波，得到滤波后的输出信号y(n)。
3.实验内容及步骤
(1)调用信号产生函数mstg产生由三路抑制载波调幅信号相加构成的复合信号st,该
函数还会自动绘图显示st的时域波形和幅频特性曲线，如图10.4.1所示。由图可见，三路
信号时域混叠无法在时域分离。但频域是分离的，所以可以通过滤波的方法在频域分离，
这就是本实验的目的。
3
2
会 0
1
-1
0 0.002 0.004 0.006 0.008 0.01 0.012 0.014 0.016 0.018 0.02
Vs
(a)s(t)的波形
1
幅度 0.5
0L0 200 400 600 800 1000 1200 1400 1600 1800 2000
fHz
(b)s(t)的频谱
图10.4.1 三路调幅信号st(即s(t))的时域波形和幅频特性曲线
(2)要求将st中三路调幅信号分离，通过观察st的幅频特性曲线，分别确定可以分离
st 中三路抑制载波单频调幅信号的三个滤波器(低通滤波器、带通滤波器、高通滤波器)
的通带截止频率和阻带截止频率。要求滤波器的通带最大衰减为0.1 dB,阻带最小衰减为
60 dB。
提示：抑制载波单频调幅信号的数学表示式为
s(1)=cos(2nfat)cos(2mf1)=2[cos(2π(f.-fo)2)+cos(2π(f。+fo)2)]
其中，cos(2πf,t)称为载波，f。为载波频率，cos(2πf,t)称为单频调制信号，f。为调制正弦
328
Created by ZhuangHeng
波信号频率，且满足f>f。由上式可见，所谓抑制载波单频调幅信号，就是两个正弦信
号相乘，它有2个频率成分：和频f。+f。、差频f。-f。,这两个频率成分关于载波频率f。
对称。所以，1路抑制载波单频调幅信号的频谱图是关于载波频率f。对称的两根谱线。容
易看出，图10.4.1中三路调幅信号的载波频率分别为250 Hz、500 Hz、1000 Hz。有关调
幅(AM)和抑制载波调幅(SCAM)的一般原理与概念，请参考通信原理教材。
(3)编程序调用MATLAB滤波器设计函数ellipord和ellip分别设计这三个椭圆滤波
器，并绘图显示其损耗函数曲线。
(4)调用滤波器实现函数 filter,用三个滤波器分别对信号产生函数mstg产生的信号
st进行滤波，分离出st中的三路不同载波频率的调幅信号y?(n)、y?(n)和y,(n),并绘图
显示 y?(n)、y:(n)和y?(n)的时域波形，观察分离效果。
4.信号产生函数mstg清单
function st=mstg
??生信号序列向量st,并显示st的时域波形和幅频曲线
t=mstg 返回三路调幅信号相加形成的混合信号，长度N=800
N=800 为信号st的长度
Fs=10000;T=1/Fs;Tp=N+T:??样频率Fs=10kHz,Tp为采样时间
t=0:T:(N-1)*T;k=0:N-1;f=k/Tp;
fel=Fs/10; ??1路调幅信号的载波频率fel=1000 Hz
??1路调幅信号的调制信号频率fml=100 Hz fmI=fel/10;
??2路调幅信号的载波频率fe2=500 Hz fe2=Fs/20;
??2路调幅信号的调制信号频率fm2=50 Hz fm2=fe2/10;
??3路调幅信号的载波频率fe3=250 Hz fe3=Fs/40;
??3路调幅信号的调制信号频率fm3=25 Hz fm3=fe3/10;
??生第1路调幅信号 xtl=cos(2*pi*fml*t)。*cos(2*pi*fel*1);
??生第2路调幅信号 xt2=cos(2*pi*fm2*t)。*cos(2*pi*fe2*t);
??生第3路调幅信号 xt3=cos(2*pi*fm3*t),cos(2*pi*fe3*t);
??路调幅信号相加 st=xt1+xt2+xt3;
??算信号st的频谱 fxt=fft(st,N);
?==以下为绘图部分，绘制st的时域波形和幅频特性曲线======
第0章上机实验
subplot(3,1.1)
plot(t,st):grid;xlabelC't/s'):ylabel('s(t)');
axis([0.Tp/8,min(st),max(st)]);title('ca)s(t)的波形)
subplot(3.1,2)
stem(f,abs(fxt)/max(abs(fxt)),.):grid;title('(b)s(t)的频谱’)
axis([0,Fs/5,0,1.2]);
xlabelC't/Hz):ylabel('幅度)
5.实验程序框图
实验程序框图如图10.4.2所示，供读者参考。
329
Created by ZhuangHeng
口口
数字信号处理(第五版)
调用函数mstg产生st,自动绘图显示st
的时域波形和幅频特性曲线
调用ellipord和ellip分别设计三个椭圆滤
波器，并绘图显示其幅频响应特性曲线
调用filter,用三个滤波器分别对信号st进行滤波，分离
出三路不同载波频率的调幅信号yi(n)、y?(n)和y?(n)
绘图显示y:(n)、y?(n)和y?(n)的时域波形
结 束
图10.4.2 实验四程序框图
6.思考题
(1)请阅读信号产生函数mstg,确定三路调幅信号的载波频率和调制信号频率。
(2)信号产生函数mstg中采样点数N=1600,对st进行N点FFT可以得到6根理想
谱线。如果取N=1800,可否得到6根理想谱线?为什么?N=2000呢?请改变函数mstg
中采样点数N的值，观察频谱图验证您的判断是否正确。
(3)修改信号产生函数mstg,给每路调幅信号加入载波成分，产生调幅(AM)信号，重
复本实验，观察AM信号与抑制载波调幅信号的时域波形及其频谱的差别。
提示：AM信号表示式：
s(t)=[A+Acos(2πft)]cos(2πft) A≥Am
7.实验报告要求
(1)简述实验目的及原理。
(2)画出实验主程序框图，打印程序清单。
(3)绘制三个分离滤波器的损耗函数曲线。
(4)绘制经过滤波分离出的三路抑制载波调幅信号的时域波形。
(5)简要回答思考题。
10.5 实验五：FIR数字滤波器设计与软件实现
1.实验目的
(1)掌握用窗函数法设计FIR数字滤波器的原理和方法。
330
Created by ZhuangHeng
(2)掌握用等波纹最佳逼近法设计FIR数字滤波器的原理和方法。
(3)掌握FIR滤波器的快速卷积实现原理。
(4)学会调用MATLAB函数设计与实现FIR滤波器。
2.实验内容及步骤
(1)认真复习第7章中用窗函数法和等波纹最佳逼近法设计FIR数字滤波器的原理；
(2)调用信号产生函数xtg产生具有加性噪声的信号xt,并自动显示xt及其频谱，如
图10.5.1所示。
10
0
-100 0.05 0.1 0.15 0.2 0.25
t/s
(a)信号加噪声波形
1
幅度 0.5
0.0 50 100 150 200 250 300 350 400 450 500
fHz
(b)信号加噪声的频谱
图10.5.1 具有加性噪声的信号xt(即x(t)及其频谱图
(3)请设计低通滤波器，从高频噪声中提取xt中的单频抑制载波调幅信号，要求信号
幅频失真小于0.1 dB,将噪声频谱衰减60 dB。观察xt的频谱，确定滤波器指标参数。
(4)根据滤波器指标选择合适的窗函数，计算窗函数的长度N,调用MATLAB函数
firl设计一个FIR低通滤波器。并编写程序，调用MATLAB快速卷积函数fftfilt实现对xt
的滤波。绘图显示滤波器的频响特性曲线、滤波器输出信号的幅频特性图和时域波形图。
(5)重复(3),滤波器指标不变，但改用等波纹最佳逼近法设计FIR 滤波器，调用
MATLAB函数 remezord和 remez设计FIR数字滤波器。比较两种设计方法设计的滤波器
阶数。
提示：
①MATLAB函数firl和fftfilt的功能及其调用格式请查阅本书7.2.4节和3.4.1节；
②采样频率Fs=1000 Hz,采样周期T=1/Fs;
③根据图10.5.1(b)和实验要求，可选择滤波器指标参数：通带截止频率f,=120 Hz,阻
带截止频率f,=150 Hz,换算成数字频率，通带截止频率w,=2πf,T=0.24π,通带最大衰
为0.1dB,阻带截止频率w.=2πf.T=0.3π,阻带最小衰为60 dB。
3.实验程序框图
实验程序框图如图10.5.2所示，供读者参考。
第1章
上机实验
331
Created by ZhuangHeng
口
口
口口
■
口口
口
口
■■■ ■
口
数字信号处理(第五版)
Fs=1000,T=1/Fs
xt=xtg
产生信号xt,并显示xt及其频谱
用窗函数法或等波纹最佳逼近法设
计FIR滤波器hn
对信号xt滤波：yt=ffilt(hn,xt)
1.计算并绘图显示滤波器损耗函数
2.绘图显示滤波器输出信号yt及其频谱
结 束
图10.5.2 实验五程序框图
4.思考题
(1)如果给定通带截止频率和阻带截止频率以及阻带最小衰减，如何用窗函数法设计
线性相位低通滤波器?请写出设计步骤。
(2)如果要求用窗函数法设计带通滤波器，且给定通带上、下截止频率为wg和wm,阻
带上、下截止频率为w和w,试求理想带通滤波器的截止频率w和w
(3)解释为什么对同样的技术指标，用等波纹最佳逼近法设计的滤波器阶数低。
5.实验报告要求
(1)对两种设计FIR滤波器的方法(窗函数法和等波纹最佳逼近法)进行分析比较，简
述其优缺点。
(2)附程序清单，打印实验内容要求绘图显示的曲线图。
(3)分析总结实验结果。
(4)简要回答思考题。
6.信号产生函数xtg程序清单
function xt=xtg
??验五信号x(t)产生函数，并显示信号的时域波形和幅频特性曲线
?=xtg产生一个长度为N,有加性高频噪声的单频调幅信号xt,N=1000,
??样频率Fs=1000 Hz
??波频率fc=Fs/10=100Hz,调制正弦波频率f0=fe/10=10 Hz
N=1000;Fs=1000:T=1/Fs;Tp=N*T;
t=0:T:(N-1)*T;
332
Created by ZhuangHeng
??波频率fe=Fs/10,单频调制信号频率为f0=Fe/10 fc=Fs/10;f0=fe/10:
??生单频正弦波调制信号mt,频率为f0 mt=cos(2*pi*f0*1):
??生载波正弦波信号ct,频率为fe ct=cos(2*pi*fe*t);
??乘产生单频调幅信号xt xt=mt.*ct;
nt=2*rand(1,N)-1; ??生随机噪声nt
?===设计高通滤波器 hn,用于滤除噪声nt中的低频成分，生成高通噪声====
fp=150;fs=200;Rp=0.1;As=70:??波器指标
??算remezord 函数所需参数f,m,dev fb=[fp,fs];m=[0,1];
dev=[10(-As/20),(10-(Rp/20)-1)/(10-(Rp/20)+1];
[n,fo,mo,W]=remezord(fb,m,dev,Fs);??定 remez函数所需参数
hn=remez(n,fo,mo,W); ??用 remez函数进行设计，用于滤除噪声nt中的低频成分
yt=filter(hn,1,10*nt); ??除随机噪声中低频成分，生成高通噪声yt
?=========以下为绘图部分===========:
xt=xt+yt;?声加信号
fst=fft(xt,N);k=0:N-1;f=k/Tp;
subplot(3,1,1);plot(t,xt):grid;xlabel('t/s');ylabel('x(t));
axis([0,Tp/5,min(xt),max(xt)]);title('(a)信号加噪声波形′)
subplot(3,1,2);plot(f,abs(fst)/max(abs(fst)));grid;title('(b)信号加噪声的频谱′)
axis([0,Fs/2,0,1.2]);xlabelCt/Hz');ylabelC'幅度')
10.6 实验六：数字信号处理在双音多频拨号系统中的应用
1.引言
双音多频(Dual Tone Multi Frequency,DTMF)信号是音频电话中的拨号信号，由美
国AT8.T贝尔公司实验室研制，并用于电话网络中。这种信号制式具有很高的拨号速
度，且容易自动监测识别，很快就代替了原有的用脉冲计数方式的拨号制式。这种双音多
频信号制式不仅用在电话网络中，还可以用于传输十进制数据的其他通信系统中，如电子
邮件和银行系统中。这些系统中用户可以用电话发送DTMF 信号，选择语音菜单进行
操作。
第1章上机实验
DTMF信号系统是一个典型的小型信号处理系统，它用数字方法产生模拟信号并进行
传输，其中还用到了D/A变换器；在接收端用A/D变换器将其转换成数字信号，并进行数
字信号处理与识别。为了提高系统的检测速度并降低成本，还开发出一种特殊的DFT算
法，称为戈泽尔(Goertzel)算法，这种算法既可以用硬件(专用芯片)实现，也可以用软件实
现。下面首先介绍双音多频信号的产生方法和检测方法，包括戈泽尔算法，最后进行模拟
实验。下面先介绍电话中的DTMF 信号的组成。
在电话中，数字0～9的中每一个都用两个不同的单音频传输，所用的8个频率分成高
频带和低频带两组，低频带有四个频率：679 Hz,770 Hz,852 Hz和941 Hz;高频带也有
333
Created by ZhuangHeng
数字信号处理(第五版)
四个频率：1209 Hz,1336 Hz,1477 Hz和1633 Hz。每一个数字均由高、低频带中各一个
频率构成，例如1用697 Hz和1209 Hz两个频率，信号用sin(2πf?t)+sin(2πf?t)表示，其
中f?=679 Hz,f?=1209 Hz。这样8个频率形成16种不同的双频信号。具体号码以及符
号对应的频率如表10.6.1所示。表中最后一列在电话中暂时未用。
表10.6.1 双频拨号的频率分配
DTMF 信号在电话中有两种作用，一个是用拨号信号去控制交换机接通被叫的用户电
话机，另一个作用是控制电话机的各种动作，如播放留言、语音信箱等。
2.电话中的双音多频(DTMF)信号的产生与检测
1)双音多频信号的产生
假设时间连续的DTMF 信号用x(t)=sin(2πf?1)+sin(2πf?L)表示，式中f,和f?是
按照表10.6.1选择的两个频率，秀代表低频带中的一个频率，f。代表高频带中的一个频
率。显然采用数字方法产生DTMF信号，方便而且体积小。下面介绍采用数字方法产生
DTMF信号。规定用8kHz对DTMF信号进行采样，采样后得到时域离散信号为
列
行
1209 Hz 1336 Hz 1477 Hz 1633 Hz
697 Hz 1 2 3 A
770 Hz 4 5 6 B
852 Hz 7 8 9 C
941 Hz 0 井 D
x(n)=sin8000+sin28000
形成上面序列的方法有两种，即计算法和查表法。用计算法求正弦波的序列值容易，
但实际中要占用一些计算时间，影响运行速度。查表法是预先将正弦波的各序列值计算出
来，寄存在存储器中，运行时只要按顺序和一定的速度取出便可。这种方法要占用一定的
存储空间，但是速度快。
由于采样频率是8000 Hz,因此要求每125ms输出一个样本，得到的序列再送到D/A
变换器和平滑滤波器，输出便是连续时间的DTMF信号。DTMF信号通过电话线路送到交
换机。
2)双音多频信号的检测
在接收端，要对收到的双音多频信号进行检测，检测两个正弦波的频率是多少，以判
断所对应的十进制数字或者符号。显然，这里仍然要用数字方法进行检测，因此要将收到
的时间连续DTMF信号经过A/D变换，变成数字信号进行检测。检测的方法有两种，一
种是用一组滤波器提取所关心的频率，根据有输出信号的2个滤波器判断相应的数字或符
号；另一种是用DFT(FFT)对双音多频信号进行频谱分析，由信号的幅度谱判断信号的两
334
Created by ZhuangHeng
个频率，最后确定相应的数字或符号。当检测的音频数目较少时，用滤波器组实现更为合
适。FFT是DFT的快速算法，但当DFT的变换区间较小时，FFT快速算法的效果并不明
显，而且还要占用很多内存，因此不如直接用DFT合适。下面介绍Goertzel算法，这种算
法的实质是直接计算DFT的一种线性滤波方法。这里略去Goertzel算法的介绍(请参考文
献[19]),可以直接调用MATLAB信号处理工具箱中戈泽尔算法的函数Goertzel,计算N
点DFT的几个感兴趣的频点的值。
3.检测DTMF信号的DFT参数选择
用DFT检测模拟DTMF 信号所含有的两个音频频率，是一个用DFT对模拟信号进行
频谱分析的问题。根据第3章用DFT对模拟信号进行谱分析的理论，确定三个参数：①采
样频率F.;② DFT的变换点数N;③对信号的观察时间的长度T。这三个参数不能随意
选取，要根据对信号频谱分析的要求进行确定。这里对信号频谱分析也有三个要求：①频
率分辨率；②谱分析的频谱范围；③检测频率的准确性。
1)频谱分析的分辨率
观察要检测的8个频率，相邻间隔最小的是第一和第二个频率，间隔是73 Hz,要求
DFT最少能够分辨相隔73 Hz的两个频率，即要求 F=73 Hz。DFT的分辨率和对信号
的观察时间T。有关，Tm=1/F=1/73=13.7ms。考虑到可靠性，留有富余量，要求按
键的时间大于40 ms。
2)频谱分析的频率范围
要检测的信号频率范围是697~1633 Hz,但考虑到存在语音干扰，除了检测这8个频
率外，还要检测它们的二次倍频的幅度大小，波形正常且干扰小的正弦波的二次倍频是很
小的，如果发现二次谐波很大，则不能确定这是DTMF信号。这样，频谱分析的频率范围
为697～3266 Hz。按照采样定理，最高频率不能超过折叠频率，即0.5F,≥3622 Hz,由此
要求最小的采样频率应为7.24 kHz。因为数字电话总系统已经规定F,=8kHz,因此对频
谱分析范围的要求是一定满足的。按照Tm=13.7ms,F,=8kHz,算出对信号最少的采
样点数为Nmm=Tpmm·F,≈110。 第1章上机实验
3)检测频率的准确性
这是一个用DFT检测正弦波频率是否准确的问题。序列的N点DFT是对序列频谱函
数在0～2π区间的N点等间隔采样，如果是一个周期序列，截取周期序列的整数倍周期，
进行DFT,其采样点刚好在周期信号的频率上，DFT的幅度最大处就是信号的准确频率。
分析这些DTMF信号，不可能经过采样得到周期序列，因此存在检测频率的准确性问题。
DFT的频率采样点频率为w=2πk/N(k=0,1,2,…,N-1),相应的模拟域采样点
频率为f.=F,k/N(k=0,1,2,…,N-1),希望选择一个合适的N,使用该公式算出的
f,能接近要检测的频率，或者用8个频率中的任一个频率f代入公式f!=F,k/N中时，
得到的k值最接近整数值，这样虽然用幅度最大点检测的频率有误差，但可以准确判断所
对应的DTMF频率，即可以准确判断所对应的数字或符号。经过分析研究认为N=205是
最好的。按照F,=8kHz,N=205,算出8个基频及其二次谐波对应的k值以及k取整数
335
Created by ZhuangHeng
口口
口
口
口
口
口口
口口
口口
口
数字信号处理(第五版)
时的频率误差见表10.6.2。
表10.6.2 8个基频及其二次谐波对应的k值以及k取整数时的频率误差
通过以上分析，确定F.=8kHz,N=205,T,=25.625ms。键入数字时，按键时间大
于40ms。
8个基频
/Hz
最近的
整数k值
DFT的
k值
绝对误差 二次谐波
/Hz
对应的
k值
最近的
整数k值 绝对误差
697 17.861 18 0.139 1394 35.024 35 0.024
770 19.531 20 0.269 1540 38.692 39 0.308
852 21.833 22 0.167 1704 42.813 43 0.187
941 24.113 24 0.113 1882 47.285 47 0.285
1209 30.981 31 0.019 2418 60.752 61 0.248
1336 34,235 34 0.235 2672 67.134 67 0.134
1477 37.848 38 0.152 2954 74.219 74 0.219
1633 41.846 42 0.154 3266 82.058 82 0.058
4. DTMF信号的产生与识别仿真实验
下面先介绍MATLAB工具箱函数goertzel,然后介绍DTMF 信号的产生与识别仿真
实验程序。goerztel函数的调用格式为
Xgk=goertzel(xn,K)
其中，xn是被变换的时域序列，用于DTMF信号检测时，xn就是DTMF 信号的205个采
样值；K是要求计算的DFT[xn]的频点序号向量，用N表示xn的长度，则要求1≤K≤N。由
表10.2.2可知，如果只计算DTMF信号8个基频时，
K=[18,20,22,24,31,34,38,42]
如果同时计算8个基频及其二次谐波时，
K=[18,20,22,24,31,34,35,38,39,42,43,47,61,67,74,82]
Xgk是变换结果向量，其中存放的是由K指定的频率点的DFT[x(n)]的值。设X(K)=
DFT[x(n)],则Xgk(i)=X(K(i)),i=1,2,…,length(K)。
DTMF信号的产生与识别仿真实验在MATLAB环境下进行，编写仿真程序，运行程
序，送入6位电话号码，程序自动产生与每一位号码数字相应的DTMF信号，并送出双频
声音；再用DFT进行谱分析，显示每一位号码数字的DTMF信号的DFT幅度谱，按照幅
度谱的最大值确定对应的频率；接着按照频率确定每一位对应的号码数字；最后输出6位
电话号码。
本实验程序较复杂，所以将仿真程序提供给读者，只要求读者读懂程序，直接运行程
序仿真。程序名为exp6。程序分四段：第一段(2～7行)设置参数，并读入6位电话号码：
第二段(9~20行)根据键入的6位电话号码产生时域离散DTMF信号，并连续发出6位号
336
Created by ZhuangHeng
码对应的双音频声音；第三段(22~25行)对时域离散DTMF信号进行频率检测，画出幅度
谱；第四段(26～33行)根据幅度谱的两个峰值，分别查找并确定输入的6位电话号码。根
据程序中的注释很容易分析编程思想和处理算法。程序清单如下：

TMF双音多频拨号信号的生成和检测仿真程序：exp6.m
tm=[1,2,3,65;4,5,6,66;7,8,9,67;42,0,35,68];?MF信号代表的16个数
N=205;K=[18,20,22,24,31,34,38,42];个基频对应的8个k值
??频率向量 f1=[697,770,852,941];
?频率向量 [2=[1209,1336,1477,1633];
TN=input('键入6位电话号码=): ??入6位数字
??收端电话号码初值为零 TNr=0;
?别对每位号码数字处理：产生信号，发声，检测 for m=1:6;
d=fix(TN/10(6-m)): ??算出第m位号码数字
TN=TN-d+10-(6-m);
for p=1:4;
for q=1:4;
if tm(p,q)==abs(d);break,end 检测与第m位号码相符的列号q
end
if tm(p,q)==abs(d):break,end 检测与第m位号码相符的行号p
end
n=0:1023; ??了发声，加长序列
x=sin(2*pi*n*f1(p)/8000)+sin(2*pi*n*f2(q)/8000);??成双频信号
sound(x,8000); ?出声音
pause(0.1) ??邻号码响声之间加0.1秒停顿
??收检测端的程序
X=goertzel(x(1:N),K+1); ??Goertzel算法计算八点DFT样本
val=abs(X); ?出八点DFT的模
subplot(3,2,1);stem(K,val,'.):grid;xlabel('k);ylabelC'X(k)”
■
第1章上机实验
??出8点DFT的幅度
axis([10.50.0.120])
limit=80; ?频检测门限为80
for s=5:8;
if val(s)>limit,break,end ??找列号
end
for r=1:4:
if val(r)>limit,break,end??找行号
end
TNr=TNr+tm(r,s-4)*10(6-m);??6位电话号码表示成一个6位数，以便显示
end
disp('接收端检测到的号码为：)
337
Created by ZhuangHeng
口口
口口
a口
口
数字信号处理(第五版)
disp(TNr) ??示接收到的6位电话号码
运行程序，根据提示键入6位电话号码123456,回车后可以听见6位电话号码对应的
DTMF信号的声音，并输出相应的6幅频谱图如图10.6.1所示，左上角的第一个图在k=
18和k=31两点出现峰值，所以对应第一位号码数字1。最后显示检测到的电话号码
123456。
1)实验内容
(1)运行仿真程序exp6.m,任意送入6位电话号码，打印出相应的幅度谱。观察程序
运行结果，对照表10.6.1和表10.6.2,判断程序谱分析的正确性。
100 100
X(k) 50 x(k 50
0l
10 20 30 40 50 0
10
业 逆
20 30 40 50
k k
100 1
100
[X(k) 50 [X(k) 50
ol i 0
10 20 30 40 50 10 20 30 40 50
k k
100 100
X(k) 50 x(x) 50-
ol10 o
20 30 40 50 10 20 30 40 50
k k
图10.6.1 6位电话号码123456的DTMF信号在8个近似基频点的DFT幅度
(2)分析该仿真程序，将产生、检测和识别6位电话号码的程序改为能产生、检测和
识别8位的程序，并运行一次，打印出相应的幅度谱和8位电话号码。
2)实验报告
(1)打印6位和8位电话号码DTMF信号的幅度谱。
(2)简述DTMF信号的参数：采样频率、DFT的变换点数以及观测时间的确定原则。
338
Created by ZhuangHeng
附录
附录A 用Masson公式求网络传输函数H(z)
已知信号流图，按照Masson公式可以直接写出传输函数H(z),Masson公式为
Ha)-2T (A.1)
式中，△称为流图特征式，其计算公式如下：
△=1-∑L+∑LL-∑LLL?+…
∑L 式中： 表示所有环路增益之和；
∑LiL 表示每两个互不接触的环路增益乘积之和；
2L"L"L"表示每三个互不接触的环路增益乘积之和；
附录
T,表示从输入节点到输出节点的第k条前向通路的增益；
△。表示不与第k条前向通路接触的那部分流图的△值。
例如，利用Masson公式求图A.1所示流图的系统函数H(z),图中有四个环路：
L?由x?→x→x
L?由x?→x?→x→x→x→x?
L?由x?→x→x→x→x?
L?由x?→x?→x→x?
它们的环路增益分别为：
L?=-H?G?,L?=-H?H,H?H?G?
L=-H?H?H?G?,L=-H?H?G?
互不接触的环路有一对，两个环路增益乘积为
L?L?=H?G?H?H,G?
339
Created by ZhuangHeng
口
数字信号处理(第五版)
H? H?
x(n) H H? H H
y(n)
? H?
-G? G
图A.1
没有三个互不接触的环路，因此
△=1+(H?G?+H?H?H?H?G?+H?H,H?G?+H?H?G?)+HG?H?H?G?
从输入节点到输出节点有三条前向通路：
T?:x(n)→x?→x?→x?→x→xs→y(n)
T?=H?H?H?H?H?
T?:x(n)→x?→a→x→xg→y(n)
T?=H?H?H?H?
Ta:x(n)→x?→x?→x→y(n)
T,=H?H?H?
由于前向通路T?和T。没有不接触的环路，所以，△?=1,△=1,与前向通路T,不接
触的环路只有L?,因此△=1+HG?,最后得到网络的传输函数为
H(z)=TiA?+TA+T△
附录B MATLAB信号处理工具箱函数索引表
版本5.1(R12.1)06-04-2001
340
分 类 函 数 名 功 能说 明 本函数首次出现
所在的章节或例题
angle 相角 2.6.3节
freqs 模拟系统频率响应
freqspace 为频率响应设定频率间隔
一
freqz 数字滤波器频率响应 2.6.3节，例2.6.4
滤波器分析
abs 幅值 2.6.3节
freqzplot 频率响应绘制
fvtool 滤波器可视化工具
grpdelay 群时延
一
impz 脉冲响应(离散的)
unwrap 修正相位，使其范围不限于主角士π
zplane 画出离散的零极点增益 2.6.3节，例2.6.4
Created by ZhuangHeng
续表一
分 类 函 数 名 功 能 说 明 本函数首次出现
所在的章节或例题
conv2 二维卷积
deconv 解卷积
fftfilt 重叠相加滤波器实现 3.4.1节，例3.4.1
filter 滤波器实现 5.3节
filter2 二维滤波器实现
一
滤波器实现
conv 卷积计算
一
filtfilt 零相位滤波
filtic 确定滤波器原始条件 5.3节
latefilt 格形滤波器实现
一
medfilt1 一维中值滤波
一
sgolayfilt Savitzky Golay滤波器实现
sosfilt 二阶环节(biquad)滤波器实现
upfirdn 先高采样，后FIP滤波，再低采样
cremez 复非线性相位等波动FIR滤波器设计
firl 基于窗函数FIR滤波器设计 7.2.3节，例7.2.1,
例7,2.2,例7.2.3
fir2 基于窗函数的任意响应FIR滤波器设计 7.3节
fircls 约束最小二乘法任意响应滤波器设计
一
firelsl 约束最小二乘法低通和高通滤波器设计
FIR滤波器设计
convmtx 卷积矩阵
一
firls 最小二乘法FIR滤波器设计
firrcos 上升余弦FIR滤波器设计
intfilt 插值FIR滤波器设计
kaiserord 基于窗函数的Kaiser滤波器阶数选择
remez Parks MeClellan最适合FIR滤波器设计 7.4.2节，例7.4.1,
例7.4.2,例7.4.3
remezord Parks MeClellan滤波器阶数估计 7.4.2节
sgolay Savitzky Golay FIR平滑滤波器设计
附录
341
Created by ZhuangHeng
数字信号处理(第五版)
续表二
342
分 类 函 数 名 功 能 说 明 本函数首次出现
所在的章节或例题
chebyl 切比雪夫I型滤波器设计 6.2.3节
IIR数字
滤波器设计
butter 巴特沃斯滤波器设计 6.2.2,例6.2.2,例
6.2.5
cheby2 切比雪夫Ⅱ型滤波器设计 6.2.3节
ellip 椭圆型滤波器设计 6.2.4节，例6.2.4
maxflat 归一化的巴特沃斯低通滤波器设计
yulewalk 耶鲁—沃克滤波器设计
IIR滤波器
阶数估算
buttord 巴特沃斯滤波器阶数选择 6.2.2节，例6.2.2
cheblord 切比雪夫I型滤波器阶数选择 6.2.3节，例6.2.3
cheb2ord 切比雪夫Ⅱ型滤波器阶数选择 6.2.4节，例6.2.3
ellipord 椭圆形滤波器阶数选择 6.2.4节，例6.2.4
buttap 巴特沃斯滤波器原型 6.2.2节
模拟低通
滤波器原型
besselap 贝塞尔滤波器原型
cheblap 切比雪夫I型滤波器原型(通带波动) 6.2.3节
cheb2ap 切比雪夫Ⅱ型滤波器原型(阻带波动) 6.2.3节
ellipap 椭圆滤波器原型 6.2.4节
butter 巴特沃斯滤波器设计
模拟低通
滤波器设计
besself 贝塞尔模拟滤波器设计
cheby1 切比雪夫I型滤波器设计 6.2.3节，例6.2.3
cheby2 切比雪夫Ⅱ型滤波器设计 6.2.3节，例6.2.3
ellip 椭圆滤波器设计 6.2.4节
模拟滤波器
频带变换
lp2bp 低通向带通模拟滤波器变换
Ip2bs 低通向带阻模拟滤波器变换
一
lp2hp 低通向高通模拟滤波器变换 例6.2.5
lp2lp 低通向低通模拟滤波器变换
滤波器离散化
bilinear 有预先修正选项的双线性变换 例6.4.2
impinvar 脉冲响应不变法模拟向数字的转换 6.3节，例6.3.2
Created by ZhuangHeng
续表三
分 类 函 数 名 功 能 说 明 本函数首次出现
所在的章节或例题
polystab 使多项式稳定
polyscale 多项式根乘以倍率
residuez Z变换部分分式展开
一
sos2ss 级联二阶环节向状态空间转换
sos2tf 级联二阶环节向传递函数转换 5.3节
sos2zp 级联二阶环节向零极增益转换
ss2sos 状态空间转换为二阶环节级联
ss2tf 状态空间向传递函数转换
线性系统变换
late2tf 格形或者格形梯形向传递函数转换 5.3节，5.7.2节
ss2zp 状态空间向零极增益转换
tf21ate 传递函数向格形或者格形梯形转换 5.3节，5.7.1节，
5.7.2节
tf2sos 传递函数向级联二阶环节转换 5.3节，例5.3.2,
5.4.1节
tf2ss 状态空间向传递函数转换
一
tf2zp 传递函数向零极增益转换
一
zp2sos 零极增益向级联二阶环节转换
zp2ss 零极增益向状态空间转换
zp2tf 零级增益向传递函数转换
一
barthannwin 修正巴特利特一汉宁窗 二
blackman 布莱克曼窗函数
blackmanharris 最小四项 Blackman-Harris窗函数
bohmanwin Bohman 窗函数
chebwin 切比雪夫窗函数
一
gausswin 高斯窗函数
一
窗函数
bartlett Bartlett 窗函数 6.2.2节
hamming 哈明窗函数
一
hanning 汉宁窗函数
一
kaiser 凯泽窗函数
nutallwin Nuttall最小四项Blackman-Harris窗函数
boxcar 矩形窗函数
triang 三角窗函数
tukeywin Tukey 窗函数
一
window 窗函数引入
■附录
343 Created by ZhuangHeng
口
口
口
口口
口口
口
数字信号处理(第五版)
续表四
344
分 类 函 数 名 功 能说 明 本函数首次出现
所在的章节或例题
czt 线性调频Z变换
一
det 离散的余弦变换
dftmtx 离散傅里叶变换矩阵
一
fft 快速傅里叶变换 3.1.4节，例3.1.2
fft2 二维快速傅里叶变换 变换
bitrevorder 将输入变换成倒序排列
一
fftshift 交换矢量的一半 10.6节
goertzel 计算 DFT的Goertzel算法
hilbert Hilbert 变换
idet 离散的逆余弦变换
ifft 快速傅里叶逆变换 3.1.4节
ifft2 二维快速傅里叶逆变换
一
倒谱分析
cceps 复倒谱
icceps 逆复倒谱
rceps 实例谱和最小相位重建
corrcoef 相关系数
corrmtx 自相关矩阵
cov 协方差矩阵
一
csd 互相关谱密度
pburg 用Burg方法功率谱估计
pcov 用协方差方法功率谱估计
peig 用特征向量方法功率谱估计
periodogram 周期谱图方法功率谱估计
pmcov 用修改协方差方法的功率谱估计
统计信号处理和
谱分析
cohere 相干函数
一
pmtm 用Thomson 多带方法功率谱估计
pmusic 用MUSIC方法的功率谱估计
psdplot 绘制功率谱密度数据
一
pwelch 用Welch方法功率谱估计
pyulear 用耶鲁一沃克AR方法的功率谱估计
rooteig 用特征向量法作正弦频率功率谱估计
rootmusie 用MUSIC法作正弦频率功率谱估计
tfe 传递函数估计
xcorr 互相关函数或自相关函数 1.6.6节
xcorr2 二维互相关
一
xcov 协方差函数
一
Created by ZhuangHeng
续表五
分 类 函 数 名 功能 说 明 本函数首次出现
所在的章节或例题
arcov 用协方差方法AR参数的建模
armcov 用修改协方差方法AR参数的建模
一
aryule 用耶鲁-沃克方法AR参数的建模
一
参数建模
arburg 用Burg方法AR参数的建模
ident 参看系统辨识工具箱
一
invfreqs 模拟滤波器向频率响应拟合
invfreqz 离散滤波器向频率响应拟合
一
prony Prony离散滤波器拟合时间响应
一
stmcb Steiglitz MeBride 迭代的ARMA建模
一
rc2lar 反射系数向对数区域比转换
一
线性预测
re2is 反射系数向反正弦参数转换
一
rc2poly 反射系数向预测多项式转换
一
rlevinson 逆Levinson Durbin递归
一
schurre Schur算法
downsample 抽取输入信号
interp 整数因子内插 8.7节
多采样率
信号处理
decimate 整数因子抽取 8.7节
interpl 通用一维插值透入(MATLAB实现箱)
resample 用新取样速度再抽样 8.7节
spline 三次样条内插
upfirdn 先内插，后FIR 滤波，再抽取 8.7节
upsample 对输入信号内插
一
dric Dirichlet(周期性sinc)函数
gauspuls 高斯高频脉冲发生器
gmonopuls 高斯单脉冲发生器
一
pulstran 脉冲序列发生器
波形产生
chirp 扫频的频率余弦发生器
rectpuls 采样的非周期性的方波发生器
sawtooth 锯齿函数
sinc sinc或者sin(πx)/(πx)函数
square 方波函数
tripuls 采样的非周期性的三角形发生器
vco 压控振荡器
■附录
345
Created by ZhuangHeng
数字信号处理(第五版)
续表六
346
分 类 函 数 名 功 能 说 明 本函数首次出现
所在的章节或例题
cell2sos 将单元阵列转换为二阶级联矩阵
cplxpair 把矢量变为复共轭对
demod 解调
dpss 离散的扩展球形序列(Slepian序列)
dpssclear 从数据库去除离散的扩展球形序列
一
dpssdir 离散的扩展球形序列数据库子目录
dpssload 从数据库下载离散的扩展球形序列
一
dpsssave 向数据库写人离散的扩展球形序列 专门的运算
buffer 把一个矢量缓冲到数据帧的矩阵中去
一
eqtflength 使离散时间传递函数分子、分母系数等长
modulate 为通信仿真调制
seqperiod 在一个矢量中找到最小长度重复序列
sos2cell 将二阶级联矩阵转换为单元阵列
specgram 语音信号谱图
stem 画出离散数据序列
strips 画出条形图
udecode 使输入二进制码均匀解码
uencode 使输入信号均匀编码为N位二进制码
图形用户
界面工具
fdatool 滤波器分析设计工具 7.7节
sptool 信号处理工具
音频支持(这
些函数不是工
具箱函数，属于
MATLAB基本
部分)
sound 重放矢量成为声音
soundsc 声音自动定标和重放矢量数
wavplay 使用视窗音频的输出装置重放声音
一
wavread 读微软.wav声音文件
wavrecord 使用视窗音频的输入装置记录声音
wavwrite 写微软.wav声音文件
Created by ZhuangHeng
