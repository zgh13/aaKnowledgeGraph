目 录
基 础 篇
第1章 MATLAB概述 …………………3
1.1 MATLAB的发展……………………………3
1.2 MATIAB的主要功能 ………………………4
1.3 MATLAB系统的运行环境与安装…………5
1.3.1 运行环境 ……………………………5
1.3.2 安装…………………………………5
1.4 MATLAB系统的启动与退出 ………………6
1.4.1 启动…………………………………6
1.4.2 退出…………………………………6
1.5 MATLAB命令窗口 …………………………7
1.5.1 菜单栏…………………………………7
1.5.2 工具栏 …………………………………9
1.5.3 命令编辑区……………………………9
1.6 MATLAB文件管理…………………………11
1.6.1 MATLAB的目录结构…………………11
1.6.2 MATLAB的搜索路径…………………11
1.6.3 用户目录的设置 ……………………12
1.6.4 搜索路径的设置 …………………12
1.7 MATLAB帮助系统………………………13
1.7.1 帮助命令 ……………………………14
1.7.2 帮助窗口 ……………………………14
1.7.3 帮助桌面 ……………………………14
1.7.4 在线帮助页 …………………………15
1.8 MATIAB功能演示 ……………………15
习题……………………………………17
第2章 MATLAB数据…………………18
2.1 MATLAB数据的特点…………………18
2.2 变最和赋值………………………………18
2.2.1 变量的命名 …………………………18
2.2.2 赋值语句 ……………………………19
2.2.3 数据的输出格式 ……………………19
2.2.4 预定义变量 …………………………20
2.2.5 内存变量的管理 …………………21
2.3 MATLAB矩阵……………………………23
2.3.1 矩阵的建立…………………………23
2.3.2 冒号表达式 …………………………26
2.3.3 矩阵的拆分 …………………………26
2.3.4 多维矩阵 …………………………28
2.4 MATLAB运算……………………………30
2.4.1 算术运算 ……………………………30
2.4.2 关系运算 ……………………………34
2.4.3 逻辑运算 ……………………………35
2.5 字符串 …………………………………36
2.6 结构和单元 ………………………………38
2.6.1 结构数据 …………………………38
2.6.2 单元数据 …………………………39
习题二…………………………………………40
第3章 MATLAB程序设计………………42
3.1 M文件 ……………………………………42
3.1.1 M文件的建立与编辑 ………………42
3.1.2 M文件的分类………………………43
3.2 数据的输人输出 …………………………44
3.2.1 input 函数 …………………………………44
3.2.2 disp 函数………………………………45
3.2.3 pause 函数…………………………46
3.3 选择结构 …………………………………46
3.3.1 if语句…………………………………46
3.3.2 switch语句…………………………48
3.3.3 try语句……………………………50
3.4 循环结构 …………………………………50
3.4.1 for语句……………………………50
3.4.2 while 语句……………………………52
3.4.3 循环的嵌套 …………………………54
3.5 函数文件 …………………………………55
3.5.1 函数文件的基本结构 ………………55
3.5.2 函数调用……………………………56
3.5.3 函数所传递参数的可调性 …………57
4.3.1 图形的裁剪处理 ……………………86
4.3.2 视点处理……………………………87
4.3.3 色彩处理……………………………89
4.3.4 光照处理 ……………………………91
4.4 图像与动画 ………………………………92
4.4.1 图像…………………………………92
4.4.2 动画 …………………………………93
4.5 低层绘图操作 ……………………………93
4.5.1 图形对象及其句柄 …………………93
4.5.2 图形对象属性 ………………………94
4.5.3 图形对象的创建 ……………………96
习题四 ………………………………………103
第5章 MATLAB数值计算 ……………104
5.1 特殊矩阵 ……………………………………104
5.1.1 对角阵与三角阵……………………104
5.1.2 特殊矩阵的生成……………………106
5.2 矩阵分析………………………………108
5.2.1 矩阵结构变换………………………108
5.2.2 矩阵的逆与伪逆 ……………………109
5.2.3 方阵的行列式………………………111
5.2.4 矩阵的秩 ……………………………111
5.2.5 向量和矩阵的范数…………………112
5.2.6 矩阵的条件数和迹 …………………114
·2· 目录
3.6 全局变量和局部变量 ……………………58 5.2.7 矩阵的特征值与特征向量…………115
3.7 类和对象 ………………………………59 5.2.8 MATLAB在三维向量中的应用 ……117
3.8 文件操作 …………………………………61 5.3 矩阵分解与线性方程组求解……………120
3.8.1 文件的打开与关闭 …………………61 5.3.1 矩阵分解……………………………120
3.8.2 二进制文件读写操作 ………………62 5.3.2 线性方程组求解 ……………………124
3.8.3 文本文件读写操作 …………………62 5.4 数据处理与多项式计算…………………127
3.8.4 数据文件定位 ………………………63 5.4.1 数据统计与分析 ……………………127
习题三……………………………………64 5.4.2 数值插值……………………………131
第4章 MATIAB绘图…………………66 5.4.3 曲线拟合……………………………134
4.1 二维图形 ………………………………66 5.4.4 多项式计算…………………………136
4.1.1 绘制二维曲线的最基本函数 ………66 5.4.5 函数的最大值与最小值……………138
4.1.2 绘制图形的辅助操作 ………………70 5.5 傅立叶分析………………………………139
4.1.3 绘制二维图形的其他函数 …………75 5.6 数值微积分………………………………141
4.2 二维图形 …………………………………80 5.6.1 数值微分……………………………141
4.2.1 绘制三维曲线的最基本函数 ………80 5.6.2 数值积分 ……………………………144
4.2.2 三维曲面 ……………………………81 5.7 常微分方程的数值求解 …………………146
4.2.3 其他三维图形 ………………………86 5.7.1 引言 …………………………………146
5.7.2 龙格一库塔法简介…………………147 4.3 三维图形的精细处理 ……………………86 5.7.3 龙格一库塔法的实现………………147
5.8 非线性方程的数值求解…………………150
5.8.1 数学迭代法简介…………………150
5.8.2 单变量非线性方程求解……………151
5.8.3 非线性方程组求解…………………152
5.9 稀疏矩阵 …………………………………153
5.9.1 矩阵存储方式………………………153
5.9.2 稀疏存储方式的产生与转化………154
5.9.3 稀疏矩阵应用举例………………156
习题五 ………………………………………157
第6章 MATLAB符号计算 ……………160
6.1 符号计算基础 …………………………160
6.1.1 符号对象…………………………160
6.1.2 基本的符号运算 ……………………163
6.1.3 符号表达式中变量的确定…………165
6.2 符号导数及其应用………………………166
6.2.1 函数的极限 ……………………………166
6.2.2 符号函数求导及其应用……………167
6.3 符号积分…………………………………169
6.3.1 不定积分……………………………169
6.3.2 符号函数的定积分…………………170
6.3.3 积分变换……………………………172
6.4 级数……………………………………175
6.4.1 级数的符号求和……………………175
目录 ·3·
6.4.2 函数的泰勒级数 ……………………176
6.4.3 函数的傅立叶级数…………………177
6.5 代数方程的符号求解…………………178
6.5.1 线性方程组的符号求解 ……………179
6.5.2 非线性方程组的符号求解…………180
6.6 常微分方程的符号求解…………………182
6.6.1 求常微分方程的通解………………182
6.6.2 求常微分方程的特解 ………………183
6.6.3 常微分方程组求解 …………………184
习题六…………………………………………185
应 用 篇
第7章 MATLAB图形用户界面设计 …189
7.1 菜单设计………………………………189
7.1.1 用户菜单的建立……………………189
7.1.2 菜单对象常用属性…………………190
7.1.3 快捷菜单……………………………191
7.2 对话框设计………………………………193
7.2.1 对话框的控件………………………193
7.2.2 对话框的设计 …………………………193
7.3 用户界面设计工具………………………201
7.3.1 图形界面控制面板…………………201
7.3.2 属性编辑器…………………………202
7.3.3 事件过程编辑器……………………203
7.3.4 菜单编辑器…………………………204
7.3.5 位置调整工具………………………204
习题七 ………………………………………207
第8章 MATLAB笔记本 ………………208
8.1 笔记本的安装及启动……………………208
8.1.1 笔记本的安装………………………208
8.1.2 笔记本的启动………………………209
8.1.3 MA7LAB笔记本的界面 ……………209
8.2 输入单元的定义与执行…………………210
8.2.1 基本操作 ……………………………210
8.2.2 自初始化单元及其应用……………211
8.2.3 单元群及其应用……………………212
8.2.4 单元的循环执行…………………214
8.3 计算区的定义与执行 ……………………215
8.4 输出格式控制…………………………215
8.4.1 输出数据格式控制 …………………215
8.4.2 输出图形格式控制…………………216
8.5 Notebook菜单的其他命令 ………………217
8.5.1 整个M-book 文档输入单元
的执行………………………………217
8.5.2 别去M-book 文档中所有
输出单元 ……………………………217
8.5.3 单元转化为文本 ……………………217
8.6 M-book 模板样式的修改 ………………217
习题八 …………………………………………218
第9章 MATLAB环境下的仿真
软件 Simulink …………………219
9.1 Simulink的基本操作 ……………………219
9.1.1 Simulink 的启动与退出 ……………219
9.1.2 Simulink 模块的操作 ………………220
9.2 Simulink的几类基本模块 ………………224
9.3 仿真模型参数的设置……………………227
9.3.1 通过菜单命令设置仿真模型
参数 ………………………………227
9.3.2 在命令窗口设置仿真模型
参数………………………………233
9.4 子系统的建立与封装……………………240
9.4.1 子系统的建立……………………240
9.4.2 子系统的条件执行 …………………241
9.4.3 子系统的封装 ………………………244
9.5 在命令窗口中创建模型 …………………248
9.5.1 构造模型的命令……………………249
9.5.2 设置模块参数………………………249
9.6 S-函数的设计和应用 …………………250
9.6.1 S-函数概述 ………………………250
9.6.2 用M文件编写S-函数……………250
9.6.3 S-函数的命令调用 ………………259
9.7 仿真系统的线性化分析 …………………259
9.7.1 连续系统的线性化…………………259
9.7.2 离散系统的线性化………………260
9.7.3 连续系统线性化的一种高级
形式 …………………………………261
9.7.4 平衡分析 …………………………262
习题九………………………………………263
第10章 MATLAB应用实例……………265
10.1 MATLAB在电路分析中的应用…………265
·4· 目录
10.1.1 概述………………………………265 10.3.1 概述…………………………272
10.1.2 实例……………………………266 10.3.2 实例……………………………272
10.2 MATLAB在控制系统分析中的应用…269 10.4 MATLAB在1程结构分析中的应用…278
10.2.1 概述………………………………269 10.4.1 概述…………………………278
10.2.2 实例………………………………269 10.4.2 实例……………………………278
10.3 MATLAB在数学建模中的应用…………272
实 验 篇
实验要求…………………………………285 实验八 数据处理和多项式计算………292
实验一 MATLAB运算基础 ……………285 实验九 数值微积分与方程数值求解……293
实验二 选择结构程序设计 ……………287 实验十 符号计算基础与符号微积分…294
实验三 循环结构程序设计 ……………288 实验十一 级数与方程符号求解………295
实验四 函数与文件………………………289 实验十二 菜单设计………………………295
实验五 高层绘图操作…………………289 实验十三 对话框的设计…………………296
实验六 低层绘图操作…………………290 实验十四 Simulink的应用………………297
实验七 线性代数中的数值计算问题…291 实验十五 综合实验……………………299
参考文献 ……………………………………………………………………………………………300
础
第1章 MATLAB概述
自20世纪80年代以来，出现了科学计算语言，亦称数学软件。比较流行的有MATLAB、
Mathematica、Mathcad、Maple等，因为它们具有功能强、效率高、简单易学等特点，使其在许多领域
得到广泛应用。目前流行的几种科学计算软件各具特点，而且都在不断地发展，新的版本不断出
现，但就影响而言，影响最大、流行最广的当属MATLAB语言。
本章先介绍MATLAB的发展和主要功能，然后介绍MATLAB软件系统的使用，最后通过几个
例子演示MATLAB的功能。通过本章的学习，读者将对MATLAB语言许多诱人的特点有一个感
性认识，为今后的学习奠定基础。
1.1 MATLAB的发展
MATIAB是英文MATrix LABoratory(矩阵实验室)的缩写。1980年前后，时任美国新墨西哥大
学计算机科学系主任的Cleve Moler教授在给学生讲授线性代数课程时，想教学生使用当时流行
的线性代数软件包LNPACK 和基于特征值计算的软件包EISPACK,但发现许多高级语言调用
LINPACK和EISPACK软件包极为不便，于是，Cleve Moler教授便着手编写了接口程序并命名为
MATLAB,这便是MATLAB的雏形。
早期的MATLAB是用FORTRAN语言编写的，尽管功能十分简单，但由于是免费软件，还是
吸引了大批使用者。经过几年的校际流传，在 John Litte的推动下，由John Little、Cleve Moler 和
Steve Bangert合作，于1984年成立了MathWorks公司，并正式推出 MATLAB第1版(DOS版)。从
这时起，MATLAB的核心采用C语言编写，功能也越来越强。它不仅具有数值计算功能，而且还
具有符号计算、图形处理等功能。
以后，MATLAB版本不断更新。MathWorks公司于1992年推出了具有划时代意义的4.0版，
并于1993年推出了其微机版，该版本可以配合Windows 3.x一起使用，使其应用范围越来越广。
1994年推出的4.2版扩充了4.0版的功能，尤其在图形界面设计方面提供了新的方法。1997年
推出的5.0版提供了更多的数据结构，如结构数据、单元数据、多维矩阵、对象与类等，使编程更
方便。1999年初推出的5.3版在很多方面又进行了进一步改进。2001年7月，Math Works公司
推出了MATLAB的最新版本6.1版，6.1版对计算机的配置要求比较高，很多用户仍使用5.3版，
因此本书以5.3版为基础，全面介绍MATLAB的功能与使用技巧。
目前，MATLAB已经不仅仅是一个“矩阵实验室”了，它已成为一种广泛应用于工程计算及数
值分析领域的新型高级语言。MATLAB功能强大、简单易学、编程效率高，因丽深受广大科技工
作者的欢迎。在欧美各高等院校，MATLAB已成为线性代数、自动控制理论、数字信号处理、时间
序列分析、动态系统仿真、图像处理等课程的基本教学工具，成为理工科本科生、硕士生以及博士
生必须掌握的基本编程语言。在科研和工业生产领域，MATLAB已被广泛地用于研究和解决各
·4· 基 础 篇
种具体的工程问题。近年来，MA7LAB在我国也开始流行，应用MATLAB的单位和个人急剧增
加。可以预见，MATLAB将在我国科学研究和工程应用中发挥越来越大的作用。
1.2 MATLAB的主要功能
MATLAB自1984年由MathWorks公司推向市场以来，历经十几年的发展和改进，现已逐步风
靡世界。其可靠的数值计算和符号计算功能、强大的绘图功能、简单易学的语言体系以及为数众
多的应用工具箱使其在科技应用软件中备受瞩目。
1.数值计算和符号计算功能
科学计算有数值计算和符号计算之分。MATLAB的数值计算功能非常强大，它提供了十分
丰富的数值计算函数，而且所采用的数值计算算法都是国际公认的、最先进的、可靠的算法，其程
序由世界一流专家编制，并经高度优化。高质量的数值计算功能为MATLAB赢得了声誉。
在实际应用中，除了数值计算外，在符号计算领域往往要得到问题的解析解，MATLAB和著
名的符号计算语言Maple结合，实现了MATLAB的符号计算功能。
2.绘图功能
MATLAB提供了两个层次的绘图操作：一种是对图形句柄进行的低层绘图操作，另一种是建
立在低层绘图操作之上的高层绘图操作。利用MATLAB的高层绘图操作可以轻而易举地绘制各
种图形。利用MATLAB图形句柄操作，可以随心所欲地对图形元素进行各种操作，为用户在图形
表现方面开拓了一个广阔的、没有丝毫束缚的空间。
3.MATLAB语言体系
MATLAB是一种高级的科学计算语言。它具有程序结构控制、函数调用、数据结构、输入输
出、面向对象等程序语言特征。使用MATLAB可以很容易地实现BASIC、FORTRAN、C等传统语
言的几乎全部功能，包括Windows图形用户界面的设计，而且简单易学，编程效率高。因此，对于
从事数值计算、计算机辅助设计和系统仿真等领域的人员来说，用MATTAB编程的确是一个最佳
选择。
MATLAB是解释性语言，程序执行速度较慢，而且不能脱离MATLAB环境而独立运行。
MathWorks公司希望使MATLAB成为新一代的通用软件开发工具，并为此提供了将MATLAB源程
序编译为独立于MATLAB集成环境运行的 EXE文件以及将MATLAB程序转化为C语言程序的
编译器。
4.MATLAB工具箱
MATLAB包含两部分内容：基本部分和各种可选的工具箱。基本部分构成了MATLAB的核
心内容，也是使用和构造工具箱的基础。MATLAB工具箱分为两大类：功能性工具箱和学科性工
具箱。功能性工具箱主要用来扩充其符号计算功能、可视建模仿真功能及文字处理功能等、学
科性工具箱专业性比较强，如控制系统工具箱(Control System Toolbox)、信号处理工具箱(Signal
Processing Toolbox)、神经网络工具箱(Neural Network Toolhox)、最优化工具箱(Optimization Toolbox)、
金融工具箱(Financial Toolbox)、统计学工具箱(Statistics Toolbox),等等，这些工具箱都是由该领域
内学术水平很高的专家编写的，用户可以直接利用这些工具箱进行相关领域的科学研究。
第1章 MATLAB概述 ·5·
MATLAB共备很强的开放性。除内部函数外，所有MATLAB基本文件和各工具箱文件都
是可读可改的源文件，用户可通过对源文件的修改或加入自已编写的文件去构建新的专用工具
箱。
1.3 MATLAB系统的运行环境与安装
1.3.1 运行环境
MATLAB5.3作为Windows 95/98下的一个应用程序，本身对软硬件没有特殊要求。也就是
说，它对环境的要求与Windows 95/98要求是一致的。
1.硬件环境
一般要求486以上的处理器、16 MB以上内存、足够的硬盘可用空间(随安装MATLAB组件
的多少而定)、CD-ROM驱动器、鼠标等。
2.软件环境
Windows 95/98或以上版本的操作系统。当使用MATIAB笔记本时，需先安装Micrusoft
Word。如果用户想生成mex 文件，需安装Microsoft C/C++、Borland C/C++或 Watcom C/C++,
或Microsoft Fortran PowerStation。如果用户想阅读完整的MATLAB的帮助信息，需预先安装
Netscape Navigator 2.0以上版本或者是Microsoft Intemet Explorer 3.0以上版本来阅读其中的超文
本帮助信息，还需安装Adobe Acrobat Rcader来阅读其中的PDF格式的帮助文件。
1.3.2 安装
MATLAB 5.3必须在Windows 95/98环境下用系统自带的安装程序setup.exe进行安装。步
骤如下：
(1)启动Windows 95/98。
(2)将MATIAB5.3光盘放入光驱，一般情况下，安装程序会自动运行。假如没有自动运行，
则在“我的电脑”或“资源管理器”中双击setup.exe 文件即可。运行 setup.exe文件后，进入 MAT LAB安装过程，稍等片刻，将会出现 Welcome to the MATLAB Setup的欢迎界面。
(3)单击Next按钮，进入用户安装协议界面。
(4)单击Yes按钮，进人用户信息注册界面。此时，需要在Name 栏中填入自己的名字或代
号；在Company 栏中填入自己的工作单位名称；在Personal License Password 栏中正确填入用户使
用许可号(可以在有关文本文件中或光盘盒上查找并妥善保存)。只有将这些信息都正确输入以
后，安装过程才能继续。
(5)单击Next按钮进入下一步。在Components 列表框中，根据自身需要选择安装所需要的
MATLAB组件。第一项为MATLAB基本组件，必须安装；其余的为MATLAB工具箱，可以根据需
要进行选择。在缺省状态下，MATIAB 5.3所安装的路径为c:\matlabrll。本书假定选择缺省安
装路径。如需修改，单击 Browse按钮，进入路径选择界面，否则跳过这一步。注意，硬盘可用空
间必须比 MATLAB所需空间大。
6 基 础 篇
(6)单击Next 按钮，进入下一步，进行文件复制
(7)文件复制结束，单击Finish按钮，MATLAB安装完毕。
1.4 MATLAB系统的启动与退出
1.4.1 启动
与一般的Windows 95/98程序一样，启动MATLAB系统有3种常见方法：
(1)在Windows 95/98桌面，单击任务栏上的“开始”按钮，选择“程序”菜单项，然后单击Mat lab菜单项中的MATLAB5.3程序，就可启动MATLAB系统，这时将看到图1.1所示的MATL.AB命
令窗口。
MATLAsind Nipday H口冈
T4 Y findew Help
鄱 ?
To get started,type one F these: helpwin,helpdesk,or deno.
for praduct. infornation.visit w.nathuworks.Con.
1
可
图1.1 MATLAB命令窗口
(2)运行e:\matlabrl1 \bin中的MATLAB系统启动程序matlab.exe。通过“我的电脑”或“资
源管理器”去查找这个程序，然后双击它。
(3)利用建立快捷方式的功能，将MATLAB系统启动程序以快捷方式放在Windows 95/98桌
面上，只要在桌面上双击该图标即可启动MATLAB。
1.4.2 返出
要退出MATLAB系统，也有3种常见方法：
(1)在MATLAB命令窗口 File菜单中选择Exit MATLAB命令。
(2)在MATLAB命令窗口输人 Exit或Quit命令。
(3)单击MATLAB命令窗口的关闭按钮。
第1章 MATLAB既述 :7
1.5 MATLAB命令窗口
启动MATLAB 5.3后，屏幕上会出现MATLAB命令窗口(如图1.1所示),它提供了用户和
MATLAB交互操作的环境。MATLAB命令窗口的组成和一般Windows 95/98窗口的组成类似。
在图1.1中，最上面显示MATLAB Command Window字样的一栏为标题栏，标题栏左边为窗口控
制按纽，右边依次为窗口最小化按钮、窗口缩放按纽和关闭窗口按钮。标题栏下面为菜单栏，其
中包含有5个菜单项。菜单栏下面为工具栏，其中提供了10个工具按钮。工具栏下面是命令编
辑区，命令编辑区占窗口的绝大部分。
1.5.1 象单程
在MATLAB5.3命令窗口的菜单栏，共包含File,Edit,View,Window和 Help等5个菜单项。
下面介绍它们的作用。
1.File 菜单项
File菜单项实现有关文件的操作，所包含的命令如图1.2所示。
E1
A? -ile
pen Zicre
1 Model
Eun Seript
Load Yurkspace
Save Yorkpaceh
Show orhtpace
Show Friphie Propertytor
Sho GT Layout Tool
Sn Path
Frsforancet
Print Sey
rint.
Lit TLAB Ctrl+Q
图1.2 File菜单项
File菜单项中各命令的作用如下：
(1)New 命令 用于建立M文件、图形窗口或Simulink的模型。
(2)Open命令 打开一个已经建立的M文件。
8 基 算
(3)OpenSeleetion 命令 打开选中的M文件。
(4)Run Sonpt命令 执行一个命令文件。
(5)Load Wokspace命令 将MAT文件中的变量装人到MATIAB工作空间。
(6)Save Workspsce As命令 把MATLAB工作空间的所有变量保存为MAT文件。
(7)Show Workspace命令 打开工作空间浏览器，其中显示MATLAB工作空间中所有变量的
类型、大小及占用的存储空间。
(8)Show Graphics Propery Edior命令 打开图形属性编辑器。在图形属性编辑器里，可以选
择MATLAB已经打开的图形窗口，对每个图形对象的属性值进行修改。这部分内容将在第7章
详细介绍。
(9)ShowGUI Layout Tool命令 打开图形界面控制面板。通过图形界面控制面板可以设计
图形用户界面。这部分内容将在第7章详细介绍。
(10)Set Path命令 打开路径浏览器。通过路径浏览器可以更改MATLAB执行命令时的搜
索路径。
(11)Peferenes命令 打开命令窗口的环境设置卡，用于设置命令窗口所采用的显示格式、
字体和图形复制选项。
(12)Pnnt Setup命令 设置打印机的参数，如打印机的类型，纸张大小，送纸方向，图形的打
印质量，等等。
(13)Print命令 用于打印命令窗口中的内容，也可以设置一些打印参数。
(14)Pam Seleeion命令 按照Pint Schup 选项的设置，打印选中的内容。
(15)Exit MATLAB命令 退出MATLAB系统。
2.Edit 菜单项
Edit菜单项用于命令窗口的编辑操作，如图1.3所示。
Edit菜单项中各命令的作用如下：
(1)Lida,Gut Copy和Faste 命令 分别用于撤销上一次操 T
作，剪切、复制和粘贴，这4项和其他Windows 95/98应用程序的相
应菜单项没有什么差别。 2L性
(2)Clear命令 在命令编辑区输人命令出现错误时，选中想 + 5m 则除的内容，再单击 Clear选项，将清除错误的内容，但已经按回车
犍的命令不可清除。 图1.3 Edi莱单项
(3)Select AI命令 用于选定文本编辑区的所有内容，以便
进一步复制。
(4)Clear Session命令 清除命令编释区的全部内容，但并不删除工作空间中的变量。
3.View 菜单项
MATLAB5.3版比早期版本多提供了一个View菜单项，该菜单可以用来显示和关闭工具栏。
4.Window 菜单项
利用Window菜单项可以查看目前MATLAB打开的所有窗口，并可选中某个窗口为当前窗
口，从而实现在不同衡口之间的转换。
第1章 MATLAB概述 9·
5.Help菜单项
Help 菜单项提供帮助信息，如图1.4所示。
Help菜单项中各命令的作用如下：
Hlp Yindo
Help Iips
(1)Help Window命令 打开MATLAB的帮助窗口。 Hulp tedk 009L1
(2)Help Tips命令 打开帮助窗口，并首先显示MATLAB的帮 Bpla ant lm 助系统的分类和使用方法。 ( A7LA (3)Help Desk(HTML)命令 打开系统WWw测览器，并显示 h Liensy MATLAB的帮助桌面。通过帮助桌面可以得到MATLAB的详细帮
助。 Jin.MATLA Aeenk
(4)Examples and Demos命令 MATLAB演示窗主页。可以通
图1,4 Help菜单项 过演示MATLAB提供的例子来熟悉相关部分的用法。
(5)About MATTLAB命令 显示关于MATLAB的版本、版权等信息。
(6)ShowLicense命令 显示款件许可协议。
(7)Join MATLAB Aocess 命令 打开系统 wwW浏览器，上网用户可通过填写相关的表格来
获得MathWorks公司的产品。
1.5.2 工具程
MATLAB5.3命令衡口的工具栏共提供了10个命令按钮，按钮名称及功能如图1,5所示。
这些命令按钮均有对应的菜单命令.但比菜单命令使用起来更快捷、方便。
新建 剪切 粘贴 工作空间潮览器 Simulink 模块库湖览露
册B?
打开 复制 撤销 路径测览龄 帮助
图1,5 命令窗口的工其栏
1.5.3 命命编稀区
1.命令编辑区的作用
命令编辑区用于输人命令和显示计算结果。选择Rile菜单项的Preference命令，可以设置命
令编辑区的显示风格。有时在命令编辑区会出现命令提示符》,表示MATLAB已准备好，正等待
用户输入命令。在》提示符后键人命令并按下回车键后，MATLAB就会解释执行所输人的命令
并在命令后面给出计算结果。值得注意的是，在中文 Windows环境下，不会出现提示符》,但这并
不影响 MATLAB的使用。
2.命令行的输入规则
一般来说，一个命令行输人一条命令，命令行以回车结束。但一个命令行也可以输人若干条
·10· 基 础 篇
命令，各命令之间以逗号分隔，若前一命令后带有分号，则逗号可以省略。例如
p=15,m=35
p=15;m=35
以上两个命令行都是合法的，第一个命令行执行后显示p和m的值，第二个命令行因命令p
=15后面带有分号，p的值不显示，而只显示m的值。
如果一个命令行很长，一个物理行之内写不下，可以在第一个物理行之后加上3个小黑点并
按下回车键，然后接着下一个物理行继续写命令的其他部分。3个小黑点称为续行符，即把下面
的物理行看作该行的“逻辑”继续。例如
8=1-1/2+1/3-1/4+1/5-1/6+1/7-..
1/8+1/9-1/10+1/11-1/12;
这是一个命令行，但占用2个物理行，第一个物理行以续行符结束，第二个物理行是上一行
的继续。
3.命令行的编辑
在MATLAB里，有很多的控制键和方向键可用于命令行的编辑。如果能熟练使用这些键将
大大提高操作效率。例如，当将命令xl=(log(3)+sqrt(5))/2中的函数名 sqrt输人成srt 时，由于
MATLAB中不存在srt 函数，MATLAB将会给出错误信息：
??? Undefined function or variable'srt'
重新输人命令时，用户不用输入整行命令，而只需按个键调出刚才输人的命令行，再在相应
的位置输人q字母并按下回车键即可。在回车时，光标可以在该命令行的任何位置，没有必要将
光标移到该命令行的末尾。反复使用个键，可以回调以前输人的所有命令行，其作用类似MS DOS下的DOSKEY命令。还可以只输入少量的几个字母，再按个键就可以调出最后一条以这些
字母开头的命令。例如，输人 plo后再按个键，则会调出最后一次使用的以plo开头的命令行。
表1.1介绍了MATLAB命令行编辑的常用控制键及其功能。
表1.1 命令行编辑的常用控制键
键名 功 能 键名
前寻式调回已输人过的命令
后寻式调回已输入过的命令
在当前行中左移光标
在当前行中右移光标
前寻式翻滚一页
后寻式翻滚一页
Home
End
Del
Backspace
Esc
功 能
将光标移到当前行首端
将光标移到当前行末尾
删除光标右边的字符
删除光标左边的字符
PgUp 剽除当前行全部内容
PgDn
4.常用操作系统命令
除了菜单操作之外，MATLAB还提供了许多直接在命令窗口执行的操作命令，以实施有关操
作。下面先介绍类似于操作系统命令的常用命令(见表1.2),其作用与 DOS下相关命令类似。
其他命令将在今后介绍相关内容时进行介绍。
第1章 MATLAB楼述 It
表1,2 常用摄作系统命令
命令 动 能 命令
显示文件日录清单
改变当稚工作目录
建立目录
删除文件
显示文本文件内容
mte
opfil
hh
de
wob
功能
di 使基后的显示内客分屏进行
d 发制文件
kdir 显示当前目录下的M文件和MAY 文件
delete 清除命令窗口妮示的内容
type 打开润络岗览器
表1.2中所列命令是在MATLAB命今窗口执行的命令，虽然和DOS的有关命令作用类似，
但命令名、格式、用法并非完全相同，使用时不要混淆。
1.6 MATLAB文件管理
1.6.1 MATLAB的目最结构
为了对文件进行有效的组织和管理，MATLAB有自己严谨的目录结构，不同类型的文件放在
不问的目录下。前面介绍MATLAB的安装时，选择了缺省安装路径e:\matlabrl?,在安装目录下
有下面几个常用的子目录。
(1)bin子目录 存放MATLAB的大部分可执行文件，库文件以及一些设置路径的批处理文
件。
(2)extem子目录 存放MATLAB语言和C的接口，如头文件等。
(3)help子目录 存放HTML型的或PDF型的帮助文件。
(4)motebook 子目录 MATLAB笔记本目录，即存放MATLAB语言和Wond的接口。
(5)simalink子目录 Simulink软件所在的目录。
(6)toolbox子目录 各个工具箱所在目录。其中，matlib子目录下为MATLAB系统的基本内
容.而其他的目录随所安装工具箱的不同而有所差异。
(7)work子目录 用户工作目录。
1.6.2 MATLAB的搜索路径
当用户在MATLAB命令窗口输人一条命令后，MATLAB按照一定次序寻钱相关的文件。基
本的搜素过程是：
(1)检查是不是一个变量。
(2)检查是不是一个内部函数。
(3)检查是否当前目录下的M文件(扩展名为m的文件》。
(4)检查是否MATLAB搜索路径中其他目录下的M文件。
假定建立了一个变量 examp,同时在当前目录下建立了一个M文件 examp.m,如果在命令窗
·12· 基 础 篇
口输人 examp,按照上面介绍的搜索过程，应是在屏幕上显示变量examp的值。如果没有建立ex amp变量，则执行 examp.m文件。
1.6.3 用户目录的设置
用户可以将白己的工作目录设置成当前目录，从而使得用户的操作都在用户日录中进行。
将用户目录设置成当前目录使用cd命令。例如，将用户目录c:\mydir设置为当前目录，可在命
令窗口输入命令：
cd e:\mydir
注意：设置的当前目录只是在当前启动的MATLAB环境下有效，一旦MATLAB重新启动，必
须重新设置。
1.6.4 校索路径的设置
用户可以将自己的工作目录列入MATLAB搜索路径，从而将用户目录纳入MATLAB系统统
一管理。
1.用path 命令设置搜索路径
使用path命令可以把用户目录临时纳入搜索路径。例如，将用户目录c:\mydir加到搜索路
径下，可在命令窗口输入命令：
path(path,'c:\mydir')
要注意的是，设置的搜索路径仅在当前启动的MATLAB环境下有效，一旦MATLAB重新启
动，必须重新设置。
2.用路径浏览器设置搜索路径
MATLAB路径浏览器可用来设置当前目录和永久性改变搜索路径。
(1)路径浏览器的启动
启动路径浏览器有3种方法：在MATLAB命令窗口 File菜单中选Set Path 命令；在命令窗口
执行pathtool命令；单击命令窗口工具栏上的路径浏览器按钮。
启动路径浏览器后，屏幕上出现图1.6所示的路径浏览器窗口。
(2)路径浏览器的操作
在路径浏览器窗口的Path菜单中选Add to Path命令，可将指定目录添加到搜索路径下。选
择该命令后，将打开一个图1.7所示的添加目录对话框，用户可以在此对话框空白栏直接输入所
需添加的目录，或通过空白栏右边的按钮选择所需添加的目录。再通过空白栏下方的单选按钮，
决定把用户目录放在搜索路径前端还是后端。选择结束后，单击OK按钮，回到MATLAB路径浏
览器。在路径浏览器中，选择 File菜单项中的Save Path 命令，便完成了添加操作。
在路径浏览器窗口的Path菜单中选Remove from Path 命令，可将指定目录从搜索路径中删
除。先在路径浏览器的路径列表中选定某目录，再选择Path 中的Remove from Path 命令，并选择
File中的Save Path命令，即完成操作。
也可利用路径浏览器进行当前目录设置。在路径浏览器窗口单击Browse按钮，然后在出现
的目录中选定所需的月录，便完成了设置。要注意的是，当前目录的设置都是临时的，一旦MAT LAB重新启动，必须重新设置。
第1章 MATAB概述 13
Psth Bromr 国口区
Ei14 tdi! Yi Lath Too1 Molp
回区N
Curnt les inIL
D:\HFIL Br.
Ysu LK
C:\MATLABR11\toolbox\ant1ab\gener
C:HATLAEp11voo1bex\naeIab\ops
c:\ATLA8211\toolbax\aaclab\Iang
C:\HATLABR11\toolbox\ac1mb\olant
c:XHATLABR11\eoo1box\ma1b\elfun
c \HATLABR111tc01box\matlab\spet
;
物同时可言艺国A
BAIATA.H
DISTANT.其
DHAT.H
E21.t
直410.H
5411.其
E412.H
R413.H
X414.M
B414_1.8
Eamdy 10-17PN
图工在 路径浏蔻器
Add to PAth 区
liractouy to D
W118
Cuneel
kdd to fraChdd ta haak
图1,7 振加目录谢话供
1.7 MATLAB帮助系统
MATLAB提供了数目繁多的函数和命令，要全部把它们记下来是不现实的。可行的办法是
先掌握一些基本内容，然后在实践中不渐总结和积累，掌握其他内容。通过软件系统本身提供的
帮助功能来学习软件的使用是重要的学习方法。MATLAB也提供了丰富的帮助功能，通过这种
功能可以很方便地获得有关函数和命令的使用方法。
在MATLAB环境下，要获得替助可通过以下儿种方法：帮助命令，帮助窗口，帮助桌面或在
线帮助页。对于inteme用户，还可真接链接到Mahwaks公司的网页上(hup://www.mathwoks.
com)寻求帮助。
·14· 基 础 篇
1.7.1 帮助命令
1.help命令
help.命令是查询函数语法的最基本方法，查询信息直接显示在命令窗口。例如，为了显示
sqrt 函数的使用方法与功能，可使用命令：
help sqt
屏幕显示帮助信息：
SQRT Square rnot.
SQRT(X)is the square root of the elements of X.Complex
results are produced if X is not positive.
See alsu SQRTM.
值得注意的是，MATLAB命令窗口里显示的帮助信息用大写来突出函数名，但在使用函数
时，要用小写。
MATLAB按照函数的不同用途分别存放在不同的子目录下，用相应的帮助命令可显示某一
类函数。例如，所有的线性代数函数均收在matfun子目录下，用命令
help matfun
可显示所有线性代数函数。
不带任何参数的help命令将显示所有的子目录。
2.lookfor 命令
help 命令只搜索出与那些关键字完全匹配的结果，lookfor 命令对搜索范围内的M文件进行
关键字搜索，条件比较宽松。例如，因为不存在inverse函数，命令
help inverse
搜索结果为：
inverse.m not found.
而执行命令：
lookfor inverse
将得到M文件中包含 jinverse的全部函数。
lookfor命令只对M文件的第一行进行关键字搜索。若在lookfor命令后加上-all选项，则可对
M文件进行全文搜索。
1.7.2 帮助窗口
帮助窗口给出的帮助信息和帮助命令给出的帮助信息一样，但在帮助窗口更容易浏览与之
相关的其他函数。在MATLAB命令窗口中，要进入帮助窗口有3种方法：
(1)单击工具栏上的帮助按钮。
(2)键人 helpwin命令。
(3)选择 Help菜单中的Help Window命令。
1.7.3 帮助桌面
帮助桌面比帮助命令及帮助窗口提供的帮助信息更多。帮助桌面的帮助信息大都用超文本
第1章 MATLAB慨述 ·15·
标记语言(HTML)写成，可以通过Netseape或Internet Explorer阅读。在MATLAB的命令窗口中，进
入帮助桌面有两种方法：
(1)键入 helpdesk 命令。
(2)选择Help菜单的Help Desk 命令。
这两种方法都会自动启动浏览器，用户可利用浏览器来浏览帮助信息。如果知道想要查询
的函数的名字，可以使用doc命令直接查看帮助信息。doc会自动打开浏览器并定位到相应函
数。
1.7.4 在线帮助页
帮助桌面的所有文件均有相应的PDF 格式文件，称为在线帮助页。PDF格式文件可用
Adobe Acrobat Reader阅读。用户选中帮助桌面上关于PDF格式文件的选项，或是在命令窗口中
键入命令doc,便会自动打开Adobe Acrobat Reader。
对于Intermet用户，还可以通过帮助桌面很方便地访问MathWorks公司的主页，向 MathWorks
公司咨询。
1.8 MATLAB功能演示
本节通过几个有代表性的例子来演示MATLAB的功能，日的是使读者能初步领略到MAT LAB的风格与特点。作为操作练习，读者可在MATLAB软件环境下验证下面的例子。
例1.1 求解线性方程组：
在MATLAB命令窗口输入命令：
a=[2,3,-1;8,2,3;45,3,9];
b=[2;4;23];
x=inv(a)*b
其中前两条命令建立系数矩阵a和列向量b,第三条命令求根。inv(a)为a的逆矩阵，也可用x
=a\b求根。得到的结果为：
x=
0.5531
0.2051
-0.2784
例1.2 绘制正弦曲线和余弦曲线。
在MATLAB命令窗口输入：
x=[0:0.5:360]*pi/180;
plot(x,sin(x),x,cos(x));
其中，第一条命令建立x向量，x从0°变化到360°并转换为弧度，第二条命令绘制曲线。命令执
行后，将打开一个图形窗口，并在其中显示正弦曲线和余弦曲线。
·16· 基 础 篇
例1.3 输人10个学生的成绩并对成绩按升序排序。
在MATLAB命令窗口输人：
g=input('请输人学生成绩：');
g=sot(g)
第一条命令执行后，屏幕提示“请输人学生成绩：”,在提示信息后输入10个学生的成绩，第二条
命令将成绩按升序排序。假定输入10个学生的成绩为：
「56,78,67,89,78.54,65,90,89,97]
则输出结果为：
g=
5456 78 89 8990 97 65 6778
例1.4 设有常微分方程初值问题：
r=4+12,0≤t≤1
y(0)=2
试求其数值解，并与精确解相比较(精确解为y(t)=√I+1+1)。
首先建立函数文件 funt.m:
function yp= funt(t,y)
yp=(y^2-1-2)/4/(t+1);
然后求解微分方程：
10=0;tf=10;y0=2;
[t,y]=ode23(' funt',[0,f],y0);
yl=sqn(t+1)+1;
1
ans=
· Columns I through 7
00.320000.93801.8105 2.81053.8105 4.8105
Columns 8 through 13
5.8105 6.8105 7.8105 8.8105 9.8105 10.0000
y
ans=
Columns I through 7
2.0000 2.149012.39292.6786 2.9558 3.1988 3.4181
Columns 8 through 13
3.6198 33.8079 3.9849 4.1529 4.3133 4.3430
y1'
ans=
Columns 1 through 7
2.0000 2.148922.3921 2.6765 2.9521 3.1933 3.4105
Columns 8 through 13
3.9683 4.1322 4.2879 4.3166 3.6097 3.7947
其中y为数值解，y1为精确值，显然两者近似。
第1章 MATLAB概述 ·17·
习 题 一
1.与其他高级语言相比，MATLAB有哪些显著特点?
2.怎样理解MATLAB的开放性?试结合自己的专业领域，为MATLAB设计一个工具箱。例如，假定一个桥
梁专家为MATLAB设计一个桥梁设计工具箱。
3.当正常安装好MATLAB后，误把 Windows 95子目录删除。当重新安装 Windows 95后，是否要再安装MAT LAB?
4.试将MATLAB系统的用户界面、操作方式与其他 Windows 95应用程序(如Word)作一对比，有哪些共同规
律?
5.先建立自己的工作目录，再分别用path 命令和路径浏览器将自已的工作目录设置到MATLAB搜索路径
下。用help命令能查询到自己的工作目录吗?
6.查看MATLAB的目录结构，并检查自已的机器上安装了哪些工具箱。
7.利用MATLAB的帮助功能分别查询 iny 函数，plot 函数以及MATLAB操作系统命令的功能及用法。
8.roots函数可以用于求多项式的根。先用 help 命令查看该函数的用法，然后利用该函数求x?+7x3+9x-
20=0的全部根。
第2章 MATLAB数据
随着MATLAB版本的提高，MATLAB数据类型更为丰富，除整型、双精度型、字符型等基本数
据类型外，还有结构体、单元等更为复杂的数据类型。而且，以上各种数据类型都以矩阵(在其他
高级语言中也称数组)形式存在，所以矩阵是MATLAB最基本的数据对象。十分丰富的数据类
型，使得MATLAB的数据表达能力非常强，给应用带来极大方便，也为MATLAB管理更复杂的数
据提供可能，从而进一步扩展了MATLAB的应用领域。
本章首先分析MATLAB数据的特点，然后重点介绍MATLAB中各种数据的表示方法以及数
据的各种基本运算，从而为学习MATLAB程序设计作好准备。
2.1 MATLAB数据的特点
正如MATLAB的名字——“矩阵实验室”的含义一样，MATLAB是由早期专门用于矩阵运算
的软件发展而来。矩阵是MATLAB最基本、最重要的数据对象，MATLAB的大部分运算或命令都
是在矩阵运算的意义下执行的，而且这种运算定义在复数域上。正因为如此，MATLAB的矩阵运
算功能非常丰富，体现出比其他高级语言要高得多的编程效率。许多含有矩阵运算的复杂计算
问题，在MATLAB中很容易得到解决。
因为向量可以看成是仅有一行或一列的矩阵，单个数据(标量)可以看成是仅含一个元素的
矩阵，故向量和单个数据都可以作为特殊矩阵来处理。
在一般情况下，矩阵的每个元素必须具有相同的数据类型。对于数值数据，MATLAB中最常
用的类型为双精度型，占64位(8个字节),用double函数实现转换。此外，还有单精度数，占32
位(4个字节),用single函数实现转换。还有带符号整数和无符号整数，其转换函数有 int8、int16、
int32、uint8、uint16、uint32,每一函数名后面的数字表示相应数据类型所占位数，其含义不难理解。
除数值数据以外，还有字符数据，在MATLAB中用char函数实现转换。
在实际应用中，有时需要将不同类型的数据构成矩阵的元素，为此MATLAB提供了结构
(Struelure)和单元(Cell)数据类型。此外，还有多维矩阵以及工程中应用十分广泛的稀疏矩阵
(Sparse)。
2.2 变量和赋值
2.2.1 变量的命名
变量代表一个或若干个内存单元，为了对变量所对应的存储单元进行访问，需要给变量命
第2章 MATIAB数据 ·19·
名。在MATLAB中，变量名是以字母开头，后接字母、数字或下划线的字符序列，最多19个字符。
例如，myexamp12、my_examp12、myexamp12_均为合法的变量名，而12myexamp、_myexampl2为非
法的变量名。另外，在MATLAB中，变量名区分字母的大小写。这样，myexamp、MYexamp 和
MYEXAMP表示3个不同的变量。值得注意的是，MATLAB提供的标准函数名以及命令名必须用
小写字母。例如，求矩阵A的逆用inv(A),不能写成Inv(A)或INV(A),否则会出错。
2.2.2 赋值语句
MATLAB赋值语句有两种格式：
(1)变量=表达式
(2)表达式
其中表达式是用运算符将有关运算量连接起来的式子，其结果是一个矩阵。在第一种语句形式
下，MATLAB将右边表达式的值赋给左边的变量，而在第二种语句形式下，将表达式的值赋给
MATLAB的预定义变量ans。
一般地，运算结果在命令窗口中显示出来。如果在语句的最后加分号，那么,MATLAB仅仅
执行赋值操作，不再显示运算的结果。如果运算的结果是一个很大的矩阵或根本不需要运算结
果，则可以在语句的最后加上分号。
在MATLAB语句后面可以加上注释，用于解释或说明语句的含义，对语句处理结果不产生任
何影响。注释以??头，后面是注释的内容。
5+7-2i 例2.1 计算表达式 的值，并将结果赋给变量x,然后显示出结果。
在MATLAB命令窗口输人命令：
x=(5+cos(47*pi/180))/(1+sqrt(7)-2*i) ??算表达式的值
其中pi和i都是MATLAB定义的变量，分别代表圆周率π和虚数单位。
输出结果是：
x=
1.1980+0.6572i
2.2.3 数据的输出格式
MATLAB用十进制数表示一个常数，具体可采用日常记数法和科学记数法两种表示方法。
如3.14159、-9.359i、3+5i等是采用日常记数法表示的常数，与通常的数学表示一样。又如
1.78029e2、6.732E2i、1234e-3-5i等是采用科学记数法表示的常数，在这里用字母e或E表示
以10为底的指数。
在一般情况下，MATLAB内部每一个数据元素都是用双精度数来表示和存储的。数据输出
时用户可以用format命令设置或改变数据输出格式。format命令的格式为：
fornal 格式符
其中格式符决定数据的输出格式，各种格式符及其含义见表2.1。注意，format 命令只影响数据
输出格式，而不影响数据的计算和存储。
·20· 基 础 篇
表2.1 控制数据输出格式的格式符
格式符 含义
输出小数点后4位，最多不超过7位有效数字。对于大于1000的实数，用5位有效数字的 short 科学记数形式输出
long 15位有效数字形式输出
short e 5位有效数字的科学记数形式输出
long e 15位有效数字的科学记数形式输出
short g 从short和short e中自动选择最佳输出方式
long g 从long和long e中自动选择最佳输出方式
rat 近似有理数表示
bex 十六进制表示
+ 正数、负数、零分别用+、一、空格表示
bank 银行格式，元、角、分表示
compact 输出变量之间没有空行
loose 输出变量之间有空行
如果输出矩阵的每个元素都是纯整数，MATLAB就用不加小数点的纯整数格式显示结果。
只要矩阵中有一个元素不是纯整数，MATLAB将按当前的输出格式显示计算结果。缺省的输出
格式是short 格式。作为一个例子，假定输入为：
x=[4/31.2345e-6]
那么,在各种不同的格式符下的输出为：
短格式(short):1.3333 0.0000
短格式e方式(short e):1.3333e+001.2345e-06
长格式(long):1.33333333333333 0.00000123450000
长格式e方式(long e):1.33333333333333e+00 1.23450000000000e-06
银行格式(bank):1.33 0.00
十六进制格式(hex):3f555555555 3eb46231abfd271
+格式(+):++
2.2.4 预定义变量
在MATLAB工作空间中，还驻留几个由系统本身定义的变量。它们有特定的含义，在使用
时，应尽量避免对这些变量重新赋值。除前面介绍过的ans外，还有一些常用的预定义变量，现
将它们列于表2.2中。
第2章 MATLAB数据 21
表2.2 常用的预定义变量
预定义变量 含义 预定义变量
计算结果的缺省赋值变量 twnin
机器零阐值 nargout
圆周率x的近似值 ealmax
虚数单位 realmin
无穷大。如1/0的结果 later
非数。如0/0、nf/inf的结果 latwam
含 义
as 函数输入参数个数
ep 函数输出参数个数
pi 最大正实数
标 最小正实数
inf,Inf 存放最新的错误信息
NaN,nan 存放最新的警告信息
2.2.5 为森变量的管理
1.内存变量的显示与测除
who和 whos这两个命令用于显示在MATLAB工作空间中已经驻留的变量名清单。但whos
在给出驻留变量名的同时，还给出它们的维数，所占字节数及性质。
clear命令用于副除MATLAB工作空间中的变量。注意，预定义变量不能被删除。
2.工作空间浏览酪
(1)工作空间测览器的启动
MATLAB工作空间渊览器专门用于内存变量的管理。启动工作空间浏览器有3种方法：在
命令窗口 File菜单中选Show Workspace命令；在命令窗口执行 workspace 命令；单击命令窗口工具
栏上的工作空间酒览器按纽。
启动工作空间浏览器后，屏幕上出现图2.1所示的工作空间润览器窗口。
Workspue riwir E门区
m
品。
耻
Si族 lytoCIu**
4xl 880cell array
30x30 7200- double urrsy 排
曲
1x1 double urray
1x1 a daublt array
1x1 8 double srray
irnd lot6架 山mnts am832
Qosn 2elat et
图2.1 工作空间浏览器
(2)工作空间浏览器的操作
22 基 础 篇
工作空间浏览器显示所有内存变量的属性。当选中某些变量后，再单击delete 按钮，这些变
量将被删除。当选中某些变量后，再单击open按钮，将进人变量编辑器(图2.2)。通过变量编辑
器可以直接观察变量中的具体元素，也可修改变量中的具体元素。
TLAB tditor/1Lbvecer-[abel
 i2 dit Y Dabug Iodi indo Help A圆国
口日(局白
帽，自姐 Stack:
1 2
0.9855 0.7995 0.5466
0.9169 0.4289 0.44491
4
I 0.5798
2 0.药04
B 04103 0.3046 0.6946 0.5298
30by 30
te
Ready 9:53 AR
图2.2 变量编辑器
通常，对于较大矩阵的输入，可采用变量编辑器。操作方法是：
①在命令窗口中向一个新变量赋空阵。
②在工作空间浏览器中打开该变量。
③在变量编辑器左下方的2个填充栏中填写待建矩阵的行数和列数，于是在变量编辑窗中
就会出现空白表格。表格的每一个方格对应矩阵的一个元素，在方格中填写元素值。
3.内存变量文件
利用MAT文件可以把当前MATLAB工作空间中的一些有用变量长久地保留下来。MAT文
件是MATLAB保存数据的一种标准格式二进制文件，扩展名一定是，mat。MAT文件的生成和装
人由save和load命令来完成。常用格式为：
ve 文件名[变量名表]1-append][-ci]
laad 文件名[变量名表][-ssci]
其中，文件名可以带路径，但不需带扩展名，mat,命令隐含一定对，mat文件进行操作。变量名表
中的变量个数不限，只要内存或文件中存在即可，变量名之间以空格分隔。当变量名表省略时，
保存或装人全部变量。-asci选项使文件以ASCI格式处理，省略该选项时文件将以二进制格
式处理。save命令中的-append选项控制将变量追加到MAT文件中。
假定变量 am和D存在于MATLAB工作空间中，输人以下命令便可借助mydata,mat 文件保
存am和D:
wremydsta am D
第2章 MATLAB数据 ·23·
假如在下次重新进人MATLAB后，需要使用矩阵am和D,可用下述命令把mydata.mat 中的
内容装入MATLAB工作空间：
load mydata
在执行上述命令后，在当前的MATLAB环境中，am和D就是两个已知变量了。
注意：mydata是用户自己取的文件名，MATLAB默认扩展名为.mat。上述 save命令执行以
后，该mydata.mat 文件将存放在当前目录。假如用户有意要让mydata.mat存放在指定的其他目
录(比如d:Mpp 目录)上.那么 save命令改为：
save d:\pp \mydata am D
当然，相应 load命令中文件名前也要加路径名。
除了操作命令以外，通过MATLAB命令窗口 File菜单项中的Save Workspace As命令可以保
存工作空间中的全部变量。相应地，通过 File菜单项中的Load Workspace命令可以将保存在
MAT文件中的变量装入到MATLAB工作空间。
2.3 MATLAB矩阵
在MATLAB中，不需对矩阵的维数和类型进行说明，MATLAB会根据用户所输入的内容自动
进行配置。
2.3.1 短阵的建立
1.直接输入法
最简单的建立矩阵的方法是从键盘直接输入矩阵的元素。具体方法如下：将矩阵的元素用
方括号括起来，按矩阵行的顺序输入各元素，同一行的各元素之间用空格或逗号分隔，不同行的
元素之间用分号分隔。例如，键入命令：
A=[123;456;789]
A=
1
4
23
56
7 89
这样，在MATLAB的工作空间中就建立了一个矩阵A,以后就可以使用矩阵A。
也可以用回车键代替分号，按下列方式输人：
A=[1 2 3
456
78 9]
MATLAB提供对复数的操作与管理功能。在MATLAB中，虚数单位用i或j表示。例如，6+
5i与6+5j表示的是同一个复数。也可以写成6+5*i或6+5*j,这里将i或j看作一个运算量
参与表达式的运算。例如，建立复数矩阵：
8=exp(2);
B=[1,2+i*a,a*spt(a);sin(pi/4),a/5,3.5+6i]
·24· 基 础 篇
B=
1.0000 2.0000+7.3891i 20.0855
0.7071 1.4778 3.5000+ 6.0000i
复数矩阵还可采用另一种输入方式。例如，
R=[1,2,3;4,5,6];
I=[6,7,8;9,10,11];
ri=R+i*I
ri=
1.0000+6.0000i 2.0000+7.0000i 3.0000+8.0000i
5.0000+10.0000i 6.0000+11.0000i 4.0000+9.0000i
在这里i是单个数据，i*I表示一个数与一个矩阵相乘。
2.利用M文件建立矩阵
对于比较大且比较复杂的矩阵，可以为它专门建立一个M文件。下面通过一个简单例子来
说明如何利用M文件创建矩阵。
例2.2 利用M文件建立MYMAT矩阵。
(1)启动有关编辑程序或MATLAB文本编辑器(见第3章),并输入待建矩阵：
MYMAT=[101,102,103,104,105,106,107,108,109;
201,202,203,204,205,206,207,208,209;
301,302,303,304,305,306,307,308,309];
(2)把输入的内容以纯文本方式存盘(设文件名为mymatrix.m)。
(3)在MATLAB命令窗口中输人 mymatrix,即运行该M文件，就会自动建立一个名为MYMAT
的矩阵，可供以后使用。
3.利用MATLAB函数建立矩阵
MATLAB提供了许多产生特殊矩阵的函数，可以利用它们去建立矩阵。下面先列举几个产
生特殊矩阵的函数。
产生全0矩阵(零矩阵) zeros
产生全1矩阵(幺矩阵) ones
产生单位矩阵 eye
产生0~1间均匀分布的随机矩阵 rand
randn 产生0~1间正态分布的随机矩阵
这几个函数的调用格式相似，下面以产生零矩阵的zeros 函数为例进行说明。其调用格式
是：
产生mxm零矩阵 zeros(m)
zeros(m,n) 产生m×n零矩阵。当m=n时，等同于zeros(m)
zeros(size(A)) 产生与矩阵A同样大小的零矩阵
其中，size(A)函数返回包含两个元素的向量，分别是矩阵A的行数和列数。相关的函数有：
length(A)给出A的行数和列数中的较大者，即length(A)=max(size(A));ndims(A)给出A的维数。
例2.3 分别建立3×3、3×2和与矩阵A同样大小的零矩阵。
(1)建立一个3×3零矩阵：
第2章 MATLAB数据 ·25·
zeros(3)
ans=
000
000
000
(2)建立一个3×2零矩阵：
zeros(3,2)
ans =
00
00
00
(3)设A为2×3矩阵，则可以用zeros(size(A))建立一个与矩阵A同样大小零矩阵：
A=[123;456];??生一个2×3阶矩阵A
zeros(size(A)) ??个与矩阵A同样大小的零矩阵
ans=
000
000
此外，常用的函数还有reshape(A,m,n),它在矩阵总元素保持不变的前提下，将矩阵A重新
排成m×n的二维矩阵。例如
xv=[23,45,65.34,65,34,98.45.78.65,43,76];
ym= reshape(xv,3,4)
yn=
??生有12个元素的行向量xv
?用向量xv建立3×4矩阵ym
23 34 98 65
45 4543 65
76 65 78 34
注意，在MATLAB中，矩阵元素按列存储，即首先存储矩阵的第一列元素，然后存储第二列元
素，…,一直到矩阵的最后一列元素。reshape 函数只是改变原矩阵的行数和列数，即改变其逻辑结
构，但并不改变原矩阵元素个数及它的存储结构。例如，再针对上面建立的矩阵ym,执行命令：
newym=reshape(ym,2,6)
则输出为：
newym=
2365 65 987843
45 34 34 45 6576
4.建立大矩阵
大矩阵可由方括号中的小矩阵建立起来。例如
A=[123;456;789];
C=[A,eye(size(A));ones(size(A)),A]
C=
2300 5 6 0 1 0
9 0
·26· 基 础 篇
111 123
1 1 1 4 56
1 1 1 7 89
2.3.2 冒号表达式
在MATLAB中，冒号是一个重要的运算符。利用它可以产生行向量。冒号表达式的一般格
式是：
el:e2:e3
其中el为初始值，e2为步长，e3为终止值。冒号表达式可产生一个由el开始到e3结束，以步
长e2自增的行向量。例如
1=0:1:5
将产生行向量t,各元素为0,1,2,3,4,5。
在冒号表达式中如果省略e2不写，则步长为1。例如，t=0:5与t=0:1:5等价。
在MATLAB中，还可以用linspace函数产生行向量。其调用格式为：
linspace(a,b,n)
其中a和b是生成向量的第一个和最后一个元素，n是元素总数。当n省略时，自动产生100个
元素。显然，linspace(a,b,n)与a:(b-a)/(n-1):b等价。
2.3.3 矩阵的拆分
1.矩阵元素
MATLAB允许用户对一个矩阵的单个元素进行赋值和操作。例如，如果想将矩阵A的第3
行第2列的元素赋为200,则可以通过下面语句来完成：
A(3,2)=200
这时将只改变该元素的值，而不影响其他元素的值。如果给出的行下标或列下标大于原来
矩阵的行数和列数，则MATLAB将自动扩展原来的矩阵，并将扩展后未赋值的矩阵元素置为0。
例如
A=[1,2,3;4,5,6];
A(4,5)=10
则输出为：
12300
4 5 6 0 0 00000
0 0010
在MATLAB中，也可以采用矩阵元素的序号来引用矩阵元素。矩阵元素按列编号，先第一
列，再第二列，依次类推。例如
A=[1,2,3;4,5,6];
A(3)
ans=
2
第2章 MATLAB数据 ·27
显然，序号(Index)与下标(Subscript)是一一对应的，以m×n矩阵A为例，矩阵元素A(i,j)
的序号为(j-1)*m+i。其相互转换关系也可利用sub2ind和ind2sub函数求得。
2.矩阵拆分
(1)利用冒号表达式获得子矩阵
①A(:,j)表示取A矩阵的第j列全部元素；A(i,:)表示A矩阵第；行的全部元素；A(i,j)表
示取A矩阵第i行、第j列的元素。
② A(i:i+m,:)表示取A矩阵第i~i+m行的全部元素；A(:,k:k+m)表示取 A矩阵第k
~k+m列的全部元素，A(i:i+m,k:k+m)表示取A矩阵第i~i+m行内，并在第k~k+m列
中的所有元素。例如
A=[1,2,3,4,5;6,7,8,9,10;11,12,13,14,15;16,17,18,19,20];
A(2:3,4:5)
an8=
910
1415
又如
A(2:3,1:2:5)
ans =
6810
111315
利用MATLAB的冒号运算，可以很容易地从给出的矩阵中获得子矩阵，这样处理的速度比后
面将介绍的利用循环语句来赋值的方式快得多，所以在实际编程时应该尽量采用这种赋值方法。
此外，还可利用一般向量和 end 运算符等来表示矩阵下标，从而获得子矩阵。end表示矩阵
某一维的末尾元素下标。例如
A=[1,2,3,4,5;6,7,8,9.10;11,12,13,14,15;16,17,18,19,20];
?A最后一行元素 A(end,:);
A([1,4],3:end) ?A第1.4两行中第3列到最后一列的元素
ans=
345
181920
(2)利用空矩阵删除矩阵的元素
在MATLAB中，定义[ ]为空矩阵。给变量X赋空矩阵的语句为X=[]。注意，X=[]与clear
X不同，clear是将X从工作空间中删除，而空矩阵则存在于工作空间，只是维数为0。
将某些元素从矩阵中删除，采用将其置为空矩阵的方法就是一种有效的方法。例如
A=[123456;7891011 12;1314 1516 17 18];
A(:.[24])=[]
其中第二条命令将删除A的第二列和第四列元素。输出为：
A=
1
7
13
3
9
15
5
1112
6
17 18
·28· 基 础 篇
2.3.4 多维矩阵
除了二维矩阵之外，MATLAB5.x还能处理三维或多维矩阵。三维矩阵的逻辑结构可以看作
由若干页二维矩阵所组成。通常，三维矩阵的第一维称为行，第二维称为列，第三维称为页。对
三维矩阵而言，无论哪一“页”上的“行，列”二维矩阵，其大小是相同的，同样，无论哪“行”上的
“列，页”二维矩阵，其大小也是相同的，无论哪一“列”上的“行，页”二维矩阵，其大小也是相同的。
三维以上矩阵的形象思维比较困难，下面主要介绍三维矩阵。
三维矩阵的建立以二维矩阵为基础，常用的方法有4种：
(1)对二维矩阵进行扩充得到三维矩阵。例如
a=[12,34,56,78;3,4,5,6]; ??立一个二维矩阵
??二维矩阵进行扩充 a(2,5,1)=100;
a(2,5,2)=100;
a(2,5,3)=100;
a ??示三维矩阵a
a(::,1)=
12 34 56 78 0
。
0000
0 0100 0 0
(2)若干个同样大小的二维矩阵进行组合得到三维矩阵。例如
clear?除全部内存变量
a=[12,34,56,78;3,4,5,6];
b(:,:,1)=a;
b(:,:,2)=a;
b(:,:,3)=a;
b
b(:,:,1)=
12 34 56 78
3678
3456
(3)除产生单位矩阵的 eye 函数外，前面介绍的建立矩阵的函数都可以延伸到三维矩阵。例
如
第2章 MATLAB数据 ·29·
ar= rand(2,4,3)
ar(:,:,1)=
0.6038 0.1988 0.7468 0.9318
0.2722 0.0153 0.44S1 0.4660
ar(:,:,2)=
0.4186 0.5252 0.6721 0.0196
0.8462 0.2026 0.8381 0.6813
ar(:,:,3)=
0.3795 0.5028 0.4289 0.1897
0.8318 0.7095 0.3046 0.1934
size(ar)
an8=
243
ndims(ar)
ans=
3
(4)用cat 函数构建多维矩阵。一般调用格式是：
cat(n,Al,A2,…,An)
cat函数把大小相同的若于矩阵，沿第 n维方向串接成高维矩阵。当n=1和2时，沿行和列
的方向串接，结果是二维矩阵。当n=3时，沿页的方向串接，结果是三维矩阵。例如
a=[-1,-3,-2;3,4,5];
b=cat(1,a,a#(-1),a*2) ??行的方向串接
b=
-1-3-2
4 3 5
3 1 2
-3 -4-5
-2 -6-4
6 810
c=cat(2,a,a+(-1),a+2)??列的方向串接
c=
25 -1 -2 1 3 -3
5 -4 3 4 -3
??页的方向串接 d=cat(3,a,a*(-1),a*2)
d(:,:,1)=
-1-3-2
345
d:.2)
2)
3-4-5 -3
d(:,:,3)=
·30· 基 础 篇
-2-6-4
6810
2.4 MATLAB运 算
2.4.1 算术运算
1.基本算术运算
MATLAB的基本算术运算有：+(加)、-(减)、*(乘)、(右除)、(左除)、(乘方)。这些算
术运算的运算规则不难理解，但必须注意，运算是在矩阵意义下进行的，单个数据的算术运算只
是一种特例。
(1)矩阵加减运算
假定有两个矩阵A和B,则可以由A+B和A-B实现矩阵的加减运算。运算规则是：若
A和B矩阵的维数相同，则可以执行矩阵的加减运算，A和B矩阵的相应元素相加减。如果A
与B的维数不相同，则MATLAB将给出错误信息，提示用户两个矩阵的维数不匹配。
一个标量也可以和其他不同维数的矩阵进行加减运算。例如
x=[2,-1,0;3,2,-4];
y=x-1
y=
1-2-1
2 1-5
(2)矩阵乘法
假定有两个矩阵A和B,若A为m×n矩阵，B为n×p矩阵，则C=A*B为m×p矩阵，
其各个元素为
=∑aa·b,i=1,2,…,m;j=1,2,…,p
例如
A=[1,2,3;4,5,6];B=[1,2;3,0;7,4];
C=A*B
C=
2814
6132
矩阵A和B进行乘法运算，要求A的列数与B的行数相等，此时则称A,B矩阵是可乘的，
或称A和B两矩阵维数相容。如果两者的维数不相容，则将给出错误信息，通知用户两个矩阵
是不可乘的。
在MATLAB中还可以进行矩阵和标量相乘，标量可以是乘数也可以是被乘数。矩阵和标量
相乘就是矩阵中的每个元素与此标量相乘。
(3)矩阵除法
第2章 MATLAB数据 ·31·
在MATLAB中有两种矩阵除法运算：\和/,分别表示左除和右除。如果A矩阵是非奇异方
阵，则A\B和B/A运算可以实现。A\B等效于A的逆左乘B矩阵，也就是inv(A)*B,而B/A
等效于A矩阵的逆右乘B矩阵，也就是B*inv(A)。
对于含有标量的运算，两种除法运算的结果相同，如3/4和4\3有相同的值，都等于0.75。
又如，设a=[10.5,25],则a/5=5\a=[2.1000 5.0000]。对于矩阵来说，左除和右除表示两种不
同的除数矩阵和被除数矩阵的关系。对于矩阵运算，一般A\B≠B/A。例如
a=[123;426;749];
b={4,3,2;7,5,1;12,7,92];
cl=a\b
c2=b/a
输出结果分别是：
cl=
0.5000-0.5000 44.5000
1.0000 0.0000 46.0000
0.5000 1.1667-44.8333
c2=
-0.1667 -3.3333 2.5000
-0.8333 -7.6667 5.5000
12.8333 63.6667 -36.5000
(4)矩阵的乘方
一个矩阵的乘方运算可以表示成A^x,要求A为方阵，x为标量。例如
A=[1,2,3;4,5,6;7,8,0];
A^2
ans=
308142 66
39
3615
5469
显然，A~2即A*A。
矩阵的开方运算是相当困难的，但有了计算机，这种运算就不再显得那么麻烦了，用户可以
利用计算机方便地求出一个矩阵的方根。例如
A=[1,2,3;4,5,6;7,8,0];
A~0.1
ans=
0.9750+0.2452i0.1254-0.0493i0.0059-0.0604i
0.2227-0.096Si 1.1276+0.1539i 0.0678-0.1249i
0.0324-0.1423i0.0811-0.1659i 1.1786+0.2500i
2.点运算
在MATLAB中，有一种特殊的运算，因为其运算符是在有关算术运算符前面加点，所以叫点
运算。点运算符有.*、/、.\和.^。两矩阵进行点运算是指它们的对应元素进行相关运算，要
求两矩阵的维参数相同。例如
·32· 基 础 篇
A=[1,2,3;4,5,6;7,8.9];
B=[-1,0,1;1,-1,0;0,1,1];
C=A.*B
C=
-103
4-50
0 89
A.*B表示A和B单个元素之间对应相乘。显然与A*B的结果不同。
如果A、B两矩阵具有相同的维数，则A./B表示A矩阵除以B矩阵的对应元素。B.A
等价于A./B。例如
x=[123];y=[456];
zl=x./y
2=y.Ix
输出分别是：
zl=
0.2500 0.4000 0.5000
22=
0.2500 0.4000 0.5000
显然x./y和y.Ax值相等。这与前面介绍的矩阵的左除、右除是不一样的。
若两个矩阵的维数一致，则A.^B表示两矩阵对应元素进行乘方运算，例如
x=[123];y=[456];
z=x.^y
z=
132729
指数可以是标量。例如
x={1 2 3];
z=x.2
2=
149
底也可以是标量。例如
x=[1 2 3];y=[4 56];
z=2.^[xy]
z=
248 16 32 64
点运算在MATLAB中起着很重要的作用，也是许多初学者容易弄混的一个问题。下面再举
一个例子进行说明。
当x=0.1,0.4,0.7,1时，分别求y= sin(x)cos(x)的值。命令应当写成
x=0.1:0.3:1;
y=sin(x).*cos(x);
其中求y的表达式中必须是点乘运算。运算过程是这样的：x是含有4个元素的向量，sin(x)也
第2章 MATLAB数据 ·33·
是含有4个元素的向量，各元素即对应x点的正弦函数值，同理cos(x)也是含有4个元素的向
量，各元素即对应x点的余弦函数值，需要求各x点对应的y=sin(x)cos(x),所以必须是sin(x)
与cos(x)对应元素做乘法运算，即点乘运算。当x只是一个点时，sin(x)和cos(x)均是标量，故
直接用乘法运算就可以了。
3.MATLAB常用数学函数
MATLAB提供了许多数学函数，函数的自变量规定为矩阵变量，运算法则是将函数逐项作用
于矩阵的元素上，因而运算的结果是一个与自变量同维数的矩阵。表2.3列出了一些常用数学
函数。
表2.3 常用数学函数
函数名 含义 函数名
正弦函数 exp
余弦函数 pow2
正切函数 abs
反正弦函数 angle
反余弦函数 real
反正切函数
双曲正弦函数
imag
双曲余弦函数
双曲正切函数
rem
反双曲正弦函数 fix
反双曲余弦函数 floor
反双曲正切函数 ceil
平方根函数 round
自然对数函数 sign
常用对数函数 ged
以2为底的对数函数 lcm
oj
mod
含 义
sin 自然指数函数
cos 2的幂
tan 绝对值函数
asin 复数的幅角
acos 复数的实部
atan
sinh
复数的虚部
复数共轭运算
cosh
tanh
求余数或模运算
模除求余
asinh 向零方向取整
acosh 不大于自变量的最大整数
atanh 不小于白变量的最小整数
sqt 四舍五人到最邻近的整数
log 符号函数
log10 最大公因子
log2 最小公倍数
函数使用说明：
(1)abs函数可以求实数的绝对值、复数的模、字符串的ASCII码值。
(2)用于取整的函数有 fix、floor、ceil、round,要注意它们的区别。round 函数作四舍五入用。
设a为正整数，则其余3个函数的区别可表示为图2.3。
设x=2.45,则fix(x)、floor(x)、ceil(x)、round(x)的结果分别是2,2,3,2。又设x=-2.65,则
fix(x)、floor(x)、ceil(x)、round(x)的结果分别是-2,-3,-2,-3。
(3)函数 rem与mod的区别。rem(x,y)和mod(x,y)都要求x,y必须为相同大小的实矩阵或
为标量。当y≠0时，rem(x,y)=x-y.*fix(x./y),而mod(x,y)=x-y.*floor(x./y),当y=0
·34 基 础 篇
floor(x) fix(x)、ceil(x) fix(x),floor(x)ceil(x)
-(a+1) x -a 0 ax a+
图2.3 取整函数的区别
时，rem(x,0)=NaN,而mod(x,0)=x。显然，当x,y同号时，rem(x,y)与mod(x,y)相等。rem(x,y)
的符号与x相同，而mod(x,y)的符号与y相同。设x=5,y=3,则rem(x,y)和 mod(x,y)的结果
都是2。又设x=-5,y=3,则rem(x,y)和 mod(x,y)的结果分别是-2和1。
2.4.2 关系运算
MATLAB提供了6种关系运算符：<(小于)、<=(小于或等于)、>(大于)、>=(大于或等
于)、==〈等于)、~=(不等于)。它们的含义不难理解，但要注意其书写方法与数学中的不等式
符号不尽相同。
关系运算符的运算法则为：
(1)当两个比较量是标量时，直接比较两数的大小。若关系成立，关系表达式结果为1,否则
为0。
(2)当参与比较的量是两个维数相同的矩阵时，比较是对两矩阵相同位置的元素按标量关
系运算规则逐个进行，并给出元素比较结果。最终的关系运算结果是一个维数与原矩阵相同的
矩阵，它的元素由0或1组成。
(3)当参与比较的一个是标量，而另一个是矩阵时，则把标量与矩阵的每一个元素按标量关
系运算规则逐个比较，并给出元素比较结果。最终的运算结果是一个维数与矩阵相同的矩阵，它
的元素由0或1组成。
例2.4 产生5阶随机方阵A,其元素为[10,90]区间的随机整数，然后判断A的元素是否能
被3整除。
(1)生成5阶随机方阵A,命令和运行结果如下：
A=fix((90-F0+1)*rand(5)+10)
A=
24 35 13 2263
23 39 47 8080
41 90 80 2910
45 57 85 6221
37 19 31 8876
(2)判断A的元素是否可以被3整除，命令和运行结果如下：
P= rem(A,3)==0
P= 10001
0 1 0 0 0
10000
第2章 MATLAB数据 ·35·
11001
00000
其中，rem(A,3)是矩阵A的每个元素除以3的余数矩阵。此时，0被扩展为与A同维数的零矩
阵，P是进行==比较的结果矩阵。
2.4.3 逻鹤运算
MATLAB提供了3种逻辑运算符：&(与)、I(或)和～(非)。
运算法则为：
(1)在逻辑运算中，确认非零元素为真，用1表示，零元素为假，用0表示。
(2)设参与逻辑运算的是两个标量 a和b,那么
a&b a,b全为非零时，运算结果为1,否则为0。
alb a,b中只要有一个非零，运算结果为1。
~a 当a是零时，运算结果为1;当a非零时，运算结果为0。
(3)若参与逻辑运算的是两个同维矩阵，那么运算将对矩阵相同位置上的元素按标量规则
逐个进行。最终运算结果是一个与原矩阵同维的矩阵，其元素由1或0组成。
(4)若参与逻辑运算的一个是标量，一个是矩阵，那么运算将在标量与矩阵中的每个元素之
间按标量规则逐个进行。最终运算结果是一个与矩阵同维的矩阵，其元素由1或0组成。
(5)逻辑非是单目运算符，也服从矩阵运算规则。
(6)在算术、关系、逻辑运算中，算术运算优先级最高，逻辑运算优先级最低。
例2.5 在[0,3π]区间，求y=sin(x)的值。要求：
(1)消去负半波，即(π,2π)区间内的函数值置0。
(2)(3,)和(3,3)区间内取值均为：sin3。
先根据自变量向量x产生函数值向量y,然后按要求对y进行处理。处理的思路有两个：一
是从自变量着手进行处理，二是从函数值着手进行处理。
方法1:
x=0:pi/100:3* pi;y=sin(x);
??去负半波 yl=(x<pilx>2*pi).*y;
q=(x>pi/3&x<2*pi/3)I(x>7*pi/3&x<8*pi/3);
qn=~q;
y2=q*sin(pi/3)+qn.*y1; ??要求处理第(2)步
方法2:
x=0:pi/100:3*pi;y=sio(x);
??去负半波 yl=(y>=0),*y;
p=sin(pi/3);
y2=(y>=p)*p+(y<p),*yl;??要求处理第(2)步
此例说明，由于MATLAB以0或1表示关系运算和逻辑运算的结果，所以巧妙利用关系运算
和逻辑运算能对函数值进行分段处理，即不需条件判断就能求分段函数的值。以本题的处理结
果作为绘图数据，可以得到削顶的正弦半波曲线。
·36· 基 础 篇
此外，MATLAB还提供了一些关系与逻辑运算函数，表2.4列出常用的几个。
表2.4 关系与逻辑运算函数
函数名 含义
all 若向量的所有元素非零，则结果为1
anty 向量中任何一个元素非零，都给出结果1
exist 检查变量在工作空间是否存在，若存在，则结果为1,否则为0
find 找出向量或矩阵中非零元素的位置
isempty 若被查变量是空阵，则结果为1
isglobal 若被查变量是全局变量，则结果为1
isinf 若元素是±inf,则结果矩阵相应位置元素取1,否则取0
isnan 若元素是nan,则结果矩阵相应位置元素取1,否则取0
isfinite 若元素值大小有限，则结果矩阵相应位置元素取1,否则取0
issparse 若变量是稀疏矩阵，则结果矩阵相应位置元素取1,否则取0
isstr 若变量是字符串，则结果矩阵相应位置元素取1,否则取0
xor 若两矩阵对应元素同为0或非0,则结果矩阵相应位置元素取0,否则取1
2.5 字 符 串
在MATLAB语言中，字符串是用单撇号括起来的字符序列。例如
xm='Central South University'
输出结果是：
xm=
Ceniral South University
MATLAB将字符串当作一个行向量，每个元素对应一个字符，其标识方法和数值向量相同。
也可以建立多行字符串矩阵。例如
ch=['abedef';'123456'];
这里要求各行字符数要相等。为此，有时不得不用空格来调节各行的长度，使它们彼此相等。
字符串是以ASCII码形式存储的。abs和 double函数都可以用来获取字符串矩阵所对应的
ASCII码数值矩阵。相反，char函数可以把ASCII码矩阵转换为字符串矩阵。
例2.6 建立一个字符串向量，然后对该向量做如下处理：
(1)取第1~5个字符组成的子字符串。
(2)将字符串倒过来重新排列。
(3)将字符串中的小写字母变成相应的大写字母，其余字符不变。
(4)统计字符串中小写字母的个数。
第2章 MATLAB数据
命令及运行结果如下：
ch='ABc123d4e56Fg9';
subch=ch(1:5) ?子字符串
subch=
ABc12
revch=ch(end:-1:1) ??字符串倒排
revch =
9gF65e4d321cBA
k=find(ch>='a'&ch<='z'); ??小写字母的位置
ch(k)=ch(k)-('a'-'A'); ??小写字母变成相应的大写宇母
char(ch)
ans=
ABC123D4E56FG9
length(k) ??计小写字母的个数
ans=
4
与字符串有关的另一个重要函数是eval,其调用格式为：
eval(t)
其中：为字符串。它的作用是把字符串的内容作为对应的MATLAB语句来执行。例如
t=pi;
m='[t,sin(t),cos(t)]';
y=eval(m)
y=
3.1416 0.0000-1.0000
MATLAB还有许多与字符串处理有关的函数，表2.5列出几个常用的函数。
表2.5 字符串处理函数
函数名 含义 函数名
将ASCI码值转换成宇符
将矩阵转换成字符串
将数值转换成字符串
将整数转换成字符串
st2num
strcat
strcmp
含义
setstr 将字符串转换成数值
mat2str 用于字符串的连接
num2str 用于字符串的比较
in(2str
关于字符串的写法，还要注意两点：
(1)若字符串中的字符含有单撇号，则该单撇号字符应用两个单撇号来表示。例如
disp('I"m a teacher.')
将输出：
I'm a teacher.
(2)对于较长的字符串可以用字符串向量表示，即用[]括起来。例如
f=70;
·37·
·38· 基 础 篇
c=(f-32)/1.8;
disp([' Room temperature is',mum2str(e),degrees C.*])
其中disp 函数的自变量是一个长字符串。输出为：
Room temperature is 21.11 degrees C.
2.6 结构和单元
2.6.1 结构数据
MATLAB通过使用结构(Structure)数据类型把一组不同类型的数据同时又是在逻辑上相关
的数据组成一个有机的整体，以便于管理和引用。比如要存储学生基本情况数据就可采用结构
数据。
1.结构矩阵的建立与引用
结构矩阵的元素可以是不同的数据类型，它能将一组具有不同属性的数据纳人到一个统一
的变量名下进行管理。建立一个结构矩阵可采用给结构成员赋值的办法。具体格式为：
结构矩阵名.成员名=表达式
其中表达式应理解为矩阵表达式。例如，建立含有3个元素的结构矩阵a
a(1).xl=10;a(1).x2='lio';a(1).x3=[11,21;34,78];
a(2).xl=12;a(2),x2='wang';a(2).x3=[34,191;27,578];
a(3).xl=14;a(3).x2='cai';a(3).x3=[13,890:67,231];
结构矩阵元素的成员也可以是结构数据。例如
a(2).x1.xll=90;a(2).xl.x12=12;a(2).x1.x13=30;
以上建立的结构矩阵a含有3个元素，每个元素又含有3个成员，成员a(2).x1又是含有3
个成员的结构数据。对结构数据的引用，可以引用其成员，也可以引用结构矩阵的元素或结构变
量。例如
a(2).x3 ??用矩阵元素a(2)的成员x3
ans=
34191
27578
a(2)??用矩阵元素a(2)
ans=
x1:[1xl struct]
x2:' wang
x3:[2x2 double]
8 ??用结构矩阵a
a=
1x3 struct array with fields:
x1
x2
第2章 MATLAB数据 ·39·
x3
引用结构矩阵元素的成员时，显示其值。引用结构矩阵元素时，显示成员名和它的值，但成
员是矩阵时，不显示其具体内容，只显示成员矩阵大小参数。引用结构矩阵时，只显示结构矩阵
的大小参数和成员名。
2.结构成员的修改
可以根据需要增加或删除结构的成员。例如要给结构矩阵a增加一个成员x4,可给a中任
意一个元素增加成员x4
a(1).x4='410075';
但其他成员均为空矩阵，可以使用赋值语句给它赋确定的值。
要删除结构的成员，则可以使用rmfield 函数来完成。例如，删除成员x4
a=nmfield(a,'x4');
3.关于结构的函数
关于结构的函数见表2.6。
表2.6 关于结构的函数
函数名 含义 函数名
建立或转换为结构矩阵
获取结构成员的内容
删除结构成员
是结构时，值为真
fieldnames
setfield
isfield
含 义
struct 获取结构成员名
getfield 设定结构成员的内容
mfield 成员在结构中时，值为真
isstruct
2.6.2 单元数据
单元(Cell)数据的概念与结构有些类似，也是把不同属性的数据放在一个变量中。所不同的
是，结构变量的各个元素下有成员，每个成员都有自己的名字，对成员的引用是：结构变量名.成
员名。而单元矩阵的各个元素就是不同类型的数据，用带有大括号下标的形式引用单元矩阵元
素。
1.单元矩阵的建立与引用
建立单元矩阵和一般矩阵相似，只是矩阵元素用大括号括起来。如建立单元矩阵b
b=110,' liu',[11,21;34,78];12,' wang',[34,191;27,578];14,'cai',[13,890;67,231]
b=
[10] 'liu[2x2 double]
[12} 'wang+ [2x2 double]
[14] cai'[[2x2 double]
可以用带有大括号下标的形式引用单元矩阵元素。例如b13,3|。单元矩阵的元素可以是
结构或单元数据。例如，先建立结构变量y,给上面建立的单元矩阵b的元素b{3,4}赋值：
y.xl=34;y.x2=56;
b13,4|=y;
可以使用 elldisp函数来显示整个单元矩阵。如celdisp(b)。还可以删除单元矩阵中的某个
·40· 基 础 篇
元素。如删除b的第3个元素
b(3)=[]
b=
Columns 1 through 7
[10]][121 liu' wangcai [2x2 double] [2x2 double]
Columns 8 through 11
[2x2 double! [][] [1xi structj
单元矩阵b的第3个元素被删除后，b变成行向量。注意，这里是b(3),而不是b31。b|31
=[]是将b的第3个元素置为空矩阵，而不是删除它。
2.关于单元的函数
关于单元的函数见表2.7。
表2.7 关于单元的函数
函数名 作用 函数名
显示单元矩阵内容
把数字矩阵转换为单元矩阵
把单元矩阵转换为结构矩阵
是单元矩阵时，值为真
cellplot
deal
struc2cell
celldisp
num2cell
cell2struct
iscell
习 题 二
1、如何理解“矩阵是MATLAB最基本的数据对象”?
2.设A和B是两个同维同大小的矩阵，问：
(1)A*B和A.*B的值是否相等?
(2)A./B和B.\A的值是否相等?
(3)A/B和B\A的值是否相等?
(4)A/B和BA所代表的数学含义是什么?
3.写出完成下列操作的命令。
(1)建立3阶单位矩阵A。
(2)建立5×6随机矩阵A,其元素为[100,200]范围内的随机整数。
(3)将矩阵A第2~5行中第1,3,5列元素赋给矩阵B。
(4)删除矩阵A的第7号元素。
(5)将矩阵A的每个元素值加30。
(6)求矩阵A的大小和维数。
(7)将向量t的0元素用机器零来代替。
(8)将含有12个元素的向量x转换成3×4矩阵。
(9)求一个字符串的ASCI码。
(F0)求一个ASCI码所对应的字符。
作用
显示单元矩阵的图形描述
把输入分配给输出
把结构矩阵转换为单元矩阵
第2章 MATLAB数据 ·41·
4.当x=[-5,7.15,3],y=[3,-4,5,0]时，试分析 rem(x.y)和mod(x,y)的执行结果。
5.下列命令执行后，LI,L2,13,L4的值分别是多少?
A=1:9;B=10-A;
LI=A==B;
L2=A<=5;
L3=A>3&A<7;
14=find(A>3&A<7);
6.当A=[34,NaN,Inf,-Inf,-pi,eps,0]时，分析下列函数的执行结果：ak(A),any(A),isnan(A),isinf(A),
isfinite(A)。
7.用结构矩阵来存储5名学生的基本情况数据，每名学生的数据包括学号、姓名、专业和6门课程的成绩。
8.建立单元矩阵B并回答有关问题。
B|1,1|=1;
B|1,2|='Brenden';
B|2,1zreshape(1:9,3,3);
B|2,21=|12,34,2;54,21,3;4,23,67|;
(1)size(B)和ndims(B)的值分别是多少?
(2)B(2)和B(4)的值分别是多少?
(3)B(3)=[ ]和B|3|=[ ]执行后，B的值分别是多少?
第3章 MATLAB程序设计
MATLAB命令有两种执行方式：一种是交互式的命令执行方式，另一种是M文件的程序执行
方式。在命令执行方式下，用户在命令窗口逐条输入命令，MATLAB逐条解释执行。这种方式虽
然操作简单、直观，但速度慢，执行过程不能保留。当某些操作需反复进行时，更使人感到单调厌
烦。在程序执行方式下，用户将有关命令编成程序存储在一个文件中(称为M文件),当运行该
程序后，MATLAB就会白动依次执行该文件中的命令，直至全部命令执行完毕。以后需要这些命
令时，只需再次运行该程序。可见，程序执行方式大大减少了用户的重复劳动，成为实际应用中
的重要执行方式。
本章介绍M文件、数据的输人输出和有关控制语句，在此基础上，再介绍MATLAB程序设计
的基本方法。
3.1 M 文 件
3.1.1 M文件的建立与编辑
M文件是一个文本文件，它可以用任何编辑程序来建立和编辑，而一般常用且最为方便的是
使用MATLAB提供的文本编辑器。
1.建立新的M文件
为建立新的M文件，启动MATLAB文本编辑器有3种方法：
(1)菜单操作。从MATLAB命令窗口的File菜单中选择New菜单项，再选择M-file命令，
屏幕将出现MATLAB Editor/Debugger窗口(如图3.1所示)。MATLAB Editor/Debugger是一个集编
辑与调试两种功能于一体的工具环境。利用它不仅可以完成基本的文本编辑操作，还可以对M
文件进行调试。MATIAB文本编辑器的操作界面与使用方法和其他 Windows编辑器相似，这里
不作详细介绍。
启动MATLAB文本编辑器后，在文档窗口中输入M文件的内容，输入完毕后，选择文本编辑
器窗口 File菜单的Save或Save As命令存盘。注意，M文件存放的位置一般是MATLAB缺省的用
户工作日录c:\matlabrl1 \work,当然也可以是别的目录。如果是别的目录，则应该将该目录设定
为当前目录或将其加到搜索路径中。
(2)命令操作。在MATLAB命令窗口输人命令edit,启动MATLAB文本编辑器后，输入M文
件的内容并存盘。
(3)命令按钮操作。单击MATLAB命令窗口工具栏上的新建命令按钮，启动MATLAB文本
编辑器后，输入M文件的内容并存盘。
第3章 MATLAB程序设计 +43
MATLB Etm/DetugsuC 1uATLAN1sYn司 F回区
A lLit Vie lelur Zodle fiod tpalp 同×
口 e母?
国咱咱稻Stacke
clesr
x3;0.1:3
Tor 1=1:1ength(x1
r x(1)>0
2(3)=x(i)=x)+(1+x(i))*(I/4)+52
elzeif x(1)=-0
国
团]Fenm-cDittmE475m
lin a通
图3.1 MATLAB Edir/Debagger聚口
2.编辑已有的M文件
编辑已有的M文件，也有3种方法：
(1)菜单操作。从MATLAB命令窗口的FHle菜单中选择Open M-6le命令，则屏幕出现Open
对话框，在Open对话框中选中所需打开的M文件。在文档窗口可以对打开的M文件进行编辑
修改。编辑完成后，将M文件存盘。
(2)命令操作。在MATLAB命令窗口输入命令：dit文件名，则打开指定的M文件。
(3)命令按钮操作。单击MATLAB命令窗口工具栏上的打开命令按钮，再从弹出的对话框
中选择所需打开的M文件。
3.1.2 M文件的分类
M文件有两类：命令文件(Senpt File)和函数文件(Function Fle)。它们的扩展名均为，m.主
要区别在于：
(1)命令文件没有输人参数，也不返回输出参数，而函数文件可以带输入参数，也可返回输
出参数。
(2)命令文件对MATLAB工作空间中的变量进行操作，文件中所有命令的执行结果也完全
返回到工作空间中，而函数文件中定义的变量为局部变量，当函数文件执行完毕时，这些变量被
清除。
(3)命令文件可以直接运行，在MATAB命令窗口输入命令文件的名字，就会顺序执行命令
文件中的命令，而函数文件不能直接运行，而要以函数调用的方式来调用它。
例3.1 建立一个命令文件将变量a,b的值互换，然后运行该命令文件。
首先建立命令文件并以文件名 exch.m存盘
clesr;
·44· 基 础 篇
a=1:10;b=[11,12,13,14;15,16.17,18];
c=a;a=b;b=c;
a
b
然后在MATLAB的命令窗口中输入 exch,将会执行该命令文件，输出为：
a=
11 1314 12
15 161718
b=
1 2 678910
调用该命令文件时，不用输入参数，也没有输出参数，文件自身建立需要的变量。当文件执
行完毕后，可以用命令whos查看工作空间中的变量。这时会发现a,b,c仍然保留在工作空间
中。
例3.2 建立一个函数文件将变量a,b的值互换，然后在命令窗口调用该函数文件。
首先建立函数文件fexch.m
functiun[a,b]=exch(a,b)
c=a;a=b;b=c;
然后在MATLAB的命令窗口调用该函数文件
clear;
x=1:10;y=[11,12,13,14;15,16,17,18];
[x,y]=fexch(x,y)
输出为：
x=
11 12 13 14
15 16 17 18
y=
3 1 2 45678910
调用该函数文件时，既有输入参数，又有输出参数。当函数调用完毕后，可以用命令 whos查
看工作空间中的变量。这时会发现a,b,c未被保留在工作空间中。
3.2 数据的输入输出
MATLAB的输人输出方式包括从命令窗口的输入输出以及通过文件操作的输入输出。此
外，为了顺应现代软件开发技术的潮流，MATLAB还提供图形界面的输入输出方式。本节先介绍
命令窗口的输入输出，关于文件操作和图形界面设计分别在3.7节和第7章介绍。
3.2.1 input 画数
MATLAB提供了一些输入输出函数，允许用户和计算机之间进行数据交换。如果用户想从
键盘输入数据，则可以使用input 函数来进行，该函数的调用格式为：
第3章 MATLAB程序设计 ·45·
A= input(提示信息，选项);
其中提示信息为一个字符串，用于提示用户输人什么样的数据。例如，从键盘输人A矩阵，可以
采用下面的命令来完成：
A=input('输入A矩阵：');
执行该语句时，首先在屏幕上显示提示信息“输入A矩阵：”,然后等待用户从键盘按MATLAB规
定的格式输人A矩阵的值。
如果在input 函数调用时采用's'选项，则允许用户输人一个字符串。例如，想输人一个人的
姓名，可采用命令：
xm= input('What" s your name?','s+)
3.2.2 disp 画数
MATLAB提供的命令窗口输出函数主要有disp 函数，其调用格式为：
disp(输出项)
其中输出项既可以为字符串，也可以为矩阵。例如
A='Hello,Brenden';
disp(A)
输出为：
Hello,Brenden
又如
A=[1,2,3;4,5,6;7,8,9];
disp(A)
输出为：
123
456
789
注意，和前面介绍的矩阵显示方式不同，用disp 函数显示矩阵时将不显示矩阵的名字，而且
其格式更紧密，且不留任何没有意义的空行。
例3.3 求一元二次方程ax2+bx+c=0的根。
由于MATLAB能进行复数运算，所以不需要进行判别式的判断。程序如下：
a=input('a=?');
b=input('b=?');
c= input('c=?);
d=b*b-4*A*c;
x=[(-b+sqrt(d))/(2*a),(-b-sqn(d))/(2*a)];
disp(['xl=',num2str(x(1)),',x2=',num2str(x(2))]);
第一次运行：
a=?5
b=?67
c=?34
x1=-0.52829,x2=-12.8717
·46· 基 础 篇
第二次运行：
a=?34
b=?23
c=?45
xl=-0.33824+1.0996i,x2=-0.33824-1.0996i
3.2.3 pause 函数
当程序运行时，为了查看程序的中间结果或者观看输出的图形，有时需要暂停程序的执行。
这时可以使用pause函数，其调用格式为：
pause(延迟秒数)
如果省略延迟时间，直接使用 pause,则将暂停程序，直到用户按任一键后程序继续执行。
若要强行中止程序的运行可使用Ctrl+C命令。
3.3 选 择 结 构
选择结构是根据给定的条件成立或不成立，分别执行不同的语句。MATLAB用于实现选择
结构的语句有迁语句、switch语句和try 语句。
3.3.1 if语句
在MATLAB中，if语句有3种格式。
1.单分支it语句
语句格式为：
if 条件
语句组
end
当条件成立时，则执行语句组，执行完之后继续执行if语句的后继语句，若条件不成立，则直
接执行 if语句的后继语句。例如，当x是整数矩阵时，输出x的值。语句如下：
if fix(x)==x
disp(x);
end
2.双分支if语句
语句格式为：
if 条件
语句组1
else
语句组2
end
第3章 MATLAB程序设计 ·47·
当条件成立时，执行语句组1,否则执行语句组2,语句组1或语句组2执行后，再执行 if语
句的后继语句。
例3.4 计算分段函数
ax=10
x≠10
程序如下：
x=input('请输入x的值：');
ifx==10
y=cos(x+1)+sart(x*x+1);
else
y=x*eqt(x+8qt(x));
end
y
也可以用单分支if语句来实现：
x=input('请输人x的值：');
y=coB(x+1)+sqt(x*x+1);
if x~=10
y=x*sqrt(x+sgt(x));
end
y
或用以下程序：
x=inpur('请输入x的值：‘);
ifx==10
y= cus(x+1)+sqt(x*x+1);
end
ifx～=10
y=x*sqrt(x+sqrt(x));
end
y
3.多分支if语句
语句格式为：
if 条件1
语句组1
elseif 条件2
语句组2
…
elseif 条件m
语句组m
else
语句组m+1
·48· 基 础 篇
end
语句执行过程如图3.2所示，可用于实现多分支选择结构。
条件1 不成立
成立 条件2 不成立
成立 条件m 不成立
成立[
语句组1
图3.2 多分支if语句的执行过程
例3.5 输入一个字符，若为大写字母，则输出其后继字符，若为小写字母，则输出其前导字
符，若为数字字符则输出其对应的数值，若为其他字符则原样输出。
关于字符的处理，用abs或 double函数可得到一个字符的ASCII码，用char和setstr函数可得
到ASCII码对应的字符。程序如下：
c= ioput('请输入一个字符','s');
ifc>='A'&c<='Z'
disp(setstr(abs(c)+1));
elseif c>='a'&c<='z
disp(setstr(abs(c)-1));
elseif c>='0'&c<='9'
disp(abs(c)-abs('0'));
eise
disp(c);
end
3.3.2 switch 语句
switch 语句根据表达式的取值不同，分别执行不同的语句。其语句格式为：
switch 表达式
case 表达式1
语句组1
case 表达式2
语句组2
case 表达式m
语句组2 语句组m 语句组m+1
第3章 MATLAB程序设计 ·49·
语句组m
otherwise
语句组m+1
end
switch语句的执行过程如图3.3所示。当表达式的值等于表达式1的值时，执行语句组1,
当表达式的值等于表达式2的值时，执行语句组2,…,当表达式的值等于表达式m的值时，执行
语句组m,当表达式的值不等于case所列的表达式的值时， 求表达式的值K
执行语句组m+1。当任一分支的语句执行完后，直接执行
switch语句的下一句。
switch于句后面的表达式应为一个标量或一个字符串，
case子句后面的表达式不仅可以为一个标量或一个字符串，
而且还可以为一个单元矩阵。如果case子句后面的表达式
为一个单元矩阵，则表达式的值等于该单元矩阵中的某个元
素时，执行相应的语句组。
例3.6 某商场对顾客所购买的商品实行打折销售，标
准如下(商品价格用price来表示):
price<200
200≤price<500
500≤price<1000
1000≤price<2500
2500≤price<5000
5000≤price
没有折扣
3??扣
5??扣
8??扣
10??扣
14??扣
求所售商品的实际销售价格。
程序如下：
price= input('请输入商品价格');
switch fix(price/100)
case 10,1
rate=0;
case {2,3,4
rate=3/100;
case num2cell(5:9)
rate=5/100;
case num2cel(10:24)
rate=8/100;
case mum2cell(25:49)
rate=10/100;
otherwise
rate=14/100;
end
price= price*(1-rate)
K=值l? 是
否，
K=值2? 是
否
K=值m? 是
否
语句组m+1
switch语句的下一句
图3.3 switch语句的执行过程
语句组上
语句组2
语句组m
·50· 基 础 篇
3.3.3 try 语句
MATLAB从5.2版开始提供了try 语句，这是一种试探性执行语句。语句格式为：
try
语句组1
catch
语句组2
end
try 语句先试探性执行语句组1,如果语句组1在执行过程中出现错误，则将错误信息赋给保
留的lasterr变量，并转去执行语句组2。这种试探性执行语句是其他高级语言所没有的。
例3.7 矩阵乘法运算要求两矩阵的维数相容，否则会出错。先求两矩阵的乘积，若出错，
则自动转去求两矩阵的点乘。
程序如下：
A=[1,2,3;4,5,6];B=[7,8,9;10,11,12];
try
C=A*B;
catch
C=A.*B;
end
C
lasterr ??示出错原因
输出结果为：
C=
71627
405572
ans=
Error using ==>
Inner matrixdimensions must agree.
3.4 循环 结 构
循环是指按照给定的条件，重复执行指定的语句，这是十分重要的一种程序结构。MATLAB
提供了两种实现循环结构的语句：for语句和while语句。
3.4.1 for语旬
语句格式为：
for 循环变量=表达式1:表达式2:表达式3
循环体语句
第3章 MATLAB程序设计 ·51·
end
其中表达式1的值为循环变量的初值，表达式2的值为步长，表达式3的值为循环变量的终值。
步长为1时，表达式2可以省略。
for语句的执行过程如图3.4所示。首先计算3个表达式的值，再将表达式1的值赋给循环
变量，如果此时循环变量的值介于表达式1和表达式3的值之间，则执行循环体语句，否则结束
循环的执行。执行完一次循环之后，循环变量自增一个表达式2 分别求3个表达式的值
的值，然后再判断循环变量的值是否介于表达式1和表达式3
之间，如果满足，仍然执行循环体，直至不满足为止。这时将结
表达式1的值赋给循环变量i
束for语句的执行，而继续执行 for语句后面的语句。
y=1+立+3+…+ 例3.8 已知， ,当 n=100时，求
y的值。 在初值和终值之间? 否
程序如下： 是
y=0;n=100;
for i=1:n
y=y+1/i/i;
end
y
在实际MATLAB编程中，为提高程序的执行速度，常用向
量运算来代替循环操作，所以上述程序通常由下面的程序来代
替： 图3.4 for语句执行过程
n=100;i=1:n;
F=1./i.2;
y=sum(f)
在这一程序中，首先生成一个向量i,然后用i生成向量f,f各元素值即对应于y的各累加
项，再用MATLAB提供的sum函数求f各个元素之和。如果程序中的 n值由100改成10000,再
分别运行这两个程序，则可以明显地看出，后一种方法编写的程序比前一种方法快得多。
例3.9 设，f(x)=e-05sn(x+若),求s=j。f(x)dx。
求函数f(x)在[a,b]上的定积分，其几何意义就是求曲线y=f(x)与直线x=a,x=b,y=
0所围成的曲边梯形的面积。为了求得曲边梯形面积，先将积分区间[a,b]分成n等分，每个区
间的宽度为h=(b-a)/n,对应地将曲边梯形分成n等分，每个小部分即是一个小曲边梯形。
近似求出每个小曲边梯形面积，然后将n个小曲边梯形的面积加起来，就得到总面积，即定积分
的近似值。近似地求每个小曲边梯形的面积，常用的方法有：矩形法、梯形法以及辛普生法等。
以梯形法为例，程序如下：
a=0;b=3*pi;n=1000;b=(b-a)/n;
x=a;s=0;f0=exp(-0.5*x)*sin(x+pi/6);
for i=1:n
x=x+h;
1=exp(-0.5*x)*sin(x+pi/6);
循环体语句
增加1个步长
·52· 基 础 篇
s=s+(f0+f)*h/2;
f0=fl;
end
S
上述程序来源于传统的编程思想。也可以利用向量运算，从而使得程序更加简洁，更赋有
MATLAB的特点。程序如下：
a=0;b=3*pi;n=1000;h=(b-a)/n;
x=a:h:b;f=exp(-0.5*x),*sin(x+pi/6);
fori=1:n
s(i)=(f(i)+f(i+1))=h/2;
end
S=sum(s)
程序中x,f,s均为向量，f的元素为各个x点的函数值，s的元素分别为n个梯形的面积，s
各元素之和即定积分近似值(s=0.9008)。
事实上，MATLAB提供了有关数值积分的标准函数，实际应用中可直接调用这些函数求数值
积分，这些内容将在第5章介绍。
在上述例子中，for 语句的循环变量都是标量，这与其他高级语言的相关循环语句(如 FOR TRAN语言中的DO语句，C语言中的 for语句等)等价。按照MATLAB的定义，for语句的循环变
量可以是一个列向量。for语句更一般的格式为：
for 循环变量=矩阵表达式
循环体语句
end
执行过程是依次将矩阵的各列元素赋给循环变量，然后执行循环体语句，直至各列元素处理
完毕。实际上，“表达式1:表达式2:表达式3”是一个仅为一行的矩阵(行向量),因而列向量是单
个数据。所以本节一开始给出的for语句格式是一种特例。
例3.10 已知5个学生4门功课的成绩，求每名学生的总成绩。
程序如下：
s=0;
a=[65,76,56,78;98,83,74,85;76,67,78,79;98,58,42,73;67,89,76,87];
for k=a
8=8+k;
end
disp(s');
程序的最后一行用到了矩阵转置运算符，这里是将列向量转置为行向量。
3.4.2 while 语句
while语句的一般格式为：
wbile(条件)
循环体语句
end
第3章 MATLAB程序设计 ·53·
其执行过程为：若条件成立，则执行循环体语句，执行后再判断条件是否成立，如果不成立则
跳出循环(如图3.5所示)
例3.11 根据矩阵指数的幂级数展开式求矩阵指数函数值。
E*=1+x+++…++… 条件 不成立
程序中，设X是给定的矩阵，E是矩阵指数函数值，F是展开式 成立
循环体语句 的项，n是项数，循环一直进行到F很小，以至于F值加在E上对E
的值影响不大时为止。为了判断F是否很小，可利用矩阵范数的概
mx △|a, 念。矩阵A的范数的一种定义是： ,在MATLAB中用
norm(A,1)函数来计算。所以当norm(F,1)=0时，认为F很小，应 图3.5 while语句执行过程
退出循环的执行。程序如下：
X=input('X=');
E=zeros(size(X));
F=eye(size(X));
n=1;
while norm(F,1)>0
E=E+F;
F=F*X/n;
n=n+1;
end
E
expm(X) ??用MATLAB矩阵指数函数求矩阵指数函数值
程序运行时，若从键盘输入X的值：[0.5,2,0;1,-1,-0.5;0.9,1,0.75],则程序输出结果
为：
E=
2.6126 2.0579 -0.6376
0.74200.7504 -0.5942
2.5678 2.3359 1.5549
ans =
2.6126 2.0579 -0.6376
0.7420 0.7504 -0.5942
2.5678 2.3359 1.5549
运行结果表明，程序运行结果与MAT.AB矩阵指数函数 expm(X)的结果一致。本程序涉及
到矩阵运算，初学者可能不太习惯。如能分析一下程序的执行过程，对领会编程思想是有益的。
另外，我们知道矩阵乘法的交换律不成立，但这里要请读者分析一下程序中的语句F=F*X/n
可否写成F=X*F/n,为什么?
与循环结构相关的还有一个break 语句，当在循环体内执行到该语句时，程序将跳出循环。
该语句一般与 if语句配合使用。
例3.12 用while语句实现例3.8。
·54· 基 础 篇
程序如下：
y=0;i=1;
wbile 1
f=1/i/i;
y=y+f;
ifix=100
break;
end
i=i+1;
end
y
在程序中，循环的条件为1,即循环条件总是满足的，这是一个永真循环。为了使循环能正
常结束，在循环体中加了一个if语句，当i等于100时，执行 break 命令，从而跳出for循环。
3.4.3 循环的嵌套
如果一个循环结构的循环体又包括一个循环结构，就称为循环的嵌套，或称为多重循环结
构。实现多重循环结构仍用前面介绍的3种循环语句。因为任一循环语句的循环体部分都可以
包含另一个循环语句，这种循环语句的嵌套为实现多重循环提供了方便。
多重循环的嵌套层数可以是任意的。可以按照嵌套层数，分别叫做二重循环、三重循环等。
处于内部的循环叫作内循环，处于外部的循环叫作外循环。
在设计多重循环时，要特别注意内、外循环之间的关系，以及各语句放置的位置，不要搞错。
例3.13 用筛选法求某正整数范围内的全部素数。
素数是大于1且除了1和它本身以外不能被其他任何整数所整除的整数。用筛选法求素数
的基本思想是：要找出2~m 之间的全部素数，首先在2～m中划去2的倍数(不包括2),然后划
去3的倍数(不包括3),由于4已被划去，再找5的倍数(不包括5),…,直到再划去不超过√m
的数的倍数，剩下的数都是素数。程序如下：
m=input('m=');
p=1:m;p(1)=0;
for i=2:sqt(m)
for j=2*i:i:m
p(j)=0;
end
end
0=find(p~=0);
p(n)
外循环控制i从2到√m变化，内循环在p中划去i的倍数(不包括i),p中剩下的数都是素
数。find 函数找出p中非0元素的下标并赋予变量n(注意，n为向量)。
关于在p中划去i的倍数(不包括i),可利用矩阵运算一步完成，从面得到更为简洁的程序：
m=input('m=');
p=2:m;
第3章 MATLAB程序设计 ·55·
for i=2:aqt(m)
n=find(rem(p,i)==0&p~=i);
p(n)=[];
end
P
变量n为p中能被i整除而；不等于p的元素的下标，然后将p中该位置上的元素剔除，剩
下的全为素数。
3.5 函 数 文 件
函数文件是另一种形式的M文件，每一个函数文件都定义一个函数。事实上，MATLAB提供
的标准函数大部分都是由函数文件定义的。
3.5.1 画数文件的基本结构
函数文件由 function语句引导，其基本结构为：
fumction输出形参表=函数名(输入形参表)
注释说明部分
函数体语句
其中以 function开头的一行为引导行，表示该M文件是一个函数文件。函数名的命名规则与变
量名相同。输入形参为函数的输入参数，输出形参为函数的输出参数。当输出形参多于一个时，
则应该用方括号括起来。
说明：
(1)关于函数文件名。函数文件名通常由函数名再加上扩展名.m组成，不过函数文件名与
函数名也可以不相同。当两者不同时，MATLAB将忽略函数名而确认函数文件名，因此调用时使
用函数文件名。不过最好把文件名和函数名统一，以免出错。
(2)关于注释说明部分。注释说明包括三部分内容：
①紧随函数文件引导行之后以??头的第一注释行。这一行一般包括大写的函数文件名
和函数功能简要描述，供lookfor关键词查询和 help在线帮助用。
②第一注释行及之后连续的注释行。通常包括函数输入输出参数的含义及调用格式说明
等信息，构成全部在线帮助文木。
③与在线帮助文本相隔一空行的注释行。包括函数文件编写和修改的信息，如作者、修改
日期、版本等内容，用于软件档案管理。
(3)关于 return语句。如果在函数文件中插人了retum语句，则执行到该语句就结束函数的
执行，程序流程转至调用该函数的位置。通常，在函数文件中也可不使用 retum语句，这时在被
调函数执行完成后自动返回。
例3.14 编写函数文件求半径为，的圆的面积和周长。
函数文件如下：
function [s,pl=fcircle(r)
·56· 基 础 篇
?RCLE caleulate the area and perimeter of a circle of radiir
圆半径 %r
%s 圆面积
圆周长 %p
 01年7月30日编
s=pi*r*r;
p=2*pi*r;
将以上函数文件以文件名 fcircle.m存人c:\matlabrll\work下，然后在MATLAB命令窗口调
用该函数：
[s,p]=fcircle(10)
输出结果是：
8=
314.1593
p=
62.8319
采用help命令或 lookfor命令可以显示出注释说明部分的内容，其功能和一般MATLAB函数
的帮助信息是一致的。
利用help命令可查询 fcircle 函数的注释说明：
help fcircle
屏幕显示：
CIRCLE calculate the area and perimeter of a circle of radii r
r 圆半径
8 圆面积
P 圆周长
再用lookfor.命令在第一注释行查询指定的关键词：
ookfor perimeter
屏幕显示：
feircle.m:?RCLE calculate the area and perimeter of a circle of radi r
3.5.2 函数调用
函数文件编制好后，就可调用函数进行计算了。如上面定义fcircle函数后，调用它求半径为
10的圆的面积和周长。函数调用的一般格式是：
[输出实参表]=函数名(输入实参表)
要注意的是，函数调用时各实参出现的顺序、个数，应与函数定义时形参的顺序、个数一致，
否则会出错。函数调用时，先将实参传递给相应的形参，从而实现参数传递，然后再执行函数的
功能。
例3.15 利用函数文件，实现直角坐标(x,y)与极坐标(p,0)之间的转换。
已知转换公式为：
极坐标的矢径：p=√x2+y2
第3章 MATLAB程序设计 ·57·
:θ=arctan(X) 极坐标的极角：
函数文件tran.m如下：
funetion [zho,theta]=tran(x,y)
rho=sqrt(x*x+y*y);
theta=atan(y/x);
调用tran.m的命令文件mainl.m如下：
x=input('Please input x=:');
y=input(' Please input y=:');
[rtho,the]=tran(x,y);
rho
the
在MATLAB中，函数可以嵌套调用，即一个函数可以调用别的函数，甚至调用它自身(递归调
用)。
例3.16 利用函数的递归调用，求 n!。
递归调用函数文件factor.m如下：
function f=factor(n)
if n<=1
f=1;
else
f=factor(n-1)*n;
end
在命令文件main2,m中调用函数文件 factor.m求s=1!+2!+3!+4!+5!。
s=0;
for i=1:5
8=8+factor(i);
end
s
3.5.3 画数所传递参数的可调性
MATLAB在函数调用上有一个与一般高级语言不同之处，就是函数所传递参数数目的可调
性。凭借这一点，一个函数可完成多种功能。
在调用函数时，MATLAB用两个永久变量nargin和nargout分别记录调用该函数时的输入实
参和输出实参的个数。只要在函数文件中包含这两个变量，就可以准确地知道该函数文件被调
用时的输入输出参数个数，从而决定函数如何进行处理。
例3.17 nargin用法示例。
函数文件examp.m如下：
function fout=charray(a,b,c)
if nargin==1
fout=a;
·58· 基 础 篇
elseif nargin==2
fout=a+b;
clscif nargin==3
fout=(a*b*c)/2;
end
命令文件mydemo.m如下：
x=1:3;y=[1;2;3];
examp(x)
examp(x,y')
examp(x,y,3)
执行mydemo.m后的输出是：
ans =
123
ans =2 6
ans=
21
在命令文件 mydemo.m中，3次调用函数文件examp.m,因输入参数的个数分别是1个、2个、
3个，从而执行不同的操作，返回不同的函数值，
3.6 全局变量和局部变量
在MATLAB中，全局变量用命令global定义。函数文件的内部变量是局部的，与其他函数文
件及MATLAB工作空间相互隔离。但是，如果在若干函数中，都把某一变量定义为全局变量，那
么这些函数将公用这一个变量。全局变量的作用域是整个MATLAB工作空间，即全程有效。所
有的函数都可以对它进行存取和修改。因此，定义全局变量是函数间传递信息的一种手段。
值得指出，在程序设计中，全局变量固然可以带来某些方便，但却破坏了函数对变量的封装，
降低了程序的可读性。因而，在结构化程序设计中，全局变量是不受欢迎的。尤其当程序较大，
子程序较多时，全局变量将给程序调试和维护带来不便，故不提倡使用全局变量。如果一定要用
全局变量，最好给它起一个能反应变量含义的名字，以免和其他变量混淆。
例3.18 全局变量应用示例。
先建立函数文件 wadd.m,该函数将输入的参数加权相加。
function f=wadd(x,y)
global ALPHA BETA
f= ALPHA*x+BETA*y;
再在命令窗口中输人：
global ALPHA BETA
ALPHA=1;
BETA=2;
第3章 MATLAB程序设计 ·59·
8=wadd(1,2)
输出为：
s=
5
由于在函数 wadd 和基本工作空间中都把ALPHA和BETA两个变量定义为全局变量，所以只
要在命令窗口中改变ALPHA和BETA的值，就可改变加权值，而无需修改wadd.m文件。
上例只在函数wadd和命令窗口中把ALPHA和BETA变量定义为全局变量，在实际编程时，
可在所有需要调用全局变量的函数里定义全局变量，这样就可实现数据共享。为了在基本工作
空间中使用全局变量，也要定义全局变量。
在函数文件里，全局变量的定义语句应放在变量使用以前，为了便于了解所有的全局变量，
一般把仝局变量的定义语句放在文件的前部。
3.7 类 和 对 象
MATLAB从5.0版开始引入了类(Class)和对象(Object)的概念。从结构的概念中我们知道，
结构的成员是以变量形式出现的。类的概念是结构的拓展，在类中，不但可以包含变量成员，还
可以包含与这些变量相关联的函数或运算。对象是类的一个具体实例。
类和对象的概念是面向对象程序设计(Object- oriented Programming)的基础。采用面向对象
技术可以把复杂的操作过程加以隐藏，而外部呈现为人们所习惯的处理形式。在MATLAB中，要
建立一个类，通常包含以下内容：
(1)建立类日录。类日录名必须以@开头，@后而紧接待建类的名字。类目录要处在MAT LAB搜索路径上某目录的子目录位置上。类月录下存放着定义该类对象全部性质和操作方式的
一组方法(Methods)文件。
(2)确定待建类的数据结构。在MATLAB中，常用结构矩阵作为类的数据结构。
(3)对象构造函数。在MATLAB中，没有C++中的所谓类声明语句，每个对象都是由构造
函数动态产生的。构造函数必须与待建的类同名，并放在相应的类目录上。构造函数的主要内
容有：在无输人、本类输入、非本类输入情况下，控制有合理的新对象输出；定义类对象；确定该类
的优先等级；对该类是否具有继承性加以定义。
(4)显示函数。MATLAB运行时，若一个语句不以分号结束，那么就会在屏幕上自动显示该
语句产生的变量。显示变量的具体过程是：MATLAB首先根据所产生变量的类别，到相应类目录
上去调用display 函数实现屏幕显示。如果找不到相应类目录，则使用内建的显示函数实现屏幕
显示。对于新建的类，必须为其设计相应的显示函数。显示函数和前而的构造函数是类目录上
必须有的两个M函数文件。
(5)其他函数。这包括与其他类之间的转换函数以及新建类的有关基本运算函数。
例3.19 建立一个整数类 integer,该类含有一个数据成员n,代表一个3位整数。还具有显
示整数各位数字之和、各位数字平方和、各位数字立方和等功能。
操作步骤如下：
·60· 基 础 篇
(1)在MATLAB5.3版的work目录下建立类目录@integer,即\matlabrll\work\@integera
(2)确定 integer类的数据结构，该类含有一个数据成员，即整数n。
(3)建立构造函数@integer \integer.m。
function p=integer(v)
if isa(v,'integer')
p=V; ??入变量是integer类
else
p.n=v;p=class(p,'integer'); ??人变量不是integer类
end
(4)为integer对象定义显示函数@integer \display.m。
function display(p)
disp(['The result is',num2str(p.n));?teger 对象的显示格式与别的不同
(5)为integer 对象定义其他运算函数。
求各位数字之和的函数@integer \he.m如下：
function p= he(q)
??入参数要求 integer 对象 am fix(q.n/100);
b= rem(fix(q.n/10),10);
c= rem(q.n,10);
p=a+b+c;
??出为integer对象 p=integer(p);
求各位数字平方和的函数@integer \pow2.m如下：
function p= pow2(q)
a=fix(q,n/100);
b= mem(fix(q.n/10),10);
c=rem(q.n,10);
p=a*a+b*b+c*c;
p=integer(p);
求各位数字立方和的函数@integer \pow3.m如下：
function p=pow3(q)
a=fix(q.n/100);
b= rem(fix(q.n/10),10);
c=rem(q.n,10);
p=a*a*a+b*b*b+c*c*c;
p=integer(p);
(6)integer类使用演示。
建立一个integer对象并进行类别检查，命令如下：
a=integer(123); ??立integer 对象a
isa(a,' integer') ?断a是否integer对象
ans=
1
显示 integer对象命令如下：
第3章 MATLAB程序设计 ·61
a ??示 integer对象a,注意和一般数据显示格式不同
The result is 123
对 integer对象进行有关运算命令如下：
??各位数字之和 he(integer(816))
The result is 15
pow3(integer(321)) ??各位数字立方和
The result is 36
??各位数字平方和，注意和 pow2(102)的区别 pow2(integer(102))
The result is 5
zTLAB标准函数，求2的102次方 pow2(102)
ans=
5.0706e+030
利用methods命令列出integer类已定义的方法函数名：
methods integer
Methods for class integer:
display he integer pow2 pow3
3.8 文 件 操作
文件操作是一种重要的输入输出方式，即从数据文件读取数据或将结果写入数据文件。
MATLAB提供了一系列低层输入输出函数，专门用于文件操作。
3.8.1 文件的打开与关阅
1.打开文件
在读写文件之前，必须先用 fopen 函数打开文件，并指定允许对该文件进行的操作。fopen函
数的调用格式为：
Fid= fopen(文件名，打开方式)
其中 Fid用于存储文件句柄值，如果句柄值大于0,则说明文件打开成功。文件名用字符串形
式，表示待打开的数据文件。常见的打开方式有：r(读)、w(写)、a(追加)、r+(可读可写)等。例
如，要对数据文件std.dat 进行读操作，打开该文件：
Fid= fopen('std.dat','r')
2.关闭文件
文件在进行完读、写等操作后，应及时关闭，以免数据丢失。关闭文件用fclose 函数，调用格
式为：
Sta=fclose(Fid)
该函数关闭 Fid所表示的文件。Sta表示关闭文件操作的返回代码，若关闭成功，返回0,否
则返回-1。如果要关闭所有已打开的义件用fclose('all')。
·62· 基 础 篇
3.8.2 二进制文件读写操作
1.读二进制文件
fread 函数可以读取二进制文件的数据，并将数据存入矩阵。其调用格式为：
[A,COUNT] =fread(Fid,size,precision)
其中A用于存放读取的数据，COUNT返回所读取的数据元素个数，Fid为文件句柄，size为可选
项，若不选用则读取整个文件内容，若选用则它的值可以是下列值：N(读取N个元素到一个列
向量)、inf(读取整个文件)、[M,N](读数据到M×N的矩阵中，数据按列存放)。precision代表数
据精度，常用的数据精度有：char、uchar、int、long、float、double等。缺省数据精度为uchar,即无符号
字符格式。例如
Fid=fopen(' std.dat','r');
A= fread(Fid,100,' long');
Sta=fclose(fid);
以读方式打开数据文件std.dat,然后按长整型数据格式读取该文件的前100个数据放入向
量A,最后关闭文件。
2.写二进制文件
fwrite 函数按照指定的数据精度将矩阵中的元素写入到文件中。其调用格式为：
COUNT=fwrite(Fid,A.precision)
其中 COUNT返回所写的数据元素个数，Fid为文件句柄，A用来存放写入文件的数据，precision
用于控制所写数据的精度，其形式与 fread 函数相同。例如
Fid= fopen('aaa.bin','w');
fwrite(Fid,X,'float');
将矩阵X中的数据用浮点格式写入 aaa.bin文件。
3.8.3 文本文件读写操作
1.读文本文件
fscanf 函数可以读取文本文件的内容，并按指定格式存入矩阵。其调用格式为：
[A,COUNT] =fscanf(Fid,format,size)
其中A用以存放读取的数据，COUNT返回所读取的数据元素个数。Fid为文件句柄。format用
以控制读取的数据格式，由?上格式符组成，常见的格式符有：d(整型)、f(浮点型)、s(字符串
型)、c(字符型)等，在??格式符之间还可以插入附加格式说明符，如数据宽度说明等。size为
可选项，决定矩阵A中数据的排列形式，它可以取下列值：N(读取 N个元素到一个列向量)、inf
(读取整个文件)、[M,N](读数据到M×N的矩阵中，数据按列存放)。例如，从指定文件中读取
100个整数，并存入向量x中：
x=fscanf(Fid,']*,100);
也可以将读取的100个整数存入10×10矩阵y中：
y=fscanf( Fid,']',[10,10]);
2.写文本文件
fprintf 函数可以将数据按指定格式写入到文本文件中。其调用格式为：
第3章 MATLAB程序设计 ·63·
COUNT=fprintf(Fid, format,A)
其中A存放要写入文件的数据。先按format指定的格式将数据矩阵A格式化，然后写入到Fid
所指定的文件。格式符与fscanf 函数相同。例如
x=0:0.1:1;
y=[x;exp(x)];
Fid=fopen(' exp.txt','w');
fprintf(Fid,'n2f .8f\n',y);
fclose(Fid);
上述程序段建立一文本文件exp.txt,并将矩阵y的列向量数据分别以浮点格式n2f和
.8f写人文本文件 exp.txt。格式串中的\n表示换行。出于是文本文件，可以在MATLAB命
令窗口用type命令显示其内容。
例3.20 从键盘输人5名学生的姓名和成绩，先建立一个数据文件，然后读出数据文件的内
容，并按成绩从低到高的顺序在屏幕上输出学生信息。
程序如下：
fid= fopen('t.Lxt','w');
for i=1:5
n= input('name=?','s');
s=input(' score=?');
fprintf(fid,‘?nIf\n',n,8);
end
fclose(fid);
fid=fopen('t.bt','r');
n=1;
while(1)
stu(n).num= fscanf(fid,'7,1);
stu(n).sco= fscanf( fid,'?,1);
if feof(fid)==1?of 函数测试是否到了文件结束位置
break;
end
score(n)=stu(n).sco;
n=n+1;
end
n=n-1;
[sortsco,index]=sor(score); rt 函数将向量排序
for i=1:n
oup=['姓名',stu(index(i)).nam, 成绩',num2str(sortsco(i))];
disp(oup);
end
fclose(fid);
3.8.4 数据文件定位
MATLAB提供了与文件定位操作有关的函数 fseek 和 ftell。通过这两个函数，用户可以设定
·64· 基 础 篇
或获取文件指针位置，以方便、灵活地进行输入输出操作。
fseek 函数用于定位文件位置指针，其调用格式为：
status= fseek(Fid,offset,origin)
其中Fid为文件句柄，offset 表示位置指针相对移动的字节数，若为正整数表示向文件尾方向移
动，若为负整数表示向文件头方向移动，origin 表示位置指针移动的参照位置，它的取值有3种
可能：cof表示文件的当前位置，bof表示文件的开始位置， eof'表示文件的结束位置。若定位成
功，status 返回值为0,否则返回值为-1。
ftell 函数返回文件指针的当前位置，其调用格式为：
position= ftell(Fid)
返回值为从文件开始到指针当前位置的字节数。若返回值为-1表示获取文件当前位置失败。
例3.21 分析下列程序执行后，four、position和 three 3个变量的值。
a=1:5;
Fid=fopen(' fdat.bin','w');
fwrite(Fid,a,'int16');
statu8=fclose(Fid);
Fid= fopen('fdat.bin','r');
status=fseek(Fid,6,' bof');
four= fread(Fid,1,'int16');
position= ftell(Fid);
??写方式打开文件fdat.hin
??a的元素以双字节整型写人文件 fdat.bin
??读方式打开文件fdat.bin
??文件指针从开始位置向尾部移动6个字节
??取第4个数据，并移动指针到下一个数据
?ell的返回值为8
statusx fscek(Fid,-4,' cof');
three = fread(Fid,1,'inti6');
status=fclose(Fid);
??文件指针从当前位置往前移动4个字节
??取第3个数据
程序的分析过程见注释。程序执行后，four、position和three的值分别是4,8和3。
习 题 三
1.从键盘输入一个4位整数，按如下规则加密后输出。加密规则：每位数字都加上7,然后用和除以10的余
数取代该数字；再把第一位与第三位交换，第二位与第四位交换。
2.分别用f语句和switch 语句实现以下计算，其中a,b,c的值从键盘输人。
0.5≤x<1.5
1.5≤x<3.5
3.5≤x<5.5
3.输人20个数，求其中最大数和最小数。要求分别用循环结构和调用MATLAB的max 函数、min函数来实
现。
4.已知
s=1+2+22+23+…+2
分别用循环结构和调用MATLAB的sum函数求s的值。
5.编写一个函数文件，用于求两个矩阵的乘积和点乘，然后在命令文件中调用该函数。
第3章 MATLAB程序设计 ·65·
6.编写一个函数文件，求小于任意自然数n的斐波那契(Fibnacci)数列各项。Fibnacci数列定义如下：
f=1 +
7.产生20个两位随机整数，输出其中小于平均值的偶数。
8.试定义一个字符串类sting,使其至少具有内容(contents)和长度(length)两个数据成员，并具有显示字符
串、求字符串长度、在原字符串后添加一个字符串等功能。
9.编写程序，该程序能读取一个文本文件，并能将文本文件中的小写字母转换为相应的大写字母而生成一
个新的文本文件。
10.写出下列程序的输出结果。
(1)s=0; (2)N= input('N=');
a=[12,13,14;15,16,17;18,19,20;21,22,23]; c(1:2*N-1)='';
for k=a for i=1:N
for j=1:4 cl(1:16)=";
if rem(k(j),2)～=0 k=N+1-j;
s=s+k(j); cl(k:k+2*i-2)=e(1:2*i-1);
end disp(el);
end end
end 当N的值取5时，写出输出结果。
s
(3)命令文件 ex82.m: (4)函数文件mult.m:
global x function a=mult(var)
x=1:2:5;y=2:2:6; a=var{1;
exsub(y); for i=2:length(var)
x a=a*varlil;
y end
函数文件exsub、m: 命令文件pp.m:
p=[17,-6;35,-12];
p=mult(Ip;PiP;p;pl)
function fun=sub(z)
globul x
z=3*x;x=x+z;
第4章 MATLAB绘 图
强大的绘图功能是MATLAB的特点之一。MATLAB提供了一系列的绘图函数，用户不需过
多考虑绘图细节，只需给出一些基本参数就能得到所需图形，这一类函数称为高层绘图函数。除
此之外，MATLAB还提供了直接对图形句柄进行操作的低层绘图操作。这类操作将图形的每个
图形元素(如坐标轴、曲线、曲面或文字等)看作是一个独立的对象，系统给每个图形对象分配一
个句柄，以后可以通过该句柄对该图形元素进行操作，而不影响图形的其他部分。高层绘图操作
简单明了、方便高效，是用户最常使用的绘图方法，而低层绘图操作控制和表现图形的能力更强，
为用户更加自主地绘制图形创造了条件。事实上，MATLAB的高层绘图函数都是利用低层绘图
函数而建立起来的。
本章介绍绘制二维和三维图形的高层绘图函数以及其他图形控制函数的使用方法，在此基
础上，再介绍可以操作和控制各种图形对象的低层绘图操作。
4.1 二维图 形
4.1.1 绘制二维曲线的最基本画数
在MATLAB中，最基本且应用最为广泛的绘图函数为 plot函数，利用它可以在二维平而上绘
制出不同的曲线。
1.plot 函数的基本用法
plot 函数用于绘制x-y平面上的线性坐标曲线图，因此需提供一组x坐标以及与各点x坐
标对应的y坐标，这样就可以绘制分别以x坐标和y坐标为横、纵坐标的二维曲线。plot 函数的
基本调用格式为：
plot(x,y)
其中x和y为长度相同的向量，分别用于存储x坐标和y坐标数据。
例4.1 在0≤x≤2π区间内，绘制曲线y=2e-?-5*sin(2πx)。
程序如下：
x=0;pi/100:2*pi;
y=2*exp(-0.5*x),*sin(2*pi*x);
plot(x,y)
程序执行后，打开一个图形窗口，在其中绘出图4.1所示的曲线。
注意：求y时，指数函数和正弦函数之间要用点乘运算，而因2为标量，所以2与指数函数之
间可以用乘法运算。这样，x和y所包含的元素个数相等，y(i)是x(i)点的函数值。
以上提到plot 函数的自变量x,y为长度相同的向量，这是最常见、最基本的情况。实际应
第4章 MATLAB绘图 ·67
2
1.5
1
0.5
0
-05
-1
-150 1 2 3 4 5 6 7
图4.1 y=2e?.5*sin(2πx)的曲线
用中还有一些变化，下面分别说明。
(1)当x,y是同维矩阵时，则以x,y对应列元素为横、纵坐标分别绘制曲线，曲线条数等于
矩阵的列数。
(2)当x是向量，y是有一维与x同维的矩阵时，则绘制出多根不同色彩的曲线。曲线条数
等于y矩阵的另一维数，x被作为这些曲线共同的横坐标。例如，下列程序可以在同一坐标中同
时绘制出正弦和余弦曲线。
x=linspace(0,2*pi,100);
y=[sin(x);cos(x)];
plot(x,y)
程序首先产生一个行向量x,然后分别求取行向量sin(x)和cos(x)并将它们构成矩阵y的
两行，最后在同一坐标中同时绘制出两条曲线。
(3)plot 函数最简单的调用格式是只包含一个输入参数：plot(x)。在这种情况下，当x是实
向量时，以该向量元素的下标为横坐标，元素值为纵坐标画出一条连续曲线，这实际上是绘制折
线图。当x是实矩阵时，则按列绘制每列元素值相对其下标的曲线，曲线条数等于x阵的列数。
当x是复数矩阵时，则按列分别以元素实部和虚部为横、纵坐标绘制多条曲线。
例4.2 某工厂2000年各月总产值(单位：万元)分别为22.60、88、95.56、23、9、10、14、81、56、
23,试绘制折线图以显示出该厂总产值的变化情况。
程序如下：
p=[22,60,88,95,56,23,9,10,14,81,56,23];
plot(p)
结果如图4.2所示。
·68· 基 础 篇
100
90
80
70
60
50
40
30
20
10
0
0 2 4 6 8 10 12
图4.2 某工厂2000年产值变动曲线
2.含多个输入参数的plot 函数
plot 函数可以包含若干组向量对，每一向量对可以绘制出一条曲线。含多个输入参数的plot
函数调用格式为：
plot(x1,yl,x2,y2,…,xn,yn)
其中x1和y1,x2和y2,…,xn和yn分别组成一组向量对，每一组向量对的长度可以不同。每
一向量对可以绘制出一条曲线，这样可以在同一坐标内绘制出多条曲线。
3.含选项的plot 函数
MATLAB提供了一些绘图选项，用于确定所绘曲线的线型、颜色和数据点标记符号。这些选
项如表4.1所示，它们可以组合使用。例如，b-.表示蓝色点划线，y:d表示黄色虚线并用菱形
符标记数据点。当选项省略时，MATLAB规定，线型一律用实线，颜色将根据曲线的先后顺序依
次采用表4.1给出的前7种颜色。含选项的plot 函数调用格式为：
plot(x1,yl,选项1,2,y2,选项2,…,xn,yn,选项n)
例4.3 用不同线型和颜色在同一坐标内绘制曲线 y=2e-0.5sin(2πx)及其包络线。
程序如下：
x=(0:pi/100:2*pi)';
yl=2*exp(-0.5*x)*[1,-1];
y2=2*exp(-0.5*x).*sin(2*pi*x);
x1=(0:12)/2;
y3=2*exp(-0.5*x1).*sin(2*pi*x1);
plot(x,yl,'g:',x,y2,'b--',x1,y3,'p+);
第4章 MATLAB绘图 ·69·
表4.1 线型、颜色和标记符号选项
(a)线型选项 (b)颜色选项 (c)标记符号选项
线型 说明 颜色 说明 标记符号 说明
点
圆圈
又号
加号
星号
标记符号
8
d
^
<
>
P
h
说明
实线 b 蓝色 方块符(square)
虚线 g 绿色 0 菱形符(diamond)
点划线 r 红色 X 朝下三角符号
双划线 c 青色 朝上三角符号
m 品红色 关 朝左三角符号
y 黄色 朝右三角符号
k 黑色 五角星符(pentagram)
w 白色 六角星符(hexagram)
程序运行结果如图4.3所示。plot 函数中包含3组绘图参数，第一组用绿色虚线绘出两根包
络线，第二组用蓝色双划线绘出曲线y,第三组用红色五角星离散地标出数据点。
程序中第一条命令用矩阵转置运算符将行向量转换为列向量。请读者思考一下，如果这里
不用转置操作，程序会怎样?如果要得到图4.3的图形，程序应如何修改?
2
15
1
05
京 文
-0.5
-1
-1,5
-2k
0 1 2 3 4 5 6 7
图4.3 用不同线型和颜色绘制的曲线
4.双纵坐标函数plotyy
plotyy 函数是MATLAB 5.x新增的函数。它能把函数值具有不同量纲、不同数量级的两个函
数绘制在同一坐标中。调用格式为：
plotyy(xI,yl,x2,y2)
其中x1-y1对应一条曲线，x2-y2 对应另一条曲线。横坐标的标度相同，纵坐标有2个，左纵
坐标用于x1-y1数据对，右纵坐标用于x2-y2数据对。
例4.4 用不同标度在同一坐标内绘制曲线yl=e-0.5* sin(2πx)及曲线 y2=1.5e-01
sin(x)。
·70· 基 础 篇
程序如下：
x1=0:pi/100:2* pi;
x2=0:pi/100:3*pi;
yl=exp(-0.5*x1).*sin(2*pi*x1);
y2=1.5*exp(-0.1×x2).*sin(x2);
plotyy(xl,yl,x2,y2);
程序运行结果如图4.4所示。
1 2
0 0
-10 1 2 3 4 5 6 7 B 9
-2
10
图4.4 用双纵坐标绘制的曲线
4.1.2 飨制图形的辅助揉作
绘制完图形后，可能还需要对图形进行一些辅助操作，以使图形意义更加明确，可读性更强。
1.图形标注
在绘制图形的同时，可以对图形加上一些说明，如图形名称、坐标轴说明以及图形某一部分
的含义等，这些操作称为添加图形标注。有关图形标注函数的调用格式为：
tite(图形名称)
xlabel(x轴说明)
ylabel(y轴说明)
text(x,y,图形说明)
egend(图例1,图例2,…)
第4章 MATLAB绘图 ·71·
其中title和xlabel、ylabel 函数分别用于说明图形和坐标轴的名称。text 函数是在(x,y)坐标处添
加图形说明。添加文本说明也可用gtext命令，执行该命令时，十字坐标光标自动跟随鼠标移动，
单击鼠标即可将文本放置在十字光标处。如命令gtext('cos(x)'),即可放置字符串'cos(x)'。leg end 函数用于绘制曲线所用线型、颜色或数据点标记图例，图例放置在图形空白处，用户还可以
通过鼠标移动图例，将其放到所希望的位置。
应当说明的是，除legend函数外，其他函数同样适用于三维图形，z坐标轴说明用 zlabel函
数。
例4.5 给图4.3中的图形添加图形标注。
程序如下：
x=(0:pi/100:2*pi)';
y1=2*exp(-0.5*x)*[1.-1];
y2=2* exp(-0.5*x).*sin(2*pi*x);
x1=(0:12)/2;
y3=2*exp(-0.5*x1).*sin(2* pi*x1);
plot(x,yl,'g:',x.y2,'b--*,x1,y3,'p');
title('曲线及其包络线'); ?图形标题
?X轴说明 xlabel(' independent variable X');
?Y轴说明 ylabel('independent variable Y');
?指定位置添加图形说明 text(2.8,0.5,'包络线');
text(0.5,0.5,'曲线y');
text(1.4,0.1,离散数据点');
legend('包络线',包络线',曲线y',离散数据点'〉?图例
程序运行结果如图4.5所示。
2.坐标控制
在绘制图形时，MATLAB可以自动根据要绘制曲线数据的范围选择合适的坐标刻度，使得曲
线能够尽可能清晰地显示出来。所以，在一般情况下用户不必选择坐标轴的刻度范围。但是，如
果用户对坐标系不满意，可利用axis函数对其重新设定。该函数的调用格式为：
axis([xmin,xmax,ymin,ymax,zmin,zmax])
如果只给出前4个参数，则MATLAB按照给出的x,y轴的最小值和最大值选择坐标系范
围，以便绘制出合适的二维曲线。如果给出了全部参数，则系统按照给出的3个坐标轴的最小值
和最大值选择坐标系范围，以便绘制出合适的三维图形。
axis函数功能丰富，常用的用法还有：
axis equal
axis square
axis auto
axis off
axis on
纵、横坐标轴采用等长刻度
产生正方形坐标系(缺省为矩形)
使用缺省设置
取消坐标轴
显示坐标轴
一般情况下，绘图命令每执行一次就刷新当前图形窗口，图形窗口原有图形将不复存在。若
希望在已存在的图形上再继续添加新的图形，可使用图形保持命令hold。hold on/off 命令控制是
·72· 基 础 篇
保持原有图形还是刷新原有图形，不带参数的hold命令在两种状态之间进行切换。
曲线及其包络线
2
1.5
1
ndependent yanable Y 0.5 曲线y{ 包络线
吨 事改蜘烟点 产
-0.5
-1
-1.5
-2
D 1 2 3 4 5
包络线
曲线y
离散数据点
包络线
文
6 7
independent vanable X
图4.5 给图形加图形标注
给坐标加网格线用grid 命令来控制。grid on/off 命令控制是画还是不画网格线，不带参数的
grid命令在两种状态之间进行切换。
给坐标加边框用box 命令。box on/off命令控制是加还是不加边框线，不带参数的box 命令
在两种状态之间进行切换。
例4.6 用图形保持功能在同一坐标内绘制曲线γ=2e-0.5*sin(2πx)及其包络线，并加网格
线。
程序如下：
x=(0:pi/100:2*pi)';
yl=2*exp(-0.5*x)*[1,-1];y2=2*exp(-0.5*x).*sin(2*pi*x);
plot(x,yi,'b:');
axis([0,2*pi,-2,2]); ??置坐标
hold on; ??置图形保持状态
plot(x,y2,'k');
grid on; ?网格线
boxoff; ??加坐标边框
hold off; ?闭图形保持
程序运行结果如图4.6所示。
第4章 MATLAB绘图 ·73·
2
15
1
05
0
-0.5
-1
-1.5
-2
0 1 2 3 4 5 6
图4.6 坐标控制
3.图形窗口的分割
在实际应用中，经常需要在一个图形窗口内绘制若于个独立的图形，这就需要对图形窗口进
行分割。分割后的图形窗口由若干个绘图区组成，每一个绘图区可以建立独立的坐标系并绘制
图形。同一图形窗口中的不同图形称为子图。MATLAB系统提供了subplot 函数，用来将当前图
形窗口分割成若干个绘图区。每个区域代表一个独立的子图，也是一个独立的坐标系，可以通过
subplot 函数激活某一区，该区为活动区，所发出的绘图命令都是作用于活动区域。subplot 函数的
调用格式为：
subplot(m,n,p)
该函数将当前图形窗口分成m×n个绘图区，即每行 n个，共m行，区号按行优先编号，且
选定第p个区为当前活动区。在每一个绘图区允许以不同的坐标系单独绘制图形。
例4.7 在一个图形窗口中以子图形式同时绘制正弦、余弦、正切、余切曲线。
程序如下：
x= linspace(0,2*pi,60);
y=sin(x);z=cos(x);
t=sin(x)./(cos(x)+eps);ct= cos(x)./(sin(x)+eps);
subplot(2,2,1);
plot(x,y);titie(' sin(x)');axis([0,2*pi,-1,1]);
subplot(2,2,2);
·74· 基 础 篇
plot(x,z);tide(' cos(x)');axis([0,2*pi,-1,1]);
subplot(2,2,3);
plot(x,t);title(' tangent(x)');axis([0,2*pi,-40,40]);
subplot(2,2,4);
plot(x,ct);title(' cotangent(x)');auis([0,2*pi,-40,40]);
程序运行结果如图4.7所示。
sin(x) 1
cos(x) 1
0.5 0.5
0 0
-0.5 -05
-1 2 4 6
-1
0 2 4 6
tangent(x) cotangent(x) 40 40
20 20
0
-20 -20
-40
0 2 4 6
40
0 2 4 6
图4.7 图形窗口的分割
例4.7中将图形窗口分割成2×2个绘图区，编号从1到4,各区分别绘制一幅图形，这是最
规则的情况。实际上，还可以作更灵活的分割。看下面的程序。
x= linspace(0,2*pi,60);
y=sin(x);z=cos(x);
t=sin(x)./(cos(x)+eps);ct= cos(x)./(sin(x)+eps);
subplot(2,2,1); ??择2×2个区中的1号区
stairs(x,y);axis([0,2*pi,-1,1}); tairs 函数绘制阶梯图(见下一小节)
subplot(2,1,2); ??择2×1个区中的2号区
stem(x,y);axis([0,2* pi,-1,1]); tem 函数绘制杆图(见下--小节)
subplot(4,4,3); ??择4×4个区中的3号区
plot(x,y);axis([0,2*pi,-1,1]);
subplot(4,4,4); ??择4×4个区中的4号区
plot(x,z);axis([0,2*pi,-1,1]);
subplot(4,4,7); ??择4×4个区中的7号区
plot(x,t);axis([0,2*pi,-40,403);
subplot(4,4,8); ??择4×4个区中的8号区
第4章 MATLAB绘图 ·75·
plot(x,ct);axis([0,2*pi,-40,40);
程序运行结果如图4.8所示。本质上讲，这还是一种规则的分割，4.5节将进一步说明，如
何利用坐标轴对象操作对图形窗口作任意分割。
1 1 1
D5 0 D
0 -1 0
40 5
-05 20
0
-1
导叹0
0
5
-10
-20 -20 2 4 6 -40
0 5
-40
0 5
1
05
-05
-10 1 2 3 4 5 6
图4.8 图形窗口的灵活分剂
4.1.3 给制二维图形的其他画数
1.其他形式的线性直角坐标图
在线性直角坐标系中，其他形式的图形有条形图、阶梯图、杆图和填充图等，所采用的函数分
别是：
bar(x,y,选项)
stairs(x,y,选项)
stem(x,y,选项)
fi](x1,y1,选项1,x2,y2,选项2,…)
前3个函数的用法与plot 函数相似，只是没有多输入变量形式。fill 函数按向量元素下标渐增
次序依次用直线段连接 x,y对应元素定义的数据点。假若这样连接所得折线不封闭，那么MAT LAB将自动把该折线的首尾连接起来，构成封闭多边形，然后将多边形内部涂满指定的颜色。
例4.8 分别以条形图、填充图、阶梯图和杆图形式绘制曲线y=2e-0.5。
程序如下：
x=0:0.35:7;
y=2*exp(-0.5*x);
subplot(2,2,1);bar(x,y,'g');
itle(' bar(x,y,"g")');axis([0,7,0,2]);
·76· 基 础 篇
subplot(2,2.2);6il(x,y,'r');
title('6il(x,y,"r")');axis([0,7,0,2]);
subplot(2,2,3);stairs(x,y,'b');
title('stairs(x,y,"b")');axis([0,7,0,2]);
subplot(2,2,4);stem(x,y,'k');
tidle('stem(x,y,"k")');axis([0,7,0,2]);
程序执行结果如图4.9所示。
bar(x,yg) fl(x,y.) 2: 2
1.5 15
1 1
05 05
0
0246
0
0 246
stairs(x,y.b) stem(x,y.k) 2 20
9
1.5 15 o
1 1
0.5 0.5
o9
●
9
ol 2 4 6
0l0 2 4 6
图4.9 几种不同形式的图形
2.极坐标图
polar函数用来绘制极坐标图，其调用格式为：
polar(theta,rho,选项)
其中 theta 为极坐标极角，rho为极坐标矢径，选项的内容与plot 函数相似。
例4.9 绘制p=sin(20)cos(20)的极坐标图。
程序如下：
theta=0:0.01:2*pi;
tho=sin(2*theta).* cos(2* thela);
polar(theta,rho,'k');
程序运行结果如图4.10所示。
3.对数坐标图形
在实际应用中，经常用到对数坐标，例如控制理论中的Bule图。MATLAB提供了绘制对数
和半对数坐标曲线的函数，调用格式为：
semilogx(x1,y1,选项1,x2,y2,选项2,…)
第4章 MATLAB绘图 ·77·
90 05 120 60
0.4
03
150 30 0.2,
01
180 0
210 330
240 300
270
图4.10 极坐标图
semilogy(xl,yi,选项1,x2,y2,选项2,…)
loglog(x1,y1.选项1,x2,y2,选项2,…)
其中选项的定义与plot 函数完全一致，所不同的是坐标轴的选取。semilogx 函数使用半对数坐
标，x轴为常用对数刻度，而y轴仍保持线性刻度。semilogy 函数也使用半对数坐标，y轴为常用
对数刻度，而x轴仍保持线性刻度。loglog函数使用全对数坐标，x,y轴均采用常用对数刻度。
例4.10 绘制y=10x2的对数坐标图并与直角线性坐标图进行比较。
程序如下：
x=0:0.1:10;
y=10*x.x;
subplot(2,2,1):plot(x,y);tizle('plot(x,y)');grid on;
subplot(2,2,2);semilogx(x,y);title('semilogx(x,y)');grid on;
subplot(2,2.3);semilogy(x,y);title('semilogy(x,y)');gid on;
subplot(2,2,4);loglog(x,y);title(' loglog(x,y)');grid on;
程序执行结果如图4.11所示。
第2章曾介绍过利用冒号表达式或 linspace函数产生线性坐标向量，MATLAB还提供了一个
实用的函数 logspace,它可以按对数等间距地分布来产生一个向量。该函数的调用格式为：
logspace(a,b,n)
其中a和6是生成向量的第一个和最后一个元素，n是元素总数。当n省略时，自动产生50个
元素。
4.对函数自适应采样的绘图函数
前面介绍了很多绘图函数，基本的操作方法为：先取足够稠密的自变量向量x,然后计算出
函数值向量y,最后用绘图函数绘图。在取数据点时一般都是等间隔采样，这对绘制高频率变化
·78· 基 础 篇
plot(x y) semlogx(x,y) 1000 1000
800 800
600 600
400 400
200 200
0
0 5 10 oL101 10° 10
10? semlogy(x,y) 10? iogiog(x,y)
102 102
10° 10°
T
102!
0 5 10 102101 10° 10'
图4.11 对数坐标图
的函数不够精确。例如函数f(x)=cos(tan(πx)),在(0,1)范围有无限多个振荡周期，函数变化率
大。为提高精度，绘制出比较真实的函数曲线，就不能等间隔采样，而必须在变化率大的区段密
集采样，以充分反应函数的实际变化规律，进而提高图形的真实度。fplot 函数可自适应地对函数
进行采样，能更好地反应函数的变化规律。fplot 函数的调用格式为：
fplot(frume,lims,tol,选项)
其中 fname为函数名，以字符串形式出现。它可以是由多个分量函数构成的行向量，分量函数可
以是函数的直接字符串，也可以是内部函数名或函数文件名，但自变量都必须为x。lims为x,y
的取值范围，以行向量形式出现，取二元向量[xmin,xmax]时，x轴的范围被人为确定，取四元向
量[xmin,xmax,ymin,ymax]时，x,y轴的范围被人为确定。tol为相对允许误差，其系统默认值为
2e-3。选项定义与plot 函数相同。例如
fplot(' sin(x)',[0.2*pi],'*+)
fplot('[sin(x),cos(x)]',[0,2*pi,-1.5,1.5],le-3,'r.')
第二个语句同时绘制正弦、余弦曲线。观察上述语句绘制的正余弦曲线采样点的分布，可发
现曲线变化率大的区段，采样点比较密集。
例4.11 用fplot 函数绘制f(x)=cos(tan(πx))的曲线。
先建立函数文件myf.m,程序如下：
function y=myf(x)
y=cos( tan(pi*x));
再用fplot 函数绘制myf,m函数的曲线，命令如下：
fplot(' myf',[-0.4,1.4],1e-4)
第4章 MATLAB绘图 ·79·
得到如图4.12所示曲线。从图4.12中可看出，在x=0.5附近采样点十分密集。
也可以直接用fplot 函数绘制f(x)=cos(tan(πx))的曲线，命令如下：
fplot('cos(tan(pi*x))',[-0.4,1.4],le-4)
1
0.8
06
04
02
0
-02
-04
06
08
4 -02 0 02 0.4 0608 1 12 14
图4.12 自适应采样绘图
5.其他形式的图形
MATLAB提供的绘图函数还有很多，例如，用来表示各元素占总和的百分比的饼图、复数的
相量图，等等。下面以一个实例加以说明。
例4.12 绘制图形：
(1)某次考试优秀、良好、中等、及格、不及格的人数分别为：7,17,23,19,5,试用饼图作成绩
统计分析。
(2)绘制复数的相量图：3+2i、4.5-i和-1.5+5i。
程序如下：
subplot(1,2,1);
pie([7,17,23,19,5]);
title('饼图'):legend('优秀','良好.'中等',及格',不及格');
subplot(1,2,2);
compass([3+2i,4.5-i,-1.5+5i]);title('相量图');
程序执行结果如图4.13所示。
基 础 篇
饼图
10 %
优秀良好
相量图
90 10
中等
及格
120 60
不及格 150 5 30 本
24% 27%
180 a
210 为30
32% 240 300 270
图4.13 其他形式图形举例
4.2 三 维 图形
4.2.1 绘制三维曲线的最基本西数
最基本的三维图形函数为plot3,它是将二维绘图函数plot的有关功能扩展到三维空间，用来
绘制三维曲线。plot3函数与plot函数用法十分相似，其调用格式为：
plot3(x1,yl,zl,选项1,x2,y2,2,选项2,…,xn,yn,zn,选项n)
其中每一组x,y,z组成一组曲线的坐标参数，选项的定义和 plot 函数相同。当x,y,z是同维向
量时，则x,y,z对应元素构成一条三维曲线。当x,y,z是同维矩阵时，则以x,y,z对应列元素
绘制三维曲线，曲线条数等于矩阵列数。
例4.13 绘制空间曲线：
{y+±=02=64
曲线所对应的参数方程为：
程序如下：
t=0:pi/50:2*pi;
x=8*cos(t);y=4*sqrt(2)*sin(t);z=-4*sqn(2)*sin(1);
plot3(x,y,z,'p');
tidle('Line in 3-D Space');texi(0,0,0,'origin');
xlabel('x'),ylabel(Y'),zlabel('Z');grid;
结果如图4.14所示。
·80·
第4章 MATLAB绘图 ·81·
Line in 3-D Space
6、
4、
2、
N0 origip -2
-4、
6
10
5 10
0 5
5
0
-5
Y
-10 ·10 X
图4.14 三维曲线
4.2.2 三维曲面
1.平面网格坐标矩阵的生成
绘制z=f(x,y)所代表的三维曲面图，先要在x-y平面选定一矩形区域，假定矩形区域D
=[a,b]×[c,d],然后将[a,b]在x方向分成m份，将[c,d]在y方向分成n份，由各划分点分
别作平行于两坐标轴的直线，将区域D分成m×n个小矩形，生成代表每一个小矩形顶点坐标
的平面网格坐标矩阵，最后利用有关函数绘图。
产生平面区域内的网格坐标矩阵有两种方法：
(1)利用矩阵运算生成，命令如下。
x=a:dx:b;y=(e:dy:d)';
X=ones(size(y))*x;
Y=y*ones(size(x));
上述语句执行后，矩阵X的每一行都是向量x,行数等于向量γ的元素的个数，矩阵Y的每
一列都是向量y,列数等于向量x的元素的个数。于是X和Y相同位置上的元素(X(i,j),Y(i,
j))恰好是区域D的(i,j)网格点的坐标。若根据每一个网格点上的x,y坐标求函数值z,则得
到函数值矩阵Z。显然，X,Y,Z各列或各行所对应坐标，对应于一条空间曲线，空间曲线的集
合组成空间曲面。
(2)利用meshgrid 函数生成，命令如下。
x=a:dx:b;y=c:dy:d;
[X,Y]=meshgrid(x,y);
语句执行后，所得到的网格坐标矩阵X,Y与方法(1)得到的相同。当x=y时，meshgrid 函
·82· 基 础 篇
数可写成 meshgrid(x)。
为了说明网格坐标矩阵的用法下面举一个例子，该例子巧妙地利用网格坐标矩阵来解不定
方程。
例4.14 已知6<x<30,15<y<36,求不定方程2x+5y=126的整数解。
程序如下：
x=5:29;y=14:35;
[x,yl=meshgrid(x,y); ?[5,29]×[14,35]区域生成网格坐标
z=2*x+5*y;
k=find(z==126); ??出解的位置
??出对应位置的x,y即方程的解 x(k),y(k)
输出为：
ans =
813 18 23 28 2
即方程共有5组解：(8,22)、(13,20)、(18,18)、(23,16)、(28,14)。
2.绘制三维曲面的函数
MATLAB提供了mesh 函数和surf函数来绘制三维曲面图。mesh 函数用于绘制三维网格图。
在不需要绘制特别精细的三维曲面图时，可以通过三维网格图来表示三维曲面。surf用于绘制
三维曲面图，各线条之间的补面用颜色填充。surf 函数和mesh 函数的调用格式为：
mesh(x,y,z,c)
surf(x,y,z,c)
一般情况下，x,y,z是维数相同的矩阵。x,y是网格坐标矩阵，z是网格点上的高度矩阵，c
用于指定在不同高度下的颜色范围。c省略时，MATLAB认为c=z,亦即颜色的设定是正比于图
形的高度的，这样就可以得出层次分明的三维图形。当x,y省略时，把z矩阵的列下标当作x轴
坐标，把z矩阵的行下标当作y轴坐标，然后绘制三维曲面图。当x,y是向量时，必须要求x的
长度等于z矩阵的列，y的长度等于z矩阵的行，x,y向量元素的组合构成网格点的x-y坐标，z
坐标则取自z矩阵，然后绘制三维曲面图。
例4.15 用三维曲面图表现函数z=sin(y)cos(x)。
为便于分析各种三维曲面的特征，下面画出了3种不同形式的曲面。
程序1:
x=0:0.1;2*pi;[x,y]=meshgrid(x);z=sin(y).*cos(x);
mesh(x,y,z);xlabel('x-axis'),ylabel('y-axis'),zlabel('z-axis');title('mesh');
程序2:
x=0:0.1:2*pi;[x,y]=mesbgrid(x);z=sin(y).*cos(x);
suf(x,y,z);xlabel('x-axis'),ylabel('y-axis'),zlabel('z-axis');title('surf');
程序3:
x=0:0.1:2*pi;[x,y]=meshgrid(x);z=sin(y).cos(x);
plo3(x,y,z);xlabel('x-axis'),ylabel('y-axis'),zlabel('z-axis');itle(' plot3-1');grid;
第4章 MATLAB绘图 ·83·
程序执行结果分别如图4.15、4.16、4.17所示。从图中可以发现，网格图(mesh)中线条有颜
色，线条间补面无颜色。曲面图(surf)的线条是黑色，线条间补面有颜色。还可进一步观察到曲
面图补面颜色和网格图线条颜色都是沿z轴变化的。用plot3绘制的三维曲面实际上由三维曲
线组合面成。读者可分析一下plot3(x',y',z')所绘制曲面的特征。
mesh
Z-axis
1
05
sixe-z 0
-05、
-1、日
1、
05、
0、
-0.5、
18
6
6
4
y-axis
4
y-axis
2 2
00
图4.15 三维网格图
surf
2
2
00
图4.16 三维曲面图
4
x-axis
4
X-aXIS
6
6
8
8
·84· 基 础 篇
plot3-1
1
05、
2·exis 0、
-0.5、
-1
8
6 8
4 6
2
4
2
y-axis 00
x-axis
图4.17 用plot3绘制的曲面图
例4.16 分析由函数z=x2-2y2构成的曲面形状及与平面z=a的交线。
程序如下：
[x,y]=meshgrid(-10:0.2:10);
zl=(x.2-2*y.~2)+ eps; ??1个曲面
a= input('a=?');22=a*ones(size(x));
subplot(1,2,1);mesh(x,y,zl);hold on;mesh(x,y,z2);
??2个曲面
?别画出两个曲面
v=[-10,10,-10.10,-100,100];axis(v);gnd;
hold of;
??1子图的坐标设置
r0=abs(zl-22)<=1;
xx=r0.*x;yy=r0.*y;z=r0.*22;
??两曲面z坐标差小于1的点
??这些点上的x,y,z坐标，即交线坐标
subplot(1,2,2);
plot3(xx(r0-=0),y(r0~=0),z(r0~=0),'*');
axis(v);grid;
?第2子图画出交线
??2子图的坐标设置
程序执行时，若输入a=-25,所得三维曲面图如图4.18左图所示，曲面的交线如图4.18右
图所示。输入的a不同，曲面的交线就不同。
3.标准三维曲面
MATLAB提供了-些函数用于绘制标准二维曲面，还可以利用这些函数产生相应的绘图数
据，常用于三维图形的演示。例如，sphere函数和cylinder函数分别用于绘制三维球面和柱面。
sphere 函数的调用格式为：
[x,y,z]=sphere(n)
该函数将产生(n+1)×(n+1)矩阵x,y,z,采用这3个矩阵可以绘制出圆心位于原点、半
第4章 MATLAB绘图 ·85·
100、 100、
50 50
0 0
-50 -50
-100 100
10 10
10 10
0
0
-10-10 -10 ·10
图4.18 两曲面及其交线
径为1的单位球体。若在调用该函数时不带输出参数，则直接绘制所需球面。n决定了球面的
圆滑程度，其缺省值为20。若 n值取得较小，则将绘制出多面体表面图。
cylinder 函数的调用格式为：
[x,y,z]=sphere(R,n)
其中R是一个向量，存放柱面各个层次上的半径。例如，cylinder(3)生成一个圆柱，eylinder([10,
1])生成一个圆锥，而t=0:pi/100:4*pi;R=sin(t);cylinder(R,30)生成一个正弦型柱面。另
外，生成矩阵的大小与R向量的长度及n有关。其余与sphere 函数相同。
MATLAB还有一个peaks函数，称为多峰函数，常用于三维曲面的演示。该函数可以用来生
成绘图数据矩阵，矩阵元素由函数
f(x,y)=3(1-x2)e?2-2-10(等-x3-y)。2,-3-2-
在矩形区域[-3,3]×[-3,3]的等分网格点上的函数值确定。例如
z= peaks(30);
将生成一个30×30矩阵z,即分别沿x和y方向将区间[-3,3]等分成29份，并计算这些网格点
上的函数值。缺省的等分数是48,即p=peaks将生成一个49×49矩阵p。也可以根据网格坐标
矩阵x,y重新计算函数值矩阵，例如
[x,y]=meshgrid(-5:0.1:5);
z=peaks(x,y);
生成的数值矩阵可以作为mesh、surf等函数的参数而绘制出多峰函数曲而图。另外，若在调
用peaks 函数时不带输出参数，则直接绘制出多峰函数曲面图。
·86· 基 础 篇
4.2.3 其他三雍图形
在介绍二维图形时，曾提到条形图、饼图和填充图等特殊图形，它们还可以以三维形式出现，
使用的函数分别是bar3、pie3和 fill3。此外，还有三维曲面的等高线图。等高线图分二维和三维
两种形式，分别使用函数contour和contour3绘制。下面举例说明三维等高线图的绘制。
例4.17 绘制多峰函数的等高线图。
程序如下：
[x,y,z]=peaks;
contour3(x,y,z,12,'k);?中12代表高度的等级数
xlabel('x-axis'),ylabel('y-axis'),zlabel('z-axis');
title(' contour3 of peaks');
程序执行结果如图4.19所示。
contou3 of peaks
10
5、
sixa·2 0
-5、
-10、
2
0
0
1
2
3
-2
y-axIS 3
2
-1
M-axis
图4.19 三维等高线图
4.3 三维图形的精细处理
4.3.1 图形的裁剪处理
MATLAB定义的NaN 常数可以用于表示那些不可使用的数据，利用这种特性，可以将图形中
需要裁剪部分对应的函数值设置成NaN,这样在绘制图形时，函数值为NaN的部分将不显示出
来，从而达到对图形进行裁剪的目的。
第4章 MATLAB绘图 ·87·
例4.18 裁掉例4.15三维曲面图中z>0.25的部分。
程序如下：
x=0:0.1:2*pi;[x,y]=meshgrid(x);z=sin(y).*cos(x);
[I,J]=find(z>0.25);
for ii=1:length(I)
z(I(ii),J(ii))=NaN;
end
surf(x,y,z);
程序执行结果如图4.20所示。
0.5
0
-0.5
18
6 8
4
6
2
4
2
0 0
图4.20 图形裁剪
4.3.2 视点处理
在日常生活中，从不同的视点观察物体，所看到的物体形状是不一样的。同样，从同不视点
z 绘制的三维图形其形状也是不一样的。视点位置可由方位
视点 角和仰角表示。方位角又称旋转角，它是视点与原点连线 y
在x-y平面上的投影与y轴负方向形成的角度，正值表示
逆时针，负值表示顺时针。仰角又称视角，它是视点与原点
连线与x-y平面的夹角，正值表示视点在x-y平面上 仰角 o 方，负值表示视点在x-y平面下方。图4.21示意了坐标 x
系中视点的定义，图中箭头方向表示正的方向。 方位角
从视点的定义不难看出，仰角为90°或-90°表示视点在z
轴。仰角为0°表示视点在x-y平面上，此时从x轴正方向 图4.21 视点的定义
·88· 基 础 篇
看方向角为90°,从y轴负方向看方向角为0°。据此，通过视点的设置可以绘制出三维曲面在不同
平面上的投影。MATLAB提供了设置视点的函数view。其调用格式为：
view(az,cl)
其中az为方位角，el为仰角，它们均以度为单位。系统缺省的视点定义为方位角-37.5°,仰角
30°,
例4.19 从不同视点绘制多峰函数曲面。
程序如下：
subplot(2,2,1);mesh(peaks);
view(-37.5,30); ??定子图1的视点
title('azimuth=-37.5,elevation=30')
subplot(2,2,2);mesh(peaks);
view(0,90); ??定子图2的视点
title(' azimuth=0.elevation=90')
subplot(2,2,3);mesb(peaks);
view(90,0); ??定子图3的视点
title(' azimuth=90,elevation=0·)
subplot(2,2,4);mesh(peaks);
view(-7,-10); ??定子图4的视点
title(' azinuth=-7,elevation=-10')
程序执行结果如图4.22所示，该图充分反映了视点对图形的影响。
azimuth=37.5,elevatian=30 azimuth=0,elevation=90
50
10 40
0
30
5
20
-10 50 50 10
D0 0
0 20 40 60
azimuth=90,elevaticn=0 azimuth=7,eievation=·10 10
10- 5
5-
0
0
5 5
-10 -10, o
20 40 60 0 20 40 6050
图4.22 不同视点图形
第4章 MATLAB绘图 ·89·
4.3.3 色彩处理
1.颜色的向量表示
MATLAB除用字符表示颜色外(见表4.1),还可以用含有3个元素的向量表示颜色。向量元
素在[0,1]范围取值，3个元素分别表示红、绿、蓝3种颜色的相对亮度，称为RGB三元组。表4.2
中列出了几种常见颜色的RGB值。
表4.2 几种常见颜色的RGB值
RGB值 颜色 字符 RGB值 颜色
b 蓝色
绿色 8
红色 r
青色 c
品红色 m
黄色 y
黑色 k
111
[0.5 0.5 0.5]
[0.67 01]
[1 0.5 0]
[1 0.62 0.40
[0.49 1 0.83
白色
灰色
紫色
橙色
铜色
宝石蓝
字符
[0 0 1] w
[0 1 0]
[10 0]
[0 11]
[1 0 1]
[1 10]
[0 0 0]
2.色图
色图(Color map)是MATLAB系统引人的概念。在MATLAB中，每个图形窗口只能有一个色
图。色图是m×3的数值矩阵，它的每一行是RGB三元组。色图矩阵可以人为地生成，也可以
调用MATLAB提供的函数来定义色图矩阵。表4.3列出了定义色图矩阵的函数，色图矩阵的维
数由函数调用格式决定。例如
表4.3 定义色图矩阵函数
函 数 名 含 义 函 数 名 含义
autumn 红、黄浓淡色
蓝色调浓淡色
三浓淡多彩交错色
青、品红浓淡色
纯铜色调线性浓淡色
红一白一蓝一黑交错色
灰色调线性浓淡色
黑、红、黄、白浓淡色
两端为红的饱和值色
jet
lines
pink
prism
spring
summer
winter
white
蓝头红尾饱和值色
bone 采用plot绘线色
colorcube 淡粉红色图
cool 光谱交错色
copper 青、黄浓淡色
flag 绿、黄浓淡色
gray 蓝、绿浓淡色
hot 全白色
hav
M=hot;
生成64×3色图矩阵M,表示的是从黑色、红色、黄色到白色的由浓到淡的颜色。又如
P=gray(100);
生成100×3色图矩阵P,表示的是灰色由浓到淡的颜色。
除plot 及其派生函数外，mesh、surf等函数均使用色图着色。图形窗口色图的设置和改变，使
·90· 基 础 篇
用函数：
colormap(m)
其中m代表色图矩阵。
3.三维表面图形的着色
三维表面图实际上就是在网格图的每一个网格片上涂上颜色。surf 函数用缺省的着色方式
对网格片着色。除此之外，还可以用shading命令来改变着色方式。
(1)shading faceted命令 将每个网格片用其高度对应的颜色进行着色，但网格线仍保留着，
其颜色是黑色。这是系统的缺省着色方式。
(2)shading flat命令 将每个网格片用同一个颜色进行着色，且网格线也用相应的颜色，从
而使得图形表面显得更加光滑。
(3)shading intep 命令 在网格片内采用颜色插值处理，得出的表面图显得最光滑。
例4.20 3种图形着色方式的效果展示。
程序如下：
z=peaks(20);colormap(copper);
subplot(1,3,1);surf(z);
subplot(1,3,2);surf(z);shading flat;
subplot(1,3,3);surf(z);shading interp;
程序执行结果如图4.23所示。
10 10 10
5 5 5
o 0 0
5 5 -5
-10
20
-10
20
20 20
-10
20
20
10 10
00
10 10
00
图4.23 图形着色
10 10
00
第4章 MATLAB绘图 ·91
4.3.4 光监处理
使用光照处理将把图形表现得更加真实。MATLAB提供了灯光设置的函数，其调用格式为：
light(' Color',选项1,'Sryle',选项2,' Position',选项3)
其中选项1表示光的颜色，取 RGB三元组或相应的颜色字符。选项2有'infinite'和'local'两个
取值，分别表示无穷远光和近光。选项3取三维坐标点组成的向量形式[x,y,z]。对远光，它表
示穿过该点射向原点；对于近光，它表示光源所在位置。假如函数不包含任何参数，则采用缺省
设置：白光、无穷远、穿过(1,0,1)点射向坐标原点。
例4.21 光照处理后的多峰函数曲面。
程序如下：
2=peaks(20);
subplot(1,2,1);surf(z);
light(' Posi',[0,20,10]);shading interp;hold on;
plot3(0,20,10,'p');text(0,20,10,'light');
subplot(1,2,2);surf(z);
light(' Posi',[20,0.10]);shading interp;hold on;
plot3(20,0,10,'p');text(20,0,10,' light');
程序执行结果如图4.24所示。
10*light 10、
*lght
5 5
0 0
-5 5、
-10
20
-10
20
20 20
10 10
图4.24 光照处理后的图形
10 10
00 00
+92 基 础 籍
4.4 图像与动画
4.4.1 田缘
MATLAB基本系统提供了几个用于简单图像处理的函数，利用这些函数可进行图像的读写
和显示。此外，MATLAB还有一个功能更强的图像处理工具箱，可以对图像进行更专业的处理。
1.imread和imwrite 函数
imread和imwrite 函数分别用于将图像文件读入 MATLAB工作空间，以及将图像数据和色图
数据一起写入一定格式的图像文件。MATLAB支特多种图像文件格式，如，bmp…ipg、ipeg..6f
等。
2.image和imagese 函数
这两个函数用于图像显示。为了保证图像的显示效果，一般还应使用calormap 函数设置图
像色图。
例4.22 在E盘根目录下有一图像文件 building jpg,在图形窗口显示该图像。
程序如下：
[x,cmapl=imead('e:Mbuilding.jpg'):??取图像的数据阵和色图阵
inape(x)soobunap{cmap);
axis imsge 条保待宽高比并取消坐标轴
执行结果如图4.25所示。
图4.25 图像显示
第4章 MATLAB绘图 ·93·
4.4.2 动画
如果将MATLAB产生的多幅图形保存起来，并利用系统提供的函数进行播放，就可产生动画
效果。系统所提供的动画功能函数有getframe、moviein和movie。
1.getframe 函数
getframe函数可截取每一幅画面信息而形成一个很大的列向量。该向量可保存到一个变量
中。显然，保存 n幅图就需一个大矩阵。
2.moviein 函数
moviein(n)函数用来建立一个足够大的n列矩阵。该矩阵用来保存 n幅画面的数据，以备
播放。之所以要事先建立一个大矩阵，是为了提高程序运行速度。
3.movie函数
movie(m,n)函数以每秒 n幅图的速度播放由矩阵m的列向量所组成的画面。
例4.23 播放一个直径不断变化的球体。
程序如下：
[x,y,z]=sphere(50);
m=moviein(30); ??立--个30列大矩阵
for i=1:30
surf(i*x,i*y,i*z)
m(:,i)=getframe;
??制球面
??球面保存到m矩阵
end
movie(m,10); ??每秒10幅的速度播放球面
4.5 低层绘图操作
迄今为止，本书所介绍的都是MATLAB高层绘图函数。绘图本来是一项很繁琐的工作，需要
确定很多参数，但MATLAB高层绘图函数代替用户做了这些工作，给定了参数的缺省值，这样就
使用户免去了一些操作细节，用起来很方便。但一旦遇到缺省值不能满足实际需要时，就需要用
户的干预。低层绘图操作就能解决这个问题。
4.5.1 形对象及其句杨
1.图形对象
MATLAB把构成图形的各个基本要素称为图形对象。这些对象包括计算机屏幕、图形窗口
(Figure)、坐标轴(Axes)、用户菜单(Uimenu)、用户控件(Uicontrol)、曲线(Line)、曲面(Surface)、文字
(Text)、图像(Image)、光源(Light)、区域块(Patch)和方框(Rectangle)。系统将每一个对象按树型结
构组织起来(图4.26)。每个图形对象都可以被独立地操作。
在MATLAB中，每一个具体的图形都是由若干个不同的图形对象组成。每个具体图形不一
定包含全部对象，但必须带有计算机屏幕和图形窗口对象。
·94· 基 础 篇
用户菜单
曲线 曲面
图4.26 图形对象的树型结构
计算机屏幕是产生其他对象的基础，称之为根对象。它包含一个或多个图形窗口对象。一
个图形窗口对象有3种不同类型的子对象：坐标轴、用户菜单和用户控件。其中后两类对象用于
构建图形用户界面，第7章将做专门介绍。坐标轴有7种不同类型的子对象：曲线、曲面、文字、
图像、光源、区域块、方框。对坐标轴及其7种子对象的操作即构成低层绘图操作，本节介绍其主
要内容。
2.图形对象句柄
MATLAB在创建每-个图形对象时，都为该对象分配惟一的一个值，称其为图形对象句柄
(Handle)。句柄是图形对象的惟一标识符，不同对象的句柄不可能重复和混淆。
计算机屏幕作为根对象由系统自动建立，其句柄值为0,而图形窗口对象的句柄值为一正整
数，并显示在该窗口的标题栏，其他图形对象的句柄为浮点数。MATLAB提供了3个用于获取已
有图形对象句柄的函数：
gcf 获取当前图形窗口的句柄(get current figure)。
gca 获取当前坐标轴的句柄(get current axis)。
gco 获取最近被单击的图形对象的句柄(get current object)。
为了以后对图形对象进行操作，可以在建立该对象时保存其句柄。例如，hf=figure命令用
figure 函数建立一个图形窗口对象，并将其句柄赋给变量hf保存，以后就可以通过该句柄对图形
窗口进行操作。
4.5.2 图形对象属性
1.属性名与属性值
每种图形对象都具有各种各样的属性，MATLAB正是通过对属性的操作来控制和改变图形
对象的。为方便属性的操作，MATLAB给每种对象的每一个属性规定了一个名字，称为属性名，
而属性名的取值称为属性值。例如，LineStyle是曲线对象的一个属性名，它的值决定着线型，取
值可以是-、:-.--或none。在属性名的写法中，不区分字母的大小写，而且在不引起歧义
的前提下，属性名不必写全。例如，lines就代表LineStyle。此外，属性名要用单撤号括起来。
2.属性的操作
当创建一个对象时，必须给对象的各种属性赋予必要的属性值，否则，系统自动使用缺省属
计算机屏幕
图形窗口
坐标轴 用户控件
文字 图像 光源 区域块 方框
第4章 MATLAB绘图 ·95·
性值。用户可以通过set函数重新设置对象属性，同时也可通过get函数获取这些属性值。
set 函数的调用格式为：
set(句柄，属性名1,属性值1、属性名2,属性值2,…)
其中句柄用于指明要操作的对象。如果在调用set 函数时省略全部属性名和属性值，则将显示出
句柄所有的允许属性。
曾经提及，绘制二维曲线时，通过选择不同的选项可以设置曲线的颜色、线型和数据点的标
记符号，下面用图形句柄操作来实现。假定要绘制正弦曲线，命令如下：
x=0:pi/10:2*pi;
h=plot(x,sin(x));
set(h,'Color','r','LineStyle+.':,'Marker','p');
先用缺省属性绘制正弦曲线并保存曲线句柄，然后通过改变曲线的属性来设置曲线的颜色、
线型和数据点的标记符号。事实上，还有很多其他属性，通过改变这些属性，可对曲线作更进一
步的控制。
get 函数的调用格式为：
V=get(句柄，属性名)
其中V是返回的属性值。如果在调用get函数时省略属性名，则将返回句柄所有的属性值。
用get 函数米获得上述曲线的属性值。例如
col=get(h,'Color');
将得到曲线的颜色属性值[100],即红色。
用get 函数可获取屏幕的分辨率：
V=get(0,' ScreenSize')
此时，get 函数将返回一个1×4的向量V,其中前两个分量分别是屏幕的左下角横纵坐标(1,1),
而后两个分量分别是屏幕的宽度和高度。假如屏幕分辨率设置为800×600,则V的值为[11
800 600]。这有助于依据现行屏幕的分辨率来设置图形窗口的大小。
3.对象的公共属性
图形对象具有各种各样的属性，有些属性是所有对象共同具备的，有些则是各对象所特有
的。这里先介绍对象常用的公共属性。
(1)Children属性。该属性的取值是该对象所有子对象的句柄组成的一个向量。
(2)Parent属性。该属性的取值是该对象的父对象的句柄。显然，图形窗口对象的Parent 属
性总是0。
(3)Tag属性。该属性的取值是一个字符串，它相当子给该对象定义了一个标识符。定义了
Tag属性后，在任何程序中都可以通过 findobj 函数获取该标识符所对应图形对象的句柄。例如，hf
= findobj(0,'Tag','Flag1')将在屏幕对象及其子对象中寻找Tag属性为Flagl的对象，并返回句
柄。
(4)Type属性。表示该对象的类型。显然，该属性的值是不可改变的。
(5)UserData属性。该属性的取值是一个矩阵，缺省值为空矩阵。在程序设计中，可以将一
个图形对象有关的比较重要的数据存储在这个属性中，借此可以达到传递数据的目的。具体做
法是，先用set 函数给某一句柄添加一些附加数据(一个矩阵),如果想使用这样的矩阵，则用get
·96· 基 础 篇
函数调用出来。
(6)Visible属性。该属性的取值是on(缺省值)或off。决定着图形窗口是否在屏幕上显示出
来。当它的值为off时，可以用来隐藏该图形窗口的动态变化过程，如窗口大小的变化、颜色的变
化等。注意，对象存在与否与对象是否可见是两回事，对象可以存在，同时又是不可见的。
(7)ButtonDownFcn属性。该属性的取值是一个字符串，一般是某个M文件名或一小段MAT LAB语句。图形对象决定了一个作用区域，当单击该区域时，MATLAB自动执行该程序段。
(8)CreateFcn属性。该属性的取值是一个字符串，一般是某个M文件名或一小段MATLAB
语句。当创建该对象时，MATLAB自动执行该程序段。
(9)DeleteFcn属性。该属性的取值是一个字符串，一般是某个M文件名或一小段MATLAB
语句。当取消该对象时，MATLAB自动执行该程序段。
例4.24 在同一坐标下画红、绿两根不同曲线，希望获得绿色曲线的句柄，并对其进行设置。
程序如下：
x=0:pi/50;2*pi;y=sin(x);z=cos(x);
plot(x,y,'r',x,z,'g');
Hl=get(gca,' Children'); ??取两曲线句柄向量HI
for k=1:size(H)
if get(H(k),'Color')==[010]
Hlg=H(k);
end
end
?10]代表绿色
??取绿色曲线句柄
pause
set(Hlg,' LineStyle',':');
??便于观察设置效果而增加本语句，可不加
??绿色曲线进行没置
4.5.3 图形对象的创建
除根对象外，所有图形对象都可以由与之同名的低层函数创建。所创建的对象置于适当的
父对象之中，当父对象不存在时，MATLAB会自动创建它。例如，用line 函数画一根曲线，假如在
画线之前，坐标轴、图形窗口不存在，MATLAB会自动创建它们。假如在画线之前，坐标轴、图形
窗口已经存在，那么将在当前坐标轴上画线，且不影响该坐标轴上已有的其他对象。这一点与高
层绘图函数完全不同，需特别注意。
创建对象的各低层函数调用格式类似，关键要了解对象的属性及其取值。前面介绍了各对
象的公共属性，下面介绍常用图形对象的创建方法及特殊属性。
1.图形窗口对象
图形窗口是MATLAB中很重要的一类图形对象。MATLAB的一切图形图像的输出都是在图
形窗口中完成的。掌握好图形窗口的控制方法，对于充分发挥MATLAB的图形功能和设计高质
量的用户界面是十分重要的。
建立图形窗口对象使用 figure 函数。调用该函数的命令形式为：
句柄变量=figure(属性名1,属性值1,属性名2,属性值2,…)
MATLAB通过对属性的操作来改变图形窗口的形式。也可以使用 figure 函数按 MATLAB缺
省的属性值建立图形窗口：
第4章 MATLAB绘图 ·97·
figure或句柄变量=figure
MATLAB通过figure 函数建立窗口之后，还可以调用 figure 函数来显示该窗口，并将之设定为
当前窗口，命令如下：
figure(窗口句柄)
其实，即使这里引用的窗口句柄不存在，也可以使用这一命令，它的作用是对这一窗口句柄
生成一个新的窗口，并将之定义为当前窗口。
函数“close(窗口句柄)”将关闭相应的图形窗口。close all 命令可以关闭所有的图形窗口。
clf命令则是清除当前图形窗口的内容，并不关闭窗口。
MATLAB为每个图形窗口提供了很多属性。这些属性及其取值控制着图形窗口对象。除公
共属性外，其他常用属性如下：
(1)MenuBar属性。该属性的取值可以是figure(缺省值)或none。用来控制图形窗口是否应
该具有菜单条。如果它的属性值为none,则表示该图形窗口没有菜单条。这时用户可以采用
wimenu 函数来加入自己的菜单条，如果属性值为figure,则该窗口将保持图形窗口默认的菜单条，
这时也可以采用uimenu 函数在原默认的图形窗口菜单后面添加新的菜单项。
(2)Name属性。该属性的取值可以是任何字符串，它的缺省值为空。这个字符串作为图形
窗口的标题。一般情况下，其标题形式为：Figure No.1:字符串。
(3)NumberTitle属性。该属性的取值是on(缺省值)或off。决定着在图形窗口的标题中是否
以“Figure No.n:”为标题前缀，这里 n是图形窗口的序号，即句柄值。
(4)Resize 属性。该属性的取值是on(缺省值)或 off。决定着在图形窗口建立后可否用鼠标
改变该窗口的大小。
(5)Position属性。该属性的取值是一个由4个元素构成的向量，其形式为[nl,n2,n3,n4]。
这个向量定义了图形窗口对象在屏幕上的位置和大小，其中n1和n2分别为窗口左下角的横纵
坐标值，n3和 n4分别为窗口的宽度和高度。它们的单位由Units属性决定。
(6)Units 属性。该属性的取值可以是下列字符串中的任何一种：pixel(像素，为缺省值)、nor malized(相对单位)、inches(英寸)、centimeters(厘米)和points(磅)。
Units属性定义图形窗口使用的长度单位，由此决定图形窗口的大小与位置。除了normalized
以外，其他单位都是绝对度量单位。相对单位 normalized将屏幕左下角对应为(0,0),面右上角对应
为(1.0,1.0)。该属性将影响一切定义大小的属性项，如前面的Position属性。如果在程序中改变过
Units属性值，在完成相应的计算后，最好将Units属性值设置为缺省值，以防止影响其他函数计算。
(7)Color属性。该属性的取值是一个颜色值，既可以用字符表示，也可以用RGB三元组表
示。用于控制图形窗口的背景颜色缺省值为黑色。
(8)Pointer 属性。该属性的取值是arow(缺省值)、crosshair、watch、topl、topr、botl、botr、circle、
cross、fleur、custom等，用于设定鼠标标记的显示形式。
(9)对键盘及鼠标响应属性。MATLAB允许对类似于键盘和鼠标键按下这样的动作进行响
应，这类属性有KeyPressFcn(键盘键按下响应)、WindowButtonDownFcn(鼠标键按下响应)、Window ButonMotionFcn(鼠标移动响应)及WindowButtonUpFen(鼠标键释放响应)等，这些属性所对应的属
性值可以为用MATLAB编写的函数名或命令名，表示-旦键盘键或鼠标键按下之后，将自动调用
给出的函数或命令。
·98· 基 础 篇
例4.25 建立一个图形窗口。该图形窗口没有菜单条，标题名称为“图形窗口示例”,起始
于屏幕左下角、宽度和高度分别为300像素和150像素，背景颜色为绿色，且当用户从键盘按下
任意一个键时，将显示"Hello,Keyboard Key Pressed."字样。
命令如下：
hf=figure(' Color',[0,1,0],' Position',[1,1,300,150]....
'Name',图形窗口示例',NunberTitle','off',' MenuBar','none',...
'KeyPressFcn'.'disp("Hello,Keyboard Key Pressed.")');
例4.26 分别在4个不同的图形窗口绘制出正弦、余弦、正切、余切曲线。要求先建立一个
图形窗口并绘图，然后每关闭一个再建立下一个，直到建立第4个窗口并绘图。
程序如下：
x=linspace(0,2*pi,60);
y=sin(x);z= cos(x);t=tan(x);ct=1./(t+ eps);
?令组待用
C4=['figure("Name","cotangent(x)","NumberTitle",',..
"off");plot(x,ct);axis([0,2*pi,-40,40]);'];
C3=[' figure("Name"," tangent(x)","DeleteFcn",C4,,..
'"NumberTitle","off");plot(x,t);axis([0,2*pi,-40,40]);];
C2=['figure("Name","coe(x)","DeleteFcn",C3,,...
"NumberTide","of");plot(x,z);axis([0,2*pi,-1,1]);'];
?创建1个图形窗口并绘制曲线
figure('Name','sin(x),'DeleteFen',C2,' NumberTite*,'off');
plot(x,y);axis([0,2*pi,-1,1]);
2.坐标轴对象
坐标轴是MATLAB中另一类很重要的图形对象。坐标轴对象是图形窗口的子对象，每个图
形窗口中可以定义多个坐标轴对象，但只有一个坐标轴是当前坐标轴，在没有指明坐标轴时，所
有的图形图像都是在当前坐标轴中输出。必须弄清一个概念，所谓在某个图形窗口中输出图形
图像，实质上是指在该图形窗口的当前坐标轴中输出图形图像。
建立坐标轴对象使用axes 函数，调用它的命令形式为：
句柄变量=axes(属性名1,属性值1,属性名2,属性值2,…)
调用axes 函数用指定的属性在当前图形窗口创建坐标轴，并将其句柄赋给左边的句柄变
量。也可以使用axes 函数按MATLAB缺省的属性值在当前图形窗口创建坐标轴：
axes 或 句柄变量=axes
用axes函数建立坐标轴之后，还可以调用axes 函数将之设定为当前坐标轴，且坐标轴所在
的图形窗口白动成为当前图形窗口：
axes(坐标轴句柄)
注意，这里引用的坐标轴句柄必须存在，这与 figure 函数的对应调用形式不同。
MATLAB为每个坐标轴对象提供了很多属性。除公共属性外，其他常用属性如下：
(1)Box属性。该属性的取值是on或off(缺省值)。它决定坐标轴是否带有边框。
(2)GridLineStyle属性。该属性的取值可以是：(缺省值)、-、-.、-或none。该属性定义
网格线的类型。
第4章 MATIAB绘图 ·99·
(3)Position属性。该属性的取值是一个由4个元素构成的向量，其形式为[n1,n2,n3,n4]。
这个向量在图形窗口中决定一个矩形区域，坐标轴就位于其中。该矩形的左下角相对于图形窗
口左下角的坐标为(n1,n2),矩形的宽和高分别为n3和n4。它们的单位由Units属性决定。
(4)Units属性。该属性的取值是normalized(相对单位，为缺省值)、inches(英寸)、centimeters
(厘米)和points(磅)。Units属性定义 Position属性的度量单位。
(5)Title属性。该属性的取值是坐标轴标题文字对象的句柄，可以通过该属性对坐标轴标
题文字对象进行操作。例如，要改变标题的颜色，可执行命令：
set(get(gca,' Title'), Color',tr')
(6)XLabel、YLabel、ZLabel属性。3种属性的取值分别是x,y,z轴说明文字的句柄。
(7)XLim、YLim、ZLim 属性。3种属性的取值都是2个元素的数值向量。三属性分别定义各
坐标轴的上下限，缺省值为[0,1]。以前介绍的axis 函数实际上是对这些属性的直接赋值。
(8)XScale、YScale、ZScale属性。3种属性的取值都是linear(缺省值)或log,这些属性定义各
坐标轴的刻度类型。
(9)View属性。该属性的取值是2个元素的数值向量，定义视点方向。
例4.27 利用坐标轴对象实现图形窗口的任意分割。
利用axes函数可以在不影响图形窗口上其他坐标轴的前提下建立一个新的坐标轴，从而实
现图形窗口的任意分割。程序如下：
clf;??图形窗口
x= linspace(0,2* pi,20);y=sin(x);
axes(' Posi',[0.2,0.2,0.2,0.7]);plot(y,x);title(' sin(x)-1');
axes('Posi',[0.4,0.5,0.2,0.1]);stais(x,y);title(' sin(x)-2');
axes('Posi',[0.55,0.6,0.25,0.3]);stem(x,y);title('sin(x)-3');
axes(' Posi',[0.55,0.2,0.25,0.3]);stem(x,y);title('sin(x)-4');
程序执行结果如图4.27所示。
7
6
5
4
3
2
1
0
-1
sin(x)-1 1
0.6q
b
oφ 4
o
-0.5 d
o
sin(x)-2 d
1
0 5
sin(x}4 -1 5
0.5ld p
0 P
-0.5 d
d
D 1
-1
0 5
图4.27 图形窗口的任意分割
sin(0-3
10
10
·100· 基 础 篇
3.曲线对象
曲线对象是坐标轴的子对象，它既可以定义在二维坐标系中，也可以定义在三维坐标系中。
建立曲线对象使用line 函数，调用它的命令形式为：
句柄变量=line(x,y,z,属性名1,属性值1,属性名2,属性值2,…)
其中对x,y,z的解释与高层曲线函数 plot和plot3等一样，其余的解释与前面介绍过的 figure和
axes 函数类似。
每个曲线对象也具有很多属性.除公共属性外，其他常用属性如下：
(1)Color属性。定义曲线的颜色。
(2)LineStyle属性。定义线型。
(3)LineWidth属性。定义线宽。缺省值为0.5磅。
(4)Marker属性。定义数据点标记符号。缺省值为none。
(5)MarkerSize属性。定义数据点标记符号的大小。缺省值为6磅。
(6)XData、YData、ZData属性。3种属性的取值都是数值向量或矩阵。分别代表曲线对象的
3个坐标轴数据。
4.文字对象
文字对象主要用于给图形添加文字标注。MATLAB从5.0版本开始，对文字对象作了重大
改进，在文字对象中除使用一般的文字以外，还允许使用LATEX(LATEX是一种十分流行的数学
排版软件)文本，这样就可以在图形上添加希腊字母、数学符号及公式等内容。
使用text 函数可以根据指定位置和属性值添加文字说明，并保存句柄。调用该函数的命令
形式为：
句柄变量= text(x,y.z,'说明文字',属性名1.属性值1,属性名2,属性值2,…)
其中说明文字中除使用标准的ASCII字符外，还可使用LATEX格式的控制字符。例如
h= text(0.5,0.5,'x2+sin(I \omegalt+|\ betal)');
将得到标注效果：x2+sin(at+β)。
除公共属性外，文字对象的其他常用属性如下：
(1)Color 属性。定义文字对象的显示颜色。
(2)String 属性。该属性的取值是字符串或字符串矩阵，它记录着文字标注的内容。
(3)Interpreter 属性。该属性的取值是latex(缺省值)或 none,该属性控制对文字标注内容的
解释方式，即LATEX方式或ASCII方式。
(4)FontSize属性。定义文字对象的大小。缺省值为10磅。
(5)Rotation属性。该属性的取值是数值量，缺省值为0。它定义文字对象的旋转角度，取正
值时表示逆时针方向旋转，取负值时表示顺时针方向旋转。
例4.28 利用曲线对象完成例4.5。
程序如下：
x=(0:pi/100:2*pi)';
yl=2*exp(-0.5*x)*[1,-1];
y2=2*exp(-0.5*x).*sin(2*pi*x);
x1=(0:12)/2;
y3=2* exp(-0.5*x1),*sin(2*pi*x1);
第4章 MATLAB绘图 ·101·
line(x,yl,'LineStyle',':','color','g');
line(x,y2,'LineStyle','--',' color','b');
line(xl,y3,'LineStyle',' none,' Marker','p','color'.'r');
title('曲线及其包络线');
xlabel(' independent variable X');
yiabel(' independent variable Y');
1ext(2.8,0.55,'2e^1-0.5x},'FontSize',12);
lexi(0.45,0.55,'y=2e^l-0.5x!sin(21\pi}x)°,' FontSize',12);
text(1.4,0.1,'离散数据点');
legend('包络线',包络线',曲线y',离散数据点')
程序执行结果如图4.28所示。
曲线及其包络线
2
15
1
independent vanable Y 0.5 y=2e 5
sin(2πX`2e-0.5×
离散购锯点
-0.5
-1
-1.5
-2
0 1 2 3 4 5
-包络线
一曲线y
-包络线
☆离散数据点
6 7
independent vanableX
图4.28 利用曲线对象绘制的曲线
5.曲面对象
曲面对象也是坐标轴的子对象，它定义在三维坐标系中，而坐标系可以在任何视点下。建立
曲面对象使用surface函数，调用它的命令形式为：
句柄变量=surface(x,y,z.属性名1,属性值1,属性名2,属性值2,…)
其中对x,y,z的解释与高层曲面函数mesh和surf等一样，其余的解释与前面介绍过的 figure和
axes 等函数类似。
每个曲面对象也具有很多属性。除公共属性外，其他常用属性如下：
(1)EdgeColor属性。该属性的取值是代表某颜色的字符或 RGB值，还可以是flat 、interp或
none。缺省为黑色。定义曲面网格线的颜色或着色方式。
(2)FaceColor属性。该属性的取值是代表某颜色的字符或RGB值，还可以是flat(缺省值)、
·102· 基 础 篇
interp或none。定义曲面网格片的颜色或着色方式。
(3)LineStyle属性。定义曲面网格线的线型。
(4)LineWidth属性。定义曲面网格线的线宽。缺省值为0.5磅。
(5)Marker 属性。定义曲面数据点标记符号。缺省值为none。
(6)MarkerSize属性。定义曲面数据点标记符号的大小。缺省值为6磅。
(7)XData、YData、ZData属性。3种属性的取值都是数值向量或矩阵。分别代表曲面对象的
3个坐标轴数据。
例4.29 利用曲面对象绘制三维曲面z=sin(y)cos(x)。
程序如下：
x=0:0.1:2*pi;[x,y]=meshgrid(x);z=sin(y).*cos(x);
axes('view',[-37.5,30]);
hs=surface(x,y,z,'FaceColor','w','EdgeColor',' flat');
grid on;xlabel('x-axis'),ylabel('y-axis'),zabel('z-axis');ile(' mesh-surf');
pause;
set(hs,' FaceColor',' flat');
开始网格片的颜色设为白色，实际上得到的是网格图，这与高层函数 mesh所画曲面相同(见
图4.15)。暂停后，重新设置网格片的颜色，得到着色表面图(图4.29所示)。
mesh-surt
z-axis
1、
0.5、
0、
-0.5、
18
6 8
4
y-axiS
6
2
4
2
D 0
X-axis
图4.29 利用曲面对象绘制的曲面
第4章 MATLAB绘图 ·103·
习 题 四
1.绘制下列曲线。
(1)y-10 (2)y=2
(3)x2+y2=1 4){)=5
2.绘制下列极坐标图。
(1)p=5cosθ+4 (2)e=倍
(3)p=5-7 (4)e=38
3.绘制下列三维图形。
(2)z=5
(4)z (3)z=盖+
4.分别用plot和 fplot 函数绘制下列分段函数的曲线。
5.绘制例2.5经过处理后的正弦波。
6.某工厂2000年度各季度产值(单位：万元)分别为：450.6、395.9、410.2、450.9,试绘制折线图和饼图，并说
明图形的实际意义。
+25=1 7.根据 1绘制平面曲线，并分析参数a对其形状的影响。
8.低层绘图操作的基本思路是什么?它同高层绘图操作相比有何特点?
第5章 MATLAB数值计算
数值计算在科学研究与工程应用中有非常广泛的应用。许多数值计算问题，用其他程序设
计语言编程求解非常麻烦，并且需要具备专门的数学知识及一定的程序设计技能，而用MATLAB
编程，往往只要很少几个语句即可完成求解任务，而且它编程效率高、对程序员的数学背景知识
要求低。MATLAB这种强大的数值计算能力，使其在科学计算方面成为了用户的首选工具。
本章先介绍线性代数中的数值计算问题，包括特殊矩阵、矩阵分析、线性方程组求解等内容，
然后介绍数据处理和多项式计算，包括数据的分析与统计、数据插值、曲线拟合及多项式计算等
内容，最后介绍数值微积分、常微分方程数值解以及非线性代数方程求解等内容。
5.1 特 殊 矩 阵
本节在矩阵基本运算的基础上，讨论特殊矩阵及其实现问题，包括矩阵的三角提取、对角提
取以及特殊矩阵生成等内容。
5.1.1 对角阵与三角阵
1.矩阵的对角元素
矩阵的第一行第一列和第p行p列组成的一条斜线称为主对角线，有时把主对角线就简称
为对角线，把与主对角线垂直的另一条对角线称为次对角线。只有对角线上有非0元素的矩阵
称为对角矩阵简称对角阵，对角线上的元素相等的对角矩阵称为标量矩阵或数量矩阵，对角线上
的元素都为1的对角矩阵称为单位矩阵。矩阵的对角线有许多性质：如转置运算时对角线元素
不变，相似变换时对角线上的元素的和(称为矩阵的迹)不变等。在研究矩阵时，很多时候需要将
矩阵的对角线上的元素提取出来形成一个列向量，而有时又需要用一个向量构造一个对角阵。
(1)提取矩阵的对角线元素
设A为mxn矩阵，diag(A)函数提取矩阵A主对角线元素，产生一个具有min(m,n)个元素
的列向量。例如，在MATLAB命令窗口输入命令，得到的结果如下：
A=[10,20,30;40,50.60];
D=diag(A)
D=
10
50
diag(A)函数还有更进 步的形式 diag(A,k),其功能是提取第k条对角线的元素。与主对
角线平行，往上为第1条、第2条、…、第 n条对角线，往下为第-1条、第-2条、…、第-n条对
角线。主对角线为第0条对角线。例如，对于上面建立的A矩阵，提取其主对角线两侧对角线
第5章 MATLAB数值计算 ·105·
的元素，命令及运行结果如下：
D1= diag(A,1)
D=
20
60
D2=diag(A,-1)
D=
40
(2)构造对角矩阵
设V为具有m个元素的向量，diag(V)将产生一个m×m的对角矩阵，其主对角线元素即为
向量V的元素。例如，在MATLAB命令窗口输人命令，及得到的结果如下：
diag([1,2,-1,4j)
ans =1000
0200
00-10
0004
diag(V)函数也有更进一步的形式 diag(V,k),其功能是产生一个n×n(n=m+Ik1)对角
阵，其第k条对角线的元素即为向量V的元素。例如
diag(1;3,-1)
ans =
0000
1000
0200
0030
例5.1 先建立5×5矩阵A,然后将A的第1行元素乘以1,第2行乘以2,…,第5行乘以5。
用一个对角矩阵左乘一个矩阵时，相当于用对角阵的第1个元素乘以该矩阵的第1行，用对
角阵的第2个元素乘以该矩阵的第2行，…,依次类推，因此只需要按要求构造一个对角矩阵D,
并用D左乘A即可。命令如下及运行结果：
A=[17,0,1,0,15;23,5,7,14,16;4.0.13,0,22;10,12,19,21,3;11,18,25,2,19];
D=diag([1,2.3,4,5]);
D*A ??D左乘A,对A的每行乘以一个指定常数
ans=
17 0 1 015
46 10 14 2832
0 12 39 066
40 48 76 8412
55 90 95 125 10
如果要对A的每列元素乘以同一个数，可以用一个对角阵右乘矩阵A。
2.矩阵的三角阵
三角矩阵简称三角阵，三角阵又进一步分为上三角阵和下三角阵，所谓上三角阵，即矩阵的
·106· 基 础 篇
对角线以下的元素全为0的一种矩阵，而下三角阵则是对角线以上的元素全为0的一种矩阵。
(1)下三角矩阵
与矩阵A对应的下三角阵B是与A同型(具有相同的行数和列数)的一个矩阵，并且B的对
角线以下(含对角线)的元素和A对应相等，而对角线以上的元素等于0。求矩阵A的下三角阵的
MATLAB函数是tril(A)。例如，提取矩阵A的下三角元素，形成新的矩阵B,命令及运行结果如下：
A=[37,10,-8;2,19,8;0,34,-65];
B=tril(A)
B=
3700
2190
0 -65 34
tril(A)函数也有更进一步的一种形式tril(A,k),其功能是求矩阵A的第k条对角线以下的
元素。例如，提取矩阵A的第2条对角线以下的元素，形成新的矩阵B,命令及运行结果如下：
A=[17,0,1,0,15;23,5,7,14,16;4,0,13,0,22;10,12,19,21.3;11,18,25,2,19];
B=tril(A,2)
B=
17 0 1 0 0
23 5 7 14 0
4 0 13 0 22
10 12 19 21 3
11 18 25 2 9
(2)上三角矩阵
在MATLAB中，提取矩阵A的上三角矩阵的函数是triu(A)和triu(A,k),其用法与提取下三
角矩阵的函数tril(A)和tril(A,k)完全相同，请读者自己总结该函数的基本功能和用法。
5.1.2 特殊版阵的生城
MATLAB中提供了一些函数，利用这些函数可以很方便地生成一些特殊矩阵，下面介绍几个
常用函数的功能和用法。
1.魔方矩阵
魔方矩阵有一个有趣的性质，其每行、每列及两条对角线上的元素和都相等。对于n阶魔
方阵，其元素由1,2,3,…,n2共n2个整数组成。MATLAB提供了求魔方矩阵的函数magic(n),其
功能是生成一个n阶魔方阵。
例5.2 将101～125这25个数填人一个5行5列的表格中，使其每行每列及对角线的和均
为565。
首先构造一个5阶魔方矩阵，使其每行、每列及对角线的和均为65,然后，对其每个元素都
加100后这些和都变为565。命令及运行结果如下：
B=100+magie(5)
B=
第5章 MATLAB数值计算 ·107·
117 124 101 108 115
123 105 107 114 116
104 106 113 120 122
110 112 119 121 103
111 118 125 102 109
2.范得蒙德矩阵
下面是一个范得蒙德(Vandermonde)矩阵的实例：
其最后一列全为1,倒数第二列为一个指定的向量，其他各列是其后列与倒数第二列的乘
积。可以用一个指定向量生成一个范得蒙德矩阵。在MATLAB中，函数 vander(V)生成以向量V
为基础向量的范得蒙德矩阵。例如，A=vander([1;2;3;5])即可得到上述范得蒙德矩阵。
3.希尔伯特矩阵
h=i+}- 希尔伯特(Hilbert)矩阵的每个元素 。在MATLAB中，生成希尔伯特矩阵的函数
是bilb(n)。希尔伯特矩阵是一个条件数(详见5.2.6节)很差的矩阵，使用一般方法求逆会因为
原始数据的微小扰动而产生不可靠的计算结果。MATLAB中，有一个专门求希尔伯特矩阵的逆
的函数invhilb(n),其功能是求n阶的希尔伯特矩阵的逆矩阵。
4.特普利茨矩阵
特普利茨(Toeplitz)矩阵除第1行第1列外，其他每个元素都与左上角的元素相同。生成特
普利茨矩阵的函数是toeplitz(x,y),它生成一个以x为第1列，y为第1行的特普利茨矩阵。这里
x,y均为向量，二者不必等长。
5.友矩阵
设多项式P(x)为：
P(x)=a,x"+a-1x?1+…+a?x+a?
称矩阵A
a
0
0
0··
0
为多项式P(x)的友矩阵。在5.2.7中将指出：P(x)称为A的特征多项式，方程P(x)=0的根
称为A的特征值。
生成友矩阵的函数是：compan(P),生成多项式P的友矩阵。P是一个多项式的系数向量，
高次幂系数排在前，低次幂排在后。
·108· 基 础 篇
6.帕斯卡矩阵
我们知道，二次项(x+y)“展开后的系数随n的增大组成一个三角形表，称为杨辉三角形。由
杨辉三角形表组成的矩阵称为帕斯卡(Pascal)矩阵。函数pascal(n)生成一个n阶的帕斯卡矩阵。
例5.3 求(x+y)?的展开式。
MATLAB的命令及运行结果如下：
pascal(6)
ans 5
111
12 3 4 5 6 136 10 15 21
14 10 20 35 56
1 5 15 35 70 126
16 21 56 126 252
其次对角线上的元素1,5,10,10,5,1即为展开式的系数。
5.2 矩 阵 分 析
矩阵是MATLAB的基本处理对象，第2章介绍了怎样建立矩阵以及矩阵的基本运算，读者已
经感受到了MATLAB在处理矩阵问题时带给用户的方便性与灵活性，这一节继续讨论有关矩阵
的计算与性质。
5.2.1 矩阵结构变换
1.矩阵的转置
转置是矩阵的一种最常见的变形。所谓转置，即把源矩阵的第一行变成目标矩阵第一列，第
二行变成第二列，…,显然，一个m行n列的矩阵经过转置运算后，变成一个n行m列的矩阵。
设A为m×n矩阵，则其转置矩阵B的元素定义如下：
bA=ai=1,2,…,m,j=1,2,…,n
转置运算符是单斜撇号(')。例如，求矩阵A的转置矩阵B的命令为B=A'。
2.矩阵的旋转
在MATLAB中，可以很方便地以90°为单位对矩阵A按逆时针方向进行旋转。矩阵的旋转
利用函数ro190(A,k),功能是将矩阵A旋转90°的k倍，当k为1时可省略。例如，将A按逆时
针方向旋转90°,命令及运行结果如下：
A=[37,10,-8;2,19.8;0.34,-65];
B=rot90(A)
B=
-88-65
101934
3720
第5章 MATLAB数值计算 ·109·
如果输入的函数是rot90(A,4),结果应该是什么?请读者思考并上机验证自己的结论。
3.矩阵的左右翻转
对矩阵实施左右翻转是将原矩阵的第1列和最后1列调换，第2列和倒数第2列调换，…。
MATLAB对矩阵A实施左右翻转的函数是fliplr(A)。针对上面建立的矩阵A,将其左右翻转，命
令及运行结果如下：
B=fliplr(A)
B=
-81037
8192
-65340
4.矩阵的上下翻转
与矩阵的左右翻转类似，矩阵的上下翻转是将原矩阵的第1行与最后1行调换，第2行与倒
数第2行调换，…MATLAB对矩阵A实施上下翻转的函数是flipud(A)。
5.2.2 矩阵的递与满递
1.矩阵的逆
矩阵的逆是线性代数中的一个基本概念。对于一个方阵A,如果存在一个与其同阶的方阵
B,使得：
AB= BA=I(I为单位矩阵)
则称B为A的逆矩阵，当然，A也是B的逆矩阵。
求一个矩阵的逆是一件非常烦琐的工作，容易出错，但在MATLAB中，求一个矩阵的逆非常
容易。求方阵A的逆可调用函数inv(A)。
例5.4 用求逆矩阵的方法解线性方程组。
设
[2.
则原线性方程组可简写为
Ax=b
其解为
x=A-1b
有了上面的分析，就可以很方便地应用MATLAB求解了。命令及运行结果如下：
A=[1,2,3;1,4,9;1,8,27];b=[5,-2,6]';
x=inv(A)*b
x=
23.0000
·110· 基 础 篇
-14.5000
3.6667
用求系数矩阵逆的方法求解线性方程组虽然简单，但MATLAB不推荐用户这样做。一般情
况下，用左除比求矩阵的逆的方法更有效，即x=A\b。
2.矩阵的伪逆
如果矩阵A不是一个方阵，或者A是一个非满秩的方阵时，矩阵A没有逆矩阵，但可以找
到一个与A的转置矩阵A'同型的矩阵B,使得
ABA=A
BAB=B
此时称矩阵B为矩阵A的伪逆(也称为广义逆矩阵),记作A+。MATLAB中，求一个矩阵伪逆的
函数是pinv(A)。
例5.5 求A的伪逆，并将结果送B。
^-
命令及运行结果如下：
A=[3,1,1,1;1,3,1,1;1,1,3,1];
B=pinv(A)
B=
0.3929 -0.1071 -0.1071
-0.1071 0.3929 -0.1071
-0.1071 -0.1071 0.3929
0.0357 0.03570.0357
例5.6 设矩阵
^-
求A的伪逆。
MATLAB中，命令及运行结果如下：
A=[0,0,0;0,1,0;0,0,1];
pinv(A)
ans =
000
010
001
本例中，A是一个奇异矩阵，无一般意义上的逆矩阵，故本例中求A的伪逆矩阵。此外，例
中A的伪逆矩阵和A相等，读者不要由此得出一个错误结论：矩阵的伪逆矩阵就是该矩阵本身。
一般说来，矩阵的伪逆矩阵和自身是不同的，读者不妨用其他矩阵再上机试试。
第5章 MATLAB数值计算 ·111·
5.2.3 方阵的行列式
行列式是和矩阵并列的另一个数学概念。把一个方阵看作一个行列式，并对其按行列式的
规则求值，这个值就称为矩阵所对应的行列式的值。MATLAB中，求方阵A所对应的行列式的
值的函数是det(A)。
例5.7 用克拉默(Cramer)方法求解线性方程组 三
根据克拉默(Cramer)方法求解一个 n阶的线性方程组要计算n+1个行列式的值。在MAT LAB中，要构造 n+1个矩阵，下面通过MATLAB提供的函数来完成该运算。程序如下：
D=[2,2,-1,1;4,3,-1,2;8,5,-3,4;3,3,-2,2];??义系数矩阵
b=[4;6;12;6];
D1=[b,D(:,2:4)];
??义常数项向量
D2=[D(:,1:1),b,D(:,3:4)];
D3=[D(:,1:2),b,D(:,4:4)];
D4=[D(:,1:3),b];
DD=det(D);
??方程组的右端向量置换D的第1列
??方程组的右端向量置换D的第2列
??方程组的右端向量置换D的第3列
??方程组的右端向景置换D的第4列
xl=det(D1)/DD;
x2=det(D2)/DD;
x3= det(D3)/DD;
x4=det(D4)/DD;
[xl,x2,x3,x4]
程序执行后的输出为：
ans =
11-1-1
5.2.4 矩阵的秩
1.向量的线性相关
为理解矩阵秩的概念，先对向量的线性相关及其相关概念进行概述。设x,x?,…,xn}是 n
个向量，并且每个向量含有同样多个元素，kj,k?,…,kn|是n个不全为0的常数。称x=k?x1
+k?x?+…+kaxn为向量组{x?,x?,…,xn|的线性组合，或者称为x?,x?,…,x。的线性表示。
(1)线性相关性
若存在不全为0的一组常数1kj,k?,…,kn!,使得
k?x?+k?x?+…+kaxn=0
称向量组1x,x?,…,xnF线性相关，否则，称其线性无关。换句话说，当一组向量能线性组合成0
向量时，称其为一组线性相关的向量，否则，称其为线性无关的向量。
(2)线性无关组
·112· 基 础 篇
线性无关的一组向量称为线性无关组。若向量组x?,x?,…,xn!是满足某种条件的线性无
关组，并且在该无关组中任意添加一个满足条件的向量 x,则向量组ix,x?,x?,…,xn}线性相关，
称ix?,x?,…,xn{为最大线性无关组。对于三维向量，设x?=(1,0,0),x?=(0,1,0),x?=(0,0,
1),显然，fx?,2,x?l组成所有三维向量的最大无关组。向量的线性无关组有一个基本性质：组
成线性无关组的向量可以不同，但其个数是确定的。对于三维向量，可以找到不同于上述!x?,
x?,x?l的另一个最大线性无关组，但该最大无关组也一定是由3个线性无关的向量组成的。
2.矩阵的秩
一个矩阵中行(列)向量的最大线性无关组包含的行(列)向量的个数称为该矩阵的秩。也可
把矩阵的秩定义为矩阵的非零子式(子式就是一个矩阵的部分元素组成的行列式)的最大阶数，
后一种定义更便于实际计算一个矩阵的秩。如果一个矩阵的所有行向量线性无关，称该矩阵为
行满秩；一个矩阵的所有列向量线性无关，称该矩阵为列满秩。行(列)满秩的方阵称为满秩矩
阵。MATLAB中，求矩阵秩的函数是rank(A)。例如，求例5.7中方程组系数矩阵D的秩，命令及
运行结果如下：
D=[2,2,-1,1;4,3,-1,2;8,5,-3,4;3,3,-2,2];
r=rank(D)
r=
4
说明：D是一个满秩矩阵。
5.2.5 向量和矩阵的范数
向量和矩阵的范数是定义在向量和矩阵上的一种非负实值函数。设X是一个任意向量或
矩阵，X对应一个非负实数|X,并且，| X||应满足3种性质：
(1)当X≠0时，lx||>0;X=0时，|X||=0。
(2)对于任意常数k,有|kX|= Ikl||XⅡ。
(3)对于任意两个向量或矩阵X,Y,成立三角形不等式
X+Yll≤|Xil+lY
则称这样的函数ⅡX|I为X的范数。这里不讨论范数的一般性质，但是，读者应明确，向量和矩
阵都有多种方法定义其范数，范数的定义不同，范数值也就不同，因此，讨论向量和矩阵的范数
时，一定要弄清是求哪一种范数。
1.向量的3种常用范数及其计算函数
设向量V=(v?,v?,…,va),下面讨论向量的3种范数：
(1)2-范数lV|]?=√tr2+v?2+…+vA2
(2)1-范数 HVl=Iv?l+Iv?l+…+1vnI
(3)0-范数 V|l。=max!lv,I
从上述定义可以看到，2-范数就是向量的模。MATLAB中，求这3种向量范数的函数为：
(1)morm(V)或norm(V,2) 计算向量V的2-范数
(2)norm(V,1)计算向量V的1-范数
(3)norm(V,inf)计算向量V的≈-范数
第5章 MATLAB数值计算 ·113·
V=(-1.2 例5.8 设 ,1),求V的3种范数。
命令及运行结果如下：
V=[-1,1/2,1];
vl=norn(V.1) 呢求的1-范数
vl=
2.5000
v2=notm(V) ??V的2-范数
v2=
1.5000
vinf= norm(V,inf) ??V的-范数
vinf=
1
本例清楚地说明了，同一个向量的不同范数值不一定相同。
2.矩阵的范数及其计算函数
前面已经说明了向量的3种常用范数及其在MATLAB中的计算函数，下面以向量的范数为
基础来定义矩阵的范数。
设A是一个m×n的矩阵，V是一个含有n个元素的列向量，定义
A||= max ||AVⅡ,IlV|l=1
因为A是一个m×n的矩阵，而V是一个含有n个元素的列向量，所以A·V是一个含有n
个元素的列向量。前面已经定义了3种不同的向量范数，按照上式也可定义3种矩阵范数，这样
定义的矩阵范数ⅡA||称为A从属于向量的范数。
上式只给出了矩阵范数的基本定义，未给出具体计算方法，完全按照上式是难于计算一个矩
阵的某种具体范数的。从属于3种向量范数的矩阵范数计算公式是(a系矩阵A的元素):
(1)lIAli=,mx, lAVI,l=mxia
(2)|ⅡAl2= max,1IAVH?I=√A,其中A;为A'A最大特征值。
(3)|IA。=x,AVef=mx1ali
MATLAB中提供了求3种矩阵范数的函数，其函数调用格式与求向量的范数的函数完全相
同，这里不再赘述。
例5.9 求矩阵A的3种范数。
命令及运行结果如下：
A=[17,0,1,0,15;23,5,7,14,16;4,0,13,0,22;10,12,19,21,3;11,18,25,2,19]:
al=norm(A,1) ??A的1-范数
al=
75
a2=nom(A) ??A的2-范数
a2=
59.3617
·114· 基 础 篇
ainf = nom(A,inf) ??A的○-范数
ainf=
75
5.2.6 矩阵的条件数和迹
1.矩阵的条件数
在求解线性方程组AX=b时，一般认为，系数矩阵A中个别元素的微小扰动不会引起解向
量的很大变化。这样的假设在工程应用中非常重要，因为一般系数矩阵的数据是由实验数据获
得的，并非精确值，但与精确值误差不大，上面的假设可以得出如下结论：当参与运算的系数与实
际精确值误差很小时，所获得的解与问题的准确解误差也很小。遗憾的是上述假设并非总是正
确的。对于有的系数矩阵，个别元素的微小扰动会引起解的很大变化，在计算数学中，称这种矩
阵是病态矩阵，而称解不因系数矩阵的微小扰动而发生大的变化的矩阵为良性矩阵。当然，良性
与病态是相对的，需要一个参数来描述，条件数就是用来描述矩阵的这种性能的一个参数。定义
cond(A)=IIAI1A-11
即矩阵A的条件数等于A的范数与A的逆矩阵的范数的乘积。这样定义的条件数总是大于1
的。条件数越接近于1,矩阵的性能越好，反之，矩阵的性能越差。A有3种范数，相应地可定义
3种条件数。MATLAB中，计算A的3种条件数的函数是：
(1)cond(A,1)计算A的1-范数下的条件数，即
cond(A,1)=|lAⅡA-1非
(2)cond(A)或cond(A,2)计算A的2-范数下的条件数，即
cond(A)=A|2|A-'I?
(3)cond(A,inf)计算A的-范数下的条件数，即
cond(A,inf)=||AⅡ。|A-'|
例5.10 求矩阵
x[
的三种条件数。
命令及运行结果如下：
A=[2,2,3;4,5,-6;7,8,9];
CI=copd(A,1)
Cl=
149.1429
C2=cond(A)
C2=
87.9754
C3=cond(A,inf)
C3=
144.0000
第5章 MATLAB数值计算 ·115·
2.矩阵的迹
矩阵的迹等于矩阵的对角线元素之和，也等于矩阵的特征值之和。MATLAB中，求矩阵的迹
的函数是trace(A)。例如
X=[223;45-6;789];
trace(X)
ang =
16
5.2.7 矩阵的特征值与特征向量
在物理学、力学和工程技术中遇到的机械振动、电磁振荡及其稳定性问题，往往可归结为如
下的数学模型。对于n阶方阵A,求数λ和向量ξ,使得等式Aξ=Aξ成立。满足等式的数λ称
为A的特征值，而向量ξ称为A的特征向量。实际上，方程A5=AS和(A-AI)5=0是两个等
价方程。要使方程(A-A)ξ=0有非0解ξ,必须使其系数行列式为0,即det(A-λI)=0。
线性代数中已经证明，行列式 det(A-λI)是一个关于λ的n次多项式，因而方程 det(A AI)=0是一个n次方程，有n个根(含重根),就是矩阵A的n个特征值，每一个特征值对应无
穷多个特征向量。矩阵的特征值问题有确定解，但特征向量问题没有确定解。
特征值和特征向量在科学研究和工程计算中都有非常广泛的应用。MATLAB中，计算矩阵
A的特征值和特征向量的函数是eig(A),常用的调用格式有3种：
(1)E= eig(A)求矩阵A的全部特征值，构成向量E。
(2)[V,D]=eig(A)求矩阵A的全部特征值，构成对角阵D,并求A的特征向量构成V的
列向量。
(3)[V,D]=eig(A,'nobalance')与第2种格式类似，但第2种格式中先对A作相似变换，后
求矩阵A的特征值和特征向量，而格式3直接求矩阵A的特征值和特征向量。
一个矩阵的特征向量有无穷多个，eig函数只找出其中的n个，A的其他特征向量，均可由
这 n个特征向量的线性组合表示。
例5.11 设矩阵
^-
用3种不同的格式求A的特征值和特征向量。
命令及运行结果如下：
A=[1,2,2;1,-1,1;4,-12,1];
E=eig(A)
E=
1.0000
0.0000+1.0000i
0.0000-1.0000i
[V,D]=eig(A)
V=
·116 基 础 篇
0.9045 -0.4432+0.5744i -0.4432- 0.5744i
0.3015 -0.1904+0.1280i -0.1904-0.1280i
-0.3015 0.1248-0.6368i 0.1248+0.6368i
D=
1.0000
0
0
[V,D]=eig(A,' nobalance')
Vπ
-0.9045 0.2689-0.6738i 0.2689+0.6738i
-0.3015 0.1480-0.1753i 0.1480+0.1753i
0.3015 0.0544+0.6466i 0.0544-0.6466i
D=
1.0000 0 0
0 0.0000+ 1.0000i0
0 0 0.0000- 1.0000i
可以看出，用不同的调用格式求得的特征值都是(1,i,-i),但所求的特征向量并不完全相
同。
例5.12 用求特征值的方法解方程
3x?-7x?+5x2+2x-18=0
先构造与方程对应的多项式的友矩阵A,再求A的特征值。A的特征值即为方程的根。命
令及运行结果如下：
p=[3,-7,0,5,2,-18];
A=compan(p);
xl=eig(A)
xl=
是多项式p的友矩阵
??A的特征值
2.1837
1.0000+ 1.0000i
1.0000-1.0000i
-0.9252+0.7197i
-0.9252-0.7197i
x2=roots(p) ??接多项式p的零点
x2=
2.1837
1.0000+ 1.0000i
1.0000-1.0000i
-0.9252+0.7197i
-0.9252-0.7197i
可以看出，两种方法求得的方程的根是完全一致的，实际上，rots 函数正是应用求友矩阵的
特征值的方法来求方程的根。
第5章 MATLAB数值计算 ·117·
5.2.8 MATLAB在三维向量中的应用
三维向量在解析几何和高等数学中均有广泛的应用，本节讨论如何利用MATLAB来实现三
维向量的一些基本运算，所讨论的大部分问题，MATLAB中并未直接提供相应的处理函数，需要
使用命令序列或程序来完成。
1.向量共线或共面的判断
从线性代数中知道，当两个向量线性相关时，则这两个向量组成的矩阵的秩小于2,并且这两个
向量共线，否则不共线。当3个向量线性相关时，则这3个向量组成的矩阵的秩小于3,并且这3个
向量共面，否则不共面。根据这些知识，很容易在MATLAB中判断三维向量的共线、共面问题。
例5.13 设X=(1,1,1),Y=(-1,2,1),Z=(2,2,2),判断这3个向量的共线、共面问题。
命令如下：
X=[1,1,1];Y=[-1,2,1];Z=[2,2,2];
XY=[x;Y];YZ=[Y;Z];ZX=[Z;X];XYZ=[X;Y;Z];
rank(XY)
rank(YZ)
rank(ZX)
rank(XYZ)
结果分别是2,2,1,2。说明X、Y不共线，Y、Z不共线，Z、X共线，X、Y、Z共面(但不共
线)。
作为练习，请读者根据上述方法设计一个函数文件，其参数是待判断的向量，函数值是判断
结果。当2个向量共线或3个向量共面时，函数返回0,否则返回1。
2.向量方向余弦的计算
设V=(x,y,z)是一个空间三维向量，是V的长度，称向量D=(x/r,y/r,z/r)是向量 V
的方向余弦。给出一个向量后，很容易求得该向量的长度r= norm(V,2),从而可以方便地求得其
方向余弦。
例5.14 设向量V=(5,-3,2),求V的方向余弦。
建立一个函数文件direct.m:
functionf=f(v)
r=norm(v);
ifr==0
f=0
else
f=[v(1)/r,v(2)/r,v(3)/r];
end
return
在MATLAB命令窗口，输入命令；
v=[5,-3,2];
f= direct(v)
f=
·118· 基 础 篇
0.8111-0.4867 0.3244
当然，也可不设计函数文件，而在MATLAB命令窗口直接输人命令：
V=[5,-3,2];r=norn(V);
D=[V(1)/r,V(2)/r,V(3)/r]
D=
0.8111 -0.4867 0.3244
3.向量的夹角
设U=(uj,u?,u?),V=(v?,v?,v?)是2个空间向量，r、r?分别是U、V的长度，(U,V)=
1?+u2O?+u?v?是U、V的内积，θ是U、V的夹角，从解析几何中知道，向量的内积与夹角间
的关系是
(U,V)=r?r?cosθ
给出两个向量后，很容易通过MATLAB求得其内积和向量的长度ri、r?,从而通过上式可求
得两个向量的夹角θ。
例5.15 设U=(1,0,0),V=(0,1,0),求U,V间的夹角θ。
命令及运行结果如下：
U=[1,0,0];V=[0,1,0];
rl= norm(U);r2=porn(V);
UV=U*V';cosd=UV/rl/r2;
D=acos(coed)
D=
1.5708
结果为1.5708弧度，即90°。容易看出，U、V分别是直角坐标系中的两个坐标轴Ox、0y上
的单位向量，其夹角显然是90°。
4.两点间的距离
设U=(uj,u?,u?),V=(v?,02,v?),这里，U、V即可以理解为两个空间点的坐标，也可以理
解为从坐标原点到该点的向量。当对其理解为两个点坐标时，一个很自然的问题就是怎样求这
两个点之间的距离。从解析几何中知，这两个向量的差向量的长度即为两点间的距离。
例5.16 设U=(1,0,0),V=(0,1,0),求U、V两点间的距离。
命令如下：
U=[1,0,0];V=[0,1,0];UV=U-V;
D=norm(UV)
D=
1.4142
5.向量的向量积
向量U、V的向量积也是一个向量，记为U×V。U×V的方向与U、V组成的平而垂直，
U、V、U×V3个向量间遵守右手系；U×V的长度等于U的长度与V的长度及U、V间的夹角
的正弦三者的乘积，在数值上等于以U、V为邻边组成的平行四边形的面积。向量积在求与已
知平面垂直的向量及两个已知向量组成的平行四边形而积时非常有用。
设U=(u?,u?,u?),V=(v?,v?,v?),根据向量代数的知识，U、V的向量积U×V可以用一
第5章 MATLAB数值计算 ·119·
个行列式来表达：
式中i、j、k分别是坐标轴Ox、0y、0z的单位向量。MATLAB没有直接提供求两个向量的向量积
的函数，但利用上述行列式可以计算向量的向量积。
例5.17 设U=(2,-3,1),V=(3,0,4),求U×V。
命令如下：
U=[2,-3,1];V=[3,0,4];W=eye(3);
Al=[W(1,:);U;V];A2=[W(2,:);U;V];A3=[W(3,:);U;V];
UV=[det(A1),det(A2),det(A3)
UV=
-12-59
6.向量的混合积
设U=(u?,u?,u?),V=(v?,U?,v?),W=(w?,M?,w?),U、V、W的混合积定义为(UVW)=
U(V×W),向量代数中已经得出，3个向量的混合积可以用一个行列式来表达，即
vxw
利用上述行列式就可以写出计算3个向量的混合积的MATLAB语句了。
例5.18 设U=(0,0,2),V=(3,0,5),W=(1,1,0),求以这3个向量构成的六面体的体
积。
这3个向量的混合积即是其构成的六面体的体积。命令及运行结果如下：
U=[0.0.2];V=[3,0,5];W=[1,1,0];
A=[U;V;Wj;
det(A)
ans
6
7.点到平面的距离
从解析几何知，点U=(u?,u?,u?)到平面Ax+By+Cz+D=0的距离r的计算公式是
tPB2tc
根据上式在MATLAB中就能方便地计算点到平面的距离。
例5.19 求原点到平面x+y+z=1的距离。
命令及运行结果如下：
u=[0.0,0];v=[1,1,1]; ?B=C=1,ul=u2=u3=0,D=-1
r=abs(u+v'-1)/nomn(v,2)
r=
0.5774
·120· 基 础 篇
5.3 矩阵分解与线性方程组求解
5.3.1 趣阵分解
与初等代数中因式分解过程一样，线性代数中将一个矩阵表示为几个矩阵的乘积的过程称
为矩阵分解。矩阵分解在很多矩阵运算过程中都有应用。MATLAB中有许多函数可进行矩阵分
解，下面讨论其中几个常用的分解函数。
1.实对称矩阵的QDQ分解
如果一个矩阵的转置矩阵和自身相等，则称该矩阵为对称矩阵，进一步，如果对称矩阵的所
有元素均为实数，则称该矩阵为实对称矩阵。从线性代数中知道，对任何一个实对称矩阵A,都
存在正交矩阵Q(正交矩阵是满足正交条件Q'Q=QQ'=1的矩阵),使得
Q'AQ=D (D为对角矩阵)
从而有
A=QDQ'
这里，D是由A的特征值组成的对角矩阵，而Q是对应的特征向量。特征值和特征向量都可以
通过eig(A)求得，因此，在MATLAB中，可以方便地将实对称矩阵A分解为3个矩阵乘积的形
式。
例5.20 设对称矩阵
对A进行QDQ分解。
命令如下：
A=[2.1,4,6;1,2,1,5;4,1,3,4;6,5,4,2];
[Q,D]=eig(A)
Q=
-0.6081 0.2983 0.5157 0.5247
0.2885 -0.7789 0.4260 0.3586
0.7113 0.5139 0.0570 0.4762
-0.2026 -0.2006-0.7412 0.6077
D=
-1.1538 0 0 0
0 0 2.2449 0
0 0 -5.3556 0
0 0 013.2645
Q*D*Q
第5章 MATLAB数值计算 ·121·
ans=
2.0000 1.0000 4.00006.0000
1.0000 2.0000 1.0000 5.0000
4.0000 1.0000 3.0000 4.0000
6.0000 5.0000 4.0000 2.0000
结果与A相等，说明确实将A分解为了QDQ'的乘积。
例5.21 求下列二次型的标准形式及变换矩阵。
f(x,y,z)=x2+y2+3z2+4xy+2yz+2z
设
x
则有f(x,y,z)= X'AX.
这里A是一个实对称矩阵，可进行QDQ分解，即存在正交矩阵Q和对角矩阵D,使A=
QDQ'。从而有?(x,y,z)=X'(QDQ')X=(X'Q)D(Q'X)=(Q'X)'D(Q'X)。作线性变换Y=
QX,则原二次型变换为二次标准型。命令如下：
A=[1,2,1;2,1,1;1,1,3;];
[Q.D]=cig(A)
Q=
0.7071-0.5000 0.5000
-0.7071 -0.5000 0.5000
0.00000.7071 0.7071
D=
-1.0000 00 0 1.58580
04.4142 0 U
这里A=QDQ',作线性变换：[u,v,wl'=Q'X=Q'[x,y,z]',即
其逆变换是：
原关于x,y,z的二次型化为关于u,p,w的标准二次型
f(x,y,z)=g(u,v,w)=-u2+1.585 8v2+4.414 2w2
2.矩阵的LU分解
矩阵的LU分解就是将一个矩阵表示一个可交换下三角矩阵和一个上三角矩阵的乘积形
式。线性代数中已经证明，只要方阵A是非奇异的，即 det(A)≠0时，LU分解总是可以进行的。
·122· 基 础 篇
MATLAB中，完成LU分解的函数是：
(1)[L,U]=lu(A)将方阵A分解为可交换下三角矩阵L和上三角矩阵U,使A=LUe
(2)[L,U,P]=lu(A)将方阵A分解为下三角矩阵L和上三角矩阵U,使PA=LU、
当使用第1种格式时，矩阵L往往不是一个下三角矩阵，但可以通过行交换成为一个下三
角阵。设
则对矩阵A进行LU分解的命令如下：
A=[2,1,-2;1,2,1;2,5,3J;
[L,U1]=lu(A)
L=
0 0 1.0000
0.3750 1.0000 0.5000(
1.0000 1.0000 0
U=
2.0000 1.0000 -2.0000
0 4.00005.0000
0 0 0.1250
为检验结果是否正确，输入命令：
LU=L*U
LU=
21-2
121
253
说明结果是正确的。例中所获得的矩阵L并不是一个下三角矩阵，但将第二、三行互换后，
即可获得一个下三角矩阵。
下面通过一个实例介绍应用LU分解求解线性方程组的方法。
例5.22 用LU分解求方程组
的根。
写出方程组的系数矩阵A,右端项向量b,并调用lu(A)对A进行分解，得
第5章 MATLAB数值计算 ·123·
原方程组为
AX=b
以LWU分解结果PA= LW代入，得
(LU)X=Pb
即：
L(UX)=Pb
作变换Y= UX,得
LY= Pb
即原方程组的求解转化为对2个三角形方程组的求解：
+0.68?+y=10
这个方程组很容易求解，从第1个方程开始求解，顺次将求解结果代入后面的方程，即可求
得方程组的全部解。将求解结果代入下面的方程组，可求得原方程组AX=b的解。
和前面的方程组类似，这个方程组从第4个方程开始求解，顺次将求解结果代入前面的方
程，可求得方程组的全部解。实际上，这就是高斯消元法的思想。本例的具体求解过程留作练
习。
3.矩阵的QR分解
对矩阵A进行QR分解，就是把A分解为一个正交矩阵Q和一个上三角矩阵R的乘积形
式。QR分解只能对方阵进行。对矩阵A进行QR分解的函数是[Q,R]=qr(A),根据方阵A,求
一个正交矩阵Q和一个上三角矩阵R,使A=QR。例如，对矩阵
^-
进行QR分解的命令是：
A=[2,1,-2;1,2,1;2,5,3];
[Q,R]=qr(A)
Q=
-0.6667 0.7362 0.1162
-0.3333 -0.1550 -0.9300
-0.6667 -0.6587 0.3487
R=
-3.0000 -4.6667-1.0000
·124· 基 础 篇
0 -2.8674 -3.6037
0 0 -0.1162
读者可以验证，上述结果Q,R满足Q'Q=QQ'=1,QR=A,说明所得结果是正确的。
5.3.2 线性方程组求解
1.线性方程组解的一般讨论
线性代数中对线性方程组 Ax=b的求解理论有详细讨论，这里对其作一个归纳：
(1)当A是-个满秩方阵时，方程Ax=b称为恰定方程，方程有惟一解à=A-'b,这是最
基本的一种情况。一般用x=A\b求解速度更快。
(2)当方程组右端向量b=0时，方程称为齐次方程组。齐次方程组总有零解，因此称解x=
0为平凡解。当A的秩小于n时，齐次方程组有无穷多个非平凡解，其通解中包含n-rank(A)个
线性无关的解向量，用MATLAB的函数null(A,'r+)可求得基础解系。
(3)一般而言，当右端向量b≠0时，方程组系数矩阵秩 rank(A)与其增广矩阵的秩 rank([A,
b])是判断其是否有解的基本条件：
①当rank(A)=rank([A,b])=n时，方程组有惟一解：x=A\b或x=pinv(A)*b。
②当rank(A)=rank([A,b])<n时，方程组有无穷多个解，其通解由一个特解和对应的齐次
方程组Ax=0的通解组成。可以用A\b求得方程组的一个特解，用null(A,'r')求得该方程组
所对应的齐次方程组的基础解系，基础解系中包含n-rank(A)个线性无关的解向量。
③当 rank(A)< rank([A,b])时，方程组无解，即没有x,使得Ax=b。应用向量范数理论，
即没有x,使得
l Ax-bl?=0
由此想到，是否有x,使得||Ax-bll?取最小值，这个最小值问题是有解的，其解为x=
A\b或x=pinv(A)*b,即A的伪逆矩阵与b的乘积。
有了上面这些讨论，就可以设计解线性方程组的一般函数了。函数文件如下：
function [x,y]=line_solution(A,b)
[m,n]=size(A);y=[];
if nom(b)>0 ??齐次方程组
if rank(A)==rank([a,b]) ??程组相容
if rarnk(A)==m ??惟一解
x=A\b;
else ??程组有无穷多个解，基础解系
disp('原方程组有无穷个解，其齐次方程组的基础解系为y,特解为x');
y=null(A,'r');
x=A\b;
end
else ??程组不相容，给出最小二乘法解
disp('方程组的最小二乘法解是：);
x=A\b;
end
第5章 MATLAB数值计算 ·125·
else ??次方程组
ifrank(A)>=n ?满秩
x=zero(m,1) 解
else ??0解
disp('方程组有无穷个解，基础解系为x');
x= mull(A,'r');
end
end
return
2.应用举例
例5.23 求下列线性方程组
的解。
在MATLAB命令窗口，输入命令：
A=[2,2,-1,1;4,3,-1,2;8,5,-3,4;3,3,-2,2];b=[4,6,12,6]';
[x,y]=line_solution(A,b) ??用自定义函数
x=
1.00000000000000
1.00000000000000
-1.00000000000000
-1.00000000000000
y=
[]
结果y=[],说明方程组只有惟一解。为验证结果，在MATLAB命令窗口，输入命令：
A*x
ans =
4
6
12
6
说明所求结果满足原方程组，是正确的。
例5.24 求下列线性方程组
的解。
·126· 基 础 篇
方程组有4个未知数，但只有3个方程，所以是欠定方程组，在其解存在的情况下，会有多个
解。在MATLAB命令窗口，输入命令：
A=[2.7.3,1;3,5,2.2;9,4,1.7];b=[6,4,2
[x,y'= line_solution(A,b)
输出结果是：
原方程组有无穷个解，其齐次方程组的基础解系为y,特解为x
Warning:Rank deficient,rank = 2 tol=8.6112e-015.
> InE:\MATLAB55 \exam \ line_solution.m at line 10
x=
-0.18181818181818
0.90909090909091
0
0
y=
0.09090909090909 -0.81818181818182
-0.45454545454545 0.09090909090909
1.00000000000000 0
0 1.00000000000000
y是原方程组所对应的齐次方程组的基础解系，包含2个线性无关的解向量。为检验解的
正确性，输人命令：
A*x
an6 =
6.00000000000000
4.00000000000000
2.00000000000000
说明x确实是原方程组的-·个特解。输入命令：
A*y
an8 =
1.0e-015*
0 0
0.22204460492503 0
0.11102230246252 -0.88817841970013
结果很小，说明y是原方程组所对应的齐次方程组的解。理论上，A*y的结果应该是0向
量，但由于计算误差，这里显示的结果已经很好了。
第5章 MATLAB数值计算 ·127·
5.4 数据处理与多项式计算
5.4.1 数据统计与分析
1.求矩阵最大和最小元素
(1)求向量的最大最小元素
求一个向量X的最大元素的函数有两种调用格式，分别是：
①y=max(X)返回向量X的最大元素存人y,如果X中包含复数元素，则按模取最大元
素。
②[y,1]=max(X)返回向量X的最大元素存人y,最大元素的序号存人I,如果X中包含
复数元素，则按模取最大元素。
求向量X的最小元素的函数是min(X),用法和max(X)完全相同。
(2)求矩阵的最大和最小元素
求矩阵A的最大元素的函数有3种调用格式，分别是：
① max(A)返回一个行向量，向量的第；个元素是A矩阵的第i列上的最大元素。
②{Y,U]=max(A)返回2个行向量，Y向量记录A的每列的最大元素，U向量记录每列最
大元素的行号。
③ max(A,[],dim) dim取1或2。dim取1时，该函数和max(A)完全相同。dim取2时，
该函数返回一个列向量，其第i个元素是A矩阵的第i行上的最大元素。
求最小元素的函数是min,其用法和max完全相同。
(3)两个向量或矩阵对应元素的比较
函数max和min还能对两个同型的向量或矩阵进行比较：
①U=max(A,B) A,B是两个同型的向量或矩阵。结果U是与A,B同型的向量或矩阵，
U的每个元素等于A,B对应元素的较大者。
②U=max(A,n)n是一个标量。结果U是与A同型的向量或矩阵，U的每个元素等于A
对应元素和 n中的较大者。
min函数的用法和max完全相同。
例5.25 求矩阵
的每行及每列的最大和最小元素，并求整个矩阵的最大和最小元。
命令如下：
A=[13,-56,78;25,63,-235;78,25,563;1,0,-1];
max(A,l),2) ??每行最大元素
·128 · 基 础 篇
ans =
78
63
563
1
min(A,[].2) 呢求每行最小元素
ans =
-56
-235
25
-1
max(A) ??每列最大元素
ans =
78 63 563
min(A) ??每列最小元素
ans =
1 -56 -235
max(max(A)) ??整个矩阵的最大元素
ans =
563
min(min(A)) ??整个矩阵的最小元素
ans =
-235
2.求矩阵的平均值和中值
所谓中值，是指在数据序列中其值的大小恰好处在中间的元素。例如，数据序列-2,5,7,9,
12的中值为7,因为比它大和比它小的数据均为2个，即它的大小恰好处于数据序列各个值的中
间，这是数据序列为奇数个的情况；如果为偶数个，则中值等于中间的两项之平均值。例如，数据
序列-2,5,6,7,9,12中、处于中间的数是6和7,故其中值为此两数之平均值6.5。
求矩阵和向量元素的平均值的函数是mean,求中值的函数是median。它们的调用方法和
max 函数完全相同。设X是一个向量，A是一个矩阵，两个函数的用法如下：
mean(X)返回向量X的算术平均值。
median(X)返回向量X的中值。
mean(A) 返回一个行向量，其第i个元素是A的第i列的算术平均值。
median(A)返回一个行向量，其第i个元素是A的第i列的中值。
mean(A,dim)当dim为1时，该函数等同于mean(A),当dim为2时，返回一个列向量，其
第i个元素是A的第；行的算术平均值。
median(A,dim)当dim为1时，该函数等同于median(A),当 dim为2时，返回一个列向量，
其第i个元素是A的第i行的中值。
3.矩阵元素求和与求积
矩阵和向量求和与求积的基本函数是sum和 prod,其使用方法和max类似，说明如下：
第5章 MATLAB数值计算 ·129·
sum(X)返回向量X各元素的和。
prod(X)返回向量X各元素的乘积。
sum(A)返回一个行向量，其第；个元素是A的第；列的元素和。
prod(A)返回一个行向量，其第i个元素是A的第i列的元素乘积。
sum(A,dim)当dim为1时，该函数等同于sum(A),当dim为2时，返回一个列向量，其第i
个元素是A的第i行的各元素和。
prod(A,dim)当dim为1时，该函数等同于prod(A),当dim为2时，返回一个列向量，其第
i个元素是A的第i行的各元素乘积。
例5.26 求矩阵A的每行元素的乘积和全部元素的乘积。
命令如下：
A=[1,2,3,4;5,6,7,8;9,10,11.12];
S=prod(A,2)
S=
24
1680
11880
prod(S) ??A的全部元素的乘积
ans =
479001600
4.矩阵元素累加和与累乘积
设U=(u,u?,u?,…,un)是一个向量，V、W是与U等长的另外两个向量，并且
v=(,.·2u)
w=(π,π.…,立)
称V为U的累加和向量，W为U的累乘积向量。MATLAB中，使用cumsum和cumprod 函数能方
便地求得向量和矩阵元素的累加和与累乘积向量，函数的用法和sum及prod相同，说明如下：
cumsum(X)返回向量X累加和向量。
cumprod(X)返回向量X累乘积向量。
cumsum(A)返回一个矩阵，其第i列是A的第i列的累加和向量。
cumprod(A)返回一个矩阵，其第i列是A的第；列的累乘积向量。
cumsum(A,dim)当dim为1时，该函数等同于cumsum(A),当dim为2时，返回一个矩阵，
其第i行是A的第i行的累加和向量。
cumprod(A,dim)当dim为1时，该函数等同于cumprod(A),当dim为2时，返回一个向量，
其第i行是A的第；行的累乘积向量。
例5.27 求向量X=(1!,2!,3!,…,10!)。
命令如下：
X=cumprod(1:10)
X=
·130· 基 础 篇
Columns I through 6
1 2 6 24 120 720
Columns 7 through 10
5040 40320 3628803628800
5.标准方差
对于具有N个元素的数据序列x?,x?,x?,…,xw,标准方差的计算公式如下
s=√2-P
或
s?=√÷2(x-x2
其中，x为
x=六
标准方差的计算在数理统计中是一项基本工作。MATLAB中，提供了计算数据序列的标准
方差的函数std。对于向量X,std(X)返回一个标准方差。对于矩阵A,std(A)返回一个行向量，
它的各个元素便是矩阵A各列或各行的标准方差。std 函数的一般调用格式为：
std(A,FLAG,dim)
其中 dim取1或2。当dim=1时，求各列元素的标准方差；当dim=2时，则求各行元素的标准
方差。FLAG取0或1,当FLAG=0时，按S?所列公式计算S,当FLAG=1时，按S?所列公式计
算S。缺省 FLAG=0,dim=1。
6.元素排序
对向量元素进行排序是一个经常性的操作，MATLAB中对向量X是排序函数是sort(X),函
数返回一个对X中的元素按升序排列的新向量。
sort 函数也可以对矩阵A的各列(或行)重新排序，其调用格式为：
[Y,1]=sort(A,dim)
其中 dim指明对A的列还是行进行排序，若dim=1,则按列排，若dim=2,则按行排。Y是排序
后的矩阵，而I记录Y中的元素在A中的位置。
例5.28 对下列矩阵做各种排序。
^-
命令如下：
A=[1,-8,5;4,12,6;13,7,-13];
surt(A)
ans =
??A的每列按升序排序
1-8-13 475
13126
第5章 MATLAB数值计算 ·131·
-sort(-A,2) ??A的每行按降序排序
ans =
51-8
1264
137-13
[X,I]=8ort(A) ??A按列排序，井将每个元素所在行号送矩阵I
X=
1-8-13
475
13126
I=
1 13
2 3 1
3 22
5.4.2 数值插值
设函数y=f(x),如果我们已经知道了对于自变量X的一组取值X=(xi,x?,…,xa),对应
的函数值为
称X=(xi,x?,…,xn)为采样点，而Y=(y?,y?,…,y)是函数在采样点的样本值。数值插值的
任务就是根据上述条件构造一个函数y=g(x),使得在X=(x?,x?,…,xa),有
且在两个相邻的采样点(x;,x;+)(i=1,2,…,i-1)之间，g(x)光滑过度。如果被插值函数f(x)
是光滑的，并且采样点足够密，一般在采样区间内，f(x)与g(x)比较接近。插值函数g(x)一般
由线性函数、多项式、样条函数或这些函数的分段函数充当。
数值插值方法在实际工作中有广泛的应用。在工程测量和科学实验中，所得到的数据通常
都是离散的。如果要得到这些离散点以外的其他点的数值，就需要根据这些已知数据进行插值。
根据被插值函数的自变量个数，插值问题分为一维插值，二维插值和多维插值等；根据是用
分段直线、多项式或样条函数来作为插值函数，插值问题又分为线性插值、多项式插值和样条插
值等。MATLAB中，对上述问题均提供了相应的函数，下而逐一对其进行介绍。
1.一维数值插值
如果被插值函数是一个单变量函数，则数值插值问题称为一维插值。一维插值采用的方法
有线性方法、最近方法、三次样条和三次插值。MATLAB中，实现这些插值的函数是 interpl。其
·132· 基 础 篇
调用格式为：
YI= interpl(X,Y,XI,' method')
函数根据X、Y的值，计算函数在X1处的值。X、Y是两个等长的已知向量，分别描述采样
点和样本值，X1是一个向量或标量，描述欲插值的点，YI是一个与X1等长的插值结果。method
是插值方法，允许的取值有'linear'(线性插值)、nearest'(最近插值)、'spline'(三次样条插值)、
cubic(二次多项式插值),缺省值是' linear'。
注意：X1的取值范围不能超出X的给定范围，否则，会给出“NaN”错误。
例5.29 用不同的插值方法计算sin(x)在π/2点的值。
这是一个一维插值问题。在MATLAB命令窗口，输入命令：
X=0:0.2:pi;Yz sin(X); ??出X.Y
??缺省方法(即线性插值方法)计算sin(π/2) intepl(X,Y,pi/2)
ans=
0.9975
interpl(X,Y,pi/2,'nearest') ??最近方法计算sin(π/2)
ans=
0.9996
intepl(X,Y,pi/2,' linear') ??线性方法计算 sin(x/2)
arns=
0.9975
interpl(X.Y,pi/2,' spline') ??三次样条方法计算sin(x/2)
ans=
1.0000
interpl(X,Y,pi/2,' cubic')
ans=
??三次多项式方法计算sin(x/2)
1.0000
例中，三次样条和三次多项式的插值结果最好，最近方法次之，线性方法最差，但不能认为什
么情况下都是这样的。插值方法的好坏依赖于被插值函数，没有一种对所有函数都是最好的插
值方法。
MATLAB中有一个专门的三次样条插值函数YI=spline(X,Y,X1),其功能及使用方法与函
数YI=interpl(X,Y,X1,' spline')完全相同。
例5.30 某检测参数f随时间t的采样结果如表5.1,用数值插值法计算t=2,7,12,17,22,
17,32,37,42,47,52,57时f的值。
表5.1 检测参数了与时间t的采样结果
0 5 10 15 20 25 30
f 3.2015 2.256 879.5 1835.9 2968.8 4136.2 5237.9
35 40 45 50 55 60 65
6152.7 6725.3 6848.3 6403.5 6824,7 7328.5 7857.6
第5章 MATLAB数值计算 ·133·
这是一个一维数值插值问题，命令如下：
T=0:5:65;
X=2:5:57;
F=[3.2015,2.2560,879.5.1835.9,2968.8.4136.2.5237.9,6152.7,...
6725.3,6848.3,6403.5.6824.7,7328.5,7857.6];
F1= interpl(T,F,X) ??线性方法插值
Fl=
1.0e+003*
0.0028 0.3532 1.2621 2.2891 3.4358 4.5769
5.6038 6.3817 6.7745 6.67046.5720 7.0262
F1=interpl(T,F,X,'nearest') ??最近方法插值
Fl=
1.0e +003
0.0032 0.0023 0.8795 1.8359 2.9688 4.1362
5.2379 6.1527 6.7253 6.8483 6.4035 6.8247
F1=interpl(T,F,X,'spline') ??三次样条方法插值
FI=
1.0c+003*
-0.1702 0.3070 1.2560 2.2698 3.4396 4.5896
5.6370 6.4229 6.8593 6.6535 6.4817 7.0441
Fl=interpl(T,F,X,' cubic') ??三次多项式方法插值
F1=
1.0e+003*
-0.1026 0.2861 1.2479 2.2747 3.4364 4.5906
5.6337 6.4280 6.8341 6.6697 6.5057 7.0191
2.二维数值插值
当采样变量只与一个参数相关时，可以选定一个检测区间，记录下采样值，并根据对参数的
采样值来构造一个一维函数，从而应用该函数计算参数在插值点的值，这就是一维插值问题。自
然，某采样变量依据两个参数变化时，其采样点就应该是一个由这两个参数组成的一个平面区
域，插值函数也是一个二维函数。对依赖于两个参数的函数进行插值的问题称为二维插值问题。
同样，MATLAB中，提供了解决二维插值问题的函数。其调用格式为：
ZI=interp2(X,Y,Z,X1,Y1,' method')
其中X、Y是两个向量，分别描述两个参数的采样点，Z是与参数采样点对应的采样变量的样本
值，X1、Y1是两个向量或标量，描述欲插值的点。method的取值与一维插值函数相同。
同样，X1、Y1的取值范围不能超出X、Y的给定范围，否则，会给出“NaN”错误。
例5.31 设Z=x2+y2,对Z函数在(0,1)×(0,2)区域内进行插值。
命令如下：
x=0:0.1:10;y=0:0.2:20;
[X,Y]=meshgnd(x,y);
Z=X.2+Y.2;
·134· 基 础 篇
interp2(x,y,Z,0.5,0.5) ??函数在(0.5,0.5)点进行插值
ans=
0.5100
interp2(x,y,Z,0.50.6),0.4) ??函数在(0.5,0.4)点和(0.6,0.4)点进行插值
ans=
0.4100 0.5200
interp2(x,y,Z,[0.50.6].[0.40.5')??函数在(0.5.0.4)点和(0.6.0.5)点进行插值
ans=
0.4100 0.6200
interp2(x,y,Z,[0.50.6]*,[0.40.5])??函数在(0.5,0.4),(0.6,0.4),(0.5,0.5)和(0.6,0.5)点进行插值
ang=
0.41000.5200
0.5100 0.6200
如果想提高插值精度，可选择插值方法为'spline',对于本例，精度可以提高。输入命令：
interp2(x,y,Z,[0.50.6]*,[0.40.5],'spline')
ans=
0.4100 0.5200
0.5000 0.6200
3.三维数值插值
对三维函数插值的函数是interp3,其使用方法和interp2相同。其调用格式为：
W1= interp3(X,Y,Z,W,XI,Y1,ZI,'method')
函数返回三维插值结果。其中X、Y、Z是3个向量，分别描述3个参数的采样点，W是与参
数采样点对应的采样变量的样本值，X1、Y1、Z1是3个向量或标量，描述欲插值的点。method是
插值方法，可选，其取值与一、二维插值函数相同。
注意：X1、Y1、Z1的取值范围不能超出X、Y、Z的给定范围，否则，会给出“NaN”错误。
5.4.3 曲线拟合
1.曲线拟合与最小二乘法
与数值插值类似，曲线拟合的目的也是用一个较简单的函数去逼近一个复杂的或未知的函
数，所依据的条件都是在一个区间(或一个区域)上的有限个采样点的函数值。数值插值要求逼
近函数在采样点与被逼近函数相等，在要求逼近函数是一个统一(而不是分段函数)的较简单的
函数(如多项式)时，并非总能满足；曲线拟合放弃在插值点两者完全相等的要求，而只要求两者
之差的平方和最小，这就是最小二乘法的基本思想。设f(x)是被插值函数，p(x)是一个多项式，
在采样点的取值如表5.2所示。
表5.2 函数采样示意表
x
f(x)
x 2
…
fi f? J?
…
Pi P2 P3
f
p(x) Pa
第5章 MATLAB数值计算 ·135·
-p.2 当 最小时，称p(x)是?(x)的一个最佳平方逼近(也称为最小二乘逼近)。数学
上已经证明，上述最小二乘逼近问题的解总是确定的。有关的证明推导过程，有兴趣的读者请参
考有关资料。
2.曲线拟合的实现
曲线采用最小二乘法则进行拟合时，实际上是求一个系数向量，该系数向量是一个多项式的
系数。MATLAB中，提供了解决使用最小二乘法进行曲线拟合的函数。调用格式为：
[P,S]= polyfit(X,Y,m)
函数根据采样点X和采样点函数值Y,产生一个m次多项式P及其在采样点的误差向量
S。其中X、Y是两个等长的向量，P是一个长度为m+1的向量。
例5.32 用一个5次多项式在区间[0,2π]内逼近函数 sin(x)。
在给定区问上，均匀地选择50个采样点X,并应用sin(X)计算采样点函数值Y。然后利用
5次多项式逼近。命令如下：
X=linspace(0,2*pi,50);Y=sin(X);
[P,S]=polyfit(X.Y,5) ??到5次多项式的系数和误差
P=
-0.0056 0.0874 -0.3946 0.2685 0.8797 0.0102
S=
R:[6x6 double]
df:44
normr:0.0337
plot(X,Y,'k*',X,polyval(P,X),'k-')
绘出sin(X)和多项式P(X)在给定区间的函数曲线(图5.1所示),其中*曲线是sin(X),实
15
1
05
-0.5
·1
-1.50 1 2 3 4 5 6 7
图5.1 用5次多项式对正弦函数的拟合
·136· 基 础 篇
线是P(x)。函数polyval(P,X)是一个MATLAB函数，返回多项式P(X)的值，下一节将作介绍。
从图5.1可以看出，5次多项式对正弦函数的拟合效果是非常好的。
5.4.4 多项式计算
多项式是一种最简单的函数，也是用来对其他复杂函数进行逼近的工具。这一节讨论 MAT LAB中多项式的各种运算函数。
一个m次多项式有m+1个系数，在MATLAB中，用一个长度为m+1的向量表示一个m次
多项式。
1.多项式的建立
(1)已知多项式的全部系数建立多项式
当已知多项式的全部系数时，建立多项式和建立一个向量的方法完全相同，直接用赋值语句
即可建立。注意变量最高次幂的系数作为向量的第一个分量，而常数项作为最后一个分量，不要
弄反。
(2)已知多项式的全部根建立多项式
已知一个多项式的全部根X求多项式系数的函数是poly(X),该函数返回以X为全部根的
一个多项式P,当X是一个长度为m的向量时，P是一个长度为m+1的向量。
2.多项式求根
求多项式p(x)的根的函数是roots(P),这里，P是p(x)的系数向量，该函数返回方程p(x)=
0的全部根(含重根，复根)。
3.多项式求值
求多项式p(x)在某点或某些点的函数值的函数是polyval(P,x)。若x为一数值，则求多项
式在该点的值；若x为向量或矩阵，则对向量或矩阵中的每个元素求其多项式的值。
例5.33 已知
f(x)=3x?+4x3-5x2-7.2x+5
(1)计算f(x)=0的全部根。
(2)由方程f(x)=0的根构造一个多项式g(x),并与f(x)进行对比。
(3)计算f(5)f(7.8)、f(9.6)、f(12.3)的值。
命令如下：
P=[3,0,4,-5,-7.2,5];
X=roots(P)
X=
??方程f(x)=0的根
-0.3046+ 1.6217i
-0.3046-1.6217i
1.0190
-1.0066
0.5967
G=poly(X)
G=
??多项式g(x)
1.0000 -0.00001.3333-1.6667 -2.4000 1.6667
第5章 MATLAB数值计算 ·137·
这是多项式f(x)除以首项系数3的结果，两者的零点相同。
X0=[5,7.8,9.6,12.3];
f=polyval(P,X0) ??多项式f(x)在给定点的值
f=
1.0e+005*
0.0972 0.8816 2.47638.5120
多项式求值还有一个函数是polyvalm,其调用格式与polyval相同，但含义不同。polyvalm函
数要求x为方阵，它以方阵为自变量求多项式的值。设A为方阵，P代表多项式x3-5x2+8,那
么polyvalm(P,A)的含义是：
A*A*A-5*A*A+8*eye(size(A))
而polyval(P,A)的含义是：
A.*A.*A-5*A.*A+8*ones(size(A))
读者不妨上机验证一下。
4.多项式的四则运算
(1)多项式的加减法
MATLAB中，未提供专门多项式加减法函数，事实上，多项式的加减法就是其所对应的向量
的加减法。当两个多项式具有相同的次数时，对两个系数向量直接进行加减法；当两个多项式的
次数不同时，要在一个较低次幂的多项式系数向量前补0,使两个系数向量等长。
(2)多项式的乘法
函数conv(PI,P2)用于求多项式P1和P2的乘积。这里，P1、P2是两个多项式系数向量。
(3)多项式的除法
函数[Q,r]=deconv(PI,P2)用于对多项式 P1和P2做除法运算。其中Q返回多项式P1除
以P2的商式，r返回P1除以 P2的余式。这里，Q和r仍是多项式系数向量。
deconv是conv的逆函数，即有P1=conv(P2,Q)+r。
例5.34 设
f(x)=3x?-5x?+2x3-7x2+5x+6
g(x)=3x2+5x-3
(1)求f(x)+g(x)和f(x)-g(x)。
(2)求f(x)g(x)和f(x)/g(x)。
在MATLAB命令窗口，输入命令：
f=[3,-5,2,-7,5,6];g=[3,5,-3];gl=[0,0,0,g];
f+gl ??f(x)+g(x)
ans=
3-52-4103
f-g1 ??f(x)-g(x)
ans=
3 -5 2 -10 0 9
conv(f,g) ??f(x)*g(x)
ans
·138 基 础 篇
90-28 4 -26 64 15 -18
[Q.r]=deconv(f,g) ??f(x)/g(x),商式送Q,余式送r。
Q=
1.0000)-3.33337.2222-17.7037
r=
00 0 0 115.1852 -47.1111
5.多项式的导函数
对多项式求导数的函数是：
P=polyder(P)求多项式P的导函数
p=polyder(P,Q)求P*Q的导函数
[p,q]=polyder(P,Q)求P/Q的导函数，导函数的分子存入p,分母存入q。
上述函数中，参数P、Q是多项式的向量表示，结果pq也是多项式的向量表示。
例5.35 求有理分式
f(x)=10x°+5x+6x8+7-5-100
的导数。
命令如下：
P=[3,5,0,-8,1,-5];
Q=[10,5,0,0,6,0,0,7,-1,0,-100];
[p,q]=polyder(P,Q)
P=
-150 -360 -125 640 172400
225 234 -4 170 -1444 -2014
106 1590 -100
q=
25 100100 0
0140 86-10
-12 0 -1151-14
12060 --d6
2000 10000
导数的分子是一个14次多项式，其14次幂的系数是-150,常数项是-100;分母是一个20
次多项式，其20次幂的系数是100,常数项是10000。
5.4.5 画数的最大值与最小值
求函数在指定区间的最大值与最小值是一种常见的运算，MATLAB中用于求最小值的函数
是：
fmin(f,a,b)求单变量函数f(x)在区间(a,b)上的最小值点。
fmins(F,XO)求多变量函数F(x)在估计值XO附近的最小值点。
MATLAB没有专门提供求函数最大值点的函数，但只要注意到-f(x)在区间(a,b)上的最
小值点就是f(x)在(a,b)的最大值点，所以 fmin(-f,a,b)返回函数f(x)在区间(a,b)上的最大
值。
第5章 MATLAB数值计算 ·139·
例5.36 求函数
f(x)=x-1+5
在区间(-10,1)和(1,10)上的最小值点。
首先建立函数文件fx.m:
function f=f(x)
[=x-1/x+5;
return
上述函数文件也可用一个语句函数代替：
ff= inline('x-1/x+5')
再在MATLAB命令窗口，输入命令：
fmin('fx',-10,-1) ??函数在区间(-10,-1)内的最小值点
ans=
-9.9999
fmin(ff,1,10) ??函数在区间(1,10)内的最小值点。注意函数名f不用加
ans=
1.0001
例5.37 设
f(x,y,2)=x+4+子+2
求函数f在(0.5,0.5,0.5)附近的最小值。
建立函数文件fxyz.m:
funetion f=f(u)
x=u(1);y=u(2);z=u(3);
f=x+y.2./x/4+z.~2./y+2./z;
return
在MALAB命令窗口，输人命令：
U=fmins('fxyz·,[0.5,0.5,0.5])
U=
??函数的最小值点
0.5000 1.0000 1.0000
fxyz(U) 呢求函数的最小值
Ans=
4.0000
5.5 傅立叶分析
离散傅立叶变换在通信、数据测试与分析及过程控制中有广泛的应用。本节先简要阐述离
散傅立叶变换的基本概念和变换公式，然后讨论 MATLAB中离散傅立叶变换的实现。
1.离散傅立叶变换的基本概念
设向量X=(x?,x?,…,xn)是某个参数的一组样本值，称向量Y=(yi,y?,…,yw)为X的一
·140 · 基 础 篇
个离散傅立叶变换，其中
w=x/
称上式为离散傅立叶变换公式，而下式称为离散傅立叶逆变换公式。
六em-)
2.离散傅立叶变换的实现
MATLAB中，提供了对向量(或直接对矩阵的行或列)进行离散傅立叶变换的函数，其调用格
式是：
Y=f(X,n,dim)
(1)当X是一个向量时，返问对X的离散傅立叶变换。n可以省略，其缺省值为X的长度
m=length(X),n<m时，只截取前 n个元素进行变换；n≥m时，在X后面补上n-m个0元素。
X是一个向量时，参数dim不选。
(2)当X是一个矩阵时，返回一个矩阵并送Y,其列(行)是对X的列(行)的离散傅立叶变
换。参数n与(1)相同，dim=1时，对X进行列变换；dim=2时，对X进行行变换。dim的缺省
值是1。
例5.38 求X=(1,0,-3,5,2)的离散傅立叶逆变换。
在MATLAB命令窗口，输入命令：
X=[1,0.-3,5,2];
Y=f(X) ??X进行变换
Y=
5.0000 -0.0000+6.6044i 0.0000-6.4329i -0.0000+6.4329i
0.0000-6.6044j
3.离散傅立叶变换的逆变换
MATLAB中，对向量(或直接对矩阵的行或列)进行离散傅立叶逆变换的函数的调用方法是：
Y=if(X,n,dim)
函数对X进行离散傅立叶逆变换。其中X、n、dim的意义及用法和离散傅立叶变换函数fft
完全相同。
例5.39 对矩阵
^--
的列向量、行向量分别进行离散傅立叶变换并对变换结果进行逆变换。
命令如下：
A=[3,2,1,1;-5.1,0,1;3,2,1,5];
fA=f(A) ??A的列向量的傅立叶变换
ffA=
1.0000 2.0000 7.0000 5.0000
4.0000+6.9282i 0.5000+0.8660i 0.5000+0.8660i -2.0000+3.4641i
4.0000-6.9282i 0.5000-0.8660i 0.5000-0.8660i-2.0000-3.4641i
第5章 MATLAB数值计算 ·141·
fftA2=f(A,4,2) ??A的行向量的傅立叶变换
fLA2=
7.0000 2.0000-1.0000i 1.0000 2.0000+1.0000i
-3.0000 -5.0000 -7.0000 -5.0000
11.0000 2.0000+3.0000i -3.0000 2.0000-3.0000i
if(fA) ??矩阵fHA的列向量进行傅立叶逆变换，结果应等于A
ans =
3.0000-0.0000i 2.0000-0.0000i 1.0000-0.0000i 1.0000-0.0000i
-5.0000 1.0000-0.0000i 0-0.0000i 1.0000-0.0000i
3.0000-0.0000i 2.0000+0.0000i 1.0000+0.0000i 5.0000+0.0000i
班(ftA2,4,2) ??矩阵血A2的行向量进行傅立叶逆变换，其结果应等于A
ans =
3.0000 2.0000+0.0000i 1.0000 1.0000-0.0000i
-5.0000 1.0000 0 1.0000
3.0000 2.0000-0.0000i 1.0000 5.0000+0.0000i
5.6 数值微积分
5.6.1 数值微分
一般来说，函数的导数依然是一个函数。数值方法的基本思想是：不求问题的解析表达结
果，而只求问题对应于某些点的解，称这样离散的解为数值解。设函数f(x)的导函数f(x)=
g(x),高等数学关心的是g(x)的形式和性质，而数值分析关心的问题是怎样计算 g(x)在一串
离散点X=(x?,x?,…,x)的近似值G=(g?,g?,…,gn)以及所计算的近似值有多大误差。误差
可以两个向量差的范数描述：
△=l(g(x?),g(x?),…,g(xn))-(g?,82,…,ga)l
当然，进行误差分析必须对g(x)的性质有所了解。
1.数值差分与差商
任意函数f(x)在x点的导数是通过极限定义的
上述式子中，均假设h>0,如果去掉上述等式右端的h→0的极限过程，并引进记号
·142· 基 础 篇
称△f(x).Vf(x)及8f(x)分别为函数在x点处以h(h>0)为步长的向前差分、向后差分和中心
差分。当步长h充分小时，有理由相信：
和差分一样，称△f(x)/h、Vf(x)/h及8f(x)/h分别为函数在x点处以h(h>0)为步长的向
前差商、向后差商和中心差商。当步长h(h>0)充分小时，函数f在点x的微分接近于函数在该
点的任意种差分，而f在点x的导数接近于函数在该点的任意种差商。
2.数值微分的实现
有两种方式计算任意函数f(x)在给定点x的数值导数，第1种方式是用多项式或样条函数
g(x)对f(x)进行逼近(插值或拟合),然后用逼近函数g(x)在点x处的导数作为f(x)在点x处
的导数。第2种方式是用f(x)在点x处的某种差商作为其导数。MATLAB中，没有直接提供求
数值导数的函数，只有计算向前差分的函数。
DX= diff(X)计算向量X的向前差分，DX(i)=X(i+1)-X(i),0<i<n。
DX=diff(X,n) 计算X的n阶向前差分，diff(X,2)=diff(diff(X))。
DX=diff(A,n,dim)计算矩阵A的n阶差分，dim=1时(缺省状态),按列计算差分；dim=
2,按行计算差分。
例5.40 求向量sin(X)的1~3阶差分。设X由[0,2π]间均匀分布的10个点组成。
命令如下：
X=linspace(6.2*pi,10);
Y=sin(X);
DY=dif(Y); ??算Y的一阶差分
??算Y的阶差分，也可用命令dif(DY)计算 D2Y=diff(Y,2);
D3Y=dif(Y,3); ??算Y的二阶差分，也可用diff(D2Y)或diff(DY,2)
输出结果分别是：
X=
0 0.6981 1.3963 2.0944 2.7925 3.4907 4.1888
4.8869 5.5851 6.2832
Y=
0 0.6428 0.9848 0.8660 0.3420 -0.3420 -0.8660
-0.9848 -0.6428 -0.0000
DY=
0.6428 0.3420 -0.1188 -0.5240 -0.6840 -0.5240 -0.1788
0.3420 0.6428
D2Y=
-0.3008 -0.4608 -0.4052 -0.1600 0.1600 0.4052 0.4608
0.3008
第5章 MATLAB数值计算 ·143·
D3Y=
-0.16000.0556 0.24520.3201 0.24522 0.0556 -0.1600
例5.41 用不同的方法求函数f(x)的数值导数，并在同一个坐标系中做出f(x)的图像。
设
f(x)=√x3+2x2-x+12+√x+5+5x+2
为进行对比，求出子(x)
f(x)=233+242-x+12*6x+5)+5
为确定计算数值导数的点，假设在[-3,3]区间以0.01为步长求数值导数，下面用3种方法
求f(x)在这些点的导数。首先用一个5次多项式p(x)拟合函数f(x),并对p(x)求一般意义下
的导数，得dp(x),求出dp(x)在假设点的值；第2种方法直接求f(x)在假设点的数值导数；第3
种方法直接求f(x)在假设点的导数，最后用一个坐标图显示这3条曲线。程序如下：
f=inline('sqt(x.^3+2*x.2-x+12)+(x+5).(1/6)+5*x+2');
g=inline('(3*x.^2+4*x-1)./sqt(x.3+2*x,2-x+12)/2+1/6./(x+5).(5/6)+5');
x=-3:0.01:3;
p=polyfit(x,f(x),5); ??5次多项式p拟合f(x)
dp=polyder(p); ??拟合多项式p求导数dp
?? dp在假设点的函数值 dpx= polyval(dp,x);
dx=dif(f([x,3.01]))/0.01; ??接对f(x)求数值导数
??函数f的导函数g在假设点的导数 gx=g(x);
??图 plot(x,dpx,x,dx,'g.*,x,gx,'r-');
程序运行后得到图5.2所示的图形。
8
7.5
7
65
6
5.5
5
4.5
3 -2 -1 0 1 2 3
图5.2 用不同力法求得的数值导数
·144· 基 础 篇
5.6.2 数值积分
1.数值积分的基本原理
数值积分研究定积分的数值求解方法。设
1=?r(x)dx,12=[p(x)dx
从高等数学中知道，当If(x)-p(x)|<e时，111-12I<e(b-a)。这说明，当ε充分小时，
可用12近似地代替I1。所以，求任意函数f(x)在[a,b]上的定积分时，当难以使用解析的方法
求出f(x)的原函数时，则可以寻找一个在[a,b]上与f(x)逼近，但形式上却简单日易于求积的
函数p(x),用p(x)在[a,b]上的积分值近似地代替f(x)在[a,b]上的积分值。一般选择被积
函数的插值多项式充当这样的替代函数。选择的插值多项式的次数不同，就形成了不同的数值
积分公式。选择一次多项式时，称为梯形公式，选择二次多项式时，称为辛普生(Simpson)公式。
如果把积分区间[a,b]分划为n个等长的子区间
[a,b]=[a,a,]U[a,a?]U…U[an-1,b]
则在每个子区间[a?,ai+1]上用f(x)的插值多项式p(x)代替f(x),其逼近效果一般将会比在整
个区间上使用一个统一的插值多项式时更好。这样就形成了数值积分复合公式。对被积函数
f(x)采用一、二次多项式插值，然后对插值多项式求积分，就得到了几个常见的数值积分公式
s?=za[f(a)+f(b)]
S2=6f(a)+4(“±b)+f(b)]
s,=瓷(f(a)+f(b)+22fa+h)]
s=告2[r(a+A)+4/(a+去1A)+f(a+(i+1)A)]
S?、S?是基本梯形和基本辛普生求积公式，S?、S?是复合梯形和复合辛普生求积公式。计算
数学中已经证明，对一般工程问题，复合辛普生积分公式具有足够的精度。
2.数值积分的实现
被积函数一般是用一个解析式给出，但也有很多情况下用一个表格形式给出。MATLAB中，
对这两种给定被积函数的方法，提供了不同的数值积分函数。
(1)被积函数是一个解析式
函数 quad(f,a,b,tol,trace)用于求被积函数f(x)在[a,b]上的定积分，tol是计算精度，缺省
值是0.001。trace非0时，画出积分图形。注意，调用quad 函数时，先要建立一个描述被积函数
f(x)的函数文件或语句函数。当被积函数f含有一个以上的变量时，quad 函数的调用格式为：
quad(f,a,b,tol,trace,gl,g2)
其中f,a,b,tol,trace等参数的含义同前。gl,g2代人f的非积分变量中，即将f=f(x,y,z)在
[a,b]上的积分确定为f(g1,g2,z)在[a,b]上的积分。当省略 tol,trace时，要补上[],具体用法
见例5.44。
数值积分函数还有一种形式 quad8,其用法与quad完全相同。一般说来，quad8比 quad 精度
第5章 MATIAB数值计算 ·145·
要高。
例5.42 用两种不同的方法求
1=f2dx
先建立一个函数文件ex.m:
function ex=ex(x)
??意应用点运算 ex= exp(-x.2);
retum
然后，在MATLAB命令窗口，输入命令：
??意函数名应加字符引号 quad('ex+,0,1,le-6)
anS=
0.7468
quad8('ex',0,1,le-6) ??另一函数求积分
ans=
0.7468
也可不建立关于被积函数的函数文件，而使用语句函数(内联函数)求解，命令如下：
g=inline('exp(-x.~2)'); ??义一个语句函数g(x)=exp(-x^2)
??意函数名不加号 quad8(g,0,1)
ans =
0.7468
读者可用解析方法计算一下本例，并与本例所显示的结果做一比较。
(2)被积函数由一个表格定义
在科学实验和工程应用中，函数关系往往是不知道的，只有实验测定的一组样本点和样本
值，这时，人们就无法使用quad 函数计算其定积分。MATLAB中，对由表格形式定义的函数关系
求定积分的问题来用trapz(X,Y)函数。其中向量X、Y定义函数关系Y=f(X)。X、Y是两个等
长的向量：X=(x?,x?,…,xn),Y=(y,y?,…,ya),并且x?<x?<…<xn,积分区间是[xi,x]。
例5.43 用trapz 函数计算
1=f2dx
在MATLAB命令窗口，输入命令：
X=0:0.01:1;Y=exp(-X.2);
trapz(X,Y)
ans =
0.7468
(3)二重积分
例5.44 计算
r=Jdzdy
的二重积分。
MATLAB中虽然直接提供计算二重积分的函数，但这里首先用累次积分的方法完成本例。
·146· 基 础 篇
本例积分区域是一个矩形，可以很容易将其转化为二次积分进行处理。具体方法是：首先在x
方向对区间[0,1]进行一个分划，得到一个向量，用x的每一个分量代入积分公式，此时所给积分
化为一个关于y的定积分，用函数quad就可求出该积分，然后对这一列积分值使用函数 trapz沿
x方向进行第二次积分。
建立一个函数文件fixy.m:
function f=f(x,y)
f=exp(-x.2-y.2);
returm
建立一个命令文件 ftxyl.m:
for i=1:20
int2(i)=quad(' fixy',0.1,[i,[j,x(i));?二维函数fixy中以x=x(i)代入并对y积分。
end
在MATLAB命令窗口，输入命令：
x=linspace(0,1.20);
fxyl
trapz(x,in2)
ans =
0.5576
读者会觉得上述过程非常烦琐，实际上，MATLAB提供了计算二重积分的函数：
dblquad(f,a,b,e,d,tol,trace)
该函数求f(x,y)在[a,b]×[c,d]区域上的二重积分。参数 tol,trace的用法与函数quad
完全相同。
如果直接使用这里介绍的二重积分函数dblquad来求解本例就非常简单，命令如下：
g=inline('exp(-x.~2-y.2)');
dblquad(g,0,1,0,1) ??接调用二重积分函数求解
ans =
0.5577
5.7 常微分方程的数值求解
5.7.1 引言
这里以一阶常微分方程为例叙述常微分方程的基本概念。一阶常微分方程的初值问题的一
般形式是
y'=f(x,y)
y(xn)=yo
多数情况下，一阶常微分初值问题的解是存在且惟一的，但存在解并不意味着可以用有限形
式表示其解。事实上，在大多数情况下，一阶常微分初值问题的解是不能用有限形式表示的。我
第5章 MATLAB数值计算 ·147·
们知道，常微分方程的解是一个函数，既然不能找到解的解析表达式，能否像数值微分一样即不
求解函数的一般表达式，而只求解函数在指定点的函数值，这就导致了对微分方程数值解的研
究。本节对微分方程数值解的基本思想做一个简单的介绍，并在此基础上讨论 MATLAB中的常
微分方程初值问题的数值解的求解方法。
5.7.2 龙格—库塔法简介
常微分方程初值问题的数值解的方法很多，有欧拉(Euler)法、线性多步法、预估校正法、龙格
一库塔法(Runge-Kutta)等，以龙格一库塔法使用最多，这里只对该方法进行介绍。MATLAB中，
也采用龙格—库塔方法实现对常微分方程初值问题的数值解求解。
为了叙述方便，这里重写一次一阶常微分方程的初值问题的一般形式
y'=f(x,y)
y(x?)=yo
在求解未知函数y时，y在x。点的值y(x?)=yn是已知的，并且根据高等数学中的中值定
理，应有
y(xo+ h)=y≈yo+ hf(xo,yo),h>0,称为步长
y(xo+2h)=y?≈yi+hf(xi,y)
一般地，在任意点x;=xo+ih,有
y(xo+ih)=y:≈y:1+ hf(x-1,y,1),i=1,2,…,n
当(xo,yo)确定后，根据上述递推式能计算出未知函数y在点x?=xo+ih,i=0,1,…,n的一
列数值解
y,=yo,yt,y2,…,yn,i=0,1,…,n
当然，递推过程中有一个误差累计的问题。在实际计算过程中，使用的递推公式一般进行过
改造，著名的龙格一库塔公式是
y(xo+ih)=n=x-1+6(k?+2k?+2k?+k?)
其中
k?=f(xi-1,yi-1)
hz=f(x?I+立h,y-1+立h)
k?=f(xi-1+立h,y:-1+立h饭)
k?=f(x?-1+h,y;-1+ hk?)
5.7.3 龙格—库塔法的实现
基于龙格 库塔法，MATLAB提供了求常微分方程数值解的函数，一般调用格式为：
[X,Y]= ode23(f,[x0,xn],y0)
[X,Y]= ode45(f,[x0,xm],y0)
其中X、Y是两个向量，X对应自变量x在求解区间[x0,xn]的一组采样点，其采样密度是自适
应的，无需指定；Y是与X对应的一组解，是一个函数，[x0,xn]代表自变量的求解区间，y0=
·148· 基 础 篇
y(x0),由方程的初值给定。函数在求解区间[x0,xn]内，自动设立采样点向量X,并求出解函数
y在采样点X处的样本值。
这两个函数分别采用了二阶、三阶龙格一库塔法和四阶、五阶龙格一库塔法，并采用自适应
变步长的求解方法，即当解的变化较慢时采用较大的步长，从而使得计算速度很快。当解的变化
较快时步长会自动地变小，从而使得计算精度很高。
例5.45 求微分方程
-2
(y=x2+ 初值问题在[1,3]区间内的数值解，并将结果与解析解( )进行比较。
这里f(x,y)=-2y/x+4x,先建立一个该函数的M文件 fxy1.m:
function f=f(x,y)
??意使用点运算符 f=-2.*y./x+4*x
retum
再输入命令：
[X,Y]= ode45(' fxyl',[1,3],2);
X ??示自变量的一组采样点
ans =
1.0000 1.0500 1.1000 1.1500 1.2000 1.2500 1.3000
1.3500 1.4000 1.4500 1.5000 1.5500 1.6000 1.6500
1.7000 1.75001.80001.8500 1.9000 1.9500 2.0000
2.0500 2.1000 2.15002.2000 2.25002.3000 2.3500
2.4000 2.4500 2.50002.55002.6000 2.6500 2.7000
2.75002.8000 2.8500 2.9000 2.9500 3.0000
Y ??示求解函数与采样点对应的一组数值解，结果是：
ans =
2.0000 2.0095 2.0364 2.0786 2.13442.2025 2.2817
2.3712 2.4702 2.5781 2.6944 2.8187 2.9506 3.0898
3.2360 3.3890 3.5486 3.7147 3.8870 4.0655 4.2500
4.4405 4.6368 4.8388 5.0466 5.2600 5.4790 5.7036
5.9336 6.1691 6.4100 6.6563 6.9079 7.1649 7.4272
7.6947 7.9676 8.2456 8.5289 8.8174 9.1111
(X.2+1./X.^2)' ??示求解函数与采样点对应的一组解析解，结果是：
ans =
2.0000 2.0095 2.0364 2.0786 2.1344 2.2025 2.2817
2.3712 2.4702 2.5781 2.6944 2.8187 2.9506 3.0898
3.23603.3890 3.5486 3.7147 3.8870 4.0655 4.2500
4.4405 4.6368 4.8388 5.0466 5.2600 5.4790 5.7036
5.9336 6.16916.4100 6.6563 6.9079 7.1649 7.4272
7.6947 7.9676 8.24568.5289 8.8174 9.1111
第5章 MATLAB数值计算 ·149·
从对两组结果的比较中可以看出，ode45函数具有很高的精度。
例5.46 求解
初值问题在区间[0,2]中的解。
这是一个二阶常微分方程，ode45函数只能求解一阶常微分方程和方程组，故应先将所给问
题转化为一个等价的一阶微分方程组。
令u=y,D=y得
建立一个函数文件 fxy2.m:
funetion f=f(x,y)
f(2)=-x.*y(2)+x.-2-5;
f(1)=y(2);
f=f';
return
在MATLAB命令窗口，输入命令：
[x,Y]=ode45('fxy2',[0,2],[5,6]);
[X,Y]
ans =
0 5.0000 6.0000
0.0419 5.2467 5.7856
0.0837 5.4843 5.5615
0.1256 5.7123 5.3288
0.1675 S.9304 5.0885
0.21756.17744.7929
0.2675 6.4095 4.4896
0.3175 6.6263 4.1806
0.3675 6.8275 3.8676
0.4175 7.0130 3.5526
0.4675 7.1828 3.2373
结果第一列为x的采样点，第二列和第三列分别为y和y与x对应点的值(只列出部分结
果)。
·150· 基 础 篇
5.8 非线性方程的数值求解
在5.3节中，已经比较详细地讨论了线性代数方程组的解法。在实际应用过程中，还有大量
的问题要归结于一个非线性方程或方程组的求解。非线性方程的求解过程比线性方程要困难很
多，一般没有程序性的求解步骤，需要解题者的知识与技巧。本节讨论在MATLAB中怎样求解一
般的非线性方程和方程组。在介绍MATLAB函数之前，为了使读者更好地明了函数参数的意义，
先简要介绍所需的数学背景知识。
5.8.1 数学迭代法简介
单变量方程的一般形式是
f(x)=0
n元方程组的一般形式是
记
称函数F(X)为向量值函数。引进了上述向量记号后，一般 n元方程组可以简记为
F(X)=0
向量值函数F(X)中有一个分量函数f(X)为非线性函数时，称方程组为非线性方程组。非
线性方程组一般使用迭代法方法求解。迭代法方法的基本思想是，首先构造一个与方程组等价
的方程组
X=G(X)
再选取一个初值向量X。,令X?=G(X?),X?=G(X?),…
一般的有
Xi+1=G(X,)
该式称为求解方程组的迭代式。由迭代式，可以从一个初值X。出发，求得一列向量：X?,X,
X?,…,X。对迭代式两边取极限，当极限
lim Xa+1= lim G(Xa)=X
存在时，显然，其极限值X*就是方程组F(X)=0的解。用这种方法求解方程的过程称为迭代
法。用迭代法求解方程组的关键问题是：如何构造一个函数G(X),使得：
第5章 MATLAB数值计算 ·151·
(1)迭代式是适当的，由其产生的一列X,都在G(X)的定义域内。
(2)由其定义的向量列X。收敛，即上述极限值存在。
(3)X有较快的收敛速度。
上述过程对于一般人员是比较困难的。幸运的是计算数学工作者已经研究出了许多构造迭
代函数G(X)的方法，其巾，牛顿(Newton)迭代法在解题过程中使用很普遍。牛顿迭代式是
Xn+1=X。-DF(X)]-'F(X)
其中，DF(X)称为F(X)的雅可比(Jacobi)矩阵 E
5.8.2 单变量非线性方程求解
在迭代式X.=C(X,)中，设n=1,就得到了求解单变量方程f(x)=0的牛顿迭代式
x.=x。-fx)
和求解微分方程一样，在MATLAB中，用户一般并不需要按上述迭代过程求解一个单变量方
程，MATLAB中，提供了求解单变量方程的函数fzero(f,x0,tol),该函数采用迭代法计算函数f(x)
的一个零点，迭代初值为xo,当两次迭代结果小于 tol时停止迭代过程。tol的缺省值是eps.
注意，在调用函数fzerp 之前，要使用M文件建立自已要计算的函数f(x),只有定义了函数
f(x)的M文件后，才能在fzero 函数的参数中使用自定义函数名。
f(x)=x-1+5在xo=-5和xo=1作为迭代仞值时的零点。 例5.47 求
先编制一个函数文件fz.m:
function f=f(x)
f=x-1/x+5;
然后，在MATLAB命令窗口，输入命令：
fzero('fz',-5) ??-5作为迭代初值
Zero found in the interval:[-4.8,-5.2].
ans =
-5.1926
fzero('fz',1)
Zero found in the interval:[0.094903,1.64
ans =
0.1926
·152· 基 础 篇
5.8.3 非线性方程组求解
MATLAB基本程序中未提供求解非线性方程组F(X)=0的函数，但在其优化工具箱(Opti mization Toolbox)中，为用户提供函数fsolve,其调用格式为：
X=fsolve(F,X0)
其中，X、F的意义如前述，X0是迭代初值向量。
例5.48 求下列方程组在(1,1,1)附近的解并对结果进行验证。
首先建立方程的函数文件 fxyzl.m:
function F=F(X)
x=X(1);y=X(2);z=X(3):
F(1)=sin(x)+y+z2*exp(x);
F(2)=x+y*z;
F(3)=x*y*z;
在MATLAB命令窗口，输入命令：
X=fsolve(' fxyzl',[1,1,1]) ??解X的3个分量x、y、z
X=
0.0015 -0.0136 0.1099
Y=fxyzl(X) ??验所求结果X是否满足原方程组
Y=
1.0e-005*
0.0004-0.0003 -0.2235
norm(Y)
ans=
??Y向量的模
2.2353e-006
Y向量的模接近0,说明结果正确。本例要求求解方程组 F(X)=[0;0;0](列向量),实际上
是求出了方程组F(X)=Y(Y的转置)的解，当||YI≈0时，认为后者的根就是所需求解的
根。
例5.49 求圆
x2+y2+z2=9
和直线
-3y-62-1=。 的两个交点。
该问题即为求解方程组
第5章 MATLAB数值计算 ·153·
应用函数 fsolve求解方程组时必须先估计出方程组的根的大致范围。所给直线的方向数是
(-12,24,-14),故其与球心在坐标原点的球面的交点大致是(-1,1,-1)和(1,-1,1)。以这
两点作为迭代初值。
建立方程组函数文件 fxyz2.m:
function F=F(X)
x=X(1);y=X(2);z=X(3);
F(1)=x2+y2+z2-9:
F(2)=3*x+5*y+6×z;
F(3)=x-3*y-6*z-1;
在MATLAB命令窗口，输入命令；
X1= fsolve(' fxy22',[-1,1,-1}) ??直线与球面的第一个交点
XI=
-0.9508 2.4016 -1,5259
X2=fsolve(' fxy22',[1,-1,1]) ??直线与球面的第二个交点
X2=
1.4180 -2.3362 1.2378
5.9 稀疏 矩 阵
在科学研究和工程计算中，所遇到的矩阵往往都是很大的，经常是几百阶甚至更大，并且，其
中的大部分元素都为0,非0元素很少，这样的矩阵称为稀疏矩阵。处理稀疏矩阵时，当然也可
以不考虑矩阵的稀疏特征，将其和普通矩阵同样处理，但这样做会浪费大量的存储空间，并由此
带来访问大量0元素时的时间消耗。计算数学中，专门研究了一套对稀疏矩阵的存储与处理方
法。本节先介绍这些方法的基本内容和MATLAB中对这些方法的支持，随后以两个示例帮助读
者更进一步理解这些内容。
5.9.1 叛阵存储方式
1.矩阵的完全存储模式
MATLAB中，矩阵一般是按列存储的，这种存储方式的特征是只存储矩阵元素本身，不存储
元素所在的行列位置，每个元素的行列位置由其元素的存储位置决定，这种存储方式称为完全存
储方式。完全存储方式没有辅助存储空间开销，直观简洁，但对于具有稀疏特征的矩阵，由于存
储了大量的0元素，降低了其对存储空间的利用率。
2.稀疏矩阵的存储方式
在稀疏存储方式中，一个非0元素用3个数据存储：元素、元素所在的行、元素所在的列。当
一个稀疏矩阵的非0元素少于1/3时，这种存储方式有利于提高存储空间利用率。设
^-
·154· 基 础 篇
是具有稀疏特征的矩阵，其顺序存储方式是按列存储一个元素序列，共12个元素：
1,0,2,0,5,0,0,0,0,0.0.7
其稀疏存储方式如下，括号内为元素的行列位置.其后面为元素本身。
(1,1),1,(3,1),2.(2,2),5,(3,4),7
稀疏存储方式也是占用12个元素空间，当原矩阵更加“稀疏”时，公有效地提高空间利用率
注意，在讲稀疏矩阵时，有两个概念需要分清：一是讲矩阵的0元素较多，该矩阵是一个具有
稀疏特征的矩阵；二是讲采用稀疏方式存储的矩阵。
5.9.2 稀疏存储方式的产生与转化
1.将一个完全存储方式转化为稀疏存储方式
函数B=sparse(A)将矩阵A转化为稀疏存储方式的矩阵B,当矩阵A是稀疏存储方式时，
函数调用格式相当于B=A。
例5.50 设
将A转化为稀疏存储方式，
在MATLAB命令窗口，输入命令：
A=[2,0,0,0,0;0.0,0,0.0;0,0,0,5,0;0,1,0,0,-1;0,0.0.0,-5];
B=spurse(A)
B=
(1.1)2
(4,2)1
(3,4)5
(4.5)-1
(5.5)-5
B就是A的稀疏存储方式，在运算过程中，B可以直接参与运算。当参与运算的对象不全
是稀疏存储矩阵时，所得结果一般是完全存储形式。
sparse 函数还有其他一些格式，逐一说明如下：
sparse(m,n) 生成一个m×n的所有元素都是0的稀疏矩阵。
sparse(u,v,S)u、V、S是3个等长的向量。S是要建立的稀疏矩阵的非0元素，u(i)、x(i)
分别是S(i)的行和列下标，该函数建立一个max(u)行、max(v)列并以S为稀疏元素的稀疏矩
阵。
此外，还有一些和稀疏矩阵操作有关的函数。例如：
[U.V,S]=find(A)返回矩阵A中非0元素的下标和元素。这里产生的U、V、S可作为
sparse(u,v,s)的参数。
full(A)返回和稀疏存储矩阵A对应的完全存储方式矩阵。
第5章 MATLAB数值计算 ·155
2.产生一个稀疏矩阵
sparse 函数可以将一个完全存储方式的稀疏矩阵转化为稀疏存储方式，但在实际应用时，如
果要创立一个200×150的稀疏存储方式的矩阵，按照上述方法，则必须先建立该矩阵的完全存
储方式矩阵，然后使用sparse 函数进行转化，这显然是不可取的。能否只把要建立的稀疏矩阵的
非0元素及其所在行和列的位置表示出来后由MATLAB自己产生其稀疏存储方式呢?这需要使
用spconvert 函数。调用格式为：
B=spcoavert(A)
其中A为一个m×3或m×4的矩阵，其每行表示一个非0元素，m是非0元素的个数.A中每
个元素的意义是：
(i,1)第i个非0元素所在的行。
(i,2)第i个非0元素所在的列
(i,3) 第i个非0元素值的实部。
(i.4)第i个非0元素值的虚部，若矩阵的全部元素都足实数，则无须第四列。
该函数将A所描述的一个稀疏矩阵转化为一个稀疏存储矩阵。
例5.51 将稀疏矩阵
转化为稀疏存储方式。
在MATLAB命令窗口，输入命令：
A=[2,2.1:3.1,-1;4,3,3;5,3,8;6,6,12j;
B=spconvert(A)
B=
(3.1)-1
(2,2)1
(4,3)3
(5,3)8
(6,6)12
应注意，矩阵A并非稀疏存储矩阵，只有B才是稀疏存储矩阵，为证明这 点，输入命令：
full(A) ??A的完全存储形式
ans=
2 2F
31-1
433
538
6612
fuli(B) ??B的完全存储形式：
ans=
·156· 基 础 篇
0 00 0 0 0
010000
-100000
003000
008000
0 00 0 0 12
3.单位稀疏矩阵的产生
单位矩阵只有对角线元素为1,其他元素都为0,是一种具有稀疏特征的矩阵。函数eyc产
生一个完全存储方式的单位矩阵，而MATLAB还有一个产生稀疏存储方式的单位矩阵的函数，这
就是speye。函数speye(m,n)返回一个m×n的稀疏存储单位矩阵。
5.9.3 稀蹴矩阵应用举例
例5.52 求下列齐次方程组
=0
=0
的基础解系。
这个方程组的系数矩阵中0元素较多，这里用稀疏矩阵来解决这个问题。在MATLAB命令
窗口，输入命令：
S=[1,1,1;1,3,-1;2,2,1;2,4,-1;3.1,-1:3,3,1;3,5,-1;4,2,-1;4,4,1;4,6,-1;5,3,-1;5,5,1;6,
4.-1;6,6,1]
该命令将产生·个关于系数矩阵的描述，结果是：
S=
111 ??明第1行第1列元素为1
13-1 ??明第1行第3列元素为-1
221
24-1
31-1
331
35-1
42-1
441
46-1
53-1
551
64-1
661
第5章 MATLAB数值计算 ·157·
A=spconvert(S) ??命令将对系数矩阵的描述S转化为一个稀疏存储矩阵
A=
(1,1)1
(3,1)-1
(2,2)1
(4,2)-1
(1,3)-1
(3,3)1
(5,3)-1
(2,4)-1
(4,4)1
(6,4) -1
(3,5) -1
(5,5)1
(4,6)-1
(6,6)1
x=null(A,'r') ??函数将求出原方程组的基础解系
x=
Empty matrix:6-by-0
说明原方程组没有非0解。读者可以计算该系数矩阵的秩，会看到该系数矩阵是一个满秩
矩阵。
稀疏矩阵还有很多功能强大的应用，有兴趣的读者可查阅有关资料。
习 题 五
1.求下列矩阵的主对角元素、上三角阵、下三角阵、逆矩阵、行列式的值、秩、范数、条件数、迹、特征值和特
征向量。
w[
2.分别用克莱姆(Cramer)法则、矩阵求逆、矩阵除法以及矩阵分解法求下列线性方程组的解。
·158· 基 础 篇
3.按要求对指定函数进行插值和拟合
表5.3 特殊角的正弦正切值表
a(度) 0 15 30 45 75 60
0.707 1 0.5000 0.2588
0.2679 0.577 4 1.0000
0.8660 0.9659
1.7320 3.7320
90
sina 0 1.0000
tana 0
表5.4 1-100内特殊值的平方根表
N 1 4 9
1 2 3
36 25 16 49 64
4 5 6 7 8
81 100
N 9 10
(1)按表5.3用三次样条方法插值计算0°~90'内整数点的正弦值和0~75内整数点的正切值.然后用5次
多项式拟合方法计算相同的函数值，并将两种计算结果进行比较。
(2)按表5.4用三次多项式方法插值计算1-100之间整数的平方根。
4.利用MATLAB提供的 randn 函数生成符合正态分布的10×5随机矩阵A,进行如下操作：
(1)A各列元素的均值和标准方差。
(2)A的最大元素和最小元素。
(3)分别对A的每列元素按升序、每行元素按降序排序。
5、已知多项式P?(x)=3x+2.P?(x)=5x2-x+2,P?(x)=x2-0.5,求：
(1)P(x)=P(x)P?(x)P?(x)
(2)P(x)=0的全部根。
(3)计算 x,=0.2i.i=0,1.2.….10各点上的P(x,)
6.求下列函数在指定点的数值导数。
(1)f(x)=sin2x+cus2x,x=6,43,
(2)f(x)=√x2+1.x=1,2,3
7.求数值积分。
(1)smnsiskdx
(2)d
f.√x2+Pds,c:x2+y2=1. (3)
cos(x+y)dxdy,Q:0≤x≤π,0≤y≤ (4)
8.求下列函数在指定区间的最大值：
(1)f(x)=1±xx∈(0,2)。
(2)f(r)=sinx+cosx2,x∈(0.π):
第5章 MATLAB数值计算 ·159·
9.求下列微分方程的数值解。
{--
10.求下列非线性方程的数值解。
(1)x?+3x3-2x2+5x-10=0
MATLAB符号计算 第6章
符号计算是MATLAB的一个重要组成部分。应用符号计算功能，可以直接对抽象的符号对
象进行微积分与代数计算，并获得问题的解析结果。MATLAB中的符号计算功能是以Maple V
为基础开发的，集成在MATLAB的符号运算工具箱(Symbolic Math Toolbox)中。用户必须在MAT LAB安装时选择安装符号运算工具箱模块，才能运行与符号运算有关的函数。
本章首先介绍符号计算基础，然后介绍符号微积分、级数的符号求和与函数的级数表示、代
数方程和微分方程的符号求解等内容。
6.1 符号计算基础
在科学研究和工程实践活动中，除存在大量的数值计算外，还有对符号对象进行的运算。符
号计算可以获得比数值计算更一般的结果。MATLAB中为用户提供了一种符号数据类型，相应
的变量和常量称为符号变量和符号常数。用户在定义了符号对象(符号变量、符号常数以及有它
们参与的数学表达式)后，可以进行符号对象的运算。
6.1.1 符号对象
进行符号运算前首先要建立符号对象。如前所述，符号对象包括符号变量、符号常数以及符
号表达式等。
1.建立符号变量和符号常数
MATLAB中提供了2个建立符号对象的函数：sym和syms,两个函数的用法不同。
(1)sym函数
sym 函数用来建立单个符号量，例如，a=sym('a')建立符号变量a,此后，用户可以在表达式
中使用变量a进行各种运算。读者不要将符号变量a和在其他过程中建立的非符号变量a混
淆。一个非符号变量在参与运算前必须赋值，变量的运算实际上是该变量所对应值的运算，其运
算结果是一个和变量类型对应的值。而符号变量参与计算前无须赋值，其结果是一个由参与运
算的变量名组成的表达式。为使读者理解这一点，下面看一个实例。
例6.1 考察符号变量和数值变量的差别。
在MATLAB命令窗口，输人命令：
a=sym('a');b=sym('b');c=sym('c');d= sym('d'); ??义4个符号变量
??义4个数值变量 w=10;x=5;y=-8;z=11;
A=[a,b;c,d] ??立符号矩阵A
A=
[a,b]
第6章 MATLAB符号计算 ·161·
[c,d]
B=[w,x;y,z] ??立数值矩阵B
B=
105
-811
det(A) ??算符号矩阵A的行列式
ans=
a*d-b*c
det(B) ??算数值矩阵B的行列式
aNS=
150
应用sym 函数还可以定义符号常数，使用符号常数进行代数运算时与数值常数进行的运算
有些差别。
例6.2 比较符号常数与数值在代数运算时的差别。
在MATLAB命令窗口，输入命令：
pil=sym(' pi');kl=sym('8');k2=sym('2·);k3=sym('3'); ??义符号变量
pi2=pi;rl=8;r2=2;r3=3; ??义数值变量
sin(pil/3) ??算符号表达式值
ans=
1/2*3(1/2)
sin(pi2/3) 计算数值表达式值
ans=
0.8660
sqrt(k1) ??算符号表达式值
ans=
2*2~(1/2)
spt(r1) ??算数值表达式值
ans=
2.8284
sqt(k3+sqt(k2)) ??算符号表达式值
ans=
(3+2^(1/2))(1/2)
sqrt(r3+sqrt(r2)) ??算数值表达式值
ans=
2.1010
从该例可以看出，用符号常数进行计算更像在进行数学演算，所得到的结果是精确的数学表
达式，而数值计算将结果近似为一个有限小数。
在例6.1和6.2中，读者可以看到，函数sym一次只能定义一个符号变量，使用不方便。
MATLAB提供了另一个函数syms,一次可以定义多个符号变量。
(2)syms 函数
syms 函数的一般调用格式为：
·162· 基 础 篇
syms varl var2…an
函数定义符号变量 varl,var2,…,varn等。用这种格式定义符号变量时不要在变量名上加
字符分界符(),变量间用空格而不要用逗号分隔。例如，用syms函数定义4个符号变量a、b.c,
d,命令如下：
syms a bcd
2.建立符号表达式
含有有符号量的表达式称为符号表达式。符号表达式包括一般代数式、符号方程、符号矩阵
和抽象函数等。
(1)建立代数式
建立符号表达式的方法有两种：一是直接用sym函数建立符号表达式，二是使用已经定义的
符号变量组成符号表达式。
例6.3 用两种方法建立符号表达式：3x2+5y+2xy+6。
在MATIAB窗口，输入命令：
U=sym('3*x^2+5*y+2*x*y+6') ??义符号表达式U.此时不需定义变量x、y
U=
3×x2+5`y+2×x*y+6
synis xy;
V=3)x2+5×y+2×x*y+6
??立符号变量x、y
??义符号表达式V
ans =
3*x^2+5*y+2*x*y+6
2·U-V+6 ??符号表达式的值
ans =
3*x2+5*y+5*x*y+12
(2)建立符号方程
利用sym函数可以建立符号方程。例如，y=sym('a*x^2+bx+c=0·)建立一个符号方程
ax2+bx+c=0、因为符号方程中含有等号，所以不能采用赋值的方法米建立符号方程，否则方
程中的等号和命令中的赋值号会混淆。
(3)建立符号矩阵
在例6.1巾已经建立了一个符号矩阵A,这里采用的是直接输入法。也可以由一些小的符
号矩阵来构成一个大的符号矩阵。
例6.4 计算3阶范得蒙德(Vandermonde)矩阵行列式的值。设A是一个由符号变量a,b,c
确定的范得蒙德矩阵。
^-
用 vander 函数可以建立一个范得蒙德数值矩阵，但对一组符号变量，不能用 vander函数，必
须用其他的方法建立矩阵。命令如下：
syms a bc;
U=[a.b,c];
第6章 MATLAB符号计算 ·163·
A=[[1,1.1:L;U.21 ??立范得蒙德符号矩阵
A=
[1.1.1
a.b.ej
a~2,b^2,c~2]
del(A) 呢计算A的行列式值
ans =
b×c2-c*b2-a*C~2+a*b2+a2*c-a2*b
(4)建立抽象函数
符号表达式和符号矩阵中，尽管其表达式本身的值末确定，但函数关系是确定的，所谓抽象
函数，是函数关系也未确定的一种函数。例如，函数f(x,y)只知道函数了依赖于变量x和y,但
并未确定具体的依赖关系，这是一个抽象函数。在高等数学中所研究的多是这一类函数。
例6.5 建立x,y的一般二元函数。
在MATLAB命令窗口，输人命令：
syms xy:
f=sym('f(x.y)');
6.1.2 基本的符号运算
1.符号表达式运算
(1)符号表达式的四则运算
符号表达式的四则运算和其他表达式的运算并无不同，但要注意，其运算结果依然是一个符
号表达式。且在很多时候，MATLAB并未将结果化为最简形式。
例6.6 符号表达式的四则运算示例。
在MATLAB命令窗口，输人命令：
syms xy z;
f=2*x+x2*x-5*x+x^3 ??号表达式的结果为最简形式
f=
-3*x+2*x^3
f=2*x/(5×x) ??号表达式的结果为最简形式
f=
2/5
1=(x+y)*(x-y) ??号表达式的结果不是x2-y2,而是(x+y)*(x-y)
[=
(x+y)×(x-y)
(2)因式分解与展开
MATLAB提供了儿个专用于符号表达式运算的函数，它们既可用于一般符号表达式，也可用
于符号矩阵，下面简要介绍这儿个函数的功能和用法。
factor(S)对S分解因式，S是符号表达式或符号矩阵，
expand(S)对S进行展开，S是符号表达式或符号矩阵。
collect(S)对S合并同类项，S是符号表达式或符号矩阵。
·164· 基 础 篇
collect(S,v)对S按变量v合并同类项，S是符号表达式或符号矩阵。
例6.7 对下列符号矩阵A的每个元素分解因式。
a=[22-46+1003--2]
符号矩阵A涉及a,b,x,y等4个符号变量，首先定义符号变量及符号矩阵，然后应用 factor
函数分解因子。命令如下：
syms a bxy;
A=[2*a^2*b3*×2-4*a*b~4*x3+10*a*b6*x4,3*x*y-5*x2;4,a3-b^3];
??A的每个元素分解因式 factor(A)
ans=
[2*a*x^2*b3*(5*x2*b3-2*x*b+a), -x*(-3*y+5*x)]
[ (a-b)*(a^2+a*b+b2)? 4.
例6.8 计算表达式S的值。
S=(-7x2-8y2)×(-x2+3y2)
命令如下：
syrms x y;
s=(-7*x2-8*y^2)*(-x2+3*y^2);
expand(s)
ans=
??s展开
7*x4-13*x2*y2-24*y4
collect(s,x)
ans
??s按变量x合并同类项(无同类项)
7*x^4-13*x2*y2-24*y4
factor(ans)
ans =
(7*x2+8*y2)*(x2-3*y2)
??ans分解因式
(3)表达式化简
MATLAB提供的对符号表达式化简的函数有：
simplify(S) 应用函数规则对S进行化简。
simple(S)调用MATLAB的其他函数对表达式进行综合化简，并显示化简过程。
例6.9 化简
s=(x2+y2)2+(x2-y2)2
命令如下：
syms xy;
s=(x^2+y2)2+(x^2-y^2)2;
?TLAB自动调用多种函数对s进行化简，并显示每步结果 simple(s)
simplify; ??是simple 函数自动调用的函数，并非由用户健人。下同
2*x4+2*y4
radsimp:
2*x4+2*y4
第6章 MATLAB符号计算 ·165·
combine(trig):
2*x4+2*y4
factor:
2*x4+2*y4
expand:
2*x^4+2*y4
combine:
(x2+y^2)-2+(x-2-y2)-2
convert(exp):
(x2+y2)~2+(x2-y2)2
convert(sincos):
(x2+y2)2+(x^2-y2)~2
convert( tan):
(x^2+y2)2+(x^2-y2)~2
collect(x):
2*x^4+2*y4
ans =
2*x4+2*y4
simple 函数试探使用各种函数化简，其化简过程是机械性的，其中有些步骤可以省略。
2.符号矩阵运算
上述用于一般符号表达式的函数都可用于符号矩阵，但应注意这些函数用于符号矩阵时，是
分别作用于矩阵的每一个元素。除上面介绍的函数外，MATLAB还有一些专用于符号矩阵的函
数，这些函数作用于单个的数据无意义。
transpose(S) 返回S矩阵的转置矩阵。
determ(S) 返回S矩阵的行列式值。
colspace(S)返回S矩阵列空间的基。
[Q,D]=eigensys(S)Q返回S矩阵的特征向量，D返回S矩阵的特征值。
其实，第5章曾介绍过的许多应用于数值矩阵的函数，如 diag、triu、tril、inv、det、rank、eig等，也
可直接应用于符号矩阵。
6.1.3 符号表达式中变量的确定
MATLAB中的符号可以表示符号变量和符号常数。findsym可以帮助用户查找一个符号表达
式中的符号变量。该函数的调用格式为：
findsym(S,n)
函数返回符号表达式S中的n个符号变量，若没有指定 n,则返回S中的全部符号变量。
例如
syms x ay zb;
sl=3*x+y;s2=a*y+b;
findsym(sí),findsym(s2,2),findsym(5*x+2)
ans =
??义5个符号变量
??义符号表达式
·166· 基 础 篇
x.y
ans
y,b
ans =
x
c=sym('3');
findsym(a*x+b^y+c)
??义符号常数c
??号常数c不在结果中出现
ans =
s,b,x,y
在求函数的极限、导数和积分时，如果用户没有明确指定自变量，MATLAB将按缺省原则确
定主变量并对其进行相应微积分运算。可用 findsym(S,1)查找系统的缺省变量，事实上，MAT LAB按离字符'x最近原则确定缺省变量。例如：
findsym(a*y+b*w,1)
ans =
y
findsym(a*z+b*w,1)
ans =
w
6.2 符号导数及其应用
学习 MATLAB符号计算的日的在于借助于MATLAB的强大功能解决实际应用中遇到的问
题，减少用户在数学上的大量推理和计算。极限与导数是高等数学的基础，现在就研究如何应用
MATIAB解决求函数极限和导数的问题。
6.2.1 函数的极限
MATLAB中求函数极限的函数是limit,可用来求函数在指定点的极限值和其左右极限值。
limit 函数的调用格式为：
limit(f,x,a)
函数求极限limf(x)。格式中的参数a,x可以省略。当省略参数x时，MATJ.AB按缺省原则
确定求极限的变量。可使用函数findsym(f,1)帮助查找符号表达式f的缺省变量。当省略参数a
时，MATLAB默认变量趋近于0.即相当于a=0的情况。
limit 函数的另一种功能是求单边极限，其调用格式为：
limit(f,x,a,' right')或limit(I,x,a,' left')
lim/(x)和Limf(x)。参数x和a的取值规则同前。 分别求极限
例6.10 求下列极限。
(1)m (2) imsin(x+a)-sin(x-a)
第6章 MATLAB符号计算
(3) lim x(√x2+1-x) (4)im--a
在MATLAB命令窗口，输入命令：
syms a m x;
f=(x(1/m)-a(1/m))/(x-a);
limit(f,x,a) 呢求极限(1)
ans=
a(1/m)/a/m
f=(sin(a+x)-sin(a-x))/x;
limit(f) ??极限(2)
ans 
2*cos(a)
f=x*(sgrt(x~2+1)-x);
Kimit(f,inf) ??f函数在x(包括+∞和-如)处的极限
ans =
NaN
limit(f,x,inf,' left') ??极限(3)
ans =
1/2
f=(sapt(x)-spt(a)-sqt(x-a))/sqt(x*x-a*a);
limit(f,x,a,' right') 呢求极限(4)
ans =
-1/2*2(1/2)/a(1/2)
6.2.2 符号画数求导及其应用
导数的概念是读者已经熟悉的，它是高等数学的基础，是现代数学的一个基本工具，这一节
讨论怎样应用MATLAB求函数的一阶导数、高阶导数以及求多变量函数的导数。
MATLAB中的求导的函数为：
dif(f,x,n)
diff 函数求函数f对变量x的n阶导数。参数x的用法同求极限函数limit,可以缺省，缺省
值与limit 相同，n的缺省值是1。
例6.11 求下列函数的导数。
(1)y=√1+e2,求y'。 (2)y= xcos(x),求y"、y"。
(3){r=baint (4)=.求。 ,求y、y"。
(5)z=f(x,y)由方程 x2+y2+z2=a2定义，求z、y。
命令如下：
syms abtxy z;
f=sqn(L+exp(x));
dif(1) ??(1)。未指定求导变量和阶数，按缺省规则处理
·167·
·168· 基 础 篇
ans =
1/2/(I+exp(x))~(1/2)*exp(x)
f=x*cos(x);
dif(f,x,2) ??(2)。求f对x的二阶导数
ans=
-2*sin(x)-x*cos(x)
dif(f,x,3) ??(2)。求亻对x的三阶导数
ans =
-3*cos(x)+x*sin(x)
fl=a*cos(t);2=b*sin(t);
diff(12)/dif(fl) ??(3)。按参数方程求导公式求y对x的导数
Ans=
-b* cos(t)/a/sin(1)
(diff(fA)*dif(2,2)-diff(f1,2)*dif(2))/(diff(fI))~3??(3)。求y对x的二阶导数
ans =
-(a*sin(t)2*b+a*cos(1)^2*b)/a^3/sin(t)^3
f=x*exp(y)/y2;
dif(f,x) ??(4)。z对x的偏导数
ans =
exp(y)/y2
diff(f,y) ??(4)。z对y的偏导数
ans =
x*exp(y)/y2-2*x* exp(y)/y3
f=x2+y2+z2-a2;
zX=-diff(f,x)/diff(f,z) ??(5)。按隐函数求导公式求z对x的偏导数
zx=
-x/z
zy=-dif(f,y)/dif(f,z) ??(5)。按隐函数求导公式求z对y的偏导数
zy=
-y/z
解题过程中未对结果化简处理，读者可用6.1.2节中的有关函数进一步简化有些导函数的
结果。
例6.12 求曲线y=x3+3x-2上与直线y=4x-1平行的切线的切点。
依题意，即求曲线哪一点的导数值为4。命令如下：
x=8yin('x');
y=x3+3*x-2; ??义曲线函数
f=dif(y); ??曲线求导数
g=f-4;
solve(g) ??方程f-4=0的根，即求曲线何处的导数为4
ans =
[1/3*3-(1/2)]
第6章 MATLAB符号计算 ·169·
[-1/3*3*(1/2)}
x=3和x=-3 结果表明，在 处的切线和指定直线平行。
从这个例子可以看到，MATLAB尽管可以进行很多繁杂的计算，但应用MATLAB解决实际问
题时，解题者自身的分析过程也是必不可少的。
6.3 符 号 积 分
在第5章介绍了求定积分的数值方法。数值方法最大的好处就是“可行性”,不管被积函数
的形式如何、复杂程度怎样，采用数值积分法总可以求得一个结果，尽管这种结果大部分情况下
是近似的。数值方法最大的缺点就是不能获得解析解。这一节讨论符号函数的积分，这里讨论
的方法可以获得和高等数学巾一样的解析结果。积分算法是非结构性的，许多函数的原函数存
在，但不可用有限解析表达式表示，即使可以求积的函数，其求积过程也可能很复杂，但利用
MATLAB求积分就非常容易。
6.3.1 不定积分
求函数的不定积分是求导数的逆运算。在MATLAB中，求不定积分的函数是int,其调用格
式为：
int(f,x)
int 函数求函数f对变量x的不定积分。参数x可以缺省，缺省原则与diff 函数相同。
例6.13 求下列不定积分。
(1)?(3-x2)dx
(2)?√x1+x2dx
命令如下：
x=sym('x');
f=(3-x2)~3;
int(f) ??不定积分(1)
ans =
-1/7*x7+9/5*x^5-9*x3+27*x
f= sqr(x^3+x4);
int(f) ??不定积分(2)
ans =
-1/48*(x3+x4)(1/2)*(-16*(x2+x)(3/2)+12*(x2+x)“(1/2)#x+6*(x2+x)“(1/2)-3*log
(1/2+x+(x2+x)^(1/2)))/x/((x+1)*x)(1/2)
g=simple(ans) ??用simple 函数对结果化简
g=
1/3*x(5/2)*(x+1)-(1/2)+1/12*x~(3/2)*(x+1)'(1/2)~1/8*x'(1/2)*(x+1)~(1/2)+1/16*
·170· 基 础 篇
log(1/2+x+(x2+x)^(1/2))
上述结果还可进一步化简，这也说明MATLAB还有需进一步完善的地方。
6.3.2 符号函数的定积分
定积分在实际工作中有广泛的应用。在MATIAB中，定积分的计算使用函数：
int(f.x,a,b)
该函数计算函数f在区间[a.b]或(a,b)上的定积分。参数x的意义与求不定积分函数相
同。a和b可以是两个具体的数，也可以是一个符号表达式，还可以是无穷(inf)。当函数f关于
变量x在闭区间[a,b]上可积时，函数返同一个定积分结果。当a,b中有一个是iaf时，函数返
回一个广义积分。当a,b中有一个是符号表达式时，函数返回一个符号函数。
例6.14 求下列定积分，并对(4)与数值积分结果进行比较。
(1)f1-x1dx
dx (2)
(3) 24adx
(4) ?(x-1)
命令如下：
x=sym('x');t=sym('t');
int(abs(1-x),1,2) ??定积分(1)
ans =
1/2
f=1/(1+x2);
int(f,~inf,inf) ??定积分(2)
anS=
pi
int(4*{*x,x,2,sin(t)) ??定积分(3)
an8 
2*t*(sin(t)~2-4)
f=x3/(x-1)-100;
I= int(f,2,3) ??符号积分的方法求定积分(4)
I=
97893129180187301565519001875382615/1192978373971185320372138406360121344
double(I) ??上述符号结果转换为数值
ans =
0.0821
为应用数值方法求定积分(4),先建立一个函数文件 fxx.m:
function f=[(x)
f=x.3./(x-1).^100; ??意应使用点运算
第6章 MATLAB符号计算 ·171·
再在MATLAB命令窗口，输入命令：
II= quad8(' fxx',2,3,le-6)
I1=
??数值积分方法求定积分(4)
0.0821
计算结果表明两种计算方法的结果完全一致。
例6.15 求椭球的体积。
+菇+=1
用平面z= zo(zo≤c)去截取上述椭球时，其相交线是一个椭圆；,该椭圆在xy平面投影的面
积是S(z)=rab(c2-22) v=jS(z)dz。 ,椭球的体积
命令如下：
syms a bez;
f=pi*a*b*(e~2-z2)/c2;
V=int(f,z,-c,c)
V=
4/3*pi*a*b*e
例6.16 轴的长度为10m,若该轴的线密度计算公式是f(x)=6+0.3x(kg/s)(其中x为
距轴的端点的距离),求轴的质量。
轴的质量应是轴密度函数沿整个轴的积分。下面应用数值积分和符号函数两种方式计算轴
的质量。
(1)符号函数积分。在MATLAB命令窗口，输人命令：
syms x;
f=6+0.3*x;
m=int(f,0.10)
m =
75
(2)数值积分。
先建立一个函数文件fx.m:
function fx=fx(x)
fx=6+0.3*x;
再在MATLAB命令窗口，输入命令：
m=quad('fx',0,10,1e-6)
m=
75
由于本例很简单，两种计算方法的结果完全一样，大部分情况下，两者会存在极小的差别，一
般符号函数积分的结果是准确的。但读者不要认为有了符号函数积分后，数值积分就毫无用处，
在不能用有限形式表示一个函数的原函数，或被积函数只有列表表示形式时，数值积分方法是符
号函数积分无法替代的。
例6.17 求空间曲线c从点(0,0,0)到点(3,3,2)的长度。设曲线c的方程是：
·172· 基 础 篇
求曲线c的长度是曲线一型积分问题，按公式可转化为定积分问题。这里曲线的始终点对
应参数t=0和t=1,曲线积分转化为定积分的公式是：
?F(x,y,2)=ff(x(2),y(t),2(t))√(x'(t)2+(y(2)2+(z(2))2d
计算曲线长度时，被积函数f=1。
命令如下：
syms t;
x=3*1;y=3+12;z=2*r3;
f= dif([x,y,z],t) ??x,y,z对参数1的导数
f=
[ 3,6*t,6*r2]
g=sqrt(f+f') ??算一型积分公式中的根式部分
8=
3*(1+4*t*corj(t)+4*12*conj(t)2)~(1/2)
1=in(g,t,0,1) ??算曲线c的长度
1=
5
6.3.3 积分变换
所谓积分变换，就是通过积分运算，把一个函数f变成另外一个函数F,变换过程是
F(1)=?f(x)K(x,t)dx
其中二元函数K(x,t)称为变换的核，变换的核决定了变换的不同名称。f称为变换F的原函
数，而F(t)称为f(x)的像函数。在一定条件下，像函数F(t)和原函数f(x)间是一—对应，可以
相互转化的。
积分变换的一项基本应用是求解微分方程，求解过程是基于这样一种想法：假如不容易从原
方程直接求得解f,则对原方程进行变换，如果能从变换以后的方程中求得解F,则对F进行逆
变换，即可求得原方程的解f,当然，在选择变换的核时，应使得变换以后的方程比原方程容易求
解。
常见的积分变换有傅立叶变换、拉普拉斯变换和Z变换。
1.傅立叶(Fourier)变换
当积分变换的核
K(x,t)=e-i(其中i为虚数单位)
称积分变换
F(t)=Jf(x)e-dx
第6章 MATLAB符号计算 ·173·
为傅立叶变换，其逆变换为
f(x)=2F(t)ed
在MATLAB中，进行傅立叶变换的函数是：
fourier(fx,x,t)求函数f(x)的傅立叶像函数F(t)。
ifourier(Fw,t,x)求傅立叶像函数F(t)的原函数f(x)。
例6.18 求函数y=Ixi的傅立叶变换及其逆变换。
命令如下：
syms xl:
y=abs(x);
??y的傅立叶变换 Ft= fourier(y,x,t)
Ft=
-2/r2
fx=ifourier(Pt,t,x) ??F的傅立叶逆变换
fx=
x*(Heaviside(x)-Heaviside(-x))
结果中的Heaviside是Maple函数库中的一个函数，数学上称为单位阶跃函数。其定义是
eavisdecx)={0,x<0
不能在MATLAB中调用Heaviside函数。
2.拉普拉斯(Laplace)变换
拉普拉斯变换在微分方程、信号分析及自动控制方面有广泛的应用。当积分变换的核为
K(x,t)=e
称积分变换
F(t)=J。x)e=“dx
为拉普拉斯变换，其逆变换为
f(x)=J"F(t)e“d
在MATLAB中，进行拉普拉斯变换的函数是：
laplace(fx,x,t)求函数f(x)的拉普拉斯像函数F(t)。
ilaplace(Fw,t,x)求拉普拉斯像函数F(t)的原函数f(x)。
例6.19 计算y=x2的拉普拉斯变换及其逆变换。
命令如下：
x=sym('x');y=x^2;
Ft=laplace(y,x,t) ??函数y进行拉普拉斯变换
A=
2/r3
fx=ilaplace(Ft,t,x) ??函数Ft进行拉普拉斯逆变换
fx=
·174· 基 础 篇
x2
3.Z变换
当函数f(x)呈现为一个离散的数列f(n)时，称变换
F(2)=2f(n)e“
为Z变换，其逆变换为
(n)-zfF(z)d
其中i为虚数单位。
对数列f(n)进行 Z变换的MATLAB函数是：
ztrans(fn,n,z)求fn的Z变换像函数F(z)
iztrans(Fz,z,n) 求Fz的Z变换原函数f(n)
例6.20 求数列fn =e?"的Z变换及其逆变换。
命令如下：
syms n z
fn= exp(-n);
??fn的Z变换 Fz=ztrans(fn,n,z)
Fz=
z/exp(-1)/(z/exp(-1)-1)
f= iztrans(Fz,z,n) ??Fz的逆Z变换
f=
exp(-1)^n
4.积分变换的应用
下面举例说明拉普拉斯变换在求解微分方程中的应用。
例6.21 用拉普拉斯方法解微分方程。
y"-2y-3y=4e2*
y(0)=2,y'(0)=8
用拉普拉斯方法解微分方程的基本思想是对方程两端同时进行拉普拉斯变换，并利用拉普
拉斯变换的性质求出未知函数y的像函数L[y],然后对L[y]进行逆变换。
命令如下：
syms x t;
y= sym('y(x)); ??义未知函数为一个抽象函数
PtI= laplace(dif(y,2)-2*diff(y)-3*y,x,t) ??方程左端进行拉普拉斯变换
Ftl=
1*(1*Japlace(y(x),x,1)-y(0))-D(y)(0)-2*t*Japlace(y(x),x,t)+2*y(0)-3*laplace(y(x),x,t)
Ft2= laplace(4*exp(2*x),x,t) ??方程右端进行拉普拉斯变换
F2=
4/(t-2)
令FtI= Ft2,并将初值条件y(0)=2,Dy(0)=8代人，得
(t*t-2t-3)*laplace(y(x),x,)-2t-4=4/(t-2)
第6章 MATLAB符号计算 ·175
这是一个关于laplace(y(x),x,t)的代数方程，解这个方程，得
laplace(y(x),x,t)=(2t+4+4/(t-2))/(t×t-2t-3)
对laplace(y(x),x,1)求拉普拉斯逆变换，即得到y(x)。命令如下：
??行拉普拉斯逆变换 y= ilaplace((2*1+4+4/(t-2))/(t*1-2*t-3),t,x)
y=
-4/3*exp(2*x)-1/6×exp(-x)+7/2*exp(3*x)
通过拉普拉斯变换及其逆变换，将一个微分方程的求解问题转化为一个代数方程的求解问
题，这种思想读者应认真体会。另外，本例中将未知函数y定义为一个关于x的抽象函数而不是
一般的字符变量，这也应引起读者注意。
6.4 级 数
数值级数与函数级数是高等数学的重点研究内容，级数也是物理学以及其他工程技术学科
的重要理论基础和分析工具。这一节讨论MATLAB有关级数的函数。
6.4.1 级数的将号求和
在第5章讨论过有限级数求和的函数sum,sum处理的级数是以一个向量形式表示的，并且
只能是有穷级数，对于下面的等比无穷级数求和
s=∑
sum是无能为力的。求级数的和S需要符号表达式求和函数symsum,调用格式为
symsum(a,n,n0,nn)
其巾a表示一个级数的通项，是一个符号表达式。n是求和变量(n可以省略，省略时使用系统
的缺省变量),n0和nn是求和的开始项和末项。函数的功能是求和：S=a(n0)+…+a(nn)。
例6.22 求下列级数之和。
(1)s1=1+4+9+16+…++…
(2)s2=1-2+3-4+…+(-1)“+…
(3)s3=x+2x2+3x3+…+nx"+…
(4)s4=1+4+9+16+…10000
命令如下：
n=sym('n');
sl=symsum(1/n^2,n,1,inf)
sl =
I/6*pi2
??sl
s2=symsum((-1)(n+1)/n,1,inf)
s2=
??s2。未指定求和变量，缺省为o
log(2)
·176· 基 础 篇
s3=symsum(n*x^n.n,1,inf)
s3=
??s3。此处的求和变量n不能省略。
x/(x-1)~2
s4=symsum(n2,1,100)
s4=
338350
??4。计算有限级数的和
6.4.2 画数的泰勒级数
泰勒(Taylor)级数可以将一个任意函数表示为一个幂级数，并且，在许多情况下，只需要取幂
级数的前有限项对于大多数工程应用问题已经足够。在高等数学中讨论了怎样将一个任意(当
然也应该满足泰勒条件)的函数在某点x。附近表示为幂级数的方法，MATLAB中提供了将函数
展开为幂级数的函数taylor,其调用格式为：
taylor(f,v,n,a)
该函数将函数f按变量v展开为泰勒级数，展开到第 n项(即变量v的n-1次幂)为止，n
的缺省值为6。》的缺省值与diff 函数相同。参数a指定将函数f在自变量v=a处展开，a的缺
省值是0。
例6.23 求下列函数在指定点的泰勒展开式。
(1)1±x+,展开到含 x?的项。
(2)√1-2x+x3-√1-3x+x2,展开到含x?的项。
命令如下：
x=sym('x');
fl=(I+x+x2)/(1-x+x^2);
2=sgt(1-2*x+x^3)-(1-3*x+x^2)(1/3);
laylor(fl,x,5) ??(1)。展开到x的4次幂时应选择n=5
ans =
1+2*x+2*x^2-2*x4
taylor(2,6) ??(2)。
Ans =
1/6*x^2+x^3+119/72*x4+239/72*x^5
例6.24 将下列多项式表示成x+1的幂的多项式。
P(x)=1+3x+5x2-2x3
本例即要求在x=-1处将函数P(x)展开到n=4。命令如下：
x=sym('x');
p=1+3*x+5*x^2-2*x3;
f=taylor(p,x,-1,4)
f=
-8-13*x+11*(1+x)~2-2*(1+x)-3
例6.25 应用泰勒公式近似计算V4000。
因为4 000=22-96=22(1-96×2-12)
第6章 MATI.AB符号计算 ·177·
所以
"4000=21-96×2-12
命令如下：
x=sym('x');
[=(1-x)~(1/12);
g=taylor(f,4)
??义函数，4000(1/12)=2f(96/2-12)
??f的泰勒展开式g,有4000(1/12)=2g(96/2^12)
8=
1-1/12*x-11/288*x2-253/10368*x3
b=96/2~12;
a=1-b/12-11/288*b2-253/10368*b~3 ??算g(b) =
0.9980
2*a 呢求4000(I/12)的结果
ans =
1.9961
4000(1/12) ??MATLAB的乘方运算直接计算
ans=
1.9961
用泰勒公式近似计算的结果和直接调用MATLAB函数的计算结果完全一致，说明这种计算
方法是正确的。
读者也许注意到了，本例中在求得了函数f(x)的泰勒展开式g(x)后，没有直接使用g(b)
的语句计算函数g(x)在x=b处的值，而是将函数g重新输入了一次，这样做是很麻烦的，但没
有捷径。符号函数不能像函数文件那样直接计算函数在指定点的值。
6.4.3 函数的傅立叶级数
设函数f(x)和级数
(x)=2+ZTauco(k)+ bain(kx)]
式中
a=1f(x)cos hixdx
=1f(x)sin kxdx
如果级数s(x)收敛于f(x),称s(x)为f(x)的傅立叶级数。从高等数学中知道，一般函数
的傅立叶级数都是收敛的。傅立叶级数在电路分析、自动控制理论及通信分析中有广泛的应用。
但MATLAB5.x版中，尚未提供求函数傅立叶级数的内部函数。下面就设计一个简化的求任意
函数的傅立叶级数的函数文件。
function mfourier= mfourier(f.n)
syms xabc;
mfourier = int(f,-pi,pi)/2; ??算a0
·178· 基 础 篇
for i=1:n
a(i)=int(f* cos(i*x),-pi,pi);
b(i)=int(f* sin(i*x),-pi,pi);
mfourier= mfourier+ a(i)*cos(1*x)+b(i)*sin(i*x);
end
retum
调用该函数时，需给出被展开的符号函数f和展开项数n,不可缺省。
例6.26 在[-π,π]区间展开下列函数为傅立叶级数。
(1)f(x)=x,展开到第5项。
(2)f(x)=lxl,展开到第5项。
(3)f(x)=cos(ax),展开到第6项。
(4)f(x)=sin(bx),展开到第4项。
命令如下：
x=sym('x');a=sym('a');
f=x;
mfourier(f,5) ??f(x)=x的傅立叶级数的前5项
ans =
2×pi*sin(x)-pi* sin(2*x)+2/3*pi*sin(3*x)-1/2*pi*sin(4*x)+2/5*pi*sin(5*x)
C=abe(x);
mfourier(f,5) ??f(x)=1xl的傅立叶级数的前5项
ans =
1/2*pi2-4*cos(x)-4/9*cos(3*x)-4/25*cos(5*x)
syms a;
f=cos(a*x);
mfourier(f,6) ??F(x)=cos(ax)的傅立叶级数的前6项
ans =
sin(pi*a)/a-2/(a-1)/(a+1)*a*sin(pi*a)*cos(x)+2/(a-2)/(a+2)*a*sin(pi+a)*cos(2*x)-
2/(a-3)/(a+3)*a*sin(pi*a)*cos(3*x)+2/(a-4)/(a+4)*a*sin(pi*a)* cos(4*x)-2/(a-5)/
(a+5)*a*sin(pi*a)*cos(5*x)+2/(a-6)/(a+6)*sin(pi*a)*a*cos(6*x)
f=sin(a*x);
mfourier(f,4) ??f(x)=sin(ax)的傅立叶级数的前4项
ans =
-2/(a+1)/(a-1)*sin(pi*a)*sin(x)+4/(a+2)/(a-2)*sin(pi*a)*sin(2*x)-6/(a+3)/(a-3)*
sin(pi*a)*sin(3*x)+8/(a+4)/(a-4)*sin(pi*a)*sin(4*x)
上面定义的函数文件mfourier.m存在两个问题：第一调用参数规定太死，不能缺省；其次，只
能在[-π,π]展开函数f(x),请读者对这个函数文件 mfourier.m进行修改，使其能在一般的
[-1,1]上将f(x)展开为傅立叶级数，并且调用参数更灵活、更方便。
6.5 代数方程的符号求解
所谓代数方程是指未涉及微积分运算的方程。与微分方程相比，代数方程比较简单，但除一
第6章 MATLAB符号计算 ·179·
些特殊形式的代数方程外，要求得一个代数方程的解也并非易事。在第5章，已经讨论了代数方
程的数值求解方法。本节讨论在MATLAB中，怎样求解用符号表达式表示的一般代数方程。
6.5.1 线性方程组的符号求解
第5章已经讨论过，对于形如AX=b的线性方程组，有
X=inv(A)*b或X=A\b
对于数值计算，A,b必须是数值矩阵，不能含有符号量。在下面的讨论中去掉这一限制，允
许矩阵A,b中含有符号量。
MATLAB中提供了一个求解线性代数方程组的函数linsolve,其调用格式为：
insolve(A,b)
该函数返回线性方程组AX =b的解。这里A,b允许是符号矩阵，A必须行满秩(即rank
(A)>=m,m是A的行数)。
例6.27 求线性方程组AX=b的解。
OA=
(2)A-
解方程组(1)的命令如下：
A=[34,8,4:3,34,3;3,6,8];
b=[4;6;2];
X=linsolve(A,b) ??用linsolve函数求(1)的解
X=
[138/2045]
[ 66/409]
[ 212/2045]
A\b ??另一种方法求(1)的解
ans=
0.0675
0.1614
0.1037
上述两种结果本质上相同，但形式不同，因为符号运算将数值结果都用精确值表示，不化为
小数，面数值运算时都有用限小数表示结果。
解方程组(2)的命令如下：
syrns all al2 a13a21 a22 a23 a31 a32 a33 bl b2 b3;
A=[al1,a12,a13;a21,a22,a23;a31,a32,a33];
b=[b1;b2;b3];
X=linsolve(A,b) ??用linsolve函数求(2)的解
XX=A\b ??左除运算求(2)的解
·180· 基 础 篇
读者可以上机运行上述命令，仔细比较会发现，两种方法得到的结果是完全相同的。
6.5.2 昨线性方程组的符号求解
第5章讨论过非线性方程组的数值求解方法。非线性方程组的一般形式是：
F(X)=0
其中X是未知量，是一个含n个元素的列向量，0是含 n个元素的0向量。在5.4节中，要
求向量值函数F(X)中不含符号量，即F函数中不含参数，这在实际工作中是难以做到的。下
面的讨论中，假设F是一个任意的向量值函数。
求解非线性方程组的函数是solve,调用格式为：
solve('eqnl','eqn2',…,' egnN',' varl,var2,…,varN')
该函数求解由参数 eqnl、egn2、…、eqnN所定义的方程组，求解变量由 var1、par2、…、varN等
定义，若不指定求解变量，由缺省规则确定。
当方程右端为0时，方程 egni中可以不包含右端项和等号，而仅列出方程左端的表达式。
例6.28 解下列方程。
(1)x+2+24=1+x22
(2)x-√x3-4x-7=1
(3)2sin(3x-π/4)=1
(4)x+xe2-10=0
命令如下：
x=solve('1/(x+2)+4*x/(x2-4)=1+2/(x-2)',x')??方程(1)
x=
1
f=sym('x-(x3-4*x-7)^(1/3)=1');
x=solve(f) ??方程(2)
X
3
x=solve('2×sin(3*x-pi/4)=1') ??方程(3)
X=
5/36*pi
x=solve('x+x*exp(x)-10','x') ??方程(4)。仅标出方程的左端
x=
1.6335061701558463841931651789789
用函数solve求解方程时，常常会发生遗根的情况，分析一下上面的输出结果，就会发现例题
解答中给出的根不完整，有遗漏。对于无任何特征的一般方程组，要保证逐一求找出其全部根，
是一个非常困难的问题，人们期待后续的MATLAB版本会弥补现在留给用户的这一缺陷。
例6.29 求下列方程组的解。
(2){+5=2
第6章 MATLAB符号计算 ·181·
(3){2=298 4{2-35-2y2=0
命令如下：
[xy]=solve('1/x^3+1/y^3=28','I/x+1/y=4','x,y')??方程组(1)
x=
[ 1]
[1/3]
y=
[1/3]
[ 1]
[x y]=solve('x+y-98','x^(1/3)+y'(1/3)-2','x,y') ??方程组(2)
Warning:Explicit solution could not be found.
> InC:MATLABR11\ toolbox \symbolic \solve.m at line 136
x=
[empty sym ]
y=
[]
对方程组(2)MATLAB给出了无解的结论，显然错误，下面看完全与其同构的方程组(3)。输
入命令如下：
[u,v]=solve('u"3+v3-98','u+v-2’,'u,v') ??方程组(3)
u=
[5]
[-3]
V=
{-3]
[ 5]
[xv]=solve('×2+y2-5°,2××2-3*x*y-2*y2')??方程组(4)
X=
[-1]
[1]
[2]
[-2]
v=
[ 2]
[-2]
[ 1]
[-1]
通过上面的例子，读者应该对MATLAB求解方程组的强大能力有所了解，同时对其不足也有
认识。在以后遇到方程组求解问题时，应充分发挥MATLAB的功能，但当由MATLAB给出无解或
未找到所期望的解时，不要认为原方程组就真正无解了，还需要用其他方法试探着求解。如果知
道方程组在某点附近有解，不妨用方程组的数值求解函数 fsolve试探求解，一般能找到所期望的
·182· 基 础 篇
解。总之，方程组求解是一个古老而又困难的问题，MATLAB给人们提供了一种虽然不是万能但
往往非常有效的求解手段。
6.6 常微分方程的符号求解
第5章讨论了常微分方程的数值求解函数ode23和ode45。数值求解只能给出方程的数值
解，与读者在微分方程课程中所学习的求解方法和解的结果还不相同。MATIAB能否对常微分
方程提供连续的符号解呢?这就是本节要讨论的问题。MATLAB的符号运算工具箱中提供了功
能强大的求解常微分方程的函数 dsolve,在介绍dsolve的用法之前，先简要说明在函数dsolve中
怎样表示微分运算。
MATLAB中表示微分方程时，用大写的字母D表示导数。例如，Dy表示y',D2y表示 y"。
Dy(0)=5表示y'(0)=5。D3y+D2y+ Dy-x+5=0表示微分方程y"+y"+y'-x+5=0。
有了上面的介绍后，就可以介绍dsolve函数的用法了。该函数的调用格式为：
dolve(' eqn1',' condition',' var')
该函数求解微分方程eqnl在初值条件condition下的特解。参数 var 描述方程中的自变量符
号，省略时按缺省原则处理，若没有给出初值条件condition,则求方程的通解。
dsolve在求解微分方程组时的调用格式为：
dsolve(' egnl*,'eqm2*,…,'eqnN,'conditionl',…,' conditionN','varl',…,' varN')
函数求解微分方程组eqn}、…、egnN在初值条件conditoion1、…、conditionN下的解，若不给出
初值条件，则求方程组的通解。varl、…、varN给出求解变量。
6.6.1 求常微分方程的通斛
在调用dsolve 函数时，若不写condition 参数就可求常微分方程的通解。
例6.30 求下列微分方程的通解。
(1)dx=22
(2)x2adx+2xy=e
(3)&
命令如下：
y=dsolve('Dy-(x2+y2)/x2/2','x')
y=
??(1)。方程的右端为0时可以不写
x*(-log(x)+2+Cl)/(-log(x)+C1)
y=dsolve(' Dy*x2+2*x*y-exp(x)°,'x')??(2)
y=
1/x2*exp(x)+1/x2*C1
y=dsolve(' Dy-x/y/sqt(1-x2)',x') ??(3)
第6章 MATLAB符号计算 ·183·
v=
[(-2*(-(x-1)*(x+1))(1/2)+C1)(1/2)」
[-(-2*(-(x-1)*(x+1))-(1/2)+C1)(1/2)
6.6.2 求常微分方程的特解
求解常微分方程特解时，只要将初值条件代入函数dsolve的condition 参数中即可。
例6.31 求微分方程的特解。
(1)d=2x2,y(0)=1
(2)d2,y(2)=1
命令如下：
y=dsolve(' Dy=2*x*y2','y(0)=1','x')??(1)
Y=
-1/(x^2-1)
y=dsolve('Dy-x2/(I+y2),y(2)=1.x')吸解(2)
y=
(1/2×(4*x3-16+4*(20+x6-8*x3)(1/2)(1/3)-2/(4*x^3-16+4*(20+x6-8*x3)~(1/2))
(1/3)
[-1/4*(4*x~3-16+4*(20+x6-8*x3)^(1/2))^(1/3)+1/(4*x^3-16+4*(20+x6-8*x^3)-(1/2))
~(1/3)+i*(-1/4*(4××3-16+4*(20+x'6-8*x^3)(1/2))~(1/3)-1/(4*x^3-16+4*(20+x6-8*
x^3)^(1/2))~(1/3))*3(1/2)]
[-1/4*(4*x~3-16+4*(20+x6-8×x^3)^(1/2))(1/3)+1/(4*×3-16+4*(20+x6-8*x^3)(1/2))
(1/3)+i*(1/4×(4*x^3-16+4*(20+x6-8*×3)(1/2))-(1/3)+1/(4*x^3-16+4*(20+x6-8*x^
3)-(1/2))~(1/3))*3(1/2)]
这里给出的解很冗长。如果读者熟悉微分方程的解法，可以很快求得方程(2)的用隐式函数
表示的解
y3-x3+3y+4=0
求解这个三次方程，解出y,得到与MATLAB一致的3个解。
例6.32 用微分方程的数值解法和符号解法解下列方程，并对结果进行比较。
xdx+2y=4x2,y(1)=2
在MATLAB命令窗口，输入命令：
y=dsolve(' Dy+2*y/x-4*x','y(1)=2',x') ??符号方法得到方程的解析解
y=
x^2+1/x2
为了求方程的数值解，需要按要求建立一个函数文件fxyy.m:
function f=fxyy(x,y)
f=(4*x2-2*y)/x; ?能是y'=f(x,y)的形式，当不是这种形式时，要变形。
rctum
输入命令：
·184· 基 础 篇
[t,w]=ode45(' fxyy',[1,2],2);呢得到区间[1,2]中的数值解，以向量t、w存储。
为了对两种结果进行比较，在同一个坐标系中作出两种结果的图形。输入命令：
x=linspacc(1,2,100);
??作图把符号解的结果离散化 y=x.2+1./x.2;
plot(x,y.'b.',t,w.'r-');
符号解图形用兰色圆点表示，数值解图形用红色实线表示。结果如图6.1所示。可以看出，
两种结果的图形是完全一致的，这也说明了数值解法有足够的精确度。
4.5
4
35
3
2.5
2
11 12 1.3 14 151.6 1718192
图6.1 数值解和符号解比较
6.6.3 常微分方程组求解
在一个问题中如有几个未知函数，因而需要由几个微分方程进行约束，这样的方程组称为微
分方程组。例如
有两个未知函数f(x)、g(x),由两个方程共同约束，这两个方程组成一个微分方程组。dsolve函
数的第2种格式就是专门用来求解微分方程组的。
例6.33 求下列微分方程组的解。
命令如下：
第6章 MATLAB符号计算 ·185·
[x,y!=dsolve('Dx=4*x-2*y','Dy=2*x-y','t')??方程组(1)
x=
-1/3*C1+4/3×Cl*exp(3*t)-2/3×C2*exp(3*t)+2/3*C2
y=
2/3*Cl*exp(3*t)-2/3×C1+4/3*C2-1/3*C2*exp(3*1)
x,yi=dsolve('D2x-y','D2y+x','t') ??方程组(2)
因为第(2)题的结果非常冗长，所以书中未予列出。许多情况下若用隐函数表示微分方程的
结果会比显式方法简洁，但在MATLAB中，dsolve 函数一律使用显式方式表示结果，这也是符号
方法求解微分方程的一个特点。
符号运算功能强大，是MATLAB的一个特色。对于许多工程计算问题，MATLAB中既提供了
数值计算方法，也提供了符号计算方法，这两者各有用途：数值计算方法的主要特征是“可行性”,
但不能给出解析解；符号方法能给出解析解，但结果一般较复杂、冗长，且对问题的选择性强，很
多问题(特别是求解微分方程的问题)无法用符号方法求解。读者应根据问题灵活选择解决方
案。…-般情况下，符号方法使用要方便一些。
习 题 六
1.分解因式。
(1)x?-1 (2)x?+x3+2x2+x+1
(3)125x?+75x?+15x2+1 (4)x2+y2+z2+2(zy+yz+x)
2.化简表达式。
(1)*+ (2)√+225+-22-6
(3)2cos2x-sin2x (4)√3+2√2
3.求函数的极限。
(1)m-6x+4 (2).
(3)mI+x2-1 (4)im(x+÷)
4.求函数的符号导数。
(1)y=3x2-5x+1,求y'y°。 (2)y=√x+√x+√x,求yy。
(3)y=sinx-,求yy。 x。 (4)z=x+y-√x2+y2,求
5.求不定积分。
(1)?x+。 (2)[VI-3xdx
4) (3)
6.用数值与符号两种方法求给定函数的定积分，并对结果进行比较。
(1)fx(2-x2)2de (2)f*d
·186· 基 础 篇
(3)?(xsin t)2dx (4)?{ 1hx dx
7.求下列级数之和。
(1)1-2+4-8+… (2)x+3+亏+等+…
(3)1+9+1+4+…
(4)×2×3+2×3×4+3×4×5+4×5×6+…
8.求函数在x=x。的泰勒展开式。
(1)y=x?-5x3+x2-3x+4,a=4
(2)y=2,x=0,n=5
(3)y= tan x,xo= 2,n=3
(4)y= sin2x,x=0,n=8
(5)y=√x3+x2+5x+3,x=0,n=5
9.求函数的傅立叶展开式。
(1))=2a3(-π≤a≤π),n=5
(2)y=e?3+x(-π≤X≤π),n=5
10.求微分方程初值问题的符号解，并与数值解进行比较.
xv°+(1-n)y'+y=0
y(0)=v(0)=0
1Ⅱ.求非线性方程的符号解。
(1)ax2+bx+c=0
(2) 2sin(3x+4)=1
(3)sin x-√3c08x=√2
(4)x2+10(x-1)√x+14x+1=0
12.求非线性方程组的符号解。
第7章 MATLAB图形用户界面设计
所谓图形用户界面(Graphical User Interface,简称GUI)是指由窗口、菜单、对话框等各种图形
元素组成的用户界面。在这种用户界面下，用户的操作既形象生动，又方便灵活，所以在人机交
互方式中占据主导地位。诚然，如果所解决的问题输人输出比较单一，那么一般不会考虑图形用
户界面的设计，但如果要开发一个通用软件，那么采用图形用户界面是人机交互方式的最佳选
择。
MATLAB图形用户界面的设计是通过图形窗口、用户菜单、用户控件等图形对象的操作来实
现的，在第4章已经介绍了图形窗口、坐标轴等图形对象的操作，这些内容是本章学习的基础，务
必仔细阅读并掌握。本章重点介绍如何通过用户菜单对象来建立自己的菜单系统、如何通过用
户控件对象来建立对话框，最后介绍MATLAB提供的用户界面设计工具。
7.1 菜 单 设 计
菜单是一种十分重要的用户界面，也是软件的一种重要操作方式，现代软件大都具有十分友
好的菜单系统。从图4.26图形对象的树形结构可知，MATLAB用户菜单对象是图形窗口的子对
象，所以菜单设计总在某一个图形窗口中进行。MATLAB的各个图形窗口有自已的菜单栏，包括
File、Edit、Tools、Windows和Help共5个菜单项。为了建立用户自己的菜单系统，可以先将图形窗
口的MeruBar属性设置为none,以取消图形窗口缺省的菜单，然后再建立用户自己的菜单。
7.1.1 用户莱单的建立
用户菜单通常包括一级菜单(菜单条)和二级菜单，有时根据需要还可以往下建立子菜单(三
级菜单等),每一级菜单又包括若干菜单项。要建立用户菜单可用uimenu 函数，因其调用方法不
同，该函数可以用于建立一级菜单项和子菜单项。
建立一级菜单项的函数调用形式为：
一级菜单项句柄=uimenu(图形窗口句柄，属性名1,属性值1,属性名2,属性值2,…)
建立子菜单项的函数调用形式为：
子菜单项句柄=uimenu(一级菜单项句柄，属性名1,属性值1,属性名2,属性值2,…)
这两种调用形式的区别在于：建立一级菜单项时，要给出图形窗口的句柄值。如果省略了这
个句柄值，MATLAB就在当前图形窗口中建立这个菜单项。如果此时不存在活动图形窗口，
MATLAB会自动打开一个图形窗口，并将该菜单项作为它的菜单对象。在建立子菜单项时，必须
指定一级菜单项对应的句柄值。例如
hm=uimenu(gcf,' Label',' file');
hml=uimenu(hm,' Label','Save');
·190· 应 用 篇
hm2=uimenu(hm.'Label'.Save As');
将在当前图形窗口菜单条中建立名为File的菜单项。其中，labe!属性值 File就是菜单项的名
字，hm是File菜单项的句柄值，供定义该菜单项的子菜单之用。后两条命令将在File菜单项下
建立Save和 Save As两个子菜单项。
7.1.2 莱单对象常用属性
菜单对象具有Children、Parent、Tag、Type、UserData、Visible等公共属性，它们的含义请阅读4.5
节有关内容。除公共属性外，还有一些常用的特殊属性。
(1)Label属性。该属性的取值是字符串，用于定义菜单项的名字。可以在字符串中加入&
字符，这时在该菜单项名字上，跟随&字符后的字符有一条下划线，&字符本身不出现在菜单项
中。对于这种有带下划线字符的菜单，可以用Alt键加该字符键来激活相应的菜单项。
(2)Accelerator属性。该属性的取值可以是任何字母，用于定义菜单项的快捷键。如取字母
W,则表示定义快捷键为Ctrl+W。
(3)Callback 属性。该属性的取值是字符串，可以是某个M文件名或一组MATLAB命令。在
该菜单项被选中以后，MATLAB将自动地调用此回调函数来作出对相应菜单项的响应，如果没有
设置一个合适的回调函数，则此菜单项也将失去其应有的意义。
在产生子菜单时Callback 选项也可以省略，因为这时可以直接打开下一级菜单，而不是侧重
于对某一函数进行响应。
(4)Checked属性。该属性的取值是on或off(缺省值),该属性为菜单项定义一个指示标记，
可以用这个特性指明菜单项是否已选中。
(5)Enable 属性。该属性的取值是on(缺省值)或off,这个属性控制菜单项的可选择性。如
果它的值是off,则此时不能使用该菜单。此时，该菜单项呈灰色。
(6)Position属性。该属性的取值是数值，它定义一级菜单项在菜单条上的相对位置或子菜
单项在菜单组内的相对位置。例如，对于一级菜单项，若Position 属性值为1,则表示该菜单项位
于图形窗口菜单条的可用位置的最左端。
(7)Separator属性。该属性的取值是on或off(缺省值)。如果该属性值为on,则在该菜单项
上方添加一条分隔线，可以用分隔线将各菜单项按功能分开。
例7.1 建立图7.1所示的“图形演示系统”菜单。菜单条中含有3个菜单项：Plot、Oplion和
Quit。Plot中有Sine Wave和Cosine Wave两个子菜单项，分别控制在本图形窗口画出正弦和余弦
曲线。Option菜单项的内容如图7.1所示。其中 Grid on和Grid off控制给坐标轴加网格线，Box
on和 Box off控制给坐标轴加边框，而且这4项只有在画有曲线时才是可选的。Figure Color 控制
图形窗口背景颜色。Quit控制是否退出系统。
程序如下：
screen= get(0.'ScreenSize');
W=screen(3);H=screen(4);
figure('Color',[1,1,1],Position'.[0.2*H,0.2×H,0.6*W,0.4*H]...
'Name'.图形演示系统. Numberfitle',of?,'MenuBar'.' none');
??义 Piot菜单项
hplot= wmenu(gef,' Label','&Plot');
第7章 MATLAB图形用户界面设计 191
aimenu(Lplat,' Lalel+,Sime Wave, Call.=-pi:pi/20:piploat(t,sin(t):.
*sel(hgon."Enable".on");'sel(hgolf,"Erable""om"):'.
'set(hbos."Enuble"。""):'set(hbsaif,"Enabho","on"):3:
imemu(bpla,' Label.Coine Wavet.'Call',-:pi/20:pipl1c9):
sel(hpon,"Enable","on"):,al(hgulf,* Eoable"")x',
aet(hboo,"Enable","am"):'et(bboff,"Enuble","u"):7):
强定义Optiom菜单项
hoption=uinenu(nf.'Label.&Optun):
hgon=uimenu(hoptiom. Label&Grig o'.Cll pid onEnable'B:
bg=l* aimens(bogtioe,*Ldbd+AGig offGa* gil of*+'Eoatie空
dun=wimenu(hoptiom,'label*,&Box m separalrm,Calt'bor on*.Enabe.):
hboff=uimenu( hoption.'Label',&Ros .Call'.'box af','Enable?研'):
hfigcore uimenu(hoption.Labe',&Figure Calart.Separasor'.'on+):
uiniena(higcor,'Labl.&Rd.Accelerator''Callet(gef,"Colar""+"):):
uimens(higoot,"labd',&Bue'.Aceeleraior'b.Calt''t(gef,"Coler"b")::
uimera(bfigour,' label,&Yellow'.CaH.seil yd,"Colon","y"):*;
aium(bigsor,'labe&Wite!.Call*set(gof,"Colar""w"):t);
保定文Qit菜单项
cimenu(gef,'Lahel*,&QuitGa+,' dose(gpe);
程序运行后可以建立图7.1所示的菜单。
翻形深示系统 F回区
t tim Qut
t
ig ff
Lot o aof
UcroColr 2 Cu1+
n C任
Z11
0.5 Mhte
2 -1 0 34
图7.1“图形演示系统”莱单
7.1.3 快徒菜单
快捷菜单是用鼠标右键单击某对象时在屏幕上弹出的菜单。这种菜单出现的位置是不固定
的，面且总是和某个图形对象相联系。在MATLAB中，可以使用wicontextmenu 函数和图形对象的
UIConteaMenu 属性来建立快捷菜单，具体步骤为：
·192 应 用 篇
(1)利用uicontextmenu 函数建立快捷菜单。
(2)利用uimenu 函数为快捷菜单建立菜单项。
(3)利用set函数将该快捷菜单和某图形对象联系起来。
例7.2 绘制曲线y=2e-0.S*sin(2πx),并建立一个与之相联系的快捷菜单，用以控制曲线
的线型和曲线宽度。
程序如下：
x=0:pi/100:2*pi;
y=2*exp(-0.5*x).*sin(2*pi*x);
hl= plot(x,y);
hc=uicontextmeru; ??立快捷菜单
his=uimcnu(he,'Label',线型'); ??立菜单项
hlw=uimenu(hc,' Label','线宽');
uimenu(his,' Label',虚线','Call','set(hl,"LineStyle",":");');
uimenu(hls,'Label','实线’,Cal}',' set(hl,"LineStyle","-");');
uimenu(hlw,'Label','加宽',Call','set(h,"LineWidth",2);');
uimenu(hlw,' Label',变细','Call','set(h,"LineWidth",0.5);');
set(hl,'UIContextMenu',he); ??该快捷菜单和曲线对象联系起来
程序运行后先按缺省参数(0.5磅实线)画线，若将鼠标指针指向线条并单击右键，则弹出快
捷菜单(如图7.2所示),选择菜单命令可改变线型和曲线宽度。
2
15
0.5
0
-05
-1
-150 1 2 3 4 5 6 7
图7.2 快捷菜单设计
第7章 MATLAB图形用户界面设计 ·193·
7.2 对话框设计
对话框是用户与计算机进行信息交流的临时窗口，在现代软件中有着广泛的应用。在软件
设计时，借助于对话框可以更好地满足用户操作需要，使用户操作更加方便灵活。
7.2.1 对话框的控件
在对话框上有各种各样的控件，利用这些控件可以实现有关控制。下面先介绍这些控件。
(1)按钮(Push Button)。按钮是对话框中最常用的控件对象，其特征是在矩形框上加上文字
说明。一个按钮代表一种操作，所以有时也称命令按钮。
(2)双位按钮(Toggle Button)。在矩形框上加上文字说明。这种按钮有2个状态，即按下状
态和弹起状态。每单击一次其状态将改变一次。
(3)单选按钮(Radio Button)。单选按钮是一个圆圈加上文字说明。它是一种选择性按钮，
当被选中时，圆圈的中心有一个实心的黑点，否则圆圈为空白。在一组单选按钮中，通常只能有
一个被选中，如果选中了其中一个，则原来被选中的就不再处于被选中状态，这就像收音机一次
只能选中一个电台一样，故称作单选按钮。在有些文献中，也称作无线电按钮或收音机按钮。
(4)复选框(Check Box)。复选框是一个小方框加上文字说明。它的作用和单选按钮相似，
也是一组选择项，被选中的项其小方框中有√。与单选按钮不同的是，复选框一次可以选择多
项。这也是“复选框”名字的由来。有些文献中也称作检测框。
(5)列表框(List Box)。列表框列出可供选择的一些选项，当选项很多而列表框装不下时，可
使用列表框右端的滚动条进行选择。
(6)弹出框(Popup Menu)。弹出框平时只显示当前选项，单击其右端的向下箭头即弹出一个
列表框，列出全部选项。其作用与列表框类似。
(7)编辑框(Edit Box)。编辑框可供用户输入数据用。在编辑框内可提供缺省的输入值，随
后用户可以进行修改。
(8)滑动条(Slider)。滑动条可以用图示的方式输入指定范围内的一个数量值。用户可以移
动滑动条中间的游标来改变它对应的参数。
(9)静态文本(Static Text)。静态文本是在对话框中显示的说明性文字，一般用来给用户作
必要的提示。因用户不能在程序执行过程中改变文字说明，故将其称为静态文本。
(10)边框(Frame)。边框主要用于修饰用户界面，使用户界面更友好。可以用边框在图形
窗口中圈出一块区域，而将某些控件对象组织在这块区域中。
7.2.2 对话旭的设计
在MATLAB中，要设计一个对话框，首先要建立一个图形窗口，然后在图形窗口中放置有关
的用户控件对象。
1.建立控件对象
MATLAB提供了用于建立控件对象的函数uicontrol,其调用格式为：
·194· 应 用 篇
对象句柄=uicontrol(图形窗口句柄，属性名1,属性值1,属性名2.属性值2,…)
其中各个属性名及可取的值和前面介绍的 uimenu 函数相似，但也不尽相同，下面将介绍一些常
用的属性。
2.控件对象的属性
MATLAB的10种控件对象使用相同的属性类型，但是这些属性对于不同类型的控件对象，
其含义不尽相同。除Children、Parent、Tag、Type、UserData、Visible等公共属性外，还有一些常用的
特殊属性。
(1)Position 属性。该属性的取值是一个由4个元素构成的向量，其形式为[nT,n2,n3,n4]。
这个向量定义了控件对象在屏幕上的位置和大小，其中n1和n2分别为控件对象左下角相对于
图形窗口的横纵坐标值，n3和n4分别为控件对象的宽度和高度。它们的单位由Units属性决
定。
(2)Units属性。该属性的取值可以是pixel(像素，为缺省值)、normalized(相对单位)、inches
(英寸)、ccntimcters(厘米)或points(磅)。除了normalized 以外，其他单位都是绝对度量单位。所
有单位的度量都是从图形窗口的左下角处开始，在相对单位下，图形窗口的左下角对应为(0,0),
而右上角对应为(1.0,1.0)。该属性将影响 切定义大小的属性项，如前面的Position 属性。
(3)Callback 属性。该属性的取值是字符串。和uimenu 函数一样，Callback 属性允许用户建
立起在对话框控件对象被选中后的响应命令。
(4)String属性。该属性的取值是字符串。它定义控件对象的说明文字，如按钮上的说明文
字以及单选按钮或复选按钮后面的说明文字等。
(5)Style属性。该属性的取值可以是push(按钮，缺省值)、toggle(双位按钮)、radio(单选按
钮)、check(复选框)、list(列表框)、popup(弹出框)、edit(编辑框)、text(静态文本)、slider(滑动条)和
frame(边框)。这个属性定义控件对象的类型。
(6)BackgroundColor属性。该属性的取值是代表某种颜色的字符或RGB三元组。它定义控
件对象区域的背景色，它的缺省颜色是浅灰色。
(7)ForegroundColor属性。该属性的取值与BackgroundColor属性相同。ForegroundColor 属性
定义控件对象说明文字的颜色，其缺省颜色是黑色。
(8)Max、Min属性。Max和Min属性的取值都是数值，其缺省值分别是1和0。这两个属性
值对于不同的控件对象类型，其意义是不同的。以下分别予以介绍：
当单选按钮被激活时，它的Value属性值为Max 属性定义的值。当单选按钮处于非激活状
态时，它的Value属性值为Min属性定义的值。
当复选框被激活时，它的Value属性值为Max属性定义的值。当复选框处于非激活状态时，
它的Value属性值为Min属性定义的值。
对于滑动条对象，Max属性值必须比Min属性值大，Max定义滑动条的最大值，Min定义滑动
条的最小值。
对于编辑框，如果Max-Min>1,那么对应的编辑框接受多行字符输入。如果Max-Min≤1,
那么编辑框仅接收单行字符输入。
对于列表框，如果Max-Min>1,那么在列表框中允许多项选择；如果Max-Min≤1,那么在
列表框中只允许单项选择。
第7章 MATLAB图形用户界而设计 ·195·
另外，边框、弹出框和静态文本等控件对象不使用Max和Min属性。
(9)Value属性。该属性的取值可以是向量值，也可以是数值。它的含义依赖于控件对象的
类型。对于单选按钮和复选框，当它们处于激活状态时，Value属性值由Max属性值定义，反之由
Min属性定义。对于弹出框，Value属性值是被选项的序号，所以由Value的值，可知弹出框的选
项。同样，对于列表框，Value属性值定义了列表框中高亮度选项的序号。对于滑动条对象，Val ue属性值处于Min与Max属性值之间，由滑动条标尺位置对应的值定义。其他的控件对象不使
用这个属性值。
(10)FontAngle属性。该属性的取值是normalized(缺省值)、italic和oblique。这个属性值定
义控件对象标题等的字体。其值为normalizod时，选用系统缺省的正字体，而其值为italic 或
oblique时，使用方头斜字体。
(11)FontName 属性。该属性的取值是控件对象标题等使用字体的字库名，必须是系统支持
的各种字库。缺省字库是系统的缺省字库。
(12)FontSize属性。该属性的取值是数值，它定义控件对象标题等字体的字号。字号单位
由FontUnits属性值定义。缺省值与系统有关。
(13)FontUnits属性。该属性的取值是points(磅，缺省值)、normalizedized(相对单位)、inches
(英寸)、centimeters(厘米)或pixels(像素),该属性定义字号单位。相对单位将FontSize属性值解
释为控件对象图标高度百分比，其他单位都是绝对单位。
(14)FontWeight属性。该属性的取值是normalized(缺省值)、light、demi或bold,它定义字体的
粗细。
(15)HorizontalAlignment属性。该属性的取值是left、center(缺省值)或 right。用来决定控件
对象说明文字在水平方向上的对齐方式，即说明文字在控件对象图标上居左(left)、居中(center)、
居右(right)。
3.建立控件对象示例
(1)建立按钮对象，当单击该按钮时绘制出正弦曲线。同时建立双位按钮，用于控制是否给
坐标加网格线。
pbstart=uicontrol( gcf,'Style',' push',' Position',..
[20,20,100,25],'Sring','Start Plot',...
CallBack'.'t=-pi:pi/20:pi;plot(t,sin(t))');
ptgrid= uicontrol(gcf,'Style',' toggle','Position',...
[150,20,100,25],'String','Gid','CallBack','grid');
Style 属性值push指明该控件对象是按钮，toggle指明该控件对象是双位按钮，Position指示
建立的按钮对象在当前的图形窗口中的位置及大小，String的属性值就是对象上的说明文字，
CallBack 属性定义了当用户单击该按钮对象时应执行的操作。
(2)建立单选按钮，用来设置图形窗口的颜色，只能选择一种颜色。
hxt= uicontrol(gef,'Style',' text'.'String'....
·Color Options*.'Position',(200,130,150,20j);
??立单选按钮
hr= uicontrol(gcf,'Style!,'radio',' String'....
'Red','Pusition',[200,100,150.25],Value',1,..
·196· 应 用 篇
CallBack',['set(hr,"Value",1);','set(hb,"Value",0):',...
'set(hy,"Value",0);',' set(gef," Color","R")J);
hbz uicontrol(gcf,'Style',' radio3,'Siring'....
'Blue',' Position',[200,75,150,25]...
CallBack'.['set(hb,"Value",1),,' set(hur,"Value",0);'.
'set(hy,"Value",0);','set(gef,"Color",“B")?);
hy= uicuntroi(gef,'Styie',' radio','String',...
'Yellow',' Position'.[200,50.150,25],...
'CallBack',['set( hy,"Value",1),,' set(hr,"Value",0);'....
'set(hb,"Value",0);','set(gef,"Color","Y")]);
Callback 执行的结果保证只有一个单选按钮的状态为on,因为单选按钮的Value属性是这样
定义的：如果单选按钮的状态是on,那么属性Value的值是单选按钮的另一个属性Max的属性
值，该属性值的缺省值是1;如果状态是off,那么属性Value的值是单选按钮的另一个属性Min的
属性值，它的缺省值是0。这样，通过对属性Value设定不同的值，就可以得到单选按钮的不同状
态。
(3)建立复选框，用于设置图形窗口的某些属性，如大小、颜色、标题等。
htxt=wicontrol(gef,'Style',' text','Position',[.1,.5,.25,1]...
'Units','normalized','String','Set Windows Properties');
bp= uicontrol(gef,'Style,' chcck',' Position',...
[.1,.4,25..1],'Units','bormalized',String','MyPosition',...
'CallBack',[' set(gcf," Position",[10,10,300,250]);‘,...
'if get(bp,"Value")==1,',...
'set(gcf," Position",[10,10,600,500]),,'end']);
hc= uicontrol(gef,'Style','check', Position',..
[.1,3,25,1],'Units','nonmalized',' Suing','MyColor',...
CallBack',[' set(gef," color","w");....
'if get(he,"Value")==1,','set(gef," color","g"),,'end']);
hn= uicontrol( gcf,'Style',' check',' Position*,...
[.1,2,.25,.1],' Units','normalized,'String'.MyName',...
'CallBack',['set(gcf,"Name","复选框未选中");*....
'if get(hn,"Value“)==1,,
'set(gcf,"Name","复选框被选中"),','end'});
(4)建立弹出框，其列表中包含一组可供选择的颜色。当选择某种颜色时，就将图形窗口的
背景色设置为该颜色。
弹出框可选项在String属性中设置，每项之间用竖线字符“I”隔开，并用单撇号将所有的选
项括起来。Value属性的值是弹出式列表中选项的序号。例如，如果用户选列表中的第2项，那
么Value的属性值就是2。
bpop=uicontrol(gef,'Style','popup'.'Sring'..
'red!bluel greenl yellw',' Position',[100,100,100,80],...
'CallBack',['cbcol=["R","B","G","Y"];‘....
' set(gcf,"Color",cbcol(get(hpop,"Value")))]);
(5)建立列表框，其作用与(4)同。
第7章 MATLAB图形用户界面设计 ·197·
hl= uicontrol( gef,'Style'.' list',...
'String',' redl bluel greenl yellowl whitel back',...
Position',[100,100,100,80],'Callback'...
[' cbcol={"r","b","g","y","w","k"];',...
'set( gef,"color",cbcol(get(hl," value"))):']);
(6)建立一个编辑框，并加边框。
当需要用边框组织控件对象时，必须在定义控件对象之前建立边框对象，或者说边框对象必
须覆盖该组中所有的控件对象。为了留出边框的边界，边框对象所占用的区域至少要比该组中
所有控件对象占用的区域大。
编辑框分多行编辑框与单行编辑框。属性 Max与属性 Min之差小于或等于1时，为单行编
辑框，否则为多行编辑框。
ftdir= uicontrol( gcf,' Style',' frame',...
' back','y!,' Position',[30,180,120.100]);
edmuli= uicontrol(gcf,' Style','edit',...
'String','MATLAB is a very useful language.',..
Position',[50,200,75,55],'Max',2,'back','w');
在下列操作之后，MATLAB将执行编辑框对象Callback 属性定义的操作：
①改变编辑框中的输人值，并将鼠标移出编辑框控件对象。
②对单行编辑框，按下回车键，而不论编辑框中的值是否被改变。
③对单行和多行编辑框对象，按住Ctrl键，再按回车键，面不论编辑框中的值是否被改变。
在多行编辑框中，按下回车键，可以输入下一行字符。
(7)建立两个滑动条，分别用于设置图形窗口的宽度和高度，并利用静态文本说明对象，标
出滑动条的数值范围以及当前值。
fig=figure(' Position',[20,20,400,300]);
hslil=uicontrol(ig,'Style','slider',' Position',...
[50,50,120,20],'Min',200,'Max',800,'Value',400,..
·CallBack',['set(azmcur," String",'...
'num2str(get(hslit,"Value")));‘...
'set(gef," Position",[20,20,get(hslil,"Value"),300]);']);
hsli2=uicontrol(fig,' Style','slider','Position',...
[240,50,120,20],'Min',100,'Max',600,'Value',300,...
'CallBack',['set(elvcur,"String",..
' num2str(get(hsli2,"Value")));',...
'set(gef," Position",[20,20,400,get(hsli2,"Value");])·]);
??静态文本标出最小值
azmmin= wicontrol(fig,'Style','text',' Position,...
[20,50,30,20],' String',num2atr(get(hslil,'Min')));
elvmin=uicontrol(fig,'Style',' text','Poition',..
[210,50,30,20],'String',num2str(get(hali2,'Min')));
??静态文本标出最大值
azmmax = uicontrol(fig,' Style','text',' Position',...
198 应 用 箱
[170.50.30,201. Sring',mm2srf(ge(lalil'Ma2)):
elvmax=uicotrul(fig,Style!.' teat.'Position'
[360,50.30,20],*Suring'niam2an( gei(hal2,Mas'));
验用静态文本标出当前设置的宽度和高度
amlabel=wioetol(hg,'Siyle'texPoin
[30,80.65,201,'Sring,Widb9]
ewLsbel= uiontol(fig,"Syle'.ot' Position'
[240.80.65.20],Snng+,Heigha');
azmeur=lioontral(fig,Siyle''test',Position'…
[120,80,50.20].Sring'sumsr(e( hlit.Valhue+))4
dreu=uicontrol(fg.'Style'"text,Paition.
[310,80.50.20].Suring',mm2air(ea(hsl2.Value'))):
例7.3 建立如图7.3所示的数制转换对话框。在左边输入一个十进制整数和2-16之间
的数，单击“转换”按钮能在右边得到十进制数所对应的2-16进制字符串，单击“退出”按钮退出
对话框。
数制利稳 A回国
火题 输出日
十边解原
BC2 2~16 1
奸称 出
图73 数韧转换对话短
程序如下：
=fipan( Calm.[0,1.,1T'Puitin',[100,200,400.200.….
Name',数制转换，NumberTadet,'of.MenuBar?.none'):
uicontrod(hM,'SyleTeat'.Uainscmalirel'
+Puion'.[0.05.0.8.0.45.0.1].Horizntal.teeite..
ISring,输入概，'Back',T0.1.11);
wicontrol(hi,'Stylet.Text'Fitim3,[0.5,0.8,0.45.0.1];
*Umig*,norualized.Horiwotul,cente…
'Suing'。较出框，Back*.[0.1.1]);
wicontrol(h.'Syle,Frame, Peaiikom;[0.04,0.33,0.45,0.45]
Uns.nonalied.Bak*.(1.1.07):
nicontmilM:Syle Tes' 'Psin+,[0.05,0.6.0.25.0.1
Dnismmalized'.Hociostdl',center
第7章 MATLAB图形用户界面设计 ·199·
'String',十进制数',Back',[1.1,0]);
uicuntrol(hf,'Style',' Text','Posilion',[0.05,0.4.0.25,0.1],...
Units'.'normalized',Horizontal',center'....
'String'.'2-16进制',' Back'.[1,1,0]);
hel=uicontrol(hf,'Sryle',' Edit'.' Position',[0.25.0.6.0.2,0.1]..
'Units','normalized','Back.[0.1,0]);
he2=uicontrol(Mf,' Style',' Edit',' Position',[0.25,0.4,0.2,0.1],..
'Units','normalized',' Back',[0.1.0]);
uicontrol(hf,'Style',' Frame',' Position',[0.52,0.33,0.45,0.45j,...
'Units'.'normalized','Back',[1,1.0]);
ht=uicontrol(hf,' Style',' Text'.' Poaition',[0.6,0.5,0.3,0.1],..
'Units','normalized',Horizontal','center','Back',[0,1,0];
COMM=['n=str2num(get(hel,"String"));'.b=str2num(get(he2,"String"));'....
'dec=trdee(n,b);','set(ht,"string",dec);'];
uicontrul(hf,'Style','Push,' Position,[0.18,0.1.0.2.0.12),...
'String','转换','Units','nomalized','Call',COMM);
uicontrol(hf.'Style',' Push', Position'.[0.65.0.1,0.2,0.12....
'String',退出',' Units',' normalized','Call',' close(hf)');
程序调用了trdec.m函数文件，该函数的作用是将任意十进制整数转换为2～16进制字符
串。trdec.m函数文件如下：
function dec=trdee(n,b)
chl='0123456789ABCDEF'; ?六进制的16个符号
k=1;
while n~=0 ??断除某进制基数取余直到商为0
p(k)= rem(n,b);
n=fix(n/b);
k=k+1;
end
k=k-1;
strdec=";
while k>=1 ??成某进制数的字符串
kb=p(k);
strdec= strcat(strdec,chl(kb+1:kb+1));
k=k-1;
end
decxstrdec;
例7.4 建立如图7.4所示的图形演示对话框。在编辑框输入绘图命令，单击“绘图”按钮能
在左边坐标轴得到所对应的图形，弹出框提供色图控制，列表框提供坐标网格线和坐标边框控
制。
程序如下：
cif;
set(gef,'Unit',' normalized',' Position',[0.2,0.3,0.65,0.35]);
·200 应 用 算
etgef.'Menuher',rone,Nane'.图形演示， NumderTitet'):
aves(' Psition'.[0.05.0.15.0.55.0.7]):
aicontrol(gef,Stle',beit',*Unit'.omalized
'B.[0.63,0.85.0.2.0.1],Suing',输人绘图命令，'Harizontal',tcenter');
bodits uicontrol(gd,'Siyle',elit'.'Unt,normalized,tPo,[0.63,0.15.0.2,0.68]..
?x取2.使 Max+Nin>1.从而允许多行输入 +Max,2):
hpspop*uioontol(gef,'Syle''popup'. Unit'.nomulied...
Posi'.[0.85,0:8,0.15,0.15],String.SpingISummerlAutumm(Wiser'):
hlit uicontrnl(gef.*Se?,list,*Umit'normlizd...
Prl+[0.85.0.55,0.15.0.25].Sring',Grid n(Grid I Bos on Bax alf');
topiushl* aicontol(cf:'8tyle''push' 'Unit's'nornalized!
+Pusl,[0.85.0.35.0.15.0.15].Sring.绘图):
aicoatrol( gef,'Siyla+.1pah?,*Onit',' normgliced'
'Pos*,L0.85,0.15,0.15.0.15],'Sring关闭，Cll close sll'h
se(hposhl,Call,COMM(bedit,bpopup.bit):
hel(hlbt.'CallCOMMChedit.bpspup.hi0):
st(bpopup,"CaH.COMM(hedia.hpopup,hia));
COMM.m函数文件：
finction COMM(hedt,hpopup,hlist)
6m=get(hedi,'Suring'):
nl*ge(hpopup,*Vale):
n2=get(hist.Valie'):
if~ismpty(com) 编辑柜输入非空时
殊执行从编辑框输入的命令 ral(com'):
dpop=|apring'.'summer?husnt.'wintr生
chlis=Igid an*,*ghil ilbux on' box of:
culormap(erval(dpoplnl|));
eydl(chia(n21):
end
A开病示
05
0
检人岸阳6
et1150 ps/103
r0
yheyk项
iy
0
压口冈
Soies 口
F国chSex
s
地丽
美淋
11
图7.4 图形潢示对话拖
第7章 MATIAB图形用户界窗设计 +201
7.3 用户界面设计工具
前面介绍了用于用户界面设计的有关函数，为了更方便快捷地进行用户界面设计，MATLAB
提供了用户界面设计工具，利用这些工具使得界面设计过程变得简单和直接，实现“所见即所
得"。MATLAB的用户界面设计工具共有5个它们是：图形界面控制面板，属性编辑器，事件过
程编辑器、菜单编辑器和位置调整工具。下面简要介绍各种工具的使用方法
7.3.1 形界面控制面板
图形界面控制面板是MATLAB用户界面设计工具的集成环境。在MATLAB命令窗口中输人
命令guide或在MATLAB命令窗口 File菜单中选择 Show GUI Layout Tool命令，将启动如图7.5所
示的图形界面控制面板。图形界面控制面板分为车个部分；界面编辑工具栏，受控图形窗口列表
框和控件对象创建工其栏。
海kCt1十组 三园园
l.iiTd:H
aiT
口-厘
d
le
f
Ckrolled 1
F国 HFn
Pe0P
ph loa0 Bo bine
图7.5 图形界面控制面板
第一播是界面编辑工具栏，其中共有属性编辑器、事件过程编辑器，位置调整工其和菜单编
辑器4个工具，要打开某一编辑工具，只需单击相应的按钮即可。
第二排是受控图形窗口列表框，其中列出了当前打开的图形窗口，并显示窗口的受控状态。
相对于图形界面控制面板，所有的图形窗口只有两种状态：受控状态和激活状态。当窗口处干受
控状态时，可以编辑滚口中的所有图形对象。从这个意义上讲，受控状态又可称作编辑状态。激
活状态是通常意义下的状态，当窗口处于激活状态时，用户能够对其进行正常的操作，例如按钮
可以按下，弹出框可以打开等。刚启动图形界面控制面板时，当前图形窗口将自动处于受控状
202 应 用 篇
态。为了使某个图形窗口处于受控状态，只要在图形窗口列表框中单击相应的图形窗口名字，再
单击Apply按钮即可
第三排是控件对象创建工具栏，利用这些工具可以很方便地在图形窗口中添加各种控件对
象和坐标系对象。
7.3.2 属性编桥器
属性编辑器用于对图形对象属性进行操作和管理，其功能与set函数和get 函数相同，但属
性编辑器更容易操作和使用。
启动属性编辑器有3种方法：在MATLAB命令窗口输入 propedit命令或在图形界面控制面板
中启动属性编辑器，还可以在命令窗口 File菜单中选择 Show Graphies Poperty Editor 启动属性
编辑器后，将打开属性编辑器窗口，在该窗口可进行有关编辑操作。例如，下列命令先给制出正
弦曲线并建立一个图形窗口，然后打开属性编辑器：
t=0:0.1:20;
plo(t,ain(10)):
pmpdhit ge);
打开的属性编辑器如图7.6所示。菜单栏下面为图形对象列表框，该列表框下有2个编辑
rqEia EIO因
u u= Twl.u
iau F L
u1meia
n9ot6
1
tKt)
To1s)
hdom) Anlnk
HiyH=adi figbiFaols
Bkqsboe or
困
ctnE
Busyetit But tcnDwaFcn Ch614ten Clipp Cos ReeueestFcD
gueue
15ml doublm】
n
clogeren
F srwreB Hp
swfuipny LMw
图7.6 属性编辆器
框，左边的一个显示属性名，右边的一个显示属性值。只要在其中分别输人属性名和属性值，就
可以修改图形对象的属性。例如，为了将图形窗口的背景颜色改为红色，可以在属性名编辑框输
人属性名 Color(不要单撤号),按回车后，Color属性的缺省值就出现在属性值编辑框，将该缺省值
改为red(带单撤号)或[100],回车后，相应的图形窗口背景颜色就变为红色。这等价于在命令
第7章 MATLAB图形用户界面设计 ·203·
窗口使用set(gef, Colar',I100))命令。
由于图形对象的属性很多，所以在修改图形对象属性时，直接输人属性名是很不方便的。为
了避免这一点，属性编辨器提供了属性列表框。在属性编辑器窗口中，选中 Show Property List复
选框，将打开属性列表框。在属性列表框中列出了被编辑图形对象的全部属性和当前的属性值。
为了编辑某个属性，只要单击相应的属性项，则相应的属性名和属性值就会出现在编辑框中，然
后改变属性值即可。
可以用Show Objeet Browser复选框打开图形对象列表框。在图形对象列表框中会列出当前
图形窗口中的图形对象及其层次关系。只要在图形对象列表框中选择某一图形对象，即可将属
性编辑器窗口对准到该对象，再对其属性进行必要的编辑修改。如果此时属性列表框是打开的，
那么该图形对象的所有属性就在属性列表框中列出。
此外，属性编辑器窗口还具有以下功能：
(1)在属性编辑器中，可以同时选择多个图形对象，甚至可以是不同类型的图形对象。此
时，在属性列表框中只显示所有被选中对象的共有属性，通过设置某个属性的值，所有被选中的
图形对象都将更改为同样的值。
(2)在属性编辑器中，允许输人属性名的前几个字母来代表整个属性名。如在属性名编辑
框输人Col即可以代替Color属性名。
(3)在属性名编辑框中，属性编辑器忽略含有空格的输人。所以如果输人了错误的属性名。
只要按空格再输人正确的属性名即可。
7.3.3 事件过程编辨器
用事件过程编辑器可以编辑修改某个图形对象的 Callback属性值。可以在命令窗口用cbe
dit命令启动事件过程编辑器，也可以从图形界面控制面板启动事件过程编辑器。事件过程编辑
器如图7.7所示。
mC
Tii.GTel
l6(Ifof
0uQron
Shaw Dbkem
Anc
图7.7 事件过程编辑器
H
Des6
·204 应 用 蓝
用事件过程编辑器编辑Callback属性值时，首先要选中Show Ohjeet Broiser复选框，然后选中
想要修改属性的对象，再在属性弹出框中选中相应的属性，接着在编辑框中输入相应的命令代
码，最后单击 Apply 按钮。
7.3.4 兼单编精器
菜单编辑器既可以在某个图形窗口的菜单条上添加菜单项，又可以编辑已定义的菜单项。
有一点要注意，只有图形窗口处于激活状态时，用菜单编辑器添加或修改的菜单项才会出现在图
形窗口的菜单条上。
在命令窗口输人 meruedit 命令或从图形界面控制面板单击菜单编辑器按钮都能启动菜单编
辑器。菜单编辑器如图7.8所示，其使用方法与其他工具相似。
de Nhen d 疆口国
,AE fasl H-Lp
土
1igure an F110 h
V
和n
4
dirrnu isenu
T
(slo01
(6Belp)
gbnuToul
事
L+[ ME6
1[Trdr
inrnpbLE0Ppfl
Aup
NewMm
Htp Ck
F utbettn
图7.8 菜单编辑器
7.3.5 住置调整工具
位置调整工具主要用于对图形对象的几何位置进行调整，使得界面更加关观。使用命令进
行用户界面设计时，需要仔细计算每个图形对象在图形窗口中的位置坐标，且不能直接面对所设
计的界面，因此是非常麻烦的。利用位置调整工具就相当简单。
在命令窗口输人 align命令或从图形界面控制面板单击位置调整工具按钮都能启动位置调
整工具。位置调整工具如图7.9所示，它由对象列表框和调整工其按钮组成。在选择了图形对
象后，就可以用各种工具按钮来移动被选中的图形对象，或调整它与其他图形对象的相对位置。
以上介绍了MATLAB的用户界面设计工具，下面给出一个例子，以说明这些工具的具体运用。
第7章 MAILAB图形班户罪迎设计 205
iT1 回冈
PTsls olj
u1F 口
Aign Diahbwle 5oSpeang
0 por
tori
Cone
T0 nou04kerkcs muat Ditikce4
图7.9 位置藕整工共
例7.5 利用界面设计工其设计图7.10所示的用户界面。其体要求是：
Fere No?1 A口冈
Lile t Tools tindon Mp Qpsions
Yhit
Ind
10 meshz
0
atl
-10 50
coion3
60
20 40 conl团 |z=peak
00
图7.10 科用工具设计用户界面
(1)在编辑框输人形成数据。的命令，然后选择3个按钮中的一个，即可绘制出：的图形
(2)选择弹出框中的某个色图，能及时地更改经图的颜色
·206· 应 用 篇
(3)在图形窗口缺省的菜单条上添加一个菜单项Options,Options下又有两个子菜单项White
和Red,选中White项时，图形窗口将变成白色，选中Red项时，图形窗口将变成红色。
操作步骤如下：
(1)打开图形界面控制面板，添加有关图形对象
在MATLAB命令窗口输人命令guide,将打开图形界面控制面板和一个新的图形窗口，该图
形窗口处于受控状态。单击图形界面控制面板中的axes 按钮，并在图形窗口中拖出一个矩形
框，调整好大小和位置。再添加一个弹出框和一个编辑框，并调整好大小和位置。添加3个按
钮，并调整好大小和位置。必要时可利用位置调整工具将图形对象对齐。
(2)利用属性编辑器，设置图形对象的属性
打开属性编辑器，选中3个按钮，利用属性编辑器把它们的Position属性的第三、第四个分量
设为相同的值，以使3个按钮宽和高都相等。3个按钮的String属性分别是说明文字mesh(z)、
surf(z)和contour3(z)。
为设置弹出框的String属性，先在命令窗口输入命令：
cmap={' hot';'hsv';' gray';' cool';'prism';' winter';'summer';
这里列出了MATLAB提供的几个色图。把弹出框的String属性设为cmap(不用加撇号)。
利用事件过程编辑器，把弹出框的Callback 属性设为：
val=get( gebo,' Value');
str=get(gcbo,' String');
colormap(stz[valf)
其中第一条命令获得弹出框的Value属性值，第二条命令获得弹出框的 String属性值，第三条命
令选择相应的色图。gcbo 获取当前回调对象的句柄(get curent calback object)。
把3个按钮的Callback 属性设置为：
comstr=get( gelo,' String');
edith=findobj(gcbf,' Tag','FditText1');
zstr= get(edith,'String');
eval(zstr);
eval(comstr);
其中第一条命令获得按钮的String 属性值，即绘图命令；第二条命令获得Tag属性值为EditText1
的对象的句柄值，即编辑框的句柄值；第三条命令获得编辑框中的字符串；第四条命令运行编辑
框中的字符串代表的命令；第五条命令运行绘图命令。gcbf 获取当前回调图形窗口的句柄(get
current callback figure)。
(3)添加 Options菜单项
打开菜单编辑器，选中图形窗口对象，并单击New Menu 按钮，把新建菜单项的Label属性设
为Options,再单击Apply 按钮。这样将在图形窗口菜单条土增加一个新的菜单项Options。
接下来在刚建的Options菜单项下建立子菜单项。选中Options,单击New Menu 按钮，把子菜
单项的Label属性设为White,把Callback 属性设为set(gcbf," Color","w")。同理，再为Options建
立一个子菜单项，Label属性和Callback 属性分别设为Red和set(gcbf,"Color","r")。
至此，图形用户界面已经设计好。在图形窗口选择 File菜单项中的Save Figure As或 Save
第7章 MATLAB图形用户界面设计 ·207·
Figure命令用M文件把图形存起来，然后在MATLAB命令窗口运行该M文件即可得到图7.10所
示的图形用户界面。
习 题 七
1.什么是图形用户界面?有何特点?
2.菜单设计和对话框设计的基本思路是什么?
3.对话框中常用控件有哪些?务有何作用?
4.设计菜单。菜单条中含有File和Help两个菜单项。如果选择 File中的New选项，则将显示New ltem字
样；如果选择 File中的Open选项，则将显示出Open ltem字样。File中的Save菜单项初始时处于禁选状态，在选
择 Help选项之后将此菜单项恢复成可选状态，如果选择 File中的Save选项，则将显示Save item字样；如果选择
File中的Exit选项，则将关闭当前窗口，如果选择 Help中About…选项，则将显示 Help Item字样，并将Save菜单
设置成可选状态。
5.建立控件对象。
(1)建立单选按钮，分别用于将图形窗口移至屏幕的4个角。
(2)建立弹出框，分别选择不同的函数，从而实现相应的函数运算。
(3)建立列衣框，分别选择不同的函数，从而实现相应的函数运算
(4)分别建立编辑框和命令按钮，其中编辑框输入多项式系数，命令按钮求其根。
(5)用滑动条米输入 a和b的值，命令按钮求其和。
(6)在图形窗口中央建立一个按钮，单击按钮时，按钮在图形窗口中随机游动。
(7)建立一个双位按钒，控制是否保留坐标轴原有图形。
6.设计一个“MATLAB功能演示系统”,要求系统具有友好的用户界面。
7.利用用户界面设计工具设计图7.4所示的图形演示对话框。
第8章 MATLAB笔记本
MATLAB和文字处理软件Microsoft Word的结合，使用户能够在Word 环境中访问MATLAB,
为用户提供一个集文字处理与科学计算于一体的工作环境。这种工作环境称为MATLAB笔记本
(Notebook)。MATLAB笔记本不仅拥有Word的全部功能，而且能输入并执行MATLAB命令，从而
能将命令执行结果直接插人在Word文档中。
在MATLAB笔记本中，文档、图形、表格及数学公式等的输人、编辑、排版方法与常规的Word
操作完全相同。关于Word的操作，不再赘述。本章重点介绍如何利用MATLAB笔记本在Word
文档中输入、执行MATLAB命令以及保存命令执行结果。
8.1 笔记本的安装及启动
8.1.1 笔记本的安装
随MATLAB版本的不同，笔记本的安装方法也不同。对于MATLAB 5.0~5.2版，笔记本的
安装是在MATLAB安装过程中进行的，而MATLAB5.3版笔记本的安装是在MATLAB安装完成
之后，在MATLAB环境下进行的。下面介绍MATLAB5.3版笔记本的安装。具体步骤为：
(1)启动MATLAB,在其命令窗口输人：
notebook -setup
于是屏幕提示：
Welcome to the utility for setting up the MATLAB Notebook
for interfacing MATLAB to Microsoft Word
Choose your version of Microsoft Word:
[1] Microsoft Word for Windows 95(Version 7.0)
[2] Microsoft Word 97
[3] Exit,making no changes
Microsoft Word Version;
(2)用户根据自己机器上所用Word版本，在最后一行提示后而输人对应序号，并按回车键。
于是出现以下提示：
You will be presented with a dialog box.Please use it to select
your copy of the Microsoft Word 95 executable(winword.exe).
Press any key to continue...
(3)当按下任意键后，屏幕上会弹出一个对话框，让用户选择 winword.exe所在的目录。当选
定并确认后，又出现下面的提示：
You wil be presented with a dialog box.Please use it to
第8章 MATLAB笔记本 ·209·
select a Micmsoft Word template(.dot)file in one of your
Mrerosoft Word template directones. We suggest that you specify
your nornal.dot filc.
Press any key to continue...
(4)当按下任意键后，屏幕上乂弹出一个对话框，让用户选择 nomal.dot 所在的目录。当选
定并确认后，出现提示：
Notebook sctup is complete.
表示笔记本安装结束。
8.1.2 笔记本的启动
启动笔记本有两种方法：从Word中启动；从MATLAB命令窗口启动。
1.从Word中启动笔记本
启动Word后，一般按系统默认的模板 normal.dot 建立文档，文档中可以包括任意文本，当然
也可以包括MATLAB命令。但若想使MATLAB命令在Word下执行并将执行结果也包含在文档
中，则必须打开MATLAB命令窗口，在其中运行该命令，然后把运行结果剪贴到该文档中。显然，
这是非常麻烦的。而采用M-book 模板，则可以使上述操作直接在Word下进行。所谓从Word
中启动笔记木，实际上就是新建或打开一个业已存在的M-book 文档。
(1)建立新的M-book 文档
先启动Word,假若这时Word的默认模板是normal.dot。在这种情况下，建立新的M- book
文档的步骤是：从Word窗口的“文件”菜单项中选择“新建”命令，在弹出的对话框中选择M book 模板，单击“确定”按钮。于是，Word窗口由原先的默认式样变成M-book 式样。假如此前
MATLAB尚末启动，则MATLAB会自行启动，用户可以看到MATLAB的启动图标。MATLAB启动
结束后，便进入新的M-book 文档。
(2)打开已有的M-book 文档
打开已有的M-book 文档与打开一般Word文档没有什么区别。最常用的方法是：从Word
窗口的“文件”菜单项中选择“打开”命令，然后从弹出的对话框中，选择需要的M-book 文档。
2.从MATLAB中启动笔记本
从MATLAB中启动笔记本比较简单，只需在命令窗口中键入命令：
notebook或 notebook 文件名
不带文件名的notebook 命令用于建立一个新的M-book 文档，带文件名的 notebook 命令用于
打开一个已存在的M-book 文档。
8.1.3 MATLAB笔记本的界面
M-book 模板为用户提供了在Word环境下使用MATLAB的功能。该模板定义了Word与
MATLAB进行通信的宏指令、文档样式和工具栏。当调用该模板时，Word便自动将M-book 模
板定义的宏装人内存，启动笔记本用户界面，以及定义文档的样式和单元。
MATLAB笔记本的界面和通常的Word界面主要有两点区别：
(1)在菜单栏中多了一个Notebook菜单项，笔记本的许多操作都可以通过该菜单项的命令
·210· 应 用 篇
来完成。
(2)在“文件”菜单项下多了一个New M-book 命令项。如果在M-book 模板下要建立新的
M-book 文档，可以选择该命令。
8.2 输入单元的定义与执行
在MATLAB笔记本中，凡在Word与MATLAB之间进行传递的内容称为单元(Cell)。由M book 文档传向MATLAB的命令称为输人单元(Input Cell)。文档中任何合法的MATLAB命令都可
以定义为输入单元，输入单元可以送到MATLAB环境中去执行，执行结果保存在MATLAB工作空
间，同时送回笔记木，成为输出单元(Output Cell)。输入单元可以单独存在，但输出单元必须依赖
输入单元而存在。较之通常的Wond,MATLAB笔记本最重要的操作就是输入单元的定义与执
行。
8.2.1 基本操作
1.输入单元的定义
在M-book 中，输入单元可以是一条单独的MATLAB命令、在一行内的几条MATLAB命令、
多行命令或者是内嵌在文本中的命令。定义输入单元的方法是：首先选中所需命令，然后在
Notebook菜单项中选择 Define Input Cell 命令，于是被选中的MATLAB命令成为输入单元。输人
单元在M-book模板中预设置为绿色，10磅大小，Courier New 粗体英文。定义输入单元也可以
在选中所需命令后，直接按组合键Al+D。
要注意，定义的输入单元并没有执行，当然也就没有执行结果。
2.输入单元的执行
为了执行输入单元，应选择Notebook 菜单项中的Evaluate Cell 命令或直接按组合键Ctrl+ En ter。
3.输出单元
输入单元执行后产生输出单元。如果输入单元经修改后重新执行，那么新的输出单元将替
换原有的输出单元。输出单元中包含MATLAB命令的输出结果：数据、图形、错误信息。数据的
输出样式在M-book 模板中设置为蓝色，10磅大小，Courier New英文细体。错误信息的输出样
式是红色，10磅大小，Courier New英文粗体。图形的输出格式则通过Notebook 菜单中的Notebook
Options来设置。
例8.1 定义并执行输入单元。
操作步骤如下：
(1)在文档中输人MATLAB命令：
x=(1:5)/5*pi;y=2*exp(-0.5*x).*sin(2*pi*x)
(2)选中命令行，在Notebook 菜单项中选Define Input Cell 命令或直接按组合键Alt+D,于是
命令行就变成了“绿色”的输入单元。
(3)若要把输人单元送去执行，则可用Notebook 菜单项中的Evaluate Cell 命令或直接按组合
第8章 MATLAB笔记本 ·211·
键Ctrl+Enter,执行后产生“蓝色”的输出单元：
y=
-1.0543 1.0660 -0.5155 -0.0474 0.3230
在M-book 文档中，输人MATLAB命令时要特别注意：
(1)不要把中文标点混杂在MATLAB命令中，否则会产生错误。MATLAB命令及其中的标
点都必须在英文状态下输入。
(2)MATLAB的续行符(3个小黑点...),不能用于M-book。M-book 处理超过物理行命令
的方法是让其自行换行，不要加回车符。
4.输入单元定义与执行同时进行
先选中MATLAB命令，然后从Notebook菜单项中选择 Evaluate Cell 命令或直接按组合键Ctrl
+ Enter,不但使被选中的命令成为输人单元，而且送去执行，产生输出单元。
例8.2 输入单元定义与执行同时进行。
在英文状态下，以文本方式键入命令，然后选中命令并按Ctrl+Enter键，则得到输人、输出单
元：
z=y.2,a=[x;y;z;x.*y;x./z,inv(a)
z=
1.1115 1.1365 0.2658 0.0022 0.1043
=
1.0e+003*
0.0006 0.0013 0.0019 0.0025 0.0031
-0.0011 0.0011 -0.0005-0.0000 0.0003
0.0011 0.0011 0.0003 0.0000 0.0001
-0.0007 0.0013 -0.0010 -0.0001 0.0010
0.0006 0.0011 0.0071 1.1177 0.0301
an6=
-0.0656 -0.8691 0.3727 0.4369 0.0002
0.7026 -0.2481 0.0000 -0.0097 0.5241
-1.0123 -0.0006 0.2385 0.8841 0.1008
-0.00680.0116 0.0081 -0.0105 0.0009
0.1976 -0.6469 0.6276 -0.0004 -0.3511
说明：
(1)例中变量x,y的值取自MATLAB工作空间，由例8.1的输出确定。
(2)在笔记本中，是否显示计算结果的控制方法与在MATLAB命令窗口一样。命令后有分
号，则计算结果不会以输出单元显示，命令后不带分号，则显示。
(3)修改输入单元后再重新执行，则新的输出结果会覆盖掉原来的输出结果。
8.2.2 自初娘化单元及其应用
1.自初始化单元
自初始化单元(Autolnit Cell)与输人单元功能惟一不同的是：当用户启动一个M-book 文档
·212· 应 用 篇
时，包含在该文档中的自初始化单元会自动被送去执行，而输入单元不具备这种功能。若用户需
要在打开文档时，对MATLAB工作空间进行初始化工作，那么自初始化单元特别有用。自初始化
单元在M-book模板中预定义为深蓝色，10磅大小，Courier New英文粗体。
自初始化单元有两种来源：文本形式的MATLAB命令；已经存在的输入单元。为把它们变成
白初始化单元，需先选中它们，然后选择 Notebook菜单中的Define AutoInit Cell 命令即可。
2.自初始化单元的应用
M-book 的所有运算都是在MATLAB中进行的，参与运算的所有变量都储存在MATLAB工
作空间中。各M-book 文档和MATLAB命令窗口分享同一个“计算引擎”和同一个工作空间，工
作空间中的变量是各M-book 文档和MATLAB命令窗口工作后共同产生的。
当用户同时打开几个M-book 文档，或者在MATLAB命令窗口和M-book 文档之间交互运
作时，应注意不同文档之间，或者文档与窗口之间变量的相互影响。为了使某一个M-book 文档
独占MATLAB工作空间，一个有效的办法是：把 clear命令作为该文档的第一个自初始化单元。
8.2.3 单元群及其应用
1.单元群
单元群(Cell Group)是多行输入单元或自初始化单元组成的一个整体。它有3种来源：
(1)对输入的多行文本型MATLAB命令，用鼠标把它们同时选中，然后在Notebook 菜单中选
择 Define Cell或 Define Autolnit Cell命令，便生成输入单元群或自初始化单元群。
(2)对输入的多行文本型MATLAB命令，用鼠标把它们同时选中，然后在Notebook 菜单中选
择 Evaluate Cell或按组合键 Crl+ Enter,于是单元群被定义并执行。
(3)把已有的多个独立输入单元或自初始化单元同时选中，然后在Notebook 菜单中选择
Group Cells,于是，便获得以第一个独立单元的性质组合而成的单元群。
假如被选中的多个独立单元区域内，夹带有独立成行的文本，那么在把独立单元组合成群的
同时，将把原先夹在中间的文本内容移到单元群之后。
顺便指出：Notebook菜单中的Group Cells 命令不能直接把文本型MATLAB命令组合成单元
群。单元群被激活后将拥有一个输出单元(群)。在这个输出单元(群)中，输出数据的次序与命
令在(输入)单元群中的次序相同，而图形输出总在数据之后。
2.单元群的应用
单元群的用途主要有两个：
(1)保证MATLAB命令结构(如循环结构、条件结构)的完整。
(2)保证输出结果(如图形)的完整。
例8.3 对循环结构使用单元群。
clear
x=0:10;
for k=1:10
y=k*x;
plot(x,y);
hold on
第8章 MA1LAB笔记本 ·213·
end
hold off
set(gcf,' Color','w')
执行结果如图8.1所示。假如本例中的单元群用一行行独立的输人单元替代，那么当运行
它们时，将显示出错警告。
100
90
80
70
60
50
40
30l
20
10
oL0 1 2 3 4 5 6 7 8910
图8.1 对循环结构使用单元群
例8.4 使用单元群产生完整图形。
1.4
1.2
1
0.8
0.6
0.4
0.2
oL
0 1 2 3 4 5 6 7 8 9 10
图8.2 使用单元群产生的图形
214 应 用 篇
elf;
t=0:0.1:10;y=1-exp(-0.cus(1):
t=[0.10,10.0];
yx=[0.95,0.95.1.05,1.05]:
6il(n,y,*y);
bold o
plot(t.y.'k'):
hold elf
e(g, Color!.')
ymax=man(y),tm*tfindfy-ymsx))
ymax =
1.0669
tm=
2.4000
执行结果如图8.2所示。
8.2.4 单元的循环执行
利用Notebook菜单中的Evaluate Loop命令可实现单元的循环执行。操作步骤如下：
(1)选择要重复执行的输入单元，再选择 Notebook菜单中的Evalate Loop命令，弹出图8.3
所示的循环执行对话框。
(2)在对话框的Stop Afler栏中输人所需重复
执行次数，然后单击Start 按钮，开始执行命令，并
显示已执行的次数。
国wlaate tsop 区
Loup Caunt. D
(3)如果要在每一次循环后加人延迟，可以
单击 Slower 按钮，反之单击Faster按纽。如果要
暂停命令的执行，可单击Pause 按钮。
3tap AFLr 10
LnoD Sped: Qr
(4)单击Close 按钮，关闭对话框。 Sy! Pain Coxs
例8.5 用单元的循环执行产生图8.1。
操作步骤如下：
(1)运行以下命令： 图8.3 插环执行对话框
clerix=0:10;k=I;holt an
(2)选中以下3行命令，再选择 Notebook菜单中的 Evaluate Loop命令打开循环执行对话框，
取重复次数为10次，单击Stant 按钮，命令循环执行。
y=k*
ploe(x,y);
k=k+1:
(3)待循环结束，单击 Close 按钮，关闭对话框。
第8章 MATLAB笔记本 ·215
8.3 计算区的定义与执行
计算区(Cale Zone)是一个由普通Word文本、输人单元和输出单元组成的连续区，用于描述
某个具体的作业或问题。在计算区里，用户可以根据描述问题的需要，安排段落、标题、分栏，而
不受计算区外的有关格式的约束。
MATLAB笔记本将计算区定义为Wond的一个节，并将节的分隔符号置于计算区的首尾，但
在文档的开始和结束的地方Word不显示节分隔符号。
定义计算区的方法是：先选定包含普通Wond文本、输入单元和输出单元的一个连续区，然后
选择 Notehook 菜单中的Define Cale Zone命令。
一旦计算区被定义后，不管光标在计算区的什么位置，只要选择Notebook菜单中的Evaluate
Cale Zone命令即可执行计算区中的全部输人单元，且在每个输入单元后面以输出单元形式给出
相应的计算结果。
8.4 输出格式控制
输出格式控制包括输出数据控制和输出图形控制。可以通过Notebook 菜单中的Notebook
Options命令来实现。选择该命令后，会弹出如图8.4所示的输出格式控制对话框，以后的操作都
是针对该对话框进行的。
8.4.1 偷出数据措式控制
1、输出数据的表示方式
在M-book 文档中，输出单元中数据的输出格式有3种控制
方法：
(1)在图8.4所示的对话框中，通过Nunerie Fomat弹出式列
表框进行设置，共有8种可选格式：Shont,long、Hes,Bank,Plus.
Short e,Long e,Rational。
(2)通过输入单元中的format 命令进行设置。
(3)在MATLAB命令窗口中，用farmat 命令进行设置。
在此再次说明，不同输出格式给出不同的数据显示精度，但
内部存储及运算都是以相同的双精度进行的。
2.输出数据间的空行控制
在图8.4所示的对话框中，选择Loose或Compact,可以控制
输人单元与输出单元之间有无空行。如果选择Loose,则在输人
单元与输出单元之间插入一个空行，而选择Compac,不插入空
行。
M-1 财
ule t=
*! 回 石I
ap/t
nhFIFin
 to-Celehen
lt nhee
55
Pir wll
Tasl
图8.4 输出格式控制对话框
·216· 应 用 篇
注意，如果在输入单元中使用 format loose或format compact命令，则控制的将是输出单元与输
出单元之间有无空行。
8.4.2 输出国形格式控制
利用如图8.4所示的输出格式控制对话框，也可以实现对输出图形的控制。
1.图形镶嵌的控制
决定输入单元中的绘图命令是否向M-book 文档输出图形的控制选项有两个：一个是输出
格式控制对话框中的Embed Figures in M-book 复选框；另一个是在 Notebook菜单项中的Toggle
Graph Output for Cell选项。
M-book的缺省设置是：Embed Figures in M-book 处于选中状态(即该项的小方块中打√)。
在这种设置下，输出的图形被镶嵌在M-book 文档中。假如 Embed Figures in M- book处于不选
中状态(即该项的小方块为空白),那么图形将输出到另外的图形窗口中。Embed Figures in M book 复选框的状态对在其后面运行的所有输入单元中的绘图命令起控制作用。
在Embed Figures in M-hook 复选框被选中的前提下，输出图形是否镶嵌在M-book 文档中，
还取决于Notebook 菜单项中的Toggele Graph Output for Cell 选项，该选项相当于一个“拨动开关”。
M-book的缺省设置是：每个输入单元被定义时，“拨动开关”的拨动次数为0,此后一定向M
-book 文档输出图形。如果对某输人单元(选中该输人单元，或光标在该输入单元中),选中“拨
动开关”奇数次，就会紧跟在该输入单元之后显示“(no graph)”字样。表示以后再执行该输入单
元，其输出图形将被抑制。若要使该输入单元恢复输出图形的能力，必须对该输入单元再选中一
次“拨动开关”,其后“(no graph)”字样也随之消失。
2.曲面图色彩控制
为了使彩色打印机有正确的彩图输出，也为了使黑白打印机有正确的灰度图形输出，应使输
出格式控制对话框中的 Use 16-Color Figures 复选框处于选中状态(即该项的小方块中打√)。
假如在图形输出前，在输出格式控制对话框中不选择 Use 16-Color Figures复选框(即该项的小
方块为空白),那么生成的256色曲面图就可能得不到正确的色彩表达，更严重的是在黑白打印
机上所得到的曲面图将是一片黑色。
3.图形背景色的控制
在缺省情况下，正常嵌入图形的背景色应是“灰/白”的。假如由于某种原因，所嵌图形出现“灰
/黑”背景，那么可以打开输出格式控制对话框，确认 Embed Figures in M-book 处于选中状态，并再
次单击OK按钮，然后再重新运行输入单元。或在MATLAB命令窗口中，运行 whitebg(' white')命令
后，再重新运行输入单元。
4.图形大小的控制
在图8.4所示的对话框下方有3个精确控制图形大小的项目：Units、Width、Height。可通过
对这3项的设置，决定图形的大小。当然，所得图形也可以像普通 Wond图形一样，对它进行移
动、缩放、剪裁和编辑。
第8章 MATI.AB笔记本 ·217·
8.5 Notebook菜单的其他命令
8.5.1 整个M-book 文档输入单元的执行
Notebook菜单项中的Evaluate M-book命令可以把整个M-book 文档中的所有输入单元送
到MATLAB中去执行。不管光标处于文档的什么位置，执行总是从文档首部开始。在整个M book 文档输入单元执行时，不但会把所有输出单元的内容更新，而且会补写新的输出单元。这个
命令在保证整个M-book 文档中命令、数据和图形的一致性方面十分有用。但该命令可能会引
起版面混乱，所以要慎用。
8.5.2 删去M-book 文档中所有输出单元
Notebook 菜单项中的Purge Output Cells命令可以删去M-book 文档中所有输出单元。具体
操作方法为：先选中全部文档，然后选择Notebook 菜单项中的Purge Output Cells命令，这样M book 文档中所有输出单元被删去。
8.5.3 单元转化为文本
单元(包括输人单元和输出单元)与文本不同，它们是“活”的。所谓“活”单元，是指当用户改
变输入单元并再次运行时，它的输出单元也会更新，即新的结果会覆盖掉原来的结果。假如用户
希望保持原来的结果，那么就应该将“活”单元转化为“死”单元(即文本)。
单元转化为文本的方法是：选定单元，再选择Notebook菜单中的Undefine Cells命令。或将光
标置于单元之中，按组合键Alt+U。单元转化为文本后其样式会改变，由原来的样式变成Normal
样式，因此它的字体、大小、颜色均为Normal 样式。
当某输人单元或单元群被转化为文本时，与之相应的输出单元也被自动转化为文本。然而，
当输出单元被转化为文本时，就切断了它与输入单元的联系，但输入单元的性质不会因此而改
变，此后，若再次运行输人单元，Notebook 会紧跟在输入单元之后产生一个新的输出单元，而原来
的结果不变。
8.6 M-book模板样式的修改
同其他Word模板一样，用户既可以修改M-book 模板原有样式，也可以加入新样式。例如，
现有的M-book 模板中，输人单元是绿色的，输出单元是蓝色的，错误单元是红色的。现在要把
输出单元的颜色变为黑色，操作步骤如下：
(1)选取Word“格式”菜单中的“样式”选项，弹出样式对话框。
(2)在“样式”列表框中选择Output,然后单击“更改”按钮，弹出更改样式对话框。
(3)选中“添至模板”复选框，然后再单击“格式”按钮，并在弹出栏中选“字体”,又弹出字体
·218· 应 用 篇
对话框。
(4)在字体对话框中，将“颜色”项改为黑色，按“确定”按钮，然后依次退出。
习 题 八
1.简述M- book 模板和Normal模板的区别。
2.输入单元的定义和执行有哪些方法?具体操作如何?
3.自初始化单元和输入单元有何区别?
4.自初始化单元和单元群有何作用?试举例说明。
5.计算区有何作用?如何定义和执行?
6.对数据和图形实施输出控制应选择什么菜单命令?
7.在M-book 文档中输人 MAT1.AB命令时要注意什么?
8.利用MATLAB笔记本制作一份电子讲稿，要求能现场进行复杂的科学计算或改变参数后进行实时计算，
并给出数字或图形结果。在此基础上，进一步尝试利用MATLAB笔记本来实施多媒体教学。
第9章 MATLAB环境下的仿真软件Simulink
Simuink 是MATLAB环境下对动态系统进行建模、仿真和分析的一个软件包。它于20世纪
90年代初由Mathworks公司开发。现在较为流行的版本有：与MATLAB 5.2配用的Simulink 2.2
以及与MATLAB 5.3配用的Simulink 3.0。
顾名思义，Simulink 的名字表明了该系统的两个主要功能：Simu(仿真)和Link(连接)。即用
户可以调用现成的图形模型，并将它们适当地连接起来以构成动态系统的模型，然后对系统进行
仿真，并可以随时观察仿真结果和干预仿真过程。Simulink 的模块库为用户提供了多种多样的
功能模块，这是一笔非常丰富的资源。本章介绍Simulink 建模、仿真和分析的基本方法。
9.1 Simulink 的基本操作
在安装MATLAB过程中，若选中了Simulink 组件，则在MATLAB安装完成后，Simulink 也就安
装好了。Simulink 不能独立运行，只能在MATLAB环境中运行。
9.1.1 Simulink的启动与退出
1. Simulink的启动
启动Simulink的方法有3种：
(1)在MATLAB的命令窗口直接输入命令simulink。
(2)单击MATLAB命令窗口工具栏上的Simulink 模块库浏览器命令按钮。
(3)在MATLAB命令窗口 File菜单中选择New菜单项下的Model命令。
Simulink启动后会显示如图9.1所示的Simulink 模块库浏览器。采用第3种方法同时还会
出现如图9.2所示的一个新的模型窗口(名字为untitled)。采用第2种和第 3种方法启动
Simulink 模块库浏览器后再单击其工具栏中的新建模型命令按钮，也会弹出如图9.2的模型窗
口。Simulink 模块库窗口中显示了各类模块库的图标。用户利用模型窗口，通过鼠标的拖放操
作可以创建一个模型。
如果要对一个已经存在的模型文件进行编辑修改，需要打开该模型文件，其也有3种方法：
(1)在MATLAB命令窗口直接输入模型文件名(不要加扩展名.mdl)。这要求该文件在当前
目录下或在已定义的搜索路径中。
(2)在模型窗口 File菜单中选择Open命令，然后选择或输入欲编辑模型的名字。
(3)单击模型窗口工具栏上的打开命令按钮。
2.Simulink的退出
退出 Simulink,只要关闭所有模型窗口和 Simulink模块库窗口即可。
220 独 用 篇
si1InNwr 同B区
码的厂
amN
白SCatino
twrivi
Intt
ry
leTp
Tranafer Pm
Tranapuet 3kt ihls buyert Delay
Tr+
出scret
加PnctiaATl
5th Snli
出bit
t
图9.1 Simufank模块库测览器
mtiued 有问冈
1+Idit Yi Silstion P TC
Aaady 100W 5
图9.2 模型演口
9.1.2 Simulink 模块的择作
模块是建立Simalink模型的基本单元。用鼠标将模块拖到模型窗口，再用适当的方式把各种
模块连接在一起就能够建立动态系统的模型，Simdink 模块有连续系统(Coninumis),离散系统
(Discete),非线性系统(Nonlinear)等儿类基本系统构成模块，还包括函数与表(Functions & Tables)、
数学运算(Matb),信号与系统(Simals &Systens).输人信号源(Smmee)以及接收模块(Sinks)。
1.选取模块
当选取单个模块时，只要用鼠标在模块上单击郡可，这时模块的角上出现黑色的小方块。选
取多个模块时，在所有模块所占区城的一角按下鼠标左键不放，拖向该区域的对角，在此过程中
会出现虚框，当虚框包住了要选的所有模块后，放开鼠标左键，这时在所有被选模块的角上都会
第9章 MA7LAH环境下的仿真软件-Sinulink 221
口
sine Wae Scope (1)在不同的窗口之间复制。最简单的办法是用风标左键点住要
复制的模块(首先打开源模块和目标模块所在的窗口),按住左键移动 图乡3 选取多个模境
贼标到相应窗口(不用按住Crl键),然后释放，该模块就会被复制过来，而源模块不会被测除。
出现小黑块，表示横块都被选中了，如图9,3所示。
2.复制与删除模块
当然还可以用模块窗口 Edit菜单中的Copy 和 Paste命令或工具栏上的复制和粘贴命令按钮
来完成复制。
(2)在同一模型窗口内复制。有时一个模型需要多个相同的模块，这时的复制方法是：用风
标左键点住要复制的模块，按住左键移动鼠标，同时按下 Cr键，到适应位置放开做标，该模块就
被复制到当前位置。更简单的方法是按住鼠标右键(不按Cun键)移动风标。
还可以用模块窗口 Edit菜单中的Copy 和Paste命令或工其栏上的复制和粘贴命令按钮来完
成复制。
模块复制以后，会发现复制出的模块名称在原名称的基础上加了编号，这是Simulink的约
定：每个模型中的模块和名称是一一对应的，相同的模块或不同的模块都不能用同一名字。
(3)删除模块。选定模块，选择 Edit菜单中的Cu(册除到剪贴板)或Clear(彻底酬除)命令。
或者在模块上单击鼠标右键，在弹出菜单上选择Cat或Clear命令。
3.模块的参数和属性设置
Simulink中几乎所有模块的参数都允许用户进行设置。只要双击要设置的模块或在模块上
按佩标右键并在弹出的快捷菜单中选择 Block Paramelens 就会弹出参数设置对话框，图9.4所示
的是正弦波模块的参数设置对话框，用户可以设置它的幅值、阙率，相位、采样时间等参数。模块
参数还可以用set_param函数设置，这部分内容将在后面介绍。
err.Sie
5neWa
0iata
PWmre litun:
gey6d/n]
厂
石
e ti 5
Cseal de
图9.4 模块参数设置对话桩
每个模块都有一个内容相同的属性设置对话框，如图9.5所示。它的打开方式是在模块上
按鼠标右键并在弹出的快捷菜单中选择 Block Properies。该对话框包括根据需要设定的5个基
本属性：
222· 应 用 篇
Mec Itrt5neIire 网
linla
Descndbirfsbot hd atuornandveb thebchoyud
nj chenhn shoaihe sbxho the mcasl HHhe pmehoowh egdrdon od icninin
地 r
26rewiek(htieckeawe thd Opnheeion'ehe knchlobecibe tkkm bock
htalsefomsksy lond homtinteths
neg,Pnel
Pyseiptiem
Toerity
7
m Fneio
trus9s tiE
m Coerdl tele
图9.5 模块属性设置对话框
(1)描述(Description) 是对该模块在模型中用法的注释。
(2)优先级(Priority)规定该模块在模型中相对于其他模块执行的优先顺序。优先级的数
值必须是整数或不输人数值，这时系统自动选取合适的优先级。优先级的数值越小(可以是负整
数),优先级越高。
(3)标记(Tag)用户为模块添加文本格式的标记。
(4)打开函数(Open funetion)用户双击该模块时调用的MATLAB函数。
(5)属性格式字符串(Attributes format string)指定在该模块的图标下显示模块的哪个参数，
以什么格式显示。一个参数名前是“?,后面跟着“>”。属性格式字符串由任意的文本字符
串加嵌人式参数名组成，还可以使用换行符“\n”,控制在不同的行显示出参数。如果参数的值
不是字符申或数字，相应位置会显示N/S(not supported)。如果参数名无效，该位置将显示"???"。
4.模块外形的调整
(1)改变模块的大小。选定模块，用鼠标左键点住其周围的4个黑方块中的任何一个并拖
动，这时会出现一个虚线的矩形表示新模块的大小，到需要的位置后释放鼠标即可。
(2)调整模块的方向。选定模块，选择Fomat菜单中的 Rotate Block命令使模块顺时针方向
旋转90°,选择Filp BHlock命令使模块旋转180°。显然两次旋转90°与一次旋转180°的操作效果是
一样的，如图9.6所示。
(3)给模块加阴影。选定模块，选择Fomat菜单中的Show Dmop Shadow命令使模块产生阴影
效果。
第9章 MATLAB环境下的仿真较件Sinmulok ·233·
Sine Wave2
Sine Wave1
Sing W
图9.6 调整模块方向
5.模块名的处理
(1)模块名的显示。选定模块，选择Font菜单中的Hide Name命令，模块名就会被隐藏，同
时Hide Name改为 Show Name。选择 Show Name 命令就会使模块隐藏的名字显示出来。
(2)修改模块名。用就标左键单击模块名的区域，这时会在此处出现编辑状态的光标，在这
种状态下能够对模块名随意修改。
模块名和模块图标中的字体也可以更改，方法是选定模块，在Formst菜单中选择Font命令，
这时会弹出Su Fant 对话框，在对话报中选择想要的字体。
(3)改变模块名的位置。模块名的位置有一定的规律，当模块的接口在左右两侧时，模块名
只能位于模块的上下两侧，缺省在下侧；当模块的接口在上下两侧时，模块名只能位于模块的左
石两偶，缺省在左偶。
因此模块名只能从原位置移动到相对的位置。可以用鼠标拖动模块名到其相对的位置；也
可以选定模块，用Formst菜单中的 Flip Nane命令家现相对的移动。
6.模块的连接
当设置好了各个模块后，还需要把它们按照一定的顺序连接起来才能组成一个完整的系统
模型。
(1)连接两个模块。从一个模块的输出端连到另一个模块的辎人端，这是最基本的情况。
方法是移动鼠标到输出端，鼠标的箭头会变成十字形光标，这时点住威标左缝，移动鼠标到另一
个模块的输人端。当十字形光标出现“重影”时，释放叙标左键就完成丁连接。
如果两个模块不在同一水平线上，连线是一条折线。要用斜线表示、需要在连接时按住 Shit
键。两种连线的结果见图9.7。
Soope Scope1
Sine Wav SinE Waret
图97 两模块不在同一水平线上
(2)模块问连线的两整。调整模块问连线位置可采用鼠标拖放操作来实现。即先把氟标移
动到需要移动的线段的位置，按住鼠标左键，移动鼠标到目标位置，释放鼠标左链。
还有一种情况，要把一条直线分成斜线段。调整方法和前一种情况类似，不同之处在于按住
枫标左键之前要先按下 Shif键，出现小黑方块之后，藏标点住小黑方块移动，移好后释放Shift 键
和鼠标。
(3)在连线之间插人模块。把该模块用鼠标拖到连线上，然后释放鼠标即可。
·224· 应 用 篇
(4)连线的分支。实际应用中，经常需要把一个信号输送到不同的模块，这时就需要从一根
连线分出一根连线。具体的操作方法是：在先连好一条线之后，把鼠标移到分支点的位置，先按
下 Ctrl键，然后按住鼠标拖动到目标模块的输入端，释放鼠标和Ctrl键。
7.在连线上反映信息
(1)用粗线表示向量。为了能够比较直观地区别各个模块之间传输的数据是向量还是标
量，可以选择模型窗口 Format 菜单中的Wide Vector Lines命令，这样传输向量的连线就会变粗。
如果再选择 Format中的Vector Lines Widths命令，则在传输向量的连线上方会显示出该向量的长
度。
(2)显示数据类型。在连线土可以显示前一个模块输出的数据类型：选择 Format菜单中的
Port Data Types命令。
(3)信号标记。为了使模型更加直观、可读性更强，可以为传输的信号做标记。建立信号标
记的办法是：双击要做标记的线段，出现一个小文本编辑框，在里面输入标记的文本，这样就建立
了一个信号标记。信号标记可以随信号的传输在一些模块中进行传递。支持这种传递的模块有
Mux、Demux、From、Selector、Subsystem和Enable等。
要实现信号标记的传递，需要在上面列出的模块的输出端建立一个以“<”开头的标记，当开
始仿真或执行 Edit菜单中的Update Diagram命令时，传输过来的信号标记就会显示出来。图9.8
示意了这个传递的过程。
20 s11
20 s11
Consant Constantt
可 可 《51,s2>
DIsplay Display1
s22 s22
Step Step1
图9.8 信号标记的传递
9.2 Simulink 的几类基本模块
本节以表格的形式给出了Simulink 几个基本模块库中的模块功能简介，从而使得读者对
Simulink的一些主要模块有一个初步的认识。如表9.1~9.6所示，表格中的模块名和模块库中
的模块图标下的名称一致。
打开模块库窗口的方法很简单。以连续系统模块库(Continuous)为例，在 Simulink 模块库浏
览器窗口中选中Simulink,然后单击鼠标右键，这时会在鼠标指针的位置弹出一行快捷菜单，内
容是Open the'Simulink'Library,用鼠标左键单击该项，出现如图9.9所示的 Simulink 基本库窗
口，在此窗口中双击Continuous模块库的图标即可打开该模块库窗口，如图9.10所示。也可以在
模块库浏览器窗口中Simulink 下选中Continuous项，然后用与打开Simulink 基本库窗口同样的方
法直接打开连续系统模块库。
第9章 MATLAB环境下的仿真软件Simalnk 225
国y,simk3 同同因
Bb1面it Yie Forast
SiSContinyeurpis*te Fuhcbionun+ h Tabf Sptem
Bwekse Toobuse Simwisk 9k Libuay30
CoprgM)3900-1990The MW Dra
图9.9 Simulink 基本库
Lihr imlin3/Coati A口区
P:t Ye Fm1
wat
etor Dnvatve
suate-S8 Tuanferf ZPe
Memoy Tuanp 0*
Varahle Tumpott Dety
图9.10 连续系统模块库
表9.1 输入源模块(Sources)
模 块 名 功能简介 模 块 名
常数 Chip Signal
信号发生器 Clck
阶跃信号 Digial Clock
线性增加或减小的信号 From File
正弦波 Frne Wockspsce
重复的线性信号，类似锯齿形Randoen Naumber
离散脉冲发生器，和采样时问
脉冲发生器，和采样时间无关Bamd-Limited Whise Nooe
Uniform Handom Number 有关
功能简介
Conslant 频率不断变化的正兹信号
Sipal Geonerator 输出当前的仿真时间
Siep 按指定速率输出当前仿真
时间
Ramp 从文件读数据
Sine Waye 从当前工作空阿定义的矩
阵读数
Repealing Seqienee 高斯分布的随机信号
Discrere Pulke Generitor 平均分布的随机信号
Pale Generator 带限白噪声
iore
·226· 应 用 篇
表9.2 接收模块(Sinks)
模 块 名 功能简介 模 块 名
示波器
两个信号的关系图，用MAITLAB图形显示
实时数值显示
To File
To Workspace
Scope
XY Graph
Display Stop Simuiation'输人不为零时停止仿真
表9.3 连续系统模块(Continuous)
模 块 名 功能简介
积分环节
微分环节
状态方程
传递函数
模 块 名
Zero-Pole
Memory
Transport Delay
Variable Transport Delay
功能简介
Integrator 零极点模型
Derivative 把前一步的输入作为输出
把输入信号按给定的时间做 State- Space 延迟
按第二个输入指定的时间把 Transfer Fcn 第一个输人做延迟
表9.4 离散系统模块(Dlscrete)
模 块 名 功能简介 模 块 名 功能简介
Zero-Order Hold 零阶保持器
采样保持，延迟一个周期
离散时间积分
离散状态方程
Discrete Filter
Discrete Transfer Fcn
Diserrte Zero-Pole
First-Order Hole
离散滤波器(IIR、FIR)
Unit Delay 离散传递函数
Discrete- Time Integrator 离散零一极点模型
Discrete State-Space -阶保持器
表9.5 信号与系统模块(Slgmals& Systems)
功能简介 模 块 名 功 能简介
Data Store Write
Ground
Termninator
Data Type Conversion
Function-Call
Generatur
SubSystem
Configurable Subsystem
写数据到指定的数据存储器
给未连接的输人端接地，输
出0
连到未连接的输出端，终止
输出信号
数据类型转换
函数调用发生器
空的子系统
表示从用户指定的模块库里选
择的任何模块
功能简介
保存到文件
输出到当前工作空间的变量
模 块 名
In1,0ut1
Enable
Trigger
Mux
Demux
Bus Selector
Selector
提供输人、输出端口
建立使能子系统
建立触发子系统
把向量或标量组合为大的向量
把向量分为标量或小的向量
从输人中选择信号
选择输入的元素
第9章 MATLAB环境下的仿真软件 Simulink ·227·
续表
模 块 名 功能简介 模 块 名
把输人信号合并为输出信号
接收标记相同的Coto模块的
信号
定义 Goto模块标记的有效范围
把信号送到标记相同的Frvn
模块
从指定的数据存储器读数据
为数据存储器定义内存区域
Model Info
Hit Crossing
IC
Width
Probe
功能简介
Merge 显示模型的修改信息
From 检测输人信号的零交叉点
Goto Tag Visibility 设置信号的初始值
Goto 检查输人信号的宽度
Data Store Read 检测连线的宽度、采样时间
和复数信号标记
Data Store Memory
表9.6 数学运算模块(Math)
模 块 名 功能简介 模 块 名 功能简介
Sum 对输入求代数和
对输入求积或商
点积(内积)
常量增益(输入乘一个常数)
可以用滑动条改变的增益
矩阵增益(输人乘一个矩阵)
数学运算函数
三角函数
求最值
求绝对值，或求模(复数)
Sign
Rounding Function
Combinatorial Logic
Logical Operator
Relational Operator Angle
Complex to Magnitude -
Angle
Maguitude-Angle Couplex
Complex to Real-Imag
Real~Imag to Complex
Algebraic Constraint
取输人的正负符号
Product 取整函数
Dot Product 建立逻辑真值表
Gain 逻辑操作符
Slider Gain 比较操作符
Matrix Gain 求复数的幅值、相角
Math Function 根据幅值、相角得到复数
Trigonometric Function 求复数的实部、虚部
MinMax 根据实部、虚部得到复数
Abs 强制输入信号为零
9.3 仿真模型参数的设置
前面讨论了对模块的基本操作，但在设计过程中，事先还必须对仿真算法、输出模式等各种
模型参数进行设置。设置仿真模型参数的方法有两种：一种是在模型窗口通过菜单命令进行设
置。另一种是在MATLAB命令窗口中调用有关函数进行设置。本节将分别加以介绍。
9.3.1 通过茱单命令设置仿真模型参数
选择模型窗口 Simulation菜单中的Parameter命令，将出现仿真参数对话框。对话框分4个选
项卡：Solver(算法)、Workspace I/O(工作空间输入输出)、Diagnostics(诊断)和 Real-Time Workshop
228 应 用 箱
(实时工作间)。
1.Solver 选项卡设置
Slover选项卡如图9,11所示。
SinuhinTrtr:1- 辆区
5i wokspucioDnuns] FealmmWhsha(
Smdeiniie
SLt m00 yfn[109
Sds clone
Tm Valo tp ce?Domandemod
Mas dkp are o HhsaTe3
triw [Mo Ahahanreeso
unu con
Refre oitost 因 Rrs tatx
0 Ce
图9.11 Soler选项卡
(1)设置仿真起始和停止时间
设置起始和停止时间分别是在Sar tine和Stup time 两个编辑框内，通过直接输人数值来完
成的。时间单位是秒。
(2)仿真算法的选择
仿真算法根据步长的变化分为固定步长算法和变步长算法。固定步长是指在仿真过程中计
算的步长不变，而变步长算法是指在仿真过程中要根据计算的要求改变步长。对于这两种算法。
它们所对应的相关选项以及具体算法都有所不同。
在Type左栏设定算法类别：变步长(Variahle-step)和固定步长(Fied-step)算法。在Type
的右栏选择具体算法。
在采用变步长算法时，首先应该指定允许的误差限，包括相对误差限(Relative tolerance)和绝
对误差限(Absolute folernnco),当计算过程中的误差超过该误差限时，系统将自动调整步长，步长
的大小将决定仿真的精度。在采用变步长算法时还要设置最大步长(Max step size),在缺省值的
情况下，系统所给定的最大步长为：
最大步长=(终止时间-起始时间)/50
在一般情况下，系统所给的最大步长已经足够，但如果用户所进行的仿真时间过长，则缺省
值就非常大，有可能出现失真的情况，这时应根据需要设置较小的步长。
在采用固定步长算法时，要先设置因定步长。由于固定步长的步长不变，所以此时不设定误
差限，而多了一个模型类型(Mode)的选项，该选项包括：多任务(MultiTasking),单任务(SingleTask-
第9章 MATLAB环境下的仿真软件 Simulink ·229·
ing)和缺省值(Auto)。多任务是指在模型中模块具有不同的采样速率，系统同时检测模块之间采
样速率的传递。单任务是指各模块的采样速率相同，不检测采样速率的传递。缺省值则根据模
块的采样速率是否相同来决定采用单任务还是多任务。
变步长和固定步长都是算法的模型，这两种模型分别对应了许多种不同的具体算法。在介
绍各种算法之前，先介绍一个概念：刚性方程组。所谓刚性，是指问题的解可能在比积分步长还
要短的时间间隔内发生很大变化，而人们感兴趣的是在一段相当长的时间内完成的变化。对于
一个常微分方程组，如果其Jacobian矩阵的特征值相差很大，则称这个方程组为刚性方程组。对
于刚性方程组，由于特征值的原因，在计算过程中为了保持稳定性，步长的选取很复杂，所以在解
这一类方程组时，必须选取对稳定性要求不是十分严格的算法。在下面的介绍中，将指出哪些算
法可以求解刚性问题。
MATLAB提供的各种变步长算法有：
① discrete(no contiuous states)用于处理非连续状态的模型，过程中不含积分运算。
② ode45(Dormand-Prince)四、五阶Runge-Kutta算法，属于单步法，即每次求解时只需要
知道前一步的解而不需要其他的附加条件。通常情况下，该算法对许多问题都是最先使用的方
法，所以，MATLAB都是以ode45为缺省算法。该方法只适合求解非刚性问题。
③ ode23(Bogacki-Shampine)二、三阶Runge-Kutta算法，同样属于单步法。该方法也不能
求解刚性问题，但对于存在微小刚性的方程组，若允许误差较大，ode23要比ode45效果好。
④ ode113(Adams)变阶的Adams法，是一种多步预报校正算法，每次求解时要用到前几步
的解。在对误差范围要求比较严格的情况下，它比ode45效果好。该方法不能求解刚性问题。
⑤ odel5s(stiff/NDF)可变阶的数值微分算法，属于多步法。可以解刚性问题。
⑥ode23s(stiff/Mod.Rosenbrock)一种改进的罗森布罗克(Rosenbrock)二阶算法。在对误差
要求不高的情况下，效果要比 odel5s好。可以求解刚性问题。
⑦ ode23t(nod.sif/Trapezoidal)一种采用自由内插法实现的梯形公式，适用于无数值衰减
的系统。可以求解适当刚性的方程组。
⑧ ode23tb(stiff/TR-BDF2)一种TR.BDF2算法。具体说就是Runge- Kutta法的第一级采
用梯形公式，第二级采用吉尔(Gear)法，可以解刚性问题。
固定步长的各种算法有：
① discrete(no continue states)是用于处理非连续状态的模型，过程中不含积分运算。
② ode5(Dormand-Prince)是一种固定步长的ode45算法，属于Dormand-Prince算法。
③ ode4(Runge-Kuta)四阶的Runge-Kutta算法。
④ ode3(Bogacki-Shampine) 固定步长的ode23算法。
⑤ ode2(Heun)固定步长的改进欧拉(Euler)算法。
⑥ odel(Euler)固定步长的Enler算法。
(3)输出选项设置
对于同样的模型，在输入信号相同的情况下，选择不同的输出方式可以产生不同的效果。
MATLAB提供3种输出方式：Refine output、Produce additional output、Produce specified output only。
① Refine output(细化输出)细化输出的月的是使输出的数据曲线更加平滑。它根据细化
系数(Refine factor),可以在每个时间步长内加入若干资料，使得输出资料更加连续、平滑。例如，
230 应 用 新
细化系数是3,则把每个步长分成3等分，在1/3和2/3的地方各加入一个资料。细化系数越大，
细化后的曲线越平滑。但无限地增大细化系数会导致数据曲线的失真。细化输出的方式比较适
合于变步长的算法。
② Pnsduce additional output(产生附加输出)由用户指定产生输出的附加时刻。选择该项
后，右边会产生输出时刻编辑框，在此可以输人附加时刻向量。这种输出方式在仿真计算时改变
步长和指定的附加输出时刻相一致。
③ Pioduce specified outpat only(仅在指定的时刻产生输出) 仅仅提供在指定的时间点上的
输出值。当要比较同一个模型采用不同的仿真方法所得到的结果时，使用这一选项可以产生在
一些共同时间点上的输出。
2.Workspace /O选项卡设置
Workspace1/0选项卡如图9.12所示。
Simim Fr 厂顾口
okapcsuo| Dipe*tWul
Lzalhammtsp C
厂 rot 口T d
lsn e
ROmt o
FS|n
ien
tlnt romm
Dndmcre
fonk Man
OK H
图9.12 Wkapwe 10选项卡
(1)从工作空间中载人数据(Load from workapace)
在仿真过程中，如果模型中有输人端口(Im模块),可从工作空间直接把数据载入到输人端
口，即先选中Iaput复选框，再在后面的编辑框内输入数据的变量名。变量名的输人形式有许多
种，下面对各种形式分别介绍。
①矩阵的形式。如果以矩阵的形式输人变量名，则矩阵的列数必须比模型的输人端口数多
一个，MATLAB把矩阵的第一列缺省为时间向量，后面的每一列对应每一个输人端口，矩阵的第
一行表示某一时刻各输入端口的输人状态。另外，也可以把矩阵分开来表示，即MATLAB缺省的
表示方法(r,u),t是一维时间列向量，表示仿真时间；x是和：长度相等的n维列向量(n表示输
入端口的数量),表示状态值。例如，在命令窗口中定义：和n:
101:10;
=[,t.0,5,1.-2]
第9章 MATLAB环境下的仿真软件Simubnk ·231·
则3个输入端口输入的数据与时间的关系分别为：等于1、等于：的开方和等于：的平方，用图
9.13所示的模型的输出可观察各输入端口的输入数据曲线。
②包含时间数据的结构形式。对于包含时间数据的结
构，在MATLAB中有非常严格的规定，即在结构中必须有两个
名字不能改变的顶级成员：time和signals。在time成员中包含
一个列向量，表示仿真时间；在signals成员中包含一个数组，
数组中的每个元素对应一个输入端口，并且每个元素必须包
含一个名字同样不能改变的 values成员，values 成员也包含一
个列向量，对应于输人端口的输入数据。例如，对于上例，若
改为包含数据的结构输入，则命令格式如下：
In1 Sope
2
In2 Soope1
3
In3 Scope2
t=1:10; 图9.33 系统模型
A.time=t
A.signals(1).values=t;
A.signals(2).values=t.0.5;
A.signals(3).values=t.^2;
在编辑框内输入A,则产生的仿真曲线与上面矩阵形式数据输入后的输出曲线完全相同，读
者不妨自己试一试。
在一般的结构中，time成员可以为空，但是必须要有time成员。对于上面的例子，若把time
域置为空，应输人：A.time=[],Simulink 根据输入端口的模块参数设置中的采样时间来读取数
据，所以，在Inl,In2等的设置输入端口参数对话框中的采样时间(Sample Time)项时必须输入确
定的时间值，不能用默认的“-1”来选用动态方式；同时内插数据(Interpolate data)前的复选框不
能被选中。
③综合形式。在综合形式中，可以把包含时间数据的结构和不包含时间数据的结构分别输
入到不同的端口，即为上面两种结构形式的综合。
在Input的下面，还有一个Initial state的复选框，它表示的是模块的初始化状态。对模块进
行初始化的方法是：先选中Initial state复选框，然后在后面的编辑框中输入初始化数据的变量
名，对干变量要求的几种形式，与前面的输入端口数据的变量形式基本相同，但变量中的数据个
数必须和状态模块数相同。
(2)将输出保存到工作空间(Save to workspace)
在Save to workspace区域中，可以选择的选项有：Time(时间)、States(状态)、Output(输出端口)
和 Final state(最终状态)。同载人数据的形式一样，保存数据也有矩阵、包含时间数据的结构和
综合结构几种形式，在Save options区域中的Format 下可以根据需要进行选择。对于不同的形式
来说Time的格式是不变的，总是对应仿真的采样时间。下面介绍一下其他几个选项在不同形式
下的变化情况。
①矩阵形式。在使用矩阵的形式时，State输出的也是矩阵，每一列对应一个模块的状态值，
每一行对应一个时刻各个模块的状态值；Output输出的也是矩阵，矩阵行列的意义与 States相似，
但它只能是输出端口即Output的值，如果模型中没有输出端口，则Output 不能生成矩阵；Final
state同样也是输出矩阵，但输出的矩阵只有一行，表示每个模块的最终状态。
232 应 用 篇
②包含时间数据的结构形式。同载入数据时介绍的一样，结构包含两个顶级成员：time 和
kigmalsstime成员为一个列向量，表示仿真时间；signals成员包括一个子结构数组，子结构的个数
应该等于状态模块(States和Final stute)或输出端口(Output)的个数。每个子结构含有3个成员：
values,label和blockNamee values成员是一个向量，对于Sutes而言，它表示状态模块的数据；对于
Final state面言，它表示状态模块的最终数据；对于Output 而言，它表示输出端口的数据。Iabel成
员是一个字符串，对于States和Final state,其内容是Cstate(连续系统模块)或 Dstate_n(离散系统
模块),n表示相应模块中有n组离散状态；对于Output,其内容是模块间连线上的信号标注。
blockName成员是一个字符串，表示相应模块的名称。
③综合形式。和载入数据相似，可以把每个输出端口包含时间数据的结构和不包含时间数
据的结构一起输出，而此时signals成员中的数组只有一个元素。
(3)保存选项(Save options)
Save options区中的Fomat选项前面已经介绍过了，而另外两个参数Linit ows to last和 Deci mation分别表示限定和选择。Limit rows to last用来限定保存到工作空间中的数据的最大行数：
Decimation是指从每几个数据中抽取一个，如在编辑框内输入4,则表示输出数据时，每4个数据
取一个，也就是每隔3个数据取1个数据。
3.Diagnostics选项卡设置
Diagnostics选项卡如图9.14所示。
Silstis Tts 4 口回区
2clvewokipocewaovinea
A1gericIo中 min tep ie violatcn
jDneoapectef block input
Varning Yarning
unearnected B10ck output Cncontiected line
Varming Hcming
-sple tis in souce
bst gwerelew
arning Vaning achiny
Oplbs
Douslry thesig ot
厂0mle国ttrgdleoion
Dkath aqufnstdthkLO soiso
F Fielae lodtnfoe chadrolnum
D Lr He
图9.14 Diagsostics 选项卡
在Diagnoetics选项卡中，主要是指定系统对一些事件或仿真过程中可能遇到的情况做出什
么反应，反应的类型有以下几种：
(1)Noae 不做任何反应，不影响在任何情况下的程序运行。
(2)Waming 提示警告，但警告信息不影响程序的运行。
第9章 MATLAB环境下的仿真软件Simulink ·233·
(3)Eror 提示错误，在提示错误后，运行的程序将停止。
Diagnostics选项卡中列出了各种可能产生错误的项，用户可以选中任何一项后，在右边的
Action 中根据程序需要进行选择。在对话框下的Consistency checking表示一致性检验，如果选择
on,系统会进行一致性检验；如果选择 off,则系统不会进行一致性检验。一致性检验主要是保证
模块对一个固定的时间的输出不变，在解决刚性问题中，一致性检验很重要，但由于一致性检验
会使系统的性能大大地下降，所以一般情况下，建议把这一项设为off。
(4)Disable zero erossing detection 表示是否进行零交叉检验。选中时为否，不选时为是。进
行零交叉检验会大大提高仿真精度，但速度会相应地下降。
(5)Disable optimized block I/0 storage 表示是否进行VO优化存储。当进行优化存储时，会
节省大量的内存空间，因此，在进行大型的模型仿真时，最好进行优化存储。
(6)Relax Boolean type checking(2.x compatiblc)表示放宽对逻辑数据类型的检查，以与
Simulink 3.0以下的版本相兼容。当选取这一项时，系统会允许把 double类型的数据当作逻辑类
型进行操作。
4.Real-Time Workshop选项卡
Real-Time Workshop作为Simulink 3.0的一个重要功能模块，是一种实时开发环境，可以直
接从Simulink的模型产生可移植的程序源代码(C语言或Ada语言代码)并自动构造出能在多种
环境中(包括实时系统和单机仿真)实时执行的程序。通过Real-Time Workshop 可以在远程处理
器上实时运行仿真模型，也可以在主机或外部计算机上运行高速单机仿真。限于篇幅，本书不做
深人讨论，读者可参考有关书籍。
9.3.2 在命令窗口设置仿真模型参数
前几节中介绍了使用菜单命令进行仿真和参数设置的方法，可以看出它主要有以下几个优
点：
(1)可以直接设置和修改很多仿真参数，包括仿真时间、算法、仿真步长，等等。
(2)可以同时对几个系统进行仿真。
(3)可以实时监视连线上传输的数据。
(4)可以方便地修改各个模块的参数。
而本节将要介绍的方法是在命令窗口输人函数进行仿真，它虽不及菜单命令简便、直观，但
在下述两个方面，它是菜单命令不能替代的：
①可以仿真M文件、MEX文件(用C或FORTRAN 编写的可以被MATLAB调用或执行的动
态链接子程序)模型。
②从M文件中直接进行仿真。允许仿真和模块参数反复改变，或者在设定的条件下开始或
停止仿真。
从命令窗口运行仿真的函数有4个，即：sim、simset、simget和set _param。
1.sim 函数
sim函数的作用是运行一个由 Simulink 建立的模型。其调用格式为：
[t,x,y]=sim(modname,timeapan,options,data);
其中：表示仿真的时间向量。x表示状态模块的状态矩阵。y表示仿真的输出矩阵，每一列对
·234· 应 用 篇
应一个输出端口的输出数据。modname 指定模型的名字，用单撇号括起来。timespan用于指定仿
真时间区间，有3种格式：[tFinal]指定仿真停止时间，仿真开始时间缺省为0;[tStart tFinal]指定
仿真开始和停止时间；[tStart OutputTimes tFinal]指定开始时间，要输出的时间点和停止时间。op tions是由simset 函数(后面将介绍)设置的仿真参数，数据格式为结构。data是外部输人到输人
端口数据。如果输入到所有端口，则data可以是矩阵或结构；如果是输人到单个端口，则data只
能是结构。
这些参数中只有modname是必须的，当其他参数没有设置时，系统会自动以Simulink Parame ters 中设置的参数值为准。
1
Out1 Sine Wave Transfer Fon
5 11 2
Out2 Sine Wave1 Integrator
图9.15 仿真模型 Simul
对于如图9.15所示的仿真模型 Simul,我们来比较一下用不同的参数调用sim 函数的含义。
(1)在命令窗口输人：
[t,x,y]=sim(' Simul')
这时在MATLAB命令窗口用 whos命令来查看工作空间中的变量，结果如下：
Name Size Bytes Class
t 205xl 1640 double array
x 205x3 4920 double arT8)
xFinal 1x3 24 double arra)
y 205x2 double array 3280
状态矩阵x有3列表示模型 Simul中含有3个状态向量，模块 Integrator含有一个状态向量，
而Transfer Fen含有2个状态向量，这是因为它是二阶传递函数。而输出矩阵y有两列，对应着
输出口Out1和Out2的值。
(2)指定仿真开始时间、停止时间和中间输出数据的时刻：
{t,x,y]=sim('Simul',[2,8]) ??问范围为2s~8s
[t,x,y]=sim('Simul',[2,4,6,8]) 呢只在4个指定的时刻(包括开始和停止时间)有值
2.simset 函数
simset 函数用来为sim函数建立或编辑仿真参数或规定算法，并把设置结果保存在一个结构
变量中。它有如下4种用法：
(1)options=simset(property,value,…)把property 代表的参数赋值为 value,结果保存在结构
options中。
(2)options=simset(old_opstruct,property,value,…)把已有的结构old_opstnuct(由simset产
生)中的参数property 重新赋值为 value,结果保存在新结构oplions中。
第9章 MATTAR环境下的仿真软件Simulink ·235·
(3)options=simset(old_opstruct,new_opstruct)用结构 new_opstruct的值替代已经存在的
结构old_opstruct的值。
(4)simset 显示所有的参数名和它们可能的值。
simset 函数可设置的参数和可能的取值如下：
(1)Solver属性。该属性指定仿真算法，取值是一个字符串。可以取的值有：ode45、ode23、
odel13、ode15s,ode23s 、FixedStepDiscrete、ode5、ode4、ode3、ode2、odel。
(2)RelTol属性。表示相对误差容限(Relative error tolerance),缺省值le-3。仅对于变步长
算法有用，适用于所有状态变量。
(3)AbsTol属性。表示绝对误差容限(Absolute error tolerance),缺省值le-6。仅对于变步长
算法有用，适用于所有的状态变量。
(4)Refline 属性。表示输出细化因子，缺省值1。若设置了Output potiors 参数(参数值不是
all),则此项设置被忽略。
(5)MaxStep属性。表示最大步长，只对应变步长算法，缺省值auto。
(6)InitialStep属性。表示初始步长，只对应变步长算法，缺省值auto。
(7)MaxOrder属性。表示odel5s算法的最大阶数，只对应算法ode15s,缺省值5。
(8)FixedStep属性。表示固定步长，只对应变定步长算法，如果模型中有离散状态，缺省值
为基本采样时间，否则缺省值为仿真时间隔的1/50。
(9)Outputpoints属性。表示输出数据点，取值为字符串格式，指定缺省值specified时，算法只
产生在timespan中指定的时间点的值，指定 all时，输出还会包括算法的时间步长所对应的值。
(10)OutputVariables属性。表示设置输出变量，取值为字符串格式。如果在设置的字符串中
没有t,x,y,则返回的t,x或y值为空阵。
(11)SaveFormat属性。表示设置保存的状态和输出的数据格式，取值为字符串格式，缺省值
是Matrix。
(12)MaxRows属性。表示限定输出的最大行数，缺省值为0。
(13)Decimation属性。设置抽选系数，即在几个数中抽取一个，缺省值为1。
(14)Initialstate属性。表示确定连续或离散模块的初始状态值，缺省为空向量。
(15)FinalStateName属性。表示确定一个变量名用来在仿真结束后保存状态模块的状态值，
取值为字符串格式，缺省为空。
(16)Trace属性。Trace包括minstep、siminfo、compile几个参数。其中参数minstep 表示在变
步长算法的仿真过程中，当某一步不能满足误差限时就停止仿真并提示错误；参数siminfo 表示
在仿真开始时显示一个简略的仿真系数总结；参数compile表示对模块的编译过程。
(17)SreWorkspace属性。指定在哪个工作空间计算模型中定义的MATLAB表达式的值，取
值为字符串格式，可能的取值有：base、current、parent。缺省值为base(基本工作空间，指MATLAB
命令窗口)。
(18)DstWorkspace属性。指定在哪个工作空间为模型中定义的变量赋值，取值为字符串格
式，可能的取值有：base、current、parent。缺省值为current(当前工作空间)。
(19)ZeroCross属性。允许或不允许零交叉检验，零交叉检验只对应于变步长算法，取值为
字符串格式，可能的取值有：on、off。缺省值为on。
·236· 应 用 篇
例9.1 以图9.15所示的仿真模型为例，说明simset 函数的用法。
(1)在命令窗口输人命令：
option= simset(' OutputVariables',x','OutputPoints','all',' Finalstate.Name',' date');
[t,x,yl=sim( Simul',[1.10,option)
t=[]
x=
0 0 0
0.0002 0.0000 0.0002
0.0012 0.0000 0.0012
0.0062 0.0000 0.0062
0.0311 0.0006 0.0317
0.1520 0.0143 0.1654 …… …… ……
y=[]
可见，在simset 函数中没有出现的参数为空值，而出现的参数无论是缺省值还是设定值都可
以显示出米。
(2)在命令窗口中输人命令：
optionl=simset('OutputVariables'.'xy','OutputPoints','all');
[t,x,y]=sim('Simul',[2,4,6,8],optionl);
t=[2468}
x=
0 0 0
0.6051 0.2375 0.1956
-0.0950 0.4792-1.3763
1.4455 1.5579 -0.2706
y=
00
0.6051 0.2375
0.4792 -1.3763
1.5579 -0.2706
可见，此时表示仿真的时间问量、状态模块的状态矩阵以及仿真的输出矩阵均显示出来。
3.simget函数
simget 函数用来获得模型的参数设置值。如果参数值是用一个变量名定义的，simget 返回的
也是该变量的值而不是变量名。如果该变量在工作空间中不存在(即变量未被赋值),则simulink
给出一个出错信息。该函数有如下3种用法：
(1)struct= simget(modname)返回指定模型的仿真参数设置(结构)。
(2)value=simget(modname,property)返回指定模型参数property的值。
(3)value=simget(Option Structure,property)获取结构OptionStnucture中参数property的值如
果在该结构中未指定该参数，则返回一个空阵。
用户只需输人能够惟一识别它的那个参数名称的前几个字符即可。对参数名称中字母的大
第9章 MATLAB环境下的仿真软件 Simulink ·237·
小写不做区别。
4.set param函数
set_param 函数的功能很多，这里只介绍如何用set_param函数设置Simulink仿真参数以及
如何开始、暂停、终止仿真进程或者更新显示一个方块图。
(1)设置仿真参数
调用格式为：
set_param(modname,propery,vatue.…)
其中 modname为设置的模型名，property为要设置的参数，value是设置值。这里设置的参数可以
有很多种，而且和用simset 设置的内容不尽相同，相关参数的设置可以参考有关资料。
(2)控制仿真进程
调用格式为：
set_param(modname,' SimulationCommand',' cmd')
其中 modnume为仿真模型名称，而cmd是控制仿真进程的各个命令，包括start、stop、pause、contin ue或 update。
在使用函数的时候，需要注意必须先把模型打开。仍以前面提到的模型Simul为例，首先把
模型打开，然后调用如下函数：
set_param(' Simul','StarfTime','10','StopTime','20')
set_param('Simul','SimulationCmmand','start')
这时模型就会开始仿真。
这一节中介绍了系统仿真的两种方式：菜单命令的方式简便直观，易于使用，但不够灵活；从
命令窗口输入函数的方式比较复杂，但它可以很灵活地用于M文件或MEX文件中，这样就可以
编制结构比较复杂的程序，仿真过程可以在各种流程中调用。
下面介绍连续系统建模及仿真应用实例。
例9.2 假设从实际应用领域(力学、电学、生态或社会)中，抽象出有初始状态为0的二阶
微分方程x”+0.2x'+0.4x=0.2u(t),a(t)是单位阶跃函数。用积分器直接构造求解微分方
程的模型exml.mdl并仿真。
步骤如下：
(1)改写微分方程。把原方程改写为
x"=0.2u(t)-0.2x'-0.4x
(2)利用Simulink 模块库中的标准模块构建模型。利用积分模块构造微分方程求解模型的
核心思想是：x"经积分作用得x',x'再经积分模块作用就得x,而x'和x经代数运算又产生x"。构
建的模型如图9.16所示。
在构建模型过程中，对各模型块进行了如下配置：
①u(1)输入模块 它的 step time被设置为0,模块名称由原来的step 改为u(t)。
②Gs增益模块 增益参数Gain设置为0.2。
③求和模块 其图标形状 lcon shape选择 rectangular,使模块呈矩形。符号列表 List of signs
设置为+-。
④积分模块 只是把它们的名称分别改变为Int1,Int2。
·238· 应 用 篇
0.2 ◆ x"
u(t) Gs --5 ×
1-s x
G1 Int1 int2 Scope
02 G2
0.4
x_t
Clock ToWorkspace
图9.16 求解微分方程的 Simulink模型
⑤G1和G2增益模块 它们的方向旋转可借助 Fomat菜单中的Rotate Block 命令实现。
⑥ Scope示波器 先双击该模块，出现示波窗；单击示波窗第6个工具按钮，引出属数设置
界面；在Data history选项卡中，选中Save data to workspace。这将使送入示波器的数据同时被保存
在MATLAB基本空间的缺省名为ScopeData的结构矩阵中。
⑦ Clock模块 产生仿真时间数据，仅供To workspace 模块用。
⑧ Mux模块 模型中的位移数据x与时间数据t组合成向量。
⑨ To workspace模块 专为演示而设置。位移数据x与时间数据t将以x-t名称存放在
MATIAB工作空间。
⑩模型窗 exm1.mdl 选中 Simulation菜单中的Parameters 命令，打开仿真参数设置窗口。在
Solver选项卡中，把仿真的停止时间Stop time设置为20。又为演示需要，在Workspace I/O选项卡
中，选中Time和States栏，使模型仿真中产生的时间数据以 tout,状态以xout 名称保存在MATLAB
工作空间。
(3)仿真操作。双击示波器图标，打开示波窗。选择模型窗中Simulation菜单中的Start 命
令，就可在示波窗中看到位移x的变化曲线。
(4)保存在MATLAB工作空问中的数据。为演示起见，同时采用如下3种独立途径向MAT LAB基本空间存放仿真数据：
①示波器模块向工作空间存放结构数组 ScopeData。
② To workspace模块以选定的矩阵方式向工作空间存放数组x-t。
③模型窗的1/0选项卡，以 tout、xout名称存放数据在工作空间。
注意：用户在实际使用时，可据具体环境，采用以上任何一种方法保存仿真数据。换句话说，
以上3组数据中的任何一组都可独立地供用户进一步分析时使用。
例9.3 利用传递函数模块建模。
不失一般性，仍以下面的二阶微分方程为例。假设初始状态为0,n(t)是单位阶跃输入。
x"+0.2x'+0.4x=0.2u(t)
对方程两边施行拉普拉斯(Laplace)变换，得
s2X(s)+0.2SX(s)+0.4X(s)=0.2U(s)
经整理得传递函数
c(s)=s)+0.2+0.4
第9章 MATLAB环境下的仿真软件Simulink ·239·
于是根据此式，就可以用Simulink库中的传递函数模块构建求解微分方程的模型。步骤如下：
(1)根据系统传递函数构造如图9.17所示的模型exm2.mdl。
Step
0.2
2+02s+0.4
Ttansfer Fon Scope
图9.17 由传递函数模块构成的仿真模型
在模型构造过程中，对各模块进行了如下操作：
①U(S)模块 设置Step time为0。
②G(S)模块 双击标准模块，引出对话框；在分子、分母栏中填写所需的系数。
③在exm2模型窗中，选Simulation 菜单中的Parameters 命令，打开仿真参数设置窗。在
Solver选项卡中，把仿真的停止时间 Stop time设置为20。在Workspace I/O选项卡中，把初始状态
设置为(0;0)。
(2)仿真操作。双击 Scope模块，打开示波窗，再选中Simulation菜单中的Start 命令，就可看
到位移波形。
例9.4 利用状态方程模块建模。
仍以二阶微分方程x"+0.2x'+0.4x=0.2u(t)为例。
若令x?=x,x?=x',那么微分方程x"+0.2x'+0.4x=0.2u(t)可写成
=|-0.4-0.2+10.2a(c)
写成状态方程为
=Ca+D
A=|-0.4-0.21,B=0.2.c=1 ol.D=0。可以是任意形式的输入。 式中
在Simulink库中有标准的状态方程模块可供调用。假设输入的函数u是单位脉冲函数
8(t),研究该系统的位移变化。
(1)单位脉冲函数的数学含义及近似实现。单位脉冲函数在数学上定义为
t≠a
像其他物理体系中不存在理想单位脉冲一样，Simutimk库中也没有现成的单位脉冲标准模
块。为此，必须采用某种近似方法产生。单位脉冲近似构建的思路是，用一个面积为1的“窄高”
脉冲近似。近似脉冲宽度的选择要考虑两方面的因素：脉冲宽度应远小于被研究系统的最快动
态模式(如特征根的实部)。脉冲宽度不能太小，以免引起严重的圆整或截断误差。由于本系统
特征根的实部绝对值为0.1,所以取脉冲宽度为0.01,幅度为100。即8(t)= 100u(t)-100u(t
-0.01)。
(2)利用库模块构造如图9.18所示的仿真模型 exm3.mdl。
应 用 篇
u1
lum
Sta A+Bu y-C+Du
85 Soop
2
图9.18 用状态方程模块构成的仿真模型
在构建模型时，对各模块进行了如下操作：
①ul模块。它的阶跃时间Step time 设置为0,(最)终(幅)值为100。
②u2模块。它的阶跃时间 Step time 设置为0.01,(最)终(幅)值为100。
③Sum求和模块。符号列表填写+。
④SS状态方程即state space模块。A,B,C,D栏依次填定[0,1:-0.4,-0.2].[0,0.2],LI.
0],0。
选中模型窗口 Simulation 菜单中的Parameters 命令，打开仿真参数设置窗口。在Solver选项
卡中，把仿真的停止时间 Siop time设置为20。
(3)执行仿真操作，仿真结果见图9.19。
图9.19 仿真结果
9.4 子系统的建立与封装
当模型较大或者较复杂时，可以把几个模块组合成一个新的模块，并且新模块能够完成几个
模块的功能，那么这样的模块称为子系统。子系统的优点是：减少系统中的模块数目，使系统易
于调试，而且建立的子系统具有完整的功能，可以在其他模型中直接作为模块使用。
9.4.1 子系统的建点
建立子系统有两种方法：通过 Subsystem模块建立子系统和通过已有的模块建立子系统。两
者的区别是：前者先建立子系统，再为其添加功能模块；后者先选择模块，再建立子系统。下面就
·240
第9章 MATLAB环境下的仿真软件Simulink ·241·
这两种方法分别进行讨论。
1.通过Subsystem 模块建立子系统
操作步骤为：
(1)先打开Simulink 模块库浏览器，新建一个仿真模型。
(2)打开Simulink 模块库中的Signals & Systems模块库，复制Suhsystem模块到新的模型窗口
中。
(3)用鼠标左键双击Subsystem模块打开一个空白的Subsystem窗口，将要组合的模块添加到
该窗口中，另外还要根据需要复制一个或多个Input和Output 模块，表示子系统的输人和输出端
口。这样，一个子系统就建好了。
例如，将积分模块和微分模块组合建立一个子系统，子系统的模型和子系统模块的图标分别
如图9.20和图9.21所示。
1
In1
du/dt 1
S
1 Int Outf
Out1 Derivative Integrator SubSystem
图9.20 子系统的模型 图9.21 子系统模块的图标
2.通过已有的模块建立子系统
操作步骤为：
(1)先选择要建立了系统的模块，不包括输入端口和输出端口。
(2)选择模型窗口 Edit菜单中的Create Subsystem命令，这样，子系统就建好了。在这种情况
下，系统会自动把 Input模块和Output模块添加到子系统中，并把原来的模块变为子系统的图标。
9.4.2 子乐统的条件抗行
子系统的执行可以由输人信号来控制，用于控制子系统执行的信号称为控制信号，而由控制
信号控制的子系统称为条件执行子系统。在一个复杂模型中，有的模块的执行依赖子其他模块，
这种情况下，条件执行子系统是很有用的。条件执行子系统分为：使能子系统、触发子系统和使
能加触发子系统。
1.使能子系统
使能子系统表示子系统在由控制信号控制时，控制信号由负变正时子系统开始执行，直到控
制信号再次变为负时结束。控制信号可以是标量也可以是向量。如果控制信号是标量，则当标
量的值大于0时子系统开始执行。如果控制信号是向量，则向量中任何一个元素大子0,子系统
将执行。
建立使能子系统的方法是：打开 Simulink 模块库中的 Signals & Systems 模块库，将 Enable模
块复制到子系统模型中(如图9.22所示),则系统的图标发生了变化(如图9.23所示)。
下面通过一个实例说明使能子系统的工作原理。
例9.5 利用使能子系统构成一个正弦半波整流器。
操作步骤如下：
+242 应 用 篇
1 du/at
1n Denvatwe 几 日ntsgrator
1
In1
几
n o41 1
Ouf
Enable Subsystem
图9,22 使能子系缆 图9:23 使能子系统的碳块图标
(1)打开Simulink模块库浏览器以及新建一个模型窗口。将模块库测览器中的 Sinewave.
Suhsystem和Scope 3个模块拖至新建的模型窗口。
(2)双击空子系统模块Subsysten,打开其结构模型窗。
(3)将Simulink 浏览库中的1o模块、0mt模块、Enable 模块拖至子系统的结构模型窗。把In
模块的输出直接送到Out模块的输人端，Enable模块无须进行任何连接，且采用它的缺省设置实
现使能子系统。
(4)按图9.24完成新建模型窗口中各模块间的连接并存盘。
π
n?n
Out
Enabl
1
Sine Wawe SwbSystem Seope M1
(@)半波整波核型 (i0使须于系梳结悔
图9.24 利用使重子系统实现半波整流的仿真模型
(5)双击示波器模块，打开显示窗。然后选择 Simulink菜单中的Suar 命令，就可看到如图
9.25所示的半波整流波形。
说明：
(1)使能子系统外观上有一个“使能"控制信号输入口。“使
能"是指：当且仅当“使能”输入信号为正时，该模块才接收Ia输
入端的信号。
(2)使能子系统建立好后，要对Enable 模块进行参数设置。
双击 Fnabile模块打开多数对话框。选中复选框 Shuw ouput pon 愿9.25 半波整流仿真波形
后，可以为 Enable模块添加一个输出端，用以输出控制信号。在States when erabling选项列表框
中有两个选项：held和ese,Held 表示当使能子系统停止输出后，输出端口的值保持最近的输出
值；nse表示当使能子系统停止输出后，输出端口重新设为初始值，在此选择reset。对设置完的
系统模型即可进行仿真。
2.触发子系统
触发子系统是指当触发事件发生时开始执行子系统。与使能子系统相类似，触发子系统的
建立要把Signabs &Systens模块库中的Trigger模块拷贝到子系统中。
例9.6 利用触发子系统将一锯齿波转换成方波。
操作步骤如下：
第9章 MATLAB环境下的仿真软件 Simuink 243+
(1)仿上例步骤，用Sigmal Geoeraor,Siuheystem和Scope模块构成如图9.26所示的子系统，双
击Signal Generator模块图标在Wave frm的下拉列表框中选择sawoob,即锯齿波。
5
0000
00
t
 ou1 Tigor
Signal
enator SubSystem Seape Outt
(将影齿皱转换为方该的模型 ()触发子系统结愧
图9.26 利用触发子系统将锯齿波转换为方皱
(2)将上例中的 Enable模块换成 Triger触发模块。双击该模块并选Thger type 触发事件形
式为either,即上跳沿或下跳沿触发。
(3)按图9.26完成新建模型窗口中各模块间的连接。井存盘。
(4)双击示波器模玦，然后选择Simulik菜单中的 sart 命令，就可看到图9.27所示的方波。
图9.27 将锯病被转换为方波的仿真结梁
说明：
(1)触发子系统外观上有一个“触发”控制信号输入口。子系统一旦被触发，在每次触发结
束到下次触发之前总是保持上一次的输出值，面不会重新设置初始输出值。
(2)触发形式由子系统内的触发模块对话框中Trigger type的下拉列表框选择：
rising(上跳沿触发)控制信号从负值或0上升到正值时子系统开始执行。
faling(下跳沿触发)控制信号从正值或0下降到负值时子系统开始执行。
either(上跳沿或下跳沿触发) 当控制信号满足上跳沿或下跳沿触发条作时，子系统开始执
行。
funion-call(函数调用触发)表示子系统的触发由 S函数的内部逻辑决定，这种触发方式
必须与8函数配用。
(3)双击Thgger模块后，还有一复选框 Show ouput,表示是否为Tnig模块漆加一个输出
端，选中后还可以选输出信号的类型。
3.使能加触发子系统
所谓使能加触发子系统就是把Enable和Tirgger模块都加到子系统中，使能控制信号和触发
控制信号共同作用子系统的执行，也就是前两种子系统的综合。该系统的行为方式与触发子系
统相似，但只有当使能信号为正时，触发事件才起作用。
·244 应 用：篇
9.4.3 子系洗的甜装
在对子系统进行参数设置时，需要打开其中的每个模块，然后分别进行参数设置，子系统本
身没有基于整体的独立操作界面，从而使子系统的应用受到很大的限制，为解决这些问题，
Simulink 提供了子系统封装技术。
所谓子系统的封装，就是为子系统定制对话框和图标，使子系统本身有一个独立的操作界
面，把子系统中的各模块的对话框合成一个对话框，在使用时不必打开每个模块进行参数设置，
这样使子系统的使用更加方便。
子系统的封装过程很简单：先选中所要封装的子系统，再选择模型窗口Edit 菜单中的Mask
Subsystem命令，这时将出现Mask Edior对话框(如图9.28所示)。
dit:tiu/Snksyl… 周道区
on hā Dopso
Mak sip
Drwgtaumund
bithWabe
bokospry f?pan
Fd
Diosng cod|Aaosat
DK Cnel Lnui pe
图9,28 Mask Ediboe 对话祗
Mask Editor对话框中共包括3个选项卡：lcon,Lniialization和Documentation。子系统的封装主
要就是对这3项参数进行设置，下面针对这3个选项卡来介绍子系统的封装。
1,Icon选项卡的参数设置
在lcon选项卡中主要设置封装模块的图标。Icon选项卡中包括两个编辑框：Mask type和
Drawing commands,以及几个设置封装图标特性的弹出式列表框(如图9.28)。其中Mask type 编
辑框在3个选项卡中都有，它表示封装的类型，而这种类型只有表示文字的意义，可以输入任何
字符串，输入的字符串将显示在封装模块对话框的顶部。下面将着重介绍 Drawing commands编
第9章 MATLAB环墙下的仿真软件Simulink 245
辑框和弹出式列表框的设置。
(1)Drawing commands 编辑框
该编辑框主要用来建立封装图标，并且可以在封装图标中显示文本，图形、图像或传递函数。
在封装图标中显示文本的函数有4个：dip,text、fprinti.por _lable。下面介绍port_lable函数
的用法。
pont_lable函数根据端口类型和端口号为端口添加标记。其调用格式为：
pont_lahle(' pon_type1.pon_num,"lable'):
以图9.29的触发子系统为例，在Drawing commands编辑框中输人如下命令：
1 还 Int AND
2 Logical in
1
Outt
Tbgger
In2 Dperator
图9.29 触发子系统
disp('LOGIC);
pon_label(' inpat',t.In+):
port label( inpnt'.2,'m2+);
pan _labelC' utpet,1:Ourt'):
则新生成的子系统图标如图9.30所示。
Pui
Generator
3
in1
2
In2
int
LOGIC 6t!
n2
Subsystem
图9.30 显示文本的子系统图标
在图标中显示图形可以用plot 函数。在图标中显示图像可以用image 函数。在图标中显示
传递函数使用dpoly 函数，其调用格式为：
① dpoly(A,B)
其中A为传递函数的分子向量，B为传递函数的分母向量。
② dpoly(A,B,'character
当显示的传递函数按x的降幂播列时，character的取值为x,按1/x升幂时取x-。
③ droose(z,p,k)
·246· 应 用 篇
表示显示零极点模型的传递函数，其中z为零点，p为极点，k为增益。
例如，输入如下命令：
dpoly([1,2],[2,3.4,'x')
生成的子系统的图标如图9.31所示。
(2)设置封装图标特性
在Drawing commands 编辑框下面的下拉式列表框中，可以分别对图标的
图9.31 显示传递 各种特性进行设置。
① Icon frame 设置图标外的边框。Invisible表示将边框隐藏，Visible表 函数的子系统图标
示显示边框。
卡
Inl x+2
Inz 2x2+4x+3Out1
Subsystem
②Icon transparency 设置图标的透明度。Transparent表示透明，显示图标中的内容。Opaque
表示不透明，不显示图标中的内容。
③ Icon rotation 设置图标是否跟模块一起翻转：Fixed表示不翻转，Rotates 表示翻转。
① Drawing coordinates 设置在Drawing commands 编辑框中使用命令plot和text时的坐标系。
Pixel表示图标以像素为单位，当模块大小改变时，图标不随之改变；Autoscale 表示规定图标的左
下角的坐标为(0,0),右上角的坐标为(1,1),要显示的文本等必须把坐标设在[0,1]之问才能显
示。当模块大小改变时，图标也随之改变；Normalized表示根据设定的坐标点自动选取坐标系，使
设置中的最小坐标位于图标左下角，最大坐标位于图标右上角。当模块大小改变时，图标也随之
改变。
2.Inítialization选项卡的参数设置
Initialization选项卡的参数设置对话框如图9.32所示。其中Mask type编辑框与前面介绍的
内容一样，在此不再赘述。本节主要介绍设置参数的提示符、变量名和初始化命令。
(1)提示符和变量名
Initialization选项卡中间的Variable和Prompt 编辑框分别用来指定用户需要设置的变量名和
它们的提示符。它们的作用是在封装子系统的参数对活框中提示用户设置什么内容和指定变量
来接受用户设置的内容。例如，要在子系统中设置两个变量：输入1(inl)和输人2(in2),则设置
的步骤为：
①在Prompt后的编辑框中输入提示符“输入1”,在Variable后的编辑框中输入变量名 inI。
②用鼠标左键单击对话框左上方的Add 按钮，则提示符“输入1”和变量名 inl都被加人到
列表中，同时编辑框Prompt和Variable变为空，此时可以继续输入其他提示符和变量名。
③待所有提示符和变量名都设置好了，单击参数设置对话框下面的OK按钮，再用鼠标左键
双击子系统模块，则出现设置好的子系统参数设置对话框。
注意：若需要改变提示符和变量名在封装后的子系统对话模型中显示的顺序，可以选中该行
后按下Up或Down按钮进行调节。
另外，参数Assignment 的设置也与变量有关。其选项有Evaluate和Literal两项：Evaluate 表示
用户输人的内容先由MATLAB进行计算，再把结果赋给相关变量；Literal表示用户输入的内容不
经过计算，直接把字符串的格式赋给相关变量。
(2)控制类型
控制类型是指控制封装后的子系统参数设置对话模型所提供的设置参数的方式。从图9.32
第9章 MATLAB环境下的仿真软件Smalink 247
ndituro untiued/Smbsst 回区
hoon iialbe 0oimersn
Md It
Pieni Tne Visb
Ads edE
入2 d
: ecepd ot prennter list>
Dom 国
Fiunct 入T nhe E
Veiubk m2 uym Evku
Iriidsbsncimrde
CK Lol Urm Hk Aun
图9.32 Initslizatian 选项卡
中Control type下拉式列表框可知控制类型有：
① Edit 选择该项时，为用户提供一个编辑框，通过编辑框可以设置参数的值或表达式。
② Checkbox 选择该项时，只提供一个复选框，选中与不选中复选框会返回不同的值。如果
参数Assignment 设为Evaluate,那么选中复选框时，返回值为1,不选中时，返回值为0:如果参数
Assignment 设为Literal,那么选中复选框时，返回值为on;不选中时，返回值为ol。
③ Popup 选择该项时，为用户提供一个弹出式菜单，并且 Popup string 编辑框会被激活，在
此输入弹出式菜单的各选项，选项之间用符号"I"分开。
如果参数Asignment 改为Evaluate,那么选中菜单中的某个选项时，返回值是该选项所在菜
单中的序号；如果参数Asignment 改为Literal,那么选中菜单中的某选项时，以该选项的字符串形
式作为返回值。
(3)设置初始化命令
初始化命令的设置在对话框下面的Initialization commands 编辑框内进行，在此输人初始化命
令，而这些初始化命令将在仿真开始、载人模型、更换模块图标和重设封装子系统的图标时被调
用。初始化命令主要用来定义封装子系统的变量，这些变量可以被所有封装定义的初始化命令，
封装子系统中的模块和绘制图标的命令所使用。
初始化的命令由MATLAB中的表达式组成，其中包括：MATLAB函数、操作符和封装子系统
工作区中定义的变量，但这些变量不包括基本工作区中的变量。
248 应 用 篇
对于封装工作区定义的变量，通过初始化命令和模块的参数相联系，也就是说模块的参数在
获取数据时，先读取封装工作区的变量值，再通过初始化命令来取值。
3.Documentation选项卡的参数设置
在Documentation 选项卡中(如图9,33所示)所要设置的内容除了前面已经介绍过的封装类
型外，还有描述文本和帮助文本。
k Eitor meJ/Subsyste*l M回区
koon inpin Docuneronh
Mas
Bbck datewlon
Bock how
OK Cred (mhd 8mo Aet
图9.33 Documentation选项卡
(1)Block descniption 编辑框
Block description编辑框中设置的内容将显示在封装模块对话框的上部，文本的内容一般是
对模块功能的描述，用户也可以根据自己的需要自行设置。
(2)Block help编辑框
Block help编轩框输人的内容为帮助文件，当按下封装子系统参数对话框的 Help 按钮时，将
显示输人的内容。
9.5 在命令窗口中创建模型
这一节将介绍构造仿真系统模型、设置模块参数和模型参数的另一种操作方式：使用命令编
写程序。这种方式虽然不像构造 Simulink 框图那样简便、直观，但它可以灵活地控制程序的流
第9章 MATLAB环境下的仿真软件Simulink ·249·
程，并且参数可以动态设置和修改，这种方式可以实现很多框图方式无法实现的功能。
9.5.1 构造模型的命令
在表9.7中列出了这些命令和它们的功能。命令的具体用法这里不再一一介绍，使用时请
参考在线帮助。
表9.7 构造模型的命令列表
命令 功 能 命 令
在系统中加入 ·个新模块
在系统中加入一条线
关闭一个系统窗口
获取根系统的名字
关闭一个系统窗口
从系统中删除模块
从系统中删除连线
查找系统、模块、连线或注释
获取当前模块的路径名
gcbh
gcs
get_param
new_system
open_system
replace_block
save_system
sct _param
simulink
功 能
add_block 获取当前模块的句柄
add _line 获取当前系统的路径名
bdelose 获取参数值
bdroot 建立一个新的Simulink 系统
close_system 打开一个存在的系统
delete_block 替换系统中的模块
delete _line 保存系统
find_system 设置参数值
gcb 打开仿真模块库
有很多命令需要指定Simulink 系统或模块，这需要同时指定它们的位置。有以下几种情况：
(1)指定一个系统 要指定包含该系统的文件名和文件的路径。
(2)指定一个子系统 要指定该子系统所处的系统和其上的各级子系统。假定需要指定的
子系统为subsystem,那么格式为：
system/subsysteml/ subsystem2/…/subeysterm
(3)指定一个模块 需要指定模块所处的系统和各级子系统。假定要指定的模块名为
block,那么格式为：
system/subsysteml/ subsystem2/…/subaystem/block
如果模块名不止一行，那么需要加人 sprintf(\n+)作为分行的标志。例如，如果要指定的模
块是Pulse Generator(脉冲发生器),那么如下命令可以获取模型MyMode中的Pulse Generator模块
的参数Period的值。
get_peram([' MyModel Puse',spintf(\a),'Geneator'],'Peniod)
有的模块名中含有斜线“/”,要指定该模块名时，需要把斜线重复一次。
9.5.2 设置模块参数
set_param函数用来设置仿真模型或模块的各种参数。模型参数用来设置模型的仿真参数、
打印选项、回调(callback)参数等内容。模型的回调参数设置在什么时候执行指定的回调程序。
前面曾介绍过利用set_param函数来设置仿真参数。下面介绍如何利用该函数来设置各种
模块参数，包括模块的通用参数、模块的特定参数、模块的回调(callback)参数。下面的命令设置
250· 应 用 篇
仿真的开始时间为10s,终止时间为100 s:
set_param(' MyModel','StarTime',10,' StopTime',100)
下面命令设置开始仿真时执行命令notebook:
set_param(' MyModel','StartFen',' notehook')
1.设置通用模块参数
通用模块参数指所有Simulink 模块都具有的参数。其中模块的回调参数和模型回调参数类
似，只不过它是用于每个模块而不是模型。例如，下面的命令为模型中的模块 Sine Wave 设置在
窗口中的位置：
set _param(['MyModel','/','Sine Wave'],' position',[20,20,60,80])
下面的命令使得当模块 State-Space被打开(双击鼠标左键)时，为其参数A赋3×3的随机矩
阵：
set_param([' MyModel',/, State-Space'].'OpenFcn',A=randn(3,3))
2.模块的特定参数
模块的特定参数指每个不同的模块特有的参数。Simulink 通用库下几个子库中的一些常用
模块具有特有的参数和取值，但封装模块不能用函数set_param 设置参数。
9.6 S-函数的设计和应用
9.6.1 S-函数概述
1.什么是S-函数
S-函数，也称之为系统函数(System Functions),是对动态系统的程序描述。掌握了S-函数
的设计，就可以充分发挥 Simulink的功能，否则，就只能用模块库里的功能模块去拼出模型，但这
往往是不能满足需要的。S-函数可以用MATLAB语言或C语言编写。用C语言编写的S-函
数被MEX 工具软件编译成MEX 文件。像其他的MEX文件一样，必要时，它可以与MATLAB动
态地链接。用MATLAB语言编写的S-函数就是一个M文件。
S-函数具有很通用的形式，它适用于连续的、离散的和混合的系统。因此，几乎所有的
Simulink 模型都可以用S-函数描述。
2.S-函数的用途
S-函数的主要用途在于，用户可以利用它创建一个新的通用模型，此模块可以在一个模型
中多次使用，而每次使用时，有关参数可以取不同的值。另外，由于S-函数可以用C语言编写，
所以可以把已有的C程序加到一个仿真程序中。
9.6.2 用M文件编写S-函数
用来定义一个S-函数的M文件，必须能提供系统模型的有关信息。在仿真期间，Simulink
需要这些信息。Simulink、ODE solver(常微分方程或者差分方程数值算法程序)和S-函数(M文
件)三者之间交互作用，可以完成一些特定的任务。其中包括：确定初始条件和模块的特性参数，
第9章 MATLAB环境下的仿真软件 Simulink ·251
计算导数值(连续状态变量的)、离散状态变量值以及输出变量值。
S-函数的设计步骤很简单，但是可以实现非常复杂的功能：
(1)写程序。程序的编写有一定的格式，MATLAB5.3为用户提供了一个模板，只要在必要
的子程序里编写代码并输入参数就可以了。
(2)从Function & Tables子库里把S-Function系统的功能模块复制过来，输入程序的文件
名，以供调用。
Simulink 提供了一个用M文件编写S-函数的模板。该模板程序存放在toolbox \simulink\
blocks目录下，文件名为Sfuntmpl.m。下面是把注释部分都去掉后的模板程序。
function[sys,x0,str,ts]= sfuntmpl(t,x,u.flag)
switch flag,
case 0.
[sys,x0,str,ta]=mdllnitializeSizes;
case 1,
sys=mdlDerivatives(t,x,u);
case 2,
sys=mdlUpdate(t,x,u);
case 3,
sys=mdOutputs(t,x,u);
case 4,
sys= mdIGetTimeOfNextVarHit(t,x,u);
case 9,
sys=mdlTerminate(t,x,u);
otherwise
eror(['Unhandled flag=',num2str(fag)]);
end
function [sys,x0,str,ts]=mdllnitializeSizes
sizes =simsizes;
sizes.NumConLStates=0;
sizes.NumDiscStates=0;
sizes.NumOutputs=0;
sizes.Numlnputs=0;
sizes.DirFeedthrough=1;
sizes.NumSampleTimes=1;
sys=simsizes(sizes);
x0=[];
str=[];
t8=[0,0];
function sys=mdlDerivatives(t,x,u,)
sys=[ ];
function sys=mdlUpdate(t,x,u)
sys=[];
·252· 应 用 篇
function·sys= mdlOutputs(t,x,u)
sys=[];
function sys= mdiGetTimeOfNextVarHi(t,x,u)
sampleTime=1;
sys=t+ sampleTime;
function sys=mdlTerminate(t,x,u)
sys=[];
模板程序共有6个子程序：
供Simulink在仿真的不同阶段调用。这些子程序的前缀为mdl。用M文件表示的S-函数，
其中设有一个标志参数flag,每一个flag值对应于S-函数中的一个子程序。每一次调用S-函
数时，都要给出一个flag值，实际上，它就是执行S-函数中与该flag值对应的那个子程序。
Simulink 在仿真的不同阶段，需要调用S-函数中不同的子程序。表9.8表明了这种对应关系，
其中有些子程序要多次地被调用。编写S-函数时，应该根据系统的实际需要，编写相应的子程
序调用语句及相应的子程序，并提供必要的参数。
表9.8 在S-函数中调用的子程序及其与Nag值的对应关系
仿真阶段 S-函数子程序
mdlInitializeSizes
mdDerivatives
mdlUpdate
mdlOutputs
mdlGetTimeOfNextVarHit
mdlTerminate
fag值
初始化 0
计算连续状态变量导数值 1
更新离散状态变量值 2
计算输出值 3
计算下一个采样时刻 4
结束仿真任务 9
mdlInitializeSizes子程序的功能是初始化。在S-函数运行之前，为了使Simulink 能够识别一
个用M文件编写的S-函数，用户必须向它提供该S-函数的有关信息：输人量、输出量、状态变
量的个数以及其他特征。
为了向 Simuliak 提供这些信息，在子程序mdlInitializeSizes的开始处，应调用simsizes 函数：
sizes= simsizes,这个函数返回一个不透明的size结构，其结构如下：
① sizes.NumContStates 连续状态变量的个数。
② sizes.NumDiscStates 离散状态变量的个数。
③ sizes.NumOutputs 输出的个数。
④ sizes.Numlnputs 输人的个数。
⑤sizes.DirFeedthrough 直通标志，是否设定为Direct feedthrough,取决于输出是否为输人的
函数，或者取样时间是否为输人的函数。
⑥sizes.NumSampleTimes 取样时间的个数，一般取1。
上述结构用sizes结构数组来存储，然后用simsizes 指令去读取。
S-函数的基本输入参数有4个：t,x,u和flag。其中：为仿真时间；x为状态向量(即使系
第9章 MATLAB环境下的仿真软件Simulink ·253·
统中没有状态变量，也要写x);u为输人向量；flag为标志参数，控制在仿真的各阶段调用S-函
数的哪一个子程序。
S-函数的基本输出参数也有4个，它们依次是sys、x0、str和 ts。其中sys为一个返回参数
的通用符号，它得到何种参数取决于flag值，比如flag=3,则sys 得到的是S-函数的输出向量
值；x0表示初始状态(如果系统中没有状态变量x0将得到一个空阵);str仅用于方块图同S-函
数API(应用程序编程接口)的一致性校验，对于M文件S-函数，它将被置一个空阵；ts是一个
两列矩阵，一列是S-函数中各状态变量的采样周期，另一列是相应的采样时间的偏移量，采样
周期按递增顺序排列，对于连续系统，采样周期和偏移量都应置成0。
例9.7 利用M文件来写一个限幅积分器的S-函数，并借助S-函数模块来调用此文件。
限幅积分器的数学模型如下
&={,其他，4<0或x≥,a>0
其中，x为状态值，n为输入值，lb和ub分别为积分的下限和上限。
操作步骤如下：
(1)根据数学模型，编写S-函数sfun97.m。
function [sys,x0,str,ts]=sfun97(t,x,u,flag,b,ub,xi)
switch flag,
case 0,
[ays,x0,str,ts]=mdllnitializeSizes(xi);
case 1,
sys=mdlDerivatives(t,x,u.b,ub);
case 2,
8ys= mdupdate(t,x,u);
case 3,
sys= mdlOutputs(t,x,u);
case 4,
sys=mdlGefTimeONextVarHit(t,x,n);
case 9,
sys=mdlTerminate(t,x,v);
otherwise
error(['Unhandled flag =',num2str(Aag)]);
end
function [sys,x0,str,ts]=mdlnitializeSizes(xi)
sizes =simsizes;
sizes.NumContStates=1;
sizes.NumDiscStates=0;
sizes.NumOutputs=1;
sizes.Numlnputs=1;
sizes.DirFeedthrough=0;
sizes.NumSampleTimes=1;
254 麻 用 箱
ys=simsinesl sizes);
a0=x
st=1]:
a-[0.0];
fauncioo sy=mdllDerivativeslL,xn,Ib,ub}
(xcmlu&n0)1(x>=wh&u>0)
sss=0;
ehe
8*u
d
functbon = mdlUpdatelt,x,n)
s=l
function sys=mdlOuputs(1,x,u)
98年8
hinctico ys=mdlGerTiaeOINeslVarHi(,x,)
amplrTime=1;sample,set the nest hit to be one sccond laer
sys=t+ sampleTimei
funetiun syw=mdlTenminate(t.,m)
y-
(2)完成S-函数的编写后，接着建立 Simulink模型，将功能模块S-funetion复制到设计区
域，打开其参数界面，输人S-函数的文件名 sfun97.m和S-函数的参数b、ub、xi,如图9.34所
示。最后完成的模型如图9.35所示。
LIock Fueters.S-ueti 区
:5Fircion
Uadainabitock.Bkooki my be wminM.CxFowan andm
conlumto5unclan sndset txund fag ae aublmshcaDedio
e9hirchan bySmirkEa paybe tpoolisdmh Sinclon patante fiet
Paanetent
(msti n
Afur27
S-fhetinptT
13
送 Cee p bpply Sin Wave
stun97
SFundion Scope
图9.34 SFiaction参数对话框 图9.35 调用S-Funcion的模型
(3)编写主程序。
clear;
h=-0.5:
uh=0.5;
xi=0;
第9章 MATLAB环境下的仿真软件Simulink ·255·
sim('sfum97');
(4)在命令窗口运行主程序，并双击示波器，即可查看到输人波形及限幅积分的结果。
上面的简单例子中没有状态变量。大多数S-函数要处理状态变量，可能是连续的或者是
离散的，也可能两者都有。
例9.8 试分别写出一个有连续状态变量的S-函数，一个有离散状态变量的S-函数和一
个混合系统的S-函数。
(1)一个有连续状态变量的S-函数csfunc.m。
function [sys,x0,str,ts]=csfunc(t,x,u,flag)
本S-函数定义一个用下列连续状态空间方程描述的系统
x1=Ax+ Bu
y=Cx+ Du
定义矩阵
A=[-0.09,-0.01;1,0];
B=[1,-7;0,-2];
C=[0,2];
D=[-3,0;1,0];
?配标志lag
switch fag
case 0
[sys,xO,str,ts]=madlnitializeSizs(A,B,C,D);
case 1
sys= mdlDerivatives(t,x,u,A,B,C,D);
case 3
8ys=mdlOutputs(t,x,u,A,B,C,D);
case |2,4,9{
sys=[];
otherwise
error([' Unhandled flag=',num2str(lag)]);
end
sfunc.m主程序结束
以下是子程序
function[sys,x0,str,ts]=mdllnitializeSizes(A,B,C,D)
?建 sizes 结构 sizes= simsizes;
sizes.NumContStates=2; 以下填充sizes结构
sizes.NumDiscStates=0;
sizes.NumOutputs=2;
sizes.Numlnputs=2;
sizes.DirFedthrough=1 ???不是空阵，y的表达式中含有u
sizes.NumSampleTimes=1
sys= simsizes(sizes); ??sizes结构的信息填充数组sys
x0= zeros(2,1); ??初始条件
·256· 应 用 篇
str=[];
18=[0,0}; ??例中采样时间是连续性的，故采样周期和偏移时间都设置成0
mdlInitializeSizes子程序结束
function sys=mdlDerivatives(t,x,u,A,B,C,D)
sys=A×x+B*u
返回连续状态变量的导数值
mdlDerivatives子程序结束
function sy8=mdlOutputs(t,x,u,A,B,C,D)
sys=C*x+D*u;
??回输出量
mdlOutputs子程序结束
山于这个S-函数的M文件csfunc.m已包含在Simulink 中，因此，普通的 阶微分方程组都
可以使用这个文件来建模。csfunc.m与内部模块 state-space类似。这个S-函数也可作为建立
一个具有时变系数的state-space模块的出发点。
(2)一个具有离散状态变量的S-函数 dsfunc.m。
function[sys,x0,str,ts]=dsfunc(t,x,u,fag)
??S-函数定义一个用下列离散方程描述的系统
?n+1)=Ax(n)+Bu(n)
?n)=Cx(n)+ Du(n)
??义矩阵
A=[-1.3839,-0.509;1.00.0];
B=[-2.5559.0;0,4.2382];
C=[0,2.076;0,7.7801];
D=[-0.8141,-2.9334;1.2426,0]
?配标志 Hag
switch flag
case 0
[sys,x0,str,ts]=mdilnitializeSizes(A,B.C,D);
case 2
sys= mdlUpdate(t,x,u,A,B.C.D);
case 3
8ys=mdlOutputs(t,x,u,A,B,C.D);
case {1,4,9
8ys=[]:
otherwise
error([' Uahandledflag=',num2str(lag)]);
end

sfunc.m主程序结束
以下是子程序
function[sys,x0,str,ts]=mdllnitializeSizes(A,B,C,D)
sizes = gimsizes; ?建sizes结构
第9章 MATLAB环境下的仿真软件Simulink ·257·
呢以下填充sizes结构 sizes.NumContStates=0;
sizes.NumDiscStates=2;
sizes.NumOutpul8=2;
sizes.Numlnputs=2;
sizes.DirFeedihrough=1;
sizes.NumSampleTimes=1;
sys=simsizes(sizes); ??sizes结构的信息填充数组sys
×0=ones(2,1); ??态初值
st=[;
ts=[1,0]; ??用周期1s,偏移量0
mdllnitializeSizes子程序结束
function sys= mdlpdates(t,x,u,A.B.C,D)
sys= A*x+B*u
mdiUpdate子程序结束
function sys= mdlOutputs(t,x,u,A,B.C,D)
sys =C*x+D*u;
mdlOutputs子程序结束
由于本S-函数的M文件dsfunc.m已在Simulink中，用户可以直接用它为一般的差分方程
组建模。这个S-函数与内部模块 Discrete state-space类似。用户也可以用它作为建立具有时变
系数的离散状态空间系统模型的出发点。
(3)一个混合系统的S-函数mixedm.m。
混合系统是指同时含有连续状态和离散状态的系统。处理混合系统是相当简单的，根据参
数fag的不同取值，正确地调用S-函数的连续部分或离散部分的子程序。
编写混合系统的S-函数(或者任何一个有多种采样周期的S-函数)应注意的一个问题是
Simulink在所有的采样时间点上，都要调用子程序 mdlUpdate、mdlOutput 以及mdlGetTime OfNextVarHit,这就要求在这些子程序中都应检测当前时刻(即仿真时间)是否是相应变量的采样
时刻，若是，则给出该变量的返回值，否则返回空阵，以表示该变量的值尚不变。之所以这样做，
是因为在混合系统中，连续状态变量的计算步长总是小于离散部分的采样周期，仿真时间是按照
连续状态变量的计算步长累计的。
1
n1 w一1 1
z
1
Dut1 Integrator Disarete
Transfer Fcn
图9.36 混合系统模型
图9.36是由一个积分环节和--个单位延迟环节组成的混合系统，它的S-函数M文件如下：
function [sys,x0,stz,ts]=mixdem(t,x,n,flag)
??个积分环节和一个单位延迟环节串联构成的混合系统
dperiod=1; ??置延迟环节的采样周期
doffset=0; ??置偏移量
·258· 应 用 篇
switch lag
case 0
[sys,x0,str,tsj=mdlnitializeSizes(dperiod.doffset);
case 】
sys=mdlDerivatives(t,x,u):
case 2
sys=mdiUpdate(t,x,u,dperiod, doffet);
case 3
sys=mdlOutpuls(1,x,u,dperiod,doffset);
case |4,9
8ys=[];
otherwise
error(['Unhandled flag=',num2str(lag)]);
end
mixedm.m主程序结束
以下是子程序
function [sys,x0,str,ts]=mdlnitializeSizes(dperiod, doffset)
sizes=simsizes;
sizes.NumContStates=1;
sizes.NumDise.States=1;
sizes.NumOutputs=1;
sizes.Numlnpus=1;
sizes.DirFeedthrough=0;
sizes.NumSampleTimes=2; ??用周期两种，连续状态和离散状态各一种
sys=simsizes(sizes);
x0=ones(2,1);
str=[ ];
ts=[0,0;dperiod,doffset]; ??续状态的采样周期填0,偏移量也填0。
初始化子程序结束
function sys=mdlDerivatives(t,x,u,dperiod, doffset)
sys=u;
求导数子程序结束
function sys=mdlUpdate(t,x,u, dperiod,doffset)
if abs(round((t-doffset)/dperiod)-(t-doffset)/dperiod)<1e-8
8ys=x(1);
else
8ys=[]:
end
以上是离散状态更新子程序。其中：是仿真时钟(按连续环节的计算步长累计仿真时间)的
当前值。如果t值减去偏移量之后与dperiod的整数倍的偏差小子dperiod*1e-8,则离散状态更
新，返回值为x(1),否则返回空阵，表示离散状态未变。
第9章 MATLAB环境下的仿真软件 Simulink ·259·
function sys=mdlOutputs(t,x,u,dperiod, doffset)
if abs(round((l-doffset)/dperiod)-(I-doffset)/period)<1e-8
8ys=x(2);
else
sys=[ ];
end
以上是S-函数输出向量值计算子程序。因为本例中，S-函数的输出即为离散环节的输
出，故离散状态更新，则输出量也更新，返回值为x(2),否则返回空阵，表示输出值未变。
9.6.3 S-画数的命合调用
在仿真过程中，S-函数要被 Simulink 多次调用。其实用M文件表示的S-函数就是一种具
有特殊调用格式的函数文件，因此用户也可以直接用MATLAB命令调用它。例如，用命令[sizes,
x0,xstr, ts]=sfilename([],[],[],0),调用名为 sfilename的S-函数，便可执行它的初始化子
程序(这里flag=0),从而获得该S-函数所描述系统的初始化信息——规模参数sizes、初始条件
x0、状态变量所在模块的路径xstr、采样周期及采样时间偏移量 ts。
如果把该S-函数所描述的系统另外用内部模块组成的方块图模型表示，并以名字flename
存盘。再输入MATLAB命令[sizes,x0,xstr,ts] = filename([],[],[ ],0)或[sizes,x0,xstr,
ts] = filename,则得到的结果与上一条命令相同，只是xstr不再是空阵了，它是一个由字符串元
素组成的列向量，各字符串依次表示模型中各状态变量所在模块的路径。这是因为 filename是
一种mdl文件，它包含了上述S-函数M文件的全部信息，当然也包括初始化信息。
9.7 仿真系统的线性化分析
在一般的非线性系统分析中，常常要在平衡点处提取线性模型。为了解决这一问题，
Simulink 提供了3个有用的函数：linmod、dlinmod和trim。本节将介绍如何使用这3个函数。
9.7.1 连续系统的线性化
线性化分析函数linmod用来提取非线性系统的近似线性模型。该线性模型可以表示为
=x+D
其中x是系统的状态向量，u是系统的输入向量，y是系统的输出向量。A,B、C,D是常数矩
阵，统称为状态空间矩阵。
linmod 函数的调用格式为：
[A,B,C,D]=linmod('sys')
[A,B,C,D]=linmod('sys',x,u)
[A,B,C,D]=linmod('sys',x,u,pert)
[A,B,C,D]=limmod('sys',x,u,pert,xpert,upert)
其中sys 表示需要线性化的模型名称。x和a分别代表状态向量和输入向量。如果定义这些
·260· 应 用 篇
量，那么就设置了工作点，并在这个点上提取线性模型。pert为可选标量，用来设置x和u的干
扰。如果这个值没有定义，就采样默认值le-5。xpert和upert 为可选向量，用来为每一个状态
和输入设置扰动。如果定义了这个向量，那么就忽略上面的标量pert,在这种情况下，状态x的
第i个元素受到扰动后就变成x(i)+ xpert(i);输入u的第j个元素受到扰动后变成u(j)+
upert(j)。
说明：
(1)linmod得到的是用常微分方程描述的Simulink 模型的线性模型，返回的模型是以状态空
间A,B,C,D形式来表示其输入和输出之间的关系，得到在状态向量x=0和输入u=0这个工
作点附近的线性化模型。
(2)linmod是在工作点附近对状态施加扰动后来确定状态导数和输出的变化速率(即雅可
比矩阵),并把得到的结果用来计算状态空间矩阵，每一个状态x(i)受到扰动后变成
x(i)+△(i)
其中△(i)=8(1+1x(i)1)。
同样，第j项输人受到扰动后，变成
u(j)+△(j)
其中△(j)=8(1+Iu(j)I)。
linmod 函数不仅可以获取非线性系统的近似线性模型，也可以用来获取线性系统的状态空
间模型。例如，从图9.37所示的线性系统提取状态空间模型。设系统模型名为exe9_2,命令如
下：
[A,B,C,D]=linmod('exe9_2')
命令执行后得到系统的状态空间矩阵
^-d.c-1小.D-[{9
Out1
1
n1 1
plant1
2
Ou2
Feedbadk
图9.37 线性系统模型
9.7.2 离散系统的线性化
dlinmod能够以任意给定的采样时间对离散系统、多速率系统以及连续和离散混合系统进行
线性化。除了第2个选项需要插人采样时间来对系统线性化外，dinmod的调用格式和linmod是
1去
第9章 MATLAB环境下的仿真软件 Simulink ·261·
相同的：
[A,B,C,D]=dinmod('sys',Ts,x,u)
调用该函数可以产生一个以状态向量x和输人向量u为工作点，采样时间为Ts的离散状态
空间模型。要想得到一个离散系统的近似连续模型，只要把Ts设为0即可。
如果一个模型是由线性模型、多速率模块、离散模块和连续模块组成的，那么在满足下列条
件的情况下，dinmod产生一个采样时间为Ts且具有相同频率和时间响应的线性模型：
(1)Ts是系统中所有采样时间的整数倍。
(2)Ts不小于系统中最慢的采样时间。
(3)系统是稳定的。
不过，在不满足上面这些条件的情况下，也有可能得到有效的线性模型，但这要看一个系统
是否稳定。实际上只要计算线性化后所得矩阵A的特征值就可以了。因此，如果Ts>0而且特
征值在单位圆内，那么系统就是稳定的。同样，如果Ts=0,而且所有的特征值在左半平面，那么
系统也是稳定的。
当系统不稳定且采样时间不是其他采样时间的整数倍时，dinmod 就可能产生复矩阵A和
B。然而在这种情况下，仍然可以通过矩阵A的特征值来验证系统的稳定性。dlinmod可以用来
把一个系统的采样时间变成其他值，或者把一个线性离散系统变成一个连续系统。或者反过来，
把一个连续系统变成一个离散系统。
例如，对图9.37所示的线性系统，取Ts=0.1,求离散的线性化模型。命令如下：
[A,B,C,D=dlinmod('exe9_2',0.1)
命令执行后得到离散的线性化状态空间矩阵 -81-13
9.7.3 连续系统线性化的一种高级形式
函数 linmod2提供了一种线性化的高级形式。该函数和linmod相比，运行需要更长的时间，
但产生的结果要比 linmod精确。
linmod2的调用格式和 linmod 调用格式相似，但功能不同。linmod2设法平衡舍人误差(由于
小扰动引起的，并与计算精度有关的误差)与截断误差(由于大扰动引起的，使分段线性近似无效
而产生的误差),并在两者之间进行折衷。
对于调用命令[A,B,C,D]=linmod2('sys*,x,u,pert),其中pert 表示可以施加的最小扰
动，默认值为le-8。linmod2的优点是能够探测到不连续性，并产生一个警告信息。例如
warming:discontinuity detected ad A(2,3)
当出现上述这样的警告信息时，可在其他的工作点附近进行试验来得到线性化模型。
例如，对图9.37用linmod2再解一次，输人命令
[A,B,C,D]=linmod2(' exe9_2')
得到和运用linmod函数一样的结果。
关于模型线性化的几点说明：
·262· 应 用 篇
(1)若被线性化的系统本身是线性的，那么线性化过程中不存在截断误差，扰动可取任意大
小，工作点也不影响所得结果。一般来说，扰动取值较大，有利于减小圆整误差。
(2)在线性化过程中，模型的状态次序不变。
(3)在Simulink 框图上，系统的输入输出要依次编号。且系统的输入和输出必须用Singnals
& Systems库中的Inl和Out1模块来定义。Singnal Generator和 Scope模块不能作为系统的输人和
输出。
9.7.4 平街分析
在给定输入、输出及状态条件下，Simulink 提供的函数 trim可以用来确定系统的稳态平衡
点。其调用格式为：
[x,u,y,dx]=trim(' sys')
[x,u,y,dx]=trim('sys',x0,u0,y0.ix,iu,iy)
其中x,u,y,dx分别代表状态向量、输入向量、输出向量和状态向量的导数。sys是模型名。
x0,x0,y0分别为状态向量x、输入向量a和输出向量y的初始猜测值，它们的输人格式必须是
列向量形式。ix是向量，它的元素是那些在寻找过程中，要求保持其值固定不变(等于初始猜测
值)的那些状态变量的序号。iu、iy与ix类似，分别适用于a和y。
trim的功能是试图找到输人u和状态x的值来使状态的导数为0,这样的工作点被称作平
衡点，即系统在稳态时的工作点。既然这样的平衡点通常不是惟一的，因此有必要对状态x、输
入u和输出y的值进行固定。
命令[x,u,y]=trim('sys')的功能是设法找到一个平衡点，使[x;u;y]的绝对值达到最小。命
令[x,u,y]=trim('sys*,x0,u0,y0)使[x-x0;u-u0;y-y0]的绝对值达到最小。
x,u,y的每一个元素可用下面的调用格式进行固定：
trim('sys',x0,u0,y0,ix,iu,iy)
整数向量ix,iu和y用来指定x0,u0和yo中保持不变的分量下标，使搜索受约束进行。
既然无法保证平衡点一定存在，因此问题就转换为寻找一个稳态值，使得
abs([x(ix)-x0(ix);u(iu)-u0(in);y(iy)-y0(iy)])
绝对值达到最小。
trim在限制状态导数为零的情况下，用一个有约束的优化算法来求解一个由x,u和y的希
望值所组成的绝对值最小问题。对于这样一个问题，有可能没有可行解。在这种情况下，trim就
在状态导数偏离0这种最坏条件下，使上面的绝对值达到最小。
要使导数固定为一个非0值，可以采用
[x,u,y,dx]=trim('sys',x0,00.y0,ix,iu,iy,dx0,idx)
其中dx0表示希望的偏离值，idx用来表示对dx中的哪一个元素进行固定。
下面仍以图9.37的模型为例。用trim函数来找到使输出为1时输人和状态所对应的值。
首先输入u和状态变量x作为初始假设，然后设置输出y的希望值：
x=[0;0;0];
u=0;
y=[1;1];
第9章 MATLAB环境下的仿真软件 Simulink ·263·
再用索引变量指出哪个变量是固定的，哪个变量是可以变化的。例如
ix=[]; ??有固定任何状态变量
iu=[ ]; ??有固定输入
iy=[1;2]; ?定输出端口1和输出端口2
最后调用trim函数：
[x,u,y,dx]=tim(' exe9_2,[ ],[ ].y,[ ],[ ].iy)
得到状态向量x、输人向量u、输出向量y以及状态向量的导数dx 分别为：
-2-14-10-s
在平衡工作点，dx本应等于零，这里dx≠0,是由于计算误差或者搜索精度决定的。
除非问题本身的最小值惟一，否则不可能保证所求得的平衡点是最佳值。因此，要想找到全
局的最佳平衡点，多尝试几组初始值是必要的。
习 题 九
1.建立如图9.38所示的方框图模型，用菜单方式运行该模型的仿真。改变Gain 模型的增益，看Scope显示
波形的变化。用Silder Gain模型取代Gain 模块，重复上述操作。
1
Sine Wave Gain Soope
图9.38 习题九第1题图
2.建立如图9.39所示的方框图模型。用菜单方式进行仿真，改变 Slider Gain 模型的增益，观察x-y波形
的变化，用浮动的Scope模块观测各点波形。
Sine Wave1 Integrator XY Graph
1
Slider
Gain Scope1
图9.39 习题九第2题图
3.将图9.38中的Scope模块换成Outport模块。在Simulink Parameter 对话框中把时间和输出选作返回变量，
分别填以变量名t和y。用菜单方式运行仿真，然后用绘图命令画出曲线y-t。
4.用两个Outport 模块取代图9.39中的xY Graph 模块。在Simulation Parameter对话框中，把时间和输出选作
返回变量，分别填以变量名t和[y,y?j。用菜单方式进行仿真，然后用绘图命令画出曲线 y?-1,y?-2和y?-
Y20
·264· 应 用 篇
5.用To Workspace模块取代第3题中的Outport 模块。用菜单方式进行仿真，然后画曲线。
6.对第3题的Simulation Parameter对话框只解变算法(Solver),例如采用ode45,ode23变步长方法，其他参数
保持不变，看仿真结果有何差别。再改用定步长的 Diserete算法，把仿真结果与前面几种方法结果对比，能得出
什么结论?把变步长算法产生的计算时间点作为定步长 Discrete算法时的输出时间点，重新用Discrete算法进行
仿真，然后在同一坐标平面上绘制两种算法仿真结果的数据点曲线。
7.用MATLAB命令仿真习题1、习题2。
8.简述3种条件执行子系统的特点。
9.设计一个实现下面函数模块的子系统
Output =(inputl+ input2)× input3-input4
然后对子系统进行封装。要求对lcon、Initialization和Documentation 3个参数选项卡进行设置。
10.若典型反馈控制系统的模型为
c(S)=5(s22600+S/26+1,Ge(S)=K,H(S)=0.04S+1
(1)试对不同的K值绘制出闭环系统单位阶跃响应曲线，并用试探法找出使得闭环系统临界不稳定的增益
K值.并用根轨迹法检验所得出的结果
(2)令K=4,显示系统的脉冲响应曲线。
第10章 MATLAB应用实例
通过前面的学习，读者应该有这样的体会，MATLAB的确是一种优秀的科学计算语言，在需
要进行大量矩阵计算、各种数值处理、符号计算以及图形处理的各个应用领域，都具有很大的应
用价值。用MATLAB来解决诸多专业领域的实际问题，能够大大地提高工作效率和质量。
木章介绍一些MATLAB应用实例，目的是让读者通过这些实例，进一步掌握MATLAB程序设
计的基本方法，并且了解MATLAB在相关领域的应用价值，从而引导读者更好地应用MATLAB来
解决自己专业领域的实际问题。本章给出的实例尽量结合一定的专业背景，但覆盖面是有限的。
所以，本章内容仅起一个引导、提示的作用，希望能抛砖引玉。另外，在实际应用中，可能还要用
到一些学科性工具箱，因其数目繁多，本书不可能一—涉及，读者如有需要，可参考有关专著。
10.1 MATLAB在电路分析中的应用
10.1.1 概述
1.矩阵计算与线性电路分析
矩阵工具引人电路理论已有半个多世纪的历史。矩阵的引入使电路定律的表述更为精炼。
由于把多变量的系统在形式上按单变量表示，整个理论显得更为简约，概念更为清晰，而且能从
整体上掌握电路的状态。传统的克希霍夫定律、支路电流法、回路电流法以及节点电压法都可以
以矩阵形式出现。
矩阵是MATLAB最基本的数据对象，MATLAB的大部分运算或命令都是在矩阵运算的意义
下执行的，面且MATLAB的矩阵运算定义在复数域上，这为电路分析带来了方便。
2.微分方程求解与电路瞬态分析
当动态电路从某一稳定状态转换到另一稳定状态时，有些物理量(如nc,i,g,ψ)并不是立
即突变的，而是需要一定的时间。在这期间，电路将呈现出和稳定状态不同的特别现象，这种现
象为电路的过渡过程或瞬态现象。分析电路的瞬态现象时，可以建立关于电压和电流的微分方
程，再按所给定的初始条件来进行求解。
MATLAB提供了常微分方程初值问题的数值解法，利用有关函数可进行电路瞬态分析。此
外，还可以利用MATLAB符号计算或 Simulink 仿真来求解。
3.图形功能与电路分析
利用MATLAB的图形功能可以绘制电路的各种响应曲线。MATLAB的图形功能很强并可对
其实行控制。
·266· 应 用 篇
10.1.2 实例
例10.1 三相不平衡交流电路分析。计算图10.1所示三相不平衡交流电路各支路电流
(ia,i方，i。)并绘制相量图。其中r=r=re=50,rab= a
Va 60,r=10Ω,r=150,E=220 V。
根据克希霍夫定律并代入数值，1,I和1满足方程
组
O
hk b
/+2-5-H-io5
-110+j110√3
E
C
L
'
'k
○
图10.1 三相不平衡交流电路
用MATLAB先求i,i,和1。,进而求各支路电流：
a=[16,-5,-5;-5,20,-5;-5,-5,25]; ??数矩阵
b=[220;-110-110*sqrt(3)*i;-110+110*sqrt(3)*i];
??方程 I=inv(a)*b;
Ia=I(1)-F(3) ??各支路电流
Ib=I(2)-I(1)
Ic=I(3)-I(2)
h=compass([la,Ib,Ie]); ??制相量图
set(h,'LineStyle',3);
运行程序，得到各支路电流为：
Ia=
14.5783-6.5804i
Ib=
-15.1084-7.4986i
Ic=
0.5301+14.0790i
各支路电流相量图如图10.2所示。
例10.2 调谐振荡电路分析。分析图10.3所示的调谐振荡电路(iz=f(v)=a+A-rw3,
β>0,γ>0),要求绘制振荡波形和相轨迹。
根据克希霍夫定律，图10.3调谐振荡电路的电流i满足下式(忽略流入放大元件的电流)
+n+jid=Mdi
i=cd
由此两式可得到
uc+c+=M
式中
t=f(v)=a+A-r3,β>0,y>0
第10章 MATLAB应用实例 ·267·
90 20
120 60
15
150 A10 30
5,
180 0
210 330
240 300
270
图10.2 各支路电流相量图
再将上式写成
c+(rC-MR+3Mm2)+v=0 L
i
用t=√LCr作变换，可得到 M
r+(C-MB+3Mn2)+=0 r
如果 rC-Mβ<0,并设 L
D
放大元件
i
Tc
8=3,=Mc 图10.3 调谐振荡电路 则有
+(02-A)d+v=0
=√“y,上式可写成 设
r+a(2-)+y=0
这是著名的范德波尔(Van der Pol)方程。它是一个非线性方程，利用MATLAB可以求其数值
t=0,y=a,W=b。MATLAB求常微分方程初值问题数值解的函数是对 解。设其初始条件为：
一阶常微分方程组设计的，因此对高阶常微分方程，需先将它转化为一阶常微分方程组，即状态
=d,y=y 方程。选择状态变量 ,则可写出Van der Pol方程的状态方程形式：
dr=(1-y3)y?-r2
·268· 应 用 篇
d=n
基于以上状态方程建立函数文件 vdpol.m:
function ydot= vdpol(t,y)
ydot(1)=0.1*(1-y(2)2)*y(1)-y(2);?的值可以任意变化，此处取0.1
ydot(2)=y(1);
ydot=ydot';
求解微分方程：
??定积分区间 t0=0;tf=60;
??定初始条件 y0=[0;0.25];
??解微分方程 [t,y]=ode45(' vdpol',[10,t],y0);
绘制振荡波形(t,dy/ds)、(t,y)和相轨迹(y,dy/dt):
subplot(1,2,1);plot(t,y);
subplot(1,2,2);plot(y(:,2),y(:,1));
图10.4是μ取0.1时的波形图和相轨迹，从中可以清楚地了解起振时的波形变化。当μ
值很小时振荡波形和正弦波接近，相轨迹极限环接近圆形。随着p值的增大，振荡波形将有显
著失真，相轨迹变形(图10.5)。
2 2
1 1
-1 -1
-2
0 20 40 60 -2-2 0 2
图10.4 μ取0.1时的振荡波形和相轨迹
4 4
2 2
0
-2 -2
-40: 20 4060 -4
5 0 5
图10.5 μ取0.5时的振荡波形和相轨迹
MATLAB定义在复数域上的矩阵计算、微分方程求解以及图形功能为电路分析创造了良好
的条件。利用MATLAB来进行电路分析比传统方法更为简洁、高效。
第10章 MATLAB应用实例 ·269·
10.2 MATLAB在控制系统分析中的应用
10.2.1 概述
以前要想获得一个控制系统的响应，往往需要编写一个数值计算程序，如果还想绘制系统的
响应曲线，还得编写一个画图子程序。如用一些传统高级语言编程，一般情况下求解一个简单的
问题(如一个系统的阶跃响应),也需要花费很多的时间，而且得到的结果有时不一定十分满意。
MATLAB语言出现以后，特别是MATLAB的控制系统工具箱(Control System Toolbox)及Simulink仿
真软件问世以来，确实给系统分析者带来了福音，因为用户不必像以前那样将时间和精力无谓地
花费在一些无关紧要的工作中去。
用MATLAB进行控制系统计算机辅助分析，使得以往十分困难的系统仿真问题可以轻而易
举地解决。本节应用MATLAB控制系统工具箱和Simulink仿真软件来对线性时不变(LTI)系统
进行仿真。
系统仿真实质上就是对描述系统的数学模型进行求解。对控制系统来说，系统的数学模型实
际上是某种微分方程或差分方程模型，因而在仿真过程中需要以某种数值算法从给定的初始条件
出发，逐步地算出每一个时刻系统的响应，最后绘制出系统的响应曲线，由此来分析系统的性能。
MATLAB的控制系统工具箱提供了很多对线性系统在特定输入下进行仿真的函数。例如连
续时间系统在阶跃输人激励下的仿真函数step、在脉冲激励下的仿真函数impulse等，其中阶跃
响应函数step的调用格式为：
step(sys)或[Y,T]=step(sys)
其中sys代表LTI的传递函数模型，第一种调用方式直接绘制出阶跃响应曲线，而第二种调用方
式不绘制曲线，而返回输出响应Y和时间向量T。
求取脉冲响应的函数impulse和step 函数的调用格式完全一致。
10.2.2 实例
例10.3 --典型线性反馈控制系统结构如图10.6所示，图中R(S)为输人函数，Y(S)为输
出，Gc(s)为控制器模型，G(s)为对象模型，H(s)为反馈模型。各个模块分别为
G(s)=s3+2s2+38+4,Ccs)=S-3,B(s)=0.01S+i
建(s) Ge(s) G(s)
图10.6 线性反馈控制系统结构
K(s)
I(s)
·270· 应 用 篇
试分别利用MATLAB控制系统工具箱提供的仿真函数和 Simulink仿真软件求出开环和闭环系统
的阶跃响应曲线。
解法1 利用MATLAB控制系统工具箱中已经定义的一些LTI仿真函数，编写如下程序：
G=tf(4,[1,2,3,4]);Ge=tf([1,-3],[1,3]);H=tf(1.[0.01,1]);
G_o=Ge*G; ??造开环系统的传递函数。
G_c=feedback(G_o,H); ??造闭环系统的传递函数。
step(G_o); ??开环系统的阶跃响应并绘制相应的曲线。
??闭环系统的阶跃响应并绘制相应的曲线。 figure;step(G_c);
说明：
(1)f函数是控制系统工具箱中的一个LTI对象函数，由给定的传递函数分子分母构造出单
个的传递函数，使系统模型的输人和处理更加方便。该函数的调用格式为：
G=f(num,den)
其中num、den分别为系统的分子和分母系数向量，返回的变量为系统传递函数。
(2)控制系统工具箱提供的feedback 函数，用来求取反馈连接下总的系统模型。该函数的调
用格式为：
C=feedback(G1,G2)
其中G1和G2分别为前向模型和反向模型的LTTI对象，而G为总系统模型。
程序执行后，得到开环系统和闭环系统的阶跃响应曲线分别如图10.7和图10.8所示。
Step Response
From U(1)
0.2
0
-0.2
-0.4
Amplitude To: Y()0.8
-0.6
-1
-1.2
-1.4
-1.60 5 10 15 20
Time(sec.)
图10.7 开环系统的阶跃响应曲线
第10章 MATLAB应用实例 ·271·
Step Response
From U(1) 2
0
-2
Amplitude -4 To:Y(1) -6
-8
-10
-120 3 6 9 12 15 18
Time(sec.)
图10.8 闭环系统的阶跃响应曲线
解法2 利用Simulink 仿真软件进行分析，步骤如下：
(1)打开MATLAB模块库浏览器窗口以新建一个模型窗口。
(2)在模块库浏览器窗口中双击Control System Toolbox图标，即打开控制系统工具箱，并将其
中的LTI模型复制3个至新建的模型窗口，分别作为G.(s)、G(s)和H(s)的函数模块。注意：由
于H(s)是反向模块(即表示负反馈),所以需按快捷键 Ctrd+R改变其传输方向。
(3)双击其中的G(s)模块，将出现设置模块参数对话框，将LTI system variable一栏中原来系
统默认的传递函数tf(1,[1,1])修改为tf(4,[1,2,3,4]),然后对G(s)、H(s)也分别做相应修改。
(4)将模块库浏览器窗口中的Step 模块、Sum模块以及Scope模块分别复制至模型窗口，并
按图10.9连接好系统。
(5)选择模型窗口 Simulation菜单中的Start 命令，即可得到与图10.8完全一致的闭环系统
阶跃响应曲线。
(6)断开图10.9中H(s)模块左侧或右侧的连线，使其成为开环系统，再进行仿真，即可得到
与图10.7完全一致的开环系统阶跃响应曲线。
从这个例子可以看出，开环系统是稳定的，而闭环系统是不稳定的。因此，并不是所有的控
制器和闭环结构都能够改善原系统的性能，事实上，如果控制器设计不当，则将使闭环系统的特
性恶化。
·272· 应 用 篇
Step
t4,[1,2,3.4D
Gc(s)
t[1.-3].(1 31)
(8) Scope
Hs)
图10.9 线性反馈控制系统仿真模型
无论是运用MATLAB控制系统工具箱的LTI仿真函数，还是利用Simulink仿真软件，进行线
性系统时域响应分析都是十分高效、便捷的。当然 MATLAB在控制系统中的应用远非如此，其功
能是十分强大的，有兴趣的读者可以参考相关文献。
10.3 MATLAB在数学建模中的应用
10.3.1 概述
计算机的广泛应用和迅速普及，促成了数学建模的发展，也促成了实验数学的诞生。近 20
年来，国内外数学工作者一直在讨论实验数学的发展问题，并认识到实验数学应当与纯粹数学、
应用数学鼎足而立。
MATLAB强大的计算与图形功能为以实验的方式学习和研究数学理论创造了良好的条件，
成为数学工作者一个强有力的工具。数学中的许多抽象定理和结论，如今可以在实验中一目了
然，新思想、新方法也可以在计算机上迅速地呈现。
一年一度的全国大学生数学建模竞赛，不论是对提高学生的数学素质和计算机应用能力，还
是培养其从事科学研究的能力，都起着非常重要的作用。数学建模竞赛是20世纪80年代中期
美国率先进行并受到国际上众多国家响应的一种大学生数学竞赛。我国数学建模竞赛始于
1993年，竞赛试题有很强的实际应用背景，没有惟一答案，要求参赛的3个队员充分发挥集体智
慧，在72小时内对试题给出一个尽可能完整合理的解答，包括查阅资料，了解有关领域知识，建
立数学模型，研究算法，进行计算机编程和运算，得出结论，进行必要的分析，最后以书面报告形
式把所有结果表述出来。这种竞赛实质上类似于一项科研课题的研究，对参赛队员的总体素质，
包括专业知识、数学建模能力、计算机应用能力、文字表达能力以及集休协作精神都是严峻的考
验。下而就数学建模与数学实验，介绍MATLAB的应用。
10.3.2 实例
例10.4 自行车轮饰物的运动轨迹。为了使平淡的自行车增添一份美感，同时，也为了增
加自行车的安全系数，一些骑车的人及自行车厂家在自行车的辐条上安装一款亮丽夺目的饰物，
当有这种饰物的自行车在马路上驶过时，这种饰物就像游龙一样，对街边的行人闪过一道波浪形
顷1.0.01.1D
第10章 MATLAB应用实例 ·273·
的轨迹。这一波-闪的游龙，其轨迹是什么曲线?试画出它的图形。当自行车在一个抛物线型
的拱桥上通过时，或是在一拱一拱的正弦曲线上通过时，这个轨迹是什么曲线?试画出其图形。
假设自行车在运行过程中，始终只与曲线y=f(x)的一个点接触。将路面视为一通过原点
的曲线f(x),车轮视为一半径为R的圆，该圆位于曲线的上方且与此曲线相切。设饰物P在离
轮心距离为r处，显然r≤R。OP与圆交于A,现以A为初始接触点，圆(即车轮)滚过θ角以后
(假定车轮和路面作无滑动的滚动),圆与曲线的接触点变为B,圆心从0移到0',饰物P从原
位置移到P',如图10.10所示。
设B(xo,yo),0'(X,Y),P'(x,y),则
BA'=RO=BA=J。√1+f'(x)2dx
所以
θ=六。√1+f'(x)2dx Ap O'
O
o 中 φ
B
0'(X,Y)在y=f(x)过B点的法线的上侧，且在以
B为圆心的圆周上，所以有
p
A X
Y-f(xo)=-(xo)(X-xo)
(X-x?)2+(Y-f(xo))2=R2 图10.10 车轮运动示意图
联立解得
x=-Rt'(8
r=/(k)+1+f(P
又对P'(x,y),有
x=X-rsin(θ-?),y=Y-rcos(θ-φ)
其中中=atan(f'(x?)),θ=k。1+J'(x)dx。所以，饰物的运动轨迹方程为
=x0-R')--sin(8-今)
y=f(z)+1+f(-rcC0-)
(1)取f(x)=0,则有θ=x?/R,φ=0,这时饰物的运动轨迹方程为
x=x-rsin(x?/R),y=R- rcos(x?/R)
θ=k。√1+(-0.4x)2dx,中=atan(-0.4x?),这时饰物 (2)取f(x)=0.2-0.2x2,则有t
的运动轨迹方程为
=+1+(-0.4o-rsin(θ-4)
·274· 应 用 篇
y=0.2-0.2+1+(-0.4-4)
e=k√1+(0.300)Pda,p=aun(O0.3ccxo),这时饰物的 (3)取f(x)=0.3sin x,则有
运动轨迹方程为
=-1+30.308-si(8-4)
y=0.3mma+0.3-(0-4)
程序如下：
clear;
??(1)类情况的实现
x0=0:0.01:2;R=0.1;r=0.075;
xl=x0-r*sin(x0/R); ??算f(x)=0时p点运动轨迹
yl=R-rcos(x0/R);
subplot(3,1,1);
plot(x1,yl,x0,0); ??制运动轨迹曲线和f(x)曲线
gid on
??(2)类情况的实现
x0=-1:0.01:1;R=0.1;r=0.1;
y0=0.2-0.2*x0.2;
fai= atan(-0.4*x0);
int=inline('sqnt(1+(-0.4*x).2)');
??算路面曲线
??φ
??义θ的积分函数
for k=1:length(x0)
thetal(k)=quad(int,0,x0(k))/R; ??用quad函数求θ
end
x2=x0+R*0.4*x0./sqnt(1+(-0.4*x0).2)-rsin(thetal~fai); 点运动轨迹方程
y2=y0+R./spr(1+(-0.4*x0).~2)-r*cos(thetal-fai);
subplot(3,1,2);
plot(x2,y2,x0,y0) ??制运动轨迹曲线和f(x)曲线
gid on
??(3)类情况的实现
x0=0:0.01:10;R=0.1;r=0.075;
y0=0.3*sin(x0);
fai=atan(0.3#cos(x0));
int = inline('sqrt(1+(0.3*cos(x)).2)');
??算路面曲线
??中
??义B的积分函数
for k=1:length(x0)
theta2(k)=quad(int,0,x0(k))/R; ??用quad 函数求θ
end
x3=x?-0.3*R*cos(x0)./sqt(l+(0.3*cos(x0)).2)-r*sin(theta2-fai);点运动轨迹方程
y3=0.3*sin(x0)+R./sqr(1+(0.3*cos(x0)).^2)-r*coB(theta2-fai);
第10章 MATLAB应用实例 ·275·
subplot(3,1,3);
plot(x3,y3,x0,y0)
grid on
运行程序得图10.11所示曲线图。
02
01
0
0 0.2 0.4 0.6 0.8 1.2 1.41.6 182
04
02
95 -1 -05 0 05 1 1.5
05
0
-05-2 0 2 4 6 B 10
图10.11 自行车饰物运行曲线
例10.5 广告费用与效应。某装饰材料公司欲以每桶2元的价钱购进一批彩漆。一般来
说，随着彩漆售价的提高，预期销售量将减少，并对此进行了估算，见表10.1。
表10.1 售价与预期销售量
售价(元) 预期销售量(桶) 售价(元)
41000
34000
29000
25000
20000
2.50
3.50
4.50
5.50
预期销售量(桶)
2.00 38000
3.00 32000
4.00 28000
5.00 22000
6.00
为了尽快收回资金并获得较多的赢利，装饰材料公司打算做广告。投入一定的广告费后，销
售量将有一个增长，可由销售增长因子来表示。例如，投人4万元的广告费，销售增长因子为
1.95,即销售将是预期销售量的1.95倍。根据经验，广告费与销售增长因子的关系见表10.2。
·276· 应 用 篇
表10.2 广告费与销售增长因子
广告费(元) 销售增长因子 广告费(元)
1.00
1.70
1.95
1.95
10000
30000
50000
70000
销售增长因子
0 1.40
20000 1.85
40000 2.00
60000 1.80
现在的问题是装饰材料公司采取怎样的营销战略使得预期的利润最大?
设x表示售价(单位：元),y表示预期销售量(单位：桶),z表示广告费(单位：元),k表示销
售增长因子。投入广告费后，实际销售量记为s,获得的利润记为P(单位：元)。由表10.1易见，
预期销售量y随着售价x的增加而单调下降，而销售增长因子k在开始时随着广告费z的增加
而增加，在广告费z等于50 000元时达到最大值，然后在广告费增加时反而有所回落，为此可用
MATLAB画出散点图，用程序实现如下：
x1=2:0.5:6;
yl=[41000,38000,34000,32000,29000,28000,25000,22000,20000];
x2=0:10000:70000;
y2=[1.0,1.4,1.7,1.85,1.95.2.00,1.95,1.8];
subplot(2,1,1);plot(x1,y1,'o');tide('售价与预期销售量');
subplot(2.1,2);plot(x2,y2,*o');tide('广告费与销售增长因子');
程序执行后，得到图10.12。
45x10? 售价与预期销售量
49
35
3
25
2
2
0
o o
o o
0
9
25 3 3.5 4 45 5 55 49
广告费与销售增长因子 2
18
16
14
12
10
6 百
o
0
o
1 2 3 4
图10.12 销售关系图
5 6 7
x10?
第10章 MATLAB应用实例 ·277·
从图10.12易见，售价x与预期销售量y近似于一条直线，广告费z与销售增长因子k近似
于一条二次曲线。为此可令
y=a+bx,k=c+dz+ez2
其中系数a,b,c,d,e是待定参数。
投入广告费后，实际销售量s等于预期销售量y乘以销售增长因子k,即s= ky。所获得的
利润为
P=收入-支出=销售收人-成本-广告费
=sx-28-z=kxy-2ky-z=ky(x-2)-z=(c+dz+ez2)(a+bx)(x-2)-z
我们期望利润P达到最大，即
max P=(c+dz+ ez2)(a+bx)(x-2)-z,其中x>0,z>0
首先利用MATLAB编程计算参数a,b,c,d,e。
format long;
x1=2:0.5:6;
yl=[41000,38000,34000,32000,29000,28000,25000,22000,20000];
x2=0:10000:70000;
y2=[1.0,1.4,1.7,1.85,1.95,2.00,1.95,1.8];
al=polyfit(xl,yl,1);
a2=polyfit(x2,y2,2);
disp(al),disp(a2)
运行结果为：
1.0e+004*
-0.51333333333333 5.04222222222222
-0.00000000042560 0.00004092261905 1.01875000000000
即拟合曲线分别为
y=50 422.2-5133.33x
k=1.018 75+4.092 26×10-?z-4.256 0×10-10z2
其次用MATLAB求解优化模型。因MATLAB中仪能求极小值，为此将优化模型转化为
min(-P)=z-(c+dz+ ez2)(a+bx)(x-2),其中x>0,z>0
建立函数文件p.m:
function f=p(x)
f=x(2)-(1.01875+4.09226e-5*x(2)-4.2560e-10*x(2)2)*(50422.2-5133.33*x(1))*(x(1)-2)
利用 fmins寻优：
format short e
x=fmins('p',[0,0])??优从坐标原点开始
运行结果为
f=
-1.1666e+005
x=
5.9113e+000 3.3116e+004
·278· 应 用 篇
由此可见：x=5.911 3,z=33 116,函数p达到最大值116 660。代入公式，得y=20078,将
c,d,e,z的值代入公式，得k=1.907 2。从上面的计算可知，投入33116元的广告费后，实际销
售量为 ky=38 292,利润为116 660元。
10.4 MATLAB在工程结构分析中的应用
10.4.1 概述
工程结构包括土木工程结构和机械工程结构等。工程结构分析主要的根据是力学原理。经
典力学原理基本上沿着两条路线进行。条是基于牛顿运动定律，在静力分析中，主要遵循力的
平衡原理，加上组成结构材料的本构关系和应变、位移的几何协调关系可以导出微分方程。另一
条是基于功、能原理，它以能量原理(如最小势能原理，虚位移原理等)为基础，可以导出需要求解
的积分方程。
不管是解微分方程还是解积分方程，均需求出函数y=f(x),使之满足方程并在边界上满足
边界条件。对于简单的问题可以求得其解析解，但工程实际问题是复杂的，往往很难求得其实用
的解析解，因此，应用计算机得到其数值解成了可行的解决问题的途径。常用的数值方法有：差
分法、有限元法、加权残值法、边界元法等，这些解法通常都有大量的矩阵运算以及其他数值计
算。MATLAB具有强大的科学计算功能，这使得入们可以用它来代替FORTRAN 等传统的编程语
言。在计算要求相同的情况下，使用MATLAB编程，工作量会大大减少。例如在结构动力学中利
用FORTRAN求解结构的自由振动，需调用Jacobi子程序求解矩阵的特征值及对应的特征向量，
而且要求该矩阵必须为实对称矩阵，程序繁杂，且对一般用户来说，要看懂程序算法实属不易，而
采用MATLAB编制该自由振动的于程序时只需调用两个函数：求逆矩阵的 inv函数及求特征值、
特征向量的eig函数。下面简单地介绍MATLAB在工程结构分析中的应用。
10.4.2 实例
例10.6 简支梁荷载情况如图10.13所示。求其弯矩、转角和挠度。已知L=8m,q=500
N/m,Fo=1000 N,M?=800 N·m,E=200×10?N/m, Fo
I=2×10-?m?。 M。 q
从材料力学的知识可知道，由弯矩求转角要经过
一次不定积分，而由转角求挠度又要经过一次不定积
分，通常这是很麻烦而且容易出错的，而在MATLAB
中，可用cumsum函数或 cumtrapz 函数作近似的不定积
分，只要x取得足够密，其结果将相当准确，且程序非
常简单。
1 2
L/2 L/4 L/4
图10.13 简支梁受力图
由平衡方程可求出支撑反力N?和N?
N?=(?+F台-M?)/z,N?=些+Fa-N
第10章 MATLAB应用实例 ·279·
故各段弯矩方程为
M?=N?x-q·, 0≤x≤L/2
L/2≤x≤34 M?=N?(L-x)-M?,
34≤x≤L M?=N?(L-x),
对M/EI作积分，得转角A,再作一次积分，得到挠度Y,每次积分都要出现一个待定积分常
数
A={Hdx+C?=Ao(x)+C
此处设A?(x)=cumtrapz(M)*dx/El
r=?Adx+C?=[。Aa(x)dx+C?x+C?=Y?()+C?x+C?
此处设Y?(x)=cumtrapz(A?)*dx.
两个待定积分常数C?和C?可由边界条件Y(0)=0及Y(L)=0确定
Y(0)=Y?(0)+C?=0
Y(L)=Y?(L)+C?L+C?=0
于是可得
IiJ=vo()]
由此编写MATLAB程序如下：
L=8;q=500;FO=1000;MO=800;F=200e9;I=2e-6;
NI=(3*q*L~2/8+FO*L/2-MO)/L;N2=(q*L2/8+F0*L/2+MO)/L;
x=linspace(0,L,101);dx=L/100;
M1=N1+x(1:51)-q*x(1:51).2/2; ?3段用数组列出M的表达式
M2=N2*(L-x(52:76))-M0;
M3=N2*(L-x(77:101));
M=[M1,M2,M3];
A0=cumtrapz(M)*dx/(E*1); ??M积分求转角(未记积分常数)
Y0=eumtrapz(A0)*dx; ??转角积分求挠度(未记积分常数)
C=[0.1;L,1]\[-Y0(1);-YO(101)]; ??边界条件求积分常数
A=A0+C(1);Y=YO+C(1)*x+C(2); ??转角和挠度的完整值
subplot(3,1,1);plot(x,M);grid on;
subplot(3,1,2);plot(x,A);grid on;
subplot(3,1,3);plot(x,Y);grid on;
运行程序后得到图10.14所示的弯矩、转角和挠度曲线。
梯形积分累加函数cumtrapz与梯形积分函数trapz的不同在于它逐点给出积分值，因而得出
一个积分序列，而trapz只给出积分到终点的一个值。
例10.7 计算图10.15所示直梁的自振频率(基频)。已知E=2×10" Pa,p=7860kg/m3,A=
·280· 应 用 篇
4000
2000
0
0 1 2 3 4 5 6 7 8
002
0
002
-0040 1 2 3 4 5 6 7 8
0
-002
004
-0060 1 2 3 4 5 6 7 8
图10.14 弯矩、转角和挠度曲线
1.14×10-3m2,1=1.03×10-?m?。
在结构的自由振动分析中，均不计人阻尼力的作用，
其运动方程为 2 3 4 北S
[M]181+[K]!8}=0 1m Im im 1m
设各点作简谐振动，即
18}=fδ| sin wt
18!=-w2lδ'sin wt
图10.15 直梁的自由振动
代入上式得运动方程
([K]-w2[M])|8?l=0
在自由振动时，结构各结点的振幅值18。|不可能全等于零，要使上式(也就是齐次方程组)有
不全为零的解，则其系数行列式应等于零，即
I[K]-w2[M]|=0
这便是结构自由振动的频率方程，展开后是关于w的高次方程，方程的次数与矩阵[K]和
[M]的阶数相同。由频率方程解出的根w?、W?、w?、…,分别称为第一、第二、第三、…自振频率。
将运动方程左乘[M]-',则
([M]-1[K]-w2[1])!8。1=0
这时求解自振频率也就是求矩阵[M]-[K]的特征值。下面就如何形成[K]矩阵和[M]矩阵加
以说明。
(1)整体刚度矩阵[K]的形成
设有单跨梁如图10.16所示，两端结点编号为1,2。由结构力学可知，杆端力(指剪力和弯
矩)与杆端位移(指竖向位移和角位移)的关系，即单元刚度矩阵可表达为
第10章 MATLAB应用实例 ·281·
12E _6EI -6 1
2，6 示品
6F 4F
y
1 2
QK x
L
M 画
M
I Q?
在梁的分析中，忽略梁的轴向变形，不计梁的轴向
位移，因而每一个结点只有2个位移自由度。一个杆 图10.16 单跨梁示意图
件有2个结点，共有4个位移自由度，所以单元刚度矩阵是4×4阶的。为了集合整体刚度矩阵，
需要找出同一结点位移在单元刚度矩阵中的位置与在整体刚度矩阵中的位置之间的对应关系。
根据这种对应关系，利用MATLAB语言很容易实现。
(2)整体质量矩阵[M]的形成
如图10.16所示梁的单元质量矩阵为
质量矩阵的集合方法与刚度矩阵的集合方法一样。
(3)支承约束条件的处理
刚度矩阵和质量矩阵集合完成后引入支承条件，采用“缩减法”将被约束的位移自由度缩减
掉，即将[K]和[M]矩阵中与支承处相对应的行和列全部划掉。在自由振动中，结构自振频率数
等于结构中能自由位移的自由度数。
将图10.15中的梁划分为4段，共5个结点10个自由度(其中1结点的竖向位移与5结点的
竖向及转动位移受约束，即矩阵为7×7矩阵),编制程序如下：
E=2el1;I=1.03c-7;A=1.14e-3;tho=7860;L=1;
X=[12/L/L/L,-6/L/L,-12/L/I/L,-6/L/L];
Ke=E*1*[X;-6/LL,4/L,6/LL,2/L;-X;-6/L/L,2/L,6/L/L,4/L];
K=Ke;KK=Ke;
for i=2:4 ??成整体刚度矩阵
K=[K,zeros(2*i,1),zeros(2×i,1)];
K=[K;zeros(1.2*i+2);zeros(1,2*i+2)];
KK=[zeroa(2*i.1),zeros(2*i,1),KK];
KK=[zeros(1,2*i+2);zerus(1,2*i+2);KK];
K=K+KK;
end
Me=[156,-22*L,54.13*L;-22*L.4*L*L,-13*L.-3*L*L;54,…
-13×L,156,22*L;13*L,-3×L*L,22*L.4*L+1.];
Mr= rhu*A*L/420v Me;
·282· 应 用 篇
M=Me;MM=Me;
for i=2:4 ??成整体质量矩阵
M=[M,zcros(2*i,1),zeros(2*i,1)];
M=[M;zeros(1,2*i+2);zeros(1,2*i+2)];
MM=[zerus(2*i,1),zeros(2×i,1),MM];
MM=[zeros(1,2*i+2);zeros(1,2*i+2);MM;
M=M+MM;
end
K(1,:)=[;K(:,1)=[];K(8,:)=[J;K(:,8)=[]:K(8,:)=[];K(:,8)=[]; ??理约束条件
M(1.:)=[];M(:,1)=[ ];M(8,:)=[];M(:,8)=[];M(8,:)=1];M(:,8)=[];
AA=inv(M)*K;
??特征值 W= eig(AA);
W=sqrt(W);
disp(W');
程序运行结果为：
1.0e+003*
1.5615 0.9780 0.59990.3194 0.1507 0.0462 2.2607
即直梁自由振动基频为46.2。
实 验 要 求
学习程序设计，上机实验是十分重要的环节。为了方便读者上机练习，在实验篇设计了15
个实验。这些实验和课堂教学紧密配合，通过有针对性的上机实验，可以更好地熟悉MATLAB的
功能，掌握MATLAB程序设计的方法，并培养一定的应用开发能力。每个实验安排2机时左右。
读者也可以根据实际情况从每个实验中选择部分内容作为上机练习。另外，基础篇和应用篇各
章后面的部分习题也可以作为实验内容的补充。
为了达到理想的实验效果，读者务必做到：
(1)实验前认真准备，要根据实验目的和实验内容，复习好实验中可能要用到的命令，想好
编程的思路，做到胸有成竹，提高上机效率。
(2)实验过程中积极思考，要深入分析命令、程序的执行结果以及各种屏幕信息的含义、出
现的原因并提出解决办法。
(3)实验后认真总结，要总结本次实验有哪些收获，还存在哪些问题，并写出实验报告。实
验报告应包括实验目的、实验内容、流程图、程序(命令)清单、运行结果以及实验的收获与体会等
内容。
程序设计和应用开发能力的提高需要不断的上机实践和长期的积累，在上机过程中会碰到
各种各样的问题，分析问题和解决问题的过程就是经验积累的过程。只要读者按照上面3点要
求去做，在学完本课程后就一定会有很大的收获，计算机应用能力就会有很大提高。
实验一 MATLAB运算基础
一、实验目的
1.熟悉启动和退出MATLAB的方法。
2.熟悉MATLAB命令窗口的组成。
3.掌握建立矩阵的方法。
4.掌握MATLAB各种表达式的书写规则以及常用函数的使用。
二、实验内容
1.先求下列表达式的值，然后显示MATLAB工作空间的使用情况并保存全部变量。
(1)z1=21+85
x=[-04552 (2)22=2In(x+√1+x2),其中
·286· 实 验 篇
(3):3=2sin(a+0.3),a=-3.0,-2.9,-2.8,…,2.8,2.9,3.0
提示：利用冒号表达式生成a向量，求各点的函数值时用点乘运算。
,中00523
提示：用逻辑表达式求分段函数值。
2.已知
求下列表达式的值：
(1)A+6*B和A-B+I(其中1为单位矩阵)。
(2)A*B和A.*B。
(3)A^3和A.“3。
(4)A/B及B\A。
(5)[A,B]和[A([1,3],:);B^2]。
3.设有矩阵A和B
(1)求它们的乘积C。
(2)将矩阵C的右下角3×2子矩阵赋给D。
(3)查看MATLAB工作空间的使用情况。
4.完成下列操作：
(1)求[100,999]之间能被21整除的数的个数。
提示；先利用冒号表达式，再利用find和 length 函数。
(2)建立一个字符串向量，删除其中的大写字母。
提示：利用find 函数和空矩阵。
实验二 选择结构程序设计 ·287·
实验二 选择结构程序设计
一、实验目的
1.掌握建立和执行M文件的方法。
2.掌握利用if语句实现选择结构的方法。
3.掌握利用switch语句实现多分支选择结构的方法。
4.掌握try语句的使用。
二、实验内容
1.求下列分段函数的值。
要求：
(1)用if语句实现，分别输出x=-5.0,-3.0,1.0,2.0,2.5,3.0,5.0时的y值。
提示：x的值从键盘输人，可以是向量。
(2)仿照实验一第1题第4小题，用逻辑表达式实现，从而体会MATLAB逻辑表达式的一种
应用。
2.输入一个百分制成绩，要求输出成绩等级A,B,C,D,E。其中90~100分为A,80～89
分为B,70~79分为C,60～69分为D,60分以下为E。
要求：
(1)分别用if语句和switch 语句实现。
(2)输入百分制成绩后要判断该成绩的合理性，对不合理的成绩应输出出错信息。
3.假定某地区电话收费标准为：通话时间在3分钟以下，收费0.50元；3分钟以上，则每超
过1分钟加收0.15元；在7:00~22:00之间通话者，按上述收费标准全价收费，在其他时间通话
者，按上述收费标准半价收费。计算某人在t1时问通话至t2时间，应缴多少电话费。
提示：
(1)t1、2从键盘输入，通话时间为t2减去t1,相减时可以将11、2化成以秒为单位再相
减。
(2)为了简化程序，根据开始通话的时间来判断是否享受半价收费。
(3)也可以用clock 函数得到机器时间，可利用帮助功能查询该函数的用法。以程序开始运
行时的时间作为开始通话的时间t1,程序设暂停语句，以暂停结束的时间作为结束通话的时间
12。
·288· 实 验 篇
4.建立5×6矩阵，要求输出矩阵第 n行元素。当n值超过矩阵的行数时，自动转为输出矩
阵最后一行元素，并给出出错信息。
实验三 循环结构程序设计
一、实验目的
1.掌握利用for语句实现循环结构的方法。
2.掌握利用while语句实现循环结构的方法。
3.熟悉利用向量运算来代替循环操作的方法。
二、实验内容
6=1+垃+字+…+ 1.根据 ,求π的近似值。当n分别取100、1000、10000时，结果是多少?
要求：分别用循环结构和向量运算(使用sum 函数)来实现。
y=1+3+亏+…+2n-1 2.根据 ,求：
(1)y<3时的最大n值。
(2)与(1)的 n值对应的γ值。
3.一个三位整数各位数字的立方和等于该数本身则称该数为水仙花数。试输出全部水仙
花数。
要求：
(1)用循环结构实现。
(2)用向量运算来实现。
提示：全部3位整数组成向量M;分别求M各元素的个位、十位、百位数字，组成向量M1、
M2、M3;向量N=M1.*M1.*M1+M2.*M2.*M2+M3.*M3,*M3;向量K=M-N;显然K中
0元素的序号即M中水仙花数的序号。
4.已知
求f~fio中：
(1)最大值、最小值、各数之和。
(2)正数、零、负数的个数。
提示：可以考虑使用MATLAB有关函数来实现。
实验五 高层绘图操作 ·289·
实验四 函数与文件
一、实验目的
1.掌握定义和调用MATLAB函数的方法。
2.掌握MATLAB文件的基本操作。
二、实验内容
1.定义一个函数文件，求给定复数的指数、对数、正弦和余弦，并在命令文件中调用该函数
文件。
2.一物理系统可用下列方程组来表示
三
从键盘输入mi、m?和θ的值，求a?、a?、N?和N?的值。其中g取9.8,输入θ时以角度为单位。
要求：定义一个求线性方程组 AX=B根的函数文件，然后在命令文件中调用该函数文件。
3.一个自然数是素数，且它的各位数字位置经过任意对换后仍为素数，则称是绝对素数。
例如13是绝对素数。试求所有两位的绝对素数。
要求：定义一个判断素数的函数文件。
4.统计一个文本文件中每个英文字母出现的次数，不区分字母的大小写。
实验五 高层绘图操作
一、实验目的
1.掌握绘制二维图形的常用函数。
2.掌握绘制三维图形的常用函数。
3.掌握绘制图形的辅助操作。
二、实验内容
1.已知 y1=x2,y2=cos(2x),y3=y1*y2,完成下列操作：
·290· 实 验 篇
(1)在同一坐标系下用不同的颜色和线型绘制3条曲线。
(2)以子图形式绘制3条曲线。
(3)分别用条形图、阶梯图、杆图和填充图绘制3条曲线。
2.绘制极坐标曲线p=asin(b+nθ),并分析参数a,b,n对曲线形状的影响。
y=sin1 3.分别用plot和 fplot 函数绘制函数 的曲线，分析两曲线的差别。
4.绘制函数的曲面图和等高线。
(1)z=(x2-2x)e-2-2-y
(2)fx,y)=Vx-12+-(x+12+
提示：绘制三维曲面图，首先要选定一平面区域并在该区域产生网格坐标矩阵。在做本题
前，先分析并上机验证下列命令的执行结果，从中体会产生网格坐标矩阵的方法。
[x,y]=meshgrid(-1:0.5:2,1:5)
实验六 低层绘图操作
一、实验目的
1.掌握图形对象属性的基本操作。
2.掌握利用图形对象进行绘图操作的方法。
二、实验内容
1.建立一个图形窗口，使之背景颜色为红色，并在窗口上保留原有的菜单项，而且在按下鼠
标器的左键之后显示出Left Button Pressed字样。
2.先利用缺省属性绘制曲线y=x2e2,然后通过图形句柄操作来改变曲线的颜色、线型和
线宽，并利用文字对象给曲线添加文字标注y=x2e2。
3.利用曲面对象绘制曲面v(x,t)=10e-0.01*sin(2000πt-0.2x+π),并要求分别绘制曲面
在x-y、x-z和y-2平面上的投影。
提示：通过视点的设置来绘制出曲面在两两平面上的投影。
4.以任意位置子图形式绘制出正弦、余弦、正切和余切函数曲线。
提示：利用坐标轴对象对图形窗口做任意分割。
实验七 线性代数中的数值计算问题 ·291·
实验七 线性代数中的数值计算问题
一、实验目的
1.掌握生成特殊矩阵的方法。
2.掌握矩阵分析的方法。
3.掌握线性方程组的求解方法。
二、实验内容
1.产生5阶希尔伯特矩阵H和5阶帕斯卡矩阵P,且求其行列式的值Hh和Hp 以及它们
的条件数Th和Tp,判断哪个矩阵性能更好，为什么?
2.已知
^-
求A的特征值及特征向量，并分析其数学意义。
3.分别用3种不同的数值方法解线性方程组。
4.不用rot90函数，实现方阵左旋90°或右旋90°的功能。例如，原矩阵为A,A左旋后得到
B,右旋后得到C
要求：定义一个函数文件，然后在命令文件中调用该函数文件。函数文件的调用格式为
myrot(A,t),其中A在调用前为原矩阵，调用后为经旋转后的矩阵，t确定是左旋还是右旋，当t
=1时为左旋，t=-1时为右旋，t为其他值时显示出错信息。
提示：先将A转置，再作上下翻转，则完成左旋90°;若将A转置后作左右翻转，则完成右旋
90°。
·292· 实 验 篇
实验八 数据处理和多项式计算
一、实验目的
1.掌握数据统计和分析的方法。
2.掌握数值插值与曲线拟合的方法及其应用。
3.掌握多项式的常用运算。
二、实验内容
1.将100个学生5门功课的成绩存入矩阵P中，进行如下处理：
(1)分别求每门课的最高分、最低分及相应学生序号。
(2)分别求每门课的平均分和标准方差。
(3)5门课总分的最高分、最低分及相应学生序号。
(4)将5门课总分按从大到小顺序存入 zcj中，相应学生序号存入 xsxh。
提示：上机调试时，为避免输入学生成绩的麻烦，可用取值范围在[45,95]之间的随机矩阵来
表示学生成绩。
2.某气象观测站测得某日6:00~18:00之间每隔2h的室内外温度(℃)如表1所示。
表1 室内外温度观测结果(℃)
时间h 6 8 10 12 14 16 18
室内温度 t1 18.0 20.0 22.0 25.0 30.0 28.0 24.0
室外温度t2 15.0 19.0 24.0 28.0 34.0 32.0 30.0
试用三次样条插值分别求出该日室内外6:30~17:30时之间每隔2h各点的近似温度(℃)。
3.已知 lg(x)在[1,101]区间11个整数采样点的函数值如表2所示。
表2 lg(x)在10个采样点的函数值
x 1 11 21 31 41 51 61 71 81 91
0 1.041 4 1,3222 1.491 4 1.6128 1.707 6 1.785 3 1.851 3 1.908 5 1.959 0
101
lg(x) 2.004 3
试求lg(x)的5次拟合多项式p(x),并分别绘制出lg(x)和p(x)在[1,101]区间的函数曲
线。
4.有3个多项式P?(x)=x?+2x3+4x2+5,P?(x)=x+2,P?(x)=x2+2x+3,试进行下列
操作：
(1)求P(x)=P?(x)+P?(x)*P?(x)。
实验九 数值微积分与方程数值求解
(2)求P(x)的根。
(3)当x取矩阵A的每一元素时，求P(x)的值。其中
-
(4)当以矩阵A为自变量时，求P(x)的值。其中A的值与(3)相同。
实验九 数值微积分与方程数值求解
一、实验目的
1.掌握求数值导数和数值积分的方法。
2.掌握常微分方程数值求解的方法。
3.掌握非线性代数方程数值求解的方法。
二、实验为容
1.求函数在指定点的数值导数。 -…2
2.用数值方法求定积分。
(1)Z?=5“√cosP2+4sin(2x)2+1dt的近似值。
(2)I?=(+t)dx
3.求微分方程的数值解。
4.求代数方程的数值解。
(1)3x+sin x-e2=0在xo=1.5附近的根。
(2)在给定的初值xo=1,yo=1,zo=1下，求下列方程组的数值解。
·293·
·294· 实 验 篇
实验十 符号计算基础与符号微积分
一、实验目的
1.掌握定义符号对象的方法。
2.掌握符号表达式的运算法则以及符号矩阵运算。
3.掌握求符号函数极限及导数的方法。
4.掌握求符号函数定积分和不定积分的方法。
二、实验内容
1.已知x=6,y=5,利用符号表达求：√3+*-
提示：定义符号常数x=sym('6'),y=sym('5')。
2.已知1
求：
(1)B=P1·P2·A。
(2)B的逆矩阵并验证结果。
(3)包括B矩阵主对角线元素的下三角阵。
(4)B的行列式值。
提示：用于数值矩阵分析的有关函数同样适用于符号矩阵。验证结果时须将结果化简。
3.用符号方法求下列极限或导数。
(1)lim×e+1)-2(e2-1)
A=[J ddexd (2)已知 ,分别求
4.用符号方法求下列积分。
(1)f+d+
(2)。2+1dx
实验十二 菜单设计
实验十一 级数与方程符号求解
一、实验目的
1.掌握级数求和的方法。
2.掌握将函数展开为泰勒级数的方法。
3.掌握微分方程符号求解的方法。
4.掌握代数方程符号求解的方法。
二、实验内容
1.级数符号求和。
s=22-1 (1)计算：
(2)求级数 2?1之和函数，并求之和。
2.将In(x)在x=1处按5次多项式展开为泰勒级数。
3.求微分方程的符号解。
k为任意常数
4.求下列方程和方程组的符号解。
(1)3xe2+5sin x-78.5=0
(2)+5y-8=-
实验十二 菜单 设 计
一、实验目的
1.了解图形用户界面的特点。
2.掌握菜单设计的方法。
·295·
·296 实 验 篇
二、实验雨容
1.在图形窗口缺省菜单条上增加一个Pot菜单项，利用该菜单项可以在本窗口绘制三维曲
面图形。
2.为图形窗口建立快捷菜单，用以控制窗口的背景颜色和大小。
3.设计菜单(如图1所示)。
菜设计实验 国区
IZi2m
E10t Sin Trvs
xit Cosine YV
图1 菜单设计
菜单条仅有Fle菜单项，File下有New.Plot和Exit等3个选项。选择New 时利用Edit命令
建立一个新的M文件。选择 Plot将显示下一级菜单，其中有 Sine Wave和Cosine Wave两个子菜
单项，且若选择了其中的Sine Wave子菜单项，则将打开一个新的图形窗口并显示出正弦曲线。
若选择了其中的Cosine Wave子菜单项，则将打开一个新的图形窗口并显示出余弦曲线。如果选
择Exit菜单项，则将关闭窗口并退出用户系统回到MATLAB命令窗口。
实验十三 对话框的设计
一、实验目的
1.掌握建立控件对象的方法。
2.掌握对话框设计的方法。
二、实验商容
1.设计一个对话框，其中有一个编辑框和按钮，当单击按钮时，使编辑框的内容加5。
2.采用图形用户界面，从键盘输入参数a,b,n的值，考察参数对极坐标曲线p=acs(b+
实验十四 Simulink的应用 ·297·
nθ)的影响。
3.编一程序，对给定位数的数据产生校验位。
在数据处理中，关键字段值的正确与否对系统的运行至关重要。例如，在各种考试中，准考
证号是识别考生的关键字。为了正确地判断准考证号输人的正确性，将7位数的准考证号在其
前面加一位校验位，构成有校验位的8位准考证号。假定产生校验位的公式为：
=(dxi)mod 10
其中a为校验位，d;第；位的数。
例如，某考生准考证号为2573458,则校验位为
a=(2×7+5×6+7×5+3×4+4×3+5×2+8×1)mod 10=1
因此，带有校验位的8位准考证号为12573458。
要求采用图形用户界面，程序具体功能如下：
(1)输入7位数的准考证号，单击“生成”按钮，则显示对应带有校验位的8位准考证号。当
输人非7位数时，显示出错信息。
(2)输入带有校验位的8位数的准考证号，单击“校验”按钮，校验输入的准考证号正确与
否。同样，当输人非8位数时，显示出错信息。
(3)单击“退出”按钮，退出程序。
实验十四 Simulink的应用
一、实验目的
1.熟悉 Simulink的操作环境并掌握构建系统模型的方法。
2.掌握Simulink 中子系统模块的建立与封装技术。
3.对简单系统所给出的数学模型能转化为系统仿真模型并进行仿真分析。
二、实验内容
1.构建图2(a)所示的含有齿隙非线性环节的系统模型并进行仿真。其中齿隙非线性环节
的特性如图2(b)所示。
提示：
(1)齿隙非线性环节位于模块浏览器的非线性模块库(Nonliner)中。
(2)在仿真之前，对各个的参数进行设置，然后选择 Siroulink菜单中的Parameters 命令来设
置仿真参数(选仿真终止时间为3s),再选择 Simulink菜单中的 Start 命令即可开始仿真了。
2.PID控制器是在工业控制中经常用到的模块，在工程应用中其标准的数学模型为
U(s)=k,(1++i+ST)E(S)
·298· 实 验 篇
0.6s+1 10
0.1s+1
1
5 S
Step Transter Fon Tiansfer Fcn1 Integrator Badkl ash To Wonspace
Clock To Worlspace1
(a)含有非线性环节的控制系统框图
Y_
X
(b)齿隙非线性环节特性
图2 典型非线性系统框图
其中采用了一阶环节来近似纯微分动作，故一般选N≥10。先建立 PID控制器模型如图3所示，
然后建立并封装子系统。
1 Kp hT
In1 A
Gain Gain1 Integrator
t
Dut1
Td(s)
TO/N.s+1
Ttanster Fon
图3 PID控制器的 Simulink 描述
提示：
(1)选中所有模块。选择 Edit命令下的Select All菜单项可以选中所有的模块。
(2)建立子系统。选择 Edit 命令下的Create Subsystem菜单项，则可以由选定的模块和连接
关系构造出子系统。
(3)封装子系统。选择子系统模块，再选择 Edit 命令下的Mask Subsystem菜单项，将打开一
个对话框，单击该对话框中的Initialization 标签，打开相应的选项卡，用户可以在该选项卡中输入
各个变量的提示Prompt 和变量名Variable。
用户还可以打开loon选项卡，在Drawing commands栏目下填入 disp('PID')字样，这时可以
在该图标上显示PID字样。
(4)子系统参数初始化。建立该子系统后，双击该图标，将弹出一个对话框。用户可以在各
个栏目上填写默认参数，然后将此子系统存盘备用。
y
实验十五 综合实验 ·299·
3.设某简单系统的微分方程为X'(t)=-4X(t)+2u(t),式中u(t)是一个幅度为1,角频
率为1 rad/s的方波输人信号，试用两种以上的方法建立系统模型并进行仿真，同时利用Scope获
得X(t)的波形。
实验十五 综 合 实 验
一、实验目的
综合运用所学知识，掌握利用MATLAB解决实际问题的方法。
二、实验内容
1.给出迭代方程 =0.3-1.4 ,xn=0,yo=0
先编写求解方程的函数文件，然后调用该函数文件求30 000个点上的x,y,最后在所有的
(x,,y:)坐标处标记一个点(不要连线)绘出图形。这种图形迭代出来的随机点吸引到一起，最后
得出貌似连贯的引力线图。
2.分别利用数值积分法、符号积分法和 Simulink仿真求t=?。xin(1+x)dx。
提示：Simulink 仿真需利用Simulink 标准模块构建一个积分模型，并把仿真终止时间设置为
1,然后启动仿真，利用Display模块显示积分结果。
3.已知阿波罗(Apollo)卫星的运动轨迹(x,y)满足下列微分方程
=2y+x-x+)-x j=-2x+y--
其中μ=1/82.45,μ=1-μ,r?=√(x+μ)2+y2,r?=√(x+μ)2+y2,试在初值x(0)=1.2,
x(0)=0,y(0)=0,y(0)=-1.04935751下进行数值求解，并绘制出阿波罗卫星位置(x,y)的轨
迹。
提示：先选择一组状态变量，写出一阶常微分方程组，并定义相应的函数文件，然后求方程的
数值解。
